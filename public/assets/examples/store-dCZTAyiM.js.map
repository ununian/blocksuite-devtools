{"version":3,"file":"store-dCZTAyiM.js","sources":["../../../examples/store/schema.ts","../../../examples/store/main.ts"],"sourcesContent":["import { defineBlockSchema, type SchemaToModel } from '@blocksuite/store';\nimport { literal } from 'lit/static-html.js';\n\nconst TodoContainerBlockSchema = defineBlockSchema({\n  flavour: 'todo:container',\n  metadata: {\n    version: 1,\n    role: 'hub',\n    tag: literal`todo-container`,\n  },\n});\n\nconst TodoItemBlockSchema = defineBlockSchema({\n  flavour: 'todo:item',\n  props: () => ({\n    content: '',\n    done: false,\n  }),\n  metadata: {\n    version: 1,\n    role: 'content',\n    tag: literal`todo-item`,\n  },\n});\n\nexport const TodoSchema = [TodoContainerBlockSchema, TodoItemBlockSchema];\nexport type TodoContainerBlockModel = SchemaToModel<\n  typeof TodoContainerBlockSchema\n>;\nexport type TodoItemBlockModel = SchemaToModel<typeof TodoItemBlockSchema>;\n","import { type Page, Schema, Workspace } from '@blocksuite/store';\n\nimport {\n  type TodoContainerBlockModel,\n  type TodoItemBlockModel,\n  TodoSchema,\n} from './schema';\n\nfunction initPage() {\n  const schema = new Schema();\n  schema.register(TodoSchema);\n  const workspace = new Workspace({ schema });\n  const page = workspace.createPage({ id: 'page:home' });\n  page.addBlock('todo:container');\n  return page;\n}\n\nfunction bindEvents(page: Page, container: TodoContainerBlockModel) {\n  const addInput = document.querySelector('.input-add') as HTMLInputElement;\n  const addButton = document.querySelector('.button-add') as HTMLButtonElement;\n  const containerDiv = document.querySelector('.container') as HTMLDivElement;\n  addButton.addEventListener('click', () => {\n    const content = addInput.value;\n    if (content !== '') {\n      const id = page.addBlock('todo:item', { content }, container);\n      const todoItemBlock = page.getBlockById(id) as TodoItemBlockModel;\n      todoItemBlock.propsUpdated.on(() => {\n        render(container);\n      });\n      addInput.value = '';\n      addInput.focus();\n    }\n  });\n  containerDiv.addEventListener('click', event => {\n    const target = event.target as HTMLElement;\n    if (target.classList.contains('button-done')) {\n      const todoItemBlock = page.getBlockById(\n        target.parentElement?.dataset.id as string\n      ) as TodoItemBlockModel;\n      page.updateBlock(todoItemBlock, { done: !todoItemBlock.done });\n    }\n  });\n}\n\nfunction todoItemTemplate(todo: TodoItemBlockModel) {\n  return `<div class=\"todo-item\" data-id=\"${todo.id}\">\n  <button class=\"button-done\">done</button>\n  <span class=\"content ${todo.done ? 'done' : ''}\">${todo.content}</span>\n</div>`;\n}\n\nfunction render(container: TodoContainerBlockModel) {\n  const todoBlocks = container.children as Array<TodoItemBlockModel>;\n  const todoDivs = todoBlocks\n    .map((block: TodoItemBlockModel) => todoItemTemplate(block))\n    .join('\\n');\n  const containerDiv = document.querySelector('.container') as HTMLDivElement;\n  containerDiv.innerHTML = todoDivs;\n}\n\nfunction main() {\n  const page = initPage();\n  const container = page.getBlockByFlavour(\n    'todo:container'\n  )[0] as TodoContainerBlockModel;\n  bindEvents(page, container);\n  container.childrenUpdated.on(() => {\n    render(container);\n  });\n}\n\nmain();\n"],"names":["TodoContainerBlockSchema","defineBlockSchema","literal","TodoItemBlockSchema","TodoSchema","initPage","schema","Schema","page","Workspace","bindEvents","container","addInput","addButton","containerDiv","content","id","render","event","target","todoItemBlock","todoItemTemplate","todo","todoDivs","block","main"],"mappings":"gEAGA,MAAMA,EAA2BC,EAAkB,CACjD,QAAS,iBACT,SAAU,CACR,QAAS,EACT,KAAM,MACN,IAAKC,iBACP,CACF,CAAC,EAEKC,EAAsBF,EAAkB,CAC5C,QAAS,YACT,MAAO,KAAO,CACZ,QAAS,GACT,KAAM,EAAA,GAER,SAAU,CACR,QAAS,EACT,KAAM,UACN,IAAKC,YACP,CACF,CAAC,EAEYE,EAAa,CAACJ,EAA0BG,CAAmB,ECjBxE,SAASE,GAAW,CACZ,MAAAC,EAAS,IAAIC,EACnBD,EAAO,SAASF,CAAU,EAE1B,MAAMI,EADY,IAAIC,EAAU,CAAE,OAAAH,CAAQ,CAAA,EACnB,WAAW,CAAE,GAAI,YAAa,EACrD,OAAAE,EAAK,SAAS,gBAAgB,EACvBA,CACT,CAEA,SAASE,EAAWF,EAAYG,EAAoC,CAC5D,MAAAC,EAAW,SAAS,cAAc,YAAY,EAC9CC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAe,SAAS,cAAc,YAAY,EAC9CD,EAAA,iBAAiB,QAAS,IAAM,CACxC,MAAME,EAAUH,EAAS,MACzB,GAAIG,IAAY,GAAI,CAClB,MAAMC,EAAKR,EAAK,SAAS,YAAa,CAAE,QAAAO,CAAA,EAAWJ,CAAS,EACtCH,EAAK,aAAaQ,CAAE,EAC5B,aAAa,GAAG,IAAM,CAClCC,EAAON,CAAS,CAAA,CACjB,EACDC,EAAS,MAAQ,GACjBA,EAAS,MAAM,CACjB,CAAA,CACD,EACYE,EAAA,iBAAiB,QAAkBI,GAAA,CAC9C,MAAMC,EAASD,EAAM,OACrB,GAAIC,EAAO,UAAU,SAAS,aAAa,EAAG,CAC5C,MAAMC,EAAgBZ,EAAK,aACzBW,EAAO,eAAe,QAAQ,EAAA,EAEhCX,EAAK,YAAYY,EAAe,CAAE,KAAM,CAACA,EAAc,KAAM,CAC/D,CAAA,CACD,CACH,CAEA,SAASC,EAAiBC,EAA0B,CAC3C,MAAA,mCAAmCA,EAAK,EAAE;AAAA;AAAA,yBAE1BA,EAAK,KAAO,OAAS,EAAE,KAAKA,EAAK,OAAO;AAAA,OAEjE,CAEA,SAASL,EAAON,EAAoC,CAE5C,MAAAY,EADaZ,EAAU,SAE1B,IAAKa,GAA8BH,EAAiBG,CAAK,CAAC,EAC1D,KAAK;AAAA,CAAI,EACNV,EAAe,SAAS,cAAc,YAAY,EACxDA,EAAa,UAAYS,CAC3B,CAEA,SAASE,GAAO,CACd,MAAMjB,EAAOH,IACPM,EAAYH,EAAK,kBACrB,kBACA,CAAC,EACHE,EAAWF,EAAMG,CAAS,EAChBA,EAAA,gBAAgB,GAAG,IAAM,CACjCM,EAAON,CAAS,CAAA,CACjB,CACH,CAEAc,EAAK"}