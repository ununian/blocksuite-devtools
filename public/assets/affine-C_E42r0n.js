import{D as dt,c as D,W as nt,I as FB,F as Ag,H as nh,K as Ud,g as Ve,i as Cs,L as m1,M as rk,m as km,N as kc,O as Vl,P as $g,Q as ys,t as Oe,R as _1,h as ok,U as sk,V as UB,x as b,T as ae,z as ge,X as ak,Y as VB,Z as _i,$ as Bn,B as N4,f as Oi,a0 as Ht,s as Em,_ as Jt,a1 as Be,J as ar,a2 as st,a3 as zn,a4 as Qa,a5 as zB,a6 as Sm,S as jB}from"./static-yoecXErL.js";import{P as gt,d as GB,I as ni,E as ZB,i as X,e as he,B as wn,c as Fe,t as W,n as L,r as ie,W as me,o as we,S as De,f as ii,g as Dt,h as Dn,s as Ae,j as Qe,k as zl,m as lk,p as tr,q as Je,u as WB,v as qB,R as Qp,w as ck,x as YB,y as to,T as jy,z as Gy,A as Ri,C as dk,D as $t,F as uk,G as XB,H as P2,J as hk,K as Vn,b as cn,L as Tm,M as KB,N as QB,Z as Bg,a as JB,O as pk,Q as eD,U as tD,V as nD,X as iD,Y as rD}from"./ref-ehjBZcli.js";async function Dg(t,e){return new Promise(n=>{if(e?.aborted){n();return}let i=!1;e?.addEventListener("abort",()=>{i||(clearTimeout(r),n())});const r=setTimeout(()=>{i=!0,n()},t)})}function c4e(t){}function Vd(t,e,{leading:n=!0,trailing:i=!0}={}){let r=null,o=null;const s=()=>{o&&i?(t(...o),o=null,r=setTimeout(s,e)):r=null};return function(...a){if(r){o=a;return}n&&t.apply(this,a),r=setTimeout(s,e)}}const d4e=(t,e,{leading:n=!0,trailing:i=!0}={})=>{let r=null,o=null;const s=()=>{o&&i?(t(...o),o=null,r=setTimeout(s,e)):r=null};return function(...a){r&&(o=a,clearTimeout(r)),n&&!r&&t(...a),r=setTimeout(s,e)}};class li{constructor(e){this.disposables=new dt,this.flavour=e.flavour,this.std=e.std}get workspace(){return this.std.workspace}get page(){return this.std.page}get selectionManager(){return this.std.selection}get uiEventDispatcher(){return this.std.event}dispose(){this.disposables.dispose()}mounted(){}unmounted(){}handleEvent(e,n,i){this.disposables.add(this.uiEventDispatcher.add(e,n,{flavour:i?.global?void 0:this.flavour}))}bindHotKey(e,n){this.disposables.add(this.uiEventDispatcher.bindHotkey(e,{flavour:n?.global?void 0:this.flavour}))}}const oD=(t,e)=>{const n=t.path??t.currentSelectionPath;D(n,"`path` is required, you need to pass it in args or ctx before adding this command to the pipeline.");const i=t.std.view.getParent(n);if(!i)return;const r=i.children.findIndex(o=>gt.equals(o.path,n));e({blockIndex:r,parentBlock:i.view})};function sD(t,e,n){const i=t.view,r=i.findNext(e.path,o=>{if(!(o.type!=="block"||o.view.contains(e))&&!(n&&!n(o.view)))return!0});return r?i.viewFromPath("block",r.path):null}function aD(t,e,n){const r=t.view.viewFromPath("block",e);if(!r)return null;let o=null;return r.childBlockElements[0]&&(o=r.childBlockElements[0]),o||(o=sD(t,r,n)),o&&!o.contains(r)?o:null}const lD=(t,e)=>{const n=t.path??t.currentSelectionPath;D(n,"`path` is required, you need to pass it in args or ctx before adding this command to the pipeline.");const i=aD(t.std,n,t.filter);i&&e({nextBlock:i})};function cD(t,e,n){const i=t.view,r=i.findPrev(e,o=>{if(o.type==="block"&&!(n&&!n(o.view)))return!0});return r?i.viewFromPath("block",r.path):null}function dD(t,e){const n=t.view;let i=e;return n.walkThrough((r,o,s)=>{if(r.children.filter(a=>a.type==="block").length===0&&s.children.filter(a=>a.type==="block").at(-1)===r)return i=r.view,!0},e.path),i}function uD(t,e,n){const i=t.view;let r=cD(t,e,n);if(!r)return null;const o=i.viewFromPath("block",e);return o?(r.contains(o)||(r=dD(t,r)),r&&!gt.equals(r.path,e)?r:null):null}const hD=(t,e)=>{const n=t.path??t.currentSelectionPath;D(n,"`path` is required, you need to pass it in args or ctx before adding this command to the pipeline.");const i=uD(t.std,n,t.filter);i&&e({prevBlock:i})},pD=(t,e)=>{const{host:n,types:i=["block","text","image"],roles:r=["content"]}=t;D(n,"`host` is required, you need to use `withHost` command before adding this command to the pipeline.");let o=[];const s=t.textSelection??t.currentTextSelection;if(i.includes("text")&&s){const d=n.rangeManager;D(d);const u=d.textSelectionToRange(s);if(!u)return;const h=d.getSelectedBlockElementsByRange(u,{match:p=>r.includes(p.model.role),mode:"flat"});o.push(...h)}const a=t.blockSelections??t.currentBlockSelections;if(i.includes("block")&&a){const d=n.view,u=a.flatMap(h=>d.viewFromPath("block",h.path)??[]);o.push(...u)}const l=t.imageSelections??t.currentImageSelections;if(i.includes("image")&&l){const d=n.view,u=l.flatMap(h=>d.viewFromPath("block",h.path)??[]);o.push(...u)}t.filter&&(o=o.filter(t.filter));const c=o.filter((d,u)=>o.indexOf(d)===u).sort((d,u)=>{if(d===u)return 0;const h=d.compareDocumentPosition(u);return h&Node.DOCUMENT_POSITION_FOLLOWING||h&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:h&Node.DOCUMENT_POSITION_PRECEDING||h&Node.DOCUMENT_POSITION_CONTAINS?1:0});c.length!==0&&e({selectedBlocks:c})};function _n(t,e){const n={};return t.forEach(i=>{const r=e(i);n[r]||(n[r]=0),n[r]+=1}),n}function Cn(t,e){if(!t.length)return null;let n=t[0],i=e(n);for(let r=1;r<t.length;r++){const o=t[r],s=e(o);s>i&&(i=s,n=o)}return n}function fD(t,e,n){let i=0;for(let r=0;r<t.length;r++)if(e(t[r])&&(i++,i>=n))return!0;return!1}function F1(t,e){const n={};for(const i of t){const r=typeof e=="function"?e(i):i[e];n[r]||(n[r]=[]),n[r].push(i)}return n}function Im(t,e){return e.reduce((n,i)=>(n.push(t[i]),n),[])}function A2(t){return Object.keys(t)}function fk(t){return Object.values(t)}function pi(t){if(Array.isArray(t))return t[t.length-1];let e;for(const n of t)e=n;return e}function gD(t,e){if(Array.isArray(t))return t[t.length-e];const n=[...t];return n[n.length-e]}function gk(){return Math.floor(Math.random()*2**31)}class mD{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}class te{static clamp(e,n,i){return Math.max(n,typeof i<"u"?Math.min(e,i):e)}static clampV(e,n,i){return e.map(r=>i?te.clamp(r,n,i):te.clamp(r,n))}static{this.neg=e=>[-e[0],-e[1]]}static{this.add=(e,n)=>[e[0]+n[0],e[1]+n[1]]}static{this.addScalar=(e,n)=>[e[0]+n,e[1]+n]}static{this.sub=(e,n)=>[e[0]-n[0],e[1]-n[1]]}static{this.subScalar=(e,n)=>[e[0]-n,e[1]-n]}static{this.vec=(e,n)=>[n[0]-e[0],n[1]-e[1]]}static{this.mul=(e,n)=>[e[0]*n,e[1]*n]}static{this.mulV=(e,n)=>[e[0]*n[0],e[1]*n[1]]}static{this.div=(e,n)=>[e[0]/n,e[1]/n]}static{this.divV=(e,n)=>[e[0]/n[0],e[1]/n[1]]}static{this.per=e=>[e[1],-e[0]]}static{this.dpr=(e,n)=>e[0]*n[0]+e[1]*n[1]}static{this.cpr=(e,n)=>e[0]*n[1]-n[0]*e[1]}static cross(e,n,i){return(n[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(n[1]-e[1])}static{this.len2=e=>e[0]*e[0]+e[1]*e[1]}static{this.len=e=>Math.hypot(e[0],e[1])}static{this.pry=(e,n)=>te.dpr(e,n)/te.len(n)}static{this.uni=e=>te.div(e,te.len(e))}static{this.normalize=e=>te.uni(e)}static{this.tangent=(e,n)=>te.uni(te.sub(e,n))}static{this.dist2=(e,n)=>te.len2(te.sub(e,n))}static{this.dist=(e,n)=>Math.hypot(e[1]-n[1],e[0]-n[0])}static{this.fastDist=(e,n)=>{const i=[n[0]-e[0],n[1]-e[1]],r=[Math.abs(i[0]),Math.abs(i[1])];let o=1/Math.max(r[0],r[1]);return o=o*(1.29289-(r[0]+r[1])*o*.29289),[i[0]*o,i[1]*o]}}static{this.ang=(e,n)=>Math.atan2(te.cpr(e,n),te.dpr(e,n))}static{this.angle=(e,n)=>Math.atan2(n[1]-e[1],n[0]-e[0])}static{this.med=(e,n)=>te.mul(te.add(e,n),.5)}static{this.rot=(e,n=0)=>[e[0]*Math.cos(n)-e[1]*Math.sin(n),e[0]*Math.sin(n)+e[1]*Math.cos(n)]}static{this.rotWith=(e,n,i=0)=>{if(i===0)return e;const r=Math.sin(i),o=Math.cos(i),s=e[0]-n[0],a=e[1]-n[1],l=s*o-a*r,c=s*r+a*o;return[l+n[0],c+n[1]]}}static{this.isEqual=(e,n)=>e[0]===n[0]&&e[1]===n[1]}static{this.lrp=(e,n,i)=>te.add(e,te.mul(te.sub(n,e),i))}static{this.int=(e,n,i,r,o=1)=>{const s=(te.clamp(i,r)-i)/(r-i);return te.add(te.mul(e,1-s),te.mul(n,o))}}static{this.ang3=(e,n,i)=>{const r=te.vec(n,e),o=te.vec(n,i);return te.ang(r,o)}}static{this.abs=e=>[Math.abs(e[0]),Math.abs(e[1])]}static{this.rescale=(e,n)=>{const i=te.len(e);return[n*e[0]/i,n*e[1]/i]}}static{this.isLeft=(e,n,i)=>(n[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(n[1]-e[1])}static{this.clockwise=(e,n,i)=>te.isLeft(e,n,i)>0}static{this.toFixed=e=>e.map(n=>Math.round(n*100)/100)}static snap(e,n=1){return[Math.round(e[0]/n)*n,Math.round(e[1]/n)*n]}static{this.nearestPointOnLineThroughPoint=(e,n,i)=>te.add(e,te.mul(n,te.pry(te.sub(i,e),n)))}static{this.distanceToLineThroughPoint=(e,n,i)=>te.dist(i,te.nearestPointOnLineThroughPoint(e,n,i))}static{this.nearestPointOnLineSegment=(e,n,i,r=!0)=>{const o=te.uni(te.sub(n,e)),s=te.add(e,te.mul(o,te.pry(te.sub(i,e),o)));if(r){if(s[0]<Math.min(e[0],n[0]))return e[0]<n[0]?e:n;if(s[0]>Math.max(e[0],n[0]))return e[0]>n[0]?e:n;if(s[1]<Math.min(e[1],n[1]))return e[1]<n[1]?e:n;if(s[1]>Math.max(e[1],n[1]))return e[1]>n[1]?e:n}return s}}static{this.distanceToLineSegment=(e,n,i,r=!0)=>te.dist(i,te.nearestPointOnLineSegment(e,n,i,r))}static{this.nearestPointOnBounds=(e,n)=>[te.clamp(n[0],e.minX,e.maxX),te.clamp(n[1],e.minY,e.maxY)]}static{this.distanceToBounds=(e,n)=>te.dist(n,te.nearestPointOnBounds(e,n))}static{this.nudge=(e,n,i)=>te.isEqual(e,n)?e:te.add(e,te.mul(te.uni(te.sub(n,e)),i))}static{this.nudgeAtAngle=(e,n,i)=>[Math.cos(n)*i+e[0],Math.sin(n)*i+e[1]]}static{this.toPrecision=(e,n=4)=>[+e[0].toPrecision(n),+e[1].toPrecision(n)]}static{this.pointsBetween=(e,n,i=6)=>Array.from(Array(i)).map((r,o)=>{const s=o/(i-1),a=Math.min(1,.5+Math.abs(.5-s));return[...te.lrp(e,n,s),a]})}static{this.pointOffset=(e,n,i)=>{let r=te.uni(te.sub(n,e));return te.isEqual(e,n)&&(r=e),te.add(e,te.mul(r,i))}}static{this.slope=(e,n)=>e[0]===n[0]?NaN:(e[1]-n[1])/(e[0]-n[0])}static{this.max=(...e)=>[Math.max(...e.map(n=>n[0])),Math.max(...e.map(n=>n[1]))]}static{this.min=(...e)=>[Math.min(...e.map(n=>n[0])),Math.min(...e.map(n=>n[1]))]}static{this.toVec=e=>[e.x,e.y]}static{this.toPoint=e=>({x:e[0],y:e[1]})}}class En extends Array{constructor(e=[0,0],n=[0,0],i=[0,0],r=[0,0]){super(2),this._tangent=[0,0],this._in=[0,0],this._out=[0,0],this[0]=e[0],this[1]=e[1],this._tangent=n,this._in=i,this._out=r}static fromVec(e){const n=new En;return n[0]=e[0],n[1]=e[1],n}setVec(e){return this[0]=e[0],this[1]=e[1],this}get tangent(){return this._tangent}set tangent(e){this._tangent=e}get in(){return this._in}get absIn(){return te.add(this,this._in)}set in(e){this._in=e}get out(){return this._out}get absOut(){return te.add(this,this._out)}set out(e){this._out=e}clone(){return new En(this,this._tangent,this._in,this._out)}}const Hh=1e-12,bD=112e-18,mk=1e-8;function Zy(t){return t*t}function H4(t,e){return Zy(t[0]-e[0])+Zy(t[1]-e[1])}function vD(t,e,n){const i=H4(e,n);if(i==0)return H4(t,e);let r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return r=Math.max(0,Math.min(1,r)),H4(t,[e[0]+r*(n[0]-e[0]),e[1]+r*(n[1]-e[1])])}function yD(t,e,n){return Math.sqrt(vD(t,e,n))}function wD(t,e,n){return t.x<=e&&e<=t.x+t.w&&t.y<=n&&n<=t.y+t.h}function x7(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}function xt(t,e,n=1e-4){return Math.abs(t-e)<n}function cf(t){return t.every(e=>ih(e))}function ih(t){return t>=-Hh&&t<=Hh}function Zr(t,e,n){return Math.max(e,typeof n<"u"?Math.min(t,n):t)}function df(t,e,n,i,r=0){const o=Math.cos(r),s=Math.sin(r),a=te.sub(t,e),l=o*a[0]+s*a[1],c=s*a[0]-o*a[1];return l*l/(n*n)+c*c/(i*i)<=1}function jl(t,e){let n=0;return e.forEach((i,r)=>{const o=e[(r+1)%e.length];i[1]<=t[1]?o[1]>t[1]&&te.cross(i,o,t)>0&&(n+=1):o[1]<=t[1]&&te.cross(i,o,t)<0&&(n-=1)}),n!==0}function Lm(t,e,n){for(let i=0;i<e.length;++i){const r=i+1===e.length?0:i+1;if(yD(t,e[i],e[r])<=n)return!0}return!1}function Mm(t,e=0){let n=1/0,i=1/0,r=-1/0,o=-1/0;if(t.length<2)n=0,i=0,r=1,o=1;else for(const[s,a]of t)n=Math.min(s,n),i=Math.min(a,i),r=Math.max(s,r),o=Math.max(a,o);return e!==0?Mm(t.map(s=>te.rotWith(s,[(n+r)/2,(i+o)/2],e))):{minX:n,minY:i,maxX:r,maxY:o,width:Math.max(1,r-n),height:Math.max(1,o-i)}}function bk(t,e=!0){const n=t.length;if(n<4)return"";let i=t[0],r=t[1];const o=t[2];let s=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${r[0].toFixed(2)},${r[1].toFixed(2)} ${uf(r[0],o[0]).toFixed(2)},${uf(r[1],o[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)i=t[a],r=t[a+1],s+=`${uf(i[0],r[0]).toFixed(2)},${uf(i[1],r[1]).toFixed(2)} `;return e&&(s+="Z"),s}function uf(t,e){return(t+e)/2}function jr(t,e,n,i,r=!1){const o=te.sub(e,t),s=te.sub(i,n),a=te.cpr(o,s);if(xt(a,0,bD))return null;const l=te.sub(t,n);let c=te.cpr(s,l)/a;const d=te.cpr(o,l)/a,u=Hh,h=-u,p=1+u;return r||h<c&&c<p&&h<d&&d<p?(r||(c=Zr(c,0,1)),te.lrp(t,e,c)):null}function xD(t,e,n,i,r,o=0){t=te.rot(te.sub(t,n),-o),e=te.rot(te.sub(e,n),-o),i*=i,r*=r;const s=[],a=te.sub(e,t),l=i*a[1]*a[1]+r*a[0]*a[0],c=2*(i*t[1]*a[1]+r*t[0]*a[0]),d=i*t[1]*t[1]+r*t[0]*t[0]-i*r,u=c*c-4*l*d;if(u>=0){const h=Math.sqrt(u),p=(-c+h)/(2*l),g=(-c-h)/(2*l);0<=p&&p<=1&&s.push(te.add(te.rot(te.add(te.mul(a,p),t),o),n)),0<=g&&g<=1&&Math.abs(p-g)>1e-16&&s.push(te.add(te.rot(te.add(te.mul(a,g),t),o),n))}return s.length===0?null:s.map(h=>{const p=new En(h),g=te.uni(te.divV(te.sub(h,n),[i*i,r*r]));return p.tangent=[-g[1],g[0]],p})}function Co(t,e,n){const i=[],r=n.length;for(let o=0;o<r;o++){const s=n[o],a=n[(o+1)%r],l=jr(t,e,s,a);if(l){const c=new En(l);c.tangent=te.normalize(te.sub(a,s)),i.push(c)}}return i.length?i:null}function zd(t,e){const n=t.length;let i=[],r=1/0;for(let o=0;o<n;o++){const s=t[o],a=t[(o+1)%n],l=te.nearestPointOnLineSegment(s,a,e,!0),c=te.dist(l,e);c<r&&(r=c,i=l)}return i}function Jp(t,e){const n=t.length;for(let i=0;i<n;i++){const r=t[i],o=t[(i+1)%n];if(_D(e,[r,o]))return te.normalize(te.sub(o,r))}return[0,0]}function _D(t,e){const[n,i]=e,r=te.sub(t,n),o=te.sub(t,i);return xt(te.cpr(r,o),0,.01)&&te.dpr(r,o)<=0}function CD(t,e,n){const i=[],r=n.length;for(let o=0;o<r-1;o++){const s=n[o],a=n[o+1],l=jr(t,e,s,a);l&&i.push(new En(l,te.normalize(te.sub(a,s))))}return i.length?i:null}function _7(t,e){const n=t.length;let i=[],r=1/0;for(let o=0;o<n-1;o++){const s=t[o],a=t[o+1],l=te.nearestPointOnLineSegment(s,a,e,!0),c=te.dist(l,e);c<r&&(r=c,i=l)}return i}function hf(t){return t>0?1:-1}function C7(t,e){const{x:n,y:i,w:r,h:o,rotate:s}=t;if(!s)return e;const a=n+r/2,l=i+o/2,c=new DOMMatrix().translateSelf(a,l).rotateSelf(s).translateSelf(-a,-l),d=new DOMPoint(...e).matrixTransform(c);return[d.x,d.y]}function bi(t,e,n){const i=vr(n);return t.map(r=>te.add(e,te.rot(te.sub(r,e),i)))}function kD(t,e,n){const i=vr(n);return te.add(e,te.rot(te.sub(t,e),i))}function Bt(t,e=({x:n,y:i,w:r,h:o})=>[[n,i],[n+r,i],[n+r,i+o],[n,i+o]]){const{rotate:n}=t;let i=e(t);if(n){const{x:r,y:o,w:s,h:a}=t,l=r+s/2,c=o+a/2,d=new DOMMatrix().translateSelf(l,c).rotateSelf(n).translateSelf(-l,-c);i=i.map(u=>{const{x:h,y:p}=new DOMPoint(...u).matrixTransform(d);return[h,p]})}return i}function Og(t){const{x:e,y:n,w:i,h:r,rotate:o}=t,s=new DOMRect(e,n,i,r);return o?new DOMQuad(...Bt(t).map(a=>new DOMPoint(...a))).getBounds():s}function ks(t){const{x:e,y:n,width:i,height:r}=Og(t);return{x:e,y:n,w:i,h:r}}function e0(t){return t<0&&(t+=360),t%=360,t}function vr(t){return t*Math.PI/180}function ED(t){return t*180/Math.PI}function vh(t,e,n,i=!0){const r=i?(o,s)=>o<s:(o,s)=>o<=s;return!(r(Math.max(t[0][n],t[1][n]),Math.min(e[0][n],e[1][n]))||r(Math.max(e[0][n],e[1][n]),Math.min(t[0][n],t[1][n])))}function Pm(t,e){const{x:n,y:i,w:r,h:o,rotate:s}=t,a=n+r/2,l=i+o/2,c=r*e,d=o*e;return{x:a-c/2,y:l-d/2,w:c,h:d,rotate:s}}const pf=(t,e,n,i)=>{const r=n-t,o=i-e;return Math.hypot(r,o)};function SD(t,e,n,i,r){let o,s;if(n===0)o=i[0]-t.x,s=i[1]-t.y;else{const{minX:d,minY:u,maxX:h,maxY:p}=t,g=kD(i,[d+(h-d)/2,u+(p-u)/2],-n);o=g[0]-t.x,s=g[1]-t.y}let[a,l]=e,c;if(pf(a[0],a[1],o,s)<r||pf(l[0],l[1],o,s)<r)return!0;for(let d=0;d<e.length;d++){const u=[l[0]-a[0],l[1]-a[1]],h=Math.hypot(u[1],u[0]),p=[u[0]/h,u[1]/h],g=[o-a[0],s-a[1]],f=(g[0]*p[0]+g[1]*p[1])/Math.hypot(p[1],p[0]);c=[a[0]+p[0]*f,a[1]+p[1]*f];const v=pf(c[0],c[1],a[0],a[1]),m=pf(c[0],c[1],l[0],l[1]);if(c=m<v&&v>h?l:v<m&&m>h?a:c,Math.hypot(s-c[1],o-c[0])<r)return!0;a=l,l=e[d+1]}return!1}function wo(t,e,n,i){return`[${t},${e},${n},${i}]`}function Wn(t){return JSON.parse(t)}class ne{constructor(e=0,n=0,i=0,r=0){this.x=e,this.y=n,this.w=i,this.h=r}static fromXYWH(e){return new ne(e[0],e[1],e[2],e[3])}static from(e){return new ne(e.x,e.y,e.w,e.h)}static fromDOMRect({left:e,top:n,width:i,height:r}){return new ne(e,n,i,r)}static fromPoints(e){const{minX:n,minY:i,maxX:r,maxY:o}=Mm(e);return new ne(n,i,r-n,o-i)}static fromCenter(e,n,i){const[r,o]=e;return new ne(r-n/2,o-i/2,n,i)}get points(){return[[this.x,this.y],[this.x+this.w,this.y],[this.x+this.w,this.y+this.h],[this.x,this.y+this.h]]}get midPoints(){return[[this.x+this.w/2,this.y],[this.x+this.w,this.y+this.h/2],[this.x+this.w/2,this.y+this.h],[this.x,this.y+this.h/2]]}get center(){return[this.x+this.w/2,this.y+this.h/2]}get minX(){return this.x}get minY(){return this.y}get maxX(){return this.x+this.w}get maxY(){return this.y+this.h}get tl(){return[this.x,this.y]}get tr(){return[this.x+this.w,this.y]}get bl(){return[this.x,this.y+this.h]}get br(){return[this.x+this.w,this.y+this.h]}get verticalLine(){return[[this.x+this.w/2,this.y],[this.x+this.w/2,this.y+this.h]]}get horizontalLine(){return[[this.x,this.y+this.h/2],[this.x+this.w,this.y+this.h/2]]}get upperLine(){return[[this.x,this.y],[this.x+this.w,this.y]]}get lowerLine(){return[[this.x,this.y+this.h],[this.x+this.w,this.y+this.h]]}get leftLine(){return[[this.x,this.y],[this.x,this.y+this.h]]}get rightLine(){return[[this.x+this.w,this.y],[this.x+this.w,this.y+this.h]]}containsPoint([e,n]){const{minX:i,minY:r,maxX:o,maxY:s}=this;return i<=e&&e<=o&&r<=n&&n<=s}intersectLine(e,n,i=!1){const r=[];return[[this.tl,this.tr],[this.tl,this.bl],[this.tr,this.br],[this.bl,this.br]].forEach(([o,s])=>{const a=jr(e,n,o,s,i);a&&r.push(a)}),r.length===0?null:r}isIntersectWithBound(e,n=Hh){return e.maxX>this.minX-n&&e.maxY>this.minY-n&&e.minX<this.maxX+n&&e.minY<this.maxY+n&&!this.contains(e)&&!e.contains(this)}isOverlapWithBound(e,n=Hh){return e.maxX>this.minX-n&&e.maxY>this.minY-n&&e.minX<this.maxX+n&&e.minY<this.maxY+n}unite(e){const n=Math.min(this.x,e.x),i=Math.min(this.y,e.y),r=Math.max(this.maxX,e.maxX),o=Math.max(this.maxY,e.maxY);return new ne(n,i,r-n,o-i)}include(e){const n=Math.min(this.x,e[0]),i=Math.min(this.y,e[1]),r=Math.max(this.maxX,e[0]),o=Math.max(this.maxY,e[1]);return new ne(n,i,r-n,o-i)}getRelativePoint([e,n]){return[this.x+e*this.w,this.y+n*this.h]}toRelative([e,n]){return[(e-this.x)/this.w,(n-this.y)/this.h]}serialize(){return wo(this.x,this.y,this.w,this.h)}clone(){return new ne(this.x,this.y,this.w,this.h)}isHorizontalCross(e){return!(this.maxY<e.minY||this.minY>e.maxY)}isVerticalCross(e){return!(this.maxX<e.minX||this.minX>e.maxX)}horizontalDistance(e){return Math.min(Math.abs(this.minX-e.maxX),Math.abs(this.maxX-e.minX))}verticalDistance(e){return Math.min(Math.abs(this.minY-e.maxY),Math.abs(this.maxY-e.minY))}expand(e,n=e,i=e,r=n){return new ne(this.x-e,this.y-n,this.w+e+i,this.h+n+r)}isPointInBound([e,n],i=.01){return e>this.minX+i&&e<this.maxX-i&&n>this.minY+i&&n<this.maxY-i}isPointNearBound([e,n],i=.01){return Math.abs(e-this.minX)<i||Math.abs(e-this.maxX)<i||Math.abs(n-this.minY)<i||Math.abs(n-this.maxY)<i}contains(e){return e.x>=this.x&&e.y>=this.y&&e.maxX<=this.maxX&&e.maxY<=this.maxY}getVerticesAndMidpoints(){return[...this.points,...this.midPoints]}static deserialize(e){const[n,i,r,o]=Wn(e);return new ne(n,i,r,o)}}function TD(t,e){const n=Math.min(t.x,e.x),i=Math.min(t.y,e.y),r=Math.max(t.x+t.w,e.x+e.w),o=Math.max(t.y+t.h,e.y+e.h),s=Math.abs(r-n),a=Math.abs(o-i);return{x:n,y:i,w:s,h:a}}function U1(t){if(!t.length)return null;if(t.length===1){const{x:n,y:i,w:r,h:o}=t[0];return new ne(n,i,r,o)}let e=t[0];for(let n=1;n<t.length;n++)e=TD(e,t[n]);return new ne(e.x,e.y,e.w,e.h)}function k7(t){const{minX:e,minY:n,width:i,height:r}=Mm(t);return new ne(e,n,i,r)}function E7(t,e){const n=e/2,i=new ne(t.x-n,t.y-n,t.w+e,t.h+e);if(i.w<=0||i.h<=0)throw new Error("Invalid delta range or bound size.");return i}function vk(t,e,n,i,r){const o=n*2,s=r*2,a=Math.max(e.w-o,1),l=Math.max(e.h-o,1),c=Math.max(i.w-s,1),d=Math.max(i.h-s,1);return{points:t.map(h=>({...h,x:c*((h.x-n)/a)+r,y:d*((h.y-n)/l)+r})),bound:new ne(i.x,i.y,c+s,d+s)}}const ko={skip:!1,creating:!1,derive:!1};function Wy(t,e){ko.skip=e,ko.creating=t}function Xe(t){return function(n,i){const r=n._yProps??new Set;n._yProps=r,r.add(i),Object.defineProperty(n,i,{get(){return this.yMap.get(i)??this._preserved.get(i)??t},set(o){if(ko.skip)return;const s=$m(n,i,o,this),a=ko.creating?o:Dm(n,i,o,this);this.yMap&&(this.yMap.doc?this.surface.page.transact(()=>{this.yMap.set(i,a)}):this.yMap.set(i,a)),this.yMap.doc||this._preserved.set(i,a),xk(n,i,this),Bm(s,this)}})}}function Go(){return function(e,n){const i=e._localProps??new Set;e._localProps=i,i.add(n),Object.defineProperty(e,n,{get(){return this._local.get(n)},set(r){const o=this._local.get(n),s=ko.creating?r:Dm(e,n,r,this),a=$m(e,n,r,this);this._local.set(n,s),!ko.creating&&(Bm(a,this),this._onChange({props:{[n]:s},oldValues:{[n]:o}}))}})}}const yk=Symbol("derive");function Am(t,e,n,i){e[t]=e[t]??{},e[t][n]=i}function $m(t,e,n,i){if(ko.derive||ko.creating)return null;const r=ID(t,e);return r?r(n,i):null}function Bm(t,e){t&&(ko.derive=!0,A2(t).forEach(n=>{e[n]=t[n]}),ko.derive=!1)}function ID(t,e){return t[yk]?.[e]??null}function Rg(t){return function(n,i){Am(yk,n,i,t)}}const wk=Symbol("convert");function LD(t){return function(n,i){Am(wk,n,i,t)}}function MD(t,e){return t[wk]?.[e]??null}function Dm(t,e,n,i){const r=MD(t,e);return r?r(n,i):n}const Om=Symbol("observe");function PD(t){return function(n,i){Am(Om,n,i,t)}}function AD(t,e){return t[Om]?.[e]??null}function xk(t,e,n){const i=AD(t,e),r=n._observerDisposable??{};if(r[e]&&(r[e](),delete r[e]),i){const o=n[e];i(null,n,"altered");try{const s=a=>{i(a,n,"modified")};o.observe(s),n._observerDisposable[e]=()=>{o.unobserve(s)}}catch{throw new Error(`Failed to observe "${e.toString()}" of ${n.type} element, make sure it's a Y type.`)}}}function $D(t,e){const n=t[Om]??{};Object.keys(n).forEach(i=>{xk(t,i,e)})}var BD=Object.defineProperty,DD=Object.getOwnPropertyDescriptor,t0=(t,e,n,i)=>{for(var r=i>1?void 0:i?DD(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&BD(e,n,r),r};class Ni{constructor(e){this._preserved=new Map,this._local=new Map,this._observerDisposable={},this.display=!0,this.opacity=1,this.externalXYWH=void 0;const{yMap:n,model:i,stashedStore:r,onChange:o}=e;this.yMap=n,this.surface=i,this._stashed=r,this._onChange=o,this.index="a0",this.seed=gk()}static propsToY(e){return e}get externalBound(){return this.externalXYWH?ne.deserialize(this.externalXYWH):null}get connectable(){return!0}get deserializedXYWH(){return Wn(this.xywh)}get x(){return this.deserializedXYWH[0]}get y(){return this.deserializedXYWH[1]}get w(){return this.deserializedXYWH[2]}get h(){return this.deserializedXYWH[3]}get group(){return this.surface.getGroup(this.id)}get groups(){return this.surface.getGroups(this.id)}get id(){return this.yMap.get("id")}get elementBound(){return this.rotate?ne.from(ks(this)):ne.deserialize(this.xywh)}stash(e){if(this._stashed.has(e))return;const n=this[e],i=Object.getPrototypeOf(this);this._stashed.set(e,n),Object.defineProperty(this,e,{configurable:!0,enumerable:!0,get:()=>this._stashed.get(e),set:r=>{const o=Dm(i,e,r,this),s=this._stashed.get(e),a=$m(i,e,r,this);this._stashed.set(e,o),this._onChange({props:{[e]:o},oldValues:{[e]:s}}),Bm(a,this)}})}pop(e){if(!this._stashed.has(e))return;const n=this._stashed.get(e);this._stashed.delete(e),delete this[e],this._yProps?.has(e)?this.surface.page.transact(()=>{this.yMap.set(e,n)}):this._localProps?.has(e)?this._local.set(e,n):console.warn("pop a prop that is not yfield or local:",e)}containedByBounds(e){return Bt(this).some(n=>e.containsPoint(n))}getNearestPoint(e){const n=Bt(this);return zd(n,e)}intersectWithLine(e,n){const i=Bt(this);return Co(e,n,i)}getRelativePointLocation(e){const n=ne.deserialize(this.xywh),i=n.getRelativePoint(e),r=bi([i],n.center,this.rotate)[0],o=bi(n.points,n.center,this.rotate),s=Jp(o,r);return new En(r,s)}boxSelect(e){return this.containedByBounds(e)||e.points.some((n,i,r)=>this.intersectWithLine(n,r[(i+1)%r.length]))}hitTest(e,n,i,r){return this.elementBound.isPointInBound([e,n])}serialize(){return this.yMap.toJSON()}}t0([Xe()],Ni.prototype,"index",2);t0([Xe()],Ni.prototype,"seed",2);t0([Go()],Ni.prototype,"display",2);t0([Go()],Ni.prototype,"opacity",2);t0([Go()],Ni.prototype,"externalXYWH",2);var OD=Object.defineProperty,RD=Object.getOwnPropertyDescriptor,n0=(t,e,n,i)=>{for(var r=i>1?void 0:i?RD(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&OD(e,n,r),r};class Ec extends Ni{constructor(){super(...arguments),this.points=[],this.xywh="[0,0,0,0]",this.rotate=0,this.color="#000000",this.lineWidth=4}static propsToY(e){return e}get connectable(){return!1}get type(){return"brush"}hitTest(e,n,i){return SD(ne.deserialize(this.xywh),this.points,this.rotate,[e,n],(i?.expand??10)/Math.min(i?.zoom??1,1))}containedByBounds(e){return Bt(this).some(i=>e.containsPoint(i))}getNearestPoint(e){const{x:n,y:i}=this;return _7(this.points.map(r=>te.add(r,[n,i])),e)}intersectWithLine(e,n){const i=[this.x,this.y],r=Bt(this,s=>this.points.map(a=>te.add(a,i))),o=ne.fromDOMRect(Og(this));if(o.w<8&&o.h<8)return te.distanceToLineSegment(e,n,o.center)<5?[]:null;if(o.intersectLine(e,n,!0)){const s=r.length;for(let a=1;a<s;a++){const l=jr(e,n,r[a-1],r[a]);if(l)return[new En(l,te.normalize(te.sub(r[a],r[a-1])))]}}return null}getRelativePointLocation(e){const n=ne.deserialize(this.xywh).getRelativePoint(e);return new En(n)}}n0([Rg((t,e)=>{const n=e.lineWidth,i=k7(t);return{xywh:E7(i,n).serialize()}}),LD((t,e)=>{const n=e.lineWidth,i=k7(t),r=E7(i,n);return t.map(([s,a])=>[s-r.x,a-r.y])}),Xe()],Ec.prototype,"points",2);n0([Rg((t,e)=>{const n=ne.deserialize(t),{lineWidth:i}=e;return{points:vk(e.points.map(([o,s])=>({x:o,y:s})),e,i/2,n,i/2).points.map(o=>[o.x,o.y])}}),Xe()],Ec.prototype,"xywh",2);n0([Xe()],Ec.prototype,"rotate",2);n0([Xe()],Ec.prototype,"color",2);n0([Rg((t,e)=>{if(t===e.lineWidth)return{};const n=e.elementBound,i=e.points,r=vk(i.map(([o,s])=>({x:o,y:s})),n,t/2,E7(n,t-e.lineWidth),t/2);return{points:r.points.map(o=>[o.x,o.y]),xywh:r.bound.serialize()}}),Xe()],Ec.prototype,"lineWidth",2);const ND=6,_k=.1,t2=.25,qy=1,HD=3e3,FD=10,UD=50,Rm=1.4,VD=.3;var dn=(t=>(t.General="General",t.Scribbled="Scribbled",t))(dn||{}),Yt=(t=>(t.Solid="solid",t.Dashed="dash",t.None="none",t))(Yt||{}),wt=(t=>(t.Inter="blocksuite:surface:Inter",t.Kalam="blocksuite:surface:Kalam",t.Satoshi="blocksuite:surface:Satoshi",t.Poppins="blocksuite:surface:Poppins",t.Lora="blocksuite:surface:Lora",t.BebasNeue="blocksuite:surface:BebasNeue",t.OrelegaOne="blocksuite:surface:OrelegaOne",t))(wt||{});const zD=Object.values(wt);var us=(t=>(t.Light="300",t.Regular="400",t.SemiBold="600",t))(us||{}),ti=(t=>(t.Normal="normal",t.Italic="italic",t))(ti||{});const jD=[{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-Light-BETA.woff",weight:"300",style:"normal"},{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-SemiBold.woff",weight:"600",style:"normal"},{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-LightItalic-BETA.woff",weight:"300",style:"italic"},{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-Italic.woff",weight:"400",style:"italic"},{font:"blocksuite:surface:Inter",url:"https://cdn.affine.pro/fonts/Inter-SemiBoldItalic.woff",weight:"600",style:"italic"},{font:"blocksuite:surface:Kalam",url:"https://cdn.affine.pro/fonts/Kalam-Light.woff",weight:"300",style:"normal"},{font:"blocksuite:surface:Kalam",url:"https://cdn.affine.pro/fonts/Kalam-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:Kalam",url:"https://cdn.affine.pro/fonts/Kalam-Bold.woff",weight:"600",style:"normal"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-Light.woff",weight:"300",style:"normal"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-Bold.woff",weight:"600",style:"normal"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-LightItalic.woff",weight:"300",style:"italic"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-Italic.woff",weight:"400",style:"italic"},{font:"blocksuite:surface:Satoshi",url:"https://cdn.affine.pro/fonts/Satoshi-BoldItalic.woff",weight:"600",style:"italic"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-Light.woff",weight:"300",style:"normal"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-SemiBold.woff",weight:"600",style:"normal"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-LightItalic.woff",weight:"300",style:"italic"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-Italic.woff",weight:"400",style:"italic"},{font:"blocksuite:surface:Poppins",url:"https://cdn.affine.pro/fonts/Poppins-SemiBoldItalic.woff",weight:"600",style:"italic"},{font:"blocksuite:surface:Lora",url:"https://cdn.affine.pro/fonts/Lora-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:Lora",url:"https://cdn.affine.pro/fonts/Lora-Bold.woff",weight:"600",style:"normal"},{font:"blocksuite:surface:Lora",url:"https://cdn.affine.pro/fonts/Lora-Italic.woff",weight:"400",style:"italic"},{font:"blocksuite:surface:Lora",url:"https://cdn.affine.pro/fonts/Lora-BoldItalic.woff",weight:"600",style:"italic"},{font:"blocksuite:surface:BebasNeue",url:"https://cdn.affine.pro/fonts/BebasNeue%20Light.woff",weight:"300",style:"normal"},{font:"blocksuite:surface:BebasNeue",url:"https://cdn.affine.pro/fonts/BebasNeue-Regular.woff",weight:"400",style:"normal"},{font:"blocksuite:surface:OrelegaOne",url:"https://cdn.affine.pro/fonts/OrelegaOne-Regular.woff",weight:"400",style:"normal"}];function Ck(t,e,n,i){if(e==null||e<0||e>1)return null;const r=t[0][0],o=t[0][1],s=t[3][0],a=t[3][1];let l=t[1][0],c=t[1][1],d=t[2][0],u=t[2][1];ih(l-r)&&ih(c-o)&&(l=r,c=o),ih(d-s)&&ih(u-a)&&(d=s,u=a);const h=3*(l-r),p=3*(d-l)-h,g=s-r-h-p,f=3*(c-o),v=3*(u-c)-f,m=a-o-f-v;let y,x;if(n===0)y=e===0?r:e===1?s:((g*e+p)*e+h)*e+r,x=e===0?o:e===1?a:((m*e+v)*e+f)*e+o;else{const T=mk,M=1-T;if(e<T?(y=h,x=f):e>M?(y=3*(s-d),x=3*(a-u)):(y=(3*g*e+2*p)*e+h,x=(3*m*e+2*v)*e+f),i){y===0&&x===0&&(e<T||e>M)&&(y=d-l,x=u-c);const k=Math.sqrt(y*y+x*x);k&&(y/=k,x/=k)}if(n===3){const k=6*g*e+2*p,_=6*m*e+2*v,A=Math.pow(y*y+x*x,3/2);y=A!==0?(y*_-x*k)/A:0,x=0}}return n===2?[x,-y]:[y,x]}function kk(t,e){return Ck(t,e,0,!1)}function Yy(t,e){return Ck(t,e,1,!0)}function GD(t,e){let i=1/0,r=0;function o(a){if(a>=0&&a<=1){const l=kk(t,a);D(l);const c=te.dist2(e,l);if(c<i)return i=c,r=a,!0}return!1}for(let a=0;a<=100;a++)o(a/100);let s=1/(100*2);for(;s>mk;)!o(r-s)&&!o(r+s)&&(s/=2);return r}function ZD(t,e){const n=GD(t,e),i=kk(t,n);return D(i),i}function Nm(t){return[t[0],t[0].absOut,t[1].absIn,t[1]]}var WD=Object.defineProperty,qD=Object.getOwnPropertyDescriptor,ji=(t,e,n,i)=>{for(var r=i>1?void 0:i?qD(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&WD(e,n,r),r},Hl=(t=>(t[t.Straight=0]="Straight",t[t.Orthogonal=1]="Orthogonal",t[t.Curve=2]="Curve",t))(Hl||{});class Ft extends Ni{constructor(){super(...arguments),this.updatingPath=!1,this.path=[],this.absolutePath=[],this.xywh="[0,0,0,0]",this.rotate=0,this.mode=1,this.strokeWidth=4,this.stroke="#000000",this.strokeStyle="solid",this.roughness=Rm,this.source={position:[0,0]},this.target={position:[0,0]}}get type(){return"connector"}get connectable(){return!1}moveTo(e){const n=ne.deserialize(this.xywh),i=te.sub([e.x,e.y],[n.x,n.y]),{source:r,target:o}=this;!r.id&&r.position&&(this.source={position:te.add(r.position,i)}),!o.id&&o.position&&(this.target={position:te.add(o.position,i)})}hitTest(e,n,i){const r=this.mode===2?ZD(Nm(this.absolutePath),[e,n]):_7(this.absolutePath,[e,n]);return te.dist(r,[e,n])<(i?.expand?this.strokeWidth/2:0)+8}containedByBounds(e){return this.absolutePath.some(n=>e.containsPoint(n))}getNearestPoint(e){return _7(this.absolutePath,e)}intersectWithLine(e,n){return CD(e,n,this.absolutePath)}getRelativePointLocation(e){return new En(ne.deserialize(this.xywh).getRelativePoint(e))}serialize(){const e=super.serialize();return e.xywh=this.xywh,e}}ji([Rg((t,e)=>{const{x:n,y:i}=e;return{absolutePath:t.map(r=>r.clone().setVec([r[0]+n,r[1]+i]))}}),Go()],Ft.prototype,"path",2);ji([Go()],Ft.prototype,"absolutePath",2);ji([Go()],Ft.prototype,"xywh",2);ji([Go()],Ft.prototype,"rotate",2);ji([Xe()],Ft.prototype,"mode",2);ji([Xe()],Ft.prototype,"strokeWidth",2);ji([Xe()],Ft.prototype,"stroke",2);ji([Xe()],Ft.prototype,"strokeStyle",2);ji([Xe()],Ft.prototype,"roughness",2);ji([Xe()],Ft.prototype,"rough",2);ji([Xe()],Ft.prototype,"source",2);ji([Xe()],Ft.prototype,"target",2);ji([Xe("None")],Ft.prototype,"frontEndpointStyle",2);ji([Xe("Arrow")],Ft.prototype,"rearEndpointStyle",2);var YD=Object.defineProperty,XD=Object.getOwnPropertyDescriptor,Ng=(t,e,n,i)=>{for(var r=i>1?void 0:i?XD(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&YD(e,n,r),r};const i0=class Ek extends Ni{constructor(){super(...arguments),this.children=new nt.Y.Map,this.title=new nt.Y.Text,this.showTitle=!0,this.childIds=[]}static propsToY(e){if(e.title&&!(e.title instanceof nt.Y.Text)&&(e.title=new nt.Y.Text(e.title)),e.children&&!(e.children instanceof nt.Y.Map)){const n=new nt.Y.Map;A2(e.children).forEach(i=>{n.set(i,!0)}),e.children=n}return e}get xywh(){const e=this.childElements;return e.length===0?"[0,0,0,0]":e.slice(1).reduce((i,r)=>i.unite(r.elementBound),e[0].elementBound).serialize()}set xywh(e){}get rotate(){return 0}set rotate(e){}get connectable(){return!1}get type(){return"group"}get childElements(){const e=[],n=this.children.keys();for(const i of n){const r=this.surface.getElementById(i)||this.surface.page.getBlockById(i);r&&e.push(r)}return e}hasDescendant(e){return(typeof e=="string"?this.surface.getGroups(e):this.surface.getGroups(e.id)).some(i=>i.id===this.id)}addChild(e){const n=typeof e=="string"?e:e.id;this.surface.page.transact(()=>{this.children.set(n,!0)})}removeChild(e){const n=typeof e=="string"?e:e.id;this.surface.page.transact(()=>{this.children.delete(n)})}decendants(e=!0){return this.childElements.reduce((n,i)=>(i instanceof Ek?(n=n.concat(i.decendants()),!e&&n.push(i)):n.push(i),n),[])}containedByBounds(e){return e.contains(ne.deserialize(this.xywh))}intersectWithLine(e,n){const i=ne.deserialize(this.xywh);return Co(e,n,i.points)}};Ng([PD((t,e)=>{e.childIds=Array.from(e.children.keys())}),Xe()],i0.prototype,"children",2);Ng([Xe()],i0.prototype,"title",2);Ng([Go()],i0.prototype,"showTitle",2);Ng([Go()],i0.prototype,"childIds",2);let On=i0;var r0=(t=>(t.Inter="blocksuite:surface:Inter",t.Kalam="blocksuite:surface:Kalam",t.Satoshi="blocksuite:surface:Satoshi",t.Poppins="blocksuite:surface:Poppins",t.Lora="blocksuite:surface:Lora",t.BebasNeue="blocksuite:surface:BebasNeue",t.OrelegaOne="blocksuite:surface:OrelegaOne",t))(r0||{}),ha=(t=>(t.Light="300",t.Regular="400",t.SemiBold="600",t))(ha||{});const $2=.3,Ml={points({x:t,y:e,w:n,h:i}){return[[t,e+i/2],[t+n/2,e],[t+n,e+i/2],[t+n/2,e+i]]},hitTest(t,e,n){const i=Bt(this,Ml.points);let r=Lm([t,e],i,(n?.expand??1)/(n.zoom??1));if(!r)if(!n.ignoreTransparent||this.filled)r=jl([t,e],i);else{const o=this.text;if(!o||!o.length){const s=Pm(this,$2),a=Bt(s,Ml.points);r=jl([t,e],a)}else r=this.externalBound?.isPointInBound([t,e])??!1}return r},containedByBounds(t,e){return Bt(e,Ml.points).some(i=>t.containsPoint(i))},getNearestPoint(t,e){const n=Bt(e,Ml.points);return zd(n,t)},intersectWithLine(t,e,n){const i=Bt(n,Ml.points);return Co(t,e,i)},getRelativePointLocation(t,e){const n=ne.deserialize(e.xywh),i=n.getRelativePoint(t);let r=Ml.points(n);r.push(i),r=bi(r,n.center,e.rotate);const o=r.pop(),s=Jp(r,o);return new En(o,s)}},Sk={points({x:t,y:e,w:n,h:i}){return[[t,e+i/2],[t+n/2,e],[t+n,e+i/2],[t+n/2,e+i]]},hitTest(t,e,n){const i=[t,e],r=(n?.expand??1)/(n?.zoom??1),o=this.w/2,s=this.h/2,a=[this.x+o,this.y+s],l=this.rotate*Math.PI/180;let c=df(i,a,o+r,s+r,l)&&!df(i,a,o-r,s-r,l);if(!c)if(!n.ignoreTransparent||this.filled)c=df(i,a,o,s,l);else{const d=this.text;if(!d||!d.length){const u=o*$2,h=s*$2;c=df(i,a,u,h,l)}else c=this.externalBound?.isPointInBound([t,e])??!1}return c},containedByBounds(t,e){return Bt(e,Sk.points).some(i=>t.containsPoint(i))},getNearestPoint(t,e){const n=ne.deserialize(e.xywh),i=1e3,r=.01,o=n.center[0],s=n.center[1],a=n.w/2,l=n.h/2;let c=(t[0]-o)/a,d=(t[1]-s)/l;for(let u=0;u<i;u++){const h=Math.sqrt(c*c+d*d),p=c/h,g=d/h,f=t[0]-(t[0]+c*a),v=t[1]-(t[1]+d*l),m=f*p*a+v*g*l;c-=r*m*p,d-=r*m*g;const y=Math.atan2(d,c);c=Math.cos(y),d=Math.sin(y)}return[o+c*a,s+d*l]},intersectWithLine(t,e,n){const i=n.rotate*Math.PI/180,r=ne.deserialize(n.xywh);return xD(t,e,r.center,r.w/2,r.h/2,i)},getRelativePointLocation(t,e){const n=ne.deserialize(e.xywh),i=n.getRelativePoint(t),r=n.w/2,o=n.h/2,s=te.uni(te.divV(te.sub(i,n.center),[r*r,o*o]));return new En(i,[-s[1],s[0]])}},KD={points({x:t,y:e,w:n,h:i}){return[[t,e],[t+n,e],[t+n,e+i],[t,e+i]]},hitTest(t,e,n){const i=Bt(this);let r=Lm([t,e],i,(n?.expand??1)/(n.zoom??1));if(!r)if(!n.ignoreTransparent||this.filled)r=jl([t,e],i);else{const o=this.text;if(!o||!o.length){const s=Pm(this,$2),a=Bt(s);r=jl([t,e],a)}else r=this.externalBound?.isPointInBound([t,e])??!1}return r},containedByBounds(t,e){return Bt(e).some(i=>t.containsPoint(i))},getNearestPoint(t,e){const n=Bt(e);return zd(n,t)},intersectWithLine(t,e,n){const i=Bt(n);return Co(t,e,i)},getRelativePointLocation(t,e){const n=ne.deserialize(e.xywh),i=n.getRelativePoint(t),r=bi([i],n.center,e.rotate??0)[0],o=bi(n.points,n.center,e.rotate??0),s=Jp(o,r);return new En(r,s)}},Pl={points({x:t,y:e,w:n,h:i}){return[[t,e+i],[t+n/2,e],[t+n,e+i]]},hitTest(t,e,n){const i=Bt(this,Pl.points);let r=Lm([t,e],i,(n?.expand??1)/(n?.zoom??1));if(!r)if(!n.ignoreTransparent||this.filled)r=jl([t,e],i);else{const o=this.text;if(!o||!o.length){const s=Pm(this,VD),a=Bt(s,Pl.points);r=jl([t,e],a)}else r=this.externalBound?.isPointInBound([t,e])??!1}return r},containedByBounds(t,e){return Bt(e,Pl.points).some(i=>t.containsPoint(i))},getNearestPoint(t,e){const n=Bt(e,Pl.points);return zd(n,t)},intersectWithLine(t,e,n){const i=Bt(n,Pl.points);return Co(t,e,i)},getRelativePointLocation(t,e){const n=ne.deserialize(e.xywh),i=n.getRelativePoint(t);let r=Pl.points(n);r.push(i),r=bi(r,n.center,e.rotate);const o=r.pop(),s=Jp(r,o);return new En(o,s)}};var QD=Object.defineProperty,JD=Object.getOwnPropertyDescriptor,fn=(t,e,n,i)=>{for(var r=i>1?void 0:i?JD(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&QD(e,n,r),r};const l1={rect:KD,triangle:Pl,ellipse:Sk,diamond:Ml};class Ct extends Ni{constructor(){super(...arguments),this.textDisplay=!0,this.xywh="[0,0,100,100]",this.rotate=0,this.shapeType="rect",this.radius=0,this.filled=!1,this.fillColor="--affine-palette-shape-yellow",this.strokeWidth=4,this.strokeColor="--affine-palette-line-yellow",this.strokeStyle="solid",this.shapeStyle="General",this.roughness=Rm}static propsToY(e){return e.text&&!(e.text instanceof nt.Y.Text)&&(e.text=new nt.Y.Text(e.text)),e}get type(){return"shape"}hitTest(e,n,i){return l1[this.shapeType].hitTest.call(this,e,n,i)}containedByBounds(e){return l1[this.shapeType].containedByBounds(e,this)}intersectWithLine(e,n){return l1[this.shapeType].intersectWithLine(e,n,this)}getNearestPoint(e){return l1[this.shapeType].getNearestPoint(e,this)}getRelativePointLocation(e){return l1[this.shapeType].getRelativePointLocation(e,this)}}fn([Go()],Ct.prototype,"textDisplay",2);fn([Xe()],Ct.prototype,"xywh",2);fn([Xe()],Ct.prototype,"rotate",2);fn([Xe()],Ct.prototype,"shapeType",2);fn([Xe()],Ct.prototype,"radius",2);fn([Xe()],Ct.prototype,"filled",2);fn([Xe()],Ct.prototype,"fillColor",2);fn([Xe()],Ct.prototype,"strokeWidth",2);fn([Xe()],Ct.prototype,"strokeColor",2);fn([Xe()],Ct.prototype,"strokeStyle",2);fn([Xe()],Ct.prototype,"shapeStyle",2);fn([Xe()],Ct.prototype,"roughness",2);fn([Xe()],Ct.prototype,"text",2);fn([Xe("#000000")],Ct.prototype,"color",2);fn([Xe(20)],Ct.prototype,"fontSize",2);fn([Xe(r0.Inter)],Ct.prototype,"fontFamily",2);fn([Xe(ha.Regular)],Ct.prototype,"fontWeight",2);fn([Xe("normal")],Ct.prototype,"fontStyle",2);fn([Xe("center")],Ct.prototype,"textAlign",2);fn([Xe("center")],Ct.prototype,"textHorizontalAlign",2);fn([Xe("center")],Ct.prototype,"textVerticalAlign",2);var eO=Object.defineProperty,tO=Object.getOwnPropertyDescriptor,Zo=(t,e,n,i)=>{for(var r=i>1?void 0:i?tO(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&eO(e,n,r),r};class vn extends Ni{constructor(){super(...arguments),this.xywh="[0,0,16,16]",this.rotate=0,this.text=new nt.Y.Text,this.color="#000000",this.fontSize=16,this.fontFamily=r0.Inter,this.fontWeight=ha.Regular,this.fontStyle="normal",this.textAlign="center"}static propsToY(e){return e.text&&!(e.text instanceof nt.Y.Text)&&(e.text=new nt.Y.Text(e.text)),e}get type(){return"text"}getNearestPoint(e){return zd(ne.deserialize(this.xywh).points,e)}containedByBounds(e){return Bt(this).some(i=>e.containsPoint(i))}intersectWithLine(e,n){const i=Bt(this);return Co(e,n,i)}hitTest(e,n){const i=Bt(this);return jl([e,n],i)}}Zo([Xe()],vn.prototype,"xywh",2);Zo([Xe()],vn.prototype,"rotate",2);Zo([Xe()],vn.prototype,"text",2);Zo([Xe()],vn.prototype,"color",2);Zo([Xe()],vn.prototype,"fontSize",2);Zo([Xe()],vn.prototype,"fontFamily",2);Zo([Xe()],vn.prototype,"fontWeight",2);Zo([Xe()],vn.prototype,"fontStyle",2);Zo([Xe()],vn.prototype,"textAlign",2);Zo([Xe()],vn.prototype,"hasMaxWidth",2);const Tk={group:On,connector:Ft,shape:Ct,brush:Ec,text:vn};function S7(t,e,n,i,r){const o=new Map,s=Tk[t];if(!s)throw new Error(`Invalid element type: ${n.get("type")}`);Wy(!0,r.skipFieldInit??!1);let a=!1;const l=new s({yMap:n,model:i,stashedStore:o,onChange:h=>a&&r.onChange({id:e,...h})});Wy(!1,!1);let c;return{model:l,mount:()=>{$D(s.prototype,l),c=nO(n,h=>{a&&r.onChange({id:e,...h})}),l._preserved.clear(),a=!0},unmount:()=>{a=!1,fk(l._observerDisposable??{}).forEach(h=>h()),c?.()}}}function nO(t,e){const n=i=>{const r={},o={};i.keysChanged.forEach(s=>{const a=i.changes.keys.get(s),l=i.changes.keys.get(s)?.oldValue;a&&(a.action==="update"||a.action==="add")&&(r[s]=t.get(s),o[s]=l)}),e({props:r,oldValues:o})};return t.observe(n),()=>{t.observe(n)}}function Ik(t,e){const n=Tk[t];if(!n)throw new Error(`Invalid element type: ${t}`);return(n.propsToY??Ni.propsToY)(e)}function iO(t,e,n){const{type:i,id:r,...o}=t;if(!r)throw new Error("Cannot find id in props");const s=new nt.Y.Map,a=S7(i,r,s,e,n);return t=Ik(i,t),s.set("type",i),s.set("id",r),Object.keys(o).forEach(l=>{a.model[l]=t[l]}),a}var kn=(t=>(t.SHAPE="shape",t.BRUSH="brush",t.CONNECTOR="connector",t.TEXT="text",t.GROUP="group",t))(kn||{}),Rt=(t=>(t[t.LINE_WIDTH_TWO=2]="LINE_WIDTH_TWO",t[t.LINE_WIDTH_FOUR=4]="LINE_WIDTH_FOUR",t[t.LINE_WIDTH_SIX=6]="LINE_WIDTH_SIX",t[t.LINE_WIDTH_EIGHT=8]="LINE_WIDTH_EIGHT",t[t.LINE_WIDTH_TEN=10]="LINE_WIDTH_TEN",t[t.LINE_WIDTH_TWELVE=12]="LINE_WIDTH_TWELVE",t[t.Thin=4]="Thin",t[t.Thick=10]="Thick",t))(Rt||{}),qe=(t=>(t.DocAndEdgeless="both",t.EdgelessOnly="edgeless",t.DocOnly="doc",t))(qe||{});function rO(t,e){if(!e.includes(t.flavour))throw new Error(`model flavour ${t.flavour} is not allowed`)}function Ie(t,e){return!!t&&e.includes(t.flavour)}function Hg(t,e,n){const i=t.getParent(e);return i===null?!1:n===i.flavour?!0:Hg(t,i,n)}const lr="data-block-id",oO=800,Fh=26,n2=24,sO=2,B2=53,At={horizontal:752,horizontalThin:752,list:752,vertical:364,cube:170,video:752,figma:752},bt={horizontal:116,horizontalThin:80,list:46,vertical:390,cube:114,video:544,figma:544},Hm="https://affine-worker.toeverything.workers.dev/api/worker/image-proxy",aO="https://affine-worker.toeverything.workers.dev/api/worker/link-preview";function lO(t,e,n=1e-4){return Math.abs(t-e)<n}function Es(t,e,n){return t<e?e:t>n?n:t}function Lk(t,e,n){return n=n-e,t=(t-e+n)%n,e+(Number.isNaN(t)?0:t)}function Gl(t,e=!0,n=1){const i=e?1e3:1024;if(Math.abs(t)<i)return t+" bytes";const r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=-1;const s=10**n;do t/=i,++o;while(Math.round(Math.abs(t)*s)/s>=i&&o<r.length-1);return t.toFixed(n)+" "+r[o]}const Fm=`[${lr}]`,cO=32,F4=cO/2/2;function D2(t,e,n={}){if(e.id in n)throw new Error("Can't get next block! There's a loop in the block tree!");n[e.id]=!0;const i=e.page;if(e.children.length)return e.children[0];let r=e;for(;r;){const o=i.getNextSibling(r);if(o)return Ie(o,["affine:note"])?ms(t)?null:D2(t,o):o;r=i.getParent(r)}return null}function dO(t,e){const n=o=>{const s=o.page.getParent(o);if(!s)return null;const a=s.children.indexOf(o);if(a>0){let l=s.children[a-1];for(;l.children.length>0;)l=l.children[l.children.length-1];return l}return ms(t)&&Ie(s,["affine:note"])?null:s},i={},r=o=>{if(o.id in i)throw new Error("Can't get previous block! There's a loop in the block tree!");i[o.id]=!0;const s=n(o);return s?s.role==="content"&&!Ie(s,["affine:frame"])?s:r(s):null};return r(e)}function qn(t){const e=[];let n=t;for(;n;)e.unshift(n.id),n=n.page.getParent(n);return e}function Mk(t,e){if(Ie(t,["affine:image","affine:frame"])){let n=t;const i=[];for(;n;)Ie(n,["affine:surface"])||i.unshift(n.id),n=n.page.getParent(n);return e.viewFromPath("block",i)}else return e.viewFromPath("block",qn(t))}function gs(t){const e=Pk(t);if(e)return e;const n=Um(t);return n||null}function V1(t){return en(t)?Ak(t):ms(t)?$k(t):null}function Pk(t){return t.closest("affine-doc-page")}function Ak(t){return t.querySelector("affine-doc-page")}function Um(t){return t.closest("affine-edgeless-page")}function $k(t){return t.querySelector("affine-edgeless-page")}function uO(t){const e=t.closest("affine-editor-container");return D(e),e}function en(t){return!!t.closest("doc-editor")}function ms(t){return!!t.closest("edgeless-editor")}function hO(t){if(!en(t))return null;const e=t.page;D(e.root);const n=t.view.viewFromPath("block",[e.root.id]);if(!n||n.closest("affine-doc-page")!==n)throw new Error("Failed to get viewport element!");return n.viewportElement}function T7(t,e){return pO(t,qn(e))}function pO(t,e){return t.view.viewFromPath("block",e)}async function fO(t,e){D(e.page.root);const n=V1(t);return n?(await n.updateComplete,e.id===e.page.root.id?n:t.view.viewFromPath("block",qn(e))):null}function Vm(t,e){const i=t.view.viewFromPath("block",qn(e))?.querySelector("rich-text");return i||null}async function Bk(t,e){const n=await fO(t,e);if(!n)return null;await n.updateComplete;const i=n?.querySelector("rich-text");return i||null}function Ja(t,e){if(Ie(e,["affine:database"]))return null;const n=Vm(t,e);return n?n.inlineEditor:null}function Dk(t){const e=t.closest(Fm);return D(e,"Cannot find block element by element"),Zl(e)}function Ok(t){const e=t.closest(".affine-doc-viewport");return e?e.querySelector("doc-title"):null}function Rk(t){const e=Ok(t);if(!e)return null;const n=e.querySelector("rich-text");return D(n),n.inlineEditor}function Nk(t,e){return t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY}function I7(t){return t.hasAttribute(lr)}function gO({tagName:t}){return t==="AFFINE-DOC-PAGE"}function Hk(t){return t.tagName==="AFFINE-EDGELESS-PAGE"}function mO(t){return gO(t)||Hk(t)||vO(t)||yO(t)}function O2(t){return!mO(t)}function bO({tagName:t}){return t==="AFFINE-IMAGE"}function vO({tagName:t}){return t==="AFFINE-NOTE"}function yO({tagName:t}){return t==="AFFINE-SURFACE"}function Fk({tagName:t}){return t==="AFFINE-DATABASE-TABLE"||t==="AFFINE-DATABASE"}function wO({classList:t}){return t.contains("edgeless-block-portal-note")}function Fg(t,e=null,n=1){const{y:i}=t;let r,o=null,s=null,a=null,l=0,c=1;if(e){const{snapToEdge:d={x:!0,y:!1}}=e;r=e.container;const u=e.rect||r?.getBoundingClientRect();u&&(d.x&&(t.x=Math.min(Math.max(t.x,u.left)+Fh*n-1,u.right-Fh*n-1)),d.y&&(n!==1&&console.warn("scale is not supported yet"),t.y=Es(t.y,u.top+1,u.bottom-1)))}if(o=Xy(document.elementsFromPoint(t.x,t.y),r),o){if(Fk(o)){s=o.getBoundingClientRect();const d=zk(o);if(d)if(a=d.getBoundingClientRect(),a.height){if(t.y<a.top||t.y>a.bottom)return o;a=null}else return o}else if(s=xa(o),a=o.querySelector(".affine-block-children-container")?.firstElementChild?.getBoundingClientRect(),a&&a.height){if(s.x<t.x&&t.x<=a.x)return o;a=null}else return o;s=null,o=null}do if(t.y=i-c*2,c<0&&c--,c*=-1,o=Xy(document.elementsFromPoint(t.x,t.y),r),o){if(s=xa(o),l=s.bottom-t.y,l>=0&&l<=F4*2||(l=t.y-s.top,l>=0&&l<=F4*2))return o;s=null,o=null}while(c<=F4);return o}function Uk(t,e,n){const i=Array.from(t.querySelectorAll(n));let r=Number.POSITIVE_INFINITY,o=null;if(!i.length)return null;for(const s of i){const a=s.getBoundingClientRect();if(a.height===0||e.y>a.bottom||e.y<a.top)continue;const l=Math.pow(e.y-(a.y+a.height/2),2)+Math.pow(e.x-a.x,2);if(l<=r)r=l,o=s;else return o}return o}function Ug(t){if(!t)return null;if(I7(t)&&O2(t))return t;const e=t.closest(Fm);return e&&O2(e)?e:null}function Zl(t){const e=t;if("hostModel"in e){const n=e;return D(n.hostModel),n.hostModel}return D(e.model),e.model}function xa(t){return Fk(t)?t.getBoundingClientRect():(t.firstElementChild??t).getBoundingClientRect()}function U4(t){if(t.length<=1)return t;let e=t[0];return t.filter((n,i)=>i===0?!0:Nk(e,n)?!1:(e=n,!0))}function Xy(t,e){const n=t.length;let i=null,r=0;for(;r<n;)if(i=t[r],r++,!(e&&!Nk(e,i))){if(I7(i)&&O2(i))return i;if(bO(i)){const o=t[r];return r<n&&I7(o)&&O2(o)?t[r]:Ug(o)}}return null}function Wo(){return getComputedStyle(document.documentElement).getPropertyValue("--affine-theme-mode").trim()==="dark"?"dark":"light"}function Vk(t){return document.elementsFromPoint(t.x,t.y).find(wO)||null}function xO(t){return t.querySelector(".affine-database-block-table")}function _O(t){return t.querySelector(".affine-database-column-header")}function zk(t){return t.querySelector(".affine-database-block-rows")}var L7=(t=>(t[t.Normal=0]="Normal",t[t.Database=1]="Database",t[t.EmptyDatabase=2]="EmptyDatabase",t))(L7||{});function jk(t,e,n){const i={rect:xa(n),flag:0};if(Ie(e,["affine:database"])){const o=xO(n);D(o);let s=o.getBoundingClientRect();if(e.isEmpty()){if(i.flag=2,t.y<s.top)return i;const a=_O(n);D(a),s=a.getBoundingClientRect(),i.rect=new DOMRect(i.rect.left,s.bottom,i.rect.width,1)}else{i.flag=1;const a=zk(n);D(a);const l=a.getBoundingClientRect();if(t.y<l.top||t.y>l.bottom)return i;const c=document.elementsFromPoint(t.x,t.y),d=c.length;let u,h=0;for(;h<d;h++){if(u=c[h],u.classList.contains("affine-database-block-row-cell-content"))return i.rect=V4(u,s),i;if(u.classList.contains("affine-database-block-row"))return u=u.querySelector(Fm),D(u),i.rect=V4(u,s),i}}}else{const o=n.parentElement;if(o?.classList.contains("affine-database-block-row-cell-content"))return i.flag=1,i.rect=V4(o),i}return i}function V4(t,e){if(!e){const o=t.closest(".affine-database-block-table");D(o),e=o.getBoundingClientRect()}const n=t.parentElement;D(n);const i=n.parentElement;D(i);const r=n.getBoundingClientRect();return new DOMRect(e.left,r.top,r.right-e.left,r.height)}function Gk(t,e){return e.some(n=>t.classList.contains(n))}class je{constructor(e=0,n=0){this.x=e,this.y=n}static from(e,n){return Array.isArray(e)?new je(e[0],e[1]):typeof e=="number"?new je(e,n??e):new je(e.x,e.y)}set(e,n){this.x=e,this.y=n}equals({x:e,y:n}){return this.x===e&&this.y===n}add(e){return new je(this.x+e.x,this.y+e.y)}scale(e){return new je(this.x*e,this.y*e)}subtract(e){return new je(this.x-e.x,this.y-e.y)}clone(){return new je(this.x,this.y)}cross(e){return this.x*e.y-this.y*e.x}lerp(e,n){return new je(this.x+(e.x-this.x)*n,this.y+(e.y-this.y)*n)}toArray(){return[this.x,this.y]}static min(e,n){return new je(Math.min(e.x,n.x),Math.min(e.y,n.y))}static max(e,n){return new je(Math.max(e.x,n.x),Math.max(e.y,n.y))}static clamp(e,n,i){return new je(Es(e.x,n.x,i.x),Es(e.y,n.y,i.y))}}let Bi=class po{constructor(e,n,i,r){const[o,s]=e<=i?[e,i]:[i,e],[a,l]=n<=r?[n,r]:[r,n];this.min=new je(o,a),this.max=new je(s,l)}get width(){return this.max.x-this.min.x}set width(e){this.max.x=this.min.x+e}get height(){return this.max.y-this.min.y}set height(e){this.max.y=this.min.y+e}get left(){return this.min.x}set left(e){this.min.x=e}get top(){return this.min.y}set top(e){this.min.y=e}get right(){return this.max.x}set right(e){this.max.x=e}get bottom(){return this.max.y}set bottom(e){this.max.y=e}center(){return new je((this.left+this.right)/2,(this.top+this.bottom)/2)}extend_with(e){this.min=je.min(this.min,e),this.max=je.max(this.max,e)}extend_with_x(e){this.min.x=Math.min(this.min.x,e),this.max.x=Math.max(this.max.x,e)}extend_with_y(e){this.min.y=Math.min(this.min.y,e),this.max.y=Math.max(this.max.y,e)}equals({min:e,max:n}){return this.min.equals(e)&&this.max.equals(n)}contains({min:e,max:n}){return this.isPointIn(e)&&this.isPointIn(n)}intersects({left:e,top:n,right:i,bottom:r}){return this.left<=i&&e<=this.right&&this.top<=r&&n<=this.bottom}isPointIn({x:e,y:n}){return this.left<=e&&e<=this.right&&this.top<=n&&n<=this.bottom}isPointDown({x:e,y:n}){return this.bottom<n&&this.left<=e&&this.right>=e}isPointUp({x:e,y:n}){return n<this.top&&this.left<=e&&this.right>=e}isPointLeft({x:e,y:n}){return e<this.left&&this.top<=n&&this.bottom>=n}isPointRight({x:e,y:n}){return e>this.right&&this.top<=n&&this.bottom>=n}intersect(e){return po.fromPoints(je.max(this.min,e.min),je.min(this.max,e.max))}clamp(e){return je.clamp(e,this.min,this.max)}clone(){const{left:e,top:n,right:i,bottom:r}=this;return new po(e,n,i,r)}toDOMRect(){const{left:e,top:n,width:i,height:r}=this;return new DOMRect(e,n,i,r)}static fromLTRB(e,n,i,r){return new po(e,n,i,r)}static fromLWTH(e,n,i,r){return new po(e,i,e+n,i+r)}static fromXY(e,n){return po.fromPoint(new je(e,n))}static fromPoint(e){return po.fromPoints(e.clone(),e)}static fromPoints(e,n){const i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=Math.min(n.x,e.x),s=Math.min(n.y,e.y);return po.fromLWTH(o,i,s,r)}static fromDOMRect({left:e,top:n,right:i,bottom:r}){return po.fromLTRB(e,n,i,r)}static fromDOM(e){return po.fromDOMRect(e.getBoundingClientRect())}};function Zk(t,e,n,i=[],r=1,o=null){const s=e.page.getSchemaByFlavour("affine:database");D(s);const a=s.model.children??[];let l=!0;if(a.length&&(i.length?l=i.map(Zl).every(y=>a.includes(y.flavour)):o&&(l=a.includes(o))),!l&&!Ie(e,["affine:database"])){const y=n.closest("affine-database");y&&(n=y,e=Zl(n))}let c="none";const d=3*r,{rect:u,flag:h}=jk(t,e,n);if(h===L7.EmptyDatabase){const y=Bi.fromDOMRect(u);return y.top-=d/2,y.height=d,c="database",{type:c,rect:y,modelState:{model:e,rect:u,element:n}}}else if(h===L7.Database){const y=Math.abs(u.top-t.y),x=Math.abs(u.bottom-t.y),T=y<x;return c=T?"before":"after",{type:c,rect:Bi.fromLWTH(u.left,u.width,(T?u.top-1:u.bottom)-d/2,d),modelState:{model:e,rect:u,element:n}}}const p=Math.abs(u.top-t.y),g=Math.abs(u.bottom-t.y);c=p<g?"before":"after";let v=4;if(c==="before"){let y,x;y=n.previousElementSibling,y?i.length&&y===i[i.length-1]?c="none":x=xa(y):(y=n.parentElement?.previousElementSibling,y&&(x=y.getBoundingClientRect())),x&&(v=(u.top-x.bottom)/2)}else{let y,x;y=n.nextElementSibling,y?i.length&&y===i[0]&&(c="none",y=null):y=Ug(n.parentElement)?.nextElementSibling,y&&(x=xa(y),v=(x.top-u.bottom)/2)}if(c==="none")return null;let m=u.top;return c==="before"?m-=v:m+=u.height+v,{type:c,rect:Bi.fromLWTH(u.left,u.width,m-d/2,d),modelState:{model:e,rect:u,element:n}}}function CO(t){return FB||Ag?t.ctrlKey||t.metaKey:t.ctrlKey}function Ky(t){return(4&t.buttons)===4}function at(t){t.stopPropagation()}function Uh(t){return t.ctrlKey||t.metaKey||t.altKey}function jd(t,e,n,i){const r=()=>{t.removeEventListener(e,n,i)};return t.addEventListener(e,n,i),r}function Gd(t,e,n,i){const r=s=>{o(),n(s)},o=()=>{t.removeEventListener(e,r,i)};return t.addEventListener(e,r,i),o}function Eo(t,e){return requestAnimationFrame(()=>{if(e===void 0){t();return}e.isConnected&&t()})}function zm(t,e){let n;return new Proxy(t,{apply(i,r,o){n===void 0&&(n=Eo(()=>{i.apply(r,o),n=void 0},e))}})}const Qy=[{description:"Images",accept:{"image/*":[".avif",".gif",".jpeg",".jpg",".png",".tif",".tiff",".webp"]}},{description:"Videos",accept:{"video/*":[".avi",".mp4",".mpeg",".ogg",".webm",".3gp",".3g2"]}},{description:"Audios",accept:{"audio/*":[".aac",".mid",".midi",".mp3",".oga",".opus",".wav",".weba",".3gp",".3g2"]}},{description:"Markdown",accept:{"text/markdown":[".md",".markdown"]}},{description:"Html",accept:{"text/html":[".html",".htm"]}},{description:"Zip",accept:{"application/zip":[".zip"]}}];async function yh({acceptType:t="Any",multiple:e=!1}={}){if("showOpenFilePicker"in window&&(()=>{try{return window.self===window.top}catch{return!1}})()&&window.showOpenFilePicker)try{const i=Qy.find(s=>s.description===t);if(t!=="Any"&&!i)throw new Error(`Unexpected acceptType "${t}"`);const r={types:i?[i]:void 0,multiple:e},o=await window.showOpenFilePicker(r);return e?await Promise.all(o.map(async a=>await a.getFile())):await o[0].getFile()}catch(i){if(!(i instanceof Error)||i.name!=="AbortError")throw i;return null}return new Promise(i=>{const r=document.createElement("input");r.classList.add("affine-upload-input","blocksuite-overlay"),r.style.display="none",r.type="file",e&&(r.multiple=!0),t!=="Any"&&(r.accept=Object.keys(Qy.find(o=>o.description===t)?.accept??"").join(",")),document.body.append(r),r.addEventListener("change",()=>{if(r.remove(),!r.files){i(null);return}if(e){i(Array.from(r.files));return}i(r.files[0])}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})}async function R2(){const t=await yh({acceptType:"Images",multiple:!0});return t||[]}function jm(t,e){const n=URL.createObjectURL(t),i=document.createElement("a"),r=new MouseEvent("click");i.download=e,i.href=n,i.dispatchEvent(r),i.remove(),URL.revokeObjectURL(n)}const Jy=100,Du=new Map,Ou=new Map;function Wk(){return{saveAttachmentData:(r,o)=>{Du.size>Jy&&(console.warn("Clear the temp attachment data. It may cause filename loss when converting between image and attachment."),Du.clear()),Du.set(r,o)},getAttachmentData:r=>{const o=Du.get(r);return Du.delete(r),o},saveImageData:(r,o)=>{Ou.size>Jy&&(console.warn("Clear temp image data. It may cause image width and height loss when converting between image and attachment."),Ou.clear()),Ou.set(r,o)},getImageData:r=>{const o=Ou.get(r);return Ou.delete(r),o}}}async function Vg(t,e={}){const n=t.createPage({id:e.id});return await n.load(()=>{const i=e.title??"",r=n.addBlock("affine:page",{title:new n.Text(i)});t.setPageMeta(n.id,{title:i}),n.addBlock("affine:surface",{},r);const o=n.addBlock("affine:note",{},r);n.addBlock("affine:paragraph",{},o),n.resetHistory()}),n}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let kO;function Gm(t){return(e,n)=>GB(e,n,{get(){return(this.renderRoot??(kO??=document.createDocumentFragment())).querySelectorAll(t)}})}async function Zd(t,e,n){const i=await Bk(t,e);if(!i)return;await i.updateComplete;const r=i.inlineEditor;D(r),r.setInlineRange(n)}function $n(t,e,n,i={index:0,length:0}){const r=e.getBlockById(n);if(D(r),!Ie(r,["affine:divider"]))return Zd(t,r,i)}function qk(t,e){if(nh){const r=document.caretPositionFromPoint(t,e),o=document.createRange();return o.setStart(r.offsetNode,r.offset),o}const n=document.caretRangeFromPoint(t,e);if(!n)return null;const i=n?.getClientRects();return i&&i.length===2&&n.startOffset===n.endOffset&&e<i[0].y+i[0].height&&(i[0].x|0)-(i[1].x|0)>0&&(n.setStart(n.startContainer,n.startOffset-1),n.setEnd(n.endContainer,n.endOffset-1)),n}function EO(t){const e=document.createRange();let n=t.firstChild;for(;n?.firstChild;)n=n.firstChild;return n&&(e.setStart(n,0),e.setEnd(n,0)),e}function SO(t){const e=document.createRange();let n=t.lastChild;for(;n?.lastChild;)n=n.lastChild;return n&&(e.setStart(n,n.textContent?.length||0),e.setEnd(n,n.textContent?.length||0)),e}async function TO(t,e,n=1){const r=e.closest(".affine-doc-viewport"),{top:o,bottom:s}=Bi.fromDOM(e),{clientHeight:a}=document.documentElement,l=(Number(window.getComputedStyle(e).lineHeight.replace(/\D+$/,""))||16)*n;switch(s<t){case!0:{let d=s;return s<100&&r&&(r.scrollTop=r.scrollTop-100+s,requestAnimationFrame(()=>{d=e.getBoundingClientRect().bottom})),d-l/2}case!1:{let d=o;return r&&o>a-100&&(r.scrollTop=r.scrollTop+(o+100-a),requestAnimationFrame(()=>{d=e.getBoundingClientRect().top})),d+l/2}}}function IO(t,e=1/0,n=0){const i=Rk(t);D(i),e>i.yText.length&&(e=i.yText.length),i.setInlineRange({index:e,length:n})}async function LO(t,e="end",n=1){!!Pk(t)&&t.querySelector("v-line")?.scrollIntoView({block:"nearest"});const{left:r,right:o}=Bi.fromDOM(t);let s=null;switch(e){case"start":s=EO(t);break;case"end":s=SO(t);break;default:{const{x:a,y:l}=e;let c=a;const d=await TO(l,t,n);a<=r&&(c=r+1),a>=o&&(c=o-1),s=qk(c,d);break}}Zm(s)}function N2(t,e,n="end",i=1){if(Ie(e,["affine:note","affine:page"]))throw new Error("Can't focus note or page!");D(e.page.root);const r=t.view.viewFromPath("block",[e.page.root.id]);D(r);const o=t.view.viewFromPath("block",qn(e));D(o);const s=o?.querySelector("[contenteditable]");s&&LO(s,n,i).catch(console.error)}function Zm(t){const e=window.getSelection();D(e),e.removeAllRanges(),t&&e.addRange(t)}function zg(t=window.getSelection()){if(!t)throw new Error("Failed to get current range, selection is null");if(t.rangeCount===0)throw new Error("Failed to get current range, rangeCount is 0");return t.rangeCount>1&&console.warn("getCurrentRange may be wrong, rangeCount > 1"),t.getRangeAt(0)}function jg(t,e){const n=qk(t,e);n?.startContainer instanceof Node&&Zm(n)}const MO=(t,e)=>{const n=t.selectedModels;D(n,"`selectedModels` is required, you need to use `getSelectedModels` command before adding this command to the pipeline.");const i=o=>{(Ie(o,["affine:database"])?o.children:o.children.filter(l=>n.findIndex(d=>d.id===l.id)>=0)).forEach(l=>{const c=n.findIndex(d=>d.id===l.id);c>=0&&n.splice(c,1),i(l)})};n.forEach(i);const r=Ud.fromModels(t.std.page,n);return t.std.clipboard.copy(r).then(()=>t.onCopy?.()).catch(console.error),e()},PO=(t,e)=>{const n=t.selectedModels;return D(n,"`selectedModels` is required, you need to use `getSelectedModels` command before adding this command to the pipeline."),n.forEach(i=>{t.std.page.deleteBlock(i)}),e()},AO=(t,e)=>{const{host:n}=t;D(n,"`host` is required, you need to use `withHost` command before adding this command to the pipeline.");const i=t.types??["block","text","image"],r=[];n.std.command.pipe().withHost().tryAll(o=>[o.getTextSelection(),o.getBlockSelections(),o.getImageSelections()]).getSelectedBlocks({types:i}).inline(o=>{const{selectedBlocks:s}=o;D(s),r.push(...s.map(a=>a.model))}).run(),e({selectedModels:r})},$O=(t,e)=>{const n=t.std.selection.filter("block");n.length!==0&&e({currentBlockSelections:n})},BO=(t,e)=>{const n=t.std.selection.filter("image");n.length!==0&&e({currentImageSelections:n})},DO=(t,e)=>{const n=t.std.selection.find("text");n&&e({currentTextSelection:n})},OO=(t,e)=>{const n=t.textSelection??t.currentTextSelection;D(n,"`textSelection` is required, you need to pass it in args or use `getTextSelection` command before adding this command to the pipeline.");const i=t.host;D(i,"`host` is required, you need to use `withHost` command before adding this command to the pipeline."),D(i.rangeManager);const r=i.rangeManager.textSelectionToRange(n);if(!r)return;const o=i.rangeManager.getSelectedBlockElementsByRange(r,{mode:"flat"}),{from:s,to:a}=n,l=o.find(h=>gt.equals(s.path,h.path));D(l);let c;if(Ie(l.model,["affine:page"])?c=l.model.title:c=l.model.text,D(c),!a)return c.delete(s.index,s.length),t.std.selection.setGroup("note",[t.std.selection.create("text",{from:{path:s.path,index:s.index,length:0},to:null})]),e();const d=o.find(h=>gt.equals(a.path,h.path));D(d);const u=d.model.text;D(u),c.delete(s.index,s.length),u.delete(0,a.length),o.filter(h=>h.model.id!==l.model.id&&h.model.id!==d.model.id).forEach(h=>{t.std.page.deleteBlock(h.model)}),t.std.selection.setGroup("note",[t.std.selection.create("text",{from:{path:a.path,index:a.index,length:0},to:null})]),e()},Wm=["affine:paragraph","affine:list"],qm=["affine:paragraph","affine:list"],Ym=["affine:database"],RO=(t,e)=>{const n=t.blockSelections??t.currentBlockSelections;D(n,"`blockSelections` is required, you need to pass it in args or use `getBlockSelections` command before adding this command to the pipeline.");const i=t.host;if(D(i,"`host` is required, you need to use `withHost` command before adding this command to the pipeline."),n.length===0)return;const r=t.styles,o=t.mode??"merge";i.std.command.pipe().withHost().getSelectedBlocks({blockSelections:n,filter:a=>qm.includes(a.model.flavour),types:["block"]}).inline((a,l)=>{const{selectedBlocks:c}=a;D(c),c.flatMap(u=>{const h=u.querySelector(`[${ni}]`);return h?h.inlineEditor:[]}).forEach(u=>{u.formatText({index:0,length:u.yTextLength},r,{mode:o})}),l()}).run()&&e()},NO=(t,e)=>{const{host:n,styles:i,mode:r="merge"}=t;D(n,"`host` is required, you need to use `withHost` command before adding this command to the pipeline.");let o=t.range;if(!o){const a=document.getSelection();if(!a||a.rangeCount===0)return;o=a.getRangeAt(0)}if(!o)return;Array.from(n.querySelectorAll(`[${ni}]`)).filter(a=>o?.intersectsNode(a)).filter(a=>{const l=a.closest(`[${lr}]`);return l?Ym.includes(l.model.flavour):!1}).map(a=>a.inlineEditor).forEach(a=>{const l=a.getInlineRange();l&&a.formatText(l,i,{mode:r})}),e()};function Yk(t){let e=t.getInlineRange();const n=t.slots.inlineRangeUpdate.on(([i,r])=>{e&&i&&(!r&&i.index===e.index||r&&i.index===e.index+1)?e=i:(t.resetMarks(),n.dispose())})}const HO=(t,e)=>{const{host:n,styles:i,mode:r="merge"}=t;D(n,"`host` is required, you need to use `withHost` command before adding this command to the pipeline.");const o=t.textSelection??t.currentTextSelection;D(o,"`textSelection` is required, you need to pass it in args or use `getTextSelection` command before adding this command to the pipeline."),n.std.command.pipe().withHost().getSelectedBlocks({textSelection:o,filter:a=>Wm.includes(a.model.flavour),types:["text"]}).inline((a,l)=>{const{selectedBlocks:c}=a;D(c),c.flatMap(u=>{const h=u.querySelector(`[${ni}]`);return h&&h.inlineEditor.getInlineRange()?h.inlineEditor:[]}).forEach(u=>{const h=u.getInlineRange();if(h)if(h.length===0){const p=u.getDeltaByRangeIndex(h.index);if(!p)return;u.setMarks({...u.marks,...Object.fromEntries(Object.entries(i).map(([g,f])=>typeof f=="boolean"?[g,u.marks&&u.marks[g]||p.attributes&&p.attributes[g]?null:f]:[g,f]))}),Yk(u)}else u.formatText(h,i,{mode:r})}),Promise.all(c.map(u=>u.updateComplete)).then(()=>{n.rangeManager?.syncTextSelectionToRange(o)}).catch(console.error),l()}).run()&&e()},Xm=t=>{const e=t.host,n=e.selection,i=e.rangeManager,r=new Ve;D(n),D(i);const o=c=>{if(c.collapsed){const d=c.startContainer instanceof Element?c.startContainer:c.startContainer.parentElement;if(!d?.closest(`[${ni}]`))return!1;const h=d?.closest(`[${e.blockIdAttr}]`);if(!h||h!==t)return!1}else if(!c.intersectsNode(t))return!1;return!0},s=(c,d)=>{if(!o(c))return null;const{from:u,to:h}=d;return gt.equals(u.path,t.path)?{index:u.index,length:u.length}:h&&gt.equals(h.path,t.path)?{index:h.index,length:h.length}:(D(t.model.text),{index:0,length:t.model.text.length})},a=(c,d=!0)=>{if(!i.binding.isComposing){if(!c)n.clear(["text"]);else{const u=n.create("text",{from:{path:t.path,index:c.index,length:c.length},to:null});n.setGroup("note",[u])}r.emit([c,d])}},l=()=>{const c=document.getSelection();if(!c||c.rangeCount===0)return null;const d=c.getRangeAt(0);if(!d)return null;const u=n.find("text");return u?s(d,u):null};return n.slots.changed.on(()=>{const c=n.find("text");if(!c)return;const d=i.value;!d||!o(d)||requestAnimationFrame(()=>{const u=s(d,c);r.emit([u,!1])})}),{setInlineRange:a,getInlineRange:l,inlineRangeUpdated:r}},FO=(t,e)=>{const n=t.std.host;Cs(n,ZB),e({host:n})};class o0{constructor(e,n,i){this.property=e,this.normal=n,i&&(this.space=i)}}o0.prototype.property={};o0.prototype.normal={};o0.prototype.space=null;function Xk(t,e){const n={},i={};let r=-1;for(;++r<t.length;)Object.assign(n,t[r].property),Object.assign(i,t[r].normal);return new o0(n,i,e)}function Vh(t){return t.toLowerCase()}class Er{constructor(e,n){this.property=e,this.attribute=n}}Er.prototype.space=null;Er.prototype.boolean=!1;Er.prototype.booleanish=!1;Er.prototype.overloadedBoolean=!1;Er.prototype.number=!1;Er.prototype.commaSeparated=!1;Er.prototype.spaceSeparated=!1;Er.prototype.commaOrSpaceSeparated=!1;Er.prototype.mustUseProperty=!1;Er.prototype.defined=!1;let UO=0;const it=Sc(),mn=Sc(),Kk=Sc(),$e=Sc(),Ot=Sc(),C1=Sc(),Wi=Sc();function Sc(){return 2**++UO}const M7=Object.freeze(Object.defineProperty({__proto__:null,boolean:it,booleanish:mn,commaOrSpaceSeparated:Wi,commaSeparated:C1,number:$e,overloadedBoolean:Kk,spaceSeparated:Ot},Symbol.toStringTag,{value:"Module"})),z4=Object.keys(M7);class Km extends Er{constructor(e,n,i,r){let o=-1;if(super(e,n),ew(this,"space",r),typeof i=="number")for(;++o<z4.length;){const s=z4[o];ew(this,z4[o],(i&M7[s])===M7[s])}}}Km.prototype.defined=!0;function ew(t,e,n){n&&(t[e]=n)}const VO={}.hasOwnProperty;function Wd(t){const e={},n={};let i;for(i in t.properties)if(VO.call(t.properties,i)){const r=t.properties[i],o=new Km(i,t.transform(t.attributes||{},i),r,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),e[i]=o,n[Vh(i)]=i,n[Vh(o.attribute)]=i}return new o0(e,n,t.space)}const Qk=Wd({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),Jk=Wd({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function eE(t,e){return e in t?t[e]:e}function tE(t,e){return eE(t,e.toLowerCase())}const nE=Wd({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:tE,properties:{xmlns:null,xmlnsXLink:null}}),iE=Wd({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:mn,ariaAutoComplete:null,ariaBusy:mn,ariaChecked:mn,ariaColCount:$e,ariaColIndex:$e,ariaColSpan:$e,ariaControls:Ot,ariaCurrent:null,ariaDescribedBy:Ot,ariaDetails:null,ariaDisabled:mn,ariaDropEffect:Ot,ariaErrorMessage:null,ariaExpanded:mn,ariaFlowTo:Ot,ariaGrabbed:mn,ariaHasPopup:null,ariaHidden:mn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Ot,ariaLevel:$e,ariaLive:null,ariaModal:mn,ariaMultiLine:mn,ariaMultiSelectable:mn,ariaOrientation:null,ariaOwns:Ot,ariaPlaceholder:null,ariaPosInSet:$e,ariaPressed:mn,ariaReadOnly:mn,ariaRelevant:null,ariaRequired:mn,ariaRoleDescription:Ot,ariaRowCount:$e,ariaRowIndex:$e,ariaRowSpan:$e,ariaSelected:mn,ariaSetSize:$e,ariaSort:null,ariaValueMax:$e,ariaValueMin:$e,ariaValueNow:$e,ariaValueText:null,role:null}}),zO=Wd({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:tE,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:C1,acceptCharset:Ot,accessKey:Ot,action:null,allow:null,allowFullScreen:it,allowPaymentRequest:it,allowUserMedia:it,alt:null,as:null,async:it,autoCapitalize:null,autoComplete:Ot,autoFocus:it,autoPlay:it,blocking:Ot,capture:it,charSet:null,checked:it,cite:null,className:Ot,cols:$e,colSpan:null,content:null,contentEditable:mn,controls:it,controlsList:Ot,coords:$e|C1,crossOrigin:null,data:null,dateTime:null,decoding:null,default:it,defer:it,dir:null,dirName:null,disabled:it,download:Kk,draggable:mn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:it,formTarget:null,headers:Ot,height:$e,hidden:it,high:$e,href:null,hrefLang:null,htmlFor:Ot,httpEquiv:Ot,id:null,imageSizes:null,imageSrcSet:null,inert:it,inputMode:null,integrity:null,is:null,isMap:it,itemId:null,itemProp:Ot,itemRef:Ot,itemScope:it,itemType:Ot,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:it,low:$e,manifest:null,max:null,maxLength:$e,media:null,method:null,min:null,minLength:$e,multiple:it,muted:it,name:null,nonce:null,noModule:it,noValidate:it,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:it,optimum:$e,pattern:null,ping:Ot,placeholder:null,playsInline:it,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:it,referrerPolicy:null,rel:Ot,required:it,reversed:it,rows:$e,rowSpan:$e,sandbox:Ot,scope:null,scoped:it,seamless:it,selected:it,shadowRootDelegatesFocus:it,shadowRootMode:null,shape:null,size:$e,sizes:null,slot:null,span:$e,spellCheck:mn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:$e,step:null,style:null,tabIndex:$e,target:null,title:null,translate:null,type:null,typeMustMatch:it,useMap:null,value:mn,width:$e,wrap:null,align:null,aLink:null,archive:Ot,axis:null,background:null,bgColor:null,border:$e,borderColor:null,bottomMargin:$e,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:it,declare:it,event:null,face:null,frame:null,frameBorder:null,hSpace:$e,leftMargin:$e,link:null,longDesc:null,lowSrc:null,marginHeight:$e,marginWidth:$e,noResize:it,noHref:it,noShade:it,noWrap:it,object:null,profile:null,prompt:null,rev:null,rightMargin:$e,rules:null,scheme:null,scrolling:mn,standby:null,summary:null,text:null,topMargin:$e,valueType:null,version:null,vAlign:null,vLink:null,vSpace:$e,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:it,disableRemotePlayback:it,prefix:null,property:null,results:$e,security:null,unselectable:null}}),jO=Wd({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:eE,properties:{about:Wi,accentHeight:$e,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:$e,amplitude:$e,arabicForm:null,ascent:$e,attributeName:null,attributeType:null,azimuth:$e,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:$e,by:null,calcMode:null,capHeight:$e,className:Ot,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:$e,diffuseConstant:$e,direction:null,display:null,dur:null,divisor:$e,dominantBaseline:null,download:it,dx:null,dy:null,edgeMode:null,editable:null,elevation:$e,enableBackground:null,end:null,event:null,exponent:$e,externalResourcesRequired:null,fill:null,fillOpacity:$e,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:C1,g2:C1,glyphName:C1,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:$e,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:$e,horizOriginX:$e,horizOriginY:$e,id:null,ideographic:$e,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:$e,k:$e,k1:$e,k2:$e,k3:$e,k4:$e,kernelMatrix:Wi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:$e,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:$e,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:$e,overlineThickness:$e,paintOrder:null,panose1:null,path:null,pathLength:$e,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Ot,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:$e,pointsAtY:$e,pointsAtZ:$e,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Wi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Wi,rev:Wi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Wi,requiredFeatures:Wi,requiredFonts:Wi,requiredFormats:Wi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:$e,specularExponent:$e,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:$e,strikethroughThickness:$e,string:null,stroke:null,strokeDashArray:Wi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:$e,strokeOpacity:$e,strokeWidth:null,style:null,surfaceScale:$e,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Wi,tabIndex:$e,tableValues:null,target:null,targetX:$e,targetY:$e,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Wi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:$e,underlineThickness:$e,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:$e,values:null,vAlphabetic:$e,vMathematical:$e,vectorEffect:null,vHanging:$e,vIdeographic:$e,version:null,vertAdvY:$e,vertOriginX:$e,vertOriginY:$e,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:$e,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),GO=/^data[-\w.:]+$/i,tw=/-[a-z]/g,ZO=/[A-Z]/g;function Qm(t,e){const n=Vh(e);let i=e,r=Er;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&GO.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(tw,qO);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!tw.test(o)){let s=o.replace(ZO,WO);s.charAt(0)!=="-"&&(s="-"+s),e="data"+s}}r=Km}return new r(i,e)}function WO(t){return"-"+t.toLowerCase()}function qO(t){return t.charAt(1).toUpperCase()}const Gg=Xk([Jk,Qk,nE,iE,zO],"html"),s0=Xk([Jk,Qk,nE,iE,jO],"svg");function nw(t){const e=[],n=String(t||"");let i=n.indexOf(","),r=0,o=!1;for(;!o;){i===-1&&(i=n.length,o=!0);const s=n.slice(r,i).trim();(s||!o)&&e.push(s),r=i+1,i=n.indexOf(",",r)}return e}function YO(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const iw=/[#.]/g;function XO(t,e){const n=t||"",i={};let r=0,o,s;for(;r<n.length;){iw.lastIndex=r;const a=iw.exec(n),l=n.slice(r,a?a.index:n.length);l&&(o?o==="#"?i.id=l:Array.isArray(i.className)?i.className.push(l):i.className=[l]:s=l,r+=l.length),a&&(o=a[0],r++)}return{type:"element",tagName:s||e||"div",properties:i,children:[]}}function rw(t){const e=String(t||"").trim();return e?e.split(/[ \t\n\r\f]+/g):[]}function KO(t){return t.join(" ").trim()}const QO=new Set(["button","menu","reset","submit"]),P7={}.hasOwnProperty;function rE(t,e,n){const i=n&&nR(n);function r(o,s,...a){let l=-1,c;if(o==null){c={type:"root",children:[]};const d=s;a.unshift(d)}else if(c=XO(o,e),c.tagName=c.tagName.toLowerCase(),i&&P7.call(i,c.tagName)&&(c.tagName=i[c.tagName]),JO(s,c.tagName)){let d;for(d in s)P7.call(s,d)&&eR(t,c.properties,d,s[d])}else a.unshift(s);for(;++l<a.length;)A7(c.children,a[l]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return r}function JO(t,e){return t==null||typeof t!="object"||Array.isArray(t)?!1:e==="input"||!t.type||typeof t.type!="string"?!0:"children"in t&&Array.isArray(t.children)?!1:e==="button"?QO.has(t.type.toLowerCase()):!("value"in t)}function eR(t,e,n,i){const r=Qm(t,n);let o=-1,s;if(i!=null){if(typeof i=="number"){if(Number.isNaN(i))return;s=i}else typeof i=="boolean"?s=i:typeof i=="string"?r.spaceSeparated?s=rw(i):r.commaSeparated?s=nw(i):r.commaOrSpaceSeparated?s=rw(nw(i).join(" ")):s=ow(r,r.property,i):Array.isArray(i)?s=i.concat():s=r.property==="style"?tR(i):String(i);if(Array.isArray(s)){const a=[];for(;++o<s.length;){const l=ow(r,r.property,s[o]);a[o]=l}s=a}if(r.property==="className"&&Array.isArray(e.className)){const a=s;s=e.className.concat(a)}e[r.property]=s}}function A7(t,e){let n=-1;if(e!=null)if(typeof e=="string"||typeof e=="number")t.push({type:"text",value:String(e)});else if(Array.isArray(e))for(;++n<e.length;)A7(t,e[n]);else if(typeof e=="object"&&"type"in e)e.type==="root"?A7(t,e.children):t.push(e);else throw new Error("Expected node, nodes, or string, got `"+e+"`")}function ow(t,e,n){if(typeof n=="string"){if(t.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((t.boolean||t.overloadedBoolean)&&(n===""||Vh(n)===Vh(e)))return!0}return n}function tR(t){const e=[];let n;for(n in t)P7.call(t,n)&&e.push([n,t[n]].join(": "));return e.join("; ")}function nR(t){const e={};let n=-1;for(;++n<t.length;)e[t[n].toLowerCase()]=t[n];return e}const iR=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],rR=rE(Gg,"div"),oR=rE(s0,"g",iR),j4=/\r?\n|\r/g;function sR(t){const e=String(t),n=[];for(j4.lastIndex=0;j4.test(e);)n.push(j4.lastIndex);return n.push(e.length+1),{toPoint:i,toOffset:r};function i(o){let s=-1;if(typeof o=="number"&&o>-1&&o<n[n.length-1]){for(;++s<n.length;)if(n[s]>o)return{line:s+1,column:o-(s>0?n[s-1]:0)+1,offset:o}}}function r(o){const s=o&&o.line,a=o&&o.column;if(typeof s=="number"&&typeof a=="number"&&!Number.isNaN(s)&&!Number.isNaN(a)&&s-1 in n){const l=(n[s-2]||0)+a-1||0;if(l>-1&&l<n[n.length-1])return l}}}const aR={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},oE={}.hasOwnProperty,lR=Object.prototype;function cR(t,e){const n=e||{};return Jm({file:n.file||void 0,location:!1,schema:n.space==="svg"?s0:Gg,verbose:n.verbose||!1},t)}function Jm(t,e){let n;switch(e.nodeName){case"#comment":{const i=e;return n={type:"comment",value:i.data},i2(t,i,n),n}case"#document":case"#document-fragment":{const i=e,r="mode"in i?i.mode==="quirks"||i.mode==="limited-quirks":!1;if(n={type:"root",children:sE(t,e.childNodes),data:{quirksMode:r}},t.file&&t.location){const o=String(t.file),s=sR(o),a=s.toPoint(0),l=s.toPoint(o.length);n.position={start:a,end:l}}return n}case"#documentType":{const i=e;return n={type:"doctype"},i2(t,i,n),n}case"#text":{const i=e;return n={type:"text",value:i.value},i2(t,i,n),n}default:return n=dR(t,e),n}}function sE(t,e){let n=-1;const i=[];for(;++n<e.length;){const r=Jm(t,e[n]);i.push(r)}return i}function dR(t,e){const n=t.schema;t.schema=e.namespaceURI===aR.svg?s0:Gg;let i=-1;const r={};for(;++i<e.attrs.length;){const a=e.attrs[i],l=(a.prefix?a.prefix+":":"")+a.name;oE.call(lR,l)||(r[l]=a.value)}const s=(t.schema.space==="svg"?oR:rR)(e.tagName,r,sE(t,e.childNodes));if(i2(t,e,s),s.tagName==="template"){const a=e,l=a.sourceCodeLocation,c=l&&l.startTag&&b1(l.startTag),d=l&&l.endTag&&b1(l.endTag),u=Jm(t,a.content);c&&d&&t.file&&(u.position={start:c.end,end:d.start}),s.content=u}return t.schema=n,s}function i2(t,e,n){if("sourceCodeLocation"in e&&e.sourceCodeLocation&&t.file){const i=uR(t,n,e.sourceCodeLocation);i&&(t.location=!0,n.position=i)}}function uR(t,e,n){const i=b1(n);if(e.type==="element"){const r=e.children[e.children.length-1];if(i&&!n.endTag&&r&&r.position&&r.position.end&&(i.end=Object.assign({},r.position.end)),t.verbose){const o={};let s;if(n.attrs)for(s in n.attrs)oE.call(n.attrs,s)&&(o[Qm(t.schema,s).property]=b1(n.attrs[s]));n.startTag;const a=b1(n.startTag),l=n.endTag?b1(n.endTag):void 0,c={opening:a};l&&(c.closing=l),c.properties=o,e.data={position:c}}}return i}function b1(t){const e=sw({line:t.startLine,column:t.startCol,offset:t.startOffset}),n=sw({line:t.endLine,column:t.endCol,offset:t.endOffset});return e||n?{start:e,end:n}:void 0}function sw(t){return t.line&&t.column?t:void 0}const hR=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),Ut="";var F;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.NUMBER_SIGN=35]="NUMBER_SIGN",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",t[t.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_F=102]="LATIN_SMALL_F",t[t.LATIN_SMALL_X=120]="LATIN_SMALL_X",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",t[t.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(F=F||(F={}));const Ei={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function aE(t){return t>=55296&&t<=57343}function pR(t){return t>=56320&&t<=57343}function fR(t,e){return(t-55296)*1024+9216+e}function lE(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function cE(t){return t>=64976&&t<=65007||hR.has(t)}var ye;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ye=ye||(ye={}));const gR=65536;class mR{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=gR,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e){const{line:n,col:i,offset:r}=this;return{code:e,startLine:n,endLine:n,startCol:i,endCol:i,startOffset:r,endOffset:r}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const n=this.html.charCodeAt(this.pos+1);if(pR(n))return this.pos++,this._addGap(),fR(e,n)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,F.EOF;return this._err(ye.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,n){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=n}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,n){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(n)return this.html.startsWith(e,this.pos);for(let i=0;i<e.length;i++)if((this.html.charCodeAt(this.pos+i)|32)!==e.charCodeAt(i))return!1;return!0}peek(e){const n=this.pos+e;if(n>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,F.EOF;const i=this.html.charCodeAt(n);return i===F.CARRIAGE_RETURN?F.LINE_FEED:i}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,F.EOF;let e=this.html.charCodeAt(this.pos);return e===F.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,F.LINE_FEED):e===F.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,aE(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===F.LINE_FEED||e===F.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){lE(e)?this._err(ye.controlCharacterInInputStream):cE(e)&&this._err(ye.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var mt;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(mt=mt||(mt={}));function dE(t,e){for(let n=t.attrs.length-1;n>=0;n--)if(t.attrs[n].name===e)return t.attrs[n].value;return null}const la=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),bR=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var G4;const vR=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),yR=(G4=String.fromCodePoint)!==null&&G4!==void 0?G4:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function wR(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=vR.get(t))!==null&&e!==void 0?e:t}var An;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(An||(An={}));const xR=32;var vo;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(vo||(vo={}));function $7(t){return t>=An.ZERO&&t<=An.NINE}function _R(t){return t>=An.UPPER_A&&t<=An.UPPER_F||t>=An.LOWER_A&&t<=An.LOWER_F}function CR(t){return t>=An.UPPER_A&&t<=An.UPPER_Z||t>=An.LOWER_A&&t<=An.LOWER_Z||$7(t)}function kR(t){return t===An.EQUALS||CR(t)}var Pn;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(Pn||(Pn={}));var Ol;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Ol||(Ol={}));class ER{constructor(e,n,i){this.decodeTree=e,this.emitCodePoint=n,this.errors=i,this.state=Pn.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Ol.Strict}startEntity(e){this.decodeMode=e,this.state=Pn.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case Pn.EntityStart:return e.charCodeAt(n)===An.NUM?(this.state=Pn.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=Pn.NamedEntity,this.stateNamedEntity(e,n));case Pn.NumericStart:return this.stateNumericStart(e,n);case Pn.NumericDecimal:return this.stateNumericDecimal(e,n);case Pn.NumericHex:return this.stateNumericHex(e,n);case Pn.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|xR)===An.LOWER_X?(this.state=Pn.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=Pn.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,i,r){if(n!==i){const o=i-n;this.result=this.result*Math.pow(r,o)+parseInt(e.substr(n,o),r),this.consumed+=o}}stateNumericHex(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if($7(r)||_R(r))n+=1;else return this.addToNumericResult(e,i,n,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,i,n,16),-1}stateNumericDecimal(e,n){const i=n;for(;n<e.length;){const r=e.charCodeAt(n);if($7(r))n+=1;else return this.addToNumericResult(e,i,n,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,i,n,10),-1}emitNumericEntity(e,n){var i;if(this.consumed<=n)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===An.SEMI)this.consumed+=1;else if(this.decodeMode===Ol.Strict)return 0;return this.emitCodePoint(wR(this.result),this.consumed),this.errors&&(e!==An.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:i}=this;let r=i[this.treeIndex],o=(r&vo.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const s=e.charCodeAt(n);if(this.treeIndex=hE(i,r,this.treeIndex+Math.max(1,o),s),this.treeIndex<0)return this.result===0||this.decodeMode===Ol.Attribute&&(o===0||kR(s))?0:this.emitNotTerminatedNamedEntity();if(r=i[this.treeIndex],o=(r&vo.VALUE_LENGTH)>>14,o!==0){if(s===An.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==Ol.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:i}=this,r=(i[n]&vo.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,i){const{decodeTree:r}=this;return this.emitCodePoint(n===1?r[e]&~vo.VALUE_LENGTH:r[e+1],i),n===3&&this.emitCodePoint(r[e+2],i),i}end(){var e;switch(this.state){case Pn.NamedEntity:return this.result!==0&&(this.decodeMode!==Ol.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Pn.NumericDecimal:return this.emitNumericEntity(0,2);case Pn.NumericHex:return this.emitNumericEntity(0,3);case Pn.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Pn.EntityStart:return 0}}}function uE(t){let e="";const n=new ER(t,i=>e+=yR(i));return function(r,o){let s=0,a=0;for(;(a=r.indexOf("&",a))>=0;){e+=r.slice(s,a),n.startEntity(o);const c=n.write(r,a+1);if(c<0){s=a+n.end();break}s=a+c,a=c===0?s+1:s}const l=e+r.slice(s);return e="",l}}function hE(t,e,n,i){const r=(e&vo.BRANCH_LENGTH)>>7,o=e&vo.JUMP_TABLE;if(r===0)return o!==0&&i===o?n:-1;if(o){const l=i-o;return l<0||l>=r?-1:t[n+l]-1}let s=n,a=s+r-1;for(;s<=a;){const l=s+a>>>1,c=t[l];if(c<i)s=l+1;else if(c>i)a=l-1;else return t[l+r]}return-1}uE(la);uE(bR);var ke;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(ke=ke||(ke={}));var va;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(va=va||(va={}));var Xi;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(Xi=Xi||(Xi={}));var ce;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(ce=ce||(ce={}));var w;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SECTION=94]="SECTION",t[t.SELECT=95]="SELECT",t[t.SOURCE=96]="SOURCE",t[t.SMALL=97]="SMALL",t[t.SPAN=98]="SPAN",t[t.STRIKE=99]="STRIKE",t[t.STRONG=100]="STRONG",t[t.STYLE=101]="STYLE",t[t.SUB=102]="SUB",t[t.SUMMARY=103]="SUMMARY",t[t.SUP=104]="SUP",t[t.TABLE=105]="TABLE",t[t.TBODY=106]="TBODY",t[t.TEMPLATE=107]="TEMPLATE",t[t.TEXTAREA=108]="TEXTAREA",t[t.TFOOT=109]="TFOOT",t[t.TD=110]="TD",t[t.TH=111]="TH",t[t.THEAD=112]="THEAD",t[t.TITLE=113]="TITLE",t[t.TR=114]="TR",t[t.TRACK=115]="TRACK",t[t.TT=116]="TT",t[t.U=117]="U",t[t.UL=118]="UL",t[t.SVG=119]="SVG",t[t.VAR=120]="VAR",t[t.WBR=121]="WBR",t[t.XMP=122]="XMP"})(w=w||(w={}));const SR=new Map([[ce.A,w.A],[ce.ADDRESS,w.ADDRESS],[ce.ANNOTATION_XML,w.ANNOTATION_XML],[ce.APPLET,w.APPLET],[ce.AREA,w.AREA],[ce.ARTICLE,w.ARTICLE],[ce.ASIDE,w.ASIDE],[ce.B,w.B],[ce.BASE,w.BASE],[ce.BASEFONT,w.BASEFONT],[ce.BGSOUND,w.BGSOUND],[ce.BIG,w.BIG],[ce.BLOCKQUOTE,w.BLOCKQUOTE],[ce.BODY,w.BODY],[ce.BR,w.BR],[ce.BUTTON,w.BUTTON],[ce.CAPTION,w.CAPTION],[ce.CENTER,w.CENTER],[ce.CODE,w.CODE],[ce.COL,w.COL],[ce.COLGROUP,w.COLGROUP],[ce.DD,w.DD],[ce.DESC,w.DESC],[ce.DETAILS,w.DETAILS],[ce.DIALOG,w.DIALOG],[ce.DIR,w.DIR],[ce.DIV,w.DIV],[ce.DL,w.DL],[ce.DT,w.DT],[ce.EM,w.EM],[ce.EMBED,w.EMBED],[ce.FIELDSET,w.FIELDSET],[ce.FIGCAPTION,w.FIGCAPTION],[ce.FIGURE,w.FIGURE],[ce.FONT,w.FONT],[ce.FOOTER,w.FOOTER],[ce.FOREIGN_OBJECT,w.FOREIGN_OBJECT],[ce.FORM,w.FORM],[ce.FRAME,w.FRAME],[ce.FRAMESET,w.FRAMESET],[ce.H1,w.H1],[ce.H2,w.H2],[ce.H3,w.H3],[ce.H4,w.H4],[ce.H5,w.H5],[ce.H6,w.H6],[ce.HEAD,w.HEAD],[ce.HEADER,w.HEADER],[ce.HGROUP,w.HGROUP],[ce.HR,w.HR],[ce.HTML,w.HTML],[ce.I,w.I],[ce.IMG,w.IMG],[ce.IMAGE,w.IMAGE],[ce.INPUT,w.INPUT],[ce.IFRAME,w.IFRAME],[ce.KEYGEN,w.KEYGEN],[ce.LABEL,w.LABEL],[ce.LI,w.LI],[ce.LINK,w.LINK],[ce.LISTING,w.LISTING],[ce.MAIN,w.MAIN],[ce.MALIGNMARK,w.MALIGNMARK],[ce.MARQUEE,w.MARQUEE],[ce.MATH,w.MATH],[ce.MENU,w.MENU],[ce.META,w.META],[ce.MGLYPH,w.MGLYPH],[ce.MI,w.MI],[ce.MO,w.MO],[ce.MN,w.MN],[ce.MS,w.MS],[ce.MTEXT,w.MTEXT],[ce.NAV,w.NAV],[ce.NOBR,w.NOBR],[ce.NOFRAMES,w.NOFRAMES],[ce.NOEMBED,w.NOEMBED],[ce.NOSCRIPT,w.NOSCRIPT],[ce.OBJECT,w.OBJECT],[ce.OL,w.OL],[ce.OPTGROUP,w.OPTGROUP],[ce.OPTION,w.OPTION],[ce.P,w.P],[ce.PARAM,w.PARAM],[ce.PLAINTEXT,w.PLAINTEXT],[ce.PRE,w.PRE],[ce.RB,w.RB],[ce.RP,w.RP],[ce.RT,w.RT],[ce.RTC,w.RTC],[ce.RUBY,w.RUBY],[ce.S,w.S],[ce.SCRIPT,w.SCRIPT],[ce.SECTION,w.SECTION],[ce.SELECT,w.SELECT],[ce.SOURCE,w.SOURCE],[ce.SMALL,w.SMALL],[ce.SPAN,w.SPAN],[ce.STRIKE,w.STRIKE],[ce.STRONG,w.STRONG],[ce.STYLE,w.STYLE],[ce.SUB,w.SUB],[ce.SUMMARY,w.SUMMARY],[ce.SUP,w.SUP],[ce.TABLE,w.TABLE],[ce.TBODY,w.TBODY],[ce.TEMPLATE,w.TEMPLATE],[ce.TEXTAREA,w.TEXTAREA],[ce.TFOOT,w.TFOOT],[ce.TD,w.TD],[ce.TH,w.TH],[ce.THEAD,w.THEAD],[ce.TITLE,w.TITLE],[ce.TR,w.TR],[ce.TRACK,w.TRACK],[ce.TT,w.TT],[ce.U,w.U],[ce.UL,w.UL],[ce.SVG,w.SVG],[ce.VAR,w.VAR],[ce.WBR,w.WBR],[ce.XMP,w.XMP]]);function Zg(t){var e;return(e=SR.get(t))!==null&&e!==void 0?e:w.UNKNOWN}const Me=w,TR={[ke.HTML]:new Set([Me.ADDRESS,Me.APPLET,Me.AREA,Me.ARTICLE,Me.ASIDE,Me.BASE,Me.BASEFONT,Me.BGSOUND,Me.BLOCKQUOTE,Me.BODY,Me.BR,Me.BUTTON,Me.CAPTION,Me.CENTER,Me.COL,Me.COLGROUP,Me.DD,Me.DETAILS,Me.DIR,Me.DIV,Me.DL,Me.DT,Me.EMBED,Me.FIELDSET,Me.FIGCAPTION,Me.FIGURE,Me.FOOTER,Me.FORM,Me.FRAME,Me.FRAMESET,Me.H1,Me.H2,Me.H3,Me.H4,Me.H5,Me.H6,Me.HEAD,Me.HEADER,Me.HGROUP,Me.HR,Me.HTML,Me.IFRAME,Me.IMG,Me.INPUT,Me.LI,Me.LINK,Me.LISTING,Me.MAIN,Me.MARQUEE,Me.MENU,Me.META,Me.NAV,Me.NOEMBED,Me.NOFRAMES,Me.NOSCRIPT,Me.OBJECT,Me.OL,Me.P,Me.PARAM,Me.PLAINTEXT,Me.PRE,Me.SCRIPT,Me.SECTION,Me.SELECT,Me.SOURCE,Me.STYLE,Me.SUMMARY,Me.TABLE,Me.TBODY,Me.TD,Me.TEMPLATE,Me.TEXTAREA,Me.TFOOT,Me.TH,Me.THEAD,Me.TITLE,Me.TR,Me.TRACK,Me.UL,Me.WBR,Me.XMP]),[ke.MATHML]:new Set([Me.MI,Me.MO,Me.MN,Me.MS,Me.MTEXT,Me.ANNOTATION_XML]),[ke.SVG]:new Set([Me.TITLE,Me.FOREIGN_OBJECT,Me.DESC]),[ke.XLINK]:new Set,[ke.XML]:new Set,[ke.XMLNS]:new Set};function pE(t){return t===Me.H1||t===Me.H2||t===Me.H3||t===Me.H4||t===Me.H5||t===Me.H6}ce.STYLE,ce.SCRIPT,ce.XMP,ce.IFRAME,ce.NOEMBED,ce.NOFRAMES,ce.PLAINTEXT;const IR=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var z;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",t[t.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",t[t.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",t[t.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",t[t.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",t[t.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(z||(z={}));const Mi={DATA:z.DATA,RCDATA:z.RCDATA,RAWTEXT:z.RAWTEXT,SCRIPT_DATA:z.SCRIPT_DATA,PLAINTEXT:z.PLAINTEXT,CDATA_SECTION:z.CDATA_SECTION};function wh(t){return t>=F.DIGIT_0&&t<=F.DIGIT_9}function rh(t){return t>=F.LATIN_CAPITAL_A&&t<=F.LATIN_CAPITAL_Z}function LR(t){return t>=F.LATIN_SMALL_A&&t<=F.LATIN_SMALL_Z}function ca(t){return LR(t)||rh(t)}function B7(t){return ca(t)||wh(t)}function fE(t){return t>=F.LATIN_CAPITAL_A&&t<=F.LATIN_CAPITAL_F}function gE(t){return t>=F.LATIN_SMALL_A&&t<=F.LATIN_SMALL_F}function MR(t){return wh(t)||fE(t)||gE(t)}function ff(t){return t+32}function mE(t){return t===F.SPACE||t===F.LINE_FEED||t===F.TABULATION||t===F.FORM_FEED}function PR(t){return t===F.EQUALS_SIGN||B7(t)}function aw(t){return mE(t)||t===F.SOLIDUS||t===F.GREATER_THAN_SIGN}class AR{constructor(e,n){this.options=e,this.handler=n,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=z.DATA,this.returnState=z.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new mR(n),this.currentLocation=this.getCurrentLocation(-1)}_err(e){var n,i;(i=(n=this.handler).onParseError)===null||i===void 0||i.call(n,this.preprocessor.getError(e))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e?.())}write(e,n,i){this.active=!0,this.preprocessor.write(e,n),this._runParsingLoop(),this.paused||i?.()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(e){this.consumedAfterSnapshot-=e,this.preprocessor.retreat(e)}_reconsumeInState(e,n){this.state=e,this._callState(n)}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let n=0;n<e;n++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,n){return this.preprocessor.startsWith(e,n)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:mt.START_TAG,tagName:"",tagID:w.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:mt.END_TAG,tagName:"",tagID:w.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:mt.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:mt.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,n){this.currentCharacterToken={type:e,chars:n,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,n;const i=this.currentToken;if(dE(i,this.currentAttr.name)===null){if(i.attrs.push(this.currentAttr),i.location&&this.currentLocation){const r=(e=(n=i.location).attrs)!==null&&e!==void 0?e:n.attrs=Object.create(null);r[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ye.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=Zg(e.tagName),e.type===mt.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(ye.endTagWithAttributes),e.selfClosing&&this._err(ye.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case mt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case mt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case mt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:mt.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,n){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==e)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=n;return}this._createCharacterToken(e,n)}_emitCodePoint(e){const n=mE(e)?mt.WHITESPACE_CHARACTER:e===F.NULL?mt.NULL_CHARACTER:mt.CHARACTER;this._appendCharToCurrentCharacterToken(n,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(mt.CHARACTER,e)}_matchNamedCharacterReference(e){let n=null,i=0,r=!1;for(let o=0,s=la[0];o>=0&&(o=hE(la,s,o+1,e),!(o<0));e=this._consume()){i+=1,s=la[o];const a=s&vo.VALUE_LENGTH;if(a){const l=(a>>14)-1;if(e!==F.SEMICOLON&&this._isCharacterReferenceInAttribute()&&PR(this.preprocessor.peek(1))?(n=[F.AMPERSAND],o+=l):(n=l===0?[la[o]&~vo.VALUE_LENGTH]:l===1?[la[++o]]:[la[++o],la[++o]],i=0,r=e!==F.SEMICOLON),l===0){this._consume();break}}}return this._unconsume(i),r&&!this.preprocessor.endOfChunkHit&&this._err(ye.missingSemicolonAfterCharacterReference),this._unconsume(1),n}_isCharacterReferenceInAttribute(){return this.returnState===z.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===z.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===z.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case z.DATA:{this._stateData(e);break}case z.RCDATA:{this._stateRcdata(e);break}case z.RAWTEXT:{this._stateRawtext(e);break}case z.SCRIPT_DATA:{this._stateScriptData(e);break}case z.PLAINTEXT:{this._statePlaintext(e);break}case z.TAG_OPEN:{this._stateTagOpen(e);break}case z.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case z.TAG_NAME:{this._stateTagName(e);break}case z.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case z.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case z.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case z.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case z.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case z.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case z.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case z.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case z.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case z.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case z.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case z.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case z.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case z.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case z.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case z.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case z.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case z.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case z.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case z.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case z.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case z.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case z.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case z.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case z.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case z.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case z.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case z.BOGUS_COMMENT:{this._stateBogusComment(e);break}case z.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case z.COMMENT_START:{this._stateCommentStart(e);break}case z.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case z.COMMENT:{this._stateComment(e);break}case z.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case z.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case z.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case z.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case z.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case z.COMMENT_END:{this._stateCommentEnd(e);break}case z.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case z.DOCTYPE:{this._stateDoctype(e);break}case z.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case z.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case z.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case z.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case z.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case z.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case z.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case z.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case z.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case z.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case z.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case z.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case z.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case z.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case z.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case z.CDATA_SECTION:{this._stateCdataSection(e);break}case z.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case z.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case z.CHARACTER_REFERENCE:{this._stateCharacterReference(e);break}case z.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(e);break}case z.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}case z.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(e);break}case z.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(e);break}case z.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(e);break}case z.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(e);break}case z.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case F.LESS_THAN_SIGN:{this.state=z.TAG_OPEN;break}case F.AMPERSAND:{this.returnState=z.DATA,this.state=z.CHARACTER_REFERENCE;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitCodePoint(e);break}case F.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case F.AMPERSAND:{this.returnState=z.RCDATA,this.state=z.CHARACTER_REFERENCE;break}case F.LESS_THAN_SIGN:{this.state=z.RCDATA_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case F.LESS_THAN_SIGN:{this.state=z.RAWTEXT_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(ca(e))this._createStartTagToken(),this.state=z.TAG_NAME,this._stateTagName(e);else switch(e){case F.EXCLAMATION_MARK:{this.state=z.MARKUP_DECLARATION_OPEN;break}case F.SOLIDUS:{this.state=z.END_TAG_OPEN;break}case F.QUESTION_MARK:{this._err(ye.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=z.BOGUS_COMMENT,this._stateBogusComment(e);break}case F.EOF:{this._err(ye.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ye.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=z.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(ca(e))this._createEndTagToken(),this.state=z.TAG_NAME,this._stateTagName(e);else switch(e){case F.GREATER_THAN_SIGN:{this._err(ye.missingEndTagName),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ye.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=z.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.BEFORE_ATTRIBUTE_NAME;break}case F.SOLIDUS:{this.state=z.SELF_CLOSING_START_TAG;break}case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentTagToken();break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.tagName+=Ut;break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:n.tagName+=String.fromCodePoint(rh(e)?ff(e):e)}}_stateRcdataLessThanSign(e){e===F.SOLIDUS?this.state=z.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=z.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){ca(e)?(this.state=z.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=z.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const n=this.currentToken;switch(n.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=z.BEFORE_ATTRIBUTE_NAME,!1;case F.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=z.SELF_CLOSING_START_TAG,!1;case F.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=z.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=z.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===F.SOLIDUS?this.state=z.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=z.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){ca(e)?(this.state=z.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=z.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=z.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case F.SOLIDUS:{this.state=z.SCRIPT_DATA_END_TAG_OPEN;break}case F.EXCLAMATION_MARK:{this.state=z.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=z.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){ca(e)?(this.state=z.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=z.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=z.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===F.HYPHEN_MINUS?(this.state=z.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=z.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===F.HYPHEN_MINUS?(this.state=z.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=z.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case F.HYPHEN_MINUS:{this.state=z.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case F.HYPHEN_MINUS:{this.state=z.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.state=z.SCRIPT_DATA_ESCAPED,this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=z.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case F.HYPHEN_MINUS:{this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case F.GREATER_THAN_SIGN:{this.state=z.SCRIPT_DATA,this._emitChars(">");break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.state=z.SCRIPT_DATA_ESCAPED,this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=z.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===F.SOLIDUS?this.state=z.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:ca(e)?(this._emitChars("<"),this.state=z.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=z.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){ca(e)?(this.state=z.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=z.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=z.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Ei.SCRIPT,!1)&&aw(this.preprocessor.peek(Ei.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Ei.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=z.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case F.HYPHEN_MINUS:{this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case F.HYPHEN_MINUS:{this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case F.HYPHEN_MINUS:{this._emitChars("-");break}case F.LESS_THAN_SIGN:{this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case F.GREATER_THAN_SIGN:{this.state=z.SCRIPT_DATA,this._emitChars(">");break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Ut);break}case F.EOF:{this._err(ye.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===F.SOLIDUS?(this.state=z.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Ei.SCRIPT,!1)&&aw(this.preprocessor.peek(Ei.SCRIPT.length))){this._emitCodePoint(e);for(let n=0;n<Ei.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=z.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=z.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.SOLIDUS:case F.GREATER_THAN_SIGN:case F.EOF:{this.state=z.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case F.EQUALS_SIGN:{this._err(ye.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=z.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=z.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:case F.SOLIDUS:case F.GREATER_THAN_SIGN:case F.EOF:{this._leaveAttrName(),this.state=z.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case F.EQUALS_SIGN:{this._leaveAttrName(),this.state=z.BEFORE_ATTRIBUTE_VALUE;break}case F.QUOTATION_MARK:case F.APOSTROPHE:case F.LESS_THAN_SIGN:{this._err(ye.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.currentAttr.name+=Ut;break}default:this.currentAttr.name+=String.fromCodePoint(rh(e)?ff(e):e)}}_stateAfterAttributeName(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.SOLIDUS:{this.state=z.SELF_CLOSING_START_TAG;break}case F.EQUALS_SIGN:{this.state=z.BEFORE_ATTRIBUTE_VALUE;break}case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentTagToken();break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=z.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.QUOTATION_MARK:{this.state=z.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case F.APOSTROPHE:{this.state=z.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingAttributeValue),this.state=z.DATA,this.emitCurrentTagToken();break}default:this.state=z.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case F.QUOTATION_MARK:{this.state=z.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case F.AMPERSAND:{this.returnState=z.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=z.CHARACTER_REFERENCE;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.currentAttr.value+=Ut;break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case F.APOSTROPHE:{this.state=z.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case F.AMPERSAND:{this.returnState=z.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=z.CHARACTER_REFERENCE;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.currentAttr.value+=Ut;break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this._leaveAttrValue(),this.state=z.BEFORE_ATTRIBUTE_NAME;break}case F.AMPERSAND:{this.returnState=z.ATTRIBUTE_VALUE_UNQUOTED,this.state=z.CHARACTER_REFERENCE;break}case F.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=z.DATA,this.emitCurrentTagToken();break}case F.NULL:{this._err(ye.unexpectedNullCharacter),this.currentAttr.value+=Ut;break}case F.QUOTATION_MARK:case F.APOSTROPHE:case F.LESS_THAN_SIGN:case F.EQUALS_SIGN:case F.GRAVE_ACCENT:{this._err(ye.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this._leaveAttrValue(),this.state=z.BEFORE_ATTRIBUTE_NAME;break}case F.SOLIDUS:{this._leaveAttrValue(),this.state=z.SELF_CLOSING_START_TAG;break}case F.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=z.DATA,this.emitCurrentTagToken();break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this._err(ye.missingWhitespaceBetweenAttributes),this.state=z.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case F.GREATER_THAN_SIGN:{const n=this.currentToken;n.selfClosing=!0,this.state=z.DATA,this.emitCurrentTagToken();break}case F.EOF:{this._err(ye.eofInTag),this._emitEOFToken();break}default:this._err(ye.unexpectedSolidusInTag),this.state=z.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const n=this.currentToken;switch(e){case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentComment(n);break}case F.EOF:{this.emitCurrentComment(n),this._emitEOFToken();break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.data+=Ut;break}default:n.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Ei.DASH_DASH,!0)?(this._createCommentToken(Ei.DASH_DASH.length+1),this.state=z.COMMENT_START):this._consumeSequenceIfMatch(Ei.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Ei.DOCTYPE.length+1),this.state=z.DOCTYPE):this._consumeSequenceIfMatch(Ei.CDATA_START,!0)?this.inForeignNode?this.state=z.CDATA_SECTION:(this._err(ye.cdataInHtmlContent),this._createCommentToken(Ei.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=z.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ye.incorrectlyOpenedComment),this._createCommentToken(2),this.state=z.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case F.HYPHEN_MINUS:{this.state=z.COMMENT_START_DASH;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptClosingOfEmptyComment),this.state=z.DATA;const n=this.currentToken;this.emitCurrentComment(n);break}default:this.state=z.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const n=this.currentToken;switch(e){case F.HYPHEN_MINUS:{this.state=z.COMMENT_END;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptClosingOfEmptyComment),this.state=z.DATA,this.emitCurrentComment(n);break}case F.EOF:{this._err(ye.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=z.COMMENT,this._stateComment(e)}}_stateComment(e){const n=this.currentToken;switch(e){case F.HYPHEN_MINUS:{this.state=z.COMMENT_END_DASH;break}case F.LESS_THAN_SIGN:{n.data+="<",this.state=z.COMMENT_LESS_THAN_SIGN;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.data+=Ut;break}case F.EOF:{this._err(ye.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const n=this.currentToken;switch(e){case F.EXCLAMATION_MARK:{n.data+="!",this.state=z.COMMENT_LESS_THAN_SIGN_BANG;break}case F.LESS_THAN_SIGN:{n.data+="<";break}default:this.state=z.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===F.HYPHEN_MINUS?this.state=z.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=z.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===F.HYPHEN_MINUS?this.state=z.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=z.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==F.GREATER_THAN_SIGN&&e!==F.EOF&&this._err(ye.nestedComment),this.state=z.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const n=this.currentToken;switch(e){case F.HYPHEN_MINUS:{this.state=z.COMMENT_END;break}case F.EOF:{this._err(ye.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=z.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const n=this.currentToken;switch(e){case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentComment(n);break}case F.EXCLAMATION_MARK:{this.state=z.COMMENT_END_BANG;break}case F.HYPHEN_MINUS:{n.data+="-";break}case F.EOF:{this._err(ye.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--",this.state=z.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const n=this.currentToken;switch(e){case F.HYPHEN_MINUS:{n.data+="--!",this.state=z.COMMENT_END_DASH;break}case F.GREATER_THAN_SIGN:{this._err(ye.incorrectlyClosedComment),this.state=z.DATA,this.emitCurrentComment(n);break}case F.EOF:{this._err(ye.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--!",this.state=z.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.BEFORE_DOCTYPE_NAME;break}case F.GREATER_THAN_SIGN:{this.state=z.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case F.EOF:{this._err(ye.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingWhitespaceBeforeDoctypeName),this.state=z.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(rh(e))this._createDoctypeToken(String.fromCharCode(ff(e))),this.state=z.DOCTYPE_NAME;else switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.NULL:{this._err(ye.unexpectedNullCharacter),this._createDoctypeToken(Ut),this.state=z.DOCTYPE_NAME;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingDoctypeName),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=z.DOCTYPE_NAME}}_stateDoctypeName(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.AFTER_DOCTYPE_NAME;break}case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.name+=Ut;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.name+=String.fromCodePoint(rh(e)?ff(e):e)}}_stateAfterDoctypeName(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Ei.PUBLIC,!1)?this.state=z.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Ei.SYSTEM,!1)?this.state=z.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ye.invalidCharacterSequenceAfterDoctypeName),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case F.QUOTATION_MARK:{this._err(ye.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=z.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{this._err(ye.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=z.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.QUOTATION_MARK:{n.publicId="",this.state=z.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{n.publicId="",this.state=z.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case F.QUOTATION_MARK:{this.state=z.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.publicId+=Ut;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case F.APOSTROPHE:{this.state=z.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.publicId+=Ut;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case F.GREATER_THAN_SIGN:{this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.QUOTATION_MARK:{this._err(ye.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{this._err(ye.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.QUOTATION_MARK:{n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:{this.state=z.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case F.QUOTATION_MARK:{this._err(ye.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{this._err(ye.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.QUOTATION_MARK:{n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case F.APOSTROPHE:{n.systemId="",this.state=z.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case F.GREATER_THAN_SIGN:{this._err(ye.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.DATA,this.emitCurrentDoctype(n);break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const n=this.currentToken;switch(e){case F.QUOTATION_MARK:{this.state=z.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.systemId+=Ut;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const n=this.currentToken;switch(e){case F.APOSTROPHE:{this.state=z.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case F.NULL:{this._err(ye.unexpectedNullCharacter),n.systemId+=Ut;break}case F.GREATER_THAN_SIGN:{this._err(ye.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const n=this.currentToken;switch(e){case F.SPACE:case F.LINE_FEED:case F.TABULATION:case F.FORM_FEED:break;case F.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.EOF:{this._err(ye.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(ye.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=z.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const n=this.currentToken;switch(e){case F.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=z.DATA;break}case F.NULL:{this._err(ye.unexpectedNullCharacter);break}case F.EOF:{this.emitCurrentDoctype(n),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case F.RIGHT_SQUARE_BRACKET:{this.state=z.CDATA_SECTION_BRACKET;break}case F.EOF:{this._err(ye.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===F.RIGHT_SQUARE_BRACKET?this.state=z.CDATA_SECTION_END:(this._emitChars("]"),this.state=z.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case F.GREATER_THAN_SIGN:{this.state=z.DATA;break}case F.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=z.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(e){e===F.NUMBER_SIGN?this.state=z.NUMERIC_CHARACTER_REFERENCE:B7(e)?(this.state=z.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(e)):(this._flushCodePointConsumedAsCharacterReference(F.AMPERSAND),this._reconsumeInState(this.returnState,e))}_stateNamedCharacterReference(e){const n=this._matchNamedCharacterReference(e);if(!this._ensureHibernation())if(n){for(let i=0;i<n.length;i++)this._flushCodePointConsumedAsCharacterReference(n[i]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(F.AMPERSAND),this.state=z.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(e){B7(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===F.SEMICOLON&&this._err(ye.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,e))}_stateNumericCharacterReference(e){this.charRefCode=0,e===F.LATIN_SMALL_X||e===F.LATIN_CAPITAL_X?this.state=z.HEXADEMICAL_CHARACTER_REFERENCE_START:wh(e)?(this.state=z.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(e)):(this._err(ye.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(F.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(F.NUMBER_SIGN),this._reconsumeInState(this.returnState,e))}_stateHexademicalCharacterReferenceStart(e){MR(e)?(this.state=z.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(e)):(this._err(ye.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(F.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(F.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(e){fE(e)?this.charRefCode=this.charRefCode*16+e-55:gE(e)?this.charRefCode=this.charRefCode*16+e-87:wh(e)?this.charRefCode=this.charRefCode*16+e-48:e===F.SEMICOLON?this.state=z.NUMERIC_CHARACTER_REFERENCE_END:(this._err(ye.missingSemicolonAfterCharacterReference),this.state=z.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateDecimalCharacterReference(e){wh(e)?this.charRefCode=this.charRefCode*10+e-48:e===F.SEMICOLON?this.state=z.NUMERIC_CHARACTER_REFERENCE_END:(this._err(ye.missingSemicolonAfterCharacterReference),this.state=z.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateNumericCharacterReferenceEnd(e){if(this.charRefCode===F.NULL)this._err(ye.nullCharacterReference),this.charRefCode=F.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(ye.characterReferenceOutsideUnicodeRange),this.charRefCode=F.REPLACEMENT_CHARACTER;else if(aE(this.charRefCode))this._err(ye.surrogateCharacterReference),this.charRefCode=F.REPLACEMENT_CHARACTER;else if(cE(this.charRefCode))this._err(ye.noncharacterCharacterReference);else if(lE(this.charRefCode)||this.charRefCode===F.CARRIAGE_RETURN){this._err(ye.controlCharacterReference);const n=IR.get(this.charRefCode);n!==void 0&&(this.charRefCode=n)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,e)}}const bE=new Set([w.DD,w.DT,w.LI,w.OPTGROUP,w.OPTION,w.P,w.RB,w.RP,w.RT,w.RTC]),lw=new Set([...bE,w.CAPTION,w.COLGROUP,w.TBODY,w.TD,w.TFOOT,w.TH,w.THEAD,w.TR]),gf=new Map([[w.APPLET,ke.HTML],[w.CAPTION,ke.HTML],[w.HTML,ke.HTML],[w.MARQUEE,ke.HTML],[w.OBJECT,ke.HTML],[w.TABLE,ke.HTML],[w.TD,ke.HTML],[w.TEMPLATE,ke.HTML],[w.TH,ke.HTML],[w.ANNOTATION_XML,ke.MATHML],[w.MI,ke.MATHML],[w.MN,ke.MATHML],[w.MO,ke.MATHML],[w.MS,ke.MATHML],[w.MTEXT,ke.MATHML],[w.DESC,ke.SVG],[w.FOREIGN_OBJECT,ke.SVG],[w.TITLE,ke.SVG]]),$R=[w.H1,w.H2,w.H3,w.H4,w.H5,w.H6],BR=[w.TR,w.TEMPLATE,w.HTML],DR=[w.TBODY,w.TFOOT,w.THEAD,w.TEMPLATE,w.HTML],OR=[w.TABLE,w.TEMPLATE,w.HTML],RR=[w.TD,w.TH];class NR{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,n,i){this.treeAdapter=n,this.handler=i,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=w.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===w.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===ke.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,n){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=n,this.currentTagId=n,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,n,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,n){const i=this._indexOf(e);this.items[i]=n,i===this.stackTop&&(this.current=n)}insertAfter(e,n,i){const r=this._indexOf(e)+1;this.items.splice(r,0,n),this.tagIDs.splice(r,0,i),this.stackTop++,r===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,r===this.stackTop)}popUntilTagNamePopped(e){let n=this.stackTop+1;do n=this.tagIDs.lastIndexOf(e,n-1);while(n>0&&this.treeAdapter.getNamespaceURI(this.items[n])!==ke.HTML);this.shortenToLength(n<0?0:n)}shortenToLength(e){for(;this.stackTop>=e;){const n=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(n,this.stackTop<e)}}popUntilElementPopped(e){const n=this._indexOf(e);this.shortenToLength(n<0?0:n)}popUntilPopped(e,n){const i=this._indexOfTagNames(e,n);this.shortenToLength(i<0?0:i)}popUntilNumberedHeaderPopped(){this.popUntilPopped($R,ke.HTML)}popUntilTableCellPopped(){this.popUntilPopped(RR,ke.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,n){for(let i=this.stackTop;i>=0;i--)if(e.includes(this.tagIDs[i])&&this.treeAdapter.getNamespaceURI(this.items[i])===n)return i;return-1}clearBackTo(e,n){const i=this._indexOfTagNames(e,n);this.shortenToLength(i+1)}clearBackToTableContext(){this.clearBackTo(OR,ke.HTML)}clearBackToTableBodyContext(){this.clearBackTo(DR,ke.HTML)}clearBackToTableRowContext(){this.clearBackTo(BR,ke.HTML)}remove(e){const n=this._indexOf(e);n>=0&&(n===this.stackTop?this.pop():(this.items.splice(n,1),this.tagIDs.splice(n,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===w.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const n=this._indexOf(e)-1;return n>=0?this.items[n]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===w.HTML}hasInScope(e){for(let n=this.stackTop;n>=0;n--){const i=this.tagIDs[n],r=this.treeAdapter.getNamespaceURI(this.items[n]);if(i===e&&r===ke.HTML)return!0;if(gf.get(i)===r)return!1}return!0}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const n=this.tagIDs[e],i=this.treeAdapter.getNamespaceURI(this.items[e]);if(pE(n)&&i===ke.HTML)return!0;if(gf.get(n)===i)return!1}return!0}hasInListItemScope(e){for(let n=this.stackTop;n>=0;n--){const i=this.tagIDs[n],r=this.treeAdapter.getNamespaceURI(this.items[n]);if(i===e&&r===ke.HTML)return!0;if((i===w.UL||i===w.OL)&&r===ke.HTML||gf.get(i)===r)return!1}return!0}hasInButtonScope(e){for(let n=this.stackTop;n>=0;n--){const i=this.tagIDs[n],r=this.treeAdapter.getNamespaceURI(this.items[n]);if(i===e&&r===ke.HTML)return!0;if(i===w.BUTTON&&r===ke.HTML||gf.get(i)===r)return!1}return!0}hasInTableScope(e){for(let n=this.stackTop;n>=0;n--){const i=this.tagIDs[n];if(this.treeAdapter.getNamespaceURI(this.items[n])===ke.HTML){if(i===e)return!0;if(i===w.TABLE||i===w.TEMPLATE||i===w.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--){const n=this.tagIDs[e];if(this.treeAdapter.getNamespaceURI(this.items[e])===ke.HTML){if(n===w.TBODY||n===w.THEAD||n===w.TFOOT)return!0;if(n===w.TABLE||n===w.HTML)return!1}}return!0}hasInSelectScope(e){for(let n=this.stackTop;n>=0;n--){const i=this.tagIDs[n];if(this.treeAdapter.getNamespaceURI(this.items[n])===ke.HTML){if(i===e)return!0;if(i!==w.OPTION&&i!==w.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;bE.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;lw.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&lw.has(this.currentTagId);)this.pop()}}const Z4=3;var Vr;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(Vr=Vr||(Vr={}));const cw={type:Vr.Marker};class HR{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,n){const i=[],r=n.length,o=this.treeAdapter.getTagName(e),s=this.treeAdapter.getNamespaceURI(e);for(let a=0;a<this.entries.length;a++){const l=this.entries[a];if(l.type===Vr.Marker)break;const{element:c}=l;if(this.treeAdapter.getTagName(c)===o&&this.treeAdapter.getNamespaceURI(c)===s){const d=this.treeAdapter.getAttrList(c);d.length===r&&i.push({idx:a,attrs:d})}}return i}_ensureNoahArkCondition(e){if(this.entries.length<Z4)return;const n=this.treeAdapter.getAttrList(e),i=this._getNoahArkConditionCandidates(e,n);if(i.length<Z4)return;const r=new Map(n.map(s=>[s.name,s.value]));let o=0;for(let s=0;s<i.length;s++){const a=i[s];a.attrs.every(l=>r.get(l.name)===l.value)&&(o+=1,o>=Z4&&this.entries.splice(a.idx,1))}}insertMarker(){this.entries.unshift(cw)}pushElement(e,n){this._ensureNoahArkCondition(e),this.entries.unshift({type:Vr.Element,element:e,token:n})}insertElementAfterBookmark(e,n){const i=this.entries.indexOf(this.bookmark);this.entries.splice(i,0,{type:Vr.Element,element:e,token:n})}removeEntry(e){const n=this.entries.indexOf(e);n>=0&&this.entries.splice(n,1)}clearToLastMarker(){const e=this.entries.indexOf(cw);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){const n=this.entries.find(i=>i.type===Vr.Marker||this.treeAdapter.getTagName(i.element)===e);return n&&n.type===Vr.Element?n:null}getElementEntry(e){return this.entries.find(n=>n.type===Vr.Element&&n.element===e)}}function dw(t){return{nodeName:"#text",value:t,parentNode:null}}const c1={createDocument(){return{nodeName:"#document",mode:Xi.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,n){return{nodeName:t,tagName:t,attrs:n,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,n){const i=t.childNodes.indexOf(n);t.childNodes.splice(i,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,n,i){const r=t.childNodes.find(o=>o.nodeName==="#documentType");if(r)r.name=e,r.publicId=n,r.systemId=i;else{const o={nodeName:"#documentType",name:e,publicId:n,systemId:i,parentNode:null};c1.appendChild(t,o)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){const e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){const n=t.childNodes[t.childNodes.length-1];if(c1.isTextNode(n)){n.value+=e;return}}c1.appendChild(t,dw(e))},insertTextBefore(t,e,n){const i=t.childNodes[t.childNodes.indexOf(n)-1];i&&c1.isTextNode(i)?i.value+=e:c1.insertBefore(t,dw(e),n)},adoptAttributes(t,e){const n=new Set(t.attrs.map(i=>i.name));for(let i=0;i<e.length;i++)n.has(e[i].name)||t.attrs.push(e[i])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}},vE="html",FR="about:legacy-compat",UR="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",yE=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],VR=[...yE,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],zR=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),wE=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],jR=[...wE,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function uw(t,e){return e.some(n=>t.startsWith(n))}function GR(t){return t.name===vE&&t.publicId===null&&(t.systemId===null||t.systemId===FR)}function ZR(t){if(t.name!==vE)return Xi.QUIRKS;const{systemId:e}=t;if(e&&e.toLowerCase()===UR)return Xi.QUIRKS;let{publicId:n}=t;if(n!==null){if(n=n.toLowerCase(),zR.has(n))return Xi.QUIRKS;let i=e===null?VR:yE;if(uw(n,i))return Xi.QUIRKS;if(i=e===null?wE:jR,uw(n,i))return Xi.LIMITED_QUIRKS}return Xi.NO_QUIRKS}const hw={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},WR="definitionurl",qR="definitionURL",YR=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),XR=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:ke.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:ke.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:ke.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:ke.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:ke.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:ke.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:ke.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:ke.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:ke.XML}],["xml:space",{prefix:"xml",name:"space",namespace:ke.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:ke.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:ke.XMLNS}]]),KR=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),QR=new Set([w.B,w.BIG,w.BLOCKQUOTE,w.BODY,w.BR,w.CENTER,w.CODE,w.DD,w.DIV,w.DL,w.DT,w.EM,w.EMBED,w.H1,w.H2,w.H3,w.H4,w.H5,w.H6,w.HEAD,w.HR,w.I,w.IMG,w.LI,w.LISTING,w.MENU,w.META,w.NOBR,w.OL,w.P,w.PRE,w.RUBY,w.S,w.SMALL,w.SPAN,w.STRONG,w.STRIKE,w.SUB,w.SUP,w.TABLE,w.TT,w.U,w.UL,w.VAR]);function JR(t){const e=t.tagID;return e===w.FONT&&t.attrs.some(({name:i})=>i===va.COLOR||i===va.SIZE||i===va.FACE)||QR.has(e)}function xE(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===WR){t.attrs[e].name=qR;break}}function _E(t){for(let e=0;e<t.attrs.length;e++){const n=YR.get(t.attrs[e].name);n!=null&&(t.attrs[e].name=n)}}function e9(t){for(let e=0;e<t.attrs.length;e++){const n=XR.get(t.attrs[e].name);n&&(t.attrs[e].prefix=n.prefix,t.attrs[e].name=n.name,t.attrs[e].namespace=n.namespace)}}function eN(t){const e=KR.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=Zg(t.tagName))}function tN(t,e){return e===ke.MATHML&&(t===w.MI||t===w.MO||t===w.MN||t===w.MS||t===w.MTEXT)}function nN(t,e,n){if(e===ke.MATHML&&t===w.ANNOTATION_XML){for(let i=0;i<n.length;i++)if(n[i].name===va.ENCODING){const r=n[i].value.toLowerCase();return r===hw.TEXT_HTML||r===hw.APPLICATION_XML}}return e===ke.SVG&&(t===w.FOREIGN_OBJECT||t===w.DESC||t===w.TITLE)}function iN(t,e,n,i){return(!i||i===ke.HTML)&&nN(t,e,n)||(!i||i===ke.MATHML)&&tN(t,e)}const rN="hidden",oN=8,sN=3;var q;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(q||(q={}));const aN={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},CE=new Set([w.TABLE,w.TBODY,w.TFOOT,w.THEAD,w.TR]),pw={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:c1,onParseError:null};class kE{constructor(e,n,i=null,r=null){this.fragmentContext=i,this.scriptHandler=r,this.currentToken=null,this.stopped=!1,this.insertionMode=q.INITIAL,this.originalInsertionMode=q.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...pw,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=n??this.treeAdapter.createDocument(),this.tokenizer=new AR(this.options,this),this.activeFormattingElements=new HR(this.treeAdapter),this.fragmentContextID=i?Zg(this.treeAdapter.getTagName(i)):w.UNKNOWN,this._setContextModes(i??this.document,this.fragmentContextID),this.openElements=new NR(this.document,this.treeAdapter,this)}static parse(e,n){const i=new this(n);return i.tokenizer.write(e,!0),i.document}static getFragmentParser(e,n){const i={...pw,...n};e??(e=i.treeAdapter.createElement(ce.TEMPLATE,ke.HTML,[]));const r=i.treeAdapter.createElement("documentmock",ke.HTML,[]),o=new this(i,r,e);return o.fragmentContextID===w.TEMPLATE&&o.tmplInsertionModeStack.unshift(q.IN_TEMPLATE),o._initTokenizerForFragmentParsing(),o._insertFakeRootElement(),o._resetInsertionMode(),o._findFormInFragmentContext(),o}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),n=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,n),n}_err(e,n,i){var r;if(!this.onParseError)return;const o=(r=e.location)!==null&&r!==void 0?r:aN,s={code:n,startLine:o.startLine,startCol:o.startCol,startOffset:o.startOffset,endLine:i?o.startLine:o.endLine,endCol:i?o.startCol:o.endCol,endOffset:i?o.startOffset:o.endOffset};this.onParseError(s)}onItemPush(e,n,i){var r,o;(o=(r=this.treeAdapter).onItemPush)===null||o===void 0||o.call(r,e),i&&this.openElements.stackTop>0&&this._setContextModes(e,n)}onItemPop(e,n){var i,r;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(r=(i=this.treeAdapter).onItemPop)===null||r===void 0||r.call(i,e,this.openElements.current),n){let o,s;this.openElements.stackTop===0&&this.fragmentContext?(o=this.fragmentContext,s=this.fragmentContextID):{current:o,currentTagId:s}=this.openElements,this._setContextModes(o,s)}}_setContextModes(e,n){const i=e===this.document||this.treeAdapter.getNamespaceURI(e)===ke.HTML;this.currentNotInHTML=!i,this.tokenizer.inForeignNode=!i&&!this._isIntegrationPoint(n,e)}_switchToTextParsing(e,n){this._insertElement(e,ke.HTML),this.tokenizer.state=n,this.originalInsertionMode=this.insertionMode,this.insertionMode=q.TEXT}switchToPlaintextParsing(){this.insertionMode=q.TEXT,this.originalInsertionMode=q.IN_BODY,this.tokenizer.state=Mi.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===ce.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==ke.HTML))switch(this.fragmentContextID){case w.TITLE:case w.TEXTAREA:{this.tokenizer.state=Mi.RCDATA;break}case w.STYLE:case w.XMP:case w.IFRAME:case w.NOEMBED:case w.NOFRAMES:case w.NOSCRIPT:{this.tokenizer.state=Mi.RAWTEXT;break}case w.SCRIPT:{this.tokenizer.state=Mi.SCRIPT_DATA;break}case w.PLAINTEXT:{this.tokenizer.state=Mi.PLAINTEXT;break}}}_setDocumentType(e){const n=e.name||"",i=e.publicId||"",r=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,n,i,r),e.location){const s=this.treeAdapter.getChildNodes(this.document).find(a=>this.treeAdapter.isDocumentTypeNode(a));s&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}}_attachElementToTree(e,n){if(this.options.sourceCodeLocationInfo){const i=n&&{...n,startTag:n};this.treeAdapter.setNodeSourceCodeLocation(e,i)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const i=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(i,e)}}_appendElement(e,n){const i=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(i,e.location)}_insertElement(e,n){const i=this.treeAdapter.createElement(e.tagName,n,e.attrs);this._attachElementToTree(i,e.location),this.openElements.push(i,e.tagID)}_insertFakeElement(e,n){const i=this.treeAdapter.createElement(e,ke.HTML,[]);this._attachElementToTree(i,null),this.openElements.push(i,n)}_insertTemplate(e){const n=this.treeAdapter.createElement(e.tagName,ke.HTML,e.attrs),i=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(n,i),this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(ce.HTML,ke.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,w.HTML)}_appendCommentNode(e,n){const i=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(n,i),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}_insertCharacters(e){let n,i;if(this._shouldFosterParentOnInsertion()?({parent:n,beforeElement:i}=this._findFosterParentingLocation(),i?this.treeAdapter.insertTextBefore(n,e.chars,i):this.treeAdapter.insertText(n,e.chars)):(n=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(n,e.chars)),!e.location)return;const r=this.treeAdapter.getChildNodes(n),o=i?r.lastIndexOf(i):r.length,s=r[o-1];if(this.treeAdapter.getNodeSourceCodeLocation(s)){const{endLine:l,endCol:c,endOffset:d}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(s,{endLine:l,endCol:c,endOffset:d})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}_adoptNodes(e,n){for(let i=this.treeAdapter.getFirstChild(e);i;i=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(i),this.treeAdapter.appendChild(n,i)}_setEndLocation(e,n){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&n.location){const i=n.location,r=this.treeAdapter.getTagName(e),o=n.type===mt.END_TAG&&r===n.tagName?{endTag:{...i},endLine:i.endLine,endCol:i.endCol,endOffset:i.endOffset}:{endLine:i.startLine,endCol:i.startCol,endOffset:i.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,o)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let n,i;return this.openElements.stackTop===0&&this.fragmentContext?(n=this.fragmentContext,i=this.fragmentContextID):{current:n,currentTagId:i}=this.openElements,e.tagID===w.SVG&&this.treeAdapter.getTagName(n)===ce.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(n)===ke.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===w.MGLYPH||e.tagID===w.MALIGNMARK)&&!this._isIntegrationPoint(i,n,ke.HTML)}_processToken(e){switch(e.type){case mt.CHARACTER:{this.onCharacter(e);break}case mt.NULL_CHARACTER:{this.onNullCharacter(e);break}case mt.COMMENT:{this.onComment(e);break}case mt.DOCTYPE:{this.onDoctype(e);break}case mt.START_TAG:{this._processStartTag(e);break}case mt.END_TAG:{this.onEndTag(e);break}case mt.EOF:{this.onEof(e);break}case mt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,n,i){const r=this.treeAdapter.getNamespaceURI(n),o=this.treeAdapter.getAttrList(n);return iN(e,r,o,i)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const n=this.activeFormattingElements.entries.findIndex(r=>r.type===Vr.Marker||this.openElements.contains(r.element)),i=n<0?e-1:n-1;for(let r=i;r>=0;r--){const o=this.activeFormattingElements.entries[r];this._insertElement(o.token,this.treeAdapter.getNamespaceURI(o.element)),o.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=q.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(w.P),this.openElements.popUntilTagNamePopped(w.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case w.TR:{this.insertionMode=q.IN_ROW;return}case w.TBODY:case w.THEAD:case w.TFOOT:{this.insertionMode=q.IN_TABLE_BODY;return}case w.CAPTION:{this.insertionMode=q.IN_CAPTION;return}case w.COLGROUP:{this.insertionMode=q.IN_COLUMN_GROUP;return}case w.TABLE:{this.insertionMode=q.IN_TABLE;return}case w.BODY:{this.insertionMode=q.IN_BODY;return}case w.FRAMESET:{this.insertionMode=q.IN_FRAMESET;return}case w.SELECT:{this._resetInsertionModeForSelect(e);return}case w.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case w.HTML:{this.insertionMode=this.headElement?q.AFTER_HEAD:q.BEFORE_HEAD;return}case w.TD:case w.TH:{if(e>0){this.insertionMode=q.IN_CELL;return}break}case w.HEAD:{if(e>0){this.insertionMode=q.IN_HEAD;return}break}}this.insertionMode=q.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let n=e-1;n>0;n--){const i=this.openElements.tagIDs[n];if(i===w.TEMPLATE)break;if(i===w.TABLE){this.insertionMode=q.IN_SELECT_IN_TABLE;return}}this.insertionMode=q.IN_SELECT}_isElementCausesFosterParenting(e){return CE.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const n=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case w.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(n)===ke.HTML)return{parent:this.treeAdapter.getTemplateContent(n),beforeElement:null};break}case w.TABLE:{const i=this.treeAdapter.getParentNode(n);return i?{parent:i,beforeElement:n}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const n=this._findFosterParentingLocation();n.beforeElement?this.treeAdapter.insertBefore(n.parent,e,n.beforeElement):this.treeAdapter.appendChild(n.parent,e)}_isSpecialElement(e,n){const i=this.treeAdapter.getNamespaceURI(e);return TR[i].has(n)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){RH(this,e);return}switch(this.insertionMode){case q.INITIAL:{Ru(this,e);break}case q.BEFORE_HTML:{xh(this,e);break}case q.BEFORE_HEAD:{_h(this,e);break}case q.IN_HEAD:{Ch(this,e);break}case q.IN_HEAD_NO_SCRIPT:{kh(this,e);break}case q.AFTER_HEAD:{Eh(this,e);break}case q.IN_BODY:case q.IN_CAPTION:case q.IN_CELL:case q.IN_TEMPLATE:{SE(this,e);break}case q.TEXT:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:{W4(this,e);break}case q.IN_TABLE_TEXT:{AE(this,e);break}case q.IN_COLUMN_GROUP:{H2(this,e);break}case q.AFTER_BODY:{F2(this,e);break}case q.AFTER_AFTER_BODY:{r2(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){OH(this,e);return}switch(this.insertionMode){case q.INITIAL:{Ru(this,e);break}case q.BEFORE_HTML:{xh(this,e);break}case q.BEFORE_HEAD:{_h(this,e);break}case q.IN_HEAD:{Ch(this,e);break}case q.IN_HEAD_NO_SCRIPT:{kh(this,e);break}case q.AFTER_HEAD:{Eh(this,e);break}case q.TEXT:{this._insertCharacters(e);break}case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:{W4(this,e);break}case q.IN_COLUMN_GROUP:{H2(this,e);break}case q.AFTER_BODY:{F2(this,e);break}case q.AFTER_AFTER_BODY:{r2(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){D7(this,e);return}switch(this.insertionMode){case q.INITIAL:case q.BEFORE_HTML:case q.BEFORE_HEAD:case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:case q.IN_BODY:case q.IN_TABLE:case q.IN_CAPTION:case q.IN_COLUMN_GROUP:case q.IN_TABLE_BODY:case q.IN_ROW:case q.IN_CELL:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:case q.IN_TEMPLATE:case q.IN_FRAMESET:case q.AFTER_FRAMESET:{D7(this,e);break}case q.IN_TABLE_TEXT:{Nu(this,e);break}case q.AFTER_BODY:{fN(this,e);break}case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:{gN(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case q.INITIAL:{mN(this,e);break}case q.BEFORE_HEAD:case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:{this._err(e,ye.misplacedDoctype);break}case q.IN_TABLE_TEXT:{Nu(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,ye.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?NH(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case q.INITIAL:{Ru(this,e);break}case q.BEFORE_HTML:{bN(this,e);break}case q.BEFORE_HEAD:{yN(this,e);break}case q.IN_HEAD:{no(this,e);break}case q.IN_HEAD_NO_SCRIPT:{_N(this,e);break}case q.AFTER_HEAD:{kN(this,e);break}case q.IN_BODY:{ci(this,e);break}case q.IN_TABLE:{z1(this,e);break}case q.IN_TABLE_TEXT:{Nu(this,e);break}case q.IN_CAPTION:{wH(this,e);break}case q.IN_COLUMN_GROUP:{i9(this,e);break}case q.IN_TABLE_BODY:{Yg(this,e);break}case q.IN_ROW:{Xg(this,e);break}case q.IN_CELL:{CH(this,e);break}case q.IN_SELECT:{DE(this,e);break}case q.IN_SELECT_IN_TABLE:{EH(this,e);break}case q.IN_TEMPLATE:{TH(this,e);break}case q.AFTER_BODY:{LH(this,e);break}case q.IN_FRAMESET:{MH(this,e);break}case q.AFTER_FRAMESET:{AH(this,e);break}case q.AFTER_AFTER_BODY:{BH(this,e);break}case q.AFTER_AFTER_FRAMESET:{DH(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?HH(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case q.INITIAL:{Ru(this,e);break}case q.BEFORE_HTML:{vN(this,e);break}case q.BEFORE_HEAD:{wN(this,e);break}case q.IN_HEAD:{xN(this,e);break}case q.IN_HEAD_NO_SCRIPT:{CN(this,e);break}case q.AFTER_HEAD:{EN(this,e);break}case q.IN_BODY:{qg(this,e);break}case q.TEXT:{dH(this,e);break}case q.IN_TABLE:{zh(this,e);break}case q.IN_TABLE_TEXT:{Nu(this,e);break}case q.IN_CAPTION:{xH(this,e);break}case q.IN_COLUMN_GROUP:{_H(this,e);break}case q.IN_TABLE_BODY:{O7(this,e);break}case q.IN_ROW:{BE(this,e);break}case q.IN_CELL:{kH(this,e);break}case q.IN_SELECT:{OE(this,e);break}case q.IN_SELECT_IN_TABLE:{SH(this,e);break}case q.IN_TEMPLATE:{IH(this,e);break}case q.AFTER_BODY:{NE(this,e);break}case q.IN_FRAMESET:{PH(this,e);break}case q.AFTER_FRAMESET:{$H(this,e);break}case q.AFTER_AFTER_BODY:{r2(this,e);break}}}onEof(e){switch(this.insertionMode){case q.INITIAL:{Ru(this,e);break}case q.BEFORE_HTML:{xh(this,e);break}case q.BEFORE_HEAD:{_h(this,e);break}case q.IN_HEAD:{Ch(this,e);break}case q.IN_HEAD_NO_SCRIPT:{kh(this,e);break}case q.AFTER_HEAD:{Eh(this,e);break}case q.IN_BODY:case q.IN_TABLE:case q.IN_CAPTION:case q.IN_COLUMN_GROUP:case q.IN_TABLE_BODY:case q.IN_ROW:case q.IN_CELL:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:{ME(this,e);break}case q.TEXT:{uH(this,e);break}case q.IN_TABLE_TEXT:{Nu(this,e);break}case q.IN_TEMPLATE:{RE(this,e);break}case q.AFTER_BODY:case q.IN_FRAMESET:case q.AFTER_FRAMESET:case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:{n9(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===F.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:case q.TEXT:case q.IN_COLUMN_GROUP:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:case q.IN_FRAMESET:case q.AFTER_FRAMESET:{this._insertCharacters(e);break}case q.IN_BODY:case q.IN_CAPTION:case q.IN_CELL:case q.IN_TEMPLATE:case q.AFTER_BODY:case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:{EE(this,e);break}case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:{W4(this,e);break}case q.IN_TABLE_TEXT:{PE(this,e);break}}}}function lN(t,e){let n=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return n?t.openElements.contains(n.element)?t.openElements.hasInScope(e.tagID)||(n=null):(t.activeFormattingElements.removeEntry(n),n=null):LE(t,e),n}function cN(t,e){let n=null,i=t.openElements.stackTop;for(;i>=0;i--){const r=t.openElements.items[i];if(r===e.element)break;t._isSpecialElement(r,t.openElements.tagIDs[i])&&(n=r)}return n||(t.openElements.shortenToLength(i<0?0:i),t.activeFormattingElements.removeEntry(e)),n}function dN(t,e,n){let i=e,r=t.openElements.getCommonAncestor(e);for(let o=0,s=r;s!==n;o++,s=r){r=t.openElements.getCommonAncestor(s);const a=t.activeFormattingElements.getElementEntry(s),l=a&&o>=sN;!a||l?(l&&t.activeFormattingElements.removeEntry(a),t.openElements.remove(s)):(s=uN(t,a),i===e&&(t.activeFormattingElements.bookmark=a),t.treeAdapter.detachNode(i),t.treeAdapter.appendChild(s,i),i=s)}return i}function uN(t,e){const n=t.treeAdapter.getNamespaceURI(e.element),i=t.treeAdapter.createElement(e.token.tagName,n,e.token.attrs);return t.openElements.replace(e.element,i),e.element=i,i}function hN(t,e,n){const i=t.treeAdapter.getTagName(e),r=Zg(i);if(t._isElementCausesFosterParenting(r))t._fosterParentElement(n);else{const o=t.treeAdapter.getNamespaceURI(e);r===w.TEMPLATE&&o===ke.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,n)}}function pN(t,e,n){const i=t.treeAdapter.getNamespaceURI(n.element),{token:r}=n,o=t.treeAdapter.createElement(r.tagName,i,r.attrs);t._adoptNodes(e,o),t.treeAdapter.appendChild(e,o),t.activeFormattingElements.insertElementAfterBookmark(o,r),t.activeFormattingElements.removeEntry(n),t.openElements.remove(n.element),t.openElements.insertAfter(e,o,r.tagID)}function t9(t,e){for(let n=0;n<oN;n++){const i=lN(t,e);if(!i)break;const r=cN(t,i);if(!r)break;t.activeFormattingElements.bookmark=i;const o=dN(t,r,i.element),s=t.openElements.getCommonAncestor(i.element);t.treeAdapter.detachNode(o),s&&hN(t,s,o),pN(t,r,i)}}function D7(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function fN(t,e){t._appendCommentNode(e,t.openElements.items[0])}function gN(t,e){t._appendCommentNode(e,t.document)}function n9(t,e){if(t.stopped=!0,e.location){const n=t.fragmentContext?0:2;for(let i=t.openElements.stackTop;i>=n;i--)t._setEndLocation(t.openElements.items[i],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){const i=t.openElements.items[0],r=t.treeAdapter.getNodeSourceCodeLocation(i);if(r&&!r.endTag&&(t._setEndLocation(i,e),t.openElements.stackTop>=1)){const o=t.openElements.items[1],s=t.treeAdapter.getNodeSourceCodeLocation(o);s&&!s.endTag&&t._setEndLocation(o,e)}}}}function mN(t,e){t._setDocumentType(e);const n=e.forceQuirks?Xi.QUIRKS:ZR(e);GR(e)||t._err(e,ye.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,n),t.insertionMode=q.BEFORE_HTML}function Ru(t,e){t._err(e,ye.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,Xi.QUIRKS),t.insertionMode=q.BEFORE_HTML,t._processToken(e)}function bN(t,e){e.tagID===w.HTML?(t._insertElement(e,ke.HTML),t.insertionMode=q.BEFORE_HEAD):xh(t,e)}function vN(t,e){const n=e.tagID;(n===w.HTML||n===w.HEAD||n===w.BODY||n===w.BR)&&xh(t,e)}function xh(t,e){t._insertFakeRootElement(),t.insertionMode=q.BEFORE_HEAD,t._processToken(e)}function yN(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.HEAD:{t._insertElement(e,ke.HTML),t.headElement=t.openElements.current,t.insertionMode=q.IN_HEAD;break}default:_h(t,e)}}function wN(t,e){const n=e.tagID;n===w.HEAD||n===w.BODY||n===w.HTML||n===w.BR?_h(t,e):t._err(e,ye.endTagWithoutMatchingOpenElement)}function _h(t,e){t._insertFakeElement(ce.HEAD,w.HEAD),t.headElement=t.openElements.current,t.insertionMode=q.IN_HEAD,t._processToken(e)}function no(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.BASE:case w.BASEFONT:case w.BGSOUND:case w.LINK:case w.META:{t._appendElement(e,ke.HTML),e.ackSelfClosing=!0;break}case w.TITLE:{t._switchToTextParsing(e,Mi.RCDATA);break}case w.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,Mi.RAWTEXT):(t._insertElement(e,ke.HTML),t.insertionMode=q.IN_HEAD_NO_SCRIPT);break}case w.NOFRAMES:case w.STYLE:{t._switchToTextParsing(e,Mi.RAWTEXT);break}case w.SCRIPT:{t._switchToTextParsing(e,Mi.SCRIPT_DATA);break}case w.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=q.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(q.IN_TEMPLATE);break}case w.HEAD:{t._err(e,ye.misplacedStartTagForHeadElement);break}default:Ch(t,e)}}function xN(t,e){switch(e.tagID){case w.HEAD:{t.openElements.pop(),t.insertionMode=q.AFTER_HEAD;break}case w.BODY:case w.BR:case w.HTML:{Ch(t,e);break}case w.TEMPLATE:{Tc(t,e);break}default:t._err(e,ye.endTagWithoutMatchingOpenElement)}}function Tc(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==w.TEMPLATE&&t._err(e,ye.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(w.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,ye.endTagWithoutMatchingOpenElement)}function Ch(t,e){t.openElements.pop(),t.insertionMode=q.AFTER_HEAD,t._processToken(e)}function _N(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.BASEFONT:case w.BGSOUND:case w.HEAD:case w.LINK:case w.META:case w.NOFRAMES:case w.STYLE:{no(t,e);break}case w.NOSCRIPT:{t._err(e,ye.nestedNoscriptInHead);break}default:kh(t,e)}}function CN(t,e){switch(e.tagID){case w.NOSCRIPT:{t.openElements.pop(),t.insertionMode=q.IN_HEAD;break}case w.BR:{kh(t,e);break}default:t._err(e,ye.endTagWithoutMatchingOpenElement)}}function kh(t,e){const n=e.type===mt.EOF?ye.openElementsLeftAfterEof:ye.disallowedContentInNoscriptInHead;t._err(e,n),t.openElements.pop(),t.insertionMode=q.IN_HEAD,t._processToken(e)}function kN(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.BODY:{t._insertElement(e,ke.HTML),t.framesetOk=!1,t.insertionMode=q.IN_BODY;break}case w.FRAMESET:{t._insertElement(e,ke.HTML),t.insertionMode=q.IN_FRAMESET;break}case w.BASE:case w.BASEFONT:case w.BGSOUND:case w.LINK:case w.META:case w.NOFRAMES:case w.SCRIPT:case w.STYLE:case w.TEMPLATE:case w.TITLE:{t._err(e,ye.abandonedHeadElementChild),t.openElements.push(t.headElement,w.HEAD),no(t,e),t.openElements.remove(t.headElement);break}case w.HEAD:{t._err(e,ye.misplacedStartTagForHeadElement);break}default:Eh(t,e)}}function EN(t,e){switch(e.tagID){case w.BODY:case w.HTML:case w.BR:{Eh(t,e);break}case w.TEMPLATE:{Tc(t,e);break}default:t._err(e,ye.endTagWithoutMatchingOpenElement)}}function Eh(t,e){t._insertFakeElement(ce.BODY,w.BODY),t.insertionMode=q.IN_BODY,Wg(t,e)}function Wg(t,e){switch(e.type){case mt.CHARACTER:{SE(t,e);break}case mt.WHITESPACE_CHARACTER:{EE(t,e);break}case mt.COMMENT:{D7(t,e);break}case mt.START_TAG:{ci(t,e);break}case mt.END_TAG:{qg(t,e);break}case mt.EOF:{ME(t,e);break}}}function EE(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function SE(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function SN(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function TN(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(n,e.attrs))}function IN(t,e){const n=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&n&&(t.treeAdapter.detachNode(n),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_FRAMESET)}function LN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML)}function MN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),pE(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,ke.HTML)}function PN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function AN(t,e){const n=t.openElements.tmplCount>0;(!t.formElement||n)&&(t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML),n||(t.formElement=t.openElements.current))}function $N(t,e){t.framesetOk=!1;const n=e.tagID;for(let i=t.openElements.stackTop;i>=0;i--){const r=t.openElements.tagIDs[i];if(n===w.LI&&r===w.LI||(n===w.DD||n===w.DT)&&(r===w.DD||r===w.DT)){t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.popUntilTagNamePopped(r);break}if(r!==w.ADDRESS&&r!==w.DIV&&r!==w.P&&t._isSpecialElement(t.openElements.items[i],r))break}t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML)}function BN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML),t.tokenizer.state=Mi.PLAINTEXT}function DN(t,e){t.openElements.hasInScope(w.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(w.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML),t.framesetOk=!1}function ON(t,e){const n=t.activeFormattingElements.getElementEntryInScopeWithTagName(ce.A);n&&(t9(t,e),t.openElements.remove(n.element),t.activeFormattingElements.removeEntry(n)),t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function RN(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function NN(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(w.NOBR)&&(t9(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,ke.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function HN(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function FN(t,e){t.treeAdapter.getDocumentMode(t.document)!==Xi.QUIRKS&&t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._insertElement(e,ke.HTML),t.framesetOk=!1,t.insertionMode=q.IN_TABLE}function TE(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,ke.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function IE(t){const e=dE(t,va.TYPE);return e!=null&&e.toLowerCase()===rN}function UN(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,ke.HTML),IE(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function VN(t,e){t._appendElement(e,ke.HTML),e.ackSelfClosing=!0}function zN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._appendElement(e,ke.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function jN(t,e){e.tagName=ce.IMG,e.tagID=w.IMG,TE(t,e)}function GN(t,e){t._insertElement(e,ke.HTML),t.skipNextNewLine=!0,t.tokenizer.state=Mi.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=q.TEXT}function ZN(t,e){t.openElements.hasInButtonScope(w.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,Mi.RAWTEXT)}function WN(t,e){t.framesetOk=!1,t._switchToTextParsing(e,Mi.RAWTEXT)}function fw(t,e){t._switchToTextParsing(e,Mi.RAWTEXT)}function qN(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===q.IN_TABLE||t.insertionMode===q.IN_CAPTION||t.insertionMode===q.IN_TABLE_BODY||t.insertionMode===q.IN_ROW||t.insertionMode===q.IN_CELL?q.IN_SELECT_IN_TABLE:q.IN_SELECT}function YN(t,e){t.openElements.currentTagId===w.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML)}function XN(t,e){t.openElements.hasInScope(w.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,ke.HTML)}function KN(t,e){t.openElements.hasInScope(w.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(w.RTC),t._insertElement(e,ke.HTML)}function QN(t,e){t._reconstructActiveFormattingElements(),xE(e),e9(e),e.selfClosing?t._appendElement(e,ke.MATHML):t._insertElement(e,ke.MATHML),e.ackSelfClosing=!0}function JN(t,e){t._reconstructActiveFormattingElements(),_E(e),e9(e),e.selfClosing?t._appendElement(e,ke.SVG):t._insertElement(e,ke.SVG),e.ackSelfClosing=!0}function gw(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,ke.HTML)}function ci(t,e){switch(e.tagID){case w.I:case w.S:case w.B:case w.U:case w.EM:case w.TT:case w.BIG:case w.CODE:case w.FONT:case w.SMALL:case w.STRIKE:case w.STRONG:{RN(t,e);break}case w.A:{ON(t,e);break}case w.H1:case w.H2:case w.H3:case w.H4:case w.H5:case w.H6:{MN(t,e);break}case w.P:case w.DL:case w.OL:case w.UL:case w.DIV:case w.DIR:case w.NAV:case w.MAIN:case w.MENU:case w.ASIDE:case w.CENTER:case w.FIGURE:case w.FOOTER:case w.HEADER:case w.HGROUP:case w.DIALOG:case w.DETAILS:case w.ADDRESS:case w.ARTICLE:case w.SECTION:case w.SUMMARY:case w.FIELDSET:case w.BLOCKQUOTE:case w.FIGCAPTION:{LN(t,e);break}case w.LI:case w.DD:case w.DT:{$N(t,e);break}case w.BR:case w.IMG:case w.WBR:case w.AREA:case w.EMBED:case w.KEYGEN:{TE(t,e);break}case w.HR:{zN(t,e);break}case w.RB:case w.RTC:{XN(t,e);break}case w.RT:case w.RP:{KN(t,e);break}case w.PRE:case w.LISTING:{PN(t,e);break}case w.XMP:{ZN(t,e);break}case w.SVG:{JN(t,e);break}case w.HTML:{SN(t,e);break}case w.BASE:case w.LINK:case w.META:case w.STYLE:case w.TITLE:case w.SCRIPT:case w.BGSOUND:case w.BASEFONT:case w.TEMPLATE:{no(t,e);break}case w.BODY:{TN(t,e);break}case w.FORM:{AN(t,e);break}case w.NOBR:{NN(t,e);break}case w.MATH:{QN(t,e);break}case w.TABLE:{FN(t,e);break}case w.INPUT:{UN(t,e);break}case w.PARAM:case w.TRACK:case w.SOURCE:{VN(t,e);break}case w.IMAGE:{jN(t,e);break}case w.BUTTON:{DN(t,e);break}case w.APPLET:case w.OBJECT:case w.MARQUEE:{HN(t,e);break}case w.IFRAME:{WN(t,e);break}case w.SELECT:{qN(t,e);break}case w.OPTION:case w.OPTGROUP:{YN(t,e);break}case w.NOEMBED:{fw(t,e);break}case w.FRAMESET:{IN(t,e);break}case w.TEXTAREA:{GN(t,e);break}case w.NOSCRIPT:{t.options.scriptingEnabled?fw(t,e):gw(t,e);break}case w.PLAINTEXT:{BN(t,e);break}case w.COL:case w.TH:case w.TD:case w.TR:case w.HEAD:case w.FRAME:case w.TBODY:case w.TFOOT:case w.THEAD:case w.CAPTION:case w.COLGROUP:break;default:gw(t,e)}}function eH(t,e){if(t.openElements.hasInScope(w.BODY)&&(t.insertionMode=q.AFTER_BODY,t.options.sourceCodeLocationInfo)){const n=t.openElements.tryPeekProperlyNestedBodyElement();n&&t._setEndLocation(n,e)}}function tH(t,e){t.openElements.hasInScope(w.BODY)&&(t.insertionMode=q.AFTER_BODY,NE(t,e))}function nH(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n))}function iH(t){const e=t.openElements.tmplCount>0,{formElement:n}=t;e||(t.formElement=null),(n||e)&&t.openElements.hasInScope(w.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(w.FORM):n&&t.openElements.remove(n))}function rH(t){t.openElements.hasInButtonScope(w.P)||t._insertFakeElement(ce.P,w.P),t._closePElement()}function oH(t){t.openElements.hasInListItemScope(w.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(w.LI),t.openElements.popUntilTagNamePopped(w.LI))}function sH(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.popUntilTagNamePopped(n))}function aH(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function lH(t,e){const n=e.tagID;t.openElements.hasInScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker())}function cH(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(ce.BR,w.BR),t.openElements.pop(),t.framesetOk=!1}function LE(t,e){const n=e.tagName,i=e.tagID;for(let r=t.openElements.stackTop;r>0;r--){const o=t.openElements.items[r],s=t.openElements.tagIDs[r];if(i===s&&(i!==w.UNKNOWN||t.treeAdapter.getTagName(o)===n)){t.openElements.generateImpliedEndTagsWithExclusion(i),t.openElements.stackTop>=r&&t.openElements.shortenToLength(r);break}if(t._isSpecialElement(o,s))break}}function qg(t,e){switch(e.tagID){case w.A:case w.B:case w.I:case w.S:case w.U:case w.EM:case w.TT:case w.BIG:case w.CODE:case w.FONT:case w.NOBR:case w.SMALL:case w.STRIKE:case w.STRONG:{t9(t,e);break}case w.P:{rH(t);break}case w.DL:case w.UL:case w.OL:case w.DIR:case w.DIV:case w.NAV:case w.PRE:case w.MAIN:case w.MENU:case w.ASIDE:case w.BUTTON:case w.CENTER:case w.FIGURE:case w.FOOTER:case w.HEADER:case w.HGROUP:case w.DIALOG:case w.ADDRESS:case w.ARTICLE:case w.DETAILS:case w.SECTION:case w.SUMMARY:case w.LISTING:case w.FIELDSET:case w.BLOCKQUOTE:case w.FIGCAPTION:{nH(t,e);break}case w.LI:{oH(t);break}case w.DD:case w.DT:{sH(t,e);break}case w.H1:case w.H2:case w.H3:case w.H4:case w.H5:case w.H6:{aH(t);break}case w.BR:{cH(t);break}case w.BODY:{eH(t,e);break}case w.HTML:{tH(t,e);break}case w.FORM:{iH(t);break}case w.APPLET:case w.OBJECT:case w.MARQUEE:{lH(t,e);break}case w.TEMPLATE:{Tc(t,e);break}default:LE(t,e)}}function ME(t,e){t.tmplInsertionModeStack.length>0?RE(t,e):n9(t,e)}function dH(t,e){var n;e.tagID===w.SCRIPT&&((n=t.scriptHandler)===null||n===void 0||n.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function uH(t,e){t._err(e,ye.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function W4(t,e){if(CE.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=q.IN_TABLE_TEXT,e.type){case mt.CHARACTER:{AE(t,e);break}case mt.WHITESPACE_CHARACTER:{PE(t,e);break}}else a0(t,e)}function hH(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_CAPTION}function pH(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_COLUMN_GROUP}function fH(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ce.COLGROUP,w.COLGROUP),t.insertionMode=q.IN_COLUMN_GROUP,i9(t,e)}function gH(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_TABLE_BODY}function mH(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(ce.TBODY,w.TBODY),t.insertionMode=q.IN_TABLE_BODY,Yg(t,e)}function bH(t,e){t.openElements.hasInTableScope(w.TABLE)&&(t.openElements.popUntilTagNamePopped(w.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function vH(t,e){IE(e)?t._appendElement(e,ke.HTML):a0(t,e),e.ackSelfClosing=!0}function yH(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,ke.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function z1(t,e){switch(e.tagID){case w.TD:case w.TH:case w.TR:{mH(t,e);break}case w.STYLE:case w.SCRIPT:case w.TEMPLATE:{no(t,e);break}case w.COL:{fH(t,e);break}case w.FORM:{yH(t,e);break}case w.TABLE:{bH(t,e);break}case w.TBODY:case w.TFOOT:case w.THEAD:{gH(t,e);break}case w.INPUT:{vH(t,e);break}case w.CAPTION:{hH(t,e);break}case w.COLGROUP:{pH(t,e);break}default:a0(t,e)}}function zh(t,e){switch(e.tagID){case w.TABLE:{t.openElements.hasInTableScope(w.TABLE)&&(t.openElements.popUntilTagNamePopped(w.TABLE),t._resetInsertionMode());break}case w.TEMPLATE:{Tc(t,e);break}case w.BODY:case w.CAPTION:case w.COL:case w.COLGROUP:case w.HTML:case w.TBODY:case w.TD:case w.TFOOT:case w.TH:case w.THEAD:case w.TR:break;default:a0(t,e)}}function a0(t,e){const n=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,Wg(t,e),t.fosterParentingEnabled=n}function PE(t,e){t.pendingCharacterTokens.push(e)}function AE(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function Nu(t,e){let n=0;if(t.hasNonWhitespacePendingCharacterToken)for(;n<t.pendingCharacterTokens.length;n++)a0(t,t.pendingCharacterTokens[n]);else for(;n<t.pendingCharacterTokens.length;n++)t._insertCharacters(t.pendingCharacterTokens[n]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}const $E=new Set([w.CAPTION,w.COL,w.COLGROUP,w.TBODY,w.TD,w.TFOOT,w.TH,w.THEAD,w.TR]);function wH(t,e){const n=e.tagID;$E.has(n)?t.openElements.hasInTableScope(w.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(w.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=q.IN_TABLE,z1(t,e)):ci(t,e)}function xH(t,e){const n=e.tagID;switch(n){case w.CAPTION:case w.TABLE:{t.openElements.hasInTableScope(w.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(w.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=q.IN_TABLE,n===w.TABLE&&zh(t,e));break}case w.BODY:case w.COL:case w.COLGROUP:case w.HTML:case w.TBODY:case w.TD:case w.TFOOT:case w.TH:case w.THEAD:case w.TR:break;default:qg(t,e)}}function i9(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.COL:{t._appendElement(e,ke.HTML),e.ackSelfClosing=!0;break}case w.TEMPLATE:{no(t,e);break}default:H2(t,e)}}function _H(t,e){switch(e.tagID){case w.COLGROUP:{t.openElements.currentTagId===w.COLGROUP&&(t.openElements.pop(),t.insertionMode=q.IN_TABLE);break}case w.TEMPLATE:{Tc(t,e);break}case w.COL:break;default:H2(t,e)}}function H2(t,e){t.openElements.currentTagId===w.COLGROUP&&(t.openElements.pop(),t.insertionMode=q.IN_TABLE,t._processToken(e))}function Yg(t,e){switch(e.tagID){case w.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_ROW;break}case w.TH:case w.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(ce.TR,w.TR),t.insertionMode=q.IN_ROW,Xg(t,e);break}case w.CAPTION:case w.COL:case w.COLGROUP:case w.TBODY:case w.TFOOT:case w.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE,z1(t,e));break}default:z1(t,e)}}function O7(t,e){const n=e.tagID;switch(e.tagID){case w.TBODY:case w.TFOOT:case w.THEAD:{t.openElements.hasInTableScope(n)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE);break}case w.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE,zh(t,e));break}case w.BODY:case w.CAPTION:case w.COL:case w.COLGROUP:case w.HTML:case w.TD:case w.TH:case w.TR:break;default:zh(t,e)}}function Xg(t,e){switch(e.tagID){case w.TH:case w.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,ke.HTML),t.insertionMode=q.IN_CELL,t.activeFormattingElements.insertMarker();break}case w.CAPTION:case w.COL:case w.COLGROUP:case w.TBODY:case w.TFOOT:case w.THEAD:case w.TR:{t.openElements.hasInTableScope(w.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE_BODY,Yg(t,e));break}default:z1(t,e)}}function BE(t,e){switch(e.tagID){case w.TR:{t.openElements.hasInTableScope(w.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE_BODY);break}case w.TABLE:{t.openElements.hasInTableScope(w.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE_BODY,O7(t,e));break}case w.TBODY:case w.TFOOT:case w.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(w.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=q.IN_TABLE_BODY,O7(t,e));break}case w.BODY:case w.CAPTION:case w.COL:case w.COLGROUP:case w.HTML:case w.TD:case w.TH:break;default:zh(t,e)}}function CH(t,e){const n=e.tagID;$E.has(n)?(t.openElements.hasInTableScope(w.TD)||t.openElements.hasInTableScope(w.TH))&&(t._closeTableCell(),Xg(t,e)):ci(t,e)}function kH(t,e){const n=e.tagID;switch(n){case w.TD:case w.TH:{t.openElements.hasInTableScope(n)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(n),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=q.IN_ROW);break}case w.TABLE:case w.TBODY:case w.TFOOT:case w.THEAD:case w.TR:{t.openElements.hasInTableScope(n)&&(t._closeTableCell(),BE(t,e));break}case w.BODY:case w.CAPTION:case w.COL:case w.COLGROUP:case w.HTML:break;default:qg(t,e)}}function DE(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.OPTION:{t.openElements.currentTagId===w.OPTION&&t.openElements.pop(),t._insertElement(e,ke.HTML);break}case w.OPTGROUP:{t.openElements.currentTagId===w.OPTION&&t.openElements.pop(),t.openElements.currentTagId===w.OPTGROUP&&t.openElements.pop(),t._insertElement(e,ke.HTML);break}case w.INPUT:case w.KEYGEN:case w.TEXTAREA:case w.SELECT:{t.openElements.hasInSelectScope(w.SELECT)&&(t.openElements.popUntilTagNamePopped(w.SELECT),t._resetInsertionMode(),e.tagID!==w.SELECT&&t._processStartTag(e));break}case w.SCRIPT:case w.TEMPLATE:{no(t,e);break}}}function OE(t,e){switch(e.tagID){case w.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===w.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===w.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===w.OPTGROUP&&t.openElements.pop();break}case w.OPTION:{t.openElements.currentTagId===w.OPTION&&t.openElements.pop();break}case w.SELECT:{t.openElements.hasInSelectScope(w.SELECT)&&(t.openElements.popUntilTagNamePopped(w.SELECT),t._resetInsertionMode());break}case w.TEMPLATE:{Tc(t,e);break}}}function EH(t,e){const n=e.tagID;n===w.CAPTION||n===w.TABLE||n===w.TBODY||n===w.TFOOT||n===w.THEAD||n===w.TR||n===w.TD||n===w.TH?(t.openElements.popUntilTagNamePopped(w.SELECT),t._resetInsertionMode(),t._processStartTag(e)):DE(t,e)}function SH(t,e){const n=e.tagID;n===w.CAPTION||n===w.TABLE||n===w.TBODY||n===w.TFOOT||n===w.THEAD||n===w.TR||n===w.TD||n===w.TH?t.openElements.hasInTableScope(n)&&(t.openElements.popUntilTagNamePopped(w.SELECT),t._resetInsertionMode(),t.onEndTag(e)):OE(t,e)}function TH(t,e){switch(e.tagID){case w.BASE:case w.BASEFONT:case w.BGSOUND:case w.LINK:case w.META:case w.NOFRAMES:case w.SCRIPT:case w.STYLE:case w.TEMPLATE:case w.TITLE:{no(t,e);break}case w.CAPTION:case w.COLGROUP:case w.TBODY:case w.TFOOT:case w.THEAD:{t.tmplInsertionModeStack[0]=q.IN_TABLE,t.insertionMode=q.IN_TABLE,z1(t,e);break}case w.COL:{t.tmplInsertionModeStack[0]=q.IN_COLUMN_GROUP,t.insertionMode=q.IN_COLUMN_GROUP,i9(t,e);break}case w.TR:{t.tmplInsertionModeStack[0]=q.IN_TABLE_BODY,t.insertionMode=q.IN_TABLE_BODY,Yg(t,e);break}case w.TD:case w.TH:{t.tmplInsertionModeStack[0]=q.IN_ROW,t.insertionMode=q.IN_ROW,Xg(t,e);break}default:t.tmplInsertionModeStack[0]=q.IN_BODY,t.insertionMode=q.IN_BODY,ci(t,e)}}function IH(t,e){e.tagID===w.TEMPLATE&&Tc(t,e)}function RE(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(w.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):n9(t,e)}function LH(t,e){e.tagID===w.HTML?ci(t,e):F2(t,e)}function NE(t,e){var n;if(e.tagID===w.HTML){if(t.fragmentContext||(t.insertionMode=q.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===w.HTML){t._setEndLocation(t.openElements.items[0],e);const i=t.openElements.items[1];i&&!(!((n=t.treeAdapter.getNodeSourceCodeLocation(i))===null||n===void 0)&&n.endTag)&&t._setEndLocation(i,e)}}else F2(t,e)}function F2(t,e){t.insertionMode=q.IN_BODY,Wg(t,e)}function MH(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.FRAMESET:{t._insertElement(e,ke.HTML);break}case w.FRAME:{t._appendElement(e,ke.HTML),e.ackSelfClosing=!0;break}case w.NOFRAMES:{no(t,e);break}}}function PH(t,e){e.tagID===w.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==w.FRAMESET&&(t.insertionMode=q.AFTER_FRAMESET))}function AH(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.NOFRAMES:{no(t,e);break}}}function $H(t,e){e.tagID===w.HTML&&(t.insertionMode=q.AFTER_AFTER_FRAMESET)}function BH(t,e){e.tagID===w.HTML?ci(t,e):r2(t,e)}function r2(t,e){t.insertionMode=q.IN_BODY,Wg(t,e)}function DH(t,e){switch(e.tagID){case w.HTML:{ci(t,e);break}case w.NOFRAMES:{no(t,e);break}}}function OH(t,e){e.chars=Ut,t._insertCharacters(e)}function RH(t,e){t._insertCharacters(e),t.framesetOk=!1}function HE(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==ke.HTML&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function NH(t,e){if(JR(e))HE(t),t._startTagOutsideForeignContent(e);else{const n=t._getAdjustedCurrentElement(),i=t.treeAdapter.getNamespaceURI(n);i===ke.MATHML?xE(e):i===ke.SVG&&(eN(e),_E(e)),e9(e),e.selfClosing?t._appendElement(e,i):t._insertElement(e,i),e.ackSelfClosing=!0}}function HH(t,e){if(e.tagID===w.P||e.tagID===w.BR){HE(t),t._endTagOutsideForeignContent(e);return}for(let n=t.openElements.stackTop;n>0;n--){const i=t.openElements.items[n];if(t.treeAdapter.getNamespaceURI(i)===ke.HTML){t._endTagOutsideForeignContent(e);break}const r=t.treeAdapter.getTagName(i);if(r.toLowerCase()===e.tagName){e.tagName=r,t.openElements.shortenToLength(n);break}}}ce.AREA,ce.BASE,ce.BASEFONT,ce.BGSOUND,ce.BR,ce.COL,ce.EMBED,ce.FRAME,ce.HR,ce.IMG,ce.INPUT,ce.KEYGEN,ce.LINK,ce.META,ce.PARAM,ce.SOURCE,ce.TRACK,ce.WBR;function FH(t,e){return kE.parse(t,e)}function UH(t,e,n){typeof t=="string"&&(n=e,e=t,t=null);const i=kE.getFragmentParser(t,n);return i.tokenizer.write(e,!0),i.getFragment()}function Sh(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?mw(t.position):"start"in t||"end"in t?mw(t):"line"in t||"column"in t?R7(t):""}function R7(t){return bw(t&&t.line)+":"+bw(t&&t.column)}function mw(t){return R7(t&&t.start)+"-"+R7(t&&t.end)}function bw(t){return t&&typeof t=="number"?t:1}class Ci extends Error{constructor(e,n,i){super(),typeof n=="string"&&(i=n,n=void 0);let r="",o={},s=!1;if(n&&("line"in n&&"column"in n?o={place:n}:"start"in n&&"end"in n?o={place:n}:"type"in n?o={ancestors:[n],place:n.position}:o={...n}),typeof e=="string"?r=e:!o.cause&&e&&(s=!0,r=e.message,o.cause=e),!o.ruleId&&!o.source&&typeof i=="string"){const l=i.indexOf(":");l===-1?o.ruleId=i:(o.source=i.slice(0,l),o.ruleId=i.slice(l+1))}if(!o.place&&o.ancestors&&o.ancestors){const l=o.ancestors[o.ancestors.length-1];l&&(o.place=l.position)}const a=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=a?a.line:void 0,this.name=Sh(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=s&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}}Ci.prototype.file="";Ci.prototype.name="";Ci.prototype.reason="";Ci.prototype.message="";Ci.prototype.stack="";Ci.prototype.column=void 0;Ci.prototype.line=void 0;Ci.prototype.ancestors=void 0;Ci.prototype.cause=void 0;Ci.prototype.fatal=void 0;Ci.prototype.place=void 0;Ci.prototype.ruleId=void 0;Ci.prototype.source=void 0;const fo={basename:VH,dirname:zH,extname:jH,join:GH,sep:"/"};function VH(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');l0(t);let n=0,i=-1,r=t.length,o;if(e===void 0||e.length===0||e.length>t.length){for(;r--;)if(t.codePointAt(r)===47){if(o){n=r+1;break}}else i<0&&(o=!0,i=r+1);return i<0?"":t.slice(n,i)}if(e===t)return"";let s=-1,a=e.length-1;for(;r--;)if(t.codePointAt(r)===47){if(o){n=r+1;break}}else s<0&&(o=!0,s=r+1),a>-1&&(t.codePointAt(r)===e.codePointAt(a--)?a<0&&(i=r):(a=-1,i=s));return n===i?i=s:i<0&&(i=t.length),t.slice(n,i)}function zH(t){if(l0(t),t.length===0)return".";let e=-1,n=t.length,i;for(;--n;)if(t.codePointAt(n)===47){if(i){e=n;break}}else i||(i=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function jH(t){l0(t);let e=t.length,n=-1,i=0,r=-1,o=0,s;for(;e--;){const a=t.codePointAt(e);if(a===47){if(s){i=e+1;break}continue}n<0&&(s=!0,n=e+1),a===46?r<0?r=e:o!==1&&(o=1):r>-1&&(o=-1)}return r<0||n<0||o===0||o===1&&r===n-1&&r===i+1?"":t.slice(r,n)}function GH(...t){let e=-1,n;for(;++e<t.length;)l0(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":ZH(n)}function ZH(t){l0(t);const e=t.codePointAt(0)===47;let n=WH(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function WH(t,e){let n="",i=0,r=-1,o=0,s=-1,a,l;for(;++s<=t.length;){if(s<t.length)a=t.codePointAt(s);else{if(a===47)break;a=47}if(a===47){if(!(r===s-1||o===1))if(r!==s-1&&o===2){if(n.length<2||i!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",i=0):(n=n.slice(0,l),i=n.length-1-n.lastIndexOf("/")),r=s,o=0;continue}}else if(n.length>0){n="",i=0,r=s,o=0;continue}}e&&(n=n.length>0?n+"/..":"..",i=2)}else n.length>0?n+="/"+t.slice(r+1,s):n=t.slice(r+1,s),i=s-r-1;r=s,o=0}else a===46&&o>-1?o++:o=-1}return n}function l0(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const qH={cwd:YH};function YH(){return"/"}function N7(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function XH(t){if(typeof t=="string")t=new URL(t);else if(!N7(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return KH(t)}function KH(t){if(t.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const i=e.codePointAt(n+2);if(i===70||i===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const q4=["history","path","basename","stem","extname","dirname"];class H7{constructor(e){let n;e?N7(e)?n={path:e}:typeof e=="string"||QH(e)?n={value:e}:n=e:n={},this.cwd=qH.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<q4.length;){const o=q4[i];o in n&&n[o]!==void 0&&n[o]!==null&&(this[o]=o==="history"?[...n[o]]:n[o])}let r;for(r in n)q4.includes(r)||(this[r]=n[r])}get basename(){return typeof this.path=="string"?fo.basename(this.path):void 0}set basename(e){X4(e,"basename"),Y4(e,"basename"),this.path=fo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?fo.dirname(this.path):void 0}set dirname(e){vw(this.basename,"dirname"),this.path=fo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?fo.extname(this.path):void 0}set extname(e){if(Y4(e,"extname"),vw(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=fo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){N7(e)&&(e=XH(e)),X4(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?fo.basename(this.path,this.extname):void 0}set stem(e){X4(e,"stem"),Y4(e,"stem"),this.path=fo.join(this.dirname||"",e+(this.extname||""))}fail(e,n,i){const r=this.message(e,n,i);throw r.fatal=!0,r}info(e,n,i){const r=this.message(e,n,i);return r.fatal=void 0,r}message(e,n,i){const r=new Ci(e,n,i);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Y4(t,e){if(t&&t.includes(fo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+fo.sep+"`")}function X4(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function vw(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function QH(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const JH={abandonedHeadElementChild:{reason:"Unexpected metadata element after head",description:"Unexpected element after head. Expected the element before `</head>`",url:!1},abruptClosingOfEmptyComment:{reason:"Unexpected abruptly closed empty comment",description:"Unexpected `>` or `->`. Expected `-->` to close comments"},abruptDoctypePublicIdentifier:{reason:"Unexpected abruptly closed public identifier",description:"Unexpected `>`. Expected a closing `\"` or `'` after the public identifier"},abruptDoctypeSystemIdentifier:{reason:"Unexpected abruptly closed system identifier",description:"Unexpected `>`. Expected a closing `\"` or `'` after the identifier identifier"},absenceOfDigitsInNumericCharacterReference:{reason:"Unexpected non-digit at start of numeric character reference",description:"Unexpected `%c`. Expected `[0-9]` for decimal references or `[0-9a-fA-F]` for hexadecimal references"},cdataInHtmlContent:{reason:"Unexpected CDATA section in HTML",description:"Unexpected `<![CDATA[` in HTML. Remove it, use a comment, or encode special characters instead"},characterReferenceOutsideUnicodeRange:{reason:"Unexpected too big numeric character reference",description:"Unexpectedly high character reference. Expected character references to be at most hexadecimal 10ffff (or decimal 1114111)"},closingOfElementWithOpenChildElements:{reason:"Unexpected closing tag with open child elements",description:"Unexpectedly closing tag. Expected other tags to be closed first",url:!1},controlCharacterInInputStream:{reason:"Unexpected control character",description:"Unexpected control character `%x`. Expected a non-control code point, 0x00, or ASCII whitespace"},controlCharacterReference:{reason:"Unexpected control character reference",description:"Unexpectedly control character in reference. Expected a non-control code point, 0x00, or ASCII whitespace"},disallowedContentInNoscriptInHead:{reason:"Disallowed content inside `<noscript>` in `<head>`",description:"Unexpected text character `%c`. Only use text in `<noscript>`s in `<body>`",url:!1},duplicateAttribute:{reason:"Unexpected duplicate attribute",description:"Unexpectedly double attribute. Expected attributes to occur only once"},endTagWithAttributes:{reason:"Unexpected attribute on closing tag",description:"Unexpected attribute. Expected `>` instead"},endTagWithTrailingSolidus:{reason:"Unexpected slash at end of closing tag",description:"Unexpected `%c-1`. Expected `>` instead"},endTagWithoutMatchingOpenElement:{reason:"Unexpected unopened end tag",description:"Unexpected end tag. Expected no end tag or another end tag",url:!1},eofBeforeTagName:{reason:"Unexpected end of file",description:"Unexpected end of file. Expected tag name instead"},eofInCdata:{reason:"Unexpected end of file in CDATA",description:"Unexpected end of file. Expected `]]>` to close the CDATA"},eofInComment:{reason:"Unexpected end of file in comment",description:"Unexpected end of file. Expected `-->` to close the comment"},eofInDoctype:{reason:"Unexpected end of file in doctype",description:"Unexpected end of file. Expected a valid doctype (such as `<!doctype html>`)"},eofInElementThatCanContainOnlyText:{reason:"Unexpected end of file in element that can only contain text",description:"Unexpected end of file. Expected text or a closing tag",url:!1},eofInScriptHtmlCommentLikeText:{reason:"Unexpected end of file in comment inside script",description:"Unexpected end of file. Expected `-->` to close the comment"},eofInTag:{reason:"Unexpected end of file in tag",description:"Unexpected end of file. Expected `>` to close the tag"},incorrectlyClosedComment:{reason:"Incorrectly closed comment",description:"Unexpected `%c-1`. Expected `-->` to close the comment"},incorrectlyOpenedComment:{reason:"Incorrectly opened comment",description:"Unexpected `%c`. Expected `<!--` to open the comment"},invalidCharacterSequenceAfterDoctypeName:{reason:"Invalid sequence after doctype name",description:"Unexpected sequence at `%c`. Expected `public` or `system`"},invalidFirstCharacterOfTagName:{reason:"Invalid first character in tag name",description:"Unexpected `%c`. Expected an ASCII letter instead"},misplacedDoctype:{reason:"Misplaced doctype",description:"Unexpected doctype. Expected doctype before head",url:!1},misplacedStartTagForHeadElement:{reason:"Misplaced `<head>` start tag",description:"Unexpected start tag `<head>`. Expected `<head>` directly after doctype",url:!1},missingAttributeValue:{reason:"Missing attribute value",description:"Unexpected `%c-1`. Expected an attribute value or no `%c-1` instead"},missingDoctype:{reason:"Missing doctype before other content",description:"Expected a `<!doctype html>` before anything else",url:!1},missingDoctypeName:{reason:"Missing doctype name",description:"Unexpected doctype end at `%c`. Expected `html` instead"},missingDoctypePublicIdentifier:{reason:"Missing public identifier in doctype",description:"Unexpected `%c`. Expected identifier for `public` instead"},missingDoctypeSystemIdentifier:{reason:"Missing system identifier in doctype",description:'Unexpected `%c`. Expected identifier for `system` instead (suggested: `"about:legacy-compat"`)'},missingEndTagName:{reason:"Missing name in end tag",description:"Unexpected `%c`. Expected an ASCII letter instead"},missingQuoteBeforeDoctypePublicIdentifier:{reason:"Missing quote before public identifier in doctype",description:"Unexpected `%c`. Expected `\"` or `'` instead"},missingQuoteBeforeDoctypeSystemIdentifier:{reason:"Missing quote before system identifier in doctype",description:"Unexpected `%c`. Expected `\"` or `'` instead"},missingSemicolonAfterCharacterReference:{reason:"Missing semicolon after character reference",description:"Unexpected `%c`. Expected `;` instead"},missingWhitespaceAfterDoctypePublicKeyword:{reason:"Missing whitespace after public identifier in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceAfterDoctypeSystemKeyword:{reason:"Missing whitespace after system identifier in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBeforeDoctypeName:{reason:"Missing whitespace before doctype name",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBetweenAttributes:{reason:"Missing whitespace between attributes",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers:{reason:"Missing whitespace between public and system identifiers in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},nestedComment:{reason:"Unexpected nested comment",description:"Unexpected `<!--`. Expected `-->`"},nestedNoscriptInHead:{reason:"Unexpected nested `<noscript>` in `<head>`",description:"Unexpected `<noscript>`. Expected a closing tag or a meta element",url:!1},nonConformingDoctype:{reason:"Unexpected non-conforming doctype declaration",description:'Expected `<!doctype html>` or `<!doctype html system "about:legacy-compat">`',url:!1},nonVoidHtmlElementStartTagWithTrailingSolidus:{reason:"Unexpected trailing slash on start tag of non-void element",description:"Unexpected `/`. Expected `>` instead"},noncharacterCharacterReference:{reason:"Unexpected noncharacter code point referenced by character reference",description:"Unexpected code point. Do not use noncharacters in HTML"},noncharacterInInputStream:{reason:"Unexpected noncharacter character",description:"Unexpected code point `%x`. Do not use noncharacters in HTML"},nullCharacterReference:{reason:"Unexpected NULL character referenced by character reference",description:"Unexpected code point. Do not use NULL characters in HTML"},openElementsLeftAfterEof:{reason:"Unexpected end of file",description:"Unexpected end of file. Expected closing tag instead",url:!1},surrogateCharacterReference:{reason:"Unexpected surrogate character referenced by character reference",description:"Unexpected code point. Do not use lone surrogate characters in HTML"},surrogateInInputStream:{reason:"Unexpected surrogate character",description:"Unexpected code point `%x`. Do not use lone surrogate characters in HTML"},unexpectedCharacterAfterDoctypeSystemIdentifier:{reason:"Invalid character after system identifier in doctype",description:"Unexpected character at `%c`. Expected `>`"},unexpectedCharacterInAttributeName:{reason:"Unexpected character in attribute name",description:"Unexpected `%c`. Expected whitespace, `/`, `>`, `=`, or probably an ASCII letter"},unexpectedCharacterInUnquotedAttributeValue:{reason:"Unexpected character in unquoted attribute value",description:"Unexpected `%c`. Quote the attribute value to include it"},unexpectedEqualsSignBeforeAttributeName:{reason:"Unexpected equals sign before attribute name",description:"Unexpected `%c`. Add an attribute name before it"},unexpectedNullCharacter:{reason:"Unexpected NULL character",description:"Unexpected code point `%x`. Do not use NULL characters in HTML"},unexpectedQuestionMarkInsteadOfTagName:{reason:"Unexpected question mark instead of tag name",description:"Unexpected `%c`. Expected an ASCII letter instead"},unexpectedSolidusInTag:{reason:"Unexpected slash in tag",description:"Unexpected `%c-1`. Expected it followed by `>` or in a quoted attribute value"},unknownNamedCharacterReference:{reason:"Unexpected unknown named character reference",description:"Unexpected character reference. Expected known named character references"}},eF="https://html.spec.whatwg.org/multipage/parsing.html#parse-error-",tF=/-[a-z]/g,nF=/%c(?:([-+])(\d+))?/g,iF=/%x/g,rF={2:!0,1:!1,0:null},oF={};function sF(t,e){const n=e||oF,i=n.onerror,r=t instanceof H7?t:new H7(t),o=n.fragment?UH:FH,s=String(r),a=o(s,{sourceCodeLocationInfo:!0,onParseError:n.onerror?l:null,scriptingEnabled:!1});return cR(a,{file:r,space:n.space,verbose:n.verbose});function l(c){const d=c.code,u=aF(d),h=n[u],p=h??!0,g=typeof p=="number"?p:p?1:0;if(g){const v=JH[u],m=new Ci(f(v.reason),{place:{start:{line:c.startLine,column:c.startCol,offset:c.startOffset},end:{line:c.endLine,column:c.endCol,offset:c.endOffset}},ruleId:d,source:"hast-util-from-html"});r.path&&(m.file=r.path,m.name=r.path+":"+m.name),m.fatal=rF[g],m.note=f(v.description),m.url=v.url===!1?void 0:eF+d,i(m)}function f(v){return v.replace(nF,m).replace(iF,y);function m(x,T,M){const k=(M?Number.parseInt(M,10):0)*(T==="-"?-1:1),_=s.charAt(c.startOffset+k);return cF(_)}function y(){return dF(s.charCodeAt(c.startOffset))}}}}function aF(t){return t.replace(tF,lF)}function lF(t){return t.charAt(1).toUpperCase()}function cF(t){return t==="`"?"` ` `":t}function dF(t){return"0x"+t.toString(16).toUpperCase()}function FE(t){const e=this,{emitParseErrors:n,...i}={...e.data("settings"),...t};e.parser=r;function r(o,s){return sF(o,{...i,onerror:n?function(a){s.path&&(a.name=s.path+":"+a.name,a.file=s.path),s.messages.push(a)}:void 0})}}const uF=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],yw={}.hasOwnProperty;function UE(t,e){const n=e||{};function i(r,...o){let s=i.invalid;const a=i.handlers;if(r&&yw.call(r,t)){const l=String(r[t]);s=yw.call(a,l)?a[l]:i.unknown}if(s)return s.call(this,r,...o)}return i.handlers=n.handlers||{},i.invalid=n.invalid,i.unknown=n.unknown,i}function hF(t,e){if(t=t.replace(e.subset?pF(e.subset):/["&'<>`]/g,i),e.subset||e.escapeOnly)return t;return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n).replace(/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,i);function n(r,o,s){return e.format((r.charCodeAt(0)-55296)*1024+r.charCodeAt(1)-56320+65536,s.charCodeAt(o+2),e)}function i(r,o,s){return e.format(r.charCodeAt(0),s.charCodeAt(o+1),e)}}function pF(t){const e=[];let n=-1;for(;++n<t.length;)e.push(t[n].replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}function fF(t,e,n){const i="&#x"+t.toString(16).toUpperCase();return n&&e&&!/[\dA-Fa-f]/.test(String.fromCharCode(e))?i:i+";"}function gF(t,e,n){const i="&#"+String(t);return n&&e&&!/\d/.test(String.fromCharCode(e))?i:i+";"}const mF=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],K4={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},bF=["cent","copy","divide","gt","lt","not","para","times"],VE={}.hasOwnProperty,F7={};let mf;for(mf in K4)VE.call(K4,mf)&&(F7[K4[mf]]=mf);function vF(t,e,n,i){const r=String.fromCharCode(t);if(VE.call(F7,r)){const o=F7[r],s="&"+o;return n&&mF.includes(o)&&!bF.includes(o)&&(!i||e&&e!==61&&/[^\da-z]/i.test(String.fromCharCode(e)))?s:s+";"}return""}function yF(t,e,n){let i=fF(t,e,n.omitOptionalSemicolons),r;if((n.useNamedReferences||n.useShortestReferences)&&(r=vF(t,e,n.omitOptionalSemicolons,n.attribute)),(n.useShortestReferences||!r)&&n.useShortestReferences){const o=gF(t,e,n.omitOptionalSemicolons);o.length<i.length&&(i=o)}return r&&(!n.useShortestReferences||r.length<i.length)?r:i}function k1(t,e){return hF(t,Object.assign({format:yF},e))}function wF(t,e,n,i){return i.settings.bogusComments?"<?"+k1(t.value,Object.assign({},i.settings.characterReferences,{subset:[">"]}))+">":"<!--"+t.value.replace(/^>|^->|<!--|-->|--!>|<!-$/g,r)+"-->";function r(o){return k1(o,Object.assign({},i.settings.characterReferences,{subset:["<",">"]}))}}function xF(t,e,n,i){return"<!"+(i.settings.upperDoctype?"DOCTYPE":"doctype")+(i.settings.tightDoctype?"":" ")+"html>"}function U2(t,e){const n=String(t);if(typeof e!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(e);for(;r!==-1;)i++,r=n.indexOf(e,r+e.length);return i}const _F=/[ \t\n\f\r]/g;function r9(t){return typeof t=="object"?t.type==="text"?ww(t.value):!1:ww(t)}function ww(t){return t.replace(_F,"")===""}const In=jE(1),zE=jE(-1),CF=[];function jE(t){return e;function e(n,i,r){const o=n?n.children:CF;let s=(i||0)+t,a=o[s];if(!r)for(;a&&r9(a);)s+=t,a=o[s];return a}}const kF={}.hasOwnProperty;function GE(t){return e;function e(n,i,r){return kF.call(t,n.tagName)&&t[n.tagName](n,i,r)}}const o9=GE({body:SF,caption:Q4,colgroup:Q4,dd:MF,dt:LF,head:Q4,html:EF,li:IF,optgroup:PF,option:AF,p:TF,rp:xw,rt:xw,tbody:BF,td:_w,tfoot:DF,th:_w,thead:$F,tr:OF});function Q4(t,e,n){const i=In(n,e,!0);return!i||i.type!=="comment"&&!(i.type==="text"&&r9(i.value.charAt(0)))}function EF(t,e,n){const i=In(n,e);return!i||i.type!=="comment"}function SF(t,e,n){const i=In(n,e);return!i||i.type!=="comment"}function TF(t,e,n){const i=In(n,e);return i?i.type==="element"&&(i.tagName==="address"||i.tagName==="article"||i.tagName==="aside"||i.tagName==="blockquote"||i.tagName==="details"||i.tagName==="div"||i.tagName==="dl"||i.tagName==="fieldset"||i.tagName==="figcaption"||i.tagName==="figure"||i.tagName==="footer"||i.tagName==="form"||i.tagName==="h1"||i.tagName==="h2"||i.tagName==="h3"||i.tagName==="h4"||i.tagName==="h5"||i.tagName==="h6"||i.tagName==="header"||i.tagName==="hgroup"||i.tagName==="hr"||i.tagName==="main"||i.tagName==="menu"||i.tagName==="nav"||i.tagName==="ol"||i.tagName==="p"||i.tagName==="pre"||i.tagName==="section"||i.tagName==="table"||i.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function IF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&i.tagName==="li"}function LF(t,e,n){const i=In(n,e);return!!(i&&i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd"))}function MF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd")}function xw(t,e,n){const i=In(n,e);return!i||i.type==="element"&&(i.tagName==="rp"||i.tagName==="rt")}function PF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&i.tagName==="optgroup"}function AF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&(i.tagName==="option"||i.tagName==="optgroup")}function $F(t,e,n){const i=In(n,e);return!!(i&&i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot"))}function BF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot")}function DF(t,e,n){return!In(n,e)}function OF(t,e,n){const i=In(n,e);return!i||i.type==="element"&&i.tagName==="tr"}function _w(t,e,n){const i=In(n,e);return!i||i.type==="element"&&(i.tagName==="td"||i.tagName==="th")}const RF=GE({body:FF,colgroup:UF,head:HF,html:NF,tbody:VF});function NF(t){const e=In(t,-1);return!e||e.type!=="comment"}function HF(t){const e=t.children,n=[];let i=-1;for(;++i<e.length;){const r=e[i];if(r.type==="element"&&(r.tagName==="title"||r.tagName==="base")){if(n.includes(r.tagName))return!1;n.push(r.tagName)}}return e.length>0}function FF(t){const e=In(t,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&r9(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function UF(t,e,n){const i=zE(n,e),r=In(t,-1,!0);return n&&i&&i.type==="element"&&i.tagName==="colgroup"&&o9(i,n.children.indexOf(i),n)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function VF(t,e,n){const i=zE(n,e),r=In(t,-1);return n&&i&&i.type==="element"&&(i.tagName==="thead"||i.tagName==="tbody")&&o9(i,n.children.indexOf(i),n)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}const bf={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function zF(t,e,n,i){const r=i.schema,o=r.space==="svg"?!1:i.settings.omitOptionalTags;let s=r.space==="svg"?i.settings.closeEmptyElements:i.settings.voids.includes(t.tagName.toLowerCase());const a=[];let l;r.space==="html"&&t.tagName==="svg"&&(i.schema=s0);const c=jF(i,t.properties),d=i.all(r.space==="html"&&t.tagName==="template"?t.content:t);return i.schema=r,d&&(s=!1),(c||!o||!RF(t,e,n))&&(a.push("<",t.tagName,c?" "+c:""),s&&(r.space==="svg"||i.settings.closeSelfClosing)&&(l=c.charAt(c.length-1),(!i.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(d),!s&&(!o||!o9(t,e,n))&&a.push("</"+t.tagName+">"),a.join("")}function jF(t,e){const n=[];let i=-1,r;if(e){for(r in e)if(e[r]!==null&&e[r]!==void 0){const o=GF(t,r,e[r]);o&&n.push(o)}}for(;++i<n.length;){const o=t.settings.tightAttributes?n[i].charAt(n[i].length-1):void 0;i!==n.length-1&&o!=='"'&&o!=="'"&&(n[i]+=" ")}return n.join("")}function GF(t,e,n){const i=Qm(t.schema,e),r=t.settings.allowParseErrors&&t.schema.space==="html"?0:1,o=t.settings.allowDangerousCharacters?0:1;let s=t.quote,a;if(i.overloadedBoolean&&(n===i.attribute||n==="")?n=!0:(i.boolean||i.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const l=k1(i.attribute,Object.assign({},t.settings.characterReferences,{subset:bf.name[r][o]}));return n===!0||(n=Array.isArray(n)?(i.commaSeparated?YO:KO)(n,{padLeft:!t.settings.tightCommaSeparatedLists}):String(n),t.settings.collapseEmptyAttributes&&!n)?l:(t.settings.preferUnquoted&&(a=k1(n,Object.assign({},t.settings.characterReferences,{attribute:!0,subset:bf.unquoted[r][o]}))),a!==n&&(t.settings.quoteSmart&&U2(n,s)>U2(n,t.alternative)&&(s=t.alternative),a=s+k1(n,Object.assign({},t.settings.characterReferences,{subset:(s==="'"?bf.single:bf.double)[r][o],attribute:!0}))+s),l+(a&&"="+a))}function ZE(t,e,n,i){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?t.value:k1(t.value,Object.assign({},i.settings.characterReferences,{subset:["<","&"]}))}function ZF(t,e,n,i){return i.settings.allowDangerousHtml?t.value:ZE(t,e,n,i)}function WF(t,e,n,i){return i.all(t)}const qF=UE("type",{invalid:YF,unknown:XF,handlers:{comment:wF,doctype:xF,element:zF,raw:ZF,root:WF,text:ZE}});function YF(t){throw new Error("Expected node, not `"+t+"`")}function XF(t){const e=t;throw new Error("Cannot compile unknown node `"+e.type+"`")}const KF={},QF={},JF=[];function eU(t,e){const n=e||KF,i=n.quote||'"',r=i==='"'?"'":'"';if(i!=='"'&&i!=="'")throw new Error("Invalid quote `"+i+"`, expected `'` or `\"`");return{one:tU,all:nU,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||uF,characterReferences:n.characterReferences||QF,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?s0:Gg,quote:i,alternative:r}.one(Array.isArray(t)?{type:"root",children:t}:t,void 0,void 0)}function tU(t,e,n){return qF(t,e,n,this)}function nU(t){const e=[],n=t&&t.children||JF;let i=-1;for(;++i<n.length;)e[i]=this.one(n[i],i,t);return e.join("")}function iU(t){const e=this,n={...e.data("settings"),...t};e.compiler=i;function i(r){return eU(r,n)}}var WE={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(m1,()=>{return n={770:function(r,o,s){var a=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(o,"__esModule",{value:!0}),o.setDefaultDebugCall=o.createOnigScanner=o.createOnigString=o.loadWASM=o.OnigScanner=o.OnigString=void 0;const l=a(s(418));let c=null,d=!1;class u{static _utf8ByteLength(m){let y=0;for(let x=0,T=m.length;x<T;x++){const M=m.charCodeAt(x);let k=M,_=!1;if(M>=55296&&M<=56319&&x+1<T){const A=m.charCodeAt(x+1);A>=56320&&A<=57343&&(k=65536+(M-55296<<10)|A-56320,_=!0)}y+=k<=127?1:k<=2047?2:k<=65535?3:4,_&&x++}return y}constructor(m){const y=m.length,x=u._utf8ByteLength(m),T=x!==y,M=T?new Uint32Array(y+1):null;T&&(M[y]=x);const k=T?new Uint32Array(x+1):null;T&&(k[x]=y);const _=new Uint8Array(x);let A=0;for(let $=0;$<y;$++){const E=m.charCodeAt($);let R=E,I=!1;if(E>=55296&&E<=56319&&$+1<y){const N=m.charCodeAt($+1);N>=56320&&N<=57343&&(R=65536+(E-55296<<10)|N-56320,I=!0)}T&&(M[$]=A,I&&(M[$+1]=A),R<=127?k[A+0]=$:R<=2047?(k[A+0]=$,k[A+1]=$):R<=65535?(k[A+0]=$,k[A+1]=$,k[A+2]=$):(k[A+0]=$,k[A+1]=$,k[A+2]=$,k[A+3]=$)),R<=127?_[A++]=R:R<=2047?(_[A++]=192|(1984&R)>>>6,_[A++]=128|(63&R)>>>0):R<=65535?(_[A++]=224|(61440&R)>>>12,_[A++]=128|(4032&R)>>>6,_[A++]=128|(63&R)>>>0):(_[A++]=240|(1835008&R)>>>18,_[A++]=128|(258048&R)>>>12,_[A++]=128|(4032&R)>>>6,_[A++]=128|(63&R)>>>0),I&&$++}this.utf16Length=y,this.utf8Length=x,this.utf16Value=m,this.utf8Value=_,this.utf16OffsetToUtf8=M,this.utf8OffsetToUtf16=k}createString(m){const y=m._omalloc(this.utf8Length);return m.HEAPU8.set(this.utf8Value,y),y}}class h{constructor(m){if(this.id=++h.LAST_ID,!c)throw new Error("Must invoke loadWASM first.");this._onigBinding=c,this.content=m;const y=new u(m);this.utf16Length=y.utf16Length,this.utf8Length=y.utf8Length,this.utf16OffsetToUtf8=y.utf16OffsetToUtf8,this.utf8OffsetToUtf16=y.utf8OffsetToUtf16,this.utf8Length<1e4&&!h._sharedPtrInUse?(h._sharedPtr||(h._sharedPtr=c._omalloc(1e4)),h._sharedPtrInUse=!0,c.HEAPU8.set(y.utf8Value,h._sharedPtr),this.ptr=h._sharedPtr):this.ptr=y.createString(c)}convertUtf8OffsetToUtf16(m){return this.utf8OffsetToUtf16?m<0?0:m>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[m]:m}convertUtf16OffsetToUtf8(m){return this.utf16OffsetToUtf8?m<0?0:m>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[m]:m}dispose(){this.ptr===h._sharedPtr?h._sharedPtrInUse=!1:this._onigBinding._ofree(this.ptr)}}o.OnigString=h,h.LAST_ID=0,h._sharedPtr=0,h._sharedPtrInUse=!1;class p{constructor(m){if(!c)throw new Error("Must invoke loadWASM first.");const y=[],x=[];for(let _=0,A=m.length;_<A;_++){const $=new u(m[_]);y[_]=$.createString(c),x[_]=$.utf8Length}const T=c._omalloc(4*m.length);c.HEAPU32.set(y,T/4);const M=c._omalloc(4*m.length);c.HEAPU32.set(x,M/4);const k=c._createOnigScanner(T,M,m.length);for(let _=0,A=m.length;_<A;_++)c._ofree(y[_]);c._ofree(M),c._ofree(T),k===0&&function(_){throw new Error(_.UTF8ToString(_._getLastOnigError()))}(c),this._onigBinding=c,this._ptr=k}dispose(){this._onigBinding._freeOnigScanner(this._ptr)}findNextMatchSync(m,y,x){let T=d,M=0;if(typeof x=="number"?(8&x&&(T=!0),M=x):typeof x=="boolean"&&(T=x),typeof m=="string"){m=new h(m);const k=this._findNextMatchSync(m,y,T,M);return m.dispose(),k}return this._findNextMatchSync(m,y,T,M)}_findNextMatchSync(m,y,x,T){const M=this._onigBinding;let k;if(k=x?M._findNextOnigScannerMatchDbg(this._ptr,m.id,m.ptr,m.utf8Length,m.convertUtf16OffsetToUtf8(y),T):M._findNextOnigScannerMatch(this._ptr,m.id,m.ptr,m.utf8Length,m.convertUtf16OffsetToUtf8(y),T),k===0)return null;const _=M.HEAPU32;let A=k/4;const $=_[A++],E=_[A++];let R=[];for(let I=0;I<E;I++){const N=m.convertUtf8OffsetToUtf16(_[A++]),P=m.convertUtf8OffsetToUtf16(_[A++]);R[I]={start:N,end:P,length:P-N}}return{index:$,captureIndices:R}}}o.OnigScanner=p;let g=!1,f=null;o.loadWASM=function(v){if(g)return f;let m,y,x,T;if(g=!0,function(M){return typeof M.instantiator=="function"}(v))m=v.instantiator,y=v.print;else{let M;(function(k){return k.data!==void 0})(v)?(M=v.data,y=v.print):M=v,m=function(k){return typeof Response<"u"&&k instanceof Response}(M)?typeof WebAssembly.instantiateStreaming=="function"?function(k){return _=>WebAssembly.instantiateStreaming(k,_)}(M):function(k){return async _=>{const A=await k.arrayBuffer();return WebAssembly.instantiate(A,_)}}(M):function(k){return _=>WebAssembly.instantiate(k,_)}(M)}return f=new Promise((M,k)=>{x=M,T=k}),function(M,k,_,A){(0,l.default)({print:k,instantiateWasm:($,E)=>{if(typeof performance>"u"){const R=()=>Date.now();$.env.emscripten_get_now=R,$.wasi_snapshot_preview1.emscripten_get_now=R}return M($).then(R=>E(R.instance),A),{}}}).then($=>{c=$,_()})}(m,y,x,T),f},o.createOnigString=function(v){return new h(v)},o.createOnigScanner=function(v){return new p(v)},o.setDefaultDebugCall=function(v){d=v}},418:r=>{var o=(typeof document<"u"&&document.currentScript&&document.currentScript.src,function(s){var a,l,c=(s=s||{})!==void 0?s:{};c.ready=new Promise(function(se,Te){a=se,l=Te});var d,u=Object.assign({},c),h=!1,p="";function g(se){return c.locateFile?c.locateFile(se,p):p+se}d=function(se){let Te;return typeof readbuffer=="function"?new Uint8Array(readbuffer(se)):(Te=read(se,"binary"),T(typeof Te=="object"),Te)},typeof scriptArgs<"u"&&scriptArgs,typeof onig_print<"u"&&(typeof console>"u"&&(console={}),console.log=onig_print,console.warn=console.error=typeof printErr<"u"?printErr:onig_print);var f,v,m=c.print||console.log.bind(console),y=c.printErr||console.warn.bind(console);Object.assign(c,u),u=null,c.arguments&&c.arguments,c.thisProgram&&c.thisProgram,c.quit&&c.quit,c.wasmBinary&&(f=c.wasmBinary),c.noExitRuntime,typeof WebAssembly!="object"&&xe("no native wasm support detected");var x=!1;function T(se,Te){se||xe(Te)}var M,k,_,A=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function $(se,Te,Y){for(var be=Te+Y,O=Te;se[O]&&!(O>=be);)++O;if(O-Te>16&&se.buffer&&A)return A.decode(se.subarray(Te,O));for(var C="";Te<O;){var S=se[Te++];if(128&S){var V=63&se[Te++];if((224&S)!=192){var J=63&se[Te++];if((S=(240&S)==224?(15&S)<<12|V<<6|J:(7&S)<<18|V<<12|J<<6|63&se[Te++])<65536)C+=String.fromCharCode(S);else{var de=S-65536;C+=String.fromCharCode(55296|de>>10,56320|1023&de)}}else C+=String.fromCharCode((31&S)<<6|V)}else C+=String.fromCharCode(S)}return C}function E(se,Te){return se?$(k,se,Te):""}function R(se){M=se,c.HEAP8=new Int8Array(se),c.HEAP16=new Int16Array(se),c.HEAP32=new Int32Array(se),c.HEAPU8=k=new Uint8Array(se),c.HEAPU16=new Uint16Array(se),c.HEAPU32=_=new Uint32Array(se),c.HEAPF32=new Float32Array(se),c.HEAPF64=new Float64Array(se)}c.INITIAL_MEMORY;var I=[],N=[],P=[];function Z(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Le(c.preRun.shift());et(I)}function pe(){et(N)}function Q(){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)H(c.postRun.shift());et(P)}function Le(se){I.unshift(se)}function ue(se){N.unshift(se)}function H(se){P.unshift(se)}var ee=0,K=null;function U(se){ee++,c.monitorRunDependencies&&c.monitorRunDependencies(ee)}function Ee(se){if(ee--,c.monitorRunDependencies&&c.monitorRunDependencies(ee),ee==0&&K){var Te=K;K=null,Te()}}function xe(se){c.onAbort&&c.onAbort(se),y(se="Aborted("+se+")"),x=!0,se+=". Build with -sASSERTIONS for more info.";var Te=new WebAssembly.RuntimeError(se);throw l(Te),Te}var Pe,ze,le="data:application/octet-stream;base64,";function He(se){return se.startsWith(le)}function Ne(se){try{if(se==Pe&&f)return new Uint8Array(f);if(d)return d(se);throw"both async and sync fetching of the wasm failed"}catch(Te){xe(Te)}}function Ue(){return f||!h||typeof fetch!="function"?Promise.resolve().then(function(){return Ne(Pe)}):fetch(Pe,{credentials:"same-origin"}).then(function(se){if(!se.ok)throw"failed to load wasm binary file at '"+Pe+"'";return se.arrayBuffer()}).catch(function(){return Ne(Pe)})}function lt(){var se={env:Se,wasi_snapshot_preview1:Se};function Te(O,C){var S=O.exports;c.asm=S,R((v=c.asm.memory).buffer),c.asm.__indirect_function_table,ue(c.asm.__wasm_call_ctors),Ee()}function Y(O){Te(O.instance)}function be(O){return Ue().then(function(C){return WebAssembly.instantiate(C,se)}).then(function(C){return C}).then(O,function(C){y("failed to asynchronously prepare wasm: "+C),xe(C)})}if(U(),c.instantiateWasm)try{return c.instantiateWasm(se,Te)}catch(O){y("Module.instantiateWasm callback failed with error: "+O),l(O)}return(f||typeof WebAssembly.instantiateStreaming!="function"||He(Pe)||typeof fetch!="function"?be(Y):fetch(Pe,{credentials:"same-origin"}).then(function(O){return WebAssembly.instantiateStreaming(O,se).then(Y,function(C){return y("wasm streaming compile failed: "+C),y("falling back to ArrayBuffer instantiation"),be(Y)})})).catch(l),{}}function et(se){for(;se.length>0;)se.shift()(c)}function B(se,Te,Y){k.copyWithin(se,Te,Te+Y)}function _e(se){try{return v.grow(se-M.byteLength+65535>>>16),R(v.buffer),1}catch{}}function fe(se){var Te,Y=k.length,be=2147483648;if((se>>>=0)>be)return!1;for(var O=1;O<=4;O*=2){var C=Y*(1+.2/O);if(C=Math.min(C,se+100663296),_e(Math.min(be,(Te=Math.max(se,C))+(65536-Te%65536)%65536)))return!0}return!1}He(Pe="onig.wasm")||(Pe=g(Pe)),ze=typeof dateNow<"u"?dateNow:()=>performance.now();var G=[null,[],[]];function j(se,Te){var Y=G[se];Te===0||Te===10?((se===1?m:y)($(Y,0)),Y.length=0):Y.push(Te)}function re(se,Te,Y,be){for(var O=0,C=0;C<Y;C++){var S=_[Te>>2],V=_[Te+4>>2];Te+=8;for(var J=0;J<V;J++)j(se,k[S+J]);O+=V}return _[be>>2]=O,0}var Ce,Se={emscripten_get_now:ze,emscripten_memcpy_big:B,emscripten_resize_heap:fe,fd_write:re};function oe(se){function Te(){Ce||(Ce=!0,c.calledRun=!0,x||(pe(),a(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),Q()))}ee>0||(Z(),ee>0||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),Te()},1)):Te()))}if(lt(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.__wasm_call_ctors).apply(null,arguments)},c.___errno_location=function(){return(c.___errno_location=c.asm.__errno_location).apply(null,arguments)},c._omalloc=function(){return(c._omalloc=c.asm.omalloc).apply(null,arguments)},c._ofree=function(){return(c._ofree=c.asm.ofree).apply(null,arguments)},c._getLastOnigError=function(){return(c._getLastOnigError=c.asm.getLastOnigError).apply(null,arguments)},c._createOnigScanner=function(){return(c._createOnigScanner=c.asm.createOnigScanner).apply(null,arguments)},c._freeOnigScanner=function(){return(c._freeOnigScanner=c.asm.freeOnigScanner).apply(null,arguments)},c._findNextOnigScannerMatch=function(){return(c._findNextOnigScannerMatch=c.asm.findNextOnigScannerMatch).apply(null,arguments)},c._findNextOnigScannerMatchDbg=function(){return(c._findNextOnigScannerMatchDbg=c.asm.findNextOnigScannerMatchDbg).apply(null,arguments)},c.stackSave=function(){return(c.stackSave=c.asm.stackSave).apply(null,arguments)},c.stackRestore=function(){return(c.stackRestore=c.asm.stackRestore).apply(null,arguments)},c.stackAlloc=function(){return(c.stackAlloc=c.asm.stackAlloc).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.dynCall_jiji).apply(null,arguments)},c.UTF8ToString=E,K=function se(){Ce||oe(),Ce||(K=se)},c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();return oe(),s.ready});r.exports=o}},i={},function r(o){var s=i[o];if(s!==void 0)return s.exports;var a=i[o]={exports:{}};return n[o].call(a.exports,a,a.exports,r),a.exports}(770);var n,i})})(WE);var vf=WE.exports,qE={exports:{}};(function(t,e){var n={};(function(i,r){t.exports=r()})(m1,function(){return(()=>{var i={350:(o,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UseOnigurumaFindOptions=s.DebugFlags=void 0,s.DebugFlags={InDebugMode:typeof process<"u"&&!!n.VSCODE_TEXTMATE_DEBUG},s.UseOnigurumaFindOptions=!1},36:(o,s)=>{var a;Object.defineProperty(s,"__esModule",{value:!0}),s.toOptionalTokenType=s.EncodedTokenAttributes=void 0,(a=s.EncodedTokenAttributes||(s.EncodedTokenAttributes={})).toBinaryStr=function(l){let c=l.toString(2);for(;c.length<32;)c="0"+c;return c},a.print=function(l){const c=a.getLanguageId(l),d=a.getTokenType(l),u=a.getFontStyle(l),h=a.getForeground(l),p=a.getBackground(l);console.log({languageId:c,tokenType:d,fontStyle:u,foreground:h,background:p})},a.getLanguageId=function(l){return(255&l)>>>0},a.getTokenType=function(l){return(768&l)>>>8},a.containsBalancedBrackets=function(l){return(1024&l)!=0},a.getFontStyle=function(l){return(30720&l)>>>11},a.getForeground=function(l){return(16744448&l)>>>15},a.getBackground=function(l){return(4278190080&l)>>>24},a.set=function(l,c,d,u,h,p,g){let f=a.getLanguageId(l),v=a.getTokenType(l),m=a.containsBalancedBrackets(l)?1:0,y=a.getFontStyle(l),x=a.getForeground(l),T=a.getBackground(l);return c!==0&&(f=c),d!==8&&(v=d),u!==null&&(m=u?1:0),h!==-1&&(y=h),p!==0&&(x=p),g!==0&&(T=g),(f<<0|v<<8|m<<10|y<<11|x<<15|T<<24)>>>0},s.toOptionalTokenType=function(l){return l}},996:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BasicScopeAttributesProvider=s.BasicScopeAttributes=void 0;const l=a(878);class c{constructor(p,g){this.languageId=p,this.tokenType=g}}s.BasicScopeAttributes=c;class d{constructor(p,g){this._getBasicScopeAttributes=new l.CachedFn(f=>{const v=this._scopeToLanguage(f),m=this._toStandardTokenType(f);return new c(v,m)}),this._defaultAttributes=new c(p,8),this._embeddedLanguagesMatcher=new u(Object.entries(g||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(p){return p===null?d._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(p)}_scopeToLanguage(p){return this._embeddedLanguagesMatcher.match(p)||0}_toStandardTokenType(p){const g=p.match(d.STANDARD_TOKEN_TYPE_REGEXP);if(!g)return 8;switch(g[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}s.BasicScopeAttributesProvider=d,d._NULL_SCOPE_METADATA=new c(0,0),d.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class u{constructor(p){if(p.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(p);const g=p.map(([f,v])=>l.escapeRegExpCharacters(f));g.sort(),g.reverse(),this.scopesRegExp=new RegExp(`^((${g.join(")|(")}))($|\\.)`,"")}}match(p){if(!this.scopesRegExp)return;const g=p.match(this.scopesRegExp);return g?this.values.get(g[1]):void 0}}},947:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LineTokens=s.BalancedBracketSelectors=s.StateStack=s.AttributedScopeStack=s.Grammar=s.createGrammar=void 0;const l=a(350),c=a(36),d=a(736),u=a(44),h=a(792),p=a(583),g=a(878),f=a(996),v=a(47);function m($,E,R,I,N){const P=d.createMatchers(E,y),Z=h.RuleFactory.getCompiledRuleId(R,I,N.repository);for(const pe of P)$.push({debugSelector:E,matcher:pe.matcher,ruleId:Z,grammar:N,priority:pe.priority})}function y($,E){if(E.length<$.length)return!1;let R=0;return $.every(I=>{for(let N=R;N<E.length;N++)if(x(E[N],I))return R=N+1,!0;return!1})}function x($,E){if(!$)return!1;if($===E)return!0;const R=E.length;return $.length>R&&$.substr(0,R)===E&&$[R]==="."}s.createGrammar=function($,E,R,I,N,P,Z,pe){return new T($,E,R,I,N,P,Z,pe)};class T{constructor(E,R,I,N,P,Z,pe,Q){if(this._rootScopeName=E,this.balancedBracketSelectors=Z,this._onigLib=Q,this._basicScopeAttributesProvider=new f.BasicScopeAttributesProvider(I,N),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=pe,this._grammar=M(R,null),this._injections=null,this._tokenTypeMatchers=[],P)for(const Le of Object.keys(P)){const ue=d.createMatchers(Le,y);for(const H of ue)this._tokenTypeMatchers.push({matcher:H.matcher,type:P[Le]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const E of this._ruleId2desc)E&&E.dispose()}createOnigScanner(E){return this._onigLib.createOnigScanner(E)}createOnigString(E){return this._onigLib.createOnigString(E)}getMetadataForScope(E){return this._basicScopeAttributesProvider.getBasicScopeAttributes(E)}_collectInjections(){const E=[],R=this._rootScopeName,I=(N=>N===this._rootScopeName?this._grammar:this.getExternalGrammar(N))(R);if(I){const N=I.injections;if(N)for(let Z in N)m(E,Z,N[Z],this,I);const P=this._grammarRepository.injections(R);P&&P.forEach(Z=>{const pe=this.getExternalGrammar(Z);if(pe){const Q=pe.injectionSelector;Q&&m(E,Q,pe,this,pe)}})}return E.sort((N,P)=>N.priority-P.priority),E}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),l.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(const E of this._injections)console.log(`  - ${E.debugSelector}`)}return this._injections}registerRule(E){const R=++this._lastRuleId,I=E(h.ruleIdFromNumber(R));return this._ruleId2desc[R]=I,I}getRule(E){return this._ruleId2desc[h.ruleIdToNumber(E)]}getExternalGrammar(E,R){if(this._includedGrammars[E])return this._includedGrammars[E];if(this._grammarRepository){const I=this._grammarRepository.lookup(E);if(I)return this._includedGrammars[E]=M(I,R&&R.$base),this._includedGrammars[E]}}tokenizeLine(E,R,I=0){const N=this._tokenize(E,R,!1,I);return{tokens:N.lineTokens.getResult(N.ruleStack,N.lineLength),ruleStack:N.ruleStack,stoppedEarly:N.stoppedEarly}}tokenizeLine2(E,R,I=0){const N=this._tokenize(E,R,!0,I);return{tokens:N.lineTokens.getBinaryResult(N.ruleStack,N.lineLength),ruleStack:N.ruleStack,stoppedEarly:N.stoppedEarly}}_tokenize(E,R,I,N){let P;if(this._rootId===-1&&(this._rootId=h.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository)),R&&R!==_.NULL)P=!1,R.reset();else{P=!0;const ue=this._basicScopeAttributesProvider.getDefaultAttributes(),H=this.themeProvider.getDefaults(),ee=c.EncodedTokenAttributes.set(0,ue.languageId,ue.tokenType,null,H.fontStyle,H.foregroundId,H.backgroundId),K=this.getRule(this._rootId).getName(null,null);let U;U=K?k.createRootAndLookUpScopeName(K,ee,this):k.createRoot("unknown",ee),R=new _(null,this._rootId,-1,-1,!1,null,U,U)}E+=`
`;const Z=this.createOnigString(E),pe=Z.content.length,Q=new A(I,E,this._tokenTypeMatchers,this.balancedBracketSelectors),Le=v._tokenizeString(this,Z,P,0,R,Q,!0,N);return u.disposeOnigString(Z),{lineLength:pe,lineTokens:Q,ruleStack:Le.stack,stoppedEarly:Le.stoppedEarly}}}function M($,E){return($=g.clone($)).repository=$.repository||{},$.repository.$self={$vscodeTextmateLocation:$.$vscodeTextmateLocation,patterns:$.patterns,name:$.scopeName},$.repository.$base=E||$.repository.$self,$}s.Grammar=T;class k{constructor(E,R,I){this.parent=E,this.scopePath=R,this.tokenAttributes=I}static createRoot(E,R){return new k(null,new p.ScopeStack(null,E),R)}static createRootAndLookUpScopeName(E,R,I){const N=I.getMetadataForScope(E),P=new p.ScopeStack(null,E),Z=I.themeProvider.themeMatch(P),pe=k.mergeAttributes(R,N,Z);return new k(null,P,pe)}get scopeName(){return this.scopePath.scopeName}equals(E){return k._equals(this,E)}static _equals(E,R){for(;;){if(E===R||!E&&!R)return!0;if(!E||!R||E.scopeName!==R.scopeName||E.tokenAttributes!==R.tokenAttributes)return!1;E=E.parent,R=R.parent}}static mergeAttributes(E,R,I){let N=-1,P=0,Z=0;return I!==null&&(N=I.fontStyle,P=I.foregroundId,Z=I.backgroundId),c.EncodedTokenAttributes.set(E,R.languageId,R.tokenType,null,N,P,Z)}pushAttributed(E,R){if(E===null)return this;if(E.indexOf(" ")===-1)return k._pushAttributed(this,E,R);const I=E.split(/ /g);let N=this;for(const P of I)N=k._pushAttributed(N,P,R);return N}static _pushAttributed(E,R,I){const N=I.getMetadataForScope(R),P=E.scopePath.push(R),Z=I.themeProvider.themeMatch(P),pe=k.mergeAttributes(E.tokenAttributes,N,Z);return new k(E,P,pe)}getScopeNames(){return this.scopePath.getSegments()}}s.AttributedScopeStack=k;class _{constructor(E,R,I,N,P,Z,pe,Q){this.parent=E,this.ruleId=R,this.beginRuleCapturedEOL=P,this.endRule=Z,this.nameScopesList=pe,this.contentNameScopesList=Q,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=I,this._anchorPos=N}equals(E){return E!==null&&_._equals(this,E)}static _equals(E,R){return E===R||!!this._structuralEquals(E,R)&&E.contentNameScopesList.equals(R.contentNameScopesList)}static _structuralEquals(E,R){for(;;){if(E===R||!E&&!R)return!0;if(!E||!R||E.depth!==R.depth||E.ruleId!==R.ruleId||E.endRule!==R.endRule)return!1;E=E.parent,R=R.parent}}clone(){return this}static _reset(E){for(;E;)E._enterPos=-1,E._anchorPos=-1,E=E.parent}reset(){_._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(E,R,I,N,P,Z,pe){return new _(this,E,R,I,N,P,Z,pe)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(E){return E.getRule(this.ruleId)}toString(){const E=[];return this._writeString(E,0),"["+E.join(",")+"]"}_writeString(E,R){return this.parent&&(R=this.parent._writeString(E,R)),E[R++]=`(${this.ruleId}, TODO-${this.nameScopesList}, TODO-${this.contentNameScopesList})`,R}withContentNameScopesList(E){return this.contentNameScopesList===E?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,E)}withEndRule(E){return this.endRule===E?this:new _(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,E,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(E){let R=this;for(;R&&R._enterPos===E._enterPos;){if(R.ruleId===E.ruleId)return!0;R=R.parent}return!1}}s.StateStack=_,_.NULL=new _(null,0,0,0,!1,null,null,null),s.BalancedBracketSelectors=class{constructor($,E){this.allowAny=!1,this.balancedBracketScopes=$.flatMap(R=>R==="*"?(this.allowAny=!0,[]):d.createMatchers(R,y).map(I=>I.matcher)),this.unbalancedBracketScopes=E.flatMap(R=>d.createMatchers(R,y).map(I=>I.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match($){for(const E of this.unbalancedBracketScopes)if(E($))return!1;for(const E of this.balancedBracketScopes)if(E($))return!0;return this.allowAny}};class A{constructor(E,R,I,N){this.balancedBracketSelectors=N,this._emitBinaryTokens=E,this._tokenTypeOverrides=I,l.DebugFlags.InDebugMode?this._lineText=R:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(E,R){this.produceFromScopes(E.contentNameScopesList,R)}produceFromScopes(E,R){if(this._lastTokenEndIndex>=R)return;if(this._emitBinaryTokens){let N=E.tokenAttributes,P=!1;if(this.balancedBracketSelectors?.matchesAlways&&(P=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const Z=E.getScopeNames();for(const pe of this._tokenTypeOverrides)pe.matcher(Z)&&(N=c.EncodedTokenAttributes.set(N,0,c.toOptionalTokenType(pe.type),null,-1,0,0));this.balancedBracketSelectors&&(P=this.balancedBracketSelectors.match(Z))}if(P&&(N=c.EncodedTokenAttributes.set(N,0,8,P,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===N)return void(this._lastTokenEndIndex=R);if(l.DebugFlags.InDebugMode){const Z=E.getScopeNames();console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,R).replace(/\n$/,"\\n")+"|");for(let pe=0;pe<Z.length;pe++)console.log("      * "+Z[pe])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(N),void(this._lastTokenEndIndex=R)}const I=E.getScopeNames();if(l.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,R).replace(/\n$/,"\\n")+"|");for(let N=0;N<I.length;N++)console.log("      * "+I[N])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:R,scopes:I}),this._lastTokenEndIndex=R}getResult(E,R){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===R-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(E,R),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(E,R){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===R-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(E,R),this._binaryTokens[this._binaryTokens.length-2]=0);const I=new Uint32Array(this._binaryTokens.length);for(let N=0,P=this._binaryTokens.length;N<P;N++)I[N]=this._binaryTokens[N];return I}}s.LineTokens=A},965:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.parseInclude=s.TopLevelRepositoryReference=s.TopLevelReference=s.RelativeReference=s.SelfReference=s.BaseReference=s.ScopeDependencyProcessor=s.ExternalReferenceCollector=s.TopLevelRepositoryRuleReference=s.TopLevelRuleReference=void 0;const l=a(878);class c{constructor(_){this.scopeName=_}toKey(){return this.scopeName}}s.TopLevelRuleReference=c;class d{constructor(_,A){this.scopeName=_,this.ruleName=A}toKey(){return`${this.scopeName}#${this.ruleName}`}}s.TopLevelRepositoryRuleReference=d;class u{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(_){const A=_.toKey();this._seenReferenceKeys.has(A)||(this._seenReferenceKeys.add(A),this._references.push(_))}}function h(k,_,A,$){const E=A.lookup(k.scopeName);if(!E){if(k.scopeName===_)throw new Error(`No grammar provided for <${_}>`);return}const R=A.lookup(_);k instanceof c?g({baseGrammar:R,selfGrammar:E},$):p(k.ruleName,{baseGrammar:R,selfGrammar:E,repository:E.repository},$);const I=A.injections(k.scopeName);if(I)for(const N of I)$.add(new c(N))}function p(k,_,A){_.repository&&_.repository[k]&&f([_.repository[k]],_,A)}function g(k,_){k.selfGrammar.patterns&&Array.isArray(k.selfGrammar.patterns)&&f(k.selfGrammar.patterns,{...k,repository:k.selfGrammar.repository},_),k.selfGrammar.injections&&f(Object.values(k.selfGrammar.injections),{...k,repository:k.selfGrammar.repository},_)}function f(k,_,A){for(const $ of k){if(A.visitedRule.has($))continue;A.visitedRule.add($);const E=$.repository?l.mergeObjects({},_.repository,$.repository):_.repository;Array.isArray($.patterns)&&f($.patterns,{..._,repository:E},A);const R=$.include;if(!R)continue;const I=M(R);switch(I.kind){case 0:g({..._,selfGrammar:_.baseGrammar},A);break;case 1:g(_,A);break;case 2:p(I.ruleName,{..._,repository:E},A);break;case 3:case 4:const N=I.scopeName===_.selfGrammar.scopeName?_.selfGrammar:I.scopeName===_.baseGrammar.scopeName?_.baseGrammar:void 0;if(N){const P={baseGrammar:_.baseGrammar,selfGrammar:N,repository:E};I.kind===4?p(I.ruleName,P,A):g(P,A)}else I.kind===4?A.add(new d(I.scopeName,I.ruleName)):A.add(new c(I.scopeName))}}}s.ExternalReferenceCollector=u,s.ScopeDependencyProcessor=class{constructor(k,_){this.repo=k,this.initialScopeName=_,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new c(this.initialScopeName)]}processQueue(){const k=this.Q;this.Q=[];const _=new u;for(const A of k)h(A,this.initialScopeName,this.repo,_);for(const A of _.references)if(A instanceof c){if(this.seenFullScopeRequests.has(A.scopeName))continue;this.seenFullScopeRequests.add(A.scopeName),this.Q.push(A)}else{if(this.seenFullScopeRequests.has(A.scopeName)||this.seenPartialScopeRequests.has(A.toKey()))continue;this.seenPartialScopeRequests.add(A.toKey()),this.Q.push(A)}}};class v{constructor(){this.kind=0}}s.BaseReference=v;class m{constructor(){this.kind=1}}s.SelfReference=m;class y{constructor(_){this.ruleName=_,this.kind=2}}s.RelativeReference=y;class x{constructor(_){this.scopeName=_,this.kind=3}}s.TopLevelReference=x;class T{constructor(_,A){this.scopeName=_,this.ruleName=A,this.kind=4}}function M(k){if(k==="$base")return new v;if(k==="$self")return new m;const _=k.indexOf("#");if(_===-1)return new x(k);if(_===0)return new y(k.substring(1));{const A=k.substring(0,_),$=k.substring(_+1);return new T(A,$)}}s.TopLevelRepositoryReference=T,s.parseInclude=M},391:function(o,s,a){var l=this&&this.__createBinding||(Object.create?function(d,u,h,p){p===void 0&&(p=h),Object.defineProperty(d,p,{enumerable:!0,get:function(){return u[h]}})}:function(d,u,h,p){p===void 0&&(p=h),d[p]=u[h]}),c=this&&this.__exportStar||function(d,u){for(var h in d)h==="default"||Object.prototype.hasOwnProperty.call(u,h)||l(u,d,h)};Object.defineProperty(s,"__esModule",{value:!0}),c(a(947),s)},47:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LocalStackElement=s._tokenizeString=void 0;const l=a(350),c=a(44),d=a(792),u=a(878);class h{constructor(T,M){this.stack=T,this.stoppedEarly=M}}function p(x,T,M,k,_,A,$,E){const R=T.content.length;let I=!1,N=-1;if($){const pe=function(Q,Le,ue,H,ee,K){let U=ee.beginRuleCapturedEOL?0:-1;const Ee=[];for(let xe=ee;xe;xe=xe.pop()){const Pe=xe.getRule(Q);Pe instanceof d.BeginWhileRule&&Ee.push({rule:Pe,stack:xe})}for(let xe=Ee.pop();xe;xe=Ee.pop()){const{ruleScanner:Pe,findOptions:ze}=f(xe.rule,Q,xe.stack.endRule,ue,H===U),le=Pe.findNextMatchSync(Le,H,ze);if(l.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log(Pe.toString())),!le){l.DebugFlags.InDebugMode&&console.log("  popping "+xe.rule.debugName+" - "+xe.rule.debugWhileRegExp),ee=xe.stack.pop();break}if(le.ruleId!==d.whileRuleId){ee=xe.stack.pop();break}le.captureIndices&&le.captureIndices.length&&(K.produce(xe.stack,le.captureIndices[0].start),m(Q,Le,ue,xe.stack,K,xe.rule.whileCaptures,le.captureIndices),K.produce(xe.stack,le.captureIndices[0].end),U=le.captureIndices[0].end,le.captureIndices[0].end>H&&(H=le.captureIndices[0].end,ue=!1))}return{stack:ee,linePos:H,anchorPosition:U,isFirstLine:ue}}(x,T,M,k,_,A);_=pe.stack,k=pe.linePos,M=pe.isFirstLine,N=pe.anchorPosition}const P=Date.now();for(;!I;){if(E!==0&&Date.now()-P>E)return new h(_,!0);Z()}return new h(_,!1);function Z(){l.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${k}: |${T.content.substr(k).replace(/\n$/,"\\n")}|`));const pe=function(H,ee,K,U,Ee,xe){const Pe=function(Ue,lt,et,B,_e,fe){const G=_e.getRule(Ue),{ruleScanner:j,findOptions:re}=g(G,Ue,_e.endRule,et,B===fe);let Ce=0;l.DebugFlags.InDebugMode&&(Ce=u.performanceNow());const Se=j.findNextMatchSync(lt,B,re);if(l.DebugFlags.InDebugMode){const oe=u.performanceNow()-Ce;oe>5&&console.warn(`Rule ${G.debugName} (${G.id}) matching took ${oe} against '${lt}'`),console.log(`  scanning for (linePos: ${B}, anchorPosition: ${fe})`),console.log(j.toString()),Se&&console.log(`matched rule id: ${Se.ruleId} from ${Se.captureIndices[0].start} to ${Se.captureIndices[0].end}`)}return Se?{captureIndices:Se.captureIndices,matchedRuleId:Se.ruleId}:null}(H,ee,K,U,Ee,xe),ze=H.getInjections();if(ze.length===0)return Pe;const le=function(Ue,lt,et,B,_e,fe,G){let j,re=Number.MAX_VALUE,Ce=null,Se=0;const oe=fe.contentNameScopesList.getScopeNames();for(let se=0,Te=Ue.length;se<Te;se++){const Y=Ue[se];if(!Y.matcher(oe))continue;const be=lt.getRule(Y.ruleId),{ruleScanner:O,findOptions:C}=g(be,lt,null,B,_e===G),S=O.findNextMatchSync(et,_e,C);if(!S)continue;l.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${Y.debugSelector}`),console.log(O.toString()));const V=S.captureIndices[0].start;if(!(V>=re)&&(re=V,Ce=S.captureIndices,j=S.ruleId,Se=Y.priority,re===_e))break}return Ce?{priorityMatch:Se===-1,captureIndices:Ce,matchedRuleId:j}:null}(ze,H,ee,K,U,Ee,xe);if(!le)return Pe;if(!Pe)return le;const He=Pe.captureIndices[0].start,Ne=le.captureIndices[0].start;return Ne<He||le.priorityMatch&&Ne===He?le:Pe}(x,T,M,k,_,N);if(!pe)return l.DebugFlags.InDebugMode&&console.log("  no more matches."),A.produce(_,R),void(I=!0);const Q=pe.captureIndices,Le=pe.matchedRuleId,ue=!!(Q&&Q.length>0)&&Q[0].end>k;if(Le===d.endRuleId){const H=_.getRule(x);l.DebugFlags.InDebugMode&&console.log("  popping "+H.debugName+" - "+H.debugEndRegExp),A.produce(_,Q[0].start),_=_.withContentNameScopesList(_.nameScopesList),m(x,T,M,_,A,H.endCaptures,Q),A.produce(_,Q[0].end);const ee=_;if(_=_.parent,N=ee.getAnchorPos(),!ue&&ee.getEnterPos()===k)return l.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),_=ee,A.produce(_,R),void(I=!0)}else{const H=x.getRule(Le);A.produce(_,Q[0].start);const ee=_,K=H.getName(T.content,Q),U=_.contentNameScopesList.pushAttributed(K,x);if(_=_.push(Le,k,N,Q[0].end===R,null,U,U),H instanceof d.BeginEndRule){const Ee=H;l.DebugFlags.InDebugMode&&console.log("  pushing "+Ee.debugName+" - "+Ee.debugBeginRegExp),m(x,T,M,_,A,Ee.beginCaptures,Q),A.produce(_,Q[0].end),N=Q[0].end;const xe=Ee.getContentName(T.content,Q),Pe=U.pushAttributed(xe,x);if(_=_.withContentNameScopesList(Pe),Ee.endHasBackReferences&&(_=_.withEndRule(Ee.getEndWithResolvedBackReferences(T.content,Q))),!ue&&ee.hasSameRuleAs(_))return l.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),_=_.pop(),A.produce(_,R),void(I=!0)}else if(H instanceof d.BeginWhileRule){const Ee=H;l.DebugFlags.InDebugMode&&console.log("  pushing "+Ee.debugName),m(x,T,M,_,A,Ee.beginCaptures,Q),A.produce(_,Q[0].end),N=Q[0].end;const xe=Ee.getContentName(T.content,Q),Pe=U.pushAttributed(xe,x);if(_=_.withContentNameScopesList(Pe),Ee.whileHasBackReferences&&(_=_.withEndRule(Ee.getWhileWithResolvedBackReferences(T.content,Q))),!ue&&ee.hasSameRuleAs(_))return l.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),_=_.pop(),A.produce(_,R),void(I=!0)}else{const Ee=H;if(l.DebugFlags.InDebugMode&&console.log("  matched "+Ee.debugName+" - "+Ee.debugMatchRegExp),m(x,T,M,_,A,Ee.captures,Q),A.produce(_,Q[0].end),_=_.pop(),!ue)return l.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),_=_.safePop(),A.produce(_,R),void(I=!0)}}Q[0].end>k&&(k=Q[0].end,M=!1)}}function g(x,T,M,k,_){return l.UseOnigurumaFindOptions?{ruleScanner:x.compile(T,M),findOptions:v(k,_)}:{ruleScanner:x.compileAG(T,M,k,_),findOptions:0}}function f(x,T,M,k,_){return l.UseOnigurumaFindOptions?{ruleScanner:x.compileWhile(T,M),findOptions:v(k,_)}:{ruleScanner:x.compileWhileAG(T,M,k,_),findOptions:0}}function v(x,T){let M=0;return x||(M|=1),T||(M|=4),M}function m(x,T,M,k,_,A,$){if(A.length===0)return;const E=T.content,R=Math.min(A.length,$.length),I=[],N=$[0].end;for(let P=0;P<R;P++){const Z=A[P];if(Z===null)continue;const pe=$[P];if(pe.length===0)continue;if(pe.start>N)break;for(;I.length>0&&I[I.length-1].endPos<=pe.start;)_.produceFromScopes(I[I.length-1].scopes,I[I.length-1].endPos),I.pop();if(I.length>0?_.produceFromScopes(I[I.length-1].scopes,pe.start):_.produce(k,pe.start),Z.retokenizeCapturedWithRuleId){const Le=Z.getName(E,$),ue=k.contentNameScopesList.pushAttributed(Le,x),H=Z.getContentName(E,$),ee=ue.pushAttributed(H,x),K=k.push(Z.retokenizeCapturedWithRuleId,pe.start,-1,!1,null,ue,ee),U=x.createOnigString(E.substring(0,pe.end));p(x,U,M&&pe.start===0,pe.start,K,_,!1,0),c.disposeOnigString(U);continue}const Q=Z.getName(E,$);if(Q!==null){const Le=(I.length>0?I[I.length-1].scopes:k.contentNameScopesList).pushAttributed(Q,x);I.push(new y(Le,pe.end))}}for(;I.length>0;)_.produceFromScopes(I[I.length-1].scopes,I[I.length-1].endPos),I.pop()}s._tokenizeString=p;class y{constructor(T,M){this.scopes=T,this.endPos=M}}s.LocalStackElement=y},974:(o,s)=>{function a(u,h){throw new Error("Near offset "+u.pos+": "+h+" ~~~"+u.source.substr(u.pos,50)+"~~~")}Object.defineProperty(s,"__esModule",{value:!0}),s.parseJSON=void 0,s.parseJSON=function(u,h,p){let g=new l(u),f=new c,v=0,m=null,y=[],x=[];function T(){y.push(v),x.push(m)}function M(){v=y.pop(),m=x.pop()}function k(_){a(g,_)}for(;d(g,f);){if(v===0){if(m!==null&&k("too many constructs in root"),f.type===3){m={},p&&(m.$vscodeTextmateLocation=f.toLocation(h)),T(),v=1;continue}if(f.type===2){m=[],T(),v=4;continue}k("unexpected token in root")}if(v===2){if(f.type===5){M();continue}if(f.type===7){v=3;continue}k("expected , or }")}if(v===1||v===3){if(v===1&&f.type===5){M();continue}if(f.type===1){let _=f.value;if(d(g,f)&&f.type===6||k("expected colon"),d(g,f)||k("expected value"),v=2,f.type===1){m[_]=f.value;continue}if(f.type===8){m[_]=null;continue}if(f.type===9){m[_]=!0;continue}if(f.type===10){m[_]=!1;continue}if(f.type===11){m[_]=parseFloat(f.value);continue}if(f.type===2){let A=[];m[_]=A,T(),v=4,m=A;continue}if(f.type===3){let A={};p&&(A.$vscodeTextmateLocation=f.toLocation(h)),m[_]=A,T(),v=1,m=A;continue}}k("unexpected token in dict")}if(v===5){if(f.type===4){M();continue}if(f.type===7){v=6;continue}k("expected , or ]")}if(v===4||v===6){if(v===4&&f.type===4){M();continue}if(v=5,f.type===1){m.push(f.value);continue}if(f.type===8){m.push(null);continue}if(f.type===9){m.push(!0);continue}if(f.type===10){m.push(!1);continue}if(f.type===11){m.push(parseFloat(f.value));continue}if(f.type===2){let _=[];m.push(_),T(),v=4,m=_;continue}if(f.type===3){let _={};p&&(_.$vscodeTextmateLocation=f.toLocation(h)),m.push(_),T(),v=1,m=_;continue}k("unexpected token in array")}k("unknown state")}return x.length!==0&&k("unclosed constructs"),m};class l{constructor(h){this.source=h,this.pos=0,this.len=h.length,this.line=1,this.char=0}}class c{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(h){return{filename:h,line:this.line,char:this.char}}}function d(u,h){h.value=null,h.type=0,h.offset=-1,h.len=-1,h.line=-1,h.char=-1;let p,g=u.source,f=u.pos,v=u.len,m=u.line,y=u.char;for(;;){if(f>=v)return!1;if(p=g.charCodeAt(f),p!==32&&p!==9&&p!==13){if(p!==10)break;f++,m++,y=0}else f++,y++}if(h.offset=f,h.line=m,h.char=y,p===34){for(h.type=1,f++,y++;;){if(f>=v)return!1;if(p=g.charCodeAt(f),f++,y++,p!==92){if(p===34)break}else f++,y++}h.value=g.substring(h.offset+1,f-1).replace(/\\u([0-9A-Fa-f]{4})/g,(x,T)=>String.fromCodePoint(parseInt(T,16))).replace(/\\(.)/g,(x,T)=>{switch(T){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:a(u,"invalid escape sequence")}throw new Error("unreachable")})}else if(p===91)h.type=2,f++,y++;else if(p===123)h.type=3,f++,y++;else if(p===93)h.type=4,f++,y++;else if(p===125)h.type=5,f++,y++;else if(p===58)h.type=6,f++,y++;else if(p===44)h.type=7,f++,y++;else if(p===110){if(h.type=8,f++,y++,p=g.charCodeAt(f),p!==117||(f++,y++,p=g.charCodeAt(f),p!==108)||(f++,y++,p=g.charCodeAt(f),p!==108))return!1;f++,y++}else if(p===116){if(h.type=9,f++,y++,p=g.charCodeAt(f),p!==114||(f++,y++,p=g.charCodeAt(f),p!==117)||(f++,y++,p=g.charCodeAt(f),p!==101))return!1;f++,y++}else if(p===102){if(h.type=10,f++,y++,p=g.charCodeAt(f),p!==97||(f++,y++,p=g.charCodeAt(f),p!==108)||(f++,y++,p=g.charCodeAt(f),p!==115)||(f++,y++,p=g.charCodeAt(f),p!==101))return!1;f++,y++}else for(h.type=11;;){if(f>=v)return!1;if(p=g.charCodeAt(f),!(p===46||p>=48&&p<=57||p===101||p===69||p===45||p===43))break;f++,y++}return h.len=f-h.offset,h.value===null&&(h.value=g.substr(h.offset,h.len)),u.pos=f,u.line=m,u.char=y,!0}},787:function(o,s,a){var l=this&&this.__createBinding||(Object.create?function(f,v,m,y){y===void 0&&(y=m),Object.defineProperty(f,y,{enumerable:!0,get:function(){return v[m]}})}:function(f,v,m,y){y===void 0&&(y=m),f[y]=v[m]}),c=this&&this.__exportStar||function(f,v){for(var m in f)m==="default"||Object.prototype.hasOwnProperty.call(v,m)||l(v,f,m)};Object.defineProperty(s,"__esModule",{value:!0}),s.parseRawGrammar=s.INITIAL=s.Registry=void 0;const d=a(391),u=a(50),h=a(652),p=a(583),g=a(965);c(a(44),s),s.Registry=class{constructor(f){this._options=f,this._syncRegistry=new h.SyncRegistry(p.Theme.createFromRawTheme(f.theme,f.colorMap),f.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(f,v){this._syncRegistry.setTheme(p.Theme.createFromRawTheme(f,v))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(f,v,m){return this.loadGrammarWithConfiguration(f,v,{embeddedLanguages:m})}loadGrammarWithConfiguration(f,v,m){return this._loadGrammar(f,v,m.embeddedLanguages,m.tokenTypes,new d.BalancedBracketSelectors(m.balancedBracketSelectors||[],m.unbalancedBracketSelectors||[]))}loadGrammar(f){return this._loadGrammar(f,0,null,null,null)}async _loadGrammar(f,v,m,y,x){const T=new g.ScopeDependencyProcessor(this._syncRegistry,f);for(;T.Q.length>0;)await Promise.all(T.Q.map(M=>this._loadSingleGrammar(M.scopeName))),T.processQueue();return this._grammarForScopeName(f,v,m,y,x)}async _loadSingleGrammar(f){return this._ensureGrammarCache.has(f)||this._ensureGrammarCache.set(f,this._doLoadSingleGrammar(f)),this._ensureGrammarCache.get(f)}async _doLoadSingleGrammar(f){const v=await this._options.loadGrammar(f);if(v){const m=typeof this._options.getInjections=="function"?this._options.getInjections(f):void 0;this._syncRegistry.addGrammar(v,m)}}async addGrammar(f,v=[],m=0,y=null){return this._syncRegistry.addGrammar(f,v),await this._grammarForScopeName(f.scopeName,m,y)}_grammarForScopeName(f,v=0,m=null,y=null,x=null){return this._syncRegistry.grammarForScopeName(f,v,m,y,x)}},s.INITIAL=d.StateStack.NULL,s.parseRawGrammar=u.parseRawGrammar},736:(o,s)=>{function a(l){return!!l&&!!l.match(/[\w\.:]+/)}Object.defineProperty(s,"__esModule",{value:!0}),s.createMatchers=void 0,s.createMatchers=function(l,c){const d=[],u=function(f){let v=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,m=v.exec(f);return{next:()=>{if(!m)return null;const y=m[0];return m=v.exec(f),y}}}(l);let h=u.next();for(;h!==null;){let f=0;if(h.length===2&&h.charAt(1)===":"){switch(h.charAt(0)){case"R":f=1;break;case"L":f=-1;break;default:console.log(`Unknown priority ${h} in scope selector`)}h=u.next()}let v=g();if(d.push({matcher:v,priority:f}),h!==",")break;h=u.next()}return d;function p(){if(h==="-"){h=u.next();const f=p();return v=>!!f&&!f(v)}if(h==="("){h=u.next();const f=function(){const v=[];let m=g();for(;m&&(v.push(m),h==="|"||h===",");){do h=u.next();while(h==="|"||h===",");m=g()}return y=>v.some(x=>x(y))}();return h===")"&&(h=u.next()),f}if(a(h)){const f=[];do f.push(h),h=u.next();while(a(h));return v=>c(f,v)}return null}function g(){const f=[];let v=p();for(;v;)f.push(v),v=p();return m=>f.every(y=>y(m))}}},44:(o,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.disposeOnigString=void 0,s.disposeOnigString=function(a){typeof a.dispose=="function"&&a.dispose()}},50:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.parseRawGrammar=void 0;const l=a(69),c=a(350),d=a(974);s.parseRawGrammar=function(u,h=null){return h!==null&&/\.json$/.test(h)?(p=u,g=h,c.DebugFlags.InDebugMode?d.parseJSON(p,g,!0):JSON.parse(p)):function(f,v){return c.DebugFlags.InDebugMode?l.parseWithLocation(f,v,"$vscodeTextmateLocation"):l.parsePLIST(f)}(u,h);var p,g}},69:(o,s)=>{function a(l,c,d){const u=l.length;let h=0,p=1,g=0;function f(le){if(d===null)h+=le;else for(;le>0;)l.charCodeAt(h)===10?(h++,p++,g=0):(h++,g++),le--}function v(le){d===null?h=le:f(le-h)}function m(){for(;h<u;){let le=l.charCodeAt(h);if(le!==32&&le!==9&&le!==13&&le!==10)break;f(1)}}function y(le){return l.substr(h,le.length)===le&&(f(le.length),!0)}function x(le){let He=l.indexOf(le,h);v(He!==-1?He+le.length:u)}function T(le){let He=l.indexOf(le,h);if(He!==-1){let Ne=l.substring(h,He);return v(He+le.length),Ne}{let Ne=l.substr(h);return v(u),Ne}}u>0&&l.charCodeAt(0)===65279&&(h=1);let M=0,k=null,_=[],A=[],$=null;function E(le,He){_.push(M),A.push(k),M=le,k=He}function R(){if(_.length===0)return I("illegal state stack");M=_.pop(),k=A.pop()}function I(le){throw new Error("Near offset "+h+": "+le+" ~~~"+l.substr(h,50)+"~~~")}const N=function(){if($===null)return I("missing <key>");let le={};d!==null&&(le[d]={filename:c,line:p,char:g}),k[$]=le,$=null,E(1,le)},P=function(){if($===null)return I("missing <key>");let le=[];k[$]=le,$=null,E(2,le)},Z=function(){let le={};d!==null&&(le[d]={filename:c,line:p,char:g}),k.push(le),E(1,le)},pe=function(){let le=[];k.push(le),E(2,le)};function Q(){if(M!==1)return I("unexpected </dict>");R()}function Le(){return M===1||M!==2?I("unexpected </array>"):void R()}function ue(le){if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function H(le){if(isNaN(le))return I("cannot parse float");if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function ee(le){if(isNaN(le))return I("cannot parse integer");if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function K(le){if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function U(le){if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function Ee(le){if(M===1){if($===null)return I("missing <key>");k[$]=le,$=null}else M===2?k.push(le):k=le}function xe(){let le=T(">"),He=!1;return le.charCodeAt(le.length-1)===47&&(He=!0,le=le.substring(0,le.length-1)),{name:le.trim(),isClosed:He}}function Pe(le){if(le.isClosed)return"";let He=T("</");return x(">"),He.replace(/&#([0-9]+);/g,function(Ne,Ue){return String.fromCodePoint(parseInt(Ue,10))}).replace(/&#x([0-9a-f]+);/g,function(Ne,Ue){return String.fromCodePoint(parseInt(Ue,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function(Ne){switch(Ne){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return Ne})}for(;h<u&&(m(),!(h>=u));){const le=l.charCodeAt(h);if(f(1),le!==60)return I("expected <");if(h>=u)return I("unexpected end of input");const He=l.charCodeAt(h);if(He===63){f(1),x("?>");continue}if(He===33){if(f(1),y("--")){x("-->");continue}x(">");continue}if(He===47){if(f(1),m(),y("plist")){x(">");continue}if(y("dict")){x(">"),Q();continue}if(y("array")){x(">"),Le();continue}return I("unexpected closed tag")}let Ne=xe();switch(Ne.name){case"dict":M===1?N():M===2?Z():(k={},d!==null&&(k[d]={filename:c,line:p,char:g}),E(1,k)),Ne.isClosed&&Q();continue;case"array":M===1?P():M===2?pe():(k=[],E(2,k)),Ne.isClosed&&Le();continue;case"key":ze=Pe(Ne),M!==1?I("unexpected <key>"):$!==null?I("too many <key>"):$=ze;continue;case"string":ue(Pe(Ne));continue;case"real":H(parseFloat(Pe(Ne)));continue;case"integer":ee(parseInt(Pe(Ne),10));continue;case"date":K(new Date(Pe(Ne)));continue;case"data":U(Pe(Ne));continue;case"true":Pe(Ne),Ee(!0);continue;case"false":Pe(Ne),Ee(!1);continue}if(!/^plist/.test(Ne.name))return I("unexpected opened tag "+Ne.name)}var ze;return k}Object.defineProperty(s,"__esModule",{value:!0}),s.parsePLIST=s.parseWithLocation=void 0,s.parseWithLocation=function(l,c,d){return a(l,c,d)},s.parsePLIST=function(l){return a(l,null,null)}},652:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SyncRegistry=void 0;const l=a(391);s.SyncRegistry=class{constructor(c,d){this._onigLibPromise=d,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=c}dispose(){for(const c of this._grammars.values())c.dispose()}setTheme(c){this._theme=c}getColorMap(){return this._theme.getColorMap()}addGrammar(c,d){this._rawGrammars.set(c.scopeName,c),d&&this._injectionGrammars.set(c.scopeName,d)}lookup(c){return this._rawGrammars.get(c)}injections(c){return this._injectionGrammars.get(c)}getDefaults(){return this._theme.getDefaults()}themeMatch(c){return this._theme.match(c)}async grammarForScopeName(c,d,u,h,p){if(!this._grammars.has(c)){let g=this._rawGrammars.get(c);if(!g)return null;this._grammars.set(c,l.createGrammar(c,g,d,u,h,p,this,await this._onigLibPromise))}return this._grammars.get(c)}}},792:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CompiledRule=s.RegExpSourceList=s.RegExpSource=s.RuleFactory=s.BeginWhileRule=s.BeginEndRule=s.IncludeOnlyRule=s.MatchRule=s.CaptureRule=s.Rule=s.ruleIdToNumber=s.ruleIdFromNumber=s.whileRuleId=s.endRuleId=void 0;const l=a(878),c=a(965),d=/\\(\d+)/,u=/\\(\d+)/g;s.endRuleId=-1,s.whileRuleId=-2,s.ruleIdFromNumber=function(k){return k},s.ruleIdToNumber=function(k){return k};class h{constructor(_,A,$,E){this.$location=_,this.id=A,this._name=$||null,this._nameIsCapturing=l.RegexSource.hasCaptures(this._name),this._contentName=E||null,this._contentNameIsCapturing=l.RegexSource.hasCaptures(this._contentName)}get debugName(){const _=this.$location?`${l.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${_}`}getName(_,A){return this._nameIsCapturing&&this._name!==null&&_!==null&&A!==null?l.RegexSource.replaceCaptures(this._name,_,A):this._name}getContentName(_,A){return this._contentNameIsCapturing&&this._contentName!==null?l.RegexSource.replaceCaptures(this._contentName,_,A):this._contentName}}s.Rule=h;class p extends h{constructor(_,A,$,E,R){super(_,A,$,E),this.retokenizeCapturedWithRuleId=R}dispose(){}collectPatterns(_,A){throw new Error("Not supported!")}compile(_,A){throw new Error("Not supported!")}compileAG(_,A,$,E){throw new Error("Not supported!")}}s.CaptureRule=p;class g extends h{constructor(_,A,$,E,R){super(_,A,$,null),this._match=new x(E,this.id),this.captures=R,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(_,A){A.push(this._match)}compile(_,A){return this._getCachedCompiledPatterns(_).compile(_)}compileAG(_,A,$,E){return this._getCachedCompiledPatterns(_).compileAG(_,$,E)}_getCachedCompiledPatterns(_){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new T,this.collectPatterns(_,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}s.MatchRule=g;class f extends h{constructor(_,A,$,E,R){super(_,A,$,E),this.patterns=R.patterns,this.hasMissingPatterns=R.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(_,A){for(const $ of this.patterns)_.getRule($).collectPatterns(_,A)}compile(_,A){return this._getCachedCompiledPatterns(_).compile(_)}compileAG(_,A,$,E){return this._getCachedCompiledPatterns(_).compileAG(_,$,E)}_getCachedCompiledPatterns(_){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new T,this.collectPatterns(_,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}s.IncludeOnlyRule=f;class v extends h{constructor(_,A,$,E,R,I,N,P,Z,pe){super(_,A,$,E),this._begin=new x(R,this.id),this.beginCaptures=I,this._end=new x(N||"",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=P,this.applyEndPatternLast=Z||!1,this.patterns=pe.patterns,this.hasMissingPatterns=pe.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(_,A){return this._end.resolveBackReferences(_,A)}collectPatterns(_,A){A.push(this._begin)}compile(_,A){return this._getCachedCompiledPatterns(_,A).compile(_)}compileAG(_,A,$,E){return this._getCachedCompiledPatterns(_,A).compileAG(_,$,E)}_getCachedCompiledPatterns(_,A){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new T;for(const $ of this.patterns)_.getRule($).collectPatterns(_,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,A):this._cachedCompiledPatterns.setSource(0,A)),this._cachedCompiledPatterns}}s.BeginEndRule=v;class m extends h{constructor(_,A,$,E,R,I,N,P,Z){super(_,A,$,E),this._begin=new x(R,this.id),this.beginCaptures=I,this.whileCaptures=P,this._while=new x(N,s.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=Z.patterns,this.hasMissingPatterns=Z.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(_,A){return this._while.resolveBackReferences(_,A)}collectPatterns(_,A){A.push(this._begin)}compile(_,A){return this._getCachedCompiledPatterns(_).compile(_)}compileAG(_,A,$,E){return this._getCachedCompiledPatterns(_).compileAG(_,$,E)}_getCachedCompiledPatterns(_){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new T;for(const A of this.patterns)_.getRule(A).collectPatterns(_,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(_,A){return this._getCachedCompiledWhilePatterns(_,A).compile(_)}compileWhileAG(_,A,$,E){return this._getCachedCompiledWhilePatterns(_,A).compileAG(_,$,E)}_getCachedCompiledWhilePatterns(_,A){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new T,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,A||""),this._cachedCompiledWhilePatterns}}s.BeginWhileRule=m;class y{static createCaptureRule(_,A,$,E,R){return _.registerRule(I=>new p(A,I,$,E,R))}static getCompiledRuleId(_,A,$){return _.id||A.registerRule(E=>{if(_.id=E,_.match)return new g(_.$vscodeTextmateLocation,_.id,_.name,_.match,y._compileCaptures(_.captures,A,$));if(_.begin===void 0){_.repository&&($=l.mergeObjects({},$,_.repository));let R=_.patterns;return R===void 0&&_.include&&(R=[{include:_.include}]),new f(_.$vscodeTextmateLocation,_.id,_.name,_.contentName,y._compilePatterns(R,A,$))}return _.while?new m(_.$vscodeTextmateLocation,_.id,_.name,_.contentName,_.begin,y._compileCaptures(_.beginCaptures||_.captures,A,$),_.while,y._compileCaptures(_.whileCaptures||_.captures,A,$),y._compilePatterns(_.patterns,A,$)):new v(_.$vscodeTextmateLocation,_.id,_.name,_.contentName,_.begin,y._compileCaptures(_.beginCaptures||_.captures,A,$),_.end,y._compileCaptures(_.endCaptures||_.captures,A,$),_.applyEndPatternLast,y._compilePatterns(_.patterns,A,$))}),_.id}static _compileCaptures(_,A,$){let E=[];if(_){let R=0;for(const I in _){if(I==="$vscodeTextmateLocation")continue;const N=parseInt(I,10);N>R&&(R=N)}for(let I=0;I<=R;I++)E[I]=null;for(const I in _){if(I==="$vscodeTextmateLocation")continue;const N=parseInt(I,10);let P=0;_[I].patterns&&(P=y.getCompiledRuleId(_[I],A,$)),E[N]=y.createCaptureRule(A,_[I].$vscodeTextmateLocation,_[I].name,_[I].contentName,P)}}return E}static _compilePatterns(_,A,$){let E=[];if(_)for(let R=0,I=_.length;R<I;R++){const N=_[R];let P=-1;if(N.include){const Z=c.parseInclude(N.include);switch(Z.kind){case 0:case 1:P=y.getCompiledRuleId($[N.include],A,$);break;case 2:let pe=$[Z.ruleName];pe&&(P=y.getCompiledRuleId(pe,A,$));break;case 3:case 4:const Q=Z.scopeName,Le=Z.kind===4?Z.ruleName:null,ue=A.getExternalGrammar(Q,$);if(ue)if(Le){let H=ue.repository[Le];H&&(P=y.getCompiledRuleId(H,A,ue.repository))}else P=y.getCompiledRuleId(ue.repository.$self,A,ue.repository)}}else P=y.getCompiledRuleId(N,A,$);if(P!==-1){const Z=A.getRule(P);let pe=!1;if((Z instanceof f||Z instanceof v||Z instanceof m)&&Z.hasMissingPatterns&&Z.patterns.length===0&&(pe=!0),pe)continue;E.push(P)}}return{patterns:E,hasMissingPatterns:(_?_.length:0)!==E.length}}}s.RuleFactory=y;class x{constructor(_,A){if(_){const $=_.length;let E=0,R=[],I=!1;for(let N=0;N<$;N++)if(_.charAt(N)==="\\"&&N+1<$){const P=_.charAt(N+1);P==="z"?(R.push(_.substring(E,N)),R.push("$(?!\\n)(?<!\\n)"),E=N+2):P!=="A"&&P!=="G"||(I=!0),N++}this.hasAnchor=I,E===0?this.source=_:(R.push(_.substring(E,$)),this.source=R.join(""))}else this.hasAnchor=!1,this.source=_;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=A,this.hasBackReferences=d.test(this.source)}clone(){return new x(this.source,this.ruleId)}setSource(_){this.source!==_&&(this.source=_,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(_,A){let $=A.map(E=>_.substring(E.start,E.end));return u.lastIndex=0,this.source.replace(u,(E,R)=>l.escapeRegExpCharacters($[parseInt(R,10)]||""))}_buildAnchorCache(){let _,A,$,E,R=[],I=[],N=[],P=[];for(_=0,A=this.source.length;_<A;_++)$=this.source.charAt(_),R[_]=$,I[_]=$,N[_]=$,P[_]=$,$==="\\"&&_+1<A&&(E=this.source.charAt(_+1),E==="A"?(R[_+1]="",I[_+1]="",N[_+1]="A",P[_+1]="A"):E==="G"?(R[_+1]="",I[_+1]="G",N[_+1]="",P[_+1]="G"):(R[_+1]=E,I[_+1]=E,N[_+1]=E,P[_+1]=E),_++);return{A0_G0:R.join(""),A0_G1:I.join(""),A1_G0:N.join(""),A1_G1:P.join("")}}resolveAnchors(_,A){return this.hasAnchor&&this._anchorCache?_?A?this._anchorCache.A1_G1:this._anchorCache.A1_G0:A?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}s.RegExpSource=x;class T{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(_){this._items.push(_),this._hasAnchors=this._hasAnchors||_.hasAnchor}unshift(_){this._items.unshift(_),this._hasAnchors=this._hasAnchors||_.hasAnchor}length(){return this._items.length}setSource(_,A){this._items[_].source!==A&&(this._disposeCaches(),this._items[_].setSource(A))}compile(_){if(!this._cached){let A=this._items.map($=>$.source);this._cached=new M(_,A,this._items.map($=>$.ruleId))}return this._cached}compileAG(_,A,$){return this._hasAnchors?A?$?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(_,A,$)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(_,A,$)),this._anchorCache.A1_G0):$?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(_,A,$)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(_,A,$)),this._anchorCache.A0_G0):this.compile(_)}_resolveAnchors(_,A,$){let E=this._items.map(R=>R.resolveAnchors(A,$));return new M(_,E,this._items.map(R=>R.ruleId))}}s.RegExpSourceList=T;class M{constructor(_,A,$){this.regExps=A,this.rules=$,this.scanner=_.createOnigScanner(A)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const _=[];for(let A=0,$=this.rules.length;A<$;A++)_.push("   - "+this.rules[A]+": "+this.regExps[A]);return _.join(`
`)}findNextMatchSync(_,A,$){const E=this.scanner.findNextMatchSync(_,A,$);return E?{ruleId:this.rules[E.index],captureIndices:E.captureIndices}:null}}s.CompiledRule=M},583:(o,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeTrieElement=s.ThemeTrieElementRule=s.ColorMap=s.fontStyleToString=s.ParsedThemeRule=s.parseTheme=s.StyleAttributes=s.ScopeStack=s.Theme=void 0;const l=a(878);class c{constructor(x,T,M){this._colorMap=x,this._defaults=T,this._root=M,this._cachedMatchRoot=new l.CachedFn(k=>this._root.match(k))}static createFromRawTheme(x,T){return this.createFromParsedTheme(p(x),T)}static createFromParsedTheme(x,T){return function(M,k){M.sort((N,P)=>{let Z=l.strcmp(N.scope,P.scope);return Z!==0?Z:(Z=l.strArrCmp(N.parentScopes,P.parentScopes),Z!==0?Z:N.index-P.index)});let _=0,A="#000000",$="#ffffff";for(;M.length>=1&&M[0].scope==="";){let N=M.shift();N.fontStyle!==-1&&(_=N.fontStyle),N.foreground!==null&&(A=N.foreground),N.background!==null&&($=N.background)}let E=new f(k),R=new h(_,E.getId(A),E.getId($)),I=new m(new v(0,null,-1,0,0),[]);for(let N=0,P=M.length;N<P;N++){let Z=M[N];I.insert(0,Z.scope,Z.parentScopes,Z.fontStyle,E.getId(Z.foreground),E.getId(Z.background))}return new c(E,R,I)}(x,T)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(x){if(x===null)return this._defaults;const T=x.scopeName,M=this._cachedMatchRoot.get(T).find(k=>function(_,A){if(A===null)return!0;let $=0,E=A[$];for(;_;){if(u(_.scopeName,E)){if($++,$===A.length)return!0;E=A[$]}_=_.parent}return!1}(x.parent,k.parentScopes));return M?new h(M.fontStyle,M.foreground,M.background):null}}s.Theme=c;class d{constructor(x,T){this.parent=x,this.scopeName=T}static from(...x){let T=null;for(let M=0;M<x.length;M++)T=new d(T,x[M]);return T}push(x){return new d(this,x)}getSegments(){let x=this;const T=[];for(;x;)T.push(x.scopeName),x=x.parent;return T.reverse(),T}toString(){return this.getSegments().join(" ")}}function u(y,x){return x===y||y.startsWith(x)&&y[x.length]==="."}s.ScopeStack=d;class h{constructor(x,T,M){this.fontStyle=x,this.foregroundId=T,this.backgroundId=M}}function p(y){if(!y)return[];if(!y.settings||!Array.isArray(y.settings))return[];let x=y.settings,T=[],M=0;for(let k=0,_=x.length;k<_;k++){let A,$=x[k];if(!$.settings)continue;if(typeof $.scope=="string"){let N=$.scope;N=N.replace(/^[,]+/,""),N=N.replace(/[,]+$/,""),A=N.split(",")}else A=Array.isArray($.scope)?$.scope:[""];let E=-1;if(typeof $.settings.fontStyle=="string"){E=0;let N=$.settings.fontStyle.split(" ");for(let P=0,Z=N.length;P<Z;P++)switch(N[P]){case"italic":E|=1;break;case"bold":E|=2;break;case"underline":E|=4;break;case"strikethrough":E|=8}}let R=null;typeof $.settings.foreground=="string"&&l.isValidHexColor($.settings.foreground)&&(R=$.settings.foreground);let I=null;typeof $.settings.background=="string"&&l.isValidHexColor($.settings.background)&&(I=$.settings.background);for(let N=0,P=A.length;N<P;N++){let Z=A[N].trim().split(" "),pe=Z[Z.length-1],Q=null;Z.length>1&&(Q=Z.slice(0,Z.length-1),Q.reverse()),T[M++]=new g(pe,Q,k,E,R,I)}}return T}s.StyleAttributes=h,s.parseTheme=p;class g{constructor(x,T,M,k,_,A){this.scope=x,this.parentScopes=T,this.index=M,this.fontStyle=k,this.foreground=_,this.background=A}}s.ParsedThemeRule=g,s.fontStyleToString=function(y){if(y===-1)return"not set";let x="";return 1&y&&(x+="italic "),2&y&&(x+="bold "),4&y&&(x+="underline "),8&y&&(x+="strikethrough "),x===""&&(x="none"),x.trim()};class f{constructor(x){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(x)){this._isFrozen=!0;for(let T=0,M=x.length;T<M;T++)this._color2id[x[T]]=T,this._id2color[T]=x[T]}else this._isFrozen=!1}getId(x){if(x===null)return 0;x=x.toUpperCase();let T=this._color2id[x];if(T)return T;if(this._isFrozen)throw new Error(`Missing color in color map - ${x}`);return T=++this._lastColorId,this._color2id[x]=T,this._id2color[T]=x,T}getColorMap(){return this._id2color.slice(0)}}s.ColorMap=f;class v{constructor(x,T,M,k,_){this.scopeDepth=x,this.parentScopes=T,this.fontStyle=M,this.foreground=k,this.background=_}clone(){return new v(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(x){let T=[];for(let M=0,k=x.length;M<k;M++)T[M]=x[M].clone();return T}acceptOverwrite(x,T,M,k){this.scopeDepth>x?console.log("how did this happen?"):this.scopeDepth=x,T!==-1&&(this.fontStyle=T),M!==0&&(this.foreground=M),k!==0&&(this.background=k)}}s.ThemeTrieElementRule=v;class m{constructor(x,T=[],M={}){this._mainRule=x,this._children=M,this._rulesWithParentScopes=T}static _sortBySpecificity(x){return x.length===1||x.sort(this._cmpBySpecificity),x}static _cmpBySpecificity(x,T){if(x.scopeDepth===T.scopeDepth){const M=x.parentScopes,k=T.parentScopes;let _=M===null?0:M.length,A=k===null?0:k.length;if(_===A)for(let $=0;$<_;$++){const E=M[$].length,R=k[$].length;if(E!==R)return R-E}return A-_}return T.scopeDepth-x.scopeDepth}match(x){if(x==="")return m._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let T,M,k=x.indexOf(".");return k===-1?(T=x,M=""):(T=x.substring(0,k),M=x.substring(k+1)),this._children.hasOwnProperty(T)?this._children[T].match(M):m._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(x,T,M,k,_,A){if(T==="")return void this._doInsertHere(x,M,k,_,A);let $,E,R,I=T.indexOf(".");I===-1?($=T,E=""):($=T.substring(0,I),E=T.substring(I+1)),this._children.hasOwnProperty($)?R=this._children[$]:(R=new m(this._mainRule.clone(),v.cloneArr(this._rulesWithParentScopes)),this._children[$]=R),R.insert(x+1,E,M,k,_,A)}_doInsertHere(x,T,M,k,_){if(T!==null){for(let A=0,$=this._rulesWithParentScopes.length;A<$;A++){let E=this._rulesWithParentScopes[A];if(l.strArrCmp(E.parentScopes,T)===0)return void E.acceptOverwrite(x,M,k,_)}M===-1&&(M=this._mainRule.fontStyle),k===0&&(k=this._mainRule.foreground),_===0&&(_=this._mainRule.background),this._rulesWithParentScopes.push(new v(x,T,M,k,_))}else this._mainRule.acceptOverwrite(x,M,k,_)}}s.ThemeTrieElement=m},878:(o,s)=>{function a(d){return Array.isArray(d)?function(u){let h=[];for(let p=0,g=u.length;p<g;p++)h[p]=a(u[p]);return h}(d):typeof d=="object"?function(u){let h={};for(let p in u)h[p]=a(u[p]);return h}(d):d}Object.defineProperty(s,"__esModule",{value:!0}),s.performanceNow=s.CachedFn=s.escapeRegExpCharacters=s.isValidHexColor=s.strArrCmp=s.strcmp=s.RegexSource=s.basename=s.mergeObjects=s.clone=void 0,s.clone=function(d){return a(d)},s.mergeObjects=function(d,...u){return u.forEach(h=>{for(let p in h)d[p]=h[p]}),d},s.basename=function d(u){const h=~u.lastIndexOf("/")||~u.lastIndexOf("\\");return h===0?u:~h==u.length-1?d(u.substring(0,u.length-1)):u.substr(1+~h)};let l=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function c(d,u){return d<u?-1:d>u?1:0}s.RegexSource=class{static hasCaptures(d){return d!==null&&(l.lastIndex=0,l.test(d))}static replaceCaptures(d,u,h){return d.replace(l,(p,g,f,v)=>{let m=h[parseInt(g||f,10)];if(!m)return p;{let y=u.substring(m.start,m.end);for(;y[0]===".";)y=y.substring(1);switch(v){case"downcase":return y.toLowerCase();case"upcase":return y.toUpperCase();default:return y}}})}},s.strcmp=c,s.strArrCmp=function(d,u){if(d===null&&u===null)return 0;if(!d)return-1;if(!u)return 1;let h=d.length,p=u.length;if(h===p){for(let g=0;g<h;g++){let f=c(d[g],u[g]);if(f!==0)return f}return 0}return h-p},s.isValidHexColor=function(d){return!!(/^#[0-9a-f]{6}$/i.test(d)||/^#[0-9a-f]{8}$/i.test(d)||/^#[0-9a-f]{3}$/i.test(d)||/^#[0-9a-f]{4}$/i.test(d))},s.escapeRegExpCharacters=function(d){return d.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},s.CachedFn=class{constructor(d){this.fn=d,this.cache=new Map}get(d){if(this.cache.has(d))return this.cache.get(d);const u=this.fn(d);return this.cache.set(d,u),u}},s.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},r={};return function o(s){var a=r[s];if(a!==void 0)return a.exports;var l=r[s]={exports:{}};return i[s].call(l.exports,l,l.exports,o),l.exports}(787)})()})})(qE);var YE=qE.exports;const Wl=[{id:"abap",scopeName:"source.abap",path:"abap.tmLanguage.json",displayName:"ABAP",samplePath:"abap.sample"},{id:"actionscript-3",scopeName:"source.actionscript.3",path:"actionscript-3.tmLanguage.json",displayName:"ActionScript",samplePath:"actionscript-3.sample"},{id:"ada",scopeName:"source.ada",path:"ada.tmLanguage.json",displayName:"Ada",samplePath:"ada.sample"},{id:"apache",scopeName:"source.apacheconf",path:"apache.tmLanguage.json",displayName:"Apache Conf",samplePath:"apache.sample"},{id:"apex",scopeName:"source.apex",path:"apex.tmLanguage.json",displayName:"Apex",samplePath:"apex.sample"},{id:"apl",scopeName:"source.apl",path:"apl.tmLanguage.json",displayName:"APL",samplePath:"apl.sample",embeddedLangs:["html","xml","css","javascript","json"]},{id:"applescript",scopeName:"source.applescript",path:"applescript.tmLanguage.json",displayName:"AppleScript",samplePath:"applescript.sample"},{id:"ara",scopeName:"source.ara",path:"ara.tmLanguage.json",displayName:"Ara",samplePath:"ara.sample"},{id:"asm",scopeName:"source.asm.x86_64",path:"asm.tmLanguage.json",displayName:"Assembly",samplePath:"asm.sample"},{id:"astro",scopeName:"source.astro",path:"astro.tmLanguage.json",displayName:"Astro",samplePath:"astro.sample",embeddedLangs:["json","javascript","typescript","stylus","sass","css","scss","less","postcss","tsx"]},{id:"awk",scopeName:"source.awk",path:"awk.tmLanguage.json",displayName:"AWK",samplePath:"awk.sample"},{id:"ballerina",scopeName:"source.ballerina",path:"ballerina.tmLanguage.json",displayName:"Ballerina",samplePath:"ballerina.sample"},{id:"bat",scopeName:"source.batchfile",path:"bat.tmLanguage.json",displayName:"Batch",samplePath:"bat.sample",aliases:["batch"]},{id:"beancount",scopeName:"text.beancount",path:"beancount.tmLanguage.json",displayName:"Beancount",samplePath:"beancount.sample"},{id:"berry",scopeName:"source.berry",path:"berry.tmLanguage.json",displayName:"Berry",samplePath:"berry.sample",aliases:["be"]},{id:"bibtex",scopeName:"text.bibtex",path:"bibtex.tmLanguage.json",displayName:"BibTeX",samplePath:"bibtex.sample"},{id:"bicep",scopeName:"source.bicep",path:"bicep.tmLanguage.json",displayName:"Bicep",samplePath:"bicep.sample"},{id:"blade",scopeName:"text.html.php.blade",path:"blade.tmLanguage.json",displayName:"Blade",samplePath:"blade.sample",embeddedLangs:["html","xml","sql","javascript","json","css"]},{id:"c",scopeName:"source.c",path:"c.tmLanguage.json",displayName:"C",samplePath:"c.sample"},{id:"cadence",scopeName:"source.cadence",path:"cadence.tmLanguage.json",displayName:"Cadence",samplePath:"cadence.sample",aliases:["cdc"]},{id:"clarity",scopeName:"source.clar",path:"clarity.tmLanguage.json",displayName:"Clarity",samplePath:"clarity.sample"},{id:"clojure",scopeName:"source.clojure",path:"clojure.tmLanguage.json",displayName:"Clojure",samplePath:"clojure.sample",aliases:["clj"]},{id:"cmake",scopeName:"source.cmake",path:"cmake.tmLanguage.json",displayName:"CMake",samplePath:"cmake.sample"},{id:"cobol",scopeName:"source.cobol",path:"cobol.tmLanguage.json",displayName:"COBOL",samplePath:"cobol.sample",embeddedLangs:["sql","html","java"]},{id:"codeql",scopeName:"source.ql",path:"codeql.tmLanguage.json",displayName:"CodeQL",samplePath:"codeql.sample",aliases:["ql"]},{id:"coffee",scopeName:"source.coffee",path:"coffee.tmLanguage.json",displayName:"CoffeeScript",samplePath:"coffee.sample",embeddedLangs:["javascript"]},{id:"cpp",scopeName:"source.cpp",path:"cpp.tmLanguage.json",displayName:"C++",samplePath:"cpp.sample",aliases:["c++"],embeddedLangs:["glsl","sql"]},{id:"crystal",scopeName:"source.crystal",path:"crystal.tmLanguage.json",displayName:"Crystal",samplePath:"crystal.sample",embeddedLangs:["html","sql","css","c","javascript","shellscript"]},{id:"csharp",scopeName:"source.cs",path:"csharp.tmLanguage.json",displayName:"C#",samplePath:"csharp.sample",aliases:["c#","cs"]},{id:"css",scopeName:"source.css",path:"css.tmLanguage.json",displayName:"CSS",samplePath:"css.sample"},{id:"csv",scopeName:"text.csv",path:"csv.tmLanguage.json",displayName:"csv syntax",samplePath:"csv.sample"},{id:"cue",scopeName:"source.cue",path:"cue.tmLanguage.json",displayName:"CUE",samplePath:"cue.sample"},{id:"cypher",scopeName:"source.cypher",path:"cypher.tmLanguage.json",displayName:"Cypher",samplePath:"cypher.sample",aliases:["cql"]},{id:"d",scopeName:"source.d",path:"d.tmLanguage.json",displayName:"D",samplePath:"d.sample"},{id:"dart",scopeName:"source.dart",path:"dart.tmLanguage.json",displayName:"Dart",samplePath:"dart.sample"},{id:"dax",scopeName:"source.dax",path:"dax.tmLanguage.json",displayName:"DAX",samplePath:"dax.sample"},{id:"diff",scopeName:"source.diff",path:"diff.tmLanguage.json",displayName:"Diff",samplePath:"diff.sample"},{id:"docker",scopeName:"source.dockerfile",path:"docker.tmLanguage.json",displayName:"Docker",samplePath:"docker.sample",aliases:["dockerfile"]},{id:"dream-maker",scopeName:"source.dm",path:"dream-maker.tmLanguage.json",displayName:"Dream Maker",samplePath:"dream-maker.sample"},{id:"elixir",scopeName:"source.elixir",path:"elixir.tmLanguage.json",displayName:"Elixir",samplePath:"elixir.sample",embeddedLangs:["html"]},{id:"elm",scopeName:"source.elm",path:"elm.tmLanguage.json",displayName:"Elm",samplePath:"elm.sample",embeddedLangs:["glsl"]},{id:"erb",scopeName:"text.html.erb",path:"erb.tmLanguage.json",displayName:"ERB",samplePath:"erb.sample",embeddedLangs:["html","ruby"]},{id:"erlang",scopeName:"source.erlang",path:"erlang.tmLanguage.json",displayName:"Erlang",samplePath:"erlang.sample",aliases:["erl"]},{id:"fish",scopeName:"source.fish",path:"fish.tmLanguage.json",displayName:"Fish",samplePath:"fish.sample"},{id:"fsharp",scopeName:"source.fsharp",path:"fsharp.tmLanguage.json",displayName:"F#",samplePath:"fsharp.sample",aliases:["f#","fs"],embeddedLangs:["markdown"]},{id:"gdresource",scopeName:"source.gdresource",path:"gdresource.tmLanguage.json",displayName:"GDResource",samplePath:"gdresource.sample",embeddedLangs:["gdshader","gdscript"]},{id:"gdscript",scopeName:"source.gdscript",path:"gdscript.tmLanguage.json",displayName:"GDScript",samplePath:"gdscript.sample"},{id:"gdshader",scopeName:"source.gdshader",path:"gdshader.tmLanguage.json",displayName:"GDShader",samplePath:"gdshader.sample"},{id:"gherkin",scopeName:"text.gherkin.feature",path:"gherkin.tmLanguage.json",displayName:"Gherkin",samplePath:"gherkin.sample"},{id:"git-commit",scopeName:"text.git-commit",path:"git-commit.tmLanguage.json",displayName:"Git Commit Message",embeddedLangs:["diff"]},{id:"git-rebase",scopeName:"text.git-rebase",path:"git-rebase.tmLanguage.json",displayName:"Git Rebase Message",embeddedLangs:["shellscript"]},{id:"glimmer-js",scopeName:"source.gjs",path:"glimmer-js.tmLanguage.json",displayName:"Glimmer JS",aliases:["gjs"],embeddedLangs:["javascript","handlebars"]},{id:"glimmer-ts",scopeName:"source.gts",path:"glimmer-ts.tmLanguage.json",displayName:"Glimmer TS",aliases:["gts"],embeddedLangs:["typescript","handlebars"]},{id:"glsl",scopeName:"source.glsl",path:"glsl.tmLanguage.json",displayName:"GLSL",samplePath:"glsl.sample",embeddedLangs:["c"]},{id:"gnuplot",scopeName:"source.gnuplot",path:"gnuplot.tmLanguage.json",displayName:"Gnuplot",samplePath:"gnuplot.sample"},{id:"go",scopeName:"source.go",path:"go.tmLanguage.json",displayName:"Go",samplePath:"go.sample"},{id:"graphql",scopeName:"source.graphql",path:"graphql.tmLanguage.json",displayName:"GraphQL",samplePath:"graphql.sample",aliases:["gql"],embeddedLangs:["javascript","typescript","jsx","tsx"]},{id:"groovy",scopeName:"source.groovy",path:"groovy.tmLanguage.json",displayName:"Groovy",samplePath:"groovy.sample"},{id:"hack",scopeName:"source.hack",path:"hack.tmLanguage.json",displayName:"Hack",samplePath:"hack.sample",embeddedLangs:["html","sql"]},{id:"haml",scopeName:"text.haml",path:"haml.tmLanguage.json",displayName:"Ruby Haml",samplePath:"haml.sample",embeddedLangs:["ruby","javascript","sass","coffee","markdown","css"]},{id:"handlebars",scopeName:"text.html.handlebars",path:"handlebars.tmLanguage.json",displayName:"Handlebars",samplePath:"handlebars.sample",aliases:["hbs"],embeddedLangs:["html","css","javascript","yaml"]},{id:"haskell",scopeName:"source.haskell",path:"haskell.tmLanguage.json",displayName:"Haskell",samplePath:"haskell.sample",aliases:["hs"]},{id:"hcl",scopeName:"source.hcl",path:"hcl.tmLanguage.json",displayName:"HashiCorp HCL",samplePath:"hcl.sample"},{id:"hjson",scopeName:"source.hjson",path:"hjson.tmLanguage.json",displayName:"Hjson",samplePath:"hjson.sample"},{id:"hlsl",scopeName:"source.hlsl",path:"hlsl.tmLanguage.json",displayName:"HLSL",samplePath:"hlsl.sample"},{id:"html",scopeName:"text.html.basic",path:"html.tmLanguage.json",displayName:"HTML",samplePath:"html.sample",embeddedLangs:["javascript","css"]},{id:"http",scopeName:"source.http",path:"http.tmLanguage.json",displayName:"HTTP",samplePath:"http.sample",embeddedLangs:["shellscript","json","xml","graphql"]},{id:"imba",scopeName:"source.imba",path:"imba.tmLanguage.json",displayName:"Imba",samplePath:"imba.sample"},{id:"ini",scopeName:"source.ini",path:"ini.tmLanguage.json",displayName:"INI",samplePath:"ini.sample",aliases:["properties"]},{id:"java",scopeName:"source.java",path:"java.tmLanguage.json",displayName:"Java",samplePath:"java.sample"},{id:"javascript",scopeName:"source.js",path:"javascript.tmLanguage.json",displayName:"JavaScript",samplePath:"javascript.sample",aliases:["js"]},{id:"jinja-html",scopeName:"text.html.jinja",path:"jinja-html.tmLanguage.json",displayName:"Jinja",samplePath:"jinja-html.sample",embeddedLangs:["html"]},{id:"jison",scopeName:"source.jison",path:"jison.tmLanguage.json",displayName:"Jison",samplePath:"jison.sample",embeddedLangs:["javascript"]},{id:"json",scopeName:"source.json",path:"json.tmLanguage.json",displayName:"JSON",samplePath:"json.sample"},{id:"json5",scopeName:"source.json5",path:"json5.tmLanguage.json",displayName:"JSON5",samplePath:"json5.sample"},{id:"jsonc",scopeName:"source.json.comments",path:"jsonc.tmLanguage.json",displayName:"JSON with Comments",samplePath:"jsonc.sample"},{id:"jsonl",scopeName:"source.json.lines",path:"jsonl.tmLanguage.json",displayName:"JSON Lines",samplePath:"jsonl.sample"},{id:"jsonnet",scopeName:"source.jsonnet",path:"jsonnet.tmLanguage.json",displayName:"Jsonnet",samplePath:"jsonnet.sample"},{id:"jssm",scopeName:"source.jssm",path:"jssm.tmLanguage.json",displayName:"JSSM",samplePath:"jssm.sample",aliases:["fsl"]},{id:"jsx",scopeName:"source.js.jsx",path:"jsx.tmLanguage.json",displayName:"JSX",samplePath:"jsx.sample"},{id:"julia",scopeName:"source.julia",path:"julia.tmLanguage.json",displayName:"Julia",samplePath:"julia.sample",embeddedLangs:["cpp","python","javascript","r","sql"]},{id:"kotlin",scopeName:"source.kotlin",path:"kotlin.tmLanguage.json",displayName:"Kotlin",samplePath:"kotlin.sample",aliases:["kt","kts"]},{id:"kusto",scopeName:"source.kusto",path:"kusto.tmLanguage.json",displayName:"Kusto",samplePath:"kusto.sample",aliases:["kql"]},{id:"latex",scopeName:"text.tex.latex",path:"latex.tmLanguage.json",displayName:"LaTeX",samplePath:"latex.sample",embeddedLangs:["tex","css","haskell","html","xml","java","lua","julia","ruby","javascript","typescript","python","yaml","rust","scala","gnuplot"]},{id:"less",scopeName:"source.css.less",path:"less.tmLanguage.json",displayName:"Less",samplePath:"less.sample"},{id:"liquid",scopeName:"text.html.liquid",path:"liquid.tmLanguage.json",displayName:"Liquid",samplePath:"liquid.sample",embeddedLangs:["html","css","json","javascript"]},{id:"lisp",scopeName:"source.lisp",path:"lisp.tmLanguage.json",displayName:"Lisp",samplePath:"lisp.sample"},{id:"logo",scopeName:"source.logo",path:"logo.tmLanguage.json",displayName:"Logo",samplePath:"logo.sample"},{id:"lua",scopeName:"source.lua",path:"lua.tmLanguage.json",displayName:"Lua",samplePath:"lua.sample",embeddedLangs:["c"]},{id:"make",scopeName:"source.makefile",path:"make.tmLanguage.json",displayName:"Makefile",samplePath:"make.sample",aliases:["makefile"]},{id:"markdown",scopeName:"text.html.markdown",path:"markdown.tmLanguage.json",displayName:"Markdown",samplePath:"markdown.sample",aliases:["md"],embeddedLangs:["css","html","ini","java","lua","make","perl","r","ruby","php","sql","vb","xml","xsl","yaml","bat","clojure","coffee","c","cpp","diff","docker","git-commit","git-rebase","go","groovy","pug","javascript","json","jsonc","less","objective-c","swift","scss","raku","powershell","python","julia","rust","scala","shellscript","typescript","tsx","csharp","fsharp","dart","handlebars","erlang","elixir","latex","bibtex"]},{id:"marko",scopeName:"text.marko",path:"marko.tmLanguage.json",displayName:"Marko",samplePath:"marko.sample",embeddedLangs:["css","less","scss","javascript"]},{id:"matlab",scopeName:"source.matlab",path:"matlab.tmLanguage.json",displayName:"MATLAB",samplePath:"matlab.sample"},{id:"mdc",scopeName:"text.markdown.mdc",path:"mdc.tmLanguage.json",displayName:"mdc",samplePath:"mdc.sample",embeddedLangs:["markdown","yaml"]},{id:"mdx",scopeName:"source.mdx",path:"mdx.tmLanguage.json",displayName:"MDX",samplePath:"mdx.sample",embeddedLangs:["tsx","toml","yaml","c","clojure","coffee","cpp","csharp","css","diff","docker","elixir","elm","erlang","go","graphql","haskell","html","ini","java","javascript","json","julia","kotlin","less","lua","make","markdown","objective-c","perl","python","r","ruby","rust","scala","scss","shellscript","shellsession","sql","xml","swift","typescript"]},{id:"mermaid",scopeName:"source.mermaid",path:"mermaid.tmLanguage.json",displayName:"Mermaid",samplePath:"mermaid.sample"},{id:"mojo",scopeName:"source.mojo",path:"mojo.tmLanguage.json",displayName:"MagicPython",samplePath:"mojo.sample"},{id:"narrat",scopeName:"source.narrat",path:"narrat.tmLanguage.json",displayName:"Narrat Language",samplePath:"narrat.sample",aliases:["nar"]},{id:"nextflow",scopeName:"source.nextflow",path:"nextflow.tmLanguage.json",displayName:"Nextflow",samplePath:"nextflow.sample",aliases:["nf"]},{id:"nginx",scopeName:"source.nginx",path:"nginx.tmLanguage.json",displayName:"Nginx",samplePath:"nginx.sample",embeddedLangs:["lua"]},{id:"nim",scopeName:"source.nim",path:"nim.tmLanguage.json",displayName:"Nim",samplePath:"nim.sample",embeddedLangs:["c","html","xml","javascript","css","glsl","markdown"]},{id:"nix",scopeName:"source.nix",path:"nix.tmLanguage.json",displayName:"Nix",samplePath:"nix.sample"},{id:"nushell",scopeName:"source.nushell",path:"nushell.tmLanguage.json",displayName:"nushell",samplePath:"nushell.sample",aliases:["nu"]},{id:"objective-c",scopeName:"source.objc",path:"objective-c.tmLanguage.json",displayName:"Objective-C",samplePath:"objective-c.sample",aliases:["objc"]},{id:"objective-cpp",scopeName:"source.objcpp",path:"objective-cpp.tmLanguage.json",displayName:"Objective-C++",samplePath:"objective-cpp.sample"},{id:"ocaml",scopeName:"source.ocaml",path:"ocaml.tmLanguage.json",displayName:"OCaml",samplePath:"ocaml.sample"},{id:"pascal",scopeName:"source.pascal",path:"pascal.tmLanguage.json",displayName:"Pascal",samplePath:"pascal.sample"},{id:"perl",scopeName:"source.perl",path:"perl.tmLanguage.json",displayName:"Perl",samplePath:"perl.sample",embeddedLangs:["html","xml","css","javascript","sql"]},{id:"php",scopeName:"source.php",path:"php.tmLanguage.json",displayName:"PHP",samplePath:"php.sample",embeddedLangs:["html","xml","sql","javascript","json","css"]},{id:"plsql",scopeName:"source.plsql.oracle",path:"plsql.tmLanguage.json",displayName:"PL/SQL",samplePath:"plsql.sample"},{id:"postcss",scopeName:"source.css.postcss",path:"postcss.tmLanguage.json",displayName:"PostCSS",samplePath:"postcss.sample"},{id:"powerquery",scopeName:"source.powerquery",path:"powerquery.tmLanguage.json",displayName:"PowerQuery",samplePath:"powerquery.sample"},{id:"powershell",scopeName:"source.powershell",path:"powershell.tmLanguage.json",displayName:"PowerShell",samplePath:"powershell.sample",aliases:["ps","ps1"]},{id:"prisma",scopeName:"source.prisma",path:"prisma.tmLanguage.json",displayName:"Prisma",samplePath:"prisma.sample"},{id:"prolog",scopeName:"source.prolog",path:"prolog.tmLanguage.json",displayName:"Prolog",samplePath:"prolog.sample"},{id:"proto",scopeName:"source.proto",path:"proto.tmLanguage.json",displayName:"Protocol Buffer 3",samplePath:"proto.sample"},{id:"pug",scopeName:"text.pug",path:"pug.tmLanguage.json",displayName:"Pug",samplePath:"pug.sample",aliases:["jade"],embeddedLangs:["javascript","css","sass","scss","stylus","coffee","html"]},{id:"puppet",scopeName:"source.puppet",path:"puppet.tmLanguage.json",displayName:"Puppet",samplePath:"puppet.sample"},{id:"purescript",scopeName:"source.purescript",path:"purescript.tmLanguage.json",displayName:"PureScript",samplePath:"purescript.sample"},{id:"python",scopeName:"source.python",path:"python.tmLanguage.json",displayName:"Python",samplePath:"python.sample",aliases:["py"]},{id:"r",scopeName:"source.r",path:"r.tmLanguage.json",displayName:"R",samplePath:"r.sample"},{id:"raku",scopeName:"source.perl.6",path:"raku.tmLanguage.json",displayName:"Raku",samplePath:"raku.sample",aliases:["perl6"]},{id:"razor",scopeName:"text.aspnetcorerazor",path:"razor.tmLanguage.json",displayName:"ASP.NET Razor",samplePath:"razor.sample",embeddedLangs:["html","csharp"]},{id:"reg",scopeName:"source.reg",path:"reg.tmLanguage.json",displayName:"Windows Registry Script",samplePath:"reg.sample"},{id:"rel",scopeName:"source.rel",path:"rel.tmLanguage.json",displayName:"Rel",samplePath:"rel.sample"},{id:"riscv",scopeName:"source.riscv",path:"riscv.tmLanguage.json",displayName:"RISC-V",samplePath:"riscv.sample"},{id:"rst",scopeName:"source.rst",path:"rst.tmLanguage.json",displayName:"reStructuredText",samplePath:"rst.sample",embeddedLangs:["cpp","python","javascript","shellscript","yaml","cmake","ruby"]},{id:"ruby",scopeName:"source.ruby",path:"ruby.tmLanguage.json",displayName:"Ruby",samplePath:"ruby.sample",aliases:["rb"],embeddedLangs:["html","xml","sql","css","c","javascript","shellscript","lua"]},{id:"rust",scopeName:"source.rust",path:"rust.tmLanguage.json",displayName:"Rust",samplePath:"rust.sample",aliases:["rs"]},{id:"sas",scopeName:"source.sas",path:"sas.tmLanguage.json",displayName:"SAS",samplePath:"sas.sample",embeddedLangs:["sql"]},{id:"sass",scopeName:"source.sass",path:"sass.tmLanguage.json",displayName:"Sass",samplePath:"sass.sample"},{id:"scala",scopeName:"source.scala",path:"scala.tmLanguage.json",displayName:"Scala",samplePath:"scala.sample"},{id:"scheme",scopeName:"source.scheme",path:"scheme.tmLanguage.json",displayName:"Scheme",samplePath:"scheme.sample"},{id:"scss",scopeName:"source.css.scss",path:"scss.tmLanguage.json",displayName:"SCSS",samplePath:"scss.sample",embeddedLangs:["css"]},{id:"shaderlab",scopeName:"source.shaderlab",path:"shaderlab.tmLanguage.json",displayName:"ShaderLab",samplePath:"shaderlab.sample",aliases:["shader"],embeddedLangs:["hlsl"]},{id:"shellscript",scopeName:"source.shell",path:"shellscript.tmLanguage.json",displayName:"Shell",samplePath:"shellscript.sample",aliases:["bash","sh","shell","zsh"]},{id:"shellsession",scopeName:"text.shell-session",path:"shellsession.tmLanguage.json",displayName:"Shell Session",samplePath:"shellsession.sample",aliases:["console"],embeddedLangs:["shellscript"]},{id:"smalltalk",scopeName:"source.smalltalk",path:"smalltalk.tmLanguage.json",displayName:"Smalltalk",samplePath:"smalltalk.sample"},{id:"solidity",scopeName:"source.solidity",path:"solidity.tmLanguage.json",displayName:"Solidity",samplePath:"solidity.sample"},{id:"sparql",scopeName:"source.sparql",path:"sparql.tmLanguage.json",displayName:"SPARQL",samplePath:"sparql.sample",embeddedLangs:["turtle"]},{id:"splunk",scopeName:"source.splunk_search",path:"splunk.tmLanguage.json",displayName:"Splunk Query Language",samplePath:"splunk.sample",aliases:["spl"]},{id:"sql",scopeName:"source.sql",path:"sql.tmLanguage.json",displayName:"SQL",samplePath:"sql.sample"},{id:"ssh-config",scopeName:"source.ssh-config",path:"ssh-config.tmLanguage.json",displayName:"SSH Config",samplePath:"ssh-config.sample"},{id:"stata",scopeName:"source.stata",path:"stata.tmLanguage.json",displayName:"Stata",samplePath:"stata.sample",embeddedLangs:["sql"]},{id:"stylus",scopeName:"source.stylus",path:"stylus.tmLanguage.json",displayName:"Stylus",samplePath:"stylus.sample",aliases:["styl"]},{id:"svelte",scopeName:"source.svelte",path:"svelte.tmLanguage.json",displayName:"Svelte",samplePath:"svelte.sample",embeddedLangs:["javascript","typescript","coffee","stylus","sass","css","scss","less","postcss","pug","markdown"]},{id:"swift",scopeName:"source.swift",path:"swift.tmLanguage.json",displayName:"Swift",samplePath:"swift.sample"},{id:"system-verilog",scopeName:"source.systemverilog",path:"system-verilog.tmLanguage.json",displayName:"SystemVerilog",samplePath:"system-verilog.sample"},{id:"tasl",scopeName:"source.tasl",path:"tasl.tmLanguage.json",displayName:"Tasl",samplePath:"tasl.sample"},{id:"tcl",scopeName:"source.tcl",path:"tcl.tmLanguage.json",displayName:"Tcl",samplePath:"tcl.sample"},{id:"tex",scopeName:"text.tex",path:"tex.tmLanguage.json",displayName:"TeX",samplePath:"tex.sample",embeddedLangs:["r"]},{id:"toml",scopeName:"source.toml",path:"toml.tmLanguage.json",displayName:"TOML",samplePath:"toml.sample"},{id:"tsx",scopeName:"source.tsx",path:"tsx.tmLanguage.json",displayName:"TSX",samplePath:"tsx.sample"},{id:"turtle",scopeName:"source.turtle",path:"turtle.tmLanguage.json",displayName:"Turtle",samplePath:"turtle.sample"},{id:"twig",scopeName:"text.html.twig",path:"twig.tmLanguage.json",displayName:"Twig",samplePath:"twig.sample",embeddedLangs:["css","javascript","scss","php","python","ruby"]},{id:"typescript",scopeName:"source.ts",path:"typescript.tmLanguage.json",displayName:"TypeScript",samplePath:"typescript.sample",aliases:["ts"]},{id:"v",scopeName:"source.v",path:"v.tmLanguage.json",displayName:"V",samplePath:"v.sample"},{id:"vb",scopeName:"source.asp.vb.net",path:"vb.tmLanguage.json",displayName:"Visual Basic",samplePath:"vb.sample",aliases:["cmd"]},{id:"verilog",scopeName:"source.verilog",path:"verilog.tmLanguage.json",displayName:"Verilog",samplePath:"verilog.sample"},{id:"vhdl",scopeName:"source.vhdl",path:"vhdl.tmLanguage.json",displayName:"VHDL",samplePath:"vhdl.sample"},{id:"viml",scopeName:"source.viml",path:"viml.tmLanguage.json",displayName:"Vim Script",samplePath:"viml.sample",aliases:["vim","vimscript"]},{id:"vue-html",scopeName:"text.html.vue-html",path:"vue-html.tmLanguage.json",displayName:"Vue HTML",samplePath:"vue-html.sample",embeddedLangs:["vue","javascript"]},{id:"vue",scopeName:"source.vue",path:"vue.tmLanguage.json",displayName:"Vue",samplePath:"vue.sample",embeddedLangs:["html","markdown","pug","stylus","sass","css","scss","less","javascript","typescript","jsx","tsx","json","jsonc","json5","yaml","toml","graphql"]},{id:"vyper",scopeName:"source.vyper",path:"vyper.tmLanguage.json",displayName:"Vyper",samplePath:"vyper.sample",aliases:["vy"]},{id:"wasm",scopeName:"source.wat",path:"wasm.tmLanguage.json",displayName:"WebAssembly",samplePath:"wasm.sample"},{id:"wenyan",scopeName:"source.wenyan",path:"wenyan.tmLanguage.json",displayName:"Wenyan",samplePath:"wenyan.sample",aliases:[""]},{id:"wgsl",scopeName:"source.wgsl",path:"wgsl.tmLanguage.json",displayName:"WGSL",samplePath:"wgsl.sample"},{id:"wolfram",scopeName:"source.wolfram",path:"wolfram.tmLanguage.json",displayName:"Wolfram",samplePath:"wolfram.sample",aliases:["wl"]},{id:"xml",scopeName:"text.xml",path:"xml.tmLanguage.json",displayName:"XML",samplePath:"xml.sample",embeddedLangs:["java"]},{id:"xsl",scopeName:"text.xml.xsl",path:"xsl.tmLanguage.json",displayName:"XSL",samplePath:"xsl.sample",embeddedLangs:["xml"]},{id:"yaml",scopeName:"source.yaml",path:"yaml.tmLanguage.json",displayName:"YAML",samplePath:"yaml.sample",aliases:["yml"]},{id:"zenscript",scopeName:"source.zenscript",path:"zenscript.tmLanguage.json",displayName:"ZenScript",samplePath:"zenscript.sample"},{id:"zig",scopeName:"source.zig",path:"zig.tmLanguage.json",displayName:"zig",samplePath:"zig.sample"}];var pa=(t=>(t[t.NotSet=-1]="NotSet",t[t.None=0]="None",t[t.Italic=1]="Italic",t[t.Bold=2]="Bold",t[t.Underline=4]="Underline",t))(pa||{});class Li{static toBinaryStr(e){let n=e.toString(2);for(;n.length<32;)n="0"+n;return n}static printMetadata(e){let n=Li.getLanguageId(e),i=Li.getTokenType(e),r=Li.getFontStyle(e),o=Li.getForeground(e),s=Li.getBackground(e);console.log({languageId:n,tokenType:i,fontStyle:r,foreground:o,background:s})}static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static getFontStyle(e){return(e&14336)>>>11}static getForeground(e){return(e&8372224)>>>15}static getBackground(e){return(e&4286578688)>>>24}static containsBalancedBrackets(e){return(e&1024)!==0}static set(e,n,i,r,o,s){let a=Li.getLanguageId(e),l=Li.getTokenType(e),c=Li.getFontStyle(e),d=Li.getForeground(e),u=Li.getBackground(e),h=Li.containsBalancedBrackets(e)?1:0;return n!==0&&(a=n),i!==0&&(l=i===8?0:i),r!==-1&&(c=r),o!==0&&(d=o),s!==0&&(u=s),(a<<0|l<<8|c<<11|h<<10|d<<15|u<<24)>>>0}}function rU(t){return t.endsWith("/")||t.endsWith("\\")?t.slice(0,-1):t}function oU(t){return t.startsWith("./")?t.slice(2):t}function XE(t){const e=t.split(/[\/\\]/g);return e.slice(0,e.length-1)}function KE(...t){return t.map(rU).map(oU).join("/")}function sU(t,e){const n=new Map;for(const i of t){const r=e(i);n.has(r)?n.get(r).push(i):n.set(r,[i])}return n}function aU(t,e=!1){const n=t.length;let i=0,r="",o=0,s=16,a=0,l=0,c=0,d=0,u=0;function h(x,T){let M=0,k=0;for(;M<x||!T;){let _=t.charCodeAt(i);if(_>=48&&_<=57)k=k*16+_-48;else if(_>=65&&_<=70)k=k*16+_-65+10;else if(_>=97&&_<=102)k=k*16+_-97+10;else break;i++,M++}return M<x&&(k=-1),k}function p(x){i=x,r="",o=0,s=16,u=0}function g(){let x=i;if(t.charCodeAt(i)===48)i++;else for(i++;i<t.length&&Jc(t.charCodeAt(i));)i++;if(i<t.length&&t.charCodeAt(i)===46)if(i++,i<t.length&&Jc(t.charCodeAt(i)))for(i++;i<t.length&&Jc(t.charCodeAt(i));)i++;else return u=3,t.substring(x,i);let T=i;if(i<t.length&&(t.charCodeAt(i)===69||t.charCodeAt(i)===101))if(i++,(i<t.length&&t.charCodeAt(i)===43||t.charCodeAt(i)===45)&&i++,i<t.length&&Jc(t.charCodeAt(i))){for(i++;i<t.length&&Jc(t.charCodeAt(i));)i++;T=i}else u=3;return t.substring(x,T)}function f(){let x="",T=i;for(;;){if(i>=n){x+=t.substring(T,i),u=2;break}const M=t.charCodeAt(i);if(M===34){x+=t.substring(T,i),i++;break}if(M===92){if(x+=t.substring(T,i),i++,i>=n){u=2;break}switch(t.charCodeAt(i++)){case 34:x+='"';break;case 92:x+="\\";break;case 47:x+="/";break;case 98:x+="\b";break;case 102:x+="\f";break;case 110:x+=`
`;break;case 114:x+="\r";break;case 116:x+="	";break;case 117:const _=h(4,!0);_>=0?x+=String.fromCharCode(_):u=4;break;default:u=5}T=i;continue}if(M>=0&&M<=31)if(Hu(M)){x+=t.substring(T,i),u=2;break}else u=6;i++}return x}function v(){if(r="",u=0,o=i,l=a,d=c,i>=n)return o=n,s=17;let x=t.charCodeAt(i);if(J4(x)){do i++,r+=String.fromCharCode(x),x=t.charCodeAt(i);while(J4(x));return s=15}if(Hu(x))return i++,r+=String.fromCharCode(x),x===13&&t.charCodeAt(i)===10&&(i++,r+=`
`),a++,c=i,s=14;switch(x){case 123:return i++,s=1;case 125:return i++,s=2;case 91:return i++,s=3;case 93:return i++,s=4;case 58:return i++,s=6;case 44:return i++,s=5;case 34:return i++,r=f(),s=10;case 47:const T=i-1;if(t.charCodeAt(i+1)===47){for(i+=2;i<n&&!Hu(t.charCodeAt(i));)i++;return r=t.substring(T,i),s=12}if(t.charCodeAt(i+1)===42){i+=2;const M=n-1;let k=!1;for(;i<M;){const _=t.charCodeAt(i);if(_===42&&t.charCodeAt(i+1)===47){i+=2,k=!0;break}i++,Hu(_)&&(_===13&&t.charCodeAt(i)===10&&i++,a++,c=i)}return k||(i++,u=1),r=t.substring(T,i),s=13}return r+=String.fromCharCode(x),i++,s=16;case 45:if(r+=String.fromCharCode(x),i++,i===n||!Jc(t.charCodeAt(i)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=g(),s=11;default:for(;i<n&&m(x);)i++,x=t.charCodeAt(i);if(o!==i){switch(r=t.substring(o,i),r){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return r+=String.fromCharCode(x),i++,s=16}}function m(x){if(J4(x)||Hu(x))return!1;switch(x){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function y(){let x;do x=v();while(x>=12&&x<=15);return x}return{setPosition:p,getPosition:()=>i,scan:e?y:v,getToken:()=>s,getTokenValue:()=>r,getTokenOffset:()=>o,getTokenLength:()=>i-o,getTokenStartLine:()=>l,getTokenStartCharacter:()=>o-d,getTokenError:()=>u}}function J4(t){return t===32||t===9}function Hu(t){return t===10||t===13}function Jc(t){return t>=48&&t<=57}var Cw;(function(t){t[t.lineFeed=10]="lineFeed",t[t.carriageReturn=13]="carriageReturn",t[t.space=32]="space",t[t._0=48]="_0",t[t._1=49]="_1",t[t._2=50]="_2",t[t._3=51]="_3",t[t._4=52]="_4",t[t._5=53]="_5",t[t._6=54]="_6",t[t._7=55]="_7",t[t._8=56]="_8",t[t._9=57]="_9",t[t.a=97]="a",t[t.b=98]="b",t[t.c=99]="c",t[t.d=100]="d",t[t.e=101]="e",t[t.f=102]="f",t[t.g=103]="g",t[t.h=104]="h",t[t.i=105]="i",t[t.j=106]="j",t[t.k=107]="k",t[t.l=108]="l",t[t.m=109]="m",t[t.n=110]="n",t[t.o=111]="o",t[t.p=112]="p",t[t.q=113]="q",t[t.r=114]="r",t[t.s=115]="s",t[t.t=116]="t",t[t.u=117]="u",t[t.v=118]="v",t[t.w=119]="w",t[t.x=120]="x",t[t.y=121]="y",t[t.z=122]="z",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.asterisk=42]="asterisk",t[t.backslash=92]="backslash",t[t.closeBrace=125]="closeBrace",t[t.closeBracket=93]="closeBracket",t[t.colon=58]="colon",t[t.comma=44]="comma",t[t.dot=46]="dot",t[t.doubleQuote=34]="doubleQuote",t[t.minus=45]="minus",t[t.openBrace=123]="openBrace",t[t.openBracket=91]="openBracket",t[t.plus=43]="plus",t[t.slash=47]="slash",t[t.formFeed=12]="formFeed",t[t.tab=9]="tab"})(Cw||(Cw={}));var V2;(function(t){t.DEFAULT={allowTrailingComma:!1}})(V2||(V2={}));function lU(t,e=[],n=V2.DEFAULT){let i=null,r=[];const o=[];function s(l){Array.isArray(r)?r.push(l):i!==null&&(r[i]=l)}return cU(t,{onObjectBegin:()=>{const l={};s(l),o.push(r),r=l,i=null},onObjectProperty:l=>{i=l},onObjectEnd:()=>{r=o.pop()},onArrayBegin:()=>{const l=[];s(l),o.push(r),r=l,i=null},onArrayEnd:()=>{r=o.pop()},onLiteralValue:s,onError:(l,c,d)=>{e.push({error:l,offset:c,length:d})}},n),r[0]}function cU(t,e,n=V2.DEFAULT){const i=aU(t,!1),r=[];function o(I){return I?()=>I(i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter()):()=>!0}function s(I){return I?()=>I(i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter(),()=>r.slice()):()=>!0}function a(I){return I?N=>I(N,i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter()):()=>!0}function l(I){return I?N=>I(N,i.getTokenOffset(),i.getTokenLength(),i.getTokenStartLine(),i.getTokenStartCharacter(),()=>r.slice()):()=>!0}const c=s(e.onObjectBegin),d=l(e.onObjectProperty),u=o(e.onObjectEnd),h=s(e.onArrayBegin),p=o(e.onArrayEnd),g=l(e.onLiteralValue),f=a(e.onSeparator),v=o(e.onComment),m=a(e.onError),y=n&&n.disallowComments,x=n&&n.allowTrailingComma;function T(){for(;;){const I=i.scan();switch(i.getTokenError()){case 4:M(14);break;case 5:M(15);break;case 3:M(13);break;case 1:y||M(11);break;case 2:M(12);break;case 6:M(16);break}switch(I){case 12:case 13:y?M(10):v();break;case 16:M(1);break;case 15:case 14:break;default:return I}}}function M(I,N=[],P=[]){if(m(I),N.length+P.length>0){let Z=i.getToken();for(;Z!==17;){if(N.indexOf(Z)!==-1){T();break}else if(P.indexOf(Z)!==-1)break;Z=T()}}}function k(I){const N=i.getTokenValue();return I?g(N):(d(N),r.push(N)),T(),!0}function _(){switch(i.getToken()){case 11:const I=i.getTokenValue();let N=Number(I);isNaN(N)&&(M(2),N=0),g(N);break;case 7:g(null);break;case 8:g(!0);break;case 9:g(!1);break;default:return!1}return T(),!0}function A(){return i.getToken()!==10?(M(3,[],[2,5]),!1):(k(!1),i.getToken()===6?(f(":"),T(),R()||M(4,[],[2,5])):M(5,[],[2,5]),r.pop(),!0)}function $(){c(),T();let I=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(I||M(4,[],[]),f(","),T(),i.getToken()===2&&x)break}else I&&M(6,[],[]);A()||M(4,[],[2,5]),I=!0}return u(),i.getToken()!==2?M(7,[2],[]):T(),!0}function E(){h(),T();let I=!0,N=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(N||M(4,[],[]),f(","),T(),i.getToken()===4&&x)break}else N&&M(6,[],[]);I?(r.push(0),I=!1):r[r.length-1]++,R()||M(4,[],[4,5]),N=!0}return p(),I||r.pop(),i.getToken()!==4?M(8,[4],[]):T(),!0}function R(){switch(i.getToken()){case 3:return E();case 1:return $();case 10:return k(!0);default:return _()}}return T(),i.getToken()===17?n.allowEmptyContent?!0:(M(4,[],[]),!1):R()?(i.getToken()!==17&&M(9,[],[]),!0):(M(4,[],[]),!1)}var kw;(function(t){t[t.None=0]="None",t[t.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=2]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",t[t.InvalidUnicode=4]="InvalidUnicode",t[t.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",t[t.InvalidCharacter=6]="InvalidCharacter"})(kw||(kw={}));var Ew;(function(t){t[t.OpenBraceToken=1]="OpenBraceToken",t[t.CloseBraceToken=2]="CloseBraceToken",t[t.OpenBracketToken=3]="OpenBracketToken",t[t.CloseBracketToken=4]="CloseBracketToken",t[t.CommaToken=5]="CommaToken",t[t.ColonToken=6]="ColonToken",t[t.NullKeyword=7]="NullKeyword",t[t.TrueKeyword=8]="TrueKeyword",t[t.FalseKeyword=9]="FalseKeyword",t[t.StringLiteral=10]="StringLiteral",t[t.NumericLiteral=11]="NumericLiteral",t[t.LineCommentTrivia=12]="LineCommentTrivia",t[t.BlockCommentTrivia=13]="BlockCommentTrivia",t[t.LineBreakTrivia=14]="LineBreakTrivia",t[t.Trivia=15]="Trivia",t[t.Unknown=16]="Unknown",t[t.EOF=17]="EOF"})(Ew||(Ew={}));const dU=lU;var Sw;(function(t){t[t.InvalidSymbol=1]="InvalidSymbol",t[t.InvalidNumberFormat=2]="InvalidNumberFormat",t[t.PropertyNameExpected=3]="PropertyNameExpected",t[t.ValueExpected=4]="ValueExpected",t[t.ColonExpected=5]="ColonExpected",t[t.CommaExpected=6]="CommaExpected",t[t.CloseBraceExpected=7]="CloseBraceExpected",t[t.CloseBracketExpected=8]="CloseBracketExpected",t[t.EndOfFileExpected=9]="EndOfFileExpected",t[t.InvalidCommentToken=10]="InvalidCommentToken",t[t.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=12]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",t[t.InvalidUnicode=14]="InvalidUnicode",t[t.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",t[t.InvalidCharacter=16]="InvalidCharacter"})(Sw||(Sw={}));const uU=typeof self<"u"&&typeof self.WorkerGlobalScope<"u",hU="process"in globalThis&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node",pU="process"in globalThis&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="bun",s9=uU||!hU&&!pU;let fU="";const gU="dist/";let e6=null;async function mU(t){if(!e6){let e;if(s9)e=vf.loadWASM({data:await fetch(QE(KE(...XE(t),"onig.wasm")))});else{const i=require("path").join(require.resolve("vscode-oniguruma"),"../onig.wasm"),o=require("fs").readFileSync(i).buffer;e=vf.loadWASM(o)}e6=e.then(()=>({createOnigScanner(n){return vf.createOnigScanner(n)},createOnigString(n){return vf.createOnigString(n)}}))}return e6}function QE(t){if(s9)return`${fU}${t}`;{const e=require("path");return e.isAbsolute(t)?t:e.resolve(__dirname,"..",t)}}async function bU(t){const e=QE(t);return s9?await fetch(e).then(n=>n.text()):await require("fs").promises.readFile(e,"utf-8")}async function JE(t){const e=[],n=await bU(t);let i;try{i=JSON.parse(n)}catch{if(i=dU(n,e,{allowTrailingComma:!0}),e.length)throw e[0]}return i}async function eS(t){let e=await JE(t);const n=tS(e);if(n.include){const i=await eS(KE(...XE(t),n.include));i.settings&&(n.settings=i.settings.concat(n.settings)),i.bg&&!n.bg&&(n.bg=i.bg),i.colors&&(n.colors={...i.colors,...n.colors}),delete n.include}return n}async function vU(t){return await JE(t)}function yU(t){t.settings||(t.settings=[]),!(t.settings[0]&&t.settings[0].settings&&!t.settings[0].scope)&&t.settings.unshift({settings:{foreground:t.fg,background:t.bg}})}function tS(t){const e=t.type||"dark",n={name:t.name,type:e,...t,...wU(t)};return t.include&&(n.include=t.include),t.tokenColors&&(n.settings=t.tokenColors,delete n.tokenColors),yU(n),n}const Tw={light:"#333333",dark:"#bbbbbb"},Iw={light:"#fffffe",dark:"#1e1e1e"};function wU(t){let e,n,i=t.settings?t.settings:t.tokenColors;const r=i?i.find(o=>!o.name&&!o.scope):void 0;return r?.settings?.foreground&&(e=r.settings.foreground),r?.settings?.background&&(n=r.settings.background),!e&&t?.colors?.["editor.foreground"]&&(e=t.colors["editor.foreground"]),!n&&t?.colors?.["editor.background"]&&(n=t.colors["editor.background"]),e||(e=t.type==="light"?Tw.light:Tw.dark),n||(n=t.type==="light"?Iw.light:Iw.dark),{fg:e,bg:n}}class xU{constructor(e,n){this.languagesPath="languages/",this.languageMap={},this.scopeToLangMap={},this._onigLibPromise=e,this._onigLibName=n}get onigLib(){return this._onigLibPromise}getOnigLibName(){return this._onigLibName}getLangRegistration(e){return this.languageMap[e]}async loadGrammar(e){const n=this.scopeToLangMap[e];if(!n)return null;if(n.grammar)return n.grammar;const i=await vU(Wl.includes(n)?`${this.languagesPath}${n.path}`:n.path);return n.grammar=i,i}addLanguage(e){this.languageMap[e.id]=e,e.aliases&&e.aliases.forEach(n=>{this.languageMap[n]=e}),this.scopeToLangMap[e.scopeName]=e}}function _U(t,e,n,i,r){let o=n.split(/\r\n|\r|\n/),s=YE.INITIAL,a=[],l=[];for(let c=0,d=o.length;c<d;c++){let u=o[c];if(u===""){a=[],l.push([]);continue}let h,p,g;r.includeExplanation&&(h=i.tokenizeLine(u,s),p=h.tokens,g=0);let f=i.tokenizeLine2(u,s),v=f.tokens.length/2;for(let m=0;m<v;m++){let y=f.tokens[2*m],x=m+1<v?f.tokens[2*m+2]:u.length;if(y===x)continue;let T=f.tokens[2*m+1],M=Li.getForeground(T),k=e[M],_=Li.getFontStyle(T),A=[];if(r.includeExplanation){let $=0;for(;y+$<x;){let E=p[g],R=u.substring(E.startIndex,E.endIndex);$+=R.length,A.push({content:R,scopes:CU(t,E.scopes)}),g++}}a.push({content:u.substring(y,x),color:k,fontStyle:_,explanation:A})}l.push(a),a=[],s=f.ruleStack}return l}function CU(t,e){let n=[];for(let i=0,r=e.length;i<r;i++){let o=e.slice(0,i),s=e[i];n[i]={scopeName:s,themeMatches:EU(t,s,o)}}return n}function Lw(t,e){let n=t+".";return t===e||e.substring(0,n.length)===n}function kU(t,e,n,i){if(!Lw(t,n))return!1;let r=e.length-1,o=i.length-1;for(;r>=0&&o>=0;)Lw(e[r],i[o])&&r--,o--;return r===-1}function EU(t,e,n){let i=[],r=0;for(let o=0,s=t.settings.length;o<s;o++){let a=t.settings[o],l;if(typeof a.scope=="string")l=a.scope.split(/,/).map(c=>c.trim());else if(Array.isArray(a.scope))l=a.scope;else continue;for(let c=0,d=l.length;c<d;c++){let h=l[c].split(/ /),p=h[h.length-1],g=h.slice(0,h.length-1);kU(p,g,e,n)&&(i[r++]=a,c=d)}}return i}var bs=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],t6={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function SU(t,e){const n=t.indexOf("\x1B",e);if(n!==-1&&t[n+1]==="["){const i=t.indexOf("m",n);return{sequence:t.substring(n+2,i).split(";"),startPosition:n,position:i+1}}return{position:t.length}}function Mw(t){const e=t.shift();if(e==="2"){const n=t.splice(0,3).map(i=>Number.parseInt(i));return n.length!==3||n.some(i=>Number.isNaN(i))?void 0:{type:"rgb",rgb:n}}else if(e==="5"){const n=t.shift();if(n)return{type:"table",index:Number(n)}}}function TU(t){const e=[];for(;t.length>0;){const n=t.shift();if(!n)continue;const i=Number.parseInt(n);if(!Number.isNaN(i))if(i===0)e.push({type:"resetAll"});else if(i<=9)t6[i]&&e.push({type:"setDecoration",value:t6[i]});else if(i<=29){const r=t6[i-20];r&&e.push({type:"resetDecoration",value:r})}else if(i<=37)e.push({type:"setForegroundColor",value:{type:"named",name:bs[i-30]}});else if(i===38){const r=Mw(t);r&&e.push({type:"setForegroundColor",value:r})}else if(i===39)e.push({type:"resetForegroundColor"});else if(i<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:bs[i-40]}});else if(i===48){const r=Mw(t);r&&e.push({type:"setBackgroundColor",value:r})}else i===49?e.push({type:"resetBackgroundColor"}):i>=90&&i<=97?e.push({type:"setForegroundColor",value:{type:"named",name:bs[i-90+8]}}):i>=100&&i<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:bs[i-100+8]}})}return e}function IU(){let t=null,e=null,n=new Set;return{parse(i){const r=[];let o=0;do{const s=SU(i,o),a=s.sequence?i.substring(o,s.startPosition):i.substring(o);if(a.length>0&&r.push({value:a,foreground:t,background:e,decorations:new Set(n)}),s.sequence){const l=TU(s.sequence);for(const c of l)c.type==="resetAll"?(t=null,e=null,n.clear()):c.type==="resetForegroundColor"?t=null:c.type==="resetBackgroundColor"?e=null:c.type==="resetDecoration"&&n.delete(c.value);for(const c of l)c.type==="setForegroundColor"?t=c.value:c.type==="setBackgroundColor"?e=c.value:c.type==="setDecoration"&&n.add(c.value)}o=s.position}while(o<i.length);return r}}}var LU={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function MU(t=LU){function e(a){return t[a]}function n(a){return`#${a.map(l=>Math.max(0,Math.min(l,255)).toString(16).padStart(2,"0")).join("")}`}let i;function r(){if(i)return i;i=[];for(let c=0;c<bs.length;c++)i.push(e(bs[c]));let a=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let d=0;d<6;d++)for(let u=0;u<6;u++)i.push(n([a[c],a[d],a[u]]));let l=8;for(let c=0;c<24;c++,l+=10)i.push(n([l,l,l]));return i}function o(a){return r()[a]}function s(a){switch(a.type){case"named":return e(a.name);case"rgb":return n(a.rgb);case"table":return o(a.index)}}return{value:s}}function PU(t,e){const n=e.split(/\r?\n/),i=MU(Object.fromEntries(bs.map(o=>[o,t.colors[`terminal.ansi${o[0].toUpperCase()}${o.substring(1)}`]]))),r=IU();return n.map(o=>r.parse(o).map(s=>{let a;s.decorations.has("reverse")?a=s.background?i.value(s.background):t.bg:a=s.foreground?i.value(s.foreground):t.fg,s.decorations.has("dim")&&(a=AU(a));let l=pa.None;return s.decorations.has("bold")&&(l|=pa.Bold),s.decorations.has("italic")&&(l|=pa.Italic),s.decorations.has("underline")&&(l|=pa.Underline),{content:s.value,color:a,fontStyle:l}}))}function AU(t){const e=t.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const i=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${i}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(i=>`${i}${i}`).join("")}80`;const n=t.match(/var\((--shiki-color-ansi-[\w-]+)\)/);return n?`var(${n[1]}-dim)`:t}const $U={pre({className:t,style:e,children:n}){return`<pre class="${t}" style="${e}" tabindex="0">${n}</pre>`},code({children:t}){return`<code>${t}</code>`},line({className:t,children:e}){return`<span class="${t}">${e}</span>`},token({style:t,children:e}){return`<span style="${t}">${e}</span>`}};function Pw(t,e={}){const n=e.bg||"#fff",i=sU(e.lineOptions??[],s=>s.line),r=e.elements||{};function o(s="",a={},l){const c=r[s]||$U[s];return c?(l=l.filter(Boolean),c({...a,children:s==="code"?l.join(`
`):l.join("")})):""}return o("pre",{className:"shiki "+(e.themeName||""),style:`background-color: ${n}`},[e.langId?`<div class="language-id">${e.langId}</div>`:"",o("code",{},t.map((s,a)=>{const l=a+1,c=i.get(l)??[],d=OU(c).join(" ");return o("line",{className:d,lines:t,line:s,index:a},s.map((u,h)=>{const p=[`color: ${u.color||e.fg}`];return u.fontStyle&pa.Italic&&p.push("font-style: italic"),u.fontStyle&pa.Bold&&p.push("font-weight: bold"),u.fontStyle&pa.Underline&&p.push("text-decoration: underline"),o("token",{style:p.join("; "),tokens:s,token:u,index:h},[DU(u.content)])}))}))])}const BU={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function DU(t){return t.replace(/[&<>"']/g,e=>BU[e])}function OU(t){const e=new Set(["line"]);for(const n of t)for(const i of n.classes??[])e.add(i);return Array.from(e)}class RU extends YE.Registry{constructor(e){super(e),this._resolver=e,this.themesPath="themes/",this._resolvedThemes={},this._resolvedGrammars={},this._langGraph=new Map,this._langMap=Wl.reduce((n,i)=>(n[i.id]=i,n),{})}getTheme(e){return typeof e=="string"?this._resolvedThemes[e]:e}async loadTheme(e){return typeof e=="string"?(this._resolvedThemes[e]||(this._resolvedThemes[e]=await eS(`${this.themesPath}${e}.json`)),this._resolvedThemes[e]):(e=tS(e),e.name&&(this._resolvedThemes[e.name]=e),e)}async loadThemes(e){return await Promise.all(e.map(n=>this.loadTheme(n)))}getLoadedThemes(){return Object.keys(this._resolvedThemes)}getGrammar(e){return this._resolvedGrammars[e]}async loadLanguage(e){const i={embeddedLanguages:e.embeddedLangs?.reduce(async(o,s,a)=>{if(!this.getLoadedLanguages().includes(s)&&this._resolver.getLangRegistration(s))return await this._resolver.loadGrammar(this._resolver.getLangRegistration(s).scopeName),o[this._resolver.getLangRegistration(s).scopeName]=a+2,o},{}),balancedBracketSelectors:e.balancedBracketSelectors||["*"],unbalancedBracketSelectors:e.unbalancedBracketSelectors||[]},r=await this.loadGrammarWithConfiguration(e.scopeName,1,i);this._resolvedGrammars[e.id]=r,e.aliases&&e.aliases.forEach(o=>{this._resolvedGrammars[o]=r})}async loadLanguages(e){for(const i of e)this.resolveEmbeddedLanguages(i);const n=Array.from(this._langGraph.values());for(const i of n)this._resolver.addLanguage(i);for(const i of n)await this.loadLanguage(i)}getLoadedLanguages(){return Object.keys(this._resolvedGrammars)}resolveEmbeddedLanguages(e){if(this._langGraph.has(e.id)||this._langGraph.set(e.id,e),e.embeddedLangs)for(const n of e.embeddedLangs)this._langGraph.set(n,this._langMap[n])}}function nS(t){return typeof t=="string"?Wl.find(e=>e.id===t||e.aliases?.includes(t)):t}function NU(t){let e=Wl,n=t.themes||[],i=t.paths?.wasm?t.paths.wasm.endsWith("/")?t.paths.wasm:t.paths.wasm+"/":gU;return t.langs&&(e=t.langs.map(nS)),t.theme&&n.unshift(t.theme),n.length||(n=["nord"]),{_languages:e,_themes:n,_wasmPath:i}}function HU(){const t={"#000001":"var(--shiki-color-text)","#000002":"var(--shiki-color-background)","#000004":"var(--shiki-token-constant)","#000005":"var(--shiki-token-string)","#000006":"var(--shiki-token-comment)","#000007":"var(--shiki-token-keyword)","#000008":"var(--shiki-token-parameter)","#000009":"var(--shiki-token-function)","#000010":"var(--shiki-token-string-expression)","#000011":"var(--shiki-token-punctuation)","#000012":"var(--shiki-token-link)"};for(let e=0;e<bs.length;e++){const n=`#A${e.toString().padStart(5,"0")}`,i=bs[e].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();t[n]=`var(--shiki-color-ansi-${i})`}return t}async function FU(t){const{_languages:e,_themes:n,_wasmPath:i}=NU(t),r=new xU(mU(i),"vscode-oniguruma"),o=new RU(r);t.paths?.themes&&(o.themesPath=t.paths.themes.endsWith("/")?t.paths.themes:t.paths.themes+"/"),t.paths?.languages&&(r.languagesPath=t.paths.languages.endsWith("/")?t.paths.languages:t.paths.languages+"/");const a=(await o.loadThemes(n))[0];let l;await o.loadLanguages(e);let c=HU();function d(A){c=A}function u(A,$){A.bg=c[A.bg]||A.bg,A.fg=c[A.fg]||A.fg,Object.entries(A.colors).forEach(([E,R])=>{A.colors[E]=c[R]||R}),$.forEach((E,R)=>{$[R]=c[E]||E})}function h(A){const $=A?o.getTheme(A):a;if(!$)throw Error(`No theme registration for ${A}`);(!l||l.name!==$.name)&&(o.setTheme($),l=$);const E=o.getColorMap();return $.type==="css"&&u($,E),{_theme:$,_colorMap:E}}function p(A){const $=o.getGrammar(A);if(!$)throw Error(`No language registration for ${A}`);return{_grammar:$}}function g(A,$="text",E,R={includeExplanation:!0}){if(UU($))return[...A.split(/\r\n|\r|\n/).map(pe=>[{content:pe}])];const{_grammar:I}=p($),{_theme:N,_colorMap:P}=h(E);return _U(N,P,A,I,R)}function f(A,$){const{_theme:E}=h($);return PU(E,A)}function v(A,$="text",E){let R;typeof $=="object"?R=$:R={lang:$,theme:E};const I=g(A,R.lang,R.theme,{includeExplanation:!1}),{_theme:N}=h(R.theme);return Pw(I,{fg:N.fg,bg:N.bg,lineOptions:R?.lineOptions,themeName:N.name})}function m(A,$){const E=f(A,$?.theme),{_theme:R}=h($?.theme);return Pw(E,{fg:R.fg,bg:R.bg,lineOptions:$?.lineOptions,themeName:R.name})}async function y(A){await o.loadTheme(A)}async function x(A){const $=nS(A);r.addLanguage($),await o.loadLanguage($)}function T(){return o.getLoadedThemes()}function M(){return o.getLoadedLanguages()}function k(A){const{_theme:$}=h(A);return $.bg}function _(A){const{_theme:$}=h(A);return $.fg}return{codeToThemedTokens:g,codeToHtml:v,ansiToThemedTokens:f,ansiToHtml:m,getTheme:A=>h(A)._theme,loadTheme:y,loadLanguage:x,getBackgroundColor:k,getForegroundColor:_,getLoadedThemes:T,getLoadedLanguages:M,setColorReplacements:d}}function UU(t){return!t||["plaintext","txt","text"].includes(t)}function Aw(t){if(t)throw t}var o2=Object.prototype.hasOwnProperty,iS=Object.prototype.toString,$w=Object.defineProperty,Bw=Object.getOwnPropertyDescriptor,Dw=function(e){return typeof Array.isArray=="function"?Array.isArray(e):iS.call(e)==="[object Array]"},Ow=function(e){if(!e||iS.call(e)!=="[object Object]")return!1;var n=o2.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&o2.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;var r;for(r in e);return typeof r>"u"||o2.call(e,r)},Rw=function(e,n){$w&&n.name==="__proto__"?$w(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},Nw=function(e,n){if(n==="__proto__")if(o2.call(e,n)){if(Bw)return Bw(e,n).value}else return;return e[n]},VU=function t(){var e,n,i,r,o,s,a=arguments[0],l=1,c=arguments.length,d=!1;for(typeof a=="boolean"&&(d=a,a=arguments[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<c;++l)if(e=arguments[l],e!=null)for(n in e)i=Nw(a,n),r=Nw(e,n),a!==r&&(d&&r&&(Ow(r)||(o=Dw(r)))?(o?(o=!1,s=i&&Dw(i)?i:[]):s=i&&Ow(i)?i:{},Rw(a,{name:n,newValue:t(d,s,r)})):typeof r<"u"&&Rw(a,{name:n,newValue:r}));return a};const n6=rk(VU);function U7(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function zU(){const t=[],e={run:n,use:i};return e;function n(...r){let o=-1;const s=r.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);a(null,...r);function a(l,...c){const d=t[++o];let u=-1;if(l){s(l);return}for(;++u<r.length;)(c[u]===null||c[u]===void 0)&&(c[u]=r[u]);r=c,d?jU(d,a)(...c):s(null,...c)}}function i(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return t.push(r),e}}function jU(t,e){let n;return i;function i(...s){const a=t.length>s.length;let l;a&&s.push(r);try{l=t.apply(this,s)}catch(c){const d=c;if(a&&n)throw d;return r(d)}a||(l instanceof Promise?l.then(o,r):l instanceof Error?r(l):o(l))}function r(s,...a){n||(n=!0,e(s,...a))}function o(s){r(null,s)}}const GU=function(t){const i=this.constructor.prototype,r=i[t],o=function(){return r.apply(o,arguments)};Object.setPrototypeOf(o,i);const s=Object.getOwnPropertyNames(r);for(const a of s){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(o,a,l)}return o},ZU={}.hasOwnProperty;class a9 extends GU{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=zU()}copy(){const e=new a9;let n=-1;for(;++n<this.attachers.length;){const i=this.attachers[n];e.use(...i)}return e.data(n6(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(o6("data",this.frozen),this.namespace[e]=n,this):ZU.call(this.namespace,e)&&this.namespace[e]||void 0:e?(o6("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const r=n.call(e,...i);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=yf(e),i=this.parser||this.Parser;return i6("parse",i),i(String(n),n)}process(e,n){const i=this;return this.freeze(),i6("process",this.parser||this.Parser),r6("process",this.compiler||this.Compiler),n?r(void 0,n):new Promise(r);function r(o,s){const a=yf(e),l=i.parse(a);i.run(l,a,function(d,u,h){if(d||!u||!h)return c(d);const p=u,g=i.stringify(p,h);qU(g)?h.value=g:h.result=g,c(d,h)});function c(d,u){d||!u?s(d):o?o(u):n(void 0,u)}}}processSync(e){let n=!1,i;return this.freeze(),i6("processSync",this.parser||this.Parser),r6("processSync",this.compiler||this.Compiler),this.process(e,r),Fw("processSync","process",n),i;function r(o,s){n=!0,Aw(o),i=s}}run(e,n,i){Hw(e),this.freeze();const r=this.transformers;return!i&&typeof n=="function"&&(i=n,n=void 0),i?o(void 0,i):new Promise(o);function o(s,a){const l=yf(n);r.run(e,l,c);function c(d,u,h){const p=u||e;d?a(d):s?s(p):i(void 0,p,h)}}}runSync(e,n){let i=!1,r;return this.run(e,n,o),Fw("runSync","run",i),r;function o(s,a){Aw(s),r=a,i=!0}}stringify(e,n){this.freeze();const i=yf(n),r=this.compiler||this.Compiler;return r6("stringify",r),Hw(e),r(e,i)}use(e,...n){const i=this.attachers,r=this.namespace;if(o6("use",this.frozen),e!=null)if(typeof e=="function")l(e,n);else if(typeof e=="object")Array.isArray(e)?a(e):s(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function o(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[d,...u]=c;l(d,u)}else s(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function s(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");a(c.plugins),c.settings&&(r.settings=n6(!0,r.settings,c.settings))}function a(c){let d=-1;if(c!=null)if(Array.isArray(c))for(;++d<c.length;){const u=c[d];o(u)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,d){let u=-1,h=-1;for(;++u<i.length;)if(i[u][0]===c){h=u;break}if(h===-1)i.push([c,...d]);else if(d.length>0){let[p,...g]=d;const f=i[h][1];U7(f)&&U7(p)&&(p=n6(!0,f,p)),i[h]=[c,p,...g]}}}}const jh=new a9().freeze();function i6(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function r6(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function o6(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Hw(t){if(!U7(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function Fw(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function yf(t){return WU(t)?t:new H7(t)}function WU(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function qU(t){return typeof t=="string"||YU(t)}function YU(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}let Fu=null;const rS=async t=>{if(Fu){const{langs:e}=t;return e&&await Promise.all(e.map(n=>Fu?.loadLanguage(n))),Fu}return Fu=await FU({...t}),Fu};class XU{constructor(e){this.maxSize=e,this.cache=new Map}get(e){const n=this.cache.get(e);return n===void 0?null:(this.cache.delete(e),this.cache.set(e,n),n)}set(e,n){if(this.cache.size>=this.maxSize){const i=this.cache.keys().next().value;this.cache.delete(i)}this.cache.set(e,n)}}const z2=new XU(4e3),Th=t=>{t=t.trim();const e=[],n=Object.create(null);for(let r=0;r<t.length;r++)t[r]==='"'&&t[r-1]!=="\\"&&e.push(r);let i=t.indexOf("filename=");for(let r=0;r<e.length;r+=2){const o=e[r],s=e[r+1];n[o]=s,o<i&&i<s&&(i=t.indexOf("filename=",s))}if(i!==-1){if(n[i+9]===void 0){const r=t.indexOf(" ",i);return t.slice(i+9,r===-1?t.length:r)}return t.slice(i+10,n[i+9])}},go=(t,e="")=>{if(!t)return e;switch(t.type){case"text":return t.value.replace(/\s+/g," ");case"element":{switch(t.tagName){case"br":return`
`}return t.children.map(n=>go(n)).join("")}}return e},j2=t=>t?t.type==="element"?t.children.filter(e=>e.type==="element"):[]:[],oS=t=>t?t.type==="element"?t.children.filter(e=>e.type==="text"):[]:[],V7=t=>({...t,children:oS(t)}),sS=(t,e)=>{if(t.type==="element"){if(t.tagName===e)return t;for(const n of t.children){const i=sS(n,e);if(i)return i}}},aS=(t,e)=>{if(t.type==="element"){if(Array.isArray(t.properties?.className)&&t.properties.className.includes(e))return t;for(const n of t.children){const i=aS(n,e);if(i)return i}}},lS=(t,e)=>{if(t.type==="element"){if(t.properties.id===e)return t;for(const n of t.children){const i=lS(n,e);if(i)return i}}},Qt=(t,e)=>{if(t.type==="root")for(const n of t.children){const i=Qt(n,e);if(i)return i}else if(t.type==="element")return e.startsWith(".")?aS(t,e.slice(1)):e.startsWith("#")?lS(t,e.slice(1)):sS(t,e)},l9=async(t,e,n)=>{try{return n?await fetch(n+"?url="+encodeURIComponent(t),e).catch(()=>fetch(t,e)):await fetch(t,e)}catch(i){throw console.warn("Error fetching image:",i),i}},Uw=(t,e,n={force:!1})=>{if(t.length===0)return[e];const i=t[t.length-1];return n?.force?(i.insert=i.insert+e.insert,i.attributes=Object.create(null),t):typeof i.insert=="string"&&typeof e.insert=="string"&&(km(i.attributes,e.attributes)||i.attributes===void 0&&e.attributes===void 0)?(i.insert+=e.insert,t):[...t,e]};class Kg extends kc{constructor(){super(...arguments),this._astToHtml=e=>jh().use(iU).stringify(e),this._traverseSnapshot=async(e,n,i)=>{const r=[],o=new Vl;return o.setONodeTypeGuard(s=>$g.safeParse(s).success),o.setEnter(async(s,a)=>{const l=s.node.props.text??{delta:[]};switch(s.node.flavour){case"affine:page":{a.openNode({type:"element",tagName:"html",properties:{},children:[]},"children").openNode({type:"element",tagName:"head",properties:{},children:[]},"children").openNode({type:"element",tagName:"style",properties:{},children:[]},"children").openNode({type:"text",value:`
                input[type='checkbox'] {
                  display: none;
                }
                label:before {
                  background: rgb(30, 150, 235);
                  border-radius: 3px;
                  height: 16px;
                  width: 16px;
                  display: inline-block;
                  cursor: pointer;
                }
                input[type='checkbox'] + label:before {
                  content: '';
                  background: rgb(30, 150, 235);
                  color: #fff;
                  font-size: 16px;
                  line-height: 16px;
                  text-align: center;
                }
                input[type='checkbox']:checked + label:before {
                  content: '';
                }
                `.replace(/\s\s+/g,"")},"children").closeNode().closeNode().closeNode().openNode({type:"element",tagName:"body",properties:{},children:[]},"children").openNode({type:"element",tagName:"div",properties:{style:"width: 70vw; margin: 60px auto;"},children:[]},"children").openNode({type:"comment",value:"BlockSuitePageTitlePlaceholder"}).closeNode();break}case"affine:code":{a.openNode({type:"element",tagName:"pre",properties:{},children:[]},"children").openNode({type:"element",tagName:"code",properties:{className:[`code-${s.node.props.language}`]},children:await this._deltaToHigglightHasts(l.delta,s.node.props.language)},"children").closeNode().closeNode();break}case"affine:paragraph":{switch(s.node.props.type){case"text":{a.openNode({type:"element",tagName:"div",properties:{className:["affine-paragraph-block-container"]},children:[]},"children").openNode({type:"element",tagName:"p",properties:{},children:this._deltaToHast(l.delta)},"children").closeNode().openNode({type:"element",tagName:"div",properties:{className:["affine-block-children-container"],style:"padding-left: 26px;"},children:[]},"children");break}case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{a.openNode({type:"element",tagName:"div",properties:{className:["affine-paragraph-block-container"]},children:[]},"children").openNode({type:"element",tagName:s.node.props.type,properties:{},children:this._deltaToHast(l.delta)},"children").closeNode().openNode({type:"element",tagName:"div",properties:{className:["affine-block-children-container"],style:"padding-left: 26px;"},children:[]},"children");break}case"quote":{a.openNode({type:"element",tagName:"div",properties:{className:["affine-paragraph-block-container"]},children:[]},"children").openNode({type:"element",tagName:"blockquote",properties:{className:["quote"]},children:[]},"children").openNode({type:"element",tagName:"p",properties:{},children:this._deltaToHast(l.delta)},"children").closeNode().closeNode().openNode({type:"element",tagName:"div",properties:{className:["affine-block-children-container"],style:"padding-left: 26px;"},children:[]},"children");break}}break}case"affine:list":{a.openNode({type:"element",tagName:"div",properties:{className:["affine-list-block-container"]},children:[]},"children").openNode({type:"element",tagName:s.node.props.type==="numbered"?"ol":"ul",properties:{style:s.node.props.type==="todo"?"list-style-type: none;":""},children:[]},"children");const c=this._deltaToHast(l.delta);s.node.props.type==="todo"&&c.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:s.node.props.checked},children:[{type:"element",tagName:"label",properties:{},children:[]}]}),a.openNode({type:"element",tagName:"li",properties:{},children:c},"children").closeNode().closeNode().openNode({type:"element",tagName:"div",properties:{className:["affine-block-children-container"],style:"padding-left: 26px;"},children:[]},"children");break}case"affine:divider":{a.openNode({type:"element",tagName:"hr",properties:{},children:[]},"children").closeNode();break}case"affine:image":{const c=s.node.props.sourceId??"";if(!i)break;await i.readFromBlob(c);const d=i.getAssets().get(c);r.push(c);const u=ys(i.getAssets(),c);if(!d)break;a.openNode({type:"element",tagName:"figure",properties:{className:["affine-image-block-container"]},children:[]},"children").openNode({type:"element",tagName:"img",properties:{src:`assets/${u}`,alt:u},children:[]},"children").closeNode().closeNode();break}}}),o.setLeave(async(s,a)=>{switch(s.node.flavour){case"affine:page":{a.closeNode().closeNode().closeNode();break}case"affine:paragraph":{a.closeNode().closeNode();break}case"affine:list":{a.closeNode().closeNode();break}}}),{ast:await o.walk(e,n),assetsIds:r}},this._traverseHtml=async(e,n,i)=>{const r=new Vl;return r.setONodeTypeGuard(o=>"type"in o&&o.type!==void 0),r.setEnter(async(o,s)=>{if(o.node.type==="element")switch(o.node.tagName){case"header":{s.skipAllChildren();break}case"img":{if(!i)break;const a=o.node,l=typeof a?.properties.src=="string"?a.properties.src:"";if(l){let c="";if(!l.startsWith("http"))i.getAssets().forEach((d,u)=>{const h=ys(i.getAssets(),u);l.includes(h)&&(c=u)});else try{const d=await l9(l,void 0,this.configs.get("imageProxy")),u=d.clone(),h=Th(d.headers.get("Content-Disposition")??"")??l.split("/").at(-1)??"image"+d.headers.get("Content-Type")?.split("/").at(-1)??".png",p=new File([await d.blob()],h);c=await _1(await u.arrayBuffer()),i?.getAssets().set(c,p),await i?.writeToBlob(c)}catch{break}s.openNode({type:"block",id:Oe(),flavour:"affine:image",props:{sourceId:c},children:[]},"children").closeNode(),s.skipAllChildren();break}break}case"pre":{const a=Qt(o.node,"code");if(!a)break;const l=a.children.length===1&&a.children[0].type==="text"?a.children[0]:{...a,tagName:"div"};let c=Array.isArray(a.properties?.className)?a.properties.className.find(d=>typeof d=="string"&&d.startsWith("code-")):void 0;c=typeof c=="string"?c.replace("code-",""):void 0,s.openNode({type:"block",id:Oe(),flavour:"affine:code",props:{language:c??"Plain Text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(l,{trim:!1})}},children:[]},"children").closeNode(),s.skipAllChildren();break}case"blockquote":{s.setGlobalContext("hast:blockquote",!0);const a=oS(o.node),l=a.every(c=>!c.value.trim());a&&!l&&s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"quote",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(V7(o.node))}},children:[]},"children").closeNode();break}case"body":case"div":{o.parent?.type==="element"&&o.parent.tagName!=="li"&&(j2(o.node).every(a=>["span","strong","em","code","del","u","a","mark","br"].includes(a.tagName))||o.node.children.map(a=>a.type).every(a=>a==="text"))&&(s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(o.node)}},children:[]},"children").closeNode(),s.skipAllChildren());break}case"p":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:s.getGlobalContext("hast:blockquote")?"quote":"text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(o.node)}},children:[]},"children");break}case"ul":case"ol":{s.setNodeContext("hast:list:type","bulleted"),o.node.tagName==="ol"?s.setNodeContext("hast:list:type","numbered"):Array.isArray(o.node.properties?.className)&&(o.node.properties.className.includes("to-do-list")?s.setNodeContext("hast:list:type","todo"):o.node.properties.className.includes("toggle")?s.setNodeContext("hast:list:type","toggle"):o.node.properties.className.includes("bulleted-list")&&s.setNodeContext("hast:list:type","bulleted"));break}case"li":{const a=j2(o.node)[0],l=s.getNodeContext("hast:list:type");s.openNode({type:"block",id:Oe(),flavour:"affine:list",props:{type:l,text:{"$blocksuite:internal:text$":!0,delta:l!=="toggle"?this._hastToDelta(o.node):this._hastToDelta(Qt(o.node,"summary")??o.node)},checked:l==="todo"?a&&Array.isArray(a.properties?.className)&&a.properties.className.includes("checkbox-on"):!1,collapsed:l==="toggle"?a&&a.tagName==="details"&&a.properties.open===void 0:!1},children:[]},"children");break}case"hr":{s.openNode({type:"block",id:Oe(),flavour:"affine:divider",props:{},children:[]},"children").closeNode();break}case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:o.node.tagName,text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(o.node)}},children:[]},"children").closeNode();break}case"br":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[]}},children:[]},"children").closeNode();break}}}),r.setLeave(async(o,s)=>{if(o.node.type==="element")switch(o.node.tagName){case"div":{o.parent?.type==="element"&&o.parent.tagName!=="li"&&Array.isArray(o.node.properties?.className)&&(o.node.properties.className.includes("affine-block-children-container")||o.node.properties.className.includes("indented"))&&s.closeNode();break}case"blockquote":{s.setGlobalContext("hast:blockquote",!1);break}case"p":{if(o.parent.type==="element"&&o.parent.children.length>o.index+1){const a=o.parent.children[o.index+1];if(a.type==="element"&&a.tagName==="div"&&Array.isArray(a.properties?.className)&&(a.properties.className.includes("affine-block-children-container")||a.properties.className.includes("indented")))break}s.closeNode();break}case"li":{s.closeNode();break}}}),r.walk(e,n)},this._deltaToHigglightHasts=async(e,n)=>{e=e.reduce((c,d)=>Uw(c,d,{force:!0}),[]),ok(e.length,1,"Delta length should be 1 in code block");const i=e[0];if(n==="Plain Text"||n==="Text"||!n)return[{type:"text",value:i.insert}];const r=n,o=await rS({langs:[r]}),s=`${i.insert}-${n}-light`,a=z2.get(s);let l;return a?l=a:(l=o.codeToThemedTokens(i.insert,r).reduce((c,d,u)=>u===0?d:[...c,{content:`
`,color:"inherit"},...d],[]),z2.set(s,l)),l.map(c=>({type:"element",tagName:"span",properties:{style:`word-wrap: break-word; color: ${c.color};`},children:[{type:"text",value:c.content}]}))},this._deltaToHast=e=>e.map(n=>{let i={type:"text",value:n.insert};return n.attributes&&(n.attributes.bold&&(i={type:"element",tagName:"strong",properties:{},children:[i]}),n.attributes.italic&&(i={type:"element",tagName:"em",properties:{},children:[i]}),n.attributes.code&&(i={type:"element",tagName:"code",properties:{},children:[i]}),n.attributes.strike&&(i={type:"element",tagName:"del",properties:{},children:[i]}),n.attributes.underline&&(i={type:"element",tagName:"u",properties:{},children:[i]}),n.attributes.link&&(i={type:"element",tagName:"a",properties:{href:n.attributes.link},children:[i]})),i}),this._hastToDeltaSpreaded=(e,n={trim:!0})=>{switch(n.trim===void 0&&(n.trim=!0),e.type){case"text":return n.trim?e.value.trim()?[{insert:e.value.trim()}]:[]:e.value?[{insert:e.value}]:[];case"element":switch(e.tagName){case"ol":case"ul":return[];case"span":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}));case"strong":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes,bold:!0},r)));case"em":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes,italic:!0},r)));case"code":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes,code:!0},r)));case"del":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes,strike:!0},r)));case"u":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes,underline:!0},r)));case"a":{const i=e.properties?.href;return typeof i!="string"?[]:e.children.flatMap(r=>this._hastToDeltaSpreaded(r,{trim:!1}).map(o=>(i.startsWith("http")&&(o.attributes={...o.attributes,link:i}),o)))}case"mark":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,{trim:!1}).map(r=>(r.attributes={...r.attributes},r)));case"br":return[{insert:`
`}]}}return"children"in e?e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n)):[]},this._hastToDelta=(e,n={trim:!0})=>this._hastToDeltaSpreaded(e,n).reduce((i,r)=>Uw(i,r),[])}async fromPageSnapshot(e){const{file:n,assetsIds:i}=await this.fromBlockSnapshot({snapshot:e.snapshot.blocks,assets:e.assets});return{file:n.replace("<!--BlockSuitePageTitlePlaceholder-->",`<h1>${e.snapshot.meta.title}</h1>`),assetsIds:i}}async fromBlockSnapshot(e){const n={type:"root",children:[{type:"doctype"}]},{ast:i,assetsIds:r}=await this._traverseSnapshot(e.snapshot,n,e.assets);return{file:this._astToHtml(i),assetsIds:r}}async fromSliceSnapshot(e){let n="";const i=[];for(const o of e.snapshot.content){const s={type:"root",children:[]},{ast:a,assetsIds:l}=await this._traverseSnapshot(o,s,e.assets);i.push(...l),n+=this._astToHtml(a)}return{file:n,assetsIds:i}}async toPageSnapshot(e){const n=this._htmlToAst(e.file),i=Qt(n,"title"),r={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return{type:"page",meta:{id:Oe(),title:go(i,"Untitled"),createDate:+new Date,tags:[]},blocks:{type:"block",id:Oe(),flavour:"affine:page",props:{title:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(i??{type:"text",value:"Untitled"})}},children:[{type:"block",id:Oe(),flavour:"affine:surface",props:{elements:{}},children:[]},await this._traverseHtml(n,r,e.assets)]}}}toBlockSnapshot(e){const n=this._htmlToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return this._traverseHtml(n,i,e.assets)}async toSliceSnapshot(e){const n=this._htmlToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]},r=await this._traverseHtml(n,i,e.assets);return r.children.length===0?null:{type:"slice",content:[r],pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId}}_htmlToAst(e){return jh().use(FE).parse(e)}}class cS extends kc{fromPageSnapshot(e){throw new Error("Method not implemented.")}fromBlockSnapshot(e){throw new Error("Method not implemented.")}fromSliceSnapshot(e){const n=[];for(const i of e.snapshot.content)if(i.type==="block"){const{flavour:r,props:o}=i;if(r==="affine:image"){const{sourceId:s}=o,a=e.assets?.getAssets().get(s);n.push(a)}}return Promise.resolve({file:n,assetsIds:[]})}toPageSnapshot(e){throw new Error("Method not implemented.")}toBlockSnapshot(e){throw new Error("Method not implemented.")}async toSliceSnapshot(e){const n=[];for(const i of e.file){const r=await _1(await i.arrayBuffer());e.assets?.getAssets().set(r,i),await e.assets?.writeToBlob(r),n.push({type:"block",flavour:"affine:image",id:Oe(),props:{sourceId:r},children:[]})}return n.length===0?null:{type:"slice",content:n,pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId}}}const KU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},QU=(t,e,n)=>{let i;const r=KU[t];return typeof r=="string"?i=r:e===1?i=r.one:i=r.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function s6(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const JU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},eV={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tV={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nV={date:s6({formats:JU,defaultWidth:"full"}),time:s6({formats:eV,defaultWidth:"full"}),dateTime:s6({formats:tV,defaultWidth:"full"})},iV={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},rV=(t,e,n,i)=>iV[t];function Uu(t){return(e,n)=>{const i=n?.context?String(n.context):"standalone";let r;if(i==="formatting"&&t.formattingValues){const s=t.defaultFormattingWidth||t.defaultWidth,a=n?.width?String(n.width):s;r=t.formattingValues[a]||t.formattingValues[s]}else{const s=t.defaultWidth,a=n?.width?String(n.width):t.defaultWidth;r=t.values[a]||t.values[s]}const o=t.argumentCallback?t.argumentCallback(e):e;return r[o]}}const oV={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},sV={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},aV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},uV=(t,e)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},hV={ordinalNumber:uV,era:Uu({values:oV,defaultWidth:"wide"}),quarter:Uu({values:sV,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Uu({values:aV,defaultWidth:"wide"}),day:Uu({values:lV,defaultWidth:"wide"}),dayPeriod:Uu({values:cV,defaultWidth:"wide",formattingValues:dV,defaultFormattingWidth:"wide"})};function Vu(t){return(e,n={})=>{const i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],o=e.match(r);if(!o)return null;const s=o[0],a=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?fV(a,u=>u.test(s)):pV(a,u=>u.test(s));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const d=e.slice(s.length);return{value:c,rest:d}}}function pV(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function fV(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function gV(t){return(e,n={})=>{const i=e.match(t.matchPattern);if(!i)return null;const r=i[0],o=e.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];s=n.valueCallback?n.valueCallback(s):s;const a=e.slice(r.length);return{value:s,rest:a}}}const mV=/^(\d+)(th|st|nd|rd)?/i,bV=/\d+/i,vV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yV={any:[/^b/i,/^(a|c)/i]},wV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xV={any:[/1/i,/2/i,/3/i,/4/i]},_V={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},kV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},EV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},SV={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},TV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},IV={ordinalNumber:gV({matchPattern:mV,parsePattern:bV,valueCallback:t=>parseInt(t,10)}),era:Vu({matchPatterns:vV,defaultMatchWidth:"wide",parsePatterns:yV,defaultParseWidth:"any"}),quarter:Vu({matchPatterns:wV,defaultMatchWidth:"wide",parsePatterns:xV,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Vu({matchPatterns:_V,defaultMatchWidth:"wide",parsePatterns:CV,defaultParseWidth:"any"}),day:Vu({matchPatterns:kV,defaultMatchWidth:"wide",parsePatterns:EV,defaultParseWidth:"any"}),dayPeriod:Vu({matchPatterns:SV,defaultMatchWidth:"any",parsePatterns:TV,defaultParseWidth:"any"})},LV={code:"en-US",formatDistance:QU,formatLong:nV,formatRelative:rV,localize:hV,match:IV,options:{weekStartsOn:0,firstWeekContainsDate:1}};let MV={};function Qg(){return MV}const dS=6048e5,PV=864e5;function xr(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function G2(t){const e=xr(t);return e.setHours(0,0,0,0),e}function Vw(t){const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function AV(t,e){const n=G2(t),i=G2(e),r=+n-Vw(n),o=+i-Vw(i);return Math.trunc((r-o)/PV)}function ql(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function $V(t){const e=xr(t),n=ql(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function BV(t){const e=xr(t);return AV(e,$V(e))+1}function Gh(t,e){const n=Qg(),i=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=xr(t),o=r.getDay(),s=(o<i?7:0)+o-i;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function Z2(t){return Gh(t,{weekStartsOn:1})}function uS(t){const e=xr(t),n=e.getFullYear(),i=ql(t,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const r=Z2(i),o=ql(t,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const s=Z2(o);return e.getTime()>=r.getTime()?n+1:e.getTime()>=s.getTime()?n:n-1}function DV(t){const e=uS(t),n=ql(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Z2(n)}function OV(t){const e=xr(t),n=+Z2(e)-+DV(e);return Math.trunc(n/dS)+1}function hS(t,e){const n=xr(t),i=n.getFullYear(),r=Qg(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=ql(t,0);s.setFullYear(i+1,0,o),s.setHours(0,0,0,0);const a=Gh(s,e),l=ql(t,0);l.setFullYear(i,0,o),l.setHours(0,0,0,0);const c=Gh(l,e);return n.getTime()>=a.getTime()?i+1:n.getTime()>=c.getTime()?i:i-1}function RV(t,e){const n=Qg(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=hS(t,e),o=ql(t,0);return o.setFullYear(r,0,i),o.setHours(0,0,0,0),Gh(o,e)}function NV(t,e){const n=xr(t),i=+Gh(n,e)-+RV(n,e);return Math.trunc(i/dS)+1}function Mt(t,e){const n=t<0?"-":"",i=Math.abs(t).toString().padStart(e,"0");return n+i}const na={y(t,e){const n=t.getFullYear(),i=n>0?n:1-n;return Mt(e==="yy"?i%100:i,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Mt(n+1,2)},d(t,e){return Mt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Mt(t.getHours()%12||12,e.length)},H(t,e){return Mt(t.getHours(),e.length)},m(t,e){return Mt(t.getMinutes(),e.length)},s(t,e){return Mt(t.getSeconds(),e.length)},S(t,e){const n=e.length,i=t.getMilliseconds(),r=Math.trunc(i*Math.pow(10,n-3));return Mt(r,e.length)}},e1={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},zw={G:function(t,e,n){const i=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const i=t.getFullYear(),r=i>0?i:1-i;return n.ordinalNumber(r,{unit:"year"})}return na.y(t,e)},Y:function(t,e,n,i){const r=hS(t,i),o=r>0?r:1-r;if(e==="YY"){const s=o%100;return Mt(s,2)}return e==="Yo"?n.ordinalNumber(o,{unit:"year"}):Mt(o,e.length)},R:function(t,e){const n=uS(t);return Mt(n,e.length)},u:function(t,e){const n=t.getFullYear();return Mt(n,e.length)},Q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return Mt(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return Mt(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){const i=t.getMonth();switch(e){case"M":case"MM":return na.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){const i=t.getMonth();switch(e){case"L":return String(i+1);case"LL":return Mt(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){const r=NV(t,i);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):Mt(r,e.length)},I:function(t,e,n){const i=OV(t);return e==="Io"?n.ordinalNumber(i,{unit:"week"}):Mt(i,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):na.d(t,e)},D:function(t,e,n){const i=BV(t);return e==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Mt(i,e.length)},E:function(t,e,n){const i=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){const r=t.getDay(),o=(r-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return Mt(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){const r=t.getDay(),o=(r-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return Mt(o,e.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const i=t.getDay(),r=i===0?7:i;switch(e){case"i":return String(r);case"ii":return Mt(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const i=t.getHours();let r;switch(i===12?r=e1.noon:i===0?r=e1.midnight:r=i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const i=t.getHours();let r;switch(i>=17?r=e1.evening:i>=12?r=e1.afternoon:i>=4?r=e1.morning:r=e1.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let i=t.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return na.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):na.H(t,e)},K:function(t,e,n){const i=t.getHours()%12;return e==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Mt(i,e.length)},k:function(t,e,n){let i=t.getHours();return i===0&&(i=24),e==="ko"?n.ordinalNumber(i,{unit:"hour"}):Mt(i,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):na.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):na.s(t,e)},S:function(t,e){return na.S(t,e)},X:function(t,e,n){const i=t.getTimezoneOffset();if(i===0)return"Z";switch(e){case"X":return Gw(i);case"XXXX":case"XX":return Al(i);case"XXXXX":case"XXX":default:return Al(i,":")}},x:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"x":return Gw(i);case"xxxx":case"xx":return Al(i);case"xxxxx":case"xxx":default:return Al(i,":")}},O:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+jw(i,":");case"OOOO":default:return"GMT"+Al(i,":")}},z:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+jw(i,":");case"zzzz":default:return"GMT"+Al(i,":")}},t:function(t,e,n){const i=Math.trunc(t.getTime()/1e3);return Mt(i,e.length)},T:function(t,e,n){const i=t.getTime();return Mt(i,e.length)}};function jw(t,e=""){const n=t>0?"-":"+",i=Math.abs(t),r=Math.trunc(i/60),o=i%60;return o===0?n+String(r):n+String(r)+e+Mt(o,2)}function Gw(t,e){return t%60===0?(t>0?"-":"+")+Mt(Math.abs(t)/60,2):Al(t,e)}function Al(t,e=""){const n=t>0?"-":"+",i=Math.abs(t),r=Mt(Math.trunc(i/60),2),o=Mt(i%60,2);return n+r+e+o}const Zw=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},pS=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},HV=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return Zw(t,e);let o;switch(i){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",Zw(i,e)).replace("{{time}}",pS(r,e))},FV={p:pS,P:HV},UV=/^D+$/,VV=/^Y+$/,zV=["D","DD","YY","YYYY"];function jV(t){return UV.test(t)}function GV(t){return VV.test(t)}function ZV(t,e,n){const i=WV(t,e,n);if(console.warn(i),zV.includes(t))throw new RangeError(i)}function WV(t,e,n){const i=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function qV(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function YV(t){if(!qV(t)&&typeof t!="number")return!1;const e=xr(t);return!isNaN(Number(e))}const XV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,KV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,QV=/^'([^]*?)'?$/,JV=/''/g,ez=/[a-zA-Z]/;function Zh(t,e,n){const i=Qg(),r=n?.locale??i.locale??LV,o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=xr(t);if(!YV(a))throw new RangeError("Invalid time value");let l=e.match(KV).map(d=>{const u=d[0];if(u==="p"||u==="P"){const h=FV[u];return h(d,r.formatLong)}return d}).join("").match(XV).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const u=d[0];if(u==="'")return{isToken:!1,value:tz(d)};if(zw[u])return{isToken:!0,value:d};if(u.match(ez))throw new RangeError("Format string contains an unescaped latin alphabet character `"+u+"`");return{isToken:!1,value:d}});r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:o,weekStartsOn:s,locale:r};return l.map(d=>{if(!d.isToken)return d.value;const u=d.value;(!n?.useAdditionalWeekYearTokens&&GV(u)||!n?.useAdditionalDayOfYearTokens&&jV(u))&&ZV(u,e,String(t));const h=zw[u[0]];return h(a,u,r.localize,c)}).join("")}function tz(t){const e=t.match(QV);return e?e[1].replace(JV,"'"):t}const nz={};function c9(t,e){const n=e||nz,i=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,r=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return fS(t,i,r)}function fS(t,e,n){if(iz(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return Ww(t.children,e,n)}return Array.isArray(t)?Ww(t,e,n):""}function Ww(t,e,n){const i=[];let r=-1;for(;++r<t.length;)i[r]=fS(t[r],e,n);return i.join("")}function iz(t){return!!(t&&typeof t=="object")}const qw=document.createElement("i");function d9(t){const e="&"+t+";";qw.innerHTML=e;const n=qw.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function er(t,e,n,i){const r=t.length;let o=0,s;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,n=n>0?n:0,i.length<1e4)s=Array.from(i),s.unshift(e,n),t.splice(...s);else for(n&&t.splice(e,n);o<i.length;)s=i.slice(o,o+1e4),s.unshift(e,0),t.splice(...s),o+=1e4,e+=1e4}function mr(t,e){return t.length>0?(er(t,t.length,0,e),t):e}const Yw={}.hasOwnProperty;function gS(t){const e={};let n=-1;for(;++n<t.length;)rz(e,t[n]);return e}function rz(t,e){let n;for(n in e){const r=(Yw.call(t,n)?t[n]:void 0)||(t[n]={}),o=e[n];let s;if(o)for(s in o){Yw.call(r,s)||(r[s]=[]);const a=o[s];oz(r[s],Array.isArray(a)?a:a?[a]:[])}}}function oz(t,e){let n=-1;const i=[];for(;++n<e.length;)(e[n].add==="after"?t:i).push(e[n]);er(t,0,0,i)}function mS(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function E1(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const sz=el(/\p{P}/u),mi=el(/[A-Za-z]/),Ai=el(/[\dA-Za-z]/),az=el(/[#-'*+\--9=?A-Z^-~]/);function W2(t){return t!==null&&(t<32||t===127)}const z7=el(/\d/),lz=el(/[\dA-Fa-f]/),bS=el(/[!-/:-@[-`{-~]/);function Ze(t){return t!==null&&t<-2}function Xt(t){return t!==null&&(t<0||t===32)}function ht(t){return t===-2||t===-1||t===32}function Jg(t){return bS(t)||sz(t)}const Yl=el(/\s/);function el(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function _t(t,e,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let o=0;return s;function s(l){return ht(l)?(t.enter(n),a(l)):e(l)}function a(l){return ht(l)&&o++<r?(t.consume(l),a):(t.exit(n),e(l))}}const cz={tokenize:dz};function dz(t){const e=t.attempt(this.parser.constructs.contentInitial,i,r);let n;return e;function i(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),_t(t,e,"linePrefix")}function r(a){return t.enter("paragraph"),o(a)}function o(a){const l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,s(a)}function s(a){if(a===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(a);return}return Ze(a)?(t.consume(a),t.exit("chunkText"),o):(t.consume(a),s)}}const uz={tokenize:hz},Xw={tokenize:pz};function hz(t){const e=this,n=[];let i=0,r,o,s;return a;function a(x){if(i<n.length){const T=n[i];return e.containerState=T[1],t.attempt(T[0].continuation,l,c)(x)}return c(x)}function l(x){if(i++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,r&&y();const T=e.events.length;let M=T,k;for(;M--;)if(e.events[M][0]==="exit"&&e.events[M][1].type==="chunkFlow"){k=e.events[M][1].end;break}m(i);let _=T;for(;_<e.events.length;)e.events[_][1].end=Object.assign({},k),_++;return er(e.events,M+1,0,e.events.slice(T)),e.events.length=_,c(x)}return a(x)}function c(x){if(i===n.length){if(!r)return h(x);if(r.currentConstruct&&r.currentConstruct.concrete)return g(x);e.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(Xw,d,u)(x)}function d(x){return r&&y(),m(i),h(x)}function u(x){return e.parser.lazy[e.now().line]=i!==n.length,s=e.now().offset,g(x)}function h(x){return e.containerState={},t.attempt(Xw,p,g)(x)}function p(x){return i++,n.push([e.currentConstruct,e.containerState]),h(x)}function g(x){if(x===null){r&&y(),m(0),t.consume(x);return}return r=r||e.parser.flow(e.now()),t.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:r}),f(x)}function f(x){if(x===null){v(t.exit("chunkFlow"),!0),m(0),t.consume(x);return}return Ze(x)?(t.consume(x),v(t.exit("chunkFlow")),i=0,e.interrupt=void 0,a):(t.consume(x),f)}function v(x,T){const M=e.sliceStream(x);if(T&&M.push(null),x.previous=o,o&&(o.next=x),o=x,r.defineSkip(x.start),r.write(M),e.parser.lazy[x.start.line]){let k=r.events.length;for(;k--;)if(r.events[k][1].start.offset<s&&(!r.events[k][1].end||r.events[k][1].end.offset>s))return;const _=e.events.length;let A=_,$,E;for(;A--;)if(e.events[A][0]==="exit"&&e.events[A][1].type==="chunkFlow"){if($){E=e.events[A][1].end;break}$=!0}for(m(i),k=_;k<e.events.length;)e.events[k][1].end=Object.assign({},E),k++;er(e.events,A+1,0,e.events.slice(_)),e.events.length=k}}function m(x){let T=n.length;for(;T-- >x;){const M=n[T];e.containerState=M[1],M[0].exit.call(e,t)}n.length=x}function y(){r.write([null]),o=void 0,r=void 0,e.containerState._closeFlow=void 0}}function pz(t,e,n){return _t(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function q2(t){if(t===null||Xt(t)||Yl(t))return 1;if(Jg(t))return 2}function e3(t,e,n){const i=[];let r=-1;for(;++r<t.length;){const o=t[r].resolveAll;o&&!i.includes(o)&&(e=o(e,n),i.push(o))}return e}const j7={name:"attention",tokenize:gz,resolveAll:fz};function fz(t,e){let n=-1,i,r,o,s,a,l,c,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(i=n;i--;)if(t[i][0]==="exit"&&t[i][1].type==="attentionSequence"&&t[i][1]._open&&e.sliceSerialize(t[i][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[i][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[i][1].end.offset-t[i][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[i][1].end.offset-t[i][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const u=Object.assign({},t[i][1].end),h=Object.assign({},t[n][1].start);Kw(u,-l),Kw(h,l),s={type:l>1?"strongSequence":"emphasisSequence",start:u,end:Object.assign({},t[i][1].end)},a={type:l>1?"strongSequence":"emphasisSequence",start:Object.assign({},t[n][1].start),end:h},o={type:l>1?"strongText":"emphasisText",start:Object.assign({},t[i][1].end),end:Object.assign({},t[n][1].start)},r={type:l>1?"strong":"emphasis",start:Object.assign({},s.start),end:Object.assign({},a.end)},t[i][1].end=Object.assign({},s.start),t[n][1].start=Object.assign({},a.end),c=[],t[i][1].end.offset-t[i][1].start.offset&&(c=mr(c,[["enter",t[i][1],e],["exit",t[i][1],e]])),c=mr(c,[["enter",r,e],["enter",s,e],["exit",s,e],["enter",o,e]]),c=mr(c,e3(e.parser.constructs.insideSpan.null,t.slice(i+1,n),e)),c=mr(c,[["exit",o,e],["enter",a,e],["exit",a,e],["exit",r,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,c=mr(c,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,er(t,i-1,n-i+3,c),n=i+c.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function gz(t,e){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=q2(i);let o;return s;function s(l){return o=l,t.enter("attentionSequence"),a(l)}function a(l){if(l===o)return t.consume(l),a;const c=t.exit("attentionSequence"),d=q2(l),u=!d||d===2&&r||n.includes(l),h=!r||r===2&&d||n.includes(i);return c._open=!!(o===42?u:u&&(r||!h)),c._close=!!(o===42?h:h&&(d||!u)),e(l)}}function Kw(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const mz={name:"autolink",tokenize:bz};function bz(t,e,n){let i=0;return r;function r(p){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),o}function o(p){return mi(p)?(t.consume(p),s):c(p)}function s(p){return p===43||p===45||p===46||Ai(p)?(i=1,a(p)):c(p)}function a(p){return p===58?(t.consume(p),i=0,l):(p===43||p===45||p===46||Ai(p))&&i++<32?(t.consume(p),a):(i=0,c(p))}function l(p){return p===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),e):p===null||p===32||p===60||W2(p)?n(p):(t.consume(p),l)}function c(p){return p===64?(t.consume(p),d):az(p)?(t.consume(p),c):n(p)}function d(p){return Ai(p)?u(p):n(p)}function u(p){return p===46?(t.consume(p),i=0,d):p===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),e):h(p)}function h(p){if((p===45||Ai(p))&&i++<63){const g=p===45?h:u;return t.consume(p),g}return n(p)}}const t3={tokenize:vz,partial:!0};function vz(t,e,n){return i;function i(o){return ht(o)?_t(t,r,"linePrefix")(o):r(o)}function r(o){return o===null||Ze(o)?e(o):n(o)}}const vS={name:"blockQuote",tokenize:yz,continuation:{tokenize:wz},exit:xz};function yz(t,e,n){const i=this;return r;function r(s){if(s===62){const a=i.containerState;return a.open||(t.enter("blockQuote",{_container:!0}),a.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(s),t.exit("blockQuoteMarker"),o}return n(s)}function o(s){return ht(s)?(t.enter("blockQuotePrefixWhitespace"),t.consume(s),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(s))}}function wz(t,e,n){const i=this;return r;function r(s){return ht(s)?_t(t,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):o(s)}function o(s){return t.attempt(vS,e,n)(s)}}function xz(t){t.exit("blockQuote")}const yS={name:"characterEscape",tokenize:_z};function _z(t,e,n){return i;function i(o){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(o),t.exit("escapeMarker"),r}function r(o){return bS(o)?(t.enter("characterEscapeValue"),t.consume(o),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(o)}}const wS={name:"characterReference",tokenize:Cz};function Cz(t,e,n){const i=this;let r=0,o,s;return a;function a(u){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(u),t.exit("characterReferenceMarker"),l}function l(u){return u===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(u),t.exit("characterReferenceMarkerNumeric"),c):(t.enter("characterReferenceValue"),o=31,s=Ai,d(u))}function c(u){return u===88||u===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(u),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),o=6,s=lz,d):(t.enter("characterReferenceValue"),o=7,s=z7,d(u))}function d(u){if(u===59&&r){const h=t.exit("characterReferenceValue");return s===Ai&&!d9(i.sliceSerialize(h))?n(u):(t.enter("characterReferenceMarker"),t.consume(u),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return s(u)&&r++<o?(t.consume(u),d):n(u)}}const Qw={tokenize:Ez,partial:!0},Jw={name:"codeFenced",tokenize:kz,concrete:!0};function kz(t,e,n){const i=this,r={tokenize:M,partial:!0};let o=0,s=0,a;return l;function l(k){return c(k)}function c(k){const _=i.events[i.events.length-1];return o=_&&_[1].type==="linePrefix"?_[2].sliceSerialize(_[1],!0).length:0,a=k,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(k)}function d(k){return k===a?(s++,t.consume(k),d):s<3?n(k):(t.exit("codeFencedFenceSequence"),ht(k)?_t(t,u,"whitespace")(k):u(k))}function u(k){return k===null||Ze(k)?(t.exit("codeFencedFence"),i.interrupt?e(k):t.check(Qw,f,T)(k)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),h(k))}function h(k){return k===null||Ze(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),u(k)):ht(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),_t(t,p,"whitespace")(k)):k===96&&k===a?n(k):(t.consume(k),h)}function p(k){return k===null||Ze(k)?u(k):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(k))}function g(k){return k===null||Ze(k)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),u(k)):k===96&&k===a?n(k):(t.consume(k),g)}function f(k){return t.attempt(r,T,v)(k)}function v(k){return t.enter("lineEnding"),t.consume(k),t.exit("lineEnding"),m}function m(k){return o>0&&ht(k)?_t(t,y,"linePrefix",o+1)(k):y(k)}function y(k){return k===null||Ze(k)?t.check(Qw,f,T)(k):(t.enter("codeFlowValue"),x(k))}function x(k){return k===null||Ze(k)?(t.exit("codeFlowValue"),y(k)):(t.consume(k),x)}function T(k){return t.exit("codeFenced"),e(k)}function M(k,_,A){let $=0;return E;function E(Z){return k.enter("lineEnding"),k.consume(Z),k.exit("lineEnding"),R}function R(Z){return k.enter("codeFencedFence"),ht(Z)?_t(k,I,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Z):I(Z)}function I(Z){return Z===a?(k.enter("codeFencedFenceSequence"),N(Z)):A(Z)}function N(Z){return Z===a?($++,k.consume(Z),N):$>=s?(k.exit("codeFencedFenceSequence"),ht(Z)?_t(k,P,"whitespace")(Z):P(Z)):A(Z)}function P(Z){return Z===null||Ze(Z)?(k.exit("codeFencedFence"),_(Z)):A(Z)}}}function Ez(t,e,n){const i=this;return r;function r(s){return s===null?n(s):(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),o)}function o(s){return i.parser.lazy[i.now().line]?n(s):e(s)}}const a6={name:"codeIndented",tokenize:Tz},Sz={tokenize:Iz,partial:!0};function Tz(t,e,n){const i=this;return r;function r(c){return t.enter("codeIndented"),_t(t,o,"linePrefix",5)(c)}function o(c){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?s(c):n(c)}function s(c){return c===null?l(c):Ze(c)?t.attempt(Sz,s,l)(c):(t.enter("codeFlowValue"),a(c))}function a(c){return c===null||Ze(c)?(t.exit("codeFlowValue"),s(c)):(t.consume(c),a)}function l(c){return t.exit("codeIndented"),e(c)}}function Iz(t,e,n){const i=this;return r;function r(s){return i.parser.lazy[i.now().line]?n(s):Ze(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),r):_t(t,o,"linePrefix",5)(s)}function o(s){const a=i.events[i.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(s):Ze(s)?r(s):n(s)}}const Lz={name:"codeText",tokenize:Az,resolve:Mz,previous:Pz};function Mz(t){let e=t.length-4,n=3,i,r;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(i=n;++i<e;)if(t[i][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(i=n-1,e++;++i<=e;)r===void 0?i!==e&&t[i][1].type!=="lineEnding"&&(r=i):(i===e||t[i][1].type==="lineEnding")&&(t[r][1].type="codeTextData",i!==r+2&&(t[r][1].end=t[i-1][1].end,t.splice(r+2,i-r-2),e-=i-r-2,i=r+2),r=void 0);return t}function Pz(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Az(t,e,n){let i=0,r,o;return s;function s(u){return t.enter("codeText"),t.enter("codeTextSequence"),a(u)}function a(u){return u===96?(t.consume(u),i++,a):(t.exit("codeTextSequence"),l(u))}function l(u){return u===null?n(u):u===32?(t.enter("space"),t.consume(u),t.exit("space"),l):u===96?(o=t.enter("codeTextSequence"),r=0,d(u)):Ze(u)?(t.enter("lineEnding"),t.consume(u),t.exit("lineEnding"),l):(t.enter("codeTextData"),c(u))}function c(u){return u===null||u===32||u===96||Ze(u)?(t.exit("codeTextData"),l(u)):(t.consume(u),c)}function d(u){return u===96?(t.consume(u),r++,d):r===i?(t.exit("codeTextSequence"),t.exit("codeText"),e(u)):(o.type="codeTextData",c(u))}}function xS(t){const e={};let n=-1,i,r,o,s,a,l,c;for(;++n<t.length;){for(;n in e;)n=e[n];if(i=t[n],n&&i[1].type==="chunkFlow"&&t[n-1][1].type==="listItemPrefix"&&(l=i[1]._tokenizer.events,o=0,o<l.length&&l[o][1].type==="lineEndingBlank"&&(o+=2),o<l.length&&l[o][1].type==="content"))for(;++o<l.length&&l[o][1].type!=="content";)l[o][1].type==="chunkText"&&(l[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(e,$z(t,n)),n=e[n],c=!0);else if(i[1]._container){for(o=n,r=void 0;o--&&(s=t[o],s[1].type==="lineEnding"||s[1].type==="lineEndingBlank");)s[0]==="enter"&&(r&&(t[r][1].type="lineEndingBlank"),s[1].type="lineEnding",r=o);r&&(i[1].end=Object.assign({},t[r][1].start),a=t.slice(r,n),a.unshift(i),er(t,r,n-r+1,a))}}return!c}function $z(t,e){const n=t[e][1],i=t[e][2];let r=e-1;const o=[],s=n._tokenizer||i.parser[n.contentType](n.start),a=s.events,l=[],c={};let d,u,h=-1,p=n,g=0,f=0;const v=[f];for(;p;){for(;t[++r][1]!==p;);o.push(r),p._tokenizer||(d=i.sliceStream(p),p.next||d.push(null),u&&s.defineSkip(p.start),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(d),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),u=p,p=p.next}for(p=n;++h<a.length;)a[h][0]==="exit"&&a[h-1][0]==="enter"&&a[h][1].type===a[h-1][1].type&&a[h][1].start.line!==a[h][1].end.line&&(f=h+1,v.push(f),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(s.events=[],p?(p._tokenizer=void 0,p.previous=void 0):v.pop(),h=v.length;h--;){const m=a.slice(v[h],v[h+1]),y=o.pop();l.unshift([y,y+m.length-1]),er(t,y,2,m)}for(h=-1;++h<l.length;)c[g+l[h][0]]=g+l[h][1],g+=l[h][1]-l[h][0]-1;return c}const Bz={tokenize:Rz,resolve:Oz},Dz={tokenize:Nz,partial:!0};function Oz(t){return xS(t),t}function Rz(t,e){let n;return i;function i(a){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),r(a)}function r(a){return a===null?o(a):Ze(a)?t.check(Dz,s,o)(a):(t.consume(a),r)}function o(a){return t.exit("chunkContent"),t.exit("content"),e(a)}function s(a){return t.consume(a),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}function Nz(t,e,n){const i=this;return r;function r(s){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),_t(t,o,"linePrefix")}function o(s){if(s===null||Ze(s))return n(s);const a=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(s):t.interrupt(i.parser.constructs.flow,n,e)(s)}}function _S(t,e,n,i,r,o,s,a,l){const c=l||Number.POSITIVE_INFINITY;let d=0;return u;function u(m){return m===60?(t.enter(i),t.enter(r),t.enter(o),t.consume(m),t.exit(o),h):m===null||m===32||m===41||W2(m)?n(m):(t.enter(i),t.enter(s),t.enter(a),t.enter("chunkString",{contentType:"string"}),f(m))}function h(m){return m===62?(t.enter(o),t.consume(m),t.exit(o),t.exit(r),t.exit(i),e):(t.enter(a),t.enter("chunkString",{contentType:"string"}),p(m))}function p(m){return m===62?(t.exit("chunkString"),t.exit(a),h(m)):m===null||m===60||Ze(m)?n(m):(t.consume(m),m===92?g:p)}function g(m){return m===60||m===62||m===92?(t.consume(m),p):p(m)}function f(m){return!d&&(m===null||m===41||Xt(m))?(t.exit("chunkString"),t.exit(a),t.exit(s),t.exit(i),e(m)):d<c&&m===40?(t.consume(m),d++,f):m===41?(t.consume(m),d--,f):m===null||m===32||m===40||W2(m)?n(m):(t.consume(m),m===92?v:f)}function v(m){return m===40||m===41||m===92?(t.consume(m),f):f(m)}}function CS(t,e,n,i,r,o){const s=this;let a=0,l;return c;function c(p){return t.enter(i),t.enter(r),t.consume(p),t.exit(r),t.enter(o),d}function d(p){return a>999||p===null||p===91||p===93&&!l||p===94&&!a&&"_hiddenFootnoteSupport"in s.parser.constructs?n(p):p===93?(t.exit(o),t.enter(r),t.consume(p),t.exit(r),t.exit(i),e):Ze(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),u(p))}function u(p){return p===null||p===91||p===93||Ze(p)||a++>999?(t.exit("chunkString"),d(p)):(t.consume(p),l||(l=!ht(p)),p===92?h:u)}function h(p){return p===91||p===92||p===93?(t.consume(p),a++,u):u(p)}}function kS(t,e,n,i,r,o){let s;return a;function a(h){return h===34||h===39||h===40?(t.enter(i),t.enter(r),t.consume(h),t.exit(r),s=h===40?41:h,l):n(h)}function l(h){return h===s?(t.enter(r),t.consume(h),t.exit(r),t.exit(i),e):(t.enter(o),c(h))}function c(h){return h===s?(t.exit(o),l(s)):h===null?n(h):Ze(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),_t(t,c,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(h))}function d(h){return h===s||h===null||Ze(h)?(t.exit("chunkString"),c(h)):(t.consume(h),h===92?u:d)}function u(h){return h===s||h===92?(t.consume(h),d):d(h)}}function Ih(t,e){let n;return i;function i(r){return Ze(r)?(t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),n=!0,i):ht(r)?_t(t,i,n?"linePrefix":"lineSuffix")(r):e(r)}}const Hz={name:"definition",tokenize:Uz},Fz={tokenize:Vz,partial:!0};function Uz(t,e,n){const i=this;let r;return o;function o(p){return t.enter("definition"),s(p)}function s(p){return CS.call(i,t,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function a(p){return r=E1(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),p===58?(t.enter("definitionMarker"),t.consume(p),t.exit("definitionMarker"),l):n(p)}function l(p){return Xt(p)?Ih(t,c)(p):c(p)}function c(p){return _S(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function d(p){return t.attempt(Fz,u,u)(p)}function u(p){return ht(p)?_t(t,h,"whitespace")(p):h(p)}function h(p){return p===null||Ze(p)?(t.exit("definition"),i.parser.defined.push(r),e(p)):n(p)}}function Vz(t,e,n){return i;function i(a){return Xt(a)?Ih(t,r)(a):n(a)}function r(a){return kS(t,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function o(a){return ht(a)?_t(t,s,"whitespace")(a):s(a)}function s(a){return a===null||Ze(a)?e(a):n(a)}}const zz={name:"hardBreakEscape",tokenize:jz};function jz(t,e,n){return i;function i(o){return t.enter("hardBreakEscape"),t.consume(o),r}function r(o){return Ze(o)?(t.exit("hardBreakEscape"),e(o)):n(o)}}const Gz={name:"headingAtx",tokenize:Wz,resolve:Zz};function Zz(t,e){let n=t.length-2,i=3,r,o;return t[i][1].type==="whitespace"&&(i+=2),n-2>i&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&t[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(r={type:"atxHeadingText",start:t[i][1].start,end:t[n][1].end},o={type:"chunkText",start:t[i][1].start,end:t[n][1].end,contentType:"text"},er(t,i,n-i+1,[["enter",r,e],["enter",o,e],["exit",o,e],["exit",r,e]])),t}function Wz(t,e,n){let i=0;return r;function r(d){return t.enter("atxHeading"),o(d)}function o(d){return t.enter("atxHeadingSequence"),s(d)}function s(d){return d===35&&i++<6?(t.consume(d),s):d===null||Xt(d)?(t.exit("atxHeadingSequence"),a(d)):n(d)}function a(d){return d===35?(t.enter("atxHeadingSequence"),l(d)):d===null||Ze(d)?(t.exit("atxHeading"),e(d)):ht(d)?_t(t,a,"whitespace")(d):(t.enter("atxHeadingText"),c(d))}function l(d){return d===35?(t.consume(d),l):(t.exit("atxHeadingSequence"),a(d))}function c(d){return d===null||d===35||Xt(d)?(t.exit("atxHeadingText"),a(d)):(t.consume(d),c)}}const qz=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ex=["pre","script","style","textarea"],Yz={name:"htmlFlow",tokenize:Jz,resolveTo:Qz,concrete:!0},Xz={tokenize:tj,partial:!0},Kz={tokenize:ej,partial:!0};function Qz(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function Jz(t,e,n){const i=this;let r,o,s,a,l;return c;function c(U){return d(U)}function d(U){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(U),u}function u(U){return U===33?(t.consume(U),h):U===47?(t.consume(U),o=!0,f):U===63?(t.consume(U),r=3,i.interrupt?e:H):mi(U)?(t.consume(U),s=String.fromCharCode(U),v):n(U)}function h(U){return U===45?(t.consume(U),r=2,p):U===91?(t.consume(U),r=5,a=0,g):mi(U)?(t.consume(U),r=4,i.interrupt?e:H):n(U)}function p(U){return U===45?(t.consume(U),i.interrupt?e:H):n(U)}function g(U){const Ee="CDATA[";return U===Ee.charCodeAt(a++)?(t.consume(U),a===Ee.length?i.interrupt?e:I:g):n(U)}function f(U){return mi(U)?(t.consume(U),s=String.fromCharCode(U),v):n(U)}function v(U){if(U===null||U===47||U===62||Xt(U)){const Ee=U===47,xe=s.toLowerCase();return!Ee&&!o&&ex.includes(xe)?(r=1,i.interrupt?e(U):I(U)):qz.includes(s.toLowerCase())?(r=6,Ee?(t.consume(U),m):i.interrupt?e(U):I(U)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(U):o?y(U):x(U))}return U===45||Ai(U)?(t.consume(U),s+=String.fromCharCode(U),v):n(U)}function m(U){return U===62?(t.consume(U),i.interrupt?e:I):n(U)}function y(U){return ht(U)?(t.consume(U),y):E(U)}function x(U){return U===47?(t.consume(U),E):U===58||U===95||mi(U)?(t.consume(U),T):ht(U)?(t.consume(U),x):E(U)}function T(U){return U===45||U===46||U===58||U===95||Ai(U)?(t.consume(U),T):M(U)}function M(U){return U===61?(t.consume(U),k):ht(U)?(t.consume(U),M):x(U)}function k(U){return U===null||U===60||U===61||U===62||U===96?n(U):U===34||U===39?(t.consume(U),l=U,_):ht(U)?(t.consume(U),k):A(U)}function _(U){return U===l?(t.consume(U),l=null,$):U===null||Ze(U)?n(U):(t.consume(U),_)}function A(U){return U===null||U===34||U===39||U===47||U===60||U===61||U===62||U===96||Xt(U)?M(U):(t.consume(U),A)}function $(U){return U===47||U===62||ht(U)?x(U):n(U)}function E(U){return U===62?(t.consume(U),R):n(U)}function R(U){return U===null||Ze(U)?I(U):ht(U)?(t.consume(U),R):n(U)}function I(U){return U===45&&r===2?(t.consume(U),pe):U===60&&r===1?(t.consume(U),Q):U===62&&r===4?(t.consume(U),ee):U===63&&r===3?(t.consume(U),H):U===93&&r===5?(t.consume(U),ue):Ze(U)&&(r===6||r===7)?(t.exit("htmlFlowData"),t.check(Xz,K,N)(U)):U===null||Ze(U)?(t.exit("htmlFlowData"),N(U)):(t.consume(U),I)}function N(U){return t.check(Kz,P,K)(U)}function P(U){return t.enter("lineEnding"),t.consume(U),t.exit("lineEnding"),Z}function Z(U){return U===null||Ze(U)?N(U):(t.enter("htmlFlowData"),I(U))}function pe(U){return U===45?(t.consume(U),H):I(U)}function Q(U){return U===47?(t.consume(U),s="",Le):I(U)}function Le(U){if(U===62){const Ee=s.toLowerCase();return ex.includes(Ee)?(t.consume(U),ee):I(U)}return mi(U)&&s.length<8?(t.consume(U),s+=String.fromCharCode(U),Le):I(U)}function ue(U){return U===93?(t.consume(U),H):I(U)}function H(U){return U===62?(t.consume(U),ee):U===45&&r===2?(t.consume(U),H):I(U)}function ee(U){return U===null||Ze(U)?(t.exit("htmlFlowData"),K(U)):(t.consume(U),ee)}function K(U){return t.exit("htmlFlow"),e(U)}}function ej(t,e,n){const i=this;return r;function r(s){return Ze(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),o):n(s)}function o(s){return i.parser.lazy[i.now().line]?n(s):e(s)}}function tj(t,e,n){return i;function i(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),t.attempt(t3,e,n)}}const nj={name:"htmlText",tokenize:ij};function ij(t,e,n){const i=this;let r,o,s;return a;function a(H){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(H),l}function l(H){return H===33?(t.consume(H),c):H===47?(t.consume(H),M):H===63?(t.consume(H),x):mi(H)?(t.consume(H),A):n(H)}function c(H){return H===45?(t.consume(H),d):H===91?(t.consume(H),o=0,g):mi(H)?(t.consume(H),y):n(H)}function d(H){return H===45?(t.consume(H),p):n(H)}function u(H){return H===null?n(H):H===45?(t.consume(H),h):Ze(H)?(s=u,Q(H)):(t.consume(H),u)}function h(H){return H===45?(t.consume(H),p):u(H)}function p(H){return H===62?pe(H):H===45?h(H):u(H)}function g(H){const ee="CDATA[";return H===ee.charCodeAt(o++)?(t.consume(H),o===ee.length?f:g):n(H)}function f(H){return H===null?n(H):H===93?(t.consume(H),v):Ze(H)?(s=f,Q(H)):(t.consume(H),f)}function v(H){return H===93?(t.consume(H),m):f(H)}function m(H){return H===62?pe(H):H===93?(t.consume(H),m):f(H)}function y(H){return H===null||H===62?pe(H):Ze(H)?(s=y,Q(H)):(t.consume(H),y)}function x(H){return H===null?n(H):H===63?(t.consume(H),T):Ze(H)?(s=x,Q(H)):(t.consume(H),x)}function T(H){return H===62?pe(H):x(H)}function M(H){return mi(H)?(t.consume(H),k):n(H)}function k(H){return H===45||Ai(H)?(t.consume(H),k):_(H)}function _(H){return Ze(H)?(s=_,Q(H)):ht(H)?(t.consume(H),_):pe(H)}function A(H){return H===45||Ai(H)?(t.consume(H),A):H===47||H===62||Xt(H)?$(H):n(H)}function $(H){return H===47?(t.consume(H),pe):H===58||H===95||mi(H)?(t.consume(H),E):Ze(H)?(s=$,Q(H)):ht(H)?(t.consume(H),$):pe(H)}function E(H){return H===45||H===46||H===58||H===95||Ai(H)?(t.consume(H),E):R(H)}function R(H){return H===61?(t.consume(H),I):Ze(H)?(s=R,Q(H)):ht(H)?(t.consume(H),R):$(H)}function I(H){return H===null||H===60||H===61||H===62||H===96?n(H):H===34||H===39?(t.consume(H),r=H,N):Ze(H)?(s=I,Q(H)):ht(H)?(t.consume(H),I):(t.consume(H),P)}function N(H){return H===r?(t.consume(H),r=void 0,Z):H===null?n(H):Ze(H)?(s=N,Q(H)):(t.consume(H),N)}function P(H){return H===null||H===34||H===39||H===60||H===61||H===96?n(H):H===47||H===62||Xt(H)?$(H):(t.consume(H),P)}function Z(H){return H===47||H===62||Xt(H)?$(H):n(H)}function pe(H){return H===62?(t.consume(H),t.exit("htmlTextData"),t.exit("htmlText"),e):n(H)}function Q(H){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(H),t.exit("lineEnding"),Le}function Le(H){return ht(H)?_t(t,ue,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(H):ue(H)}function ue(H){return t.enter("htmlTextData"),s(H)}}const u9={name:"labelEnd",tokenize:cj,resolveTo:lj,resolveAll:aj},rj={tokenize:dj},oj={tokenize:uj},sj={tokenize:hj};function aj(t){let e=-1;for(;++e<t.length;){const n=t[e][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(t.splice(e+1,n.type==="labelImage"?4:2),n.type="data",e++)}return t}function lj(t,e){let n=t.length,i=0,r,o,s,a;for(;n--;)if(r=t[n][1],o){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;t[n][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(s){if(t[n][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(o=n,r.type!=="labelLink")){i=2;break}}else r.type==="labelEnd"&&(s=n);const l={type:t[o][1].type==="labelLink"?"link":"image",start:Object.assign({},t[o][1].start),end:Object.assign({},t[t.length-1][1].end)},c={type:"label",start:Object.assign({},t[o][1].start),end:Object.assign({},t[s][1].end)},d={type:"labelText",start:Object.assign({},t[o+i+2][1].end),end:Object.assign({},t[s-2][1].start)};return a=[["enter",l,e],["enter",c,e]],a=mr(a,t.slice(o+1,o+i+3)),a=mr(a,[["enter",d,e]]),a=mr(a,e3(e.parser.constructs.insideSpan.null,t.slice(o+i+4,s-3),e)),a=mr(a,[["exit",d,e],t[s-2],t[s-1],["exit",c,e]]),a=mr(a,t.slice(s+1)),a=mr(a,[["exit",l,e]]),er(t,o,t.length,a),t}function cj(t,e,n){const i=this;let r=i.events.length,o,s;for(;r--;)if((i.events[r][1].type==="labelImage"||i.events[r][1].type==="labelLink")&&!i.events[r][1]._balanced){o=i.events[r][1];break}return a;function a(h){return o?o._inactive?u(h):(s=i.parser.defined.includes(E1(i.sliceSerialize({start:o.end,end:i.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(h),t.exit("labelMarker"),t.exit("labelEnd"),l):n(h)}function l(h){return h===40?t.attempt(rj,d,s?d:u)(h):h===91?t.attempt(oj,d,s?c:u)(h):s?d(h):u(h)}function c(h){return t.attempt(sj,d,u)(h)}function d(h){return e(h)}function u(h){return o._balanced=!0,n(h)}}function dj(t,e,n){return i;function i(u){return t.enter("resource"),t.enter("resourceMarker"),t.consume(u),t.exit("resourceMarker"),r}function r(u){return Xt(u)?Ih(t,o)(u):o(u)}function o(u){return u===41?d(u):_S(t,s,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(u)}function s(u){return Xt(u)?Ih(t,l)(u):d(u)}function a(u){return n(u)}function l(u){return u===34||u===39||u===40?kS(t,c,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(u):d(u)}function c(u){return Xt(u)?Ih(t,d)(u):d(u)}function d(u){return u===41?(t.enter("resourceMarker"),t.consume(u),t.exit("resourceMarker"),t.exit("resource"),e):n(u)}}function uj(t,e,n){const i=this;return r;function r(a){return CS.call(i,t,o,s,"reference","referenceMarker","referenceString")(a)}function o(a){return i.parser.defined.includes(E1(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?e(a):n(a)}function s(a){return n(a)}}function hj(t,e,n){return i;function i(o){return t.enter("reference"),t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),r}function r(o){return o===93?(t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),t.exit("reference"),e):n(o)}}const pj={name:"labelStartImage",tokenize:fj,resolveAll:u9.resolveAll};function fj(t,e,n){const i=this;return r;function r(a){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(a),t.exit("labelImageMarker"),o}function o(a){return a===91?(t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelImage"),s):n(a)}function s(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(a):e(a)}}const gj={name:"labelStartLink",tokenize:mj,resolveAll:u9.resolveAll};function mj(t,e,n){const i=this;return r;function r(s){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(s),t.exit("labelMarker"),t.exit("labelLink"),o}function o(s){return s===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(s):e(s)}}const l6={name:"lineEnding",tokenize:bj};function bj(t,e){return n;function n(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),_t(t,e,"linePrefix")}}const s2={name:"thematicBreak",tokenize:vj};function vj(t,e,n){let i=0,r;return o;function o(c){return t.enter("thematicBreak"),s(c)}function s(c){return r=c,a(c)}function a(c){return c===r?(t.enter("thematicBreakSequence"),l(c)):i>=3&&(c===null||Ze(c))?(t.exit("thematicBreak"),e(c)):n(c)}function l(c){return c===r?(t.consume(c),i++,l):(t.exit("thematicBreakSequence"),ht(c)?_t(t,a,"whitespace")(c):a(c))}}const Ii={name:"list",tokenize:xj,continuation:{tokenize:_j},exit:kj},yj={tokenize:Ej,partial:!0},wj={tokenize:Cj,partial:!0};function xj(t,e,n){const i=this,r=i.events[i.events.length-1];let o=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,s=0;return a;function a(p){const g=i.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!i.containerState.marker||p===i.containerState.marker:z7(p)){if(i.containerState.type||(i.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),p===42||p===45?t.check(s2,n,c)(p):c(p);if(!i.interrupt||p===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(p)}return n(p)}function l(p){return z7(p)&&++s<10?(t.consume(p),l):(!i.interrupt||s<2)&&(i.containerState.marker?p===i.containerState.marker:p===41||p===46)?(t.exit("listItemValue"),c(p)):n(p)}function c(p){return t.enter("listItemMarker"),t.consume(p),t.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||p,t.check(t3,i.interrupt?n:d,t.attempt(yj,h,u))}function d(p){return i.containerState.initialBlankLine=!0,o++,h(p)}function u(p){return ht(p)?(t.enter("listItemPrefixWhitespace"),t.consume(p),t.exit("listItemPrefixWhitespace"),h):n(p)}function h(p){return i.containerState.size=o+i.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(p)}}function _j(t,e,n){const i=this;return i.containerState._closeFlow=void 0,t.check(t3,r,o);function r(a){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,_t(t,e,"listItemIndent",i.containerState.size+1)(a)}function o(a){return i.containerState.furtherBlankLines||!ht(a)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,s(a)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,t.attempt(wj,e,s)(a))}function s(a){return i.containerState._closeFlow=!0,i.interrupt=void 0,_t(t,t.attempt(Ii,e,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function Cj(t,e,n){const i=this;return _t(t,r,"listItemIndent",i.containerState.size+1);function r(o){const s=i.events[i.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===i.containerState.size?e(o):n(o)}}function kj(t){t.exit(this.containerState.type)}function Ej(t,e,n){const i=this;return _t(t,r,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(o){const s=i.events[i.events.length-1];return!ht(o)&&s&&s[1].type==="listItemPrefixWhitespace"?e(o):n(o)}}const tx={name:"setextUnderline",tokenize:Tj,resolveTo:Sj};function Sj(t,e){let n=t.length,i,r,o;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){i=n;break}t[n][1].type==="paragraph"&&(r=n)}else t[n][1].type==="content"&&t.splice(n,1),!o&&t[n][1].type==="definition"&&(o=n);const s={type:"setextHeading",start:Object.assign({},t[r][1].start),end:Object.assign({},t[t.length-1][1].end)};return t[r][1].type="setextHeadingText",o?(t.splice(r,0,["enter",s,e]),t.splice(o+1,0,["exit",t[i][1],e]),t[i][1].end=Object.assign({},t[o][1].end)):t[i][1]=s,t.push(["exit",s,e]),t}function Tj(t,e,n){const i=this;let r;return o;function o(c){let d=i.events.length,u;for(;d--;)if(i.events[d][1].type!=="lineEnding"&&i.events[d][1].type!=="linePrefix"&&i.events[d][1].type!=="content"){u=i.events[d][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||u)?(t.enter("setextHeadingLine"),r=c,s(c)):n(c)}function s(c){return t.enter("setextHeadingLineSequence"),a(c)}function a(c){return c===r?(t.consume(c),a):(t.exit("setextHeadingLineSequence"),ht(c)?_t(t,l,"lineSuffix")(c):l(c))}function l(c){return c===null||Ze(c)?(t.exit("setextHeadingLine"),e(c)):n(c)}}const Ij={tokenize:Lj};function Lj(t){const e=this,n=t.attempt(t3,i,t.attempt(this.parser.constructs.flowInitial,r,_t(t,t.attempt(this.parser.constructs.flow,r,t.attempt(Bz,r)),"linePrefix")));return n;function i(o){if(o===null){t.consume(o);return}return t.enter("lineEndingBlank"),t.consume(o),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function r(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const Mj={resolveAll:SS()},Pj=ES("string"),Aj=ES("text");function ES(t){return{tokenize:e,resolveAll:SS(t==="text"?$j:void 0)};function e(n){const i=this,r=this.parser.constructs[t],o=n.attempt(r,s,a);return s;function s(d){return c(d)?o(d):a(d)}function a(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),l}function l(d){return c(d)?(n.exit("data"),o(d)):(n.consume(d),l)}function c(d){if(d===null)return!0;const u=r[d];let h=-1;if(u)for(;++h<u.length;){const p=u[h];if(!p.previous||p.previous.call(i,i.previous))return!0}return!1}}}function SS(t){return e;function e(n,i){let r=-1,o;for(;++r<=n.length;)o===void 0?n[r]&&n[r][1].type==="data"&&(o=r,r++):(!n[r]||n[r][1].type!=="data")&&(r!==o+2&&(n[o][1].end=n[r-1][1].end,n.splice(o+2,r-o-2),r=o+2),o=void 0);return t?t(n,i):n}}function $j(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const i=t[n-1][1],r=e.sliceStream(i);let o=r.length,s=-1,a=0,l;for(;o--;){const c=r[o];if(typeof c=="string"){for(s=c.length;c.charCodeAt(s-1)===32;)a++,s--;if(s)break;s=-1}else if(c===-2)l=!0,a++;else if(c!==-1){o++;break}}if(a){const c={type:n===t.length||l||a<2?"lineSuffix":"hardBreakTrailing",start:{line:i.end.line,column:i.end.column-a,offset:i.end.offset-a,_index:i.start._index+o,_bufferIndex:o?s:i.start._bufferIndex+s},end:Object.assign({},i.end)};i.end=Object.assign({},c.start),i.start.offset===i.end.offset?Object.assign(i,c):(t.splice(n,0,["enter",c,e],["exit",c,e]),n+=2)}n++}return t}function Bj(t,e,n){let i=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const r={},o=[];let s=[],a=[];const l={consume:y,enter:x,exit:T,attempt:_(M),check:_(k),interrupt:_(k,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:t,sliceStream:p,sliceSerialize:h,now:g,defineSkip:f,write:u};let d=e.tokenize.call(c,l);return e.resolveAll&&o.push(e),c;function u(R){return s=mr(s,R),v(),s[s.length-1]!==null?[]:(A(e,0),c.events=e3(o,c.events,c),c.events)}function h(R,I){return Oj(p(R),I)}function p(R){return Dj(s,R)}function g(){const{line:R,column:I,offset:N,_index:P,_bufferIndex:Z}=i;return{line:R,column:I,offset:N,_index:P,_bufferIndex:Z}}function f(R){r[R.line]=R.column,E()}function v(){let R;for(;i._index<s.length;){const I=s[i._index];if(typeof I=="string")for(R=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===R&&i._bufferIndex<I.length;)m(I.charCodeAt(i._bufferIndex));else m(I)}}function m(R){d=d(R)}function y(R){Ze(R)?(i.line++,i.column=1,i.offset+=R===-3?2:1,E()):R!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===s[i._index].length&&(i._bufferIndex=-1,i._index++)),c.previous=R}function x(R,I){const N=I||{};return N.type=R,N.start=g(),c.events.push(["enter",N,c]),a.push(N),N}function T(R){const I=a.pop();return I.end=g(),c.events.push(["exit",I,c]),I}function M(R,I){A(R,I.from)}function k(R,I){I.restore()}function _(R,I){return N;function N(P,Z,pe){let Q,Le,ue,H;return Array.isArray(P)?K(P):"tokenize"in P?K([P]):ee(P);function ee(Pe){return ze;function ze(le){const He=le!==null&&Pe[le],Ne=le!==null&&Pe.null,Ue=[...Array.isArray(He)?He:He?[He]:[],...Array.isArray(Ne)?Ne:Ne?[Ne]:[]];return K(Ue)(le)}}function K(Pe){return Q=Pe,Le=0,Pe.length===0?pe:U(Pe[Le])}function U(Pe){return ze;function ze(le){return H=$(),ue=Pe,Pe.partial||(c.currentConstruct=Pe),Pe.name&&c.parser.constructs.disable.null.includes(Pe.name)?xe():Pe.tokenize.call(I?Object.assign(Object.create(c),I):c,l,Ee,xe)(le)}}function Ee(Pe){return R(ue,H),Z}function xe(Pe){return H.restore(),++Le<Q.length?U(Q[Le]):pe}}}function A(R,I){R.resolveAll&&!o.includes(R)&&o.push(R),R.resolve&&er(c.events,I,c.events.length-I,R.resolve(c.events.slice(I),c)),R.resolveTo&&(c.events=R.resolveTo(c.events,c))}function $(){const R=g(),I=c.previous,N=c.currentConstruct,P=c.events.length,Z=Array.from(a);return{restore:pe,from:P};function pe(){i=R,c.previous=I,c.currentConstruct=N,c.events.length=P,a=Z,E()}}function E(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function Dj(t,e){const n=e.start._index,i=e.start._bufferIndex,r=e.end._index,o=e.end._bufferIndex;let s;if(n===r)s=[t[n].slice(i,o)];else{if(s=t.slice(n,r),i>-1){const a=s[0];typeof a=="string"?s[0]=a.slice(i):s.shift()}o>0&&s.push(t[r].slice(0,o))}return s}function Oj(t,e){let n=-1;const i=[];let r;for(;++n<t.length;){const o=t[n];let s;if(typeof o=="string")s=o;else switch(o){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=e?" ":"	";break}case-1:{if(!e&&r)continue;s=" ";break}default:s=String.fromCharCode(o)}r=o===-2,i.push(s)}return i.join("")}const Rj={42:Ii,43:Ii,45:Ii,48:Ii,49:Ii,50:Ii,51:Ii,52:Ii,53:Ii,54:Ii,55:Ii,56:Ii,57:Ii,62:vS},Nj={91:Hz},Hj={[-2]:a6,[-1]:a6,32:a6},Fj={35:Gz,42:s2,45:[tx,s2],60:Yz,61:tx,95:s2,96:Jw,126:Jw},Uj={38:wS,92:yS},Vj={[-5]:l6,[-4]:l6,[-3]:l6,33:pj,38:wS,42:j7,60:[mz,nj],91:gj,92:[zz,yS],93:u9,95:j7,96:Lz},zj={null:[j7,Mj]},jj={null:[42,95]},Gj={null:[]},Zj=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:jj,contentInitial:Nj,disable:Gj,document:Rj,flow:Fj,flowInitial:Hj,insideSpan:zj,string:Uj,text:Vj},Symbol.toStringTag,{value:"Module"}));function Wj(t){const n=gS([Zj,...(t||{}).extensions||[]]),i={defined:[],lazy:{},constructs:n,content:r(cz),document:r(uz),flow:r(Ij),string:r(Pj),text:r(Aj)};return i;function r(o){return s;function s(a){return Bj(i,o,a)}}}function qj(t){for(;!xS(t););return t}const nx=/[\0\t\n\r]/g;function Yj(){let t=1,e="",n=!0,i;return r;function r(o,s,a){const l=[];let c,d,u,h,p;for(o=e+(typeof o=="string"?o.toString():new TextDecoder(s||void 0).decode(o)),u=0,e="",n&&(o.charCodeAt(0)===65279&&u++,n=void 0);u<o.length;){if(nx.lastIndex=u,c=nx.exec(o),h=c&&c.index!==void 0?c.index:o.length,p=o.charCodeAt(h),!c){e=o.slice(u);break}if(p===10&&u===h&&i)l.push(-3),i=void 0;else switch(i&&(l.push(-5),i=void 0),u<h&&(l.push(o.slice(u,h)),t+=h-u),p){case 0:{l.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,l.push(-2);t++<d;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:i=!0,t=1}u=h+1}return a&&(i&&l.push(-5),e&&l.push(e),l.push(null)),l}}const Xj=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function TS(t){return t.replace(Xj,Kj)}function Kj(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const r=n.charCodeAt(1),o=r===120||r===88;return mS(n.slice(o?2:1),o?16:10)}return d9(n)||t}const IS={}.hasOwnProperty;function Qj(t,e,n){return typeof e!="string"&&(n=e,e=void 0),Jj(n)(qj(Wj(n).document().write(Yj()(t,e,!0))))}function Jj(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(j),autolinkProtocol:$,autolinkEmail:$,atxHeading:o(B),blockQuote:o(He),characterEscape:$,characterReference:$,codeFenced:o(Ne),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:o(Ne,s),codeText:o(Ue,s),codeTextData:$,data:$,codeFlowValue:$,definition:o(lt),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:o(et),hardBreakEscape:o(_e),hardBreakTrailing:o(_e),htmlFlow:o(fe,s),htmlFlowData:$,htmlText:o(fe,s),htmlTextData:$,image:o(G),label:s,link:o(j),listItem:o(Ce),listItemValue:h,listOrdered:o(re,u),listUnordered:o(re),paragraph:o(Se),reference:U,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:o(B),strong:o(oe),thematicBreak:o(Te)},exit:{atxHeading:l(),atxHeadingSequence:M,autolink:l(),autolinkEmail:le,autolinkProtocol:ze,blockQuote:l(),characterEscapeValue:E,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:Pe,codeFenced:l(v),codeFencedFence:f,codeFencedFenceInfo:p,codeFencedFenceMeta:g,codeFlowValue:E,codeIndented:l(m),codeText:l(Z),codeTextData:E,data:E,definition:l(),definitionDestinationString:T,definitionLabelString:y,definitionTitleString:x,emphasis:l(),hardBreakEscape:l(I),hardBreakTrailing:l(I),htmlFlow:l(N),htmlFlowData:E,htmlText:l(P),htmlTextData:E,image:l(Q),label:ue,labelText:Le,lineEnding:R,link:l(pe),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:Ee,resourceDestinationString:H,resourceTitleString:ee,resource:K,setextHeading:l(A),setextHeadingLineSequence:_,setextHeadingText:k,strong:l(),thematicBreak:l()}};LS(e,(t||{}).mdastExtensions||[]);const n={};return i;function i(Y){let be={type:"root",children:[]};const O={stack:[be],tokenStack:[],config:e,enter:a,exit:c,buffer:s,resume:d,data:n},C=[];let S=-1;for(;++S<Y.length;)if(Y[S][1].type==="listOrdered"||Y[S][1].type==="listUnordered")if(Y[S][0]==="enter")C.push(S);else{const V=C.pop();S=r(Y,V,S)}for(S=-1;++S<Y.length;){const V=e[Y[S][0]];IS.call(V,Y[S][1].type)&&V[Y[S][1].type].call(Object.assign({sliceSerialize:Y[S][2].sliceSerialize},O),Y[S][1])}if(O.tokenStack.length>0){const V=O.tokenStack[O.tokenStack.length-1];(V[1]||ix).call(O,void 0,V[0])}for(be.position={start:ia(Y.length>0?Y[0][1].start:{line:1,column:1,offset:0}),end:ia(Y.length>0?Y[Y.length-2][1].end:{line:1,column:1,offset:0})},S=-1;++S<e.transforms.length;)be=e.transforms[S](be)||be;return be}function r(Y,be,O){let C=be-1,S=-1,V=!1,J,de,ve,Ye;for(;++C<=O;){const ot=Y[C];switch(ot[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ot[0]==="enter"?S++:S--,Ye=void 0;break}case"lineEndingBlank":{ot[0]==="enter"&&(J&&!Ye&&!S&&!ve&&(ve=C),Ye=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ye=void 0}if(!S&&ot[0]==="enter"&&ot[1].type==="listItemPrefix"||S===-1&&ot[0]==="exit"&&(ot[1].type==="listUnordered"||ot[1].type==="listOrdered")){if(J){let rt=C;for(de=void 0;rt--;){const ft=Y[rt];if(ft[1].type==="lineEnding"||ft[1].type==="lineEndingBlank"){if(ft[0]==="exit")continue;de&&(Y[de][1].type="lineEndingBlank",V=!0),ft[1].type="lineEnding",de=rt}else if(!(ft[1].type==="linePrefix"||ft[1].type==="blockQuotePrefix"||ft[1].type==="blockQuotePrefixWhitespace"||ft[1].type==="blockQuoteMarker"||ft[1].type==="listItemIndent"))break}ve&&(!de||ve<de)&&(J._spread=!0),J.end=Object.assign({},de?Y[de][1].start:ot[1].end),Y.splice(de||C,0,["exit",J,ot[2]]),C++,O++}if(ot[1].type==="listItemPrefix"){const rt={type:"listItem",_spread:!1,start:Object.assign({},ot[1].start),end:void 0};J=rt,Y.splice(C,0,["enter",rt,ot[2]]),C++,O++,ve=void 0,Ye=!0}}}return Y[be][1]._spread=V,O}function o(Y,be){return O;function O(C){a.call(this,Y(C),C),be&&be.call(this,C)}}function s(){this.stack.push({type:"fragment",children:[]})}function a(Y,be,O){this.stack[this.stack.length-1].children.push(Y),this.stack.push(Y),this.tokenStack.push([be,O]),Y.position={start:ia(be.start),end:void 0}}function l(Y){return be;function be(O){Y&&Y.call(this,O),c.call(this,O)}}function c(Y,be){const O=this.stack.pop(),C=this.tokenStack.pop();if(C)C[0].type!==Y.type&&(be?be.call(this,Y,C[0]):(C[1]||ix).call(this,Y,C[0]));else throw new Error("Cannot close `"+Y.type+"` ("+Sh({start:Y.start,end:Y.end})+"): its not open");O.position.end=ia(Y.end)}function d(){return c9(this.stack.pop())}function u(){this.data.expectingFirstListItemValue=!0}function h(Y){if(this.data.expectingFirstListItemValue){const be=this.stack[this.stack.length-2];be.start=Number.parseInt(this.sliceSerialize(Y),10),this.data.expectingFirstListItemValue=void 0}}function p(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.lang=Y}function g(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.meta=Y}function f(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.value=Y.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function m(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.value=Y.replace(/(\r?\n|\r)$/g,"")}function y(Y){const be=this.resume(),O=this.stack[this.stack.length-1];O.label=be,O.identifier=E1(this.sliceSerialize(Y)).toLowerCase()}function x(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.title=Y}function T(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.url=Y}function M(Y){const be=this.stack[this.stack.length-1];if(!be.depth){const O=this.sliceSerialize(Y).length;be.depth=O}}function k(){this.data.setextHeadingSlurpLineEnding=!0}function _(Y){const be=this.stack[this.stack.length-1];be.depth=this.sliceSerialize(Y).codePointAt(0)===61?1:2}function A(){this.data.setextHeadingSlurpLineEnding=void 0}function $(Y){const O=this.stack[this.stack.length-1].children;let C=O[O.length-1];(!C||C.type!=="text")&&(C=se(),C.position={start:ia(Y.start),end:void 0},O.push(C)),this.stack.push(C)}function E(Y){const be=this.stack.pop();be.value+=this.sliceSerialize(Y),be.position.end=ia(Y.end)}function R(Y){const be=this.stack[this.stack.length-1];if(this.data.atHardBreak){const O=be.children[be.children.length-1];O.position.end=ia(Y.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(be.type)&&($.call(this,Y),E.call(this,Y))}function I(){this.data.atHardBreak=!0}function N(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.value=Y}function P(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.value=Y}function Z(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.value=Y}function pe(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const be=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=be,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function Q(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const be=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=be,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function Le(Y){const be=this.sliceSerialize(Y),O=this.stack[this.stack.length-2];O.label=TS(be),O.identifier=E1(be).toLowerCase()}function ue(){const Y=this.stack[this.stack.length-1],be=this.resume(),O=this.stack[this.stack.length-1];if(this.data.inReference=!0,O.type==="link"){const C=Y.children;O.children=C}else O.alt=be}function H(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.url=Y}function ee(){const Y=this.resume(),be=this.stack[this.stack.length-1];be.title=Y}function K(){this.data.inReference=void 0}function U(){this.data.referenceType="collapsed"}function Ee(Y){const be=this.resume(),O=this.stack[this.stack.length-1];O.label=be,O.identifier=E1(this.sliceSerialize(Y)).toLowerCase(),this.data.referenceType="full"}function xe(Y){this.data.characterReferenceType=Y.type}function Pe(Y){const be=this.sliceSerialize(Y),O=this.data.characterReferenceType;let C;O?(C=mS(be,O==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):C=d9(be);const S=this.stack.pop();S.value+=C,S.position.end=ia(Y.end)}function ze(Y){E.call(this,Y);const be=this.stack[this.stack.length-1];be.url=this.sliceSerialize(Y)}function le(Y){E.call(this,Y);const be=this.stack[this.stack.length-1];be.url="mailto:"+this.sliceSerialize(Y)}function He(){return{type:"blockquote",children:[]}}function Ne(){return{type:"code",lang:null,meta:null,value:""}}function Ue(){return{type:"inlineCode",value:""}}function lt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function et(){return{type:"emphasis",children:[]}}function B(){return{type:"heading",depth:0,children:[]}}function _e(){return{type:"break"}}function fe(){return{type:"html",value:""}}function G(){return{type:"image",title:null,url:"",alt:null}}function j(){return{type:"link",title:null,url:"",children:[]}}function re(Y){return{type:"list",ordered:Y.type==="listOrdered",start:null,spread:Y._spread,children:[]}}function Ce(Y){return{type:"listItem",spread:Y._spread,checked:null,children:[]}}function Se(){return{type:"paragraph",children:[]}}function oe(){return{type:"strong",children:[]}}function se(){return{type:"text",value:""}}function Te(){return{type:"thematicBreak"}}}function ia(t){return{line:t.line,column:t.column,offset:t.offset}}function LS(t,e){let n=-1;for(;++n<e.length;){const i=e[n];Array.isArray(i)?LS(t,i):eG(t,i)}}function eG(t,e){let n;for(n in e)if(IS.call(e,n))switch(n){case"canContainEols":{const i=e[n];i&&t[n].push(...i);break}case"transforms":{const i=e[n];i&&t[n].push(...i);break}case"enter":case"exit":{const i=e[n];i&&Object.assign(t[n],i);break}}}function ix(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Sh({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Sh({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Sh({start:e.start,end:e.end})+") is still open")}function tG(t){const e=this;e.parser=n;function n(i){return Qj(i,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}const nG={}.hasOwnProperty;function MS(t,e){let n=-1,i;if(e.extensions)for(;++n<e.extensions.length;)MS(t,e.extensions[n]);for(i in e)if(nG.call(e,i))switch(i){case"extensions":break;case"unsafe":{rx(t[i],e[i]);break}case"join":{rx(t[i],e[i]);break}case"handlers":{iG(t[i],e[i]);break}default:t.options[i]=e[i]}return t}function rx(t,e){e&&t.push(...e)}function iG(t,e){e&&Object.assign(t,e)}function rG(t,e,n,i){const r=n.enter("blockquote"),o=n.createTracker(i);o.move("> "),o.shift(2);const s=n.indentLines(n.containerFlow(t,o.current()),oG);return r(),s}function oG(t,e,n){return">"+(n?"":" ")+t}function PS(t,e){return ox(t,e.inConstruct,!0)&&!ox(t,e.notInConstruct,!1)}function ox(t,e,n){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return n;let i=-1;for(;++i<e.length;)if(t.includes(e[i]))return!0;return!1}function sx(t,e,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&PS(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function sG(t,e){const n=String(t);let i=n.indexOf(e),r=i,o=0,s=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++o>s&&(s=o):o=1,r=i+e.length,i=n.indexOf(e,r);return s}function G7(t,e){return!!(e.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function aG(t){const e=t.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function lG(t,e,n,i){const r=aG(n),o=t.value||"",s=r==="`"?"GraveAccent":"Tilde";if(G7(t,n)){const u=n.enter("codeIndented"),h=n.indentLines(o,cG);return u(),h}const a=n.createTracker(i),l=r.repeat(Math.max(sG(o,r)+1,3)),c=n.enter("codeFenced");let d=a.move(l);if(t.lang){const u=n.enter(`codeFencedLang${s}`);d+=a.move(n.safe(t.lang,{before:d,after:" ",encode:["`"],...a.current()})),u()}if(t.lang&&t.meta){const u=n.enter(`codeFencedMeta${s}`);d+=a.move(" "),d+=a.move(n.safe(t.meta,{before:d,after:`
`,encode:["`"],...a.current()})),u()}return d+=a.move(`
`),o&&(d+=a.move(o+`
`)),d+=a.move(l),c(),d}function cG(t,e,n){return(n?"":"    ")+t}function h9(t){const e=t.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function dG(t,e,n,i){const r=h9(n),o=r==='"'?"Quote":"Apostrophe",s=n.enter("definition");let a=n.enter("label");const l=n.createTracker(i);let c=l.move("[");return c+=l.move(n.safe(n.associationId(t),{before:c,after:"]",...l.current()})),c+=l.move("]: "),a(),!t.url||/[\0- \u007F]/.test(t.url)?(a=n.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(n.safe(t.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(a=n.enter("destinationRaw"),c+=l.move(n.safe(t.url,{before:c,after:t.title?" ":`
`,...l.current()}))),a(),t.title&&(a=n.enter(`title${o}`),c+=l.move(" "+r),c+=l.move(n.safe(t.title,{before:c,after:r,...l.current()})),c+=l.move(r),a()),s(),c}function uG(t){const e=t.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}AS.peek=hG;function AS(t,e,n,i){const r=uG(n),o=n.enter("emphasis"),s=n.createTracker(i);let a=s.move(r);return a+=s.move(n.containerPhrasing(t,{before:a,after:r,...s.current()})),a+=s.move(r),o(),a}function hG(t,e,n){return n.options.emphasis||"*"}const n3=function(t){if(t==null)return mG;if(typeof t=="function")return i3(t);if(typeof t=="object")return Array.isArray(t)?pG(t):fG(t);if(typeof t=="string")return gG(t);throw new Error("Expected function, string, or object as test")};function pG(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=n3(t[n]);return i3(i);function i(...r){let o=-1;for(;++o<e.length;)if(e[o].apply(this,r))return!0;return!1}}function fG(t){const e=t;return i3(n);function n(i){const r=i;let o;for(o in t)if(r[o]!==e[o])return!1;return!0}}function gG(t){return i3(e);function e(n){return n&&n.type===t}}function i3(t){return e;function e(n,i,r){return!!(bG(n)&&t.call(this,n,typeof i=="number"?i:void 0,r||void 0))}}function mG(){return!0}function bG(t){return t!==null&&typeof t=="object"&&"type"in t}const $S=[],vG=!0,Z7=!1,yG="skip";function BS(t,e,n,i){let r;typeof e=="function"&&typeof n!="function"?(i=n,n=e):r=e;const o=n3(r),s=i?-1:1;a(t,void 0,[])();function a(l,c,d){const u=l&&typeof l=="object"?l:{};if(typeof u.type=="string"){const p=typeof u.tagName=="string"?u.tagName:typeof u.name=="string"?u.name:void 0;Object.defineProperty(h,"name",{value:"node ("+(l.type+(p?"<"+p+">":""))+")"})}return h;function h(){let p=$S,g,f,v;if((!e||o(l,c,d[d.length-1]||void 0))&&(p=wG(n(l,d)),p[0]===Z7))return p;if("children"in l&&l.children){const m=l;if(m.children&&p[0]!==yG)for(f=(i?m.children.length:-1)+s,v=d.concat(m);f>-1&&f<m.children.length;){const y=m.children[f];if(g=a(y,f,v)(),g[0]===Z7)return g;f=typeof g[1]=="number"?g[1]:f+s}}return p}}}function wG(t){return Array.isArray(t)?t:typeof t=="number"?[vG,t]:t==null?$S:[t]}function xG(t,e,n,i){let r,o,s;typeof e=="function"&&typeof n!="function"?(o=void 0,s=e,r=n):(o=e,s=n,r=i),BS(t,o,a,r);function a(l,c){const d=c[c.length-1],u=d?d.children.indexOf(l):void 0;return s(l,u,d)}}function DS(t,e){let n=!1;return xG(t,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,Z7}),!!((!t.depth||t.depth<3)&&c9(t)&&(e.options.setext||n))}function _G(t,e,n,i){const r=Math.max(Math.min(6,t.depth||1),1),o=n.createTracker(i);if(DS(t,n)){const d=n.enter("headingSetext"),u=n.enter("phrasing"),h=n.containerPhrasing(t,{...o.current(),before:`
`,after:`
`});return u(),d(),h+`
`+(r===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const s="#".repeat(r),a=n.enter("headingAtx"),l=n.enter("phrasing");o.move(s+" ");let c=n.containerPhrasing(t,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(c)&&(c="&#x"+c.charCodeAt(0).toString(16).toUpperCase()+";"+c.slice(1)),c=c?s+" "+c:s,n.options.closeAtx&&(c+=" "+s),l(),a(),c}OS.peek=CG;function OS(t){return t.value||""}function CG(){return"<"}RS.peek=kG;function RS(t,e,n,i){const r=h9(n),o=r==='"'?"Quote":"Apostrophe",s=n.enter("image");let a=n.enter("label");const l=n.createTracker(i);let c=l.move("![");return c+=l.move(n.safe(t.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),a(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(a=n.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(n.safe(t.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(a=n.enter("destinationRaw"),c+=l.move(n.safe(t.url,{before:c,after:t.title?" ":")",...l.current()}))),a(),t.title&&(a=n.enter(`title${o}`),c+=l.move(" "+r),c+=l.move(n.safe(t.title,{before:c,after:r,...l.current()})),c+=l.move(r),a()),c+=l.move(")"),s(),c}function kG(){return"!"}NS.peek=EG;function NS(t,e,n,i){const r=t.referenceType,o=n.enter("imageReference");let s=n.enter("label");const a=n.createTracker(i);let l=a.move("![");const c=n.safe(t.alt,{before:l,after:"]",...a.current()});l+=a.move(c+"]["),s();const d=n.stack;n.stack=[],s=n.enter("reference");const u=n.safe(n.associationId(t),{before:l,after:"]",...a.current()});return s(),n.stack=d,o(),r==="full"||!c||c!==u?l+=a.move(u+"]"):r==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function EG(){return"!"}HS.peek=SG;function HS(t,e,n){let i=t.value||"",r="`",o=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<n.unsafe.length;){const s=n.unsafe[o],a=n.compilePattern(s);let l;if(s.atBreak)for(;l=a.exec(i);){let c=l.index;i.charCodeAt(c)===10&&i.charCodeAt(c-1)===13&&c--,i=i.slice(0,c)+" "+i.slice(l.index+1)}}return r+i+r}function SG(){return"`"}function FS(t,e){const n=c9(t);return!!(!e.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(n===t.url||"mailto:"+n===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}US.peek=TG;function US(t,e,n,i){const r=h9(n),o=r==='"'?"Quote":"Apostrophe",s=n.createTracker(i);let a,l;if(FS(t,n)){const d=n.stack;n.stack=[],a=n.enter("autolink");let u=s.move("<");return u+=s.move(n.containerPhrasing(t,{before:u,after:">",...s.current()})),u+=s.move(">"),a(),n.stack=d,u}a=n.enter("link"),l=n.enter("label");let c=s.move("[");return c+=s.move(n.containerPhrasing(t,{before:c,after:"](",...s.current()})),c+=s.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),c+=s.move("<"),c+=s.move(n.safe(t.url,{before:c,after:">",...s.current()})),c+=s.move(">")):(l=n.enter("destinationRaw"),c+=s.move(n.safe(t.url,{before:c,after:t.title?" ":")",...s.current()}))),l(),t.title&&(l=n.enter(`title${o}`),c+=s.move(" "+r),c+=s.move(n.safe(t.title,{before:c,after:r,...s.current()})),c+=s.move(r),l()),c+=s.move(")"),a(),c}function TG(t,e,n){return FS(t,n)?"<":"["}VS.peek=IG;function VS(t,e,n,i){const r=t.referenceType,o=n.enter("linkReference");let s=n.enter("label");const a=n.createTracker(i);let l=a.move("[");const c=n.containerPhrasing(t,{before:l,after:"]",...a.current()});l+=a.move(c+"]["),s();const d=n.stack;n.stack=[],s=n.enter("reference");const u=n.safe(n.associationId(t),{before:l,after:"]",...a.current()});return s(),n.stack=d,o(),r==="full"||!c||c!==u?l+=a.move(u+"]"):r==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function IG(){return"["}function p9(t){const e=t.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function LG(t){const e=p9(t),n=t.options.bulletOther;if(!n)return e==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+n+"`) to be different");return n}function MG(t){const e=t.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function zS(t){const e=t.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function PG(t,e,n,i){const r=n.enter("list"),o=n.bulletCurrent;let s=t.ordered?MG(n):p9(n);const a=t.ordered?s==="."?")":".":LG(n);let l=e&&n.bulletLastUsed?s===n.bulletLastUsed:!1;if(!t.ordered){const d=t.children?t.children[0]:void 0;if((s==="*"||s==="-")&&d&&(!d.children||!d.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(l=!0),zS(n)===s&&d){let u=-1;for(;++u<t.children.length;){const h=t.children[u];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(s=a),n.bulletCurrent=s;const c=n.containerFlow(t,i);return n.bulletLastUsed=s,n.bulletCurrent=o,r(),c}function AG(t){const e=t.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function $G(t,e,n,i){const r=AG(n);let o=n.bulletCurrent||p9(n);e&&e.type==="list"&&e.ordered&&(o=(typeof e.start=="number"&&e.start>-1?e.start:1)+(n.options.incrementListMarker===!1?0:e.children.indexOf(t))+o);let s=o.length+1;(r==="tab"||r==="mixed"&&(e&&e.type==="list"&&e.spread||t.spread))&&(s=Math.ceil(s/4)*4);const a=n.createTracker(i);a.move(o+" ".repeat(s-o.length)),a.shift(s);const l=n.enter("listItem"),c=n.indentLines(n.containerFlow(t,a.current()),d);return l(),c;function d(u,h,p){return h?(p?"":" ".repeat(s))+u:(p?o:o+" ".repeat(s-o.length))+u}}function BG(t,e,n,i){const r=n.enter("paragraph"),o=n.enter("phrasing"),s=n.containerPhrasing(t,i);return o(),r(),s}const DG=n3(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","link","linkReference","strong","text"]);function OG(t,e,n,i){return(t.children.some(function(s){return DG(s)})?n.containerPhrasing:n.containerFlow).call(n,t,i)}function RG(t){const e=t.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}jS.peek=NG;function jS(t,e,n,i){const r=RG(n),o=n.enter("strong"),s=n.createTracker(i);let a=s.move(r+r);return a+=s.move(n.containerPhrasing(t,{before:a,after:r,...s.current()})),a+=s.move(r+r),o(),a}function NG(t,e,n){return n.options.strong||"*"}function HG(t,e,n,i){return n.safe(t.value,i)}function FG(t){const e=t.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function UG(t,e,n){const i=(zS(n)+(n.options.ruleSpaces?" ":"")).repeat(FG(n));return n.options.ruleSpaces?i.slice(0,-1):i}const f9={blockquote:rG,break:sx,code:lG,definition:dG,emphasis:AS,hardBreak:sx,heading:_G,html:OS,image:RS,imageReference:NS,inlineCode:HS,link:US,linkReference:VS,list:PG,listItem:$G,paragraph:BG,root:OG,strong:jS,text:HG,thematicBreak:UG},VG=[zG];function zG(t,e,n,i){if(e.type==="code"&&G7(e,i)&&(t.type==="list"||t.type===e.type&&G7(t,i)))return!1;if("spread"in n&&typeof n.spread=="boolean")return t.type==="paragraph"&&(t.type===e.type||e.type==="definition"||e.type==="heading"&&DS(e,i))?void 0:n.spread?1:0}const _l=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],jG=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:_l},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:_l},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:_l},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:_l},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:_l},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:_l},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:_l},{atBreak:!0,character:"~"}];function GG(t){return t.label||!t.identifier?t.label||"":TS(t.identifier)}function ZG(t){if(!t._compiled){const e=(t.atBreak?"[\\r\\n][\\t ]*":"")+(t.before?"(?:"+t.before+")":"");t._compiled=new RegExp((e?"("+e+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(t.character)?"\\":"")+t.character+(t.after?"(?:"+t.after+")":""),"g")}return t._compiled}function WG(t,e,n){const i=e.indexStack,r=t.children||[],o=[];let s=-1,a=n.before;i.push(-1);let l=e.createTracker(n);for(;++s<r.length;){const c=r[s];let d;if(i[i.length-1]=s,s+1<r.length){let u=e.handle.handlers[r[s+1].type];u&&u.peek&&(u=u.peek),d=u?u(r[s+1],t,e,{before:"",after:"",...l.current()}).charAt(0):""}else d=n.after;o.length>0&&(a==="\r"||a===`
`)&&c.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),a=" ",l=e.createTracker(n),l.move(o.join(""))),o.push(l.move(e.handle(c,t,e,{...l.current(),before:a,after:d}))),a=o[o.length-1].slice(-1)}return i.pop(),o.join("")}function qG(t,e,n){const i=e.indexStack,r=t.children||[],o=e.createTracker(n),s=[];let a=-1;for(i.push(-1);++a<r.length;){const l=r[a];i[i.length-1]=a,s.push(o.move(e.handle(l,t,e,{before:`
`,after:`
`,...o.current()}))),l.type!=="list"&&(e.bulletLastUsed=void 0),a<r.length-1&&s.push(o.move(YG(l,r[a+1],t,e)))}return i.pop(),s.join("")}function YG(t,e,n,i){let r=i.join.length;for(;r--;){const o=i.join[r](t,e,n,i);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const XG=/\r?\n|\r/g;function KG(t,e){const n=[];let i=0,r=0,o;for(;o=XG.exec(t);)s(t.slice(i,o.index)),n.push(o[0]),i=o.index+o[0].length,r++;return s(t.slice(i)),n.join("");function s(a){n.push(e(a,r,!a))}}function QG(t,e,n){const i=(n.before||"")+(e||"")+(n.after||""),r=[],o=[],s={};let a=-1;for(;++a<t.unsafe.length;){const d=t.unsafe[a];if(!PS(t.stack,d))continue;const u=t.compilePattern(d);let h;for(;h=u.exec(i);){const p="before"in d||!!d.atBreak,g="after"in d,f=h.index+(p?h[1].length:0);r.includes(f)?(s[f].before&&!p&&(s[f].before=!1),s[f].after&&!g&&(s[f].after=!1)):(r.push(f),s[f]={before:p,after:g})}}r.sort(JG);let l=n.before?n.before.length:0;const c=i.length-(n.after?n.after.length:0);for(a=-1;++a<r.length;){const d=r[a];d<l||d>=c||d+1<c&&r[a+1]===d+1&&s[d].after&&!s[d+1].before&&!s[d+1].after||r[a-1]===d-1&&s[d].before&&!s[d-1].before&&!s[d-1].after||(l!==d&&o.push(ax(i.slice(l,d),"\\")),l=d,/[!-/:-@[-`{-~]/.test(i.charAt(d))&&(!n.encode||!n.encode.includes(i.charAt(d)))?o.push("\\"):(o.push("&#x"+i.charCodeAt(d).toString(16).toUpperCase()+";"),l++))}return o.push(ax(i.slice(l,c),n.after)),o.join("")}function JG(t,e){return t-e}function ax(t,e){const n=/\\(?=[!-/:-@[-`{-~])/g,i=[],r=[],o=t+e;let s=-1,a=0,l;for(;l=n.exec(o);)i.push(l.index);for(;++s<i.length;)a!==i[s]&&r.push(t.slice(a,i[s])),r.push("\\"),a=i[s];return r.push(t.slice(a)),r.join("")}function eZ(t){const e=t||{},n=e.now||{};let i=e.lineShift||0,r=n.line||1,o=n.column||1;return{move:l,current:s,shift:a};function s(){return{now:{line:r,column:o},lineShift:i}}function a(c){i+=c}function l(c){const d=c||"",u=d.split(/\r?\n|\r/g),h=u[u.length-1];return r+=u.length-1,o=u.length===1?o+h.length:1+h.length+i,d}}function tZ(t,e={}){const n={enter:r,indentLines:KG,associationId:GG,containerPhrasing:oZ,containerFlow:sZ,createTracker:eZ,compilePattern:ZG,safe:aZ,stack:[],unsafe:[...jG],join:[...VG],handlers:{...f9},options:{},indexStack:[],handle:void 0};MS(n,e),n.options.tightDefinitions&&n.join.push(rZ),n.handle=UE("type",{invalid:nZ,unknown:iZ,handlers:n.handlers});let i=n.handle(t,void 0,n,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return i&&i.charCodeAt(i.length-1)!==10&&i.charCodeAt(i.length-1)!==13&&(i+=`
`),i;function r(o){return n.stack.push(o),s;function s(){n.stack.pop()}}}function nZ(t){throw new Error("Cannot handle value `"+t+"`, expected node")}function iZ(t){const e=t;throw new Error("Cannot handle unknown node `"+e.type+"`")}function rZ(t,e){if(t.type==="definition"&&t.type===e.type)return 0}function oZ(t,e){return WG(t,this,e)}function sZ(t,e){return qG(t,this,e)}function aZ(t,e){return QG(this,t,e)}function lZ(t){const e=this;e.compiler=n;function n(i){return tZ(i,{...e.data("settings"),...t,extensions:e.data("toMarkdownExtensions")||[]})}}function cZ(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function dZ(t,e,n){const r=n3((n||{}).ignore||[]),o=uZ(e);let s=-1;for(;++s<o.length;)BS(t,"text",a);function a(c,d){let u=-1,h;for(;++u<d.length;){const p=d[u],g=h?h.children:void 0;if(r(p,g?g.indexOf(p):void 0,h))return;h=p}if(h)return l(c,d)}function l(c,d){const u=d[d.length-1],h=o[s][0],p=o[s][1];let g=0;const v=u.children.indexOf(c);let m=!1,y=[];h.lastIndex=0;let x=h.exec(c.value);for(;x;){const T=x.index,M={index:x.index,input:x.input,stack:[...d,c]};let k=p(...x,M);if(typeof k=="string"&&(k=k.length>0?{type:"text",value:k}:void 0),k===!1?h.lastIndex=T+1:(g!==T&&y.push({type:"text",value:c.value.slice(g,T)}),Array.isArray(k)?y.push(...k):k&&y.push(k),g=T+x[0].length,m=!0),!h.global)break;x=h.exec(c.value)}return m?(g<c.value.length&&y.push({type:"text",value:c.value.slice(g)}),u.children.splice(v,1,...y)):y=[c],v+y.length}}function uZ(t){const e=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!t[0]||Array.isArray(t[0])?t:[t];let i=-1;for(;++i<n.length;){const r=n[i];e.push([hZ(r[0]),pZ(r[1])])}return e}function hZ(t){return typeof t=="string"?new RegExp(cZ(t),"g"):t}function pZ(t){return typeof t=="function"?t:function(){return t}}function fZ(){return{transforms:[wZ],enter:{literalAutolink:gZ,literalAutolinkEmail:c6,literalAutolinkHttp:c6,literalAutolinkWww:c6},exit:{literalAutolink:yZ,literalAutolinkEmail:vZ,literalAutolinkHttp:mZ,literalAutolinkWww:bZ}}}function gZ(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function c6(t){this.config.enter.autolinkProtocol.call(this,t)}function mZ(t){this.config.exit.autolinkProtocol.call(this,t)}function bZ(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(t)}function vZ(t){this.config.exit.autolinkEmail.call(this,t)}function yZ(t){this.exit(t)}function wZ(t){dZ(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,xZ],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,_Z]],{ignore:["link","linkReference"]})}function xZ(t,e,n,i,r){let o="";if(!GS(r)||(/^w/i.test(e)&&(n=e+n,e="",o="http://"),!CZ(n)))return!1;const s=kZ(n+i);if(!s[0])return!1;const a={type:"link",title:null,url:o+e+s[0],children:[{type:"text",value:e+s[0]}]};return s[1]?[a,{type:"text",value:s[1]}]:a}function _Z(t,e,n,i){return!GS(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+n,children:[{type:"text",value:e+"@"+n}]}}function CZ(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function kZ(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let n=e[0],i=n.indexOf(")");const r=U2(t,"(");let o=U2(t,")");for(;i!==-1&&r>o;)t+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),o++;return[t,n]}function GS(t,e){const n=t.input.charCodeAt(t.index-1);return(t.index===0||Yl(n)||Jg(n))&&(!e||n!==47)}const EZ=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];ZS.peek=MZ;function SZ(){return{canContainEols:["delete"],enter:{strikethrough:IZ},exit:{strikethrough:LZ}}}function TZ(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:EZ}],handlers:{delete:ZS}}}function IZ(t){this.enter({type:"delete",children:[]},t)}function LZ(t){this.exit(t)}function ZS(t,e,n,i){const r=n.createTracker(i),o=n.enter("strikethrough");let s=r.move("~~");return s+=n.containerPhrasing(t,{...r.current(),before:s,after:"~"}),s+=r.move("~~"),o(),s}function MZ(){return"~"}function PZ(t,e={}){const n=(e.align||[]).concat(),i=e.stringLength||$Z,r=[],o=[],s=[],a=[];let l=0,c=-1;for(;++c<t.length;){const g=[],f=[];let v=-1;for(t[c].length>l&&(l=t[c].length);++v<t[c].length;){const m=AZ(t[c][v]);if(e.alignDelimiters!==!1){const y=i(m);f[v]=y,(a[v]===void 0||y>a[v])&&(a[v]=y)}g.push(m)}o[c]=g,s[c]=f}let d=-1;if(typeof n=="object"&&"length"in n)for(;++d<l;)r[d]=lx(n[d]);else{const g=lx(n);for(;++d<l;)r[d]=g}d=-1;const u=[],h=[];for(;++d<l;){const g=r[d];let f="",v="";g===99?(f=":",v=":"):g===108?f=":":g===114&&(v=":");let m=e.alignDelimiters===!1?1:Math.max(1,a[d]-f.length-v.length);const y=f+"-".repeat(m)+v;e.alignDelimiters!==!1&&(m=f.length+m+v.length,m>a[d]&&(a[d]=m),h[d]=m),u[d]=y}o.splice(1,0,u),s.splice(1,0,h),c=-1;const p=[];for(;++c<o.length;){const g=o[c],f=s[c];d=-1;const v=[];for(;++d<l;){const m=g[d]||"";let y="",x="";if(e.alignDelimiters!==!1){const T=a[d]-(f[d]||0),M=r[d];M===114?y=" ".repeat(T):M===99?T%2?(y=" ".repeat(T/2+.5),x=" ".repeat(T/2-.5)):(y=" ".repeat(T/2),x=y):x=" ".repeat(T)}e.delimiterStart!==!1&&!d&&v.push("|"),e.padding!==!1&&!(e.alignDelimiters===!1&&m==="")&&(e.delimiterStart!==!1||d)&&v.push(" "),e.alignDelimiters!==!1&&v.push(y),v.push(m),e.alignDelimiters!==!1&&v.push(x),e.padding!==!1&&v.push(" "),(e.delimiterEnd!==!1||d!==l-1)&&v.push("|")}p.push(e.delimiterEnd===!1?v.join("").replace(/ +$/,""):v.join(""))}return p.join(`
`)}function AZ(t){return t==null?"":String(t)}function $Z(t){return t.length}function lx(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function BZ(){return{enter:{table:DZ,tableData:cx,tableHeader:cx,tableRow:RZ},exit:{codeText:NZ,table:OZ,tableData:d6,tableHeader:d6,tableRow:d6}}}function DZ(t){const e=t._align;this.enter({type:"table",align:e.map(function(n){return n==="none"?null:n}),children:[]},t),this.data.inTable=!0}function OZ(t){this.exit(t),this.data.inTable=void 0}function RZ(t){this.enter({type:"tableRow",children:[]},t)}function d6(t){this.exit(t)}function cx(t){this.enter({type:"tableCell",children:[]},t)}function NZ(t){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,HZ));const n=this.stack[this.stack.length-1];n.type,n.value=e,this.exit(t)}function HZ(t,e){return e==="|"?e:t}function FZ(t){const e=t||{},n=e.tableCellPadding,i=e.tablePipeAlign,r=e.stringLength,o=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:s,tableCell:l,tableRow:a}};function s(p,g,f,v){return c(d(p,f,v),p.align)}function a(p,g,f,v){const m=u(p,f,v),y=c([m]);return y.slice(0,y.indexOf(`
`))}function l(p,g,f,v){const m=f.enter("tableCell"),y=f.enter("phrasing"),x=f.containerPhrasing(p,{...v,before:o,after:o});return y(),m(),x}function c(p,g){return PZ(p,{align:g,alignDelimiters:i,padding:n,stringLength:r})}function d(p,g,f){const v=p.children;let m=-1;const y=[],x=g.enter("table");for(;++m<v.length;)y[m]=u(v[m],g,f);return x(),y}function u(p,g,f){const v=p.children;let m=-1;const y=[],x=g.enter("tableRow");for(;++m<v.length;)y[m]=l(v[m],p,g,f);return x(),y}function h(p,g,f){let v=f9.inlineCode(p,g,f);return f.stack.includes("tableCell")&&(v=v.replace(/\|/g,"\\$&")),v}}function UZ(){return{exit:{taskListCheckValueChecked:dx,taskListCheckValueUnchecked:dx,paragraph:zZ}}}function VZ(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:jZ}}}function dx(t){const e=this.stack[this.stack.length-2];e.type,e.checked=t.type==="taskListCheckValueChecked"}function zZ(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const i=n.children[0];if(i&&i.type==="text"){const r=e.children;let o=-1,s;for(;++o<r.length;){const a=r[o];if(a.type==="paragraph"){s=a;break}}s===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(t)}function jZ(t,e,n,i){const r=t.children[0],o=typeof t.checked=="boolean"&&r&&r.type==="paragraph",s="["+(t.checked?"x":" ")+"] ",a=n.createTracker(i);o&&a.move(s);let l=f9.listItem(t,e,n,{...i,...a.current()});return o&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(d){return d+s}}const GZ={tokenize:KZ,partial:!0},WS={tokenize:QZ,partial:!0},qS={tokenize:JZ,partial:!0},YS={tokenize:eW,partial:!0},ZZ={tokenize:tW,partial:!0},XS={tokenize:YZ,previous:QS},KS={tokenize:XZ,previous:JS},Zs={tokenize:qZ,previous:eT},qo={};function WZ(){return{text:qo}}let Cl=48;for(;Cl<123;)qo[Cl]=Zs,Cl++,Cl===58?Cl=65:Cl===91&&(Cl=97);qo[43]=Zs;qo[45]=Zs;qo[46]=Zs;qo[95]=Zs;qo[72]=[Zs,KS];qo[104]=[Zs,KS];qo[87]=[Zs,XS];qo[119]=[Zs,XS];function qZ(t,e,n){const i=this;let r,o;return s;function s(u){return!W7(u)||!eT.call(i,i.previous)||g9(i.events)?n(u):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),a(u))}function a(u){return W7(u)?(t.consume(u),a):u===64?(t.consume(u),l):n(u)}function l(u){return u===46?t.check(ZZ,d,c)(u):u===45||u===95||Ai(u)?(o=!0,t.consume(u),l):d(u)}function c(u){return t.consume(u),r=!0,l}function d(u){return o&&r&&mi(i.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(u)):n(u)}}function YZ(t,e,n){const i=this;return r;function r(s){return s!==87&&s!==119||!QS.call(i,i.previous)||g9(i.events)?n(s):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(GZ,t.attempt(WS,t.attempt(qS,o),n),n)(s))}function o(s){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(s)}}function XZ(t,e,n){const i=this;let r="",o=!1;return s;function s(u){return(u===72||u===104)&&JS.call(i,i.previous)&&!g9(i.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),t.consume(u),a):n(u)}function a(u){if(mi(u)&&r.length<5)return r+=String.fromCodePoint(u),t.consume(u),a;if(u===58){const h=r.toLowerCase();if(h==="http"||h==="https")return t.consume(u),l}return n(u)}function l(u){return u===47?(t.consume(u),o?c:(o=!0,l)):n(u)}function c(u){return u===null||W2(u)||Xt(u)||Yl(u)||Jg(u)?n(u):t.attempt(WS,t.attempt(qS,d),n)(u)}function d(u){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(u)}}function KZ(t,e,n){let i=0;return r;function r(s){return(s===87||s===119)&&i<3?(i++,t.consume(s),r):s===46&&i===3?(t.consume(s),o):n(s)}function o(s){return s===null?n(s):e(s)}}function QZ(t,e,n){let i,r,o;return s;function s(c){return c===46||c===95?t.check(YS,l,a)(c):c===null||Xt(c)||Yl(c)||c!==45&&Jg(c)?l(c):(o=!0,t.consume(c),s)}function a(c){return c===95?i=!0:(r=i,i=void 0),t.consume(c),s}function l(c){return r||i||!o?n(c):e(c)}}function JZ(t,e){let n=0,i=0;return r;function r(s){return s===40?(n++,t.consume(s),r):s===41&&i<n?o(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?t.check(YS,e,o)(s):s===null||Xt(s)||Yl(s)?e(s):(t.consume(s),r)}function o(s){return s===41&&i++,t.consume(s),r}}function eW(t,e,n){return i;function i(a){return a===33||a===34||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===63||a===95||a===126?(t.consume(a),i):a===38?(t.consume(a),o):a===93?(t.consume(a),r):a===60||a===null||Xt(a)||Yl(a)?e(a):n(a)}function r(a){return a===null||a===40||a===91||Xt(a)||Yl(a)?e(a):i(a)}function o(a){return mi(a)?s(a):n(a)}function s(a){return a===59?(t.consume(a),i):mi(a)?(t.consume(a),s):n(a)}}function tW(t,e,n){return i;function i(o){return t.consume(o),r}function r(o){return Ai(o)?n(o):e(o)}}function QS(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||Xt(t)}function JS(t){return!mi(t)}function eT(t){return!(t===47||W7(t))}function W7(t){return t===43||t===45||t===46||t===95||Ai(t)}function g9(t){let e=t.length,n=!1;for(;e--;){const i=t[e][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}function nW(t){let n=(t||{}).singleTilde;const i={tokenize:o,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(s,a){let l=-1;for(;++l<s.length;)if(s[l][0]==="enter"&&s[l][1].type==="strikethroughSequenceTemporary"&&s[l][1]._close){let c=l;for(;c--;)if(s[c][0]==="exit"&&s[c][1].type==="strikethroughSequenceTemporary"&&s[c][1]._open&&s[l][1].end.offset-s[l][1].start.offset===s[c][1].end.offset-s[c][1].start.offset){s[l][1].type="strikethroughSequence",s[c][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},s[c][1].start),end:Object.assign({},s[l][1].end)},u={type:"strikethroughText",start:Object.assign({},s[c][1].end),end:Object.assign({},s[l][1].start)},h=[["enter",d,a],["enter",s[c][1],a],["exit",s[c][1],a],["enter",u,a]],p=a.parser.constructs.insideSpan.null;p&&er(h,h.length,0,e3(p,s.slice(c+1,l),a)),er(h,h.length,0,[["exit",u,a],["enter",s[l][1],a],["exit",s[l][1],a],["exit",d,a]]),er(s,c-1,l-c+3,h),l=c+h.length-2;break}}for(l=-1;++l<s.length;)s[l][1].type==="strikethroughSequenceTemporary"&&(s[l][1].type="data");return s}function o(s,a,l){const c=this.previous,d=this.events;let u=0;return h;function h(g){return c===126&&d[d.length-1][1].type!=="characterEscape"?l(g):(s.enter("strikethroughSequenceTemporary"),p(g))}function p(g){const f=q2(c);if(g===126)return u>1?l(g):(s.consume(g),u++,p);if(u<2&&!n)return l(g);const v=s.exit("strikethroughSequenceTemporary"),m=q2(g);return v._open=!m||m===2&&!!f,v._close=!f||f===2&&!!m,a(g)}}}class iW{constructor(){this.map=[]}add(e,n,i){rW(this,e,n,i)}consume(e){if(this.map.sort(function(o,s){return o[0]-s[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(e.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),e.length=this.map[n][0];i.push([...e]),e.length=0;let r=i.pop();for(;r;)e.push(...r),r=i.pop();this.map.length=0}}function rW(t,e,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<t.map.length;){if(t.map[r][0]===e){t.map[r][1]+=n,t.map[r][2].push(...i);return}r+=1}t.map.push([e,n,i])}}function oW(t,e){let n=!1;const i=[];for(;e<t.length;){const r=t[e];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(t[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(t[e-1][1].type==="tableDelimiterMarker"){const o=i.length-1;i[o]=i[o]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);e+=1}return i}function sW(){return{flow:{null:{tokenize:aW,resolveAll:lW}}}}function aW(t,e,n){const i=this;let r=0,o=0,s;return a;function a(E){let R=i.events.length-1;for(;R>-1;){const P=i.events[R][1].type;if(P==="lineEnding"||P==="linePrefix")R--;else break}const I=R>-1?i.events[R][1].type:null,N=I==="tableHead"||I==="tableRow"?k:l;return N===k&&i.parser.lazy[i.now().line]?n(E):N(E)}function l(E){return t.enter("tableHead"),t.enter("tableRow"),c(E)}function c(E){return E===124||(s=!0,o+=1),d(E)}function d(E){return E===null?n(E):Ze(E)?o>1?(o=0,i.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(E),t.exit("lineEnding"),p):n(E):ht(E)?_t(t,d,"whitespace")(E):(o+=1,s&&(s=!1,r+=1),E===124?(t.enter("tableCellDivider"),t.consume(E),t.exit("tableCellDivider"),s=!0,d):(t.enter("data"),u(E)))}function u(E){return E===null||E===124||Xt(E)?(t.exit("data"),d(E)):(t.consume(E),E===92?h:u)}function h(E){return E===92||E===124?(t.consume(E),u):u(E)}function p(E){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(E):(t.enter("tableDelimiterRow"),s=!1,ht(E)?_t(t,g,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):g(E))}function g(E){return E===45||E===58?v(E):E===124?(s=!0,t.enter("tableCellDivider"),t.consume(E),t.exit("tableCellDivider"),f):M(E)}function f(E){return ht(E)?_t(t,v,"whitespace")(E):v(E)}function v(E){return E===58?(o+=1,s=!0,t.enter("tableDelimiterMarker"),t.consume(E),t.exit("tableDelimiterMarker"),m):E===45?(o+=1,m(E)):E===null||Ze(E)?T(E):M(E)}function m(E){return E===45?(t.enter("tableDelimiterFiller"),y(E)):M(E)}function y(E){return E===45?(t.consume(E),y):E===58?(s=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(E),t.exit("tableDelimiterMarker"),x):(t.exit("tableDelimiterFiller"),x(E))}function x(E){return ht(E)?_t(t,T,"whitespace")(E):T(E)}function T(E){return E===124?g(E):E===null||Ze(E)?!s||r!==o?M(E):(t.exit("tableDelimiterRow"),t.exit("tableHead"),e(E)):M(E)}function M(E){return n(E)}function k(E){return t.enter("tableRow"),_(E)}function _(E){return E===124?(t.enter("tableCellDivider"),t.consume(E),t.exit("tableCellDivider"),_):E===null||Ze(E)?(t.exit("tableRow"),e(E)):ht(E)?_t(t,_,"whitespace")(E):(t.enter("data"),A(E))}function A(E){return E===null||E===124||Xt(E)?(t.exit("data"),_(E)):(t.consume(E),E===92?$:A)}function $(E){return E===92||E===124?(t.consume(E),A):A(E)}}function lW(t,e){let n=-1,i=!0,r=0,o=[0,0,0,0],s=[0,0,0,0],a=!1,l=0,c,d,u;const h=new iW;for(;++n<t.length;){const p=t[n],g=p[1];p[0]==="enter"?g.type==="tableHead"?(a=!1,l!==0&&(ux(h,e,l,c,d),d=void 0,l=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(n,0,[["enter",c,e]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(i=!0,u=void 0,o=[0,0,0,0],s=[0,n+1,0,0],a&&(a=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(n,0,[["enter",d,e]])),r=g.type==="tableDelimiterRow"?2:d?3:1):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(i=!1,s[2]===0&&(o[1]!==0&&(s[0]=s[1],u=wf(h,e,o,r,void 0,u),o=[0,0,0,0]),s[2]=n)):g.type==="tableCellDivider"&&(i?i=!1:(o[1]!==0&&(s[0]=s[1],u=wf(h,e,o,r,void 0,u)),o=s,s=[o[1],n,0,0])):g.type==="tableHead"?(a=!0,l=n):g.type==="tableRow"||g.type==="tableDelimiterRow"?(l=n,o[1]!==0?(s[0]=s[1],u=wf(h,e,o,r,n,u)):s[1]!==0&&(u=wf(h,e,s,r,n,u)),r=0):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(s[3]=n)}for(l!==0&&ux(h,e,l,c,d),h.consume(e.events),n=-1;++n<e.events.length;){const p=e.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=oW(e.events,n))}return t}function wf(t,e,n,i,r,o){const s=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",a="tableContent";n[0]!==0&&(o.end=Object.assign({},d1(e.events,n[0])),t.add(n[0],0,[["exit",o,e]]));const l=d1(e.events,n[1]);if(o={type:s,start:Object.assign({},l),end:Object.assign({},l)},t.add(n[1],0,[["enter",o,e]]),n[2]!==0){const c=d1(e.events,n[2]),d=d1(e.events,n[3]),u={type:a,start:Object.assign({},c),end:Object.assign({},d)};if(t.add(n[2],0,[["enter",u,e]]),i!==2){const h=e.events[n[2]],p=e.events[n[3]];if(h[1].end=Object.assign({},p[1].end),h[1].type="chunkText",h[1].contentType="text",n[3]>n[2]+1){const g=n[2]+1,f=n[3]-n[2]-1;t.add(g,f,[])}}t.add(n[3]+1,0,[["exit",u,e]])}return r!==void 0&&(o.end=Object.assign({},d1(e.events,r)),t.add(r,0,[["exit",o,e]]),o=void 0),o}function ux(t,e,n,i,r){const o=[],s=d1(e.events,n);r&&(r.end=Object.assign({},s),o.push(["exit",r,e])),i.end=Object.assign({},s),o.push(["exit",i,e]),t.add(n+1,0,o)}function d1(t,e){const n=t[e],i=n[0]==="enter"?"start":"end";return n[1][i]}const cW={tokenize:uW};function dW(){return{text:{91:cW}}}function uW(t,e,n){const i=this;return r;function r(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(l):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),o)}function o(l){return Xt(l)?(t.enter("taskListCheckValueUnchecked"),t.consume(l),t.exit("taskListCheckValueUnchecked"),s):l===88||l===120?(t.enter("taskListCheckValueChecked"),t.consume(l),t.exit("taskListCheckValueChecked"),s):n(l)}function s(l){return l===93?(t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),a):n(l)}function a(l){return Ze(l)?e(l):ht(l)?t.check({tokenize:hW},e,n)(l):n(l)}}function hW(t,e,n){return _t(t,i,"whitespace");function i(r){return r===null?n(r):e(r)}}function pW(){return gS([WZ(),nW(),sW(),dW()])}function fW(){return[SZ(),BZ(),UZ(),fZ()]}function gW(){return{extensions:[TZ(),FZ(),VZ()]}}function hx(){const e=this.data(),n=e.micromarkExtensions||(e.micromarkExtensions=[]),i=e.fromMarkdownExtensions||(e.fromMarkdownExtensions=[]),r=e.toMarkdownExtensions||(e.toMarkdownExtensions=[]);n.push(pW()),i.push(fW()),r.push(gW())}class Ws extends kc{constructor(){super(...arguments),this._traverseSnapshot=async(e,n,i)=>{const r=[],o=new Vl;return o.setONodeTypeGuard(s=>$g.safeParse(s).success),o.setEnter(async(s,a)=>{const l=s.node.props.text??{delta:[]},c=a.currentNode();switch(s.node.flavour){case"affine:code":{a.openNode({type:"code",lang:s.node.props.language??null,meta:null,value:l.delta.map(d=>d.insert).join("")},"children").closeNode();break}case"affine:paragraph":{const d=a.getGlobalContext("affine:paragraph:depth")??0;switch(s.node.props.type){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{a.openNode({type:"heading",depth:parseInt(s.node.props.type[1]),children:this._deltaToMdAST(l.delta,d)},"children").closeNode();break}case"text":{a.openNode({type:"paragraph",children:this._deltaToMdAST(l.delta,d)},"children").closeNode();break}case"quote":{a.openNode({type:"blockquote",children:[]},"children").openNode({type:"paragraph",children:this._deltaToMdAST(l.delta)},"children").closeNode().closeNode();break}}a.setGlobalContext("affine:paragraph:depth",d+1);break}case"affine:list":{a.getNodeContext("affine:list:parent")===s.parent&&c.type==="list"&&c.ordered===(s.node.props.type==="numbered")&&c.children[0].checked===(s.node.props.type==="todo"?s.node.props.checked:void 0)?a.openNode({type:"listItem",checked:s.node.props.type==="todo"?s.node.props.checked:void 0,children:[]},"children").openNode({type:"paragraph",children:this._deltaToMdAST(l.delta)},"children").closeNode():a.openNode({type:"list",ordered:s.node.props.type==="numbered",children:[]},"children").setNodeContext("affine:list:parent",s.parent).openNode({type:"listItem",checked:s.node.props.type==="todo"?s.node.props.checked:void 0,children:[]},"children").openNode({type:"paragraph",children:this._deltaToMdAST(l.delta)},"children").closeNode();break}case"affine:divider":{a.openNode({type:"thematicBreak"},"children").closeNode();break}case"affine:image":{const d=s.node.props.sourceId??"";if(!i)break;await i.readFromBlob(d);const u=i.getAssets().get(d);r.push(d);const h=ys(i.getAssets(),d);if(!u)break;a.openNode({type:"paragraph",children:[]},"children").openNode({type:"image",url:`assets/${h}`,title:null,alt:u.name??null},"children").closeNode().closeNode();break}case"affine:page":{const d=s.node.props.title??{delta:[]};if(d.delta.length===0)break;a.openNode({type:"paragraph",children:this._deltaToMdAST(d.delta,0)},"children").closeNode();break}case"affine:database":{const d=[],u=s.node.props.columns,h=s.node.children,p=s.node.props.cells,g=v=>({type:"tableCell",children:v}),f=Array.prototype.map.call(h,v=>Array.prototype.map.call(u,m=>{const y=p[v.id]?.[m.id];let x;if(y||m.type==="title")switch(m.type){case"link":case"progress":case"number":x=g([{type:"text",value:y.value}]);break;case"rich-text":x=g([{type:"text",value:y.value.delta.map(T=>T.insert).join()}]);break;case"title":x=g([{type:"text",value:v.props.text.delta.map(T=>T.insert).join("")}]);break;case"date":x=g([{type:"text",value:Zh(new Date(y.value),"yyyy-MM-dd")}]);break;case"select":{const T=m.data.options.find(M=>M.id===y.value)?.value;x=g([{type:"text",value:T}]);break}case"multi-select":{const T=Array.prototype.map.call(y.value,M=>m.data.options.find(k=>M===k.id).value).filter(Boolean).join(",");x=g([{type:"text",value:T}]);break}case"checkbox":{x=g([{type:"text",value:y.value}]);break}default:x=g([{type:"text",value:""}])}else x=g([{type:"text",value:""}]);return x}));Array.isArray(u)&&d.push({type:"tableRow",children:Array.prototype.map.call(u,v=>g([{type:"text",value:v.name}]))}),Array.prototype.forEach.call(f,v=>{d.push({type:"tableRow",children:v})}),a.openNode({type:"table",children:d}).closeNode(),a.skipAllChildren();break}case"affine:bookmark":{if(typeof s.node.props.title!="string"||typeof s.node.props.url!="string")break;a.openNode({type:"paragraph",children:[]},"children").openNode({type:"link",url:s.node.props.url,children:[{type:"text",value:s.node.props.title}]},"children").closeNode().closeNode();break}}}),o.setLeave(async(s,a)=>{const l=a.currentNode();switch(s.node.flavour){case"affine:paragraph":{a.setGlobalContext("affine:paragraph:depth",a.getGlobalContext("affine:paragraph:depth")-1);break}case"affine:list":{a.getNodeContext("affine:list:parent")===s.parent&&l.type==="list"&&l.ordered===(s.node.props.type==="numbered")&&l.children[0].checked===(s.node.props.type==="todo"?s.node.props.checked:void 0)?a.closeNode():a.closeNode().closeNode();break}}}),{ast:await o.walk(e,n),assetsIds:r}},this._traverseMarkdown=(e,n,i)=>{const r=new Vl;return r.setONodeTypeGuard(o=>!Array.isArray(o)&&"type"in o&&o.type!==void 0),r.setEnter(async(o,s)=>{switch(o.node.type){case"html":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:o.node.value}]}},children:[]},"children").closeNode();break}case"code":{s.openNode({type:"block",id:Oe(),flavour:"affine:code",props:{language:o.node.lang,text:{"$blocksuite:internal:text$":!0,delta:[{insert:o.node.value}]}},children:[]},"children").closeNode();break}case"paragraph":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:this._mdastToDelta(o.node)}},children:[]},"children").closeNode();break}case"heading":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:`h${o.node.depth}`,text:{"$blocksuite:internal:text$":!0,delta:this._mdastToDelta(o.node)}},children:[]},"children").closeNode();break}case"blockquote":{s.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"quote",text:{"$blocksuite:internal:text$":!0,delta:this._mdastToDelta(o.node)}},children:[]},"children").closeNode(),s.skipAllChildren();break}case"list":{s.setNodeContext("mdast:list:ordered",o.node.ordered);break}case"listItem":{s.openNode({type:"block",id:Oe(),flavour:"affine:list",props:{type:o.node.checked!==null?"todo":s.getNodeContext("mdast:list:ordered")?"numbered":"bulleted",text:{"$blocksuite:internal:text$":!0,delta:o.node.children[0]&&o.node.children[0].type==="paragraph"?this._mdastToDelta(o.node.children[0]):[]},checked:o.node.checked??!1,collapsed:!1},children:[]},"children"),o.node.children[0]&&o.node.children[0].type==="paragraph"&&s.skipChildren(1);break}case"thematicBreak":{s.openNode({type:"block",id:Oe(),flavour:"affine:divider",props:{},children:[]},"children").closeNode();break}case"image":{let a="";if(!i)break;if(o.node.url.startsWith("http")){const l=await l9(o.node.url,void 0,this.configs.get("imageProxy")),c=l.clone(),d=new File([await l.blob()],Th(l.headers.get("Content-Disposition")??"")??o.node.url.split("/").at(-1)??"image"+l.headers.get("Content-Type")?.split("/").at(-1)??".png");a=await _1(await c.arrayBuffer()),i?.getAssets().set(a,d),await i?.writeToBlob(a)}else{const l=o.node.url;i.getAssets().forEach((c,d)=>{l.includes(ys(i.getAssets(),d))&&(a=d)})}s.openNode({type:"block",id:Oe(),flavour:"affine:image",props:{sourceId:a},children:[]},"children").closeNode();break}case"table":{const a=o.node.children[0].children.map(()=>({id:Oe(),hide:!1,width:180})),l=Object.create(null);o.node.children.slice(1).forEach(d=>{const u=Oe();l[u]=Object.create(null),d.children.slice(1).forEach((h,p)=>{l[u][a[p+1].id]={columnId:a[p+1].id,value:h.children.map(g=>"value"in g?g.value:"").join("")}})});const c=o.node.children[0].children.map((d,u)=>({type:u===0?"title":"rich-text",name:d.children.map(h=>"value"in h?h.value:"").join(""),data:{},id:a[u].id}));s.openNode({type:"block",id:Oe(),flavour:"affine:database",props:{views:[{id:Oe(),name:"Table View",mode:"table",columns:[],filter:{type:"group",op:"and",conditions:[]},header:{titleColumn:a[0]?.id,iconColumn:"type"}}],title:{"$blocksuite:internal:text$":!0,delta:[]},cells:l,columns:c},children:[]},"children"),s.setNodeContext("affine:table:rowid",Object.keys(l)),s.skipChildren(1);break}case"tableRow":{s.openNode({type:"block",id:s.getNodeContext("affine:table:rowid").shift()??Oe(),flavour:"affine:paragraph",props:{text:{"$blocksuite:internal:text$":!0,delta:this._mdastToDelta(o.node.children[0])},type:"text"},children:[]}).closeNode(),s.skipAllChildren();break}}}),r.setLeave(async(o,s)=>{switch(o.node.type){case"listItem":{s.closeNode();break}case"table":{s.closeNode();break}}}),r.walk(e,n)}}async fromPageSnapshot({snapshot:e,assets:n}){let i="";e.meta.title&&(i+=`# ${e.meta.title}

`);const{file:r,assetsIds:o}=await this.fromBlockSnapshot({snapshot:e.blocks,assets:n});return i+=r,{file:i,assetsIds:o}}async fromBlockSnapshot({snapshot:e,assets:n}){const i={type:"root",children:[]},{ast:r,assetsIds:o}=await this._traverseSnapshot(e,i,n);return{file:this._astToMarkdown(r),assetsIds:o}}async fromSliceSnapshot({snapshot:e,assets:n}){let i="";const r=[];for(const s of e.content){const a={type:"root",children:[]},{ast:l,assetsIds:c}=await this._traverseSnapshot(s,a,n);r.push(...c),i+=this._astToMarkdown(l)}return{file:i.match(/\n/g)?.length===1?i.trimEnd():i,assetsIds:r}}async toPageSnapshot(e){const n=this._markdownToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return{type:"page",meta:{id:Oe(),title:"Untitled",createDate:+new Date,tags:[]},blocks:{type:"block",id:Oe(),flavour:"affine:page",props:{title:{"$blocksuite:internal:text$":!0,delta:[{insert:"Untitled"}]}},children:[{type:"block",id:Oe(),flavour:"affine:surface",props:{elements:{}},children:[]},await this._traverseMarkdown(n,i,e.assets)]}}}async toBlockSnapshot(e){const n=this._markdownToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return this._traverseMarkdown(n,i,e.assets)}async toSliceSnapshot(e){e.file=e.file.split(`
`).map(o=>o.trimStart().startsWith("-")?o:o.replace(/^ /,"&#x20;")).join(`
`);const n=this._markdownToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]},r=await this._traverseMarkdown(n,i,e.assets);return r.children.length===0?null:{type:"slice",content:[r],pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId}}_astToMarkdown(e){return jh().use(hx).use(lZ,{resourceLink:!0}).stringify(e).replace(/&#x20;\n/g,` 
`)}_markdownToAst(e){return jh().use(tG).use(hx).parse(e)}_deltaToMdAST(e,n=0){return n>0&&e.unshift({insert:" ".repeat(4).repeat(n)}),e.map(i=>{let r={type:"text",value:i.attributes?.underline?`<u>${i.insert}</u>`:i.insert};return i.attributes?.code&&(r={type:"inlineCode",value:i.insert}),i.attributes?.bold&&(r={type:"strong",children:[r]}),i.attributes?.italic&&(r={type:"emphasis",children:[r]}),i.attributes?.strike&&(r={type:"delete",children:[r]}),i.attributes?.link&&(i.insert===""?r={type:"text",value:i.attributes.link}:i.insert!==i.attributes.link&&(r={type:"link",url:i.attributes.link,children:[r]})),r})}_mdastToDelta(e){switch(e.type){case"text":return[{insert:e.value}];case"inlineCode":return[{insert:e.value,attributes:{code:!0}}];case"strong":return e.children.flatMap(n=>this._mdastToDelta(n).map(i=>(i.attributes={...i.attributes,bold:!0},i)));case"emphasis":return e.children.flatMap(n=>this._mdastToDelta(n).map(i=>(i.attributes={...i.attributes,italic:!0},i)));case"delete":return e.children.flatMap(n=>this._mdastToDelta(n).map(i=>(i.attributes={...i.attributes,strike:!0},i)));case"link":return e.children.flatMap(n=>this._mdastToDelta(n).map(i=>(i.attributes={...i.attributes,link:e.url},i)));case"list":return[]}return"children"in e?e.children.flatMap(n=>this._mdastToDelta(n)):[]}}class tT extends kc{constructor(){super(),this._markdownAdapter=new Ws}async fromPageSnapshot({snapshot:e,assets:n}){let i="";e.meta.title&&(i+=`${e.meta.title}

`);const{file:r,assetsIds:o}=await this.fromBlockSnapshot({snapshot:e.blocks,assets:n});return i+=r,{file:i,assetsIds:o}}async fromBlockSnapshot({snapshot:e}){const{mixtext:n}=await this._traverseSnapshot(e);return{file:n,assetsIds:[]}}async fromSliceSnapshot({snapshot:e}){let n="";const i=[];for(const o of e.content){const{mixtext:s}=await this._traverseSnapshot(o);n+=s}return{file:n.match(/\n/g)?.length===1?n.trimEnd():n,assetsIds:i}}async toPageSnapshot(e){return e.file=e.file.replaceAll("\r",""),{type:"page",meta:{id:Oe(),title:"Untitled",createDate:+new Date,tags:[]},blocks:{type:"block",id:Oe(),flavour:"affine:page",props:{title:{"$blocksuite:internal:text$":!0,delta:[{insert:"Untitled"}]}},children:[{type:"block",id:Oe(),flavour:"affine:surface",props:{elements:{}},children:[]},{type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:e.file.split(`
`).map(n=>({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:n}]}},children:[]}))}]}}}async toBlockSnapshot(e){return e.file=e.file.replaceAll("\r",""),{type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:e.file.split(`
`).map(n=>({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:n}]}},children:[]}))}}async toSliceSnapshot(e){return this._markdownAdapter.applyConfigs(this.configs),e.file.trim().length===0?null:(e.file=e.file.replaceAll("\r",""),await this._markdownAdapter.toSliceSnapshot({file:e.file,assets:e.assets,pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId}))}async _traverseSnapshot(e){let n="";const i=new Vl;return i.setONodeTypeGuard(r=>$g.safeParse(r).success),i.setEnter(async r=>{const o=r.node.props.text??{delta:[]};switch(r.node.flavour){case"affine:code":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:paragraph":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:list":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:divider":{n+=`---
`;break}}}),await i.walkONode(e),{mixtext:n}}}const m9=[{color:"var(--affine-tag-red)",name:"Red"},{color:"var(--affine-tag-pink)",name:"Pink"},{color:"var(--affine-tag-orange)",name:"Orange"},{color:"var(--affine-tag-yellow)",name:"Yellow"},{color:"var(--affine-tag-green)",name:"Green"},{color:"var(--affine-tag-teal)",name:"Teal"},{color:"var(--affine-tag-blue)",name:"Blue"},{color:"var(--affine-tag-purple)",name:"Purple"},{color:"var(--affine-tag-gray)",name:"Gray"},{color:"var(--affine-tag-white)",name:"White"}],px=m9.map(t=>t.color);function mW(){let t=[...px];return()=>{t.length===0&&(t=[...px]);const e=Math.floor(Math.random()*t.length);return t.splice(e,1)[0]}}const Wr=mW(),bW={typesSelect:"select",typesMultipleSelect:"multi-select",typesNumber:"number",typesCheckbox:"checkbox",typesText:"rich-text",typesTitle:"title"};class b9 extends kc{constructor(){super(...arguments),this._traverseNotionHtml=async(e,n,i,r)=>{const o=new Vl;return o.setONodeTypeGuard(s=>"type"in s&&s.type!==void 0),o.setEnter(async(s,a)=>{if(s.node.type==="element")switch(s.node.tagName){case"header":{a.skipAllChildren();break}case"img":{if(!i)break;const l=s.node,c=typeof l?.properties.src=="string"?l.properties.src:"";if(c){let d="";if(!c.startsWith("http"))i.getAssets().forEach((u,h)=>{const p=ys(i.getAssets(),h);c.includes(p)&&(d=h)});else{const u=await l9(c,void 0,this.configs.get("imageProxy")),h=u.clone(),p=Th(u.headers.get("Content-Disposition")??"")??c.split("/").at(-1)??"image"+u.headers.get("Content-Type")?.split("/").at(-1)??".png",g=new File([await u.blob()],p);d=await _1(await h.arrayBuffer()),i?.getAssets().set(d,g),await i?.writeToBlob(d)}a.openNode({type:"block",id:Oe(),flavour:"affine:image",props:{sourceId:d},children:[]},"children").closeNode(),a.skipAllChildren();break}break}case"pre":{const l=Qt(s.node,"code");if(!l)break;const c=l.children.length===1&&l.children[0].type==="text"?l.children[0]:{...l,tag:"div"};a.openNode({type:"block",id:Oe(),flavour:"affine:code",props:{language:"Plain Text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(c,{trim:!1})}},children:[]},"children").closeNode(),a.skipAllChildren();break}case"blockquote":{a.setGlobalContext("hast:blockquote",!0),a.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"quote",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(V7(s.node),{pageMap:r})}},children:[]},"children").closeNode();break}case"p":{if(!s.node.properties.id)break;a.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:a.getGlobalContext("hast:blockquote")?"quote":"text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(s.node,{pageMap:r})}},children:[]},"children");break}case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{a.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:s.node.tagName,text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(s.node,{pageMap:r})}},children:[]},"children").closeNode();break}case"ul":case"ol":{a.setNodeContext("hast:list:type","bulleted"),s.node.tagName==="ol"?a.setNodeContext("hast:list:type","numbered"):Array.isArray(s.node.properties?.className)&&(s.node.properties.className.includes("to-do-list")?a.setNodeContext("hast:list:type","todo"):s.node.properties.className.includes("toggle")?a.setNodeContext("hast:list:type","toggle"):s.node.properties.className.includes("bulleted-list")&&a.setNodeContext("hast:list:type","bulleted"));break}case"li":{const l=j2(s.node)[0],c=a.getNodeContext("hast:list:type");a.openNode({type:"block",id:Oe(),flavour:"affine:list",props:{type:c,text:{"$blocksuite:internal:text$":!0,delta:c!=="toggle"?this._hastToDelta(s.node,{pageMap:r}):this._hastToDelta(Qt(s.node,"summary")??s.node,{pageMap:r})},checked:c==="todo"?l&&Array.isArray(l.properties?.className)&&l.properties.className.includes("checkbox-on"):!1,collapsed:c==="toggle"?l&&l.tagName==="details"&&l.properties.open===void 0:!1},children:[]},"children");break}case"hr":{a.openNode({type:"block",id:Oe(),flavour:"affine:divider",props:{},children:[]},"children").closeNode();break}case"figure":{if(Qt(s.node,".link-to-page")){a.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(s.node,{pageMap:r})}},children:[]},"children").closeNode(),a.skipAllChildren();break}if(Qt(s.node,".callout")){a.openNode({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(s.node,{pageMap:r})}},children:[]},"children").closeNode(),a.skipAllChildren();break}const l=Qt(s.node,".bookmark");if(l){const p=l.properties?.href,g=go(Qt(l,".bookmark-title")),f=go(Qt(l,".bookmark-description")),v=Qt(l,".bookmark-icon"),m=typeof v?.properties?.src=="string"?v.properties.src:"";a.openNode({type:"block",id:Oe(),flavour:"affine:bookmark",props:{type:"card",url:p??"",title:g,description:f,icon:m},children:[]},"children").closeNode(),a.skipAllChildren();break}if(!i)break;const c=Qt(s.node,".image");let d="";if(c){const p=Qt(c,"img");d=typeof p?.properties.src=="string"?p.properties.src:""}if(d){let p="";if(!d.startsWith("http"))i.getAssets().forEach((g,f)=>{const v=ys(i.getAssets(),f);d.includes(v)&&(p=f)});else{const g=await fetch(d),f=g.clone(),v=Th(g.headers.get("Content-Disposition")??"")??d.split("/").at(-1)??"image"+g.headers.get("Content-Type")?.split("/").at(-1)??".png",m=new File([await g.blob()],v);p=await _1(await f.arrayBuffer()),i?.getAssets().set(p,m),await i?.writeToBlob(p)}a.openNode({type:"block",id:Oe(),flavour:"affine:image",props:{sourceId:p},children:[]},"children").closeNode(),a.skipAllChildren();break}const u=Qt(s.node,".source");let h="";if(u){const p=Qt(u,"a");h=typeof p?.properties.href=="string"?p.properties.href:""}if(h){let p="",g="",f="",v=0;if(!h.startsWith("http"))i.getAssets().forEach((m,y)=>{const x=ys(i.getAssets(),y);h.includes(x)&&(p=y,g=x,v=m.size,f=m.type)});else{const m=await fetch(h),y=m.clone();g=Th(m.headers.get("Content-Disposition")??"")??h.split("/").at(-1)??"file"+m.headers.get("Content-Type")?.split("/").at(-1)??".blob";const x=new File([await m.blob()],g);v=x.size,f=x.type,p=await _1(await y.arrayBuffer()),i?.getAssets().set(p,x),await i?.writeToBlob(p)}a.openNode({type:"block",id:Oe(),flavour:"affine:attachment",props:{name:g,size:v,type:f,sourceId:p},children:[]},"children").closeNode(),a.skipAllChildren();break}break}case"th":{const l=Oe(),c=Qt(s.node,"svg")?.properties?.className,d=Array.isArray(c)?bW[c[0]]??"rich-text":"rich-text";a.pushGlobalContextStack("hast:table:column",{type:d,name:go(V7(s.node)),data:Object.create(null),id:l});break}case"tr":if(s.parent?.type==="element"&&s.parent.tagName==="tbody"){const l=a.getGlobalContextStack("hast:table:column"),c=Object.create(null);j2(s.node).forEach((d,u)=>{if(Qt(d,".cell-title")){a.pushGlobalContextStack("hast:table:children",{type:"block",id:Oe(),flavour:"affine:paragraph",props:{text:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(d,{pageMap:r})},type:"text"},children:[]}),l[u].type="title";return}const h=[];Qt(d,".selected-value")?("options"in l[u].data||(l[u].data.options=[]),["select","multi-select"].includes(l[u].type)||(l[u].type="select"),l[u].type==="select"&&d.type==="element"&&d.children.length>1&&(l[u].type="multi-select"),d.type==="element"&&d.children.forEach(p=>{const g=l[u].data.options?.filter(v=>v.value===go(p)),f=g?.length?g[0].id:Oe();g?.length||l[u].data.options?.push({id:f,value:go(p),color:Wr()}),h.push(f)}),c[l[u].id]={columnId:l[u].id,value:h}):Qt(d,".checkbox")?(l[u].type!=="checkbox"&&(l[u].type="checkbox"),c[l[u].id]={columnId:l[u].id,value:!!Qt(d,".checkbox-on")}):l[u].type==="number"?c[l[u].id]={columnId:l[u].id,value:Number(go(d))}:c[l[u].id]={columnId:l[u].id,value:go(d)}}),a.setGlobalContextStack("hast:table:column",l),a.pushGlobalContextStack("hast:table:rows",c)}}}),o.setLeave(async(s,a)=>{if(s.node.type==="element")switch(s.node.tagName){case"div":{s.parent?.type==="element"&&s.parent.tagName!=="li"&&Array.isArray(s.node.properties?.className)&&s.node.properties.className.includes("indented")&&a.closeNode();break}case"blockquote":{a.setGlobalContext("hast:blockquote",!1);break}case"p":{if(!s.node.properties.id)break;if(s.parent.type==="element"&&s.parent.children.length>s.index+1){const l=s.parent.children[s.index+1];if(l.type==="element"&&l.tagName==="div"&&Array.isArray(l.properties?.className)&&l.properties.className.includes("indented"))break}a.closeNode();break}case"li":{a.closeNode();break}case"table":{const l=a.getGlobalContextStack("hast:table:column");a.setGlobalContextStack("hast:table:column",[]);const c=a.getGlobalContextStack("hast:table:children");a.setGlobalContextStack("hast:table:children",[]);const d=Object.create(null);a.getGlobalContextStack("hast:table:rows").map((u,h)=>{Object.keys(u).forEach(p=>{l.find(g=>g.id===p)?.type==="select"&&(u[p].value=u[p].value[0])}),d[c.at(h)?.id??Oe()]=u}),a.setGlobalContextStack("hast:table:cells",[]),a.openNode({type:"block",id:Oe(),flavour:"affine:database",props:{views:[{id:Oe(),name:"Table View",mode:"table",columns:[],filter:{type:"group",op:"and",conditions:[]},header:{titleColumn:l.find(u=>u.type==="title")?.id??"",iconColumn:"type"}}],title:{"$blocksuite:internal:text$":!0,delta:[]},columns:l,cells:d},children:[]},"children"),c.forEach(u=>{a.openNode(u,"children").closeNode()}),a.closeNode();break}}}),o.walk(e,n)},this._hastToDeltaSpreaded=(e,n={trim:!0})=>{switch(n.trim===void 0&&(n.trim=!0),e.type){case"text":return n.trim?e.value.trim()?[{insert:e.value.trim()}]:[]:e.value?[{insert:e.value}]:[];case"element":switch(e.tagName){case"ol":case"ul":return[];case"span":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n));case"strong":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes,bold:!0},r)));case"em":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes,italic:!0},r)));case"code":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes,code:!0},r)));case"del":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes,strike:!0},r)));case"u":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes,underline:!0},r)));case"a":{const i=e.properties?.href;return typeof i!="string"?[]:e.children.flatMap(r=>this._hastToDeltaSpreaded(r,n).map(o=>{if(n.pageMap){const s=n.pageMap.get(decodeURIComponent(i));if(s)return o.attributes={...o.attributes,reference:{type:"LinkedPage",pageId:s}},o.insert=" ",o}return i.startsWith("http")&&(o.attributes={...o.attributes,link:i}),o}))}case"mark":return e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n).map(r=>(r.attributes={...r.attributes},r)))}}return"children"in e?e.children.flatMap(i=>this._hastToDeltaSpreaded(i,n)):[]},this._hastToDelta=(e,n={trim:!0})=>this._hastToDeltaSpreaded(e,n).reduce((i,r)=>{if(i.length===0)return[r];const o=i[i.length-1];return typeof o.insert=="string"&&typeof r.insert=="string"&&km(o.attributes,r.attributes)?(o.insert+=r.insert,i):[...i,r]},[])}fromPageSnapshot(e){throw new Error("Method not implemented.")}fromBlockSnapshot(e){throw new Error("Method not implemented.")}fromSliceSnapshot(e){throw new Error("Method not implemented.")}async toPageSnapshot(e){const n=this._htmlToAst(e.file),i=Qt(n,"title"),r={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return{type:"page",meta:{id:e.pageId??Oe(),title:go(i,"Untitled"),createDate:+new Date,tags:[]},blocks:{type:"block",id:Oe(),flavour:"affine:page",props:{title:{"$blocksuite:internal:text$":!0,delta:this._hastToDelta(i??{type:"text",value:"Untitled"})}},children:[{type:"block",id:Oe(),flavour:"affine:surface",props:{elements:{}},children:[]},await this._traverseNotionHtml(n,r,e.assets,e.pageMap)]}}}toBlockSnapshot(e){const n=this._htmlToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]};return this._traverseNotionHtml(n,i,e.assets,e.pageMap)}async toSliceSnapshot(e){const n=this._htmlToAst(e.file),i={type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:[]},r=await this._traverseNotionHtml(n,i,e.assets);return r.children.length===0?null:{type:"slice",content:[r],pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId}}_htmlToAst(e){return jh().use(FE).parse(e)}}class nT extends kc{constructor(){super(),this._markdownAdapter=new Ws}async fromPageSnapshot({snapshot:e,assets:n}){let i="";e.meta.title&&(i+=`${e.meta.title}

`);const{file:r,assetsIds:o}=await this.fromBlockSnapshot({snapshot:e.blocks,assets:n});return i+=r,{file:i,assetsIds:o}}async fromBlockSnapshot({snapshot:e}){const{plaintext:n}=await this._traverseSnapshot(e);return{file:n,assetsIds:[]}}async fromSliceSnapshot({snapshot:e}){let n="";const i=[];for(const o of e.content){const{plaintext:s}=await this._traverseSnapshot(o);n+=s}return{file:n.match(/\n/g)?.length===1?n.trimEnd():n,assetsIds:i}}async toPageSnapshot(e){return e.file=e.file.replaceAll("\r",""),{type:"page",meta:{id:Oe(),title:"Untitled",createDate:+new Date,tags:[]},blocks:{type:"block",id:Oe(),flavour:"affine:page",props:{title:{"$blocksuite:internal:text$":!0,delta:[{insert:"Untitled"}]}},children:[{type:"block",id:Oe(),flavour:"affine:surface",props:{elements:{}},children:[]},{type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:e.file.split(`
`).map(n=>({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:n}]}},children:[]}))}]}}}async toBlockSnapshot(e){return e.file=e.file.replaceAll("\r",""),{type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:e.file.split(`
`).map(n=>({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:n}]}},children:[]}))}}async toSliceSnapshot(e){return this._markdownAdapter.applyConfigs(this.configs),e.file.trim().length===0?null:(e.file=e.file.replaceAll("\r",""),{type:"slice",content:[{type:"block",id:Oe(),flavour:"affine:note",props:{xywh:"[0,0,800,95]",background:"--affine-background-secondary-color",index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless},children:e.file.split(`
`).map(i=>({type:"block",id:Oe(),flavour:"affine:paragraph",props:{type:"text",text:{"$blocksuite:internal:text$":!0,delta:[{insert:i}]}},children:[]}))}],pageVersion:e.pageVersion,workspaceVersion:e.workspaceVersion,workspaceId:e.workspaceId,pageId:e.pageId})}async _traverseSnapshot(e){let n="";const i=new Vl;return i.setONodeTypeGuard(r=>$g.safeParse(r).success),i.setEnter(async r=>{const o=r.node.props.text??{delta:[]};switch(r.node.flavour){case"affine:code":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:paragraph":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:list":{n+=o.delta.map(s=>s.insert).join(""),n+=`
`;break}case"affine:divider":{n+=`---
`;break}}}),await i.walkONode(e),{plaintext:n}}}const Y2=({slots:t,workspace:e})=>{const n=new Map;t.afterImport.on(i=>{if(i.type==="block"&&i.snapshot.flavour==="affine:database"){const r=i.model;Object.keys(r.cells).forEach(o=>{n.has(o)&&(r.cells[n.get(o)]=r.cells[o],delete r.cells[o])})}if(i.type==="block"&&["affine:paragraph","affine:list"].includes(i.snapshot.flavour)){const r=i.model;let o=0;const s=[];for(const a of r.text.toDelta())a.attributes?.reference?.pageId?(o>0&&s.push({retain:o}),s.push({retain:a.insert?.length??0,attributes:{reference:{...a.attributes.reference,pageId:n.get(a.attributes.reference.pageId)}}}),o=0):o+=a.insert?.length??0;s.length>0&&r.text.applyDelta(s)}}),t.beforeImport.on(i=>{if(i.type==="page"){const r=e.idGenerator();n.set(i.snapshot.meta.id,r),i.snapshot.meta.id=r;return}if(i.type==="block"){const{snapshot:r}=i;if(r.flavour==="affine:page"){const a=r.children.findIndex(l=>l.flavour==="affine:surface");if(a!==-1){const[l]=r.children.splice(a,1);r.children.push(l)}}const o=r.id;let s;n.has(o)?s=n.get(o):(s=e.idGenerator(),n.set(o,s)),r.id=s,r.flavour==="affine:surface"&&(r.children.forEach(a=>{const l=a.id;n.has(l)?s=n.get(l):(s=e.idGenerator(),n.set(l,s))}),Object.entries(r.props.elements).forEach(([a,l])=>{switch(l.type){case"connector":{let c=l.source;if(n.has(c.id)){const d=n.get(c.id);D(d,"reference id must exist"),c.id=d}if(c=l.target,n.has(c.id)){const d=n.get(c.id);D(d,"reference id must exist"),c.id=d}break}case"group":{const c=l.children.json;Object.entries(c).forEach(([d,u])=>{if(n.has(d)){delete c[d];const h=n.get(d);D(h,"reference id must exist"),c[h]=u}});break}}}))}})},q7=t=>({adapterConfigs:e})=>{e.set("imageProxy",t)},vW=()=>{let t=q7(Hm);return{get:()=>t,set:e=>{t=q7(e)}}},iT=vW(),rT=iT.set,Xl=iT.get(),v1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<v1.length;t++)oh[v1.charCodeAt(t)]=t;const yW=t=>{const e=new Uint8Array(t),n=e.length;let i,r="";for(i=0;i<n;i+=3)r+=v1[e[i]>>2],r+=v1[(e[i]&3)<<4|e[i+1]>>4],r+=v1[(e[i+1]&15)<<2|e[i+2]>>6],r+=v1[e[i+2]&63];return n%3===2?r=r.substring(0,r.length-1)+"=":n%3===1&&(r=r.substring(0,r.length-2)+"=="),r},wW=t=>{const e=t.length;let n=t.length*.75,i,r=0,o,s,a,l;t[t.length-1]==="="&&(n--,t[t.length-2]==="="&&n--);const c=new ArrayBuffer(n),d=new Uint8Array(c);for(i=0;i<e;i+=4)o=oh[t.charCodeAt(i)],s=oh[t.charCodeAt(i+1)],a=oh[t.charCodeAt(i+2)],l=oh[t.charCodeAt(i+3)],d[r++]=o<<2|s>>4,d[r++]=(s&15)<<4|a>>2,d[r++]=(a&3)<<6|l&63;return c};class u6 extends kc{static{this.MIME="BLOCKSUITE/SNAPSHOT"}fromPageSnapshot(e){throw new Error("not implemented")}toPageSnapshot(e){throw new Error("not implemented")}fromBlockSnapshot(e){throw new Error("not implemented")}toBlockSnapshot(e){throw new Error("not implemented")}async fromSliceSnapshot(e){const n=e.snapshot,i=e.assets;D(i);const r=i.getAssets(),o={};return await Promise.all(Array.from(r.entries()).map(async([s,a])=>{const l=yW(await a.arrayBuffer()),c={name:a.name,type:a.type,content:l};o[s]=c})),{file:JSON.stringify({snapshot:n,blobs:o}),assetsIds:[]}}toSliceSnapshot(e){const n=JSON.parse(e.file),{blobs:i,snapshot:r}=n,o=e.assets?.getAssets();return Object.entries(i).forEach(([s,a])=>{const l=new Blob([wW(a.content)]),c=new File([l],a.name,{type:a.type});D(o),o.set(s,c)}),Promise.resolve(r)}}const fx=(t,e,n)=>{const{index:i,length:r}=t;if(Ie(n,["affine:page"])){if(r===0)return;e.props.title.delta=n.title.sliceToDelta(i,r+i);return}!e.props.text||r===0||(e.props.text.delta=n.text?.sliceToDelta(i,r+i))},xW=(t,e)=>{t.afterExport.on(n=>{if(n.type==="block"){const i=n.snapshot,r=n.model,o=e.selection.find("text");if(o&&gt.id(o.from.path)===r.id){fx(o.from,i,r);return}if(o&&o.to&&gt.id(o.to.path)===r.id){fx(o.to,i,r);return}}})},_W=t=>({slots:e})=>{xW(e,t)},Y7=t=>t.children&&t.children.length>0?Y7(t.children[t.children.length-1]):t;class gx{constructor(e,n){this.std=e,this.point=n,this._blockFromPath=r=>{const o=this.std.view.viewFromPath("block",r);return D(o),o},this.block=this._blockFromPath(n.path),this.model=this.block.model;const i=this.model.text;D(i),this.text=i}}class CW{constructor(e,n,i){this.std=e,this.text=n,this.snapshot=i,this.canMerge=()=>{const a=this._textFromSnapshot(this.firstSnapshot),l=this._textFromSnapshot(this.lastSnapshot);return a&&l&&(this.fromPointState.text.length>0&&this.endPointState.text.length>0||this.firstSnapshotIsPlainText)},this._textFromSnapshot=a=>a.props.text,this._getDeltas=()=>{const a=this._textFromSnapshot(this.firstSnapshot),l=this._textFromSnapshot(this.lastSnapshot),c=this.fromPointState.text.sliceToDelta(0,this.fromPointState.point.index),d=this.endPointState.text.sliceToDelta(this.endPointState.point.index+this.endPointState.point.length,this.endPointState.text.length),u=a.delta,h=l.delta;return{firstTextSnapshot:a,lastTextSnapshot:l,fromDelta:c,toDelta:d,firstDelta:u,lastDelta:h}},this._mergeCode=()=>{const{firstTextSnapshot:a,fromDelta:l,toDelta:c}=this._getDeltas();this.firstSnapshot.flavour=this.fromPointState.model.flavour;const d=this.fromPointState.model.language;d!=="Plain Text"&&(this.firstSnapshot.props.language=d);const u=[...l];let h=0;for(const p of this.snapshot.content)if(p.props.text){const g=this._textFromSnapshot(p);h>0&&u.push({insert:`
`}),u.push(...g.delta),h++}else break;a.delta=u.concat(c),this.snapshot.content.splice(1,h),this.lastSnapshot=Y7(this.snapshot.content[this.snapshot.content.length-1])},this._mergeSingle=()=>{this.firstSnapshot.flavour=this.fromPointState.model.flavour,this.firstSnapshot.props.type&&(this.fromPointState.text.length>0||this.firstSnapshotIsPlainText)&&(this.firstSnapshot.props.type=this.fromPointState.model.type);const{firstTextSnapshot:a,fromDelta:l,toDelta:c,firstDelta:d}=this._getDeltas();a.delta=[...l,...d,...c]},this._mergeMultiple=()=>{this.firstSnapshot.flavour=this.fromPointState.model.flavour,this.firstSnapshot.props.type&&(this.fromPointState.text.length>0||this.firstSnapshotIsPlainText)&&(this.firstSnapshot.props.type=this.fromPointState.model.type),this.lastSnapshot.props.type&&this.to&&(this.lastSnapshot.flavour=this.endPointState.model.flavour,this.lastSnapshot.props.type=this.endPointState.model.type);const{firstTextSnapshot:a,lastTextSnapshot:l,fromDelta:c,toDelta:d,firstDelta:u,lastDelta:h}=this._getDeltas();a.delta=[...c,...u],l.delta=[...h,...d]},this.pasted=()=>{if(!(this.canMerge()||this.endPointState.text.length===0))return;const l=this.std.page.getBlockById(this.lastSnapshot.id);if(D(l),!this.to){this.std.page.deleteBlock(this.fromPointState.model,{bringChildrenTo:l});return}this.std.page.deleteBlock(this.endPointState.model,l?{bringChildrenTo:l}:void 0);const c=this.std.page.getParent(this.fromPointState.model);this.std.page.deleteBlock(this.fromPointState.model,c?{bringChildrenTo:c}:void 0)},this.focusPasted=()=>{const a=this.std.host,l=this.fromPointState.block.parentBlockElement,c=this.std.page.getBlockById(this.lastSnapshot.id);D(c),a.updateComplete.then(()=>{const d=l.querySelector(`[${a.blockIdAttr}="${c.id}"]`);if(D(d),!c.text){if(Ie(c,["affine:image"])){const p=this.std.selection.create("image",{path:d.path});this.std.selection.setGroup("note",[p]);return}const h=this.std.selection.create("block",{path:d.path});this.std.selection.setGroup("note",[h]);return}const u=this.std.selection.create("text",{from:{path:d.path,index:this.firstSnapshot===this.lastSnapshot?c.text?c.text.length-this.lastIndex:0:this.lastIndex,length:0},to:null});this.std.selection.setGroup("note",[u])}).catch(console.error)};const{from:r,to:o}=n,s=o??r;if(this.to=o,this.fromPointState=new gx(e,r),this.endPointState=new gx(e,s),this.firstSnapshot=i.content[0],this.lastSnapshot=Y7(i.content[i.content.length-1]),this.firstSnapshot!==this.lastSnapshot&&this.lastSnapshot.props.text){const a=sk(this.lastSnapshot.props.text);new nt.Y.Doc().getMap("temp").set("text",a.yText),this.lastIndex=a.length}else this.lastIndex=this.endPointState.text.length-s.index-s.length;this.firstSnapshotIsPlainText=this.firstSnapshot.flavour==="affine:paragraph"&&this.firstSnapshot.props.type==="text"}merge(){if(this.fromPointState.model.flavour==="affine:code"&&!this.to){this._mergeCode();return}if(this.firstSnapshot===this.lastSnapshot){this._mergeSingle();return}this._mergeMultiple()}}function kW(t){t.content[0]?.flavour==="affine:note"&&(t.content=t.content[0].children)}const oT=t=>({slots:e})=>{let n;e.beforeImport.on(i=>{if(i.type==="slice"){const{snapshot:r}=i;kW(r);const o=t.selection.find("text");if(!o)return;n=new CW(t,o,i.snapshot),n.canMerge()&&n.merge()}}),e.afterImport.on(i=>{n&&i.type==="slice"&&(n.pasted(),n.focusPasted())})};class sT{constructor(e){this._disposables=new dt,this._clipboardAdapter=new u6,this._mixtextAdapter=new tT,this._htmlAdapter=new Kg,this._imageAdapter=new cS,this._init=()=>{this._std.clipboard.registerAdapter(u6.MIME,this._clipboardAdapter,100),this._std.clipboard.registerAdapter("text/html",this._htmlAdapter,90),["image/apng","image/avif","image/gif","image/jpeg","image/png","image/svg+xml","image/webp"].map(r=>this._std.clipboard.registerAdapter(r,this._imageAdapter,80)),this._std.clipboard.registerAdapter("text/plain",this._mixtextAdapter,70);const n=_W(this._std),i=oT(this._std);this._std.clipboard.use(n),this._std.clipboard.use(i),this._std.clipboard.use(Y2),this._std.clipboard.use(Xl),this._disposables.add({dispose:()=>{this._std.clipboard.unregisterAdapter(u6.MIME),this._std.clipboard.unregisterAdapter("text/plain"),["image/apng","image/avif","image/gif","image/jpeg","image/png","image/svg+xml","image/webp"].map(r=>this._std.clipboard.unregisterAdapter(r)),this._std.clipboard.unregisterAdapter("text/html"),this._std.clipboard.unuse(n),this._std.clipboard.unuse(i),this._std.clipboard.unuse(Y2),this._std.clipboard.unuse(Xl)}})},this._copySelected=n=>this._std.command.pipe().withHost().with({onCopy:n}).getSelectedModels().copySelectedModels(),this.onPageCopy=n=>{n.get("clipboardState").raw.preventDefault(),this._copySelected().run()},this.onPageCut=n=>{n.get("clipboardState").raw.preventDefault(),this._copySelected(()=>{this._std.command.pipe().withHost().try(r=>[r.getTextSelection().deleteText(),r.getSelectedModels().deleteSelectedModels()]).run()}).run()},this.onPagePaste=n=>{const i=n.get("clipboardState").raw;i.preventDefault(),this._std.page.captureSync(),this._std.command.pipe().try(r=>[r.getTextSelection().inline((o,s)=>{const a=o.currentTextSelection;D(a);const l=a.to??a.from;s({currentSelectionPath:l.path})}),r.getBlockSelections().inline((o,s)=>{const a=o.currentBlockSelections;D(a);const l=a.at(-1);l&&s({currentSelectionPath:l.path})})]).getBlockIndex().inline((r,o)=>(D(r.parentBlock),this._std.clipboard.paste(i,this._std.page,r.parentBlock.model.id,r.blockIndex?r.blockIndex+1:void 0).catch(console.error),o())).run()},this.onBlockSnapshotPaste=(n,i,r,o)=>{this._std.command.pipe().inline((s,a)=>(this._std.clipboard.pasteBlockSnapshot(n,i,r,o).catch(console.error),a())).run()},this.host=e}get _std(){return this.host.std}hostConnected(){this._disposables.disposed&&(this._disposables=new dt),this.host.handleEvent("copy",this.onPageCopy),this.host.handleEvent("paste",this.onPagePaste),this.host.handleEvent("cut",this.onPageCut),this._init()}hostDisconnected(){this._disposables.dispose()}}class aT{constructor(e){this.pageElement=e,this._handleDelete=()=>{const n=this._currentSelection.filter(i=>i.is("block"));n.length!==0&&this._page.transact(()=>{const i=this._replaceBlocksBySelection(n,"affine:paragraph",{});i&&this._selection.set([this._selection.create("text",{from:{index:0,length:0,path:i.path},to:null})])})},this.pageElement.bindHotKey({"Mod-z":n=>{n.get("defaultState").event.preventDefault(),this._page.canUndo&&this._page.undo()},"Shift-Mod-z":n=>{n.get("defaultState").event.preventDefault(),this._page.canRedo&&this._page.redo()},"Control-y":n=>{UB&&(n.get("defaultState").event.preventDefault(),this._page.canRedo&&this._page.redo())},"Mod-Backspace":()=>!0,Backspace:this._handleDelete,Delete:this._handleDelete,"Control-d":()=>{Ag&&this._handleDelete()}},{global:!0})}get _page(){return this.pageElement.page}get _selection(){return this.pageElement.host.selection}get _currentSelection(){return this._selection.value}_deleteBlocksBySelection(e){e.forEach(n=>{const i=this._page.getBlockById(n.blockId);i&&this._page.deleteBlock(i)})}_replaceBlocksBySelection(e,n,i){const r=e[0],o=this._page.getBlockById(r.blockId),s=this.pageElement.host.view.viewFromPath("block",r.path);D(o,`Cannot find block ${r.blockId}`),D(s,`Cannot find block view ${r.path.join(" -> ")}`);const a=s.parentPath,l=this._page.getParent(o),c=l?.children.indexOf(o);this._deleteBlocksBySelection(e);try{this._page.schema.validate(n,l?.flavour)}catch{return null}const d=this._page.addBlock(n,i,l,c);return{blockId:d,path:a.concat(d)}}}var EW=Object.defineProperty,SW=Object.getOwnPropertyDescriptor,lT=(t,e,n,i)=>{for(var r=i>1?void 0:i?SW(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&EW(e,n,r),r};const xf=24;function TW(t,e,n,i,r,o){const s=e+(n-i)/2+r,a=e+(n-i)/2+i-o;return t.raw.clientX<s||t.raw.clientX>a}let Kl=class extends wn{constructor(){super(...arguments),this.keyboardManager=null,this.clipboardController=new sT(this),this.slots={draggingAreaUpdated:new Ve,selectedRectsUpdated:new Ve,embedRectsUpdated:new Ve,embedEditingStateUpdated:new Ve,pageLinkClicked:new Ve,tagClicked:new Ve,viewportUpdated:new Ve},this._viewportElement=null,this.prependParagraphWithText=t=>{const e=this.page.addBlock("affine:paragraph",{text:t},this._getDefaultNoteBlock(),0);this.host.event.activate(),$n(this.host,this.page,e)?.catch(console.error)},this.focusFirstParagraph=()=>{const t=this._getDefaultNoteBlock(),e=t?.children.find(n=>Ie(n,["affine:paragraph","affine:list","affine:code"]));if(e)$n(this.host,this.page,e.id)?.catch(console.error);else{const n=this.page.addBlock("affine:paragraph",{},t,0);$n(this.host,this.page,n)?.catch(console.error)}}}get viewportElement(){return this._viewportElement?this._viewportElement:(this._viewportElement=this.host.closest(".affine-doc-viewport"),D(this._viewportElement),this._viewportElement)}get viewport(){const{scrollLeft:t,scrollTop:e,scrollWidth:n,scrollHeight:i,clientWidth:r,clientHeight:o}=this.viewportElement,{top:s,left:a}=this.viewportElement.getBoundingClientRect();return{top:s,left:a,scrollLeft:t,scrollTop:e,scrollWidth:n,scrollHeight:i,clientWidth:r,clientHeight:o}}_createDefaultNoteBlock(){const{page:t}=this,e=t.addBlock("affine:note",{},t.root?.id);return t.getBlockById(e)}_getDefaultNoteBlock(){return this.page.root?.children.find(t=>t.flavour==="affine:note")??this._createDefaultNoteBlock()}_initViewportResizeEffect(){new ResizeObserver(e=>{for(const{target:n}of e)if(n===this.viewportElement){this.slots.viewportUpdated.emit(this.viewport);break}}).observe(this.viewportElement)}firstUpdated(){this._initViewportResizeEffect(),this.model.children.filter(e=>Ie(e,["affine:note"])).forEach(e=>{this.disposables.add(e.propsUpdated.on(({key:n})=>{n==="displayMode"&&this.requestUpdate()}))})}connectedCallback(){super.connectedCallback(),this.clipboardController.hostConnected(),this.keyboardManager=new aT(this),this.bindHotKey({ArrowUp:()=>{const t=this.host.view,n=this.host.selection.value.find(l=>l.is("text")||l.is("block"));if(!n)return;const i=t.findPrev(n.path,(l,c,d)=>{if(l.type==="block"&&d.view===this)return!0});if(!i||this.childBlockElements.filter(l=>l.model.flavour==="affine:note").indexOf(i.view)!==0)return;const s=i.children[0];if(!s||!gt.equals(s.path,n.path))return;const a=this.host.rangeManager?.value;requestAnimationFrame(()=>{const l=this.host.rangeManager?.value;if(!(!a||!l)&&a.startContainer===l.startContainer&&a.startOffset===l.startOffset&&a.endContainer===l.endContainer&&a.endOffset===l.endOffset){const c=Rk(this.host);c&&c.focusEnd()}})}}),this.handleEvent("click",t=>{const e=t.get("pointerState");if(e.raw.target!==this&&e.raw.target!==this.viewportElement&&e.raw.target!==this.pageBlockContainer)return;const{paddingLeft:n,paddingRight:i}=window.getComputedStyle(this.pageBlockContainer);if(TW(e,this.viewport.left,this.viewport.clientWidth,this.pageBlockContainer.clientWidth,parseFloat(n),parseFloat(i)))return;let o=null;const s=this.model.page.readonly,a=this.model.children.slice().reverse().find(l=>{if(!Ie(l,["affine:note"]))return!1;const d=l;return!!d.displayMode&&d.displayMode!==qe.EdgelessOnly});if(a){const l=a.children.at(-1);if(!l||!l.text||Ie(l,["affine:code","affine:divider","affine:image","affine:database","affine:bookmark","affine:attachment","affine:surface-ref"])||/affine:embed-*/.test(l.flavour)){if(s)return;const c=this.page.addBlock("affine:paragraph",{},a.id);o=[this.model.id,a.id,c]}}else{if(s)return;const l=this.page.addBlock("affine:note",{},this.model.id),c=this.page.addBlock("affine:paragraph",{},l);o=[this.model.id,l,c]}this.updateComplete.then(()=>{o&&this.host.selection.setGroup("note",[this.host.selection.create("text",{from:{path:o,index:0,length:0},to:null})])}).catch(console.error)})}disconnectedCallback(){super.disconnectedCallback(),this.clipboardController.hostDisconnected(),this._disposables.dispose(),this.keyboardManager=null}renderBlock(){const t=b`${Fe(this.model.children.filter(n=>{const i=Ie(n,["affine:note"]),r=n,o=!!r.displayMode&&r.displayMode===qe.EdgelessOnly;return!(i&&(o||r.hidden))}),n=>n.id,n=>this.renderModel(n))}`,e=b`${Fe(Object.entries(this.widgets),([n])=>n,([n,i])=>i)}`;return b`
      <div class="affine-doc-page-block-container">${t} ${e}</div>
    `}};Kl.styles=X`
    .affine-doc-page-block-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      font-family: var(--affine-font-family);
      font-size: var(--affine-font-base);
      line-height: var(--affine-line-height);
      color: var(--affine-text-primary-color);
      font-weight: 400;
      max-width: var(--affine-editor-width);
      margin: 0 auto;
      /* cursor: crosshair; */
      cursor: default;

      /* Leave a place for drag-handle */
      /* Do not use prettier format this style, or it will be broken */
      /* prettier-ignore */
      padding-left: var(--affine-editor-side-padding, ${xf}px);
      /* prettier-ignore */
      padding-right: var(--affine-editor-side-padding, ${xf}px);
    }

    /* Extra small devices (phones, 640px and down) */
    @container viewport (width <= 640px) {
      .affine-doc-page-block-container {
        padding-left: ${xf}px;
        padding-right: ${xf}px;
      }
    }

    .affine-block-element {
      display: block;
    }

    @media print {
      .selected {
        background-color: transparent !important;
      }
    }
  `;lT([he(".affine-doc-page-block-container")],Kl.prototype,"pageBlockContainer",2);Kl=lT([W("affine-doc-page")],Kl);function IW(t){const e=[],n=t.children.slice(),i=r=>{for(const o of r)o.flavour!=="affine:note"&&e.push(o),o.children.length&&i(o.children)};return i(n),e}var LW=Object.defineProperty,MW=Object.getOwnPropertyDescriptor,io=(t,e,n,i)=>{for(var r=i>1?void 0:i?MW(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&LW(e,n,r),r};const PW=280,AW=166,$W=X`
  .frame-preview-container {
    display: block;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    position: relative;
  }

  .frame-preview-surface-container {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    overflow: hidden;
  }

  .frame-preview-surface-viewport {
    max-width: 100%;
    box-sizing: border-box;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    pointer-events: none;
    user-select: none;
  }

  .frame-preview-surface-canvas-container {
    height: 100%;
    width: 100%;
    position: relative;
  }
`;let yi=class extends me(De){constructor(){super(...arguments),this.edgeless=null,this.surfaceWidth=PW,this.surfaceHeight=AW,this.fillScreen=!1,this._surfaceModel=null,this._surfaceRefRendererId=Oe(),this._edgelessDisposables=null,this._pageDisposables=null,this._frameDisposables=null,this._getViewportWH=t=>{const[,,e,n]=Wn(t.xywh);let i=1;return this.fillScreen?i=Math.max(this.surfaceWidth/e,this.surfaceHeight/n):i=Math.min(this.surfaceWidth/e,this.surfaceHeight/n),{width:e*i,height:n*i}},this._clearEdgelessDisposables=()=>{this._edgelessDisposables?.dispose(),this._edgelessDisposables=null},this._clearPageDisposables=()=>{this._pageDisposables?.dispose(),this._pageDisposables=null},this._clearFrameDisposables=()=>{this._frameDisposables?.dispose(),this._frameDisposables=null}}get surfaceRenderer(){return this._surfaceRefRenderer.surfaceRenderer}_attachRenderer(){this._surfaceRefRenderer?.surfaceRenderer.canvas.isConnected||!this.container||this.surfaceRenderer.attach(this.container)}get _surfaceRefService(){const t=this.host.spec.getService("affine:surface-ref");return D(t,"SurfaceRefBlockService not found"),t}_setupSurfaceRefRenderer(){const e=this._surfaceRefService.getRenderer(this._surfaceRefRendererId);this._surfaceRefRenderer=e,this._disposables.add(e.slots.surfaceModelChanged.on(n=>{this._surfaceModel=n})),this._disposables.add(e.slots.surfaceRendererRefresh.on(()=>{this.requestUpdate()})),e.mount()}_cleanupSurfaceRefRenderer(){this._surfaceRefService.removeRenderer(this._surfaceRefRendererId)}_refreshViewport(){if(!this.frame)return;const t=this.frame;this.requestUpdate(),this.updateComplete.then(()=>{this.surfaceRenderer.onResize(),this.surfaceRenderer.setViewportByBound(ne.fromXYWH(Wn(t.xywh))),this.blocksPortal?.setViewport(this.surfaceRenderer)}).catch(console.error)}_tryLoadFillScreen(){this.fillScreen=this.edgeless.service.editSession.getItem("presentFillScreen")??!1}_setEdgelessDisposables(t){this._clearEdgelessDisposables(),t&&(this._edgelessDisposables=new dt,this._edgelessDisposables.add(t.slots.navigatorSettingUpdated.on(({fillScreen:e})=>{e!==void 0&&(this.fillScreen=e,this._refreshViewport())})))}_setPageDisposables(t){this._clearPageDisposables(),this._pageDisposables=new dt,this._pageDisposables.add(t.slots.blockUpdated.on(e=>{const{type:n,flavour:i}=e;if(!["affine:image","affine:note"].includes(i))return;const o=ne.deserialize(this.frame.xywh);if(n==="delete"){const s=e.model,a=ne.deserialize(s.xywh);o.containsPoint([a.x,a.y])&&this._refreshViewport()}else{const s=t.getBlockById(e.id);if(!s)return;const a=ne.deserialize(s.xywh);o.containsPoint([a.x,a.y])&&this._refreshViewport()}}))}_setFrameDisposables(t){this._clearFrameDisposables(),this._frameDisposables=new dt,this._frameDisposables.add(t.propsUpdated.on(()=>{this._refreshViewport()}))}_renderSurfaceContent(t){const{width:e,height:n}=this._getViewportWH(t);return b`<div
      class="frame-preview-surface-container"
      style=${we({width:`${this.surfaceWidth}px`,height:`${this.surfaceHeight}px`})}
    >
      <div
        style=${we({backgroundColor:t.background?`var(${t.background})`:"var(--affine-platte-transparent)",borderRadius:"4px"})}
      >
        <div
          class="frame-preview-surface-viewport"
          style=${we({width:`${e}px`,height:`${n}px`,aspectRatio:`${e} / ${n}`})}
        >
          <surface-ref-portal
            .page=${this.page}
            .host=${this.host}
            .containerModel=${t}
            .renderModel=${this.host.renderModel}
          ></surface-ref-portal>
          <div class="frame-preview-surface-canvas-container">
            <!-- attach canvas here -->
          </div>
        </div>
      </div>
    </div>`}connectedCallback(){super.connectedCallback(),this._tryLoadFillScreen(),this._setupSurfaceRefRenderer(),this._setPageDisposables(this.page),this._setEdgelessDisposables(this.edgeless),this._setFrameDisposables(this.frame)}updated(t){t.has("frame")&&(this._refreshViewport(),this._setFrameDisposables(this.frame)),t.has("edgeless")&&(this.edgeless?this._setEdgelessDisposables(this.edgeless):this._clearEdgelessDisposables()),t.has("page")&&this._setPageDisposables(this.page),this._attachRenderer()}disconnectedCallback(){super.disconnectedCallback(),this._cleanupSurfaceRefRenderer(),this._clearEdgelessDisposables(),this._clearPageDisposables(),this._clearFrameDisposables()}render(){const{_surfaceModel:t,frame:e,host:n}=this,i=!t||!e||!e.xywh||!n;return b`<div class="frame-preview-container">
      ${i?ae:this._renderSurfaceContent(e)}
    </div>`}};yi.styles=$W;io([L({attribute:!1})],yi.prototype,"edgeless",2);io([L({attribute:!1})],yi.prototype,"frame",2);io([L({attribute:!1})],yi.prototype,"page",2);io([L({attribute:!1})],yi.prototype,"host",2);io([L({attribute:!1})],yi.prototype,"surfaceWidth",2);io([L({attribute:!1})],yi.prototype,"surfaceHeight",2);io([ie()],yi.prototype,"fillScreen",2);io([ie()],yi.prototype,"_surfaceModel",2);io([he(".frame-preview-surface-canvas-container")],yi.prototype,"container",2);io([he(".frame-preview-surface-container surface-ref-portal")],yi.prototype,"blocksPortal",2);yi=io([W("frame-preview")],yi);function mx(t,e,n,i=r=>r){return t*i(.5-e*(.5-n))}function BW(t){return[-t[0],-t[1]]}function Fr(t,e){return[t[0]+e[0],t[1]+e[1]]}function hr(t,e){return[t[0]-e[0],t[1]-e[1]]}function Nr(t,e){return[t[0]*e,t[1]*e]}function DW(t,e){return[t[0]/e,t[1]/e]}function zu(t){return[t[1],-t[0]]}function bx(t,e){return t[0]*e[0]+t[1]*e[1]}function OW(t,e){return t[0]===e[0]&&t[1]===e[1]}function RW(t){return Math.hypot(t[0],t[1])}function NW(t){return t[0]*t[0]+t[1]*t[1]}function vx(t,e){return NW(hr(t,e))}function cT(t){return DW(t,RW(t))}function HW(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function ju(t,e,n){const i=Math.sin(n),r=Math.cos(n),o=t[0]-e[0],s=t[1]-e[1],a=o*r-s*i,l=o*i+s*r;return[a+e[0],l+e[1]]}function X7(t,e,n){return Fr(t,Nr(hr(e,t),n))}function yx(t,e,n){return Fr(t,Nr(e,n))}const{min:t1,PI:FW}=Math,wx=.275,Gu=FW+1e-4;function UW(t,e={}){const{size:n=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:s=Q=>Q,start:a={},end:l={},last:c=!1}=e,{cap:d=!0,easing:u=Q=>Q*(2-Q)}=a,{cap:h=!0,easing:p=Q=>--Q*Q*Q+1}=l;if(t.length===0||n<=0)return[];const g=t[t.length-1].runningLength,f=a.taper===!1?0:a.taper===!0?Math.max(n,g):a.taper,v=l.taper===!1?0:l.taper===!0?Math.max(n,g):l.taper,m=Math.pow(n*i,2),y=[],x=[];let T=t.slice(0,10).reduce((Q,Le)=>{let ue=Le.pressure;if(o){const H=t1(1,Le.distance/n),ee=t1(1,1-H);ue=t1(1,Q+(ee-Q)*(H*wx))}return(Q+ue)/2},t[0].pressure),M=mx(n,r,t[t.length-1].pressure,s),k,_=t[0].vector,A=t[0].point,$=A,E=A,R=$,I=!1;for(let Q=0;Q<t.length;Q++){let{pressure:Le}=t[Q];const{point:ue,vector:H,distance:ee,runningLength:K}=t[Q];if(Q<t.length-1&&g-K<3)continue;if(r){if(o){const Ue=t1(1,ee/n),lt=t1(1,1-Ue);Le=t1(1,T+(lt-T)*(Ue*wx))}M=mx(n,r,Le,s)}else M=n/2;k===void 0&&(k=M);const U=K<f?u(K/f):1,Ee=g-K<v?p((g-K)/v):1;M=Math.max(.01,M*Math.min(U,Ee));const xe=(Q<t.length-1?t[Q+1]:t[Q]).vector,Pe=Q<t.length-1?bx(H,xe):1,le=bx(H,_)<0&&!I,He=Pe!==null&&Pe<0;if(le||He){const Ue=Nr(zu(_),M);for(let lt=1/13,et=0;et<=1;et+=lt)E=ju(hr(ue,Ue),ue,Gu*et),y.push(E),R=ju(Fr(ue,Ue),ue,Gu*-et),x.push(R);A=E,$=R,He&&(I=!0);continue}if(I=!1,Q===t.length-1){const Ue=Nr(zu(H),M);y.push(hr(ue,Ue)),x.push(Fr(ue,Ue));continue}const Ne=Nr(zu(X7(xe,H,Pe)),M);E=hr(ue,Ne),(Q<=1||vx(A,E)>m)&&(y.push(E),A=E),R=Fr(ue,Ne),(Q<=1||vx($,R)>m)&&(x.push(R),$=R),T=Le,_=H}const N=t[0].point.slice(0,2),P=t.length>1?t[t.length-1].point.slice(0,2):Fr(t[0].point,[1,1]),Z=[],pe=[];if(t.length===1){if(!(f||v)||c){const Q=yx(N,cT(zu(hr(N,P))),-(k||M)),Le=[];for(let ue=1/13,H=ue;H<=1;H+=ue)Le.push(ju(Q,N,Gu*2*H));return Le}}else{if(!(f||v&&t.length===1))if(d)for(let Le=1/13,ue=Le;ue<=1;ue+=Le){const H=ju(x[0],N,Gu*ue);Z.push(H)}else{const Le=hr(y[0],x[0]),ue=Nr(Le,.5),H=Nr(Le,.51);Z.push(hr(N,ue),hr(N,H),Fr(N,H),Fr(N,ue))}const Q=zu(BW(t[t.length-1].vector));if(v||f&&t.length===1)pe.push(P);else if(h){const Le=yx(P,Q,M);for(let ue=1/29,H=ue;H<1;H+=ue)pe.push(ju(Le,P,Gu*3*H))}else pe.push(Fr(P,Nr(Q,M)),Fr(P,Nr(Q,M*.99)),hr(P,Nr(Q,M*.99)),hr(P,Nr(Q,M)))}return y.concat(pe,x.reverse(),Z)}function VW(t,e={}){const{streamline:n=.5,size:i=16,last:r=!1}=e;if(t.length===0)return[];const o=.15+(1-n)*.85;let s=Array.isArray(t[0])?t:t.map(({x:h,y:p,pressure:g=.5})=>[h,p,g]);if(s.length===2){const h=s[1];s=s.slice(0,-1);for(let p=1;p<5;p++)s.push(X7(s[0],h,p/4))}s.length===1&&(s=[...s,[...Fr(s[0],[1,1]),...s[0].slice(2)]]);const a=[{point:[s[0][0],s[0][1]],pressure:s[0][2]>=0?s[0][2]:.25,vector:[1,1],distance:0,runningLength:0}];let l=!1,c=0,d=a[0];const u=s.length-1;for(let h=1;h<s.length;h++){const p=r&&h===u?s[h].slice(0,2):X7(d.point,s[h],o);if(OW(d.point,p))continue;const g=HW(p,d.point);if(c+=g,h<u&&!l){if(c<i)continue;l=!0}d={point:p,pressure:s[h][2]>=0?s[h][2]:.5,vector:cT(hr(d.point,p)),distance:g,runningLength:c},a.push(d)}return a[0].vector=a[1]?.vector||[0,0],a}function dT(t,e={}){return UW(VW(t,e),e)}function zW(t,e){return dT(t,{size:e,thinning:.6,streamline:.5,smoothing:.5,easing:n=>Math.sin(n*Math.PI/2),simulatePressure:!0})}function jW(t,e,n,i){const{points:r,lineWidth:o,color:s,rotate:a}=t,[,,l,c]=t.deserializedXYWH,d=l/2,u=c/2;e.setTransform(n.translateSelf(d,u).rotateSelf(a).translateSelf(-d,-u));const h=zW(r,o),p=bk(h),g=new Path2D(p);e.fillStyle=i.getVariableColor(s),e.fill(g)}const uT=15;function hT(t,e=10,n,i,r="Rear",o=Math.PI/4){const s=v9(t,n,r,i),a=te.mul(s.tangent,-1),l=r==="Front"?Math.PI:0;return{points:[te.add(te.mul(te.rot(a,l+o),e),s),s,te.add(te.mul(te.rot(a,l-o),e),s)]}}function GW(t,e=5,n,i,r="Rear"){const o=v9(t,n,r,i),s=te.mul(o.tangent,-1),a=r==="Front"?Math.PI:0;return te.add(te.mul(te.rot(s,a),e),o)}function v9(t,e,n,i){const r=n==="Rear"?t.length-1:0,o=n==="Rear"?r-1:r+1,s=t[r],a=t[o],l=s.clone();let c;return e!==Hl.Curve?c=n==="Rear"?te.tangent(s,a):te.tangent(a,s):c=n==="Rear"?Yy(i,1):Yy(i,0),l.tangent=c??[],l}function ZW(t,e=10,n="Rear"){const i=te.mul(t.tangent,-1),r=n==="Front"?Math.PI:0;return{points:[te.add(te.mul(te.rot(i,r+Math.PI*.25),e),t),t,te.add(te.mul(te.rot(i,r-Math.PI*.25),e),t),te.add(te.mul(te.rot(i,r),e*Math.sqrt(2)),t)]}}function WW(t,e,n){const{stroke:i}=e,r=n.getVariableColor(i);return{end:t,seed:e.seed,mode:e.mode,rough:e.rough,roughness:e.roughness,strokeColor:r,strokeWidth:e.strokeWidth,fillColor:r,fillStyle:"solid",bezierParameters:Nm(e.absolutePath)}}function r3(t){const{seed:e,roughness:n,strokeWidth:i,strokeColor:r,fillColor:o}=t;return{seed:e,roughness:n,stroke:r,strokeWidth:i,fill:o,fillStyle:"solid"}}function y9(t,e,n,i,r=!0){t.fillStyle=n,t.strokeStyle=n,t.lineWidth=i,t.lineJoin="round",t.lineCap="round",t.save(),t.beginPath();for(let o=0;o<e.length;o++)o===0?t.moveTo(e[o][0],e[o][1]):t.lineTo(e[o][0],e[o][1]);r&&(t.closePath(),t.fill()),t.stroke(),t.restore()}function qW(t,e,n,i){const{mode:r,end:o,bezierParameters:s,rough:a,strokeColor:l,strokeWidth:c}=i,d=Math.PI/4,u=uT*(c/2),{points:h}=hT(t,u,r,s,o,d);a?n.linearPath(h,r3(i)):y9(e,h,l,c,!1)}function YW(t,e,n,i){const{mode:r,end:o,bezierParameters:s,rough:a,strokeColor:l,strokeWidth:c}=i,d=Math.PI/6,u=uT*(c/2),{points:h}=hT(t,u,r,s,o,d);a?n.polygon([[h[0][0],h[0][1]],[h[1][0],h[1][1]],[h[2][0],h[2][1]]],r3(i)):y9(e,h,l,c)}function XW(t,e,n,i){const{mode:r,end:o,rough:s,bezierParameters:a,strokeColor:l,strokeWidth:c}=i,d=v9(t,r,o,a),u=10*(c/2),{points:h}=ZW(d,u,o);s?n.polygon([[h[0][0],h[0][1]],[h[1][0],h[1][1]],[h[2][0],h[2][1]],[h[3][0],h[3][1]]],r3(i)):y9(e,h,l,c)}function KW(t,e,n,i){const{bezierParameters:r,mode:o,end:s,fillColor:a,strokeColor:l,strokeWidth:c,rough:d}=i,u=5*(c/2),h=GW(t,u,o,r,s),p=h[0],g=h[1];d?n.circle(p,g,u+2,r3(i)):(e.fillStyle=a,e.strokeStyle=l,e.lineWidth=c,e.save(),e.beginPath(),e.ellipse(p,g,u,u,0,0,2*Math.PI),e.closePath(),e.fill(),e.stroke(),e.restore())}function QW(t,e,n,i){const{absolutePath:r,mode:o,frontEndpointStyle:s,rearEndpointStyle:a}=t;if(!r.length||r.length<2)return;const[l,c]=t.deserializedXYWH;e.setTransform(n.translateSelf(-l,-c)),JW(t,e,i,r,t.strokeStyle==="dash",o===Hl.Curve),xx(t,r,e,i,"Front",s),xx(t,r,e,i,"Rear",a)}function JW(t,e,n,i,r,o){const{seed:s,stroke:a,strokeWidth:l,roughness:c,rough:d}=t,u=n.rc,h=n.getVariableColor(a);if(d){const p={seed:s,roughness:c,strokeLineDash:r?[12,12]:void 0,stroke:h,strokeWidth:l};if(o){const g=Nm(t.absolutePath);u.path(`M${g[0][0]},${g[0][1]} C${g[1][0]},${g[1][1]} ${g[2][0]},${g[2][1]}  ${g[3][0]},${g[3][1]} `,p)}else u.linearPath(i,p)}else e.save(),e.strokeStyle=h,e.lineWidth=t.strokeWidth,e.lineJoin="round",r&&e.setLineDash([12,12]),e.beginPath(),o?i.forEach((p,g)=>{if(g===0)e.moveTo(p[0],p[1]);else{const f=i[g-1];e.bezierCurveTo(f.absOut[0],f.absOut[1],p.absIn[0],p.absIn[1],p[0],p[1])}}):i.forEach((p,g)=>{g===0?e.moveTo(p[0],p[1]):e.lineTo(p[0],p[1])}),e.stroke(),e.closePath(),e.restore()}function xx(t,e,n,i,r,o){const s=WW(r,t,i),a=i.rc;switch(o){case"Arrow":qW(e,n,a,s);break;case"Triangle":YW(e,n,a,s);break;case"Circle":KW(e,n,a,s);break;case"Diamond":XW(e,n,a,s);break}}const pT=function(){let e=null,n=null;return()=>(n||(n=document.createElement("canvas"),e=n.getContext("2d")),e)}();function Ic({fontStyle:t,fontWeight:e,fontSize:n,fontFamily:i}){const r=tl(i,n);return`${t} ${e} ${n}px/${r}px ${Lh(i)}, sans-serif`.trim()}const h6=new Map;function tl(t,e){const n=pT(),i=Lh(t);if(h6.has(i)){const a=h6.get(i);return e/a.fontSize*a.lineHeight}const r=`${e}px ${Lh(t)}`;n.font=`${e}px ${Lh(t)}`;const o=n.measureText("M"),s=o.fontBoundingBoxAscent+o.fontBoundingBoxDescent;return r===n.font&&h6.set(i,{fontSize:e,lineHeight:s}),s}function Lh(t){return`"${t}"`}function eq(t){const e=[];let n=t.insert;for(;n.length>0;){const i=n.indexOf(`
`);if(i===-1){e.push({insert:n,attributes:t.attributes});break}n.slice(0,i).length>0&&e.push({insert:n.slice(0,i),attributes:t.attributes}),e.push(`
`),n=n.slice(i+1)}return e}function j1(t){if(t.length===0)return[[]];const e=t.flatMap(eq);function*n(i){let r=0;for(let o=0;o<i.length;o++)if(i[o]===`
`){const s=i.slice(r,o);r=o+1,yield s}else o===i.length-1&&(yield i.slice(r));i.at(-1)===`
`&&(yield[])}return Array.from(n(e))}const tq="A-Za-z--------",nq="---",iq=new RegExp(`^[^${tq}]*[${nq}]`);function fT(t){return iq.test(t)}function rq(t){return t.replace(/\t/g,"        ").replace(/\r?\n|\r/g,`
`)}function oq(t){return rq(t).split(`
`)}function Fl(t,e){const n=pT();return e!==n.font&&(n.font=e),n.measureText(t).width}function Ul(t,e){const n=oq(t);let i=0;return n.forEach(r=>{i=Math.max(i,Fl(r,e))}),i}function w9(t,e,n){return t.toDelta().flatMap(r=>({insert:_9(r.insert,e,n),attributes:r.attributes}))}const x9=(()=>{const t={};return{calculate:(i,r)=>{const o=i.charCodeAt(0);if(t[r]||(t[r]=[]),!t[r][o]){const s=Fl(i,r);t[r][o]=s}return t[r][o]},getCache:i=>t[i]}})();function sq(t){const e=t.split("-");return e.length>1&&e.forEach((n,i)=>{i!==e.length-1&&(e[i]=n+="-")}),e.join(" ").split(" ")}function _9(t,e,n){if(!Number.isFinite(n)||n<0)return t;const i=[],r=t.split(`
`),o=Fl(" ",e);let s="",a=0;const l=d=>{d.trim()&&i.push(d)},c=()=>{s="",a=0};return r.forEach(d=>{if(Ul(d,e)<=n){i.push(d);return}const h=sq(d);c();let p=0;for(;p<h.length;){const g=Fl(h[p],e);if(g===n)l(h[p]),p++;else if(g>n){for(l(s),c();h[p].length>0;){const f=String.fromCodePoint(h[p].codePointAt(0)),v=x9.calculate(f,e);a+=v,h[p]=h[p].slice(f.length),a>=n?(l(s),s=f,a=v):s+=f}a+o>=n?(l(s),c()):s.endsWith("-")||(s+=" ",a+=o),p++}else for(;a<n&&p<h.length;){const f=h[p];if(a=Fl(s+f,e),a>n){l(s),c();break}p++;const v=!f.endsWith("-");if(s+=f,v&&(s+=" "),a+o>=n){v?i.push(s.slice(0,-1)):i.push(s),c();break}}}s.slice(-1)===" "&&(s=s.slice(0,-1),l(s))}),i.join(`
`)}const aq=(t,e,n)=>{let i=0,r=0;for(;r<t.length;r++){const o=t[r];if(i+=x9.calculate(o,e),i>n)break}return t.slice(0,r)};function lq(t,e){const n=Bt(t)[0],i=bi([[e.x,e.y]],n,-t.rotate)[0];return[Math.floor((i[1]-n[1])/tl(t.fontFamily,t.fontSize)),i[0]-n[0]]}function cq(t,e){const[n,i]=lq(t,e),r=Ic(t),o=w9(t.text,r,t.w),s=j1(o).map(u=>u.map(h=>h.insert).join("")),a=s[n];let l=s.slice(0,n).join("").length-1,c=0,d=0;for(;c<i&&(l+=1,d!==a.length);)c+=x9.calculate(a[d],r),d+=1;return l}function gT(t,e,n=!1){if(!t.text)return e;const i=t.text,{fontStyle:r,fontWeight:o,fontSize:s,fontFamily:a}=t,l=tl(a,s),c=Ic({fontStyle:r,fontWeight:o,fontSize:s,fontFamily:a});let d=[];const u=i.toDelta(),h=[...i.toString()].map(f=>Ul(f,c)).sort((f,v)=>f-v).pop()??Ul("W",c);e.w<h&&(e.w=h);const p=e.w,g=u.flatMap(f=>({insert:_9(f.insert,c,p),attributes:f.attributes}));if(d=j1(g),!n&&!t.hasMaxWidth){d=j1(u);const f=Math.max(...i.toString().split(`
`).map(v=>Ul(v,c)));e.w=f}return e.h=l*d.length,e}function C9(t){return[...document.fonts.keys()].filter(n=>n.family===t).filter((n,i,r)=>r.findIndex(o=>o.family===n.family&&o.weight===n.weight&&o.style===n.style)===i)}function dq(t,e){return!!C9(t).find(r=>r.weight===e)}function uq(t,e){return!!C9(t).find(r=>r.style===e)}const mT=r0.Inter,hq=16,_f=[10,4];function pq(t,e){let n=t.title.toJSON();const i=fq(e),r=Fl(n,i),o=tl(mT,hq/e),s=t.elementBound,a=[Math.min(_f[0]/e,_f[0]),Math.min(_f[1]/e,_f[1])],l=Math.max(4/e,2),c=Math.min(4,o/2);let d=r+a[0]*2;const u=o+a[1]*2+l;return d>s.w&&(n=aq(n,i,s.w-10),n=n.slice(0,n.length-1)+"..",d=s.w),{radius:c,font:i,bound:s,text:n,titleWidth:d,titleHeight:u,lineHeight:o,padding:a,offset:l,titleBound:new ne(s.x,s.y-u,d,u)}}function fq(t){const e=16/t;return Ic({fontSize:e,fontFamily:mT,fontWeight:ha.Regular,fontStyle:"normal"})}function gq(t,e,n,i){const{xywh:r}=t,o=i.provider.selectedElements?.()||[];if(e.setTransform(n),o.includes(t.id))_x(t,e,i);else if(t.childElements.some(s=>o.includes(s.id))){const s=ne.deserialize(r);e.setLineDash([2,2]),e.strokeStyle=i.getVariableColor("--affine-blue"),e.lineWidth=1,e.strokeRect(0,0,s.w,s.h),_x(t,e,i)}}function _x(t,e,n){const i=n.zoom,{titleWidth:r,text:o,lineHeight:s,font:a,padding:l,offset:c,radius:d,titleBound:u}=pq(t,i);t.showTitle&&(t.externalXYWH=u.serialize(),e.translate(0,-c),e.beginPath(),e.roundRect(0,-s-l[1]*2,r,s+l[1]*2,d),e.fillStyle="#E3E2E4",e.fill(),e.font=a,e.fillStyle="#424149",e.textAlign="left",e.textBaseline="middle",e.fillText(o,l[0],-s/2-l[1]))}const mo=20;function o3(t,e,n){const i=Math.max(e.strokeWidth,0),r=e.w-i,o=e.h-i;switch(e.shapeType){case"rect":mq(t,0,0,r,o,e.radius??0);break;case"diamond":bq(t,0,0,r,o);break;case"ellipse":vq(t,0,0,r,o);break;case"triangle":yq(t,0,0,r,o)}switch(t.lineWidth=e.strokeWidth,t.strokeStyle=n.getVariableColor(e.strokeColor),t.fillStyle=n.getVariableColor(e.fillColor),e.strokeStyle){case"none":t.strokeStyle="transparent";break;case"dash":t.setLineDash([12,12]),t.strokeStyle=n.getVariableColor(e.strokeStyle);break;default:t.strokeStyle=n.getVariableColor(e.strokeStyle)}t.fill(),t.stroke()}function mq(t,e,n,i,r,o){const s=Math.max(Math.min(i*o,r*o),0);t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+i-s,n),t.arcTo(e+i,n,e+i,n+s,s),t.lineTo(e+i,n+r-s),t.arcTo(e+i,n+r,e+i-s,n+r,s),t.lineTo(e+s,n+r),t.arcTo(e,n+r,e,n+r-s,s),t.lineTo(e,n+s),t.arcTo(e,n,e+s,n,s),t.closePath()}function bq(t,e,n,i,r){t.beginPath(),t.moveTo(i/2,n),t.lineTo(i,r/2),t.lineTo(i/2,r),t.lineTo(e,r/2),t.closePath()}function vq(t,e,n,i,r){const o=i/2,s=r/2;t.beginPath(),t.ellipse(o,s,i/2,r/2,0,0,2*Math.PI),t.closePath()}function yq(t,e,n,i,r){t.beginPath(),t.moveTo(i/2,n),t.lineTo(i,r),t.lineTo(e,r),t.closePath()}function wq(t,e){return e==="center"?t/2:e==="right"?t-mo:mo}function xq(t,e,n,i){return i==="center"?(n-e*t.length)/2:i==="top"?mo:n-e*t.length-mo}function k9(t,e){if(!t.text)return e;const n=t.text,{fontFamily:i,fontSize:r,fontStyle:o,fontWeight:s}=t,a=tl(i,r),l=Ic({fontStyle:o,fontWeight:s,fontSize:r,fontFamily:i}),c=[...n.toString()].map(h=>Ul(h,l)).sort((h,p)=>h-p).pop()??Ul("W",l);e.w<c+mo*2&&(e.w=c+mo*2);const d=n.toDelta().flatMap(h=>({insert:_9(h.insert,l,e.w-mo*2),attributes:h.attributes})),u=j1(d);return e.h<a*u.length+mo*2&&(e.h=a*u.length+mo*2),e}function _q(t,e,n,i){const{seed:r,strokeWidth:o,filled:s,strokeStyle:a,roughness:l,rotate:c,shapeStyle:d}=t,[,,u,h]=t.deserializedXYWH,p=Math.max(o,0)/2,g=u-p*2,f=h-p*2,v=g/2,m=f/2,y=i.rc,x=i.getVariableColor(t.fillColor),T=i.getVariableColor(t.strokeColor);e.setTransform(n.translateSelf(p,p).translateSelf(v,m).rotateSelf(c).translateSelf(-v,-m)),d==="General"?o3(e,t,i):y.polygon([[g/2,0],[g,f/2],[g/2,f],[0,f/2]],{seed:r,roughness:d==="Scribbled"?l:0,strokeLineDash:a==="dash"?[12,12]:void 0,stroke:a==="none"?"none":T,strokeWidth:o,fill:s?x:void 0})}function Cq(t,e,n,i){const{seed:r,strokeWidth:o,filled:s,strokeStyle:a,roughness:l,rotate:c,shapeStyle:d}=t,[,,u,h]=t.deserializedXYWH,p=Math.max(o,0)/2,g=Math.max(1,u-p*2),f=Math.max(1,h-p*2),v=g/2,m=f/2,y=i.rc,x=i.getVariableColor(t.fillColor),T=i.getVariableColor(t.strokeColor);e.setTransform(n.translateSelf(p,p).translateSelf(v,m).rotateSelf(c).translateSelf(-v,-m)),d==="General"?o3(e,t,i):y.ellipse(v,m,g,f,{seed:r,roughness:d==="Scribbled"?l:0,strokeLineDash:a==="dash"?[12,12]:void 0,stroke:a==="none"?"none":T,strokeWidth:o,fill:s?x:void 0,curveFitting:1})}const ra=1-.5522847498;function kq(t,e,n,i){const{seed:r,strokeWidth:o,filled:s,radius:a,strokeStyle:l,roughness:c,rotate:d,shapeStyle:u}=t,[,,h,p]=t.deserializedXYWH,g=Math.max(o,0)/2,f=h-g*2,v=p-g*2,m=Math.min(f*a,v*a),y=f/2,x=v/2,T=i.getVariableColor(t.fillColor),M=i.getVariableColor(t.strokeColor),k=i.rc;e.setTransform(n.translateSelf(g,g).translateSelf(y,x).rotateSelf(d).translateSelf(-y,-x)),u==="General"?o3(e,t,i):k.path(`
      M ${m} 0
      L ${f-m} 0
      C ${f-ra*m} 0 ${f} ${ra*m} ${f} ${m}
      L ${f} ${v-m}
      C ${f} ${v-ra*m} ${f-ra*m} ${v} ${f-m} ${v}
      L ${m} ${v}
      C ${ra*m} ${v} 0 ${v-ra*m} 0 ${v-m}
      L 0 ${m}
      C 0 ${ra*m} ${ra*m} 0 ${m} 0
      Z
      `,{seed:r,roughness:u==="Scribbled"?c:0,strokeLineDash:l==="dash"?[12,12]:void 0,stroke:l==="none"?"none":M,strokeWidth:o,fill:s?T:void 0})}function Eq(t,e,n,i){const{seed:r,strokeWidth:o,filled:s,strokeStyle:a,roughness:l,rotate:c,shapeStyle:d}=t,[,,u,h]=t.deserializedXYWH,p=Math.max(o,0)/2,g=u-p*2,f=h-p*2,v=g/2,m=f/2,y=i.rc,x=i.getVariableColor(t.fillColor),T=i.getVariableColor(t.strokeColor);e.setTransform(n.translateSelf(p,p).translateSelf(v,m).rotateSelf(c).translateSelf(-v,-m)),d==="General"?o3(e,t,i):y.polygon([[g/2,0],[g,f],[0,f]],{seed:r,roughness:d==="Scribbled"?l:0,strokeLineDash:a==="dash"?[12,12]:void 0,stroke:a==="none"?"none":T,strokeWidth:o,fill:s?x:void 0})}const Sq={diamond:_q,rect:kq,triangle:Eq,ellipse:Cq};function Tq(t,e,n,i){Sq[t.shapeType](t,e,n,i),t.textDisplay&&Iq(t,e,i)}function Iq(t,e,n){const{text:i,color:r,fontSize:o,fontFamily:s,textAlign:a,w:l,h:c,textVerticalAlign:d}=t;if(!i)return;const u=tl(s,o),h=Ic({fontSize:o,fontFamily:s,fontWeight:t.fontWeight,fontStyle:t.fontStyle}),p=j1(w9(i,h,l)),g=wq(t.w,t.textAlign),f=xq(p,u,c,d);let v=0;for(const[y,x]of p.entries())for(const T of x){e.save();const M=T.insert,k=fT(M),_=k&&!e.canvas.isConnected;_&&document.body.appendChild(e.canvas),e.canvas.setAttribute("dir",k?"rtl":"ltr"),e.font=h,e.fillStyle=n.getVariableColor(r),e.textAlign=a,e.textBaseline="ideographic",e.fillText(M,g-2,(y+1)*u+f-1.5),v=Math.max(v,Fl(M,h)),_&&e.canvas.remove(),e.restore()}const m=a==="center"?g-v/2:a==="right"?g-v:mo;t.externalXYWH=wo(t.x+m-2,t.y+f-1.5,v,p.length*u)}function Lq(t,e,n,i){const{color:r,fontSize:o,fontWeight:s,fontStyle:a,fontFamily:l,textAlign:c,rotate:d}=t,[,,u,h]=t.deserializedXYWH,p=u/2,g=h/2;e.setTransform(n.translateSelf(p,g).rotateSelf(d).translateSelf(-p,-g));const f=Ic({fontStyle:a,fontWeight:s,fontSize:o,fontFamily:l}),v=w9(t.text,f,u),m=j1(v),y=tl(l,o),x=c==="center"?u/2:c==="right"?u:0;for(const[T,M]of m.entries()){let k=0;for(const _ of M){e.save();const A=_.insert,$=fT(A),E=$&&!e.canvas.isConnected;E&&document.body.appendChild(e.canvas),e.canvas.setAttribute("dir",$?"rtl":"ltr"),e.font=f,e.fillStyle=i.getVariableColor(r),e.textAlign=c,e.textBaseline="ideographic";const R=c==="center"?0:c==="right"?-.5:.5;e.fillText(A,x+k+R,(T+1)*y),k+=Ul(A,f),E&&e.canvas.remove(),e.restore()}}}const Mq={brush:jW,connector:QW,group:gq,shape:Tq,text:Lq};function p6(t,e,n){return n>0&&t>e||n<0&&t<e?e:t}const Pq=6,Cx=.1;class E9{constructor(){this._left=0,this._top=0,this._width=0,this._height=0,this._center={x:0,y:0},this._zoom=1,this._rafId=null,this._syncFlag=!1,this.viewportUpdated=new Ve,this.sizeUpdated=new Ve}get left(){return this._left}get top(){return this._top}get width(){return this._width}get height(){return this._height}get centerX(){return this._center.x}get centerY(){return this._center.y}get center(){return this._center}get zoom(){return this._zoom}get viewportX(){const{centerX:e,width:n,zoom:i}=this;return e-n/2/i}get viewportY(){const{centerY:e,height:n,zoom:i}=this;return e-n/2/i}get translateX(){return-this.viewportX*this.zoom}get translateY(){return-this.viewportY*this.zoom}get viewportMinXY(){const{centerX:e,centerY:n,width:i,height:r,zoom:o}=this;return{x:e-i/2/o,y:n-r/2/o}}get viewportMaxXY(){const{centerX:e,centerY:n,width:i,height:r,zoom:o}=this;return{x:e+i/2/o,y:n+r/2/o}}get viewportBounds(){const{viewportMinXY:e,viewportMaxXY:n}=this;return ne.from({...e,w:n.x-e.x,h:n.y-e.y})}get boundingClientRect(){return this._el.getBoundingClientRect()}onResize(){const e=this.width,n=this.height,i=this._el.getBoundingClientRect();this.setRect(i.left,i.top,i.width,i.height),this.setCenter(this.centerX-(e-this.width)/2,this.centerY-(n-this.height)/2)}setContainer(e){const n=e.getBoundingClientRect();this._el=e,this.setRect(n.left,n.top,n.width,n.height)}toModelCoord(e,n){const{viewportX:i,viewportY:r,zoom:o}=this;return[i+e/o,r+n/o]}toViewCoord(e,n){const{viewportX:i,viewportY:r,zoom:o}=this;return[(e-i)*o,(n-r)*o]}toViewBound(e){const{w:n,h:i}=e,[r,o]=this.toViewCoord(e.x,e.y);return new ne(r,o,n*this.zoom,i*this.zoom)}setCenter(e,n){this._center.x=e,this._center.y=n,this.viewportUpdated.emit({zoom:this.zoom,center:te.toVec(this.center)})}setZoom(e,n){const i=this.zoom;n=n??this._center,this._zoom=Es(e,Cx,Pq);const r=this.zoom,o=te.sub(te.toVec(this.center),te.toVec(n)),s=te.add(te.toVec(n),te.mul(o,i/r));this.setCenter(s[0],s[1]),this.viewportUpdated.emit({zoom:this.zoom,center:te.toVec(this.center)})}applyDeltaCenter(e,n){this.setCenter(this.centerX+e,this.centerY+n)}isInViewport(e){const n=ne.from(this.viewportBounds);return n.contains(e)||n.isIntersectWithBound(e)}setViewport(e,n=te.toVec(this.center),i=!1){const r=this._zoom;if(i){const o=r/e;if(o===1)this.smoothTranslate(n[0],n[1]);else{const s=[this.centerX,this.centerY],a=te.mul(te.sub(n,te.mul(s,o)),1/(1-o));this.smoothZoom(e,te.toPoint(a))}}else this._center.x=n[0],this._center.y=n[1],this.setZoom(e)}setViewportByBound(e,n=[0,0,0,0],i=!1){const[r,o,s,a]=n,l=Es((this.width-(o+a))/e.w,Cx,(this.height-(r+s))/e.h),c=[e.x+(e.w+o/l)/2-a/l/2,e.y+(e.h+s/l)/2-r/l/2];this.setViewport(l,c,i)}setRect(e,n,i,r){this._left=e,this._top=n,this._width=i,this._height=r,this.sizeUpdated.emit({width:this.width,height:this.height,left:this.left,top:this.top})}smoothZoom(e,n){const i=e-this.zoom;this._rafId&&cancelAnimationFrame(this._rafId);const r=()=>{this._rafId=requestAnimationFrame(()=>{const o=i>0?1:-1,a=i/10,l=p6(this.zoom+a,e,o);this.setZoom(l,n),l!=e&&r()})};r()}smoothTranslate(e,n){const{center:i}=this,r={x:e-i.x,y:n-i.y},o=()=>{this._rafId&&cancelAnimationFrame(this._rafId),this._rafId=requestAnimationFrame(()=>{const a={x:r.x/10,y:r.y/10},l={x:this.centerX+a.x,y:this.centerY+a.y},c=r.x>0?1:-1,d=r.y>0?1:-1;l.x=p6(l.x,e,c),l.y=p6(l.y,n,d),this.setCenter(l.x,l.y),(l.x!=e||l.y!=n)&&o()})};o()}sync(e){const n=(o,s)=>{s._syncFlag=!0,s.setZoom(o.zoom),s.setCenter(o.centerX,o.centerY),s._syncFlag=!1},i=(o,s)=>{s._syncFlag=!0,s.setRect(o.left,o.top,o.width,o.height),s._syncFlag=!1},r=[e.viewportUpdated.on(()=>{e._syncFlag||n(e,this)}),this.viewportUpdated.on(()=>{this._syncFlag||n(this,e)}),e.sizeUpdated.on(()=>{e._syncFlag||i(e,this)}),this.sizeUpdated.on(()=>{this._syncFlag||i(this,e)})];return n(e,this),()=>{r.forEach(o=>o.dispose())}}dispose(){this.sizeUpdated.dispose(),this.viewportUpdated.dispose()}}function Zu(t){return[...t]}function Aq(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(n===3)i.push(Zu(t[0]),Zu(t[1]),Zu(t[2]),Zu(t[2]));else{const r=[];r.push(t[0],t[0]);for(let a=1;a<t.length;a++)r.push(t[a]),a===t.length-1&&r.push(t[a]);const o=[],s=1-e;i.push(Zu(r[0]));for(let a=1;a+2<r.length;a++){const l=r[a];o[0]=[l[0],l[1]],o[1]=[l[0]+(s*r[a+1][0]-s*r[a-1][0])/6,l[1]+(s*r[a+1][1]-s*r[a-1][1])/6],o[2]=[r[a+1][0]+(s*r[a][0]-s*r[a+2][0])/6,r[a+1][1]+(s*r[a][1]-s*r[a+2][1])/6],o[3]=[r[a+1][0],r[a+1][1]],i.push(o[1],o[2],o[3])}}return i}function $q(t,e){return Math.sqrt(a2(t,e))}function a2(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function Bq(t,e,n){const i=a2(e,n);if(i===0)return a2(t,e);let r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return r=Math.max(0,Math.min(1,r)),a2(t,$l(e,n,r))}function $l(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function Dq(t,e){const n=t[e+0],i=t[e+1],r=t[e+2],o=t[e+3];let s=3*i[0]-2*n[0]-o[0];s*=s;let a=3*i[1]-2*n[1]-o[1];a*=a;let l=3*r[0]-2*o[0]-n[0];l*=l;let c=3*r[1]-2*o[1]-n[1];return c*=c,s<l&&(s=l),a<c&&(a=c),s+a}function K7(t,e,n,i){const r=i||[];if(Dq(t,e)<n){const o=t[e+0];r.length?$q(r[r.length-1],o)>1&&r.push(o):r.push(o),r.push(t[e+3])}else{const s=t[e+0],a=t[e+1],l=t[e+2],c=t[e+3],d=$l(s,a,.5),u=$l(a,l,.5),h=$l(l,c,.5),p=$l(d,u,.5),g=$l(u,h,.5),f=$l(p,g,.5);K7([s,d,p,f],0,n,r),K7([f,g,h,c],0,n,r)}return r}function Oq(t,e){return X2(t,0,t.length,e)}function X2(t,e,n,i,r){const o=r||[],s=t[e],a=t[n-1];let l=0,c=1;for(let d=e+1;d<n-1;++d){const u=Bq(t[d],s,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(X2(t,e,c+1,i,o),X2(t,c,n,i,o)):(o.length||o.push(s),o.push(a)),o}function bT(t,e=.15,n){const i=[],r=(t.length-1)/3;for(let o=0;o<r;o++){const s=o*3;K7(t,s,e,i)}return n&&n>0?X2(i,0,i.length,n):i}function vT(t){let e=0,n=0,i=0,r=0;const o=[];for(const{key:s,data:a}of t)switch(s){case"M":o.push({key:"M",data:[...a]}),[e,n]=a,[i,r]=a;break;case"m":e+=a[0],n+=a[1],o.push({key:"M",data:[e,n]}),i=e,r=n;break;case"L":o.push({key:"L",data:[...a]}),[e,n]=a;break;case"l":e+=a[0],n+=a[1],o.push({key:"L",data:[e,n]});break;case"C":o.push({key:"C",data:[...a]}),e=a[4],n=a[5];break;case"c":{const l=a.map((c,d)=>d%2?c+n:c+e);o.push({key:"C",data:l}),e=l[4],n=l[5];break}case"Q":o.push({key:"Q",data:[...a]}),e=a[2],n=a[3];break;case"q":{const l=a.map((c,d)=>d%2?c+n:c+e);o.push({key:"Q",data:l}),e=l[2],n=l[3];break}case"A":o.push({key:"A",data:[...a]}),e=a[5],n=a[6];break;case"a":e+=a[5],n+=a[6],o.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],e,n]});break;case"H":o.push({key:"H",data:[...a]}),e=a[0];break;case"h":e+=a[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],o.push({key:"V",data:[n]});break;case"S":o.push({key:"S",data:[...a]}),e=a[2],n=a[3];break;case"s":{const l=a.map((c,d)=>d%2?c+n:c+e);o.push({key:"S",data:l}),e=l[2],n=l[3];break}case"T":o.push({key:"T",data:[...a]}),e=a[0],n=a[1];break;case"t":e+=a[0],n+=a[1],o.push({key:"T",data:[e,n]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=i,n=r;break}return o}function yT(t){const e=[];let n="",i=0,r=0,o=0,s=0,a=0,l=0;for(const{key:c,data:d}of t){switch(c){case"M":e.push({key:"M",data:[...d]}),[i,r]=d,[o,s]=d;break;case"C":e.push({key:"C",data:[...d]}),i=d[4],r=d[5],a=d[2],l=d[3];break;case"L":e.push({key:"L",data:[...d]}),[i,r]=d;break;case"H":i=d[0],e.push({key:"L",data:[i,r]});break;case"V":r=d[0],e.push({key:"L",data:[i,r]});break;case"S":{let u=0,h=0;n==="C"||n==="S"?(u=i+(i-a),h=r+(r-l)):(u=i,h=r),e.push({key:"C",data:[u,h,...d]}),a=d[0],l=d[1],i=d[2],r=d[3];break}case"T":{const[u,h]=d;let p=0,g=0;n==="Q"||n==="T"?(p=i+(i-a),g=r+(r-l)):(p=i,g=r);const f=i+2*(p-i)/3,v=r+2*(g-r)/3,m=u+2*(p-u)/3,y=h+2*(g-h)/3;e.push({key:"C",data:[f,v,m,y,u,h]}),a=p,l=g,i=u,r=h;break}case"Q":{const[u,h,p,g]=d,f=i+2*(u-i)/3,v=r+2*(h-r)/3,m=p+2*(u-p)/3,y=g+2*(h-g)/3;e.push({key:"C",data:[f,v,m,y,p,g]}),a=u,l=h,i=p,r=g;break}case"A":{const u=Math.abs(d[0]),h=Math.abs(d[1]),p=d[2],g=d[3],f=d[4],v=d[5],m=d[6];u===0||h===0?(e.push({key:"C",data:[i,r,v,m,v,m]}),i=v,r=m):(i!==v||r!==m)&&(wT(i,r,v,m,u,h,p,g,f).forEach(function(x){e.push({key:"C",data:x})}),i=v,r=m);break}case"Z":e.push({key:"Z",data:[]}),i=o,r=s;break}n=c}return e}function Rq(t){return Math.PI*t/180}function Wu(t,e,n){const i=t*Math.cos(n)-e*Math.sin(n),r=t*Math.sin(n)+e*Math.cos(n);return[i,r]}function wT(t,e,n,i,r,o,s,a,l,c){const d=Rq(s);let u=[],h=0,p=0,g=0,f=0;if(c)[h,p,g,f]=c;else{[t,e]=Wu(t,e,-d),[n,i]=Wu(n,i,-d);const I=(t-n)/2,N=(e-i)/2;let P=I*I/(r*r)+N*N/(o*o);P>1&&(P=Math.sqrt(P),r=P*r,o=P*o);const Z=a===l?-1:1,pe=r*r,Q=o*o,Le=pe*Q-pe*N*N-Q*I*I,ue=pe*N*N+Q*I*I,H=Z*Math.sqrt(Math.abs(Le/ue));g=H*r*N/o+(t+n)/2,f=H*-o*I/r+(e+i)/2,h=Math.asin(parseFloat(((e-f)/o).toFixed(9))),p=Math.asin(parseFloat(((i-f)/o).toFixed(9))),t<g&&(h=Math.PI-h),n<g&&(p=Math.PI-p),h<0&&(h=Math.PI*2+h),p<0&&(p=Math.PI*2+p),l&&h>p&&(h=h-Math.PI*2),!l&&p>h&&(p=p-Math.PI*2)}let v=p-h;if(Math.abs(v)>Math.PI*120/180){const I=p,N=n,P=i;l&&p>h?p=h+Math.PI*120/180*1:p=h+Math.PI*120/180*-1,n=g+r*Math.cos(p),i=f+o*Math.sin(p),u=wT(n,i,N,P,r,o,s,0,l,[p,I,g,f])}v=p-h;const m=Math.cos(h),y=Math.sin(h),x=Math.cos(p),T=Math.sin(p),M=Math.tan(v/4),k=4/3*r*M,_=4/3*o*M,A=[t,e],$=[t+k*y,e-_*m],E=[n+k*T,i-_*x],R=[n,i];if($[0]=2*A[0]-$[0],$[1]=2*A[1]-$[1],c)return[$,E,R].concat(u);{u=[$,E,R].concat(u);const I=[];for(let N=0;N<u.length;N+=3){const P=Wu(u[N][0],u[N][1],d),Z=Wu(u[N+1][0],u[N+1][1],d),pe=Wu(u[N+2][0],u[N+2][1],d);I.push([P[0],P[1],Z[0],Z[1],pe[0],pe[1]])}return I}}const Nq=0,Q7=1,xT=2,Cf={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Hq(t){const e=[];let n;for(;t!=="";){if(n=t.match(/^([ \t\r\n,]+)/),n){t=t.slice(n[0].length);continue}if(n=t.match(/^([aAcChHlLmMqQsStTvVzZ])/),n){e.push({type:Nq,text:n[0]}),t=t.slice(n[0].length);continue}if(n=t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/),n)e.push({type:Q7,text:`${parseFloat(n[0])}`}),t=t.slice(n[0].length);else return[]}return e.push({type:xT,text:""}),e}function f6(t,e){return t.type===e}function S9(t){const e=[],n=Hq(t);let i="BOD",r=0,o=n[r];for(;!f6(o,xT);){let s=0;const a=[];if(i==="BOD")if(o.text==="M"||o.text==="m")r++,s=Cf[o.text],i=o.text;else return S9("M0,0"+t);else f6(o,Q7)?s=Cf[i]:(r++,s=Cf[o.text],i=o.text);if(r+s<n.length){for(let l=r;l<r+s;l++){const c=n[l];if(f6(c,Q7))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof Cf[i]=="number"){const l={key:i,data:a};e.push(l),r+=s,o=n[r],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return e}function Fq(t,e,n){const i=S9(t),r=yT(vT(i)),o=[];let s=[],a=[0,0],l=[];const c=()=>{l.length>=4&&s.push(...bT(l,e)),l=[]},d=()=>{c(),s.length&&(o.push(s),s=[])};for(const{key:h,data:p}of r)switch(h){case"M":d(),a=[p[0],p[1]],s.push(a);break;case"L":c(),s.push([p[0],p[1]]);break;case"C":if(!l.length){const g=s.length?s[s.length-1]:a;l.push([g[0],g[1]])}l.push([p[0],p[1]]),l.push([p[2],p[3]]),l.push([p[4],p[5]]);break;case"Z":c(),s.push([a[0],a[1]]);break}if(d(),!n)return o;const u=[];for(const h of o){const p=Oq(h,n);p.length&&u.push(p)}return u}function J7(t,e,n){if(t&&t.length){const[i,r]=e,o=Math.PI/180*n,s=Math.cos(o),a=Math.sin(o);t.forEach(l=>{const[c,d]=l;l[0]=(c-i)*s-(d-r)*a+i,l[1]=(c-i)*a+(d-r)*s+r})}}function Uq(t,e,n){const i=[];t.forEach(r=>i.push(...r)),J7(i,e,n)}function s3(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function c0(t,e){const n=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=e.strokeWidth*4),i=Math.max(i,.1);const r=[0,0];if(n)for(const s of t)J7(s,r,n);const o=Vq(t,i);if(n){for(const s of t)J7(s,r,-n);Uq(o,r,-n)}return o}function Vq(t,e){const n=[];for(const a of t){const l=[...a];l[0].join(",")!==l[l.length-1].join(",")&&l.push([l[0][0],l[0][1]]),l.length>2&&n.push(l)}const i=[];e=Math.max(e,.1);const r=[];for(const a of n)for(let l=0;l<a.length-1;l++){const c=a[l],d=a[l+1];if(c[1]!==d[1]){const u=Math.min(c[1],d[1]);r.push({ymin:u,ymax:Math.max(c[1],d[1]),x:u===c[1]?c[0]:d[0],islope:(d[0]-c[0])/(d[1]-c[1])})}}if(r.sort((a,l)=>a.ymin<l.ymin?-1:a.ymin>l.ymin?1:a.x<l.x?-1:a.x>l.x?1:a.ymax===l.ymax?0:(a.ymax-l.ymax)/Math.abs(a.ymax-l.ymax)),!r.length)return i;let o=[],s=r[0].ymin;for(;o.length||r.length;){if(r.length){let a=-1;for(let c=0;c<r.length&&!(r[c].ymin>s);c++)a=c;r.splice(0,a+1).forEach(c=>{o.push({s,edge:c})})}if(o=o.filter(a=>!(a.edge.ymax<=s)),o.sort((a,l)=>a.edge.x===l.edge.x?0:(a.edge.x-l.edge.x)/Math.abs(a.edge.x-l.edge.x)),o.length>1)for(let a=0;a<o.length;a=a+2){const l=a+1;if(l>=o.length)break;const c=o[a].edge,d=o[l].edge;i.push([[Math.round(c.x),s],[Math.round(d.x),s]])}s+=e,o.forEach(a=>{a.edge.x=a.edge.x+e*a.edge.islope})}return i}class zq{constructor(e){this.helper=e}fillPolygons(e,n){const i=c0(e,n);return{type:"fillSketch",ops:this.dashedLine(i,n)}}dashedLine(e,n){const i=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,r=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,o=[];return e.forEach(s=>{const a=s3(s),l=Math.floor(a/(i+r)),c=(a+r-l*(i+r))/2;let d=s[0],u=s[1];d[0]>u[0]&&(d=s[1],u=s[0]);const h=Math.atan((u[1]-d[1])/(u[0]-d[0]));for(let p=0;p<l;p++){const g=p*(i+r),f=g+i,v=[d[0]+g*Math.cos(h)+c*Math.cos(h),d[1]+g*Math.sin(h)+c*Math.sin(h)],m=[d[0]+f*Math.cos(h)+c*Math.cos(h),d[1]+f*Math.sin(h)+c*Math.sin(h)];o.push(...this.helper.doubleLineOps(v[0],v[1],m[0],m[1],n))}}),o}}class jq{constructor(e){this.helper=e}fillPolygons(e,n){n=Object.assign({},n,{hachureAngle:0});const i=c0(e,n);return this.dotsOnLines(i,n)}dotsOnLines(e,n){const i=[];let r=n.hachureGap;r<0&&(r=n.strokeWidth*4),r=Math.max(r,.1);let o=n.fillWeight;o<0&&(o=n.strokeWidth/2);const s=r/4;for(const a of e){const l=s3(a),c=l/r,d=Math.ceil(c)-1,u=l-d*r,h=(a[0][0]+a[1][0])/2-r/4,p=Math.min(a[0][1],a[1][1]);for(let g=0;g<d;g++){const f=p+u+g*r,v=h-s+Math.random()*2*s,m=f-s+Math.random()*2*s,y=this.helper.ellipse(v,m,o,o,n);i.push(...y.ops)}}return{type:"fillSketch",ops:i}}}class T9{constructor(e){this.helper=e}fillPolygons(e,n){return this._fillPolygons(e,n)}_fillPolygons(e,n){const i=c0(e,n);return{type:"fillSketch",ops:this.renderLines(i,n)}}renderLines(e,n){const i=[];for(const r of e)i.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],n));return i}}class Gq extends T9{fillPolygons(e,n){const i=this._fillPolygons(e,n),r=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),o=this._fillPolygons(e,r);return i.ops=i.ops.concat(o.ops),i}}class Zq extends T9{fillPolygons(e,n){let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);const r=Object.assign({},n,{hachureGap:i}),o=c0(e,r),s=Math.PI/180*n.hachureAngle,a=[],l=i*.5*Math.cos(s),c=i*.5*Math.sin(s);for(const[u,h]of o)s3([u,h])&&a.push([[u[0]-l,u[1]+c],[...h]],[[u[0]+l,u[1]-c],[...h]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class Wq{constructor(e){this.helper=e}fillPolygons(e,n){const i=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,r=n.zigzagOffset<0?i:n.zigzagOffset;n=Object.assign({},n,{hachureGap:i+r});const o=c0(e,n);return{type:"fillSketch",ops:this.zigzagLines(o,r,n)}}zigzagLines(e,n,i){const r=[];return e.forEach(o=>{const s=s3(o),a=Math.round(s/(2*n));let l=o[0],c=o[1];l[0]>c[0]&&(l=o[1],c=o[0]);const d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let u=0;u<a;u++){const h=u*2*n,p=(u+1)*2*n,g=Math.sqrt(2*Math.pow(n,2)),f=[l[0]+h*Math.cos(d),l[1]+h*Math.sin(d)],v=[l[0]+p*Math.cos(d),l[1]+p*Math.sin(d)],m=[f[0]+g*Math.cos(d+Math.PI/4),f[1]+g*Math.sin(d+Math.PI/4)];r.push(...this.helper.doubleLineOps(f[0],f[1],m[0],m[1],i),...this.helper.doubleLineOps(m[0],m[1],v[0],v[1],i))}}),r}}const Si={};function qq(t,e){let n=t.fillStyle||"hachure";if(!Si[n])switch(n){case"zigzag":Si[n]||(Si[n]=new Zq(e));break;case"cross-hatch":Si[n]||(Si[n]=new Gq(e));break;case"dots":Si[n]||(Si[n]=new jq(e));break;case"dashed":Si[n]||(Si[n]=new zq(e));break;case"zigzag-line":Si[n]||(Si[n]=new Wq(e));break;case"hachure":default:n="hachure",Si[n]||(Si[n]=new T9(e));break}return Si[n]}const Yq={randOffset:nY,randOffsetWithRange:iY,ellipse:Jq,doubleLineOps:rY};function _T(t,e,n,i,r){return{type:"path",ops:Ss(t,e,n,i,r)}}function l2(t,e,n){const i=(t||[]).length;if(i>2){const r=[];for(let o=0;o<i-1;o++)r.push(...Ss(t[o][0],t[o][1],t[o+1][0],t[o+1][1],n));return e&&r.push(...Ss(t[i-1][0],t[i-1][1],t[0][0],t[0][1],n)),{type:"path",ops:r}}else if(i===2)return _T(t[0][0],t[0][1],t[1][0],t[1][1],n);return{type:"path",ops:[]}}function Xq(t,e){return l2(t,!0,e)}function Kq(t,e,n,i,r){const o=[[t,e],[t+n,e],[t+n,e+i],[t,e+i]];return Xq(o,r)}function Qq(t,e){let n=Sx(t,1*(1+e.roughness*.2),e);if(!e.disableMultiStroke){const i=Sx(t,1.5*(1+e.roughness*.22),oY(e));n=n.concat(i)}return{type:"path",ops:n}}function Jq(t,e,n,i,r){const o=CT(n,i,r);return e8(t,e,r,o).opset}function CT(t,e,n){const i=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),r=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*i)),o=Math.PI*2/r;let s=Math.abs(t/2),a=Math.abs(e/2);const l=1-n.curveFitting;return s+=Ge(s*l,n),a+=Ge(a*l,n),{increment:o,rx:s,ry:a}}function e8(t,e,n,i){const[r,o]=Tx(i.increment,t,e,i.rx,i.ry,1,i.increment*K2(.1,K2(.4,1,n),n),n);let s=Q2(r,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=Tx(i.increment,t,e,i.rx,i.ry,1.5,0,n),l=Q2(a,null,n);s=s.concat(l)}return{estimatedPoints:o,opset:{type:"path",ops:s}}}function kx(t,e,n,i,r,o,s,a,l){const c=t,d=e;let u=Math.abs(n/2),h=Math.abs(i/2);u+=Ge(u*.01,l),h+=Ge(h*.01,l);let p=r,g=o;for(;p<0;)p+=Math.PI*2,g+=Math.PI*2;g-p>Math.PI*2&&(p=0,g=Math.PI*2);const f=Math.PI*2/l.curveStepCount,v=Math.min(f/2,(g-p)/2),m=Ix(v,c,d,u,h,p,g,1,l);if(!l.disableMultiStroke){const y=Ix(v,c,d,u,h,p,g,1.5,l);m.push(...y)}return s&&(a?m.push(...Ss(c,d,c+u*Math.cos(p),d+h*Math.sin(p),l),...Ss(c,d,c+u*Math.cos(g),d+h*Math.sin(g),l)):m.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+u*Math.cos(p),d+h*Math.sin(p)]})),{type:"path",ops:m}}function eY(t,e){const n=yT(vT(S9(t))),i=[];let r=[0,0],o=[0,0];for(const{key:s,data:a}of n)switch(s){case"M":{const l=1*(e.maxRandomnessOffset||0),c=e.preserveVertices;i.push({op:"move",data:a.map(d=>d+(c?0:Ge(l,e)))}),o=[a[0],a[1]],r=[a[0],a[1]];break}case"L":i.push(...Ss(o[0],o[1],a[0],a[1],e)),o=[a[0],a[1]];break;case"C":{const[l,c,d,u,h,p]=a;i.push(...sY(l,c,d,u,h,p,o,e)),o=[h,p];break}case"Z":i.push(...Ss(o[0],o[1],r[0],r[1],e)),o=[r[0],r[1]];break}return{type:"path",ops:i}}function kf(t,e){const n=[];for(const i of t)if(i.length){const r=e.maxRandomnessOffset||0,o=i.length;if(o>2){n.push({op:"move",data:[i[0][0]+Ge(r,e),i[0][1]+Ge(r,e)]});for(let s=1;s<o;s++)n.push({op:"lineTo",data:[i[s][0]+Ge(r,e),i[s][1]+Ge(r,e)]})}}return{type:"fillPath",ops:n}}function u1(t,e){return qq(e,Yq).fillPolygons(t,e)}function tY(t,e,n,i,r,o,s){const a=t,l=e;let c=Math.abs(n/2),d=Math.abs(i/2);c+=Ge(c*.01,s),d+=Ge(d*.01,s);let u=r,h=o;for(;u<0;)u+=Math.PI*2,h+=Math.PI*2;h-u>Math.PI*2&&(u=0,h=Math.PI*2);const p=(h-u)/s.curveStepCount,g=[];for(let f=u;f<=h;f=f+p)g.push([a+c*Math.cos(f),l+d*Math.sin(f)]);return g.push([a+c*Math.cos(h),l+d*Math.sin(h)]),g.push([a,l]),u1([g],s)}function nY(t,e){return Ge(t,e)}function iY(t,e,n){return K2(t,e,n)}function rY(t,e,n,i,r){return Ss(t,e,n,i,r,!0)}function oY(t){const e={...t};return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function kT(t){return t.randomizer||(t.randomizer=new mD(t.seed||0)),t.randomizer.next()}function K2(t,e,n,i=1){return n.roughness*i*(kT(n)*(e-t)+t)}function Ge(t,e,n=1){return K2(-t,t,e,n)}function Ss(t,e,n,i,r,o=!1){const s=o?r.disableMultiStrokeFill:r.disableMultiStroke,a=Ex(t,e,n,i,r,!0,!1);if(s)return a;const l=Ex(t,e,n,i,r,!0,!0);return a.concat(l)}function Ex(t,e,n,i,r,o,s){const a=Math.pow(t-n,2)+Math.pow(e-i,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=r.maxRandomnessOffset||0;d*d*100>a&&(d=l/10);const u=d/2,h=.2+kT(r)*.2;let p=r.bowing*r.maxRandomnessOffset*(i-e)/200,g=r.bowing*r.maxRandomnessOffset*(t-n)/200;p=Ge(p,r,c),g=Ge(g,r,c);const f=[],v=()=>Ge(u,r,c),m=()=>Ge(d,r,c),y=r.preserveVertices;return o&&(s?f.push({op:"move",data:[t+(y?0:v()),e+(y?0:v())]}):f.push({op:"move",data:[t+(y?0:Ge(d,r,c)),e+(y?0:Ge(d,r,c))]})),s?f.push({op:"bcurveTo",data:[p+t+(n-t)*h+v(),g+e+(i-e)*h+v(),p+t+2*(n-t)*h+v(),g+e+2*(i-e)*h+v(),n+(y?0:v()),i+(y?0:v())]}):f.push({op:"bcurveTo",data:[p+t+(n-t)*h+m(),g+e+(i-e)*h+m(),p+t+2*(n-t)*h+m(),g+e+2*(i-e)*h+m(),n+(y?0:m()),i+(y?0:m())]}),f}function Sx(t,e,n){const i=[];i.push([t[0][0]+Ge(e,n),t[0][1]+Ge(e,n)]),i.push([t[0][0]+Ge(e,n),t[0][1]+Ge(e,n)]);for(let r=1;r<t.length;r++)i.push([t[r][0]+Ge(e,n),t[r][1]+Ge(e,n)]),r===t.length-1&&i.push([t[r][0]+Ge(e,n),t[r][1]+Ge(e,n)]);return Q2(i,null,n)}function Q2(t,e,n){const i=t.length,r=[];if(i>3){const o=[],s=1-n.curveTightness;r.push({op:"move",data:[t[1][0],t[1][1]]});for(let a=1;a+2<i;a++){const l=t[a];o[0]=[l[0],l[1]],o[1]=[l[0]+(s*t[a+1][0]-s*t[a-1][0])/6,l[1]+(s*t[a+1][1]-s*t[a-1][1])/6],o[2]=[t[a+1][0]+(s*t[a][0]-s*t[a+2][0])/6,t[a+1][1]+(s*t[a][1]-s*t[a+2][1])/6],o[3]=[t[a+1][0],t[a+1][1]],r.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&e.length===2){const a=n.maxRandomnessOffset;r.push({op:"lineTo",data:[e[0]+Ge(a,n),e[1]+Ge(a,n)]})}}else i===3?(r.push({op:"move",data:[t[1][0],t[1][1]]}),r.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):i===2&&r.push(...Ss(t[0][0],t[0][1],t[1][0],t[1][1],n));return r}function Tx(t,e,n,i,r,o,s,a){const l=a.roughness===0,c=[],d=[];if(l){t=t/4,d.push([e+i*Math.cos(-t),n+r*Math.sin(-t)]);for(let u=0;u<=Math.PI*2;u=u+t){const h=[e+i*Math.cos(u),n+r*Math.sin(u)];c.push(h),d.push(h)}d.push([e+i*Math.cos(0),n+r*Math.sin(0)]),d.push([e+i*Math.cos(t),n+r*Math.sin(t)])}else{const u=Ge(.5,a)-Math.PI/2;d.push([Ge(o,a)+e+.9*i*Math.cos(u-t),Ge(o,a)+n+.9*r*Math.sin(u-t)]);const h=Math.PI*2+u-.01;for(let p=u;p<h;p=p+t){const g=[Ge(o,a)+e+i*Math.cos(p),Ge(o,a)+n+r*Math.sin(p)];c.push(g),d.push(g)}d.push([Ge(o,a)+e+i*Math.cos(u+Math.PI*2+s*.5),Ge(o,a)+n+r*Math.sin(u+Math.PI*2+s*.5)]),d.push([Ge(o,a)+e+.98*i*Math.cos(u+s),Ge(o,a)+n+.98*r*Math.sin(u+s)]),d.push([Ge(o,a)+e+.9*i*Math.cos(u+s*.5),Ge(o,a)+n+.9*r*Math.sin(u+s*.5)])}return[d,c]}function Ix(t,e,n,i,r,o,s,a,l){const c=o+Ge(.1,l),d=[];d.push([Ge(a,l)+e+.9*i*Math.cos(c-t),Ge(a,l)+n+.9*r*Math.sin(c-t)]);for(let u=c;u<=s;u=u+t)d.push([Ge(a,l)+e+i*Math.cos(u),Ge(a,l)+n+r*Math.sin(u)]);return d.push([e+i*Math.cos(s),n+r*Math.sin(s)]),d.push([e+i*Math.cos(s),n+r*Math.sin(s)]),Q2(d,null,l)}function sY(t,e,n,i,r,o,s,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let d=[0,0];const u=a.disableMultiStroke?1:2,h=a.preserveVertices;for(let p=0;p<u;p++)p===0?l.push({op:"move",data:[s[0],s[1]]}):l.push({op:"move",data:[s[0]+(h?0:Ge(c[0],a)),s[1]+(h?0:Ge(c[0],a))]}),d=h?[r,o]:[r+Ge(c[p],a),o+Ge(c[p],a)],l.push({op:"bcurveTo",data:[t+Ge(c[p],a),e+Ge(c[p],a),n+Ge(c[p],a),i+Ge(c[p],a),d[0],d[1]]});return l}const Zi="none";class aY{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return gk()}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,n,i){return{shape:e,sets:n||[],options:i||this.defaultOptions}}line(e,n,i,r,o){const s=this._o(o);return this._d("line",[_T(e,n,i,r,s)],s)}rectangle(e,n,i,r,o){const s=this._o(o),a=[],l=Kq(e,n,i,r,s);if(s.fill){const c=[[e,n],[e+i,n],[e+i,n+r],[e,n+r]];s.fillStyle==="solid"?a.push(kf([c],s)):a.push(u1([c],s))}return s.stroke!==Zi&&a.push(l),this._d("rectangle",a,s)}ellipse(e,n,i,r,o){const s=this._o(o),a=[],l=CT(i,r,s),c=e8(e,n,s,l);if(s.fill)if(s.fillStyle==="solid"){const d=e8(e,n,s,l).opset;d.type="fillPath",a.push(d)}else a.push(u1([c.estimatedPoints],s));return s.stroke!==Zi&&a.push(c.opset),this._d("ellipse",a,s)}circle(e,n,i,r){const o=this.ellipse(e,n,i,i,r);return o.shape="circle",o}linearPath(e,n){const i=this._o(n);return this._d("linearPath",[l2(e,!1,i)],i)}arc(e,n,i,r,o,s,a=!1,l){const c=this._o(l),d=[],u=kx(e,n,i,r,o,s,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const h={...c};h.disableMultiStroke=!0;const p=kx(e,n,i,r,o,s,!0,!1,h);p.type="fillPath",d.push(p)}else d.push(tY(e,n,i,r,o,s,c));return c.stroke!==Zi&&d.push(u),this._d("arc",d,c)}curve(e,n){const i=this._o(n),r=[],o=Qq(e,i);if(i.fill&&i.fill!==Zi&&e.length>=3){const s=Aq(e),a=bT(s,10,(1+i.roughness)/2);i.fillStyle==="solid"?r.push(kf([a],i)):r.push(u1([a],i))}return i.stroke!==Zi&&r.push(o),this._d("curve",r,i)}polygon(e,n){const i=this._o(n),r=[],o=l2(e,!0,i);return i.fill&&(i.fillStyle==="solid"?r.push(kf([e],i)):r.push(u1([e],i))),i.stroke!==Zi&&r.push(o),this._d("polygon",r,i)}path(e,n){const i=this._o(n),r=[];if(!e)return this._d("path",r,i);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const o=i.fill&&i.fill!=="transparent"&&i.fill!==Zi,s=i.stroke!==Zi,a=!!(i.simplification&&i.simplification<1),l=a?4-4*i.simplification:(1+i.roughness)/2,c=Fq(e,1,l);return o&&(i.fillStyle==="solid"?r.push(kf(c,i)):r.push(u1(c,i))),s&&(a?c.forEach(d=>{r.push(l2(d,!1,i))}):r.push(eY(e,i))),this._d("path",r,i)}opsToPath(e,n){let i="";for(const r of e.ops){const o=typeof n=="number"&&n>=0?r.data.map(s=>+s.toFixed(n)):r.data;switch(r.op){case"move":i+=`M${o[0]} ${o[1]} `;break;case"bcurveTo":i+=`C${o[0]} ${o[1]}, ${o[2]} ${o[3]}, ${o[4]} ${o[5]} `;break;case"lineTo":i+=`L${o[0]} ${o[1]} `;break}}return i.trim()}toPaths(e){const n=e.sets||[],i=e.options||this.defaultOptions,r=[];for(const o of n){let s=null;switch(o.type){case"path":s={d:this.opsToPath(o),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:Zi};break;case"fillPath":s={d:this.opsToPath(o),stroke:Zi,strokeWidth:0,fill:i.fill||Zi};break;case"fillSketch":s=this.fillSketch(o,i);break}s&&r.push(s)}return r}fillSketch(e,n){let i=n.fillWeight;return i<0&&(i=n.strokeWidth/2),{d:this.opsToPath(e),stroke:n.fill||Zi,strokeWidth:i,fill:Zi}}}class Lx{constructor(e,n){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new aY(n)}draw(e){const n=e.sets||[],i=e.options||this.getDefaultOptions(),r=this.ctx,o=e.options.fixedDecimalPlaceDigits;for(const s of n)switch(s.type){case"path":r.save(),r.strokeStyle=i.stroke==="none"?"transparent":i.stroke,r.lineWidth=i.strokeWidth,i.strokeLineDash&&r.setLineDash(i.strokeLineDash),i.strokeLineDashOffset&&(r.lineDashOffset=i.strokeLineDashOffset),this._drawToContext(r,s,o),r.restore();break;case"fillPath":{r.save(),r.fillStyle=i.fill||"";const a=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(r,s,o,a),r.restore();break}case"fillSketch":this.fillSketch(r,s,i);break}}fillSketch(e,n,i){let r=i.fillWeight;r<0&&(r=i.strokeWidth/2),e.save(),i.fillLineDash&&e.setLineDash(i.fillLineDash),i.fillLineDashOffset&&(e.lineDashOffset=i.fillLineDashOffset),e.strokeStyle=i.fill||"",e.lineWidth=r,this._drawToContext(e,n,i.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,n,i,r="nonzero"){e.beginPath();for(const o of n.ops){const s=typeof i=="number"&&i>=0?o.data.map(a=>+a.toFixed(i)):o.data;switch(o.op){case"move":e.moveTo(s[0],s[1]);break;case"bcurveTo":e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"lineTo":e.lineTo(s[0],s[1]);break}}n.type==="fillPath"?e.fill(r):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,n,i,r,o){const s=this.gen.line(e,n,i,r,o);return this.draw(s),s}rectangle(e,n,i,r,o){const s=this.gen.rectangle(e,n,i,r,o);return this.draw(s),s}ellipse(e,n,i,r,o){const s=this.gen.ellipse(e,n,i,r,o);return this.draw(s),s}circle(e,n,i,r){const o=this.gen.circle(e,n,i,r);return this.draw(o),o}linearPath(e,n){const i=this.gen.linearPath(e,n);return this.draw(i),i}polygon(e,n){const i=this.gen.polygon(e,n);return this.draw(i),i}arc(e,n,i,r,o,s,a=!1,l){const c=this.gen.arc(e,n,i,r,o,s,a,l);return this.draw(c),c}curve(e,n){const i=this.gen.curve(e,n);return this.draw(i),i}path(e,n){const i=this.gen.path(e,n);return this.draw(i),i}}class nl{constructor(){}setRenderer(e){this._renderer=e}}class ET extends E9{constructor(e){super(),this.stackingCanvasUpdated=new Ve,this._stackingCanvas=[],this._overlays=new Set,this._shouldUpdate=!1,this._disposables=new dt;const n=document.createElement("canvas");this.canvas=n,this.ctx=this.canvas.getContext("2d"),this.rc=new Lx(n),this.layerManager=e.layerManager,this.provider=e.provider??{},this._initViewport(),e.enableStackingCanvas=e.enableStackingCanvas??!1,e.enableStackingCanvas&&this._initStackingCanvas(e.onStackingCanvasCreated)}get stackingCanvas(){return this._stackingCanvas}_initViewport(){this.viewportUpdated.on(()=>{this._shouldUpdate=!0});let e=null;this.sizeUpdated.on(()=>{e||Eo(()=>{this._resetSize(),this._render(),e=null,this._shouldUpdate=!1},this._el)})}_initStackingCanvas(e){const n=this.layerManager,i=o=>{this._stackingCanvas=o;const s=window.devicePixelRatio,a=Math.ceil(this._width*s),l=Math.ceil(this._height*s);o.forEach(c=>{c.width===a&&c.height===l||(c.style.setProperty("width",`${this._width}px`),c.style.setProperty("height",`${this._height}px`),c.width=a,c.height=l)})},r=()=>{const o=n.getCanvasLayers().slice(0,-1),s=[],a=this._stackingCanvas;for(let l=0;l<o.length;++l){const c=o[l],d=l<a.length,u=d?a[l]:document.createElement("canvas");d||(this._stackingCanvas.push(u),e?.(u)),u.setAttribute("data-layer-id",`[${c.indexes[0]}--${c.indexes[1]}]`),u.style.setProperty("z-index",c.zIndexes.toString()),s.push(u)}this._stackingCanvas=s,i(s),this.stackingCanvasUpdated.emit(s)};this._disposables.add(this.layerManager.slots.layerUpdated.on(()=>{r()})),r()}getVariableColor(e){return this.provider.getVariableColor?.(e)??e}refresh(){this._shouldUpdate=!0}attach(e){this.setContainer(e),e.appendChild(this.canvas),this._resetSize(),this._loop()}_resetSize(){const{canvas:e}=this,n=window.devicePixelRatio;e.style.width="100%",e.style.height="100%";const i=e.getBoundingClientRect(),r=Math.ceil(i.width*n),o=Math.ceil(i.height*n);e.width=r,e.height=o,this._stackingCanvas.forEach(s=>{s.width=r,s.height=o,s.style.width=`${i.width}px`,s.style.height=`${i.height}px`}),this._shouldUpdate=!0}_loop(){Eo(()=>{this._shouldUpdate&&this._render(),this._shouldUpdate=!1,this._loop()},this._el)}_render(){const{ctx:e,viewportBounds:n,rc:i,zoom:r}=this,o=window.devicePixelRatio,s=r*o,a=new DOMMatrix().scaleSelf(s);let l=[];this.layerManager.getCanvasLayers().forEach((c,d)=>{if(!this._stackingCanvas[d]){l=l.concat(c.elements);return}const u=this._stackingCanvas[d],h=u.getContext("2d");h.clearRect(0,0,u.width,u.height),h.save(),h.setTransform(a),this._renderByBound(h,a,i,n,c.elements)}),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.save(),e.setTransform(a),this._renderByBound(e,a,i,n,l,!0)}_renderByBound(e,n,i,r,o,s=!1){if(!e)return;const a=o??this.layerManager.canvasGrid.search(r);for(const l of a){e.save();const c=l.display??!0,d=l.opacity??1;if(x7(ks(l),r)&&c){e.globalAlpha=d;const u=l.x-r.x,h=l.y-r.y,p=Mq[l.type];if(!p){console.warn(`Cannot find renderer for ${l.type}`);continue}p(l,e,n.translate(u,h),this)}e.restore()}if(s)for(const l of this._overlays)e.save(),e.translate(-r.x,-r.y),l.render(e,i),e.restore();e.restore()}getCanvasByBound(e=this.viewportBounds,n,i,r,o){i=i||document.createElement("canvas");const s=window.devicePixelRatio||1;i.width!==e.w*s&&(i.width=e.w*s),i.height!==e.h*s&&(i.height=e.h*s),i.style.width=`${e.w}px`,i.style.height=`${e.h}px`;const a=i.getContext("2d"),l=new DOMMatrix().scaleSelf(o?s*this.zoom:s),c=new Lx(i);return r&&a.clearRect(0,0,i.width,i.height),a.setTransform(l),this._renderByBound(a,l,c,e,n),i}addOverlay(e){e.setRenderer(this),this._overlays.add(e),this._shouldUpdate=!0}removeOverlay(e){e.setRenderer(null),this._overlays.delete(e),this._shouldUpdate=!0}dispose(){super.dispose()}}var jt=(t=>(t[t.Straight=0]="Straight",t[t.Orthogonal=1]="Orthogonal",t[t.Curve=2]="Curve",t))(jt||{}),sn=(t=>(t.Front="Front",t.Rear="Rear",t))(sn||{}),St=(t=>(t.None="None",t.Arrow="Arrow",t.Triangle="Triangle",t.Circle="Circle",t.Diamond="Diamond",t))(St||{});const ST="None",TT="Arrow";var qd=(t=>(t.Rect="rect",t.Triangle="triangle",t.Ellipse="ellipse",t.Diamond="diamond",t))(qd||{}),IT=(t=>(t[t.SMALL=12]="SMALL",t[t.MEDIUM=20]="MEDIUM",t[t.LARGE=28]="LARGE",t[t.XLARGE=36]="XLARGE",t))(IT||{});const LT=20,t8=["--affine-palette-shape-yellow","--affine-palette-shape-orange","--affine-palette-shape-tangerine","--affine-palette-shape-red","--affine-palette-shape-magenta","--affine-palette-shape-purple","--affine-palette-shape-green","--affine-palette-shape-blue","--affine-palette-shape-navy","--affine-palette-shape-black","--affine-palette-shape-white","--affine-palette-transparent"],MT=t8[0],lY=ge.union([ge.literal("--affine-palette-shape-yellow"),ge.literal("--affine-palette-shape-orange"),ge.literal("--affine-palette-shape-tangerine"),ge.literal("--affine-palette-shape-red"),ge.literal("--affine-palette-shape-magenta"),ge.literal("--affine-palette-shape-purple"),ge.literal("--affine-palette-shape-green"),ge.literal("--affine-palette-shape-blue"),ge.literal("--affine-palette-shape-navy"),ge.literal("--affine-palette-shape-black"),ge.literal("--affine-palette-shape-white"),ge.literal("--affine-palette-transparent")]),n8=["--affine-palette-line-yellow","--affine-palette-line-orange","--affine-palette-line-tangerine","--affine-palette-line-red","--affine-palette-line-magenta","--affine-palette-line-purple","--affine-palette-line-green","--affine-palette-line-blue","--affine-palette-line-navy","--affine-palette-line-black","--affine-palette-line-white","--affine-palette-transparent"],PT=n8[0],cY=ge.union([ge.literal("--affine-palette-line-yellow"),ge.literal("--affine-palette-line-orange"),ge.literal("--affine-palette-line-tangerine"),ge.literal("--affine-palette-line-red"),ge.literal("--affine-palette-line-magenta"),ge.literal("--affine-palette-line-purple"),ge.literal("--affine-palette-line-green"),ge.literal("--affine-palette-line-blue"),ge.literal("--affine-palette-line-navy"),ge.literal("--affine-palette-line-black"),ge.literal("--affine-palette-line-white"),ge.literal("--affine-palette-transparent")]),AT=function(){let e=null,n=null;return()=>(n||(n=document.createElement("canvas"),e=n.getContext("2d")),e)}();function kl(t){return`"${t}"`}function dY(t,e){const n=AT();return e!==n.font&&(n.font=e),n.measureText(t).width}function uY(t,e,n){const i=AT(),r=`${n}px "${e}"`;r!==i.font&&(i.font=r);const o=i.measureText(t),s=o.fontBoundingBoxAscent+o.fontBoundingBoxDescent;return{w:o.width,h:s}}function Mx(t){return[...document.fonts.keys()].filter(n=>n.family===t).filter((n,i,r)=>r.findIndex(o=>o.family===n.family&&o.weight===n.weight&&o.style===n.style)===i)}function hY(t,e){return[t[0][1],t[1][1],e[0][1],e[1][1]].every(n=>xt(n,t[0][1],.02))?vh(t,e,0):[t[0][0],t[1][0],e[0][0],e[1][0]].every(n=>xt(n,t[0][0],.02))?vh(t,e,1):!1}function g6(t,e){return xt(t[0],e[0])&&xt(t[1],e[1])}class pY{constructor(e,n=[],i=[],r=[]){this.points=e,this.blocks=n,this.expandedBlocks=i,this.excludedPoints=r,this._xMap=new Map,this._yMap=new Map;const o=this._xMap,s=this._yMap;this.points.forEach(a=>{const[l,c]=a;o.has(l)||o.set(l,[]),s.has(c)||s.set(c,[]),o.get(l)?.push(a),s.get(c)?.push(a)})}_isBlock(e,n){return this.blocks.some(i=>Co(e,n,i.points)?.length===2||i.isPointInBound(e,0)||i.isPointInBound(n,0)||[i.leftLine,i.upperLine,i.rightLine,i.lowerLine].some(o=>hY(o,[e,n])))||this.expandedBlocks.some(i=>Co(e,n,i.expand(-.5).points)?.length===2)}neighbors(e){const[n,i]=e,r=new Set,o=this._xMap.get(n),s=this._yMap.get(i);if(o){let a=1/0,l=1/0,c,d;o.forEach(u=>{if(g6(u,e))return;const h=u[1]-e[1];h>0&&h<a&&(a=h,c=u),h<0&&Math.abs(h)<l&&(l=Math.abs(h),d=u)}),c&&(this._canSkipBlock(c)||!this._isBlock(e,c))&&r.add(c),d&&(this._canSkipBlock(d)||!this._isBlock(e,d))&&r.add(d)}if(s){let a=1/0,l=1/0,c,d;s.forEach(u=>{if(g6(u,e))return;const h=u[0]-e[0];h>0&&h<a&&(a=h,c=u),h<0&&Math.abs(h)<l&&(l=Math.abs(h),d=u)}),c&&(this._canSkipBlock(c)||!this._isBlock(e,c))&&r.add(c),d&&(this._canSkipBlock(d)||!this._isBlock(e,d))&&r.add(d)}return Array.from(r)}_canSkipBlock(e){return this.excludedPoints.some(n=>g6(e,n))}}class fY{constructor(e){this._compare=e,this.heap=[]}enqueue(e,n){const i={value:e,priority:n};this.heap.push(i),this.bubbleUp()}dequeue(){const e=this.heap[0],n=this.heap.pop();return this.heap.length>0&&n&&(this.heap[0]=n,this.bubbleDown()),e?.value??null}empty(){return this.heap.length===0}bubbleUp(e=this.heap.length-1){const n=this.heap[e];for(;e>0;){const i=Math.floor((e-1)/2),r=this.heap[i];if(this._compare(r.priority,n.priority)<=0)break;this.heap[i]=n,this.heap[e]=r,e=i}}bubbleDown(){let e=0;const n=this.heap.length,i=this.heap[0];for(;;){const r=2*e+1,o=2*e+2;let s=-1,a,l;if(r<n&&(a=this.heap[r],this._compare(a.priority,i.priority)<0&&(s=r)),o<n&&(a=this.heap[r],l=this.heap[o],(s===null&&this._compare(l.priority,i.priority)<0||s!==null&&this._compare(l.priority,a.priority)<0)&&(s=o)),s===-1)break;this.heap[e]=this.heap[s],this.heap[s]=i,e=s}}}function gY(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])}function Px(t,e){return t[2]+.01<e[2]?-1:t[2]-.01>e[2]?1:t[0]<e[0]?-1:t[0]>e[0]?1:t[1]>e[1]?-1:t[1]<e[1]?1:0}function mY(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])}function bY(t,e,n){return xt(t[0],e[0])&&xt(t[0],n[0])||xt(t[1],e[1])&&xt(t[1],n[1])?0:1}function Ef(t,e){return xt(t[0],e[0],.02)&&xt(t[1],e[1],.02)}class vY{constructor(e,n,i,r,o,s=[],a=[]){this._sp=n,this._ep=i,this._originalSp=r,this._originalEp=o,this._cameFrom=new Map,this._costSoFar=new Map,this._diagonalCount=new Map,this._pointPriority=new Map,this._current=null,this._complete=!1,this._sp[2]=0,this._ep[2]=0,this._originalEp[2]=0,this._graph=new pY([...e],s,a),this._init()}_init(){this._cameFrom.set(this._sp,{from:[this._originalSp],indexs:[-1]}),this._cameFrom.set(this._originalSp,{from:[],indexs:[]}),this._costSoFar.set(this._sp,[0]),this._diagonalCount.set(this._sp,[0]),this._pointPriority.set(this._sp,[0]),this._frontier=new fY(Px),this._frontier.enqueue(this._sp,[0,0,0])}_neighbors(e){const n=this._graph.neighbors(e),i=this._cameFrom.get(e);return D(i),i.from.forEach(r=>{const o=n.findIndex(s=>Ef(s,r));o>=0&&n.splice(o,1)}),e===this._ep&&n.push(this._originalEp),n}step(){if(this._complete)return;this._current=this._frontier.dequeue();const e=this._current;if(!e){this._complete=!0;return}e===this._ep&&Ef(this._ep,this._originalEp)&&(this._originalEp=this._ep);const n=this._neighbors(e);for(let i=0;i<n.length;i++){const r=n[i],o=this._costSoFar.get(e),s=this._diagonalCount.get(e),a=this._pointPriority.get(e),l=this._cameFrom.get(e);D(o),D(s),D(a),D(l);const c=o.map(k=>k+gY(e,r)),d=s.map((k,_)=>k+bY(r,e,l.from[_]));D(r[2]);const u=a.map(k=>k+r[2]);let h=-1;if(c.length===1)h=0;else{const k=Ax(c,(_,A)=>_+.01<A,(_,A)=>xt(_,A,.02));if(k.length===1)h=k[0];else{const _=k.map($=>d[$]),A=Ax(_,($,E)=>$<E,($,E)=>$===E);if(A.length===1)h=k[A[0]];else{const $=A.map(R=>u[k[R]]);h=yY($,(R,I)=>R>I,(R,I)=>R===I)[0]}}}const p=!this._costSoFar.has(r),g=this._costSoFar.get(r)??[],f=this._diagonalCount.get(r)??[],v=this._pointPriority.get(r)??[],m=this._cameFrom.get(r)??{from:[],indexs:[]};g.push(c[h]),f.push(d[h]),v.push(u[h]),m.from.push(e),m.indexs.push(h);const y=d[h],x=u[h],T=c[h];this._costSoFar.set(r,g),this._diagonalCount.set(r,f),this._pointPriority.set(r,v),this._cameFrom.set(r,m);const M=[y,x,T+mY(r,this._ep)];if(p)this._frontier.enqueue(r,M);else{const k=this._frontier.heap.findIndex(A=>A.value===r),_=this._frontier.heap[k];_?Px(M,_.priority)<0&&(_.priority=M,this._frontier.bubbleUp(k)):this._frontier.enqueue(r,M)}if(Ef(e,this._ep)&&Ef(r,this._originalEp)){this._originalEp=r,this._complete=!0;return}}}reset(){this._cameFrom.clear(),this._costSoFar.clear(),this._diagonalCount.clear(),this._pointPriority.clear(),this._complete=!1,this._init()}run(){for(;!this._complete;)this.step()}get path(){const e=[];let n=this._complete?this._originalEp:this._current;const i=[0];for(;n;){e.unshift(n);const r=this._cameFrom.get(n);if(!r)return e;const o=i.shift();D(o),i.push(r.indexs[o]),n=r.from[o]}return e}}function Ax(t,e,n){let i=1/0,r=[];for(let o=0;o<t.length;o++){const s=t[o];e(s,i)?(i=s,r=[o]):n(s,i)&&r.push(o)}return r}function yY(t,e,n){let i=-1/0,r=[];for(let o=0;o<t.length;o++){const s=t[o];e(s,i)?(i=s,r=[o]):n(s,i)&&r.push(o)}return r}function J2(t,e=!1){return{...ne.deserialize(t.xywh),rotate:e?-t.rotate:t.rotate}}function wY(t,e){if(!e.find(a=>a.id===t.id))return!1;const{source:i,target:r}=t,o=e.find(a=>a.id===i?.id),s=e.find(a=>a.id===r?.id);return!!(!i.id&&!r.id||!i.id&&s||!r.id&&o||o&&s)}function e5(t){const e=ne.deserialize(t.xywh),n=10,i=[],r=t.rotate;return[[e.center[0],e.y-n],[e.center[0],e.maxY+n],[e.x-n,e.center[1]],[e.maxX+n,e.center[1]]].map(o=>C7({...e,rotate:r},o)).forEach(o=>{const s=t.intersectWithLine(e.center,o);D(s);const a=C7({...e,rotate:-r},s[0]);i.push({point:s[0],coord:e.toRelative(a)})}),i}function xY(t,e){const n=t.getRelativePointLocation(e);return cf(te.sub(e,[0,.5]))?n.tangent=te.rot([0,-1],vr(t.rotate)):cf(te.sub(e,[1,.5]))?n.tangent=te.rot([0,1],vr(t.rotate)):cf(te.sub(e,[.5,0]))?n.tangent=te.rot([1,0],vr(t.rotate)):cf(te.sub(e,[.5,1]))&&(n.tangent=te.rot([-1,0],vr(t.rotate))),n}function qu(t,e){const n=e5(t);return _Y(n.map(i=>i.point),e)}function _Y(t,e){const n=t.map(i=>({p:i,d:te.dist(i,e)}));return n.sort((i,r)=>i.d-r.d),n[0].p}function CY(t,e,n,i,r,o,s,a){t=sh(t),e=sh(e),n=sh(n),i=sh(i);const l=SY(t,e,n,i,r,o,s,a),c=l.points;return n=l.nextStartPoint,i=l.lastEndPoint,[$x($x(c,s?.expand(-1)??null),a?.expand(-1)??null),t,e,n,i]}function sh(t){return[Number(t[0].toFixed(2)),Number(t[1].toFixed(2)),t[2]??0]}function $x(t,e){return t.filter(n=>e?!e.isPointInBound(n):!0)}function zr(t,e,n=0){t.push(...e.map(i=>[...i,n]))}function fa(t,e,n,i=0){const r=jr(e[0],e[1],n[0],n[1],!0);r&&zr(t,[r],i)}function kY(t,e,n,i){e&&n&&i&&(zr(t,i.getVerticesAndMidpoints()),zr(t,[i.center],2),[e.upperLine,e.horizontalLine,e.lowerLine,n.upperLine,n.horizontalLine,n.lowerLine].forEach(r=>{fa(t,r,i.leftLine,0),fa(t,r,i.rightLine,0)}),[e.leftLine,e.verticalLine,e.rightLine,n.leftLine,n.verticalLine,n.rightLine].forEach(r=>{fa(t,r,i.upperLine,0),fa(t,r,i.lowerLine,0)}))}function Bx(t,e,n,i,r){if(e.maxX<n.x){const o=(e.maxX+n.x)/2;[i.horizontalLine,r.horizontalLine,i.upperLine,i.lowerLine,r.upperLine,r.lowerLine].forEach((s,a)=>{fa(t,s,[[o,0],[o,1]],a===0||a===1?6:3)})}if(e.maxY<n.y){const o=(e.maxY+n.y)/2;[i.verticalLine,r.verticalLine,i.leftLine,i.rightLine,r.leftLine,r.rightLine].forEach((s,a)=>{fa(t,s,[[0,o],[1,o]],a===0||a===1?6:3)})}}function Dx(t,e,n,i,r,o){if(xt(e[1],n.y,.02)||xt(e[1],n.maxY,.02)){const s=[n.upperLine,n.lowerLine,i.upperLine,i.lowerLine].map(l=>jr(e,[e[0],e[1]+1],l[0],l[1],!0));s.sort((l,c)=>l[1]-c[1]);const a=te.lrp(s[1],s[2],.5);zr(t,[a],6),[r.leftLine,r.rightLine,o.leftLine,o.rightLine].forEach(l=>{fa(t,[a,[a[0]+1,a[1]]],l,0)})}else{const s=[n.leftLine,n.rightLine,i.leftLine,i.rightLine].map(l=>jr(e,[e[0]+1,e[1]],l[0],l[1],!0));s.sort((l,c)=>l[0]-c[0]);const a=te.lrp(s[1],s[2],.5);zr(t,[a],6),[r.upperLine,r.lowerLine,o.upperLine,o.lowerLine].forEach(l=>{fa(t,[a,[a[0],a[1]+1]],l,0)})}}function EY(t){t=t.map(sh),t.sort((e,n)=>e[0]-n[0]);for(let e=1;e<t.length-1;e++){const n=t[e],i=t[e-1];xt(n[0],i[0],.02)&&(n[0]=i[0])}t.sort((e,n)=>e[1]-n[1]);for(let e=1;e<t.length-1;e++){const n=t[e],i=t[e-1];xt(n[1],i[1],.02)&&(n[1]=i[1])}t.sort((e,n)=>e[0]<n[0]?-1:e[0]>n[0]?1:e[1]<n[1]?-1:e[1]>n[1]?1:0);for(let e=1;e<t.length;e++){const n=t[e],i=t[e-1];if(xt(n[0],i[0],.02)&&xt(n[1],i[1],.02)){n[2]<=i[2]?t.splice(e,1):t.splice(e-1,1),e--;continue}}return t}function SY(t,e,n,i,r,o,s,a){const l=ne.fromPoints([t,e]),c=s&&a&&s.unite(a);let d=[n,i];zr(d,l.getVerticesAndMidpoints()),(!r||!o)&&zr(d,[l.center],3),c&&kY(d,s,a,c),r&&o&&(D(s),D(a),Dx(d,t,r,o,s,a),Dx(d,e,o,r,a,s),Bx(d,r,o,s,a),Bx(d,o,r,a,s)),s&&(zr(d,s.getVerticesAndMidpoints()),zr(d,s.include(i).points)),a&&(zr(d,a.getVerticesAndMidpoints()),zr(d,a.include(n).points)),d=EY(d);const u=d.map(p=>p[0]+","+p[1]).sort();u.forEach((p,g)=>{if(g!==0&&p===u[g-1])throw new Error("duplicate point")});const h=[n,i].map(p=>d.find(g=>xt(g[0],p[0],.02)&&xt(g[1],p[1],.02)));return D(h[0]),D(h[1]),{points:d,nextStartPoint:h[0],lastEndPoint:h[1]}}function m6(t,e){if(xt(t[0],e[0],.02)||xt(t[1],e[1],.02))return[t,e];{const n=te.sub(e,t),i=[t[0],t[1]+n[1]];return[t,i,e]}}function TY(t){if(t.length===0)return[];const e=[[t[0][0],t[0][1]]];for(let n=1;n<t.length-1;n++){const i=t[n],r=t[n-1],o=t[n+1];xt(r[0],i[0],.02)&&xt(i[0],o[0],.02)||xt(r[1],i[1],.02)&&xt(i[1],o[1],.02)||e.push([i[0],i[1]])}e.push(t[t.length-1]);for(let n=0;n<e.length-1;n++){const i=e[n],r=e[n+1];try{ok(xt(i[0],r[0],.02)||xt(i[1],r[1],.02),!0)}catch{console.log(t),console.log(e)}}return e}function IY(t,e){const n=[20,20,20,20],i=[20,20,20,20];if(!(t&&e))return[n,i];let r=vh(t.upperLine,e.lowerLine,0,!1),o;return r&&t.upperLine[0][1]>e.lowerLine[0][1]&&(o=te.distanceToLineSegment(t.upperLine[0],t.upperLine[1],e.lowerLine[0],!1),n[1]=Math.max(Math.min(o/2,n[1]),0)),r=vh(t.rightLine,e.leftLine,1,!1),r&&t.rightLine[0][0]<e.leftLine[0][0]&&(o=te.distanceToLineSegment(t.rightLine[0],t.rightLine[1],e.leftLine[0],!1),n[2]=Math.max(Math.min(o/2,n[2]),0)),r=vh(t.lowerLine,e.upperLine,0,!1),r&&t.lowerLine[0][1]<e.upperLine[0][1]&&(o=te.distanceToLineSegment(t.lowerLine[0],t.lowerLine[1],e.upperLine[0],!1),n[3]=Math.max(Math.min(o/2,n[3]),0)),n[0]=i[2]=Math.min(n[0],i[2])===0?20:Math.min(n[0],i[2]),n[1]=i[3]=Math.min(n[1],i[3])===0?20:Math.min(n[1],i[3]),n[2]=i[0]=Math.min(n[2],i[0])===0?20:Math.min(n[2],i[0]),n[3]=i[1]=Math.min(n[3],i[1])===0?20:Math.min(n[3],i[1]),[n,i]}function Ox(t,e,n=10,i=10,r=10,o=10){const s=Array.from(e);if(xt(t.x,s[0]))s[0]-=n;else if(xt(t.y,s[1]))s[1]-=i;else if(xt(t.maxX,s[0]))s[0]+=r;else if(xt(t.maxY,s[1]))s[1]+=o;else{const a=te.normalize(te.sub(s,t.center)),l=a[0]>0?1:-1,c=a[1]>0?1:-1;if((Math.abs(e.tangent[0])<Math.abs(e.tangent[1])?0:1)===0)if(l>0){const u=jr(t.rightLine[0],t.rightLine[1],s,[t.maxX+10,s[1]]);D(u),s[0]=u[0]+n}else{const u=jr(t.leftLine[0],t.leftLine[1],s,[t.x-10,s[1]]);D(u),s[0]=u[0]-n}else if(c>0){const u=jr(t.lowerLine[0],t.lowerLine[1],s,[s[0],t.maxY+10]);D(u),s[1]=u[1]+i}else{const u=jr(t.upperLine[0],t.upperLine[1],s,[s[0],t.y-10]);D(u),s[1]=u[1]-i}}return s}function LY(t,e,n,i,r,o){const s=n&&r?Ox(n,t,r[0],r[1],r[2],r[3]):t,a=i&&o?Ox(i,e,o[0],o[1],o[2],o[3]):e;return[s,a]}function MY(t,e,n=null,i=null){i||(Math.abs(e[0]-t[0])>Math.abs(e[1]-t[1])?e[0]+=hf(e[0]-t[0])*20:e[1]+=hf(e[1]-t[1])*20),n||(Math.abs(e[0]-t[0])>Math.abs(e[1]-t[1])?t[0]-=hf(e[0]-t[0])*20:t[1]-=hf(e[1]-t[1])*20)}class PY extends nl{constructor(e){super(),this._service=e,this.points=[],this.highlightPoint=null,this.bound=null}_findConnectablesInViews(){const e=this._service,n=this._service.viewport.viewportBounds;return e.pickElementsByBound(n).filter(i=>i.connectable)}render(e){const n=this._service.viewport.zoom;this.points.forEach(i=>{e.beginPath(),e.arc(i[0],i[1],3/n,0,Math.PI*2),e.fillStyle="white",e.strokeStyle="blue",e.fill(),e.stroke()}),this.highlightPoint&&(e.beginPath(),e.arc(this.highlightPoint[0],this.highlightPoint[1],3/n,0,Math.PI*2),e.fillStyle="blue",e.strokeStyle="blue",e.fill(),e.stroke()),this.bound&&(e.beginPath(),e.rect(this.bound.x,this.bound.y,this.bound.w,this.bound.h),e.fillStyle="rgba(211, 211, 211, 0.3)",e.fill())}renderConnector(e,n=[]){const i=this._findConnectablesInViews(),r=this._service;this.clear();let o=null;for(let s=0;s<i.length;s++){const a=i[s];if(n.includes(a.id))continue;const l=ne.deserialize(a.xywh);if(!ne.from(ks(J2(a))).expand(10).isPointInBound(e))continue;const d=e5(a);this.points=d.map(h=>h.point);for(let h=0;h<d.length;h++){const p=d[h],g=r.viewport.toViewCoord(p.point[0],p.point[1]),f=r.viewport.toViewCoord(e[0],e[1]);te.dist(g,f)<20&&(this.highlightPoint=p.point,o={id:a.id,position:p.coord})}if(o)break;const u=a.getNearestPoint(e);if(te.dist(u,e)<8){this.highlightPoint=u;const h=C7(J2(a,!0),u);this._renderer.refresh(),o={id:a.id,position:l.toRelative(h).map(p=>Zr(p,0,1))}}if(o)break;a.hitTest(e[0],e[1],{ignoreTransparent:!1})&&(o={id:a.id})}return o||(o={position:e}),this._renderer.refresh(),o}clear(){this.points=[],this.highlightPoint=null,this.bound=null}}class $T{constructor(e){this.options=e,this._aStarRunner=null}_getConnectorEndElement(e,n){const i=e[n].id;return i?this.options.getElementById(i):null}_getConnectionPoint(e,n){const i=e[n],r=n==="source"?"target":"source";if(i.id){const o=this._getConnectorEndElement(e,n);if(D(o),i.position)return xY(o,i.position);{const s=this._getConnectionPoint(e,r);return qu(o,s)}}else return D(i.position),En.fromVec(i.position)}_generateStraightConnectorPath(e){const{source:n,target:i}=e;if(n.id&&!n.position&&i.id&&!i.position){const r=this._getConnectorEndElement(e,"source"),o=this._getConnectorEndElement(e,"target"),s=ne.deserialize(r.xywh),a=ne.deserialize(o.xywh),l=qu(r,a.center),c=qu(o,s.center);return[l,c]}else{const r=this._getConnectionPoint(e,"target"),o=this._getConnectionPoint(e,"source");return(o&&r&&[o,r])??[]}}_computeStartEndPoint(e){const{source:n,target:i}=e,r=this._getConnectorEndElement(e,"source"),o=this._getConnectorEndElement(e,"target");let s,a;if(n.id&&!n.position&&i.id&&!i.position){D(r),D(o);const l=e5(r),c=e5(o);let d=1/0,u=new En,h=new En;for(const p of l)for(const g of c){const f=te.dist(p.point,g.point);f+.1<d&&(d=f,u=p.point,h=g.point)}s=u,a=h}else s=this._getConnectionPoint(e,"source"),a=this._getConnectionPoint(e,"target");return[s,a]}_generateCurveConnectorPath(e){const{source:n,target:i}=e;if(n.id||i.id){let r,o;if(!n.position&&!i.position){const s=this._getConnectorEndElement(e,"source"),a=this._getConnectorEndElement(e,"target"),l=ne.deserialize(s.xywh),c=ne.deserialize(a.xywh);r=qu(s,c.center),o=qu(a,l.center)}else r=this._getConnectionPoint(e,"source"),o=this._getConnectionPoint(e,"target");if(n.id){const s=te.rot(r.tangent,-Math.PI/2);r.out=te.mul(s,Math.max(100,Math.abs(te.pry(te.sub(o,r),s))/3))}if(i.id){const s=te.rot(o.tangent,-Math.PI/2);o.in=te.mul(s,Math.max(100,Math.abs(te.pry(te.sub(r,o),s))/3))}return[r,o]}else{const r=this._getConnectionPoint(e,"target"),o=this._getConnectionPoint(e,"source");return Math.abs(r[0]-o[0])>Math.abs(r[1]-o[1])?(o.out=[te.mul(te.sub(r,o),2/3)[0],0],r.in=[te.mul(te.sub(o,r),2/3)[0],0]):(o.out=[0,te.mul(te.sub(r,o),2/3)[1]],r.in=[0,te.mul(te.sub(o,r),2/3)[1]]),[o,r]}}_prepareOrthogonalConnectorInfo(e){const{startBound:n,endBound:i,startPoint:r,endPoint:o}=e,[s,a]=IY(n,i),[l,c]=LY(r,o,n,i,s,a),d=n?n.expand(s[0],s[1],s[2],s[3]):null,u=i?i.expand(a[0],a[1],a[2],a[3]):null;return[r,o,l,c,n,i,d,u]}_generateConnectorPath(e){const{mode:n}=e;if(n===Hl.Straight)return this._generateStraightConnectorPath(e);if(n===Hl.Orthogonal){const i=this._getConnectorEndElement(e,"source"),r=this._getConnectorEndElement(e,"target"),[o,s]=this._computeStartEndPoint(e),a=i?ne.from(ks(J2(i))):null,l=r?ne.from(ks(J2(r))):null;return this.generateOrthogonalConnectorPath({startPoint:o,endPoint:s,startBound:a,endBound:l}).map(d=>new En(d))}else if(n===Hl.Curve)return this._generateCurveConnectorPath(e);throw new Error("unknown connector mode")}updatePath(e,n){const i=n??this._generateConnectorPath(e)??[],r=k7(i),o=i.map(s=>s.setVec(te.sub(s,[r.x,r.y])));e.updatingPath=!0,e.xywh=r.serialize(),e.path=o,e.updatingPath=!1}generateOrthogonalConnectorPath(e){const n=this._prepareOrthogonalConnectorInfo(e);let[i,r,o,s]=n;const[,,,,a,l,c,d]=n,u=[],h=[];if(a&&u.push(a.clone()),l&&u.push(l.clone()),c&&h.push(c.clone()),d&&h.push(d.clone()),a&&l&&a.isPointInBound(r)&&l.isPointInBound(i)||a&&c?.isPointInBound(r,0)||l&&d?.isPointInBound(i,0))return m6(i,r);const p=CY(i,r,o,s,a,l,c,d),g=p[0];[,i,r,o,s]=p,MY(i,r,a,l),this._aStarRunner=new vY(g,o,s,i,r,u,h),this._aStarRunner.run();let f=this._aStarRunner.path;return l||f.pop(),a||f.shift(),f=TY(f),f}hasRelatedElement(e){const{source:n,target:i}=e;return!(n.id&&!this.options.getElementById(n.id)||i.id&&!this.options.getElementById(i.id))}}function AY(t){const e=l=>t.getElementById(l)??t.page.getBlockById(l),n=new $T({getElementById:e}),i=l=>{(l.source?.id&&e(l.source.id)||l.source?.position)&&(l.target?.id&&e(l.target.id)||l.target?.position)&&n.updatePath(l)},r=new Set;let o=!1;const s=l=>{r.add(l),o||(o=!0,queueMicrotask(()=>{r.forEach(i),r.clear(),o=!1}))},a=[t.elementAdded.on(({id:l})=>{const c=e(l);c&&("type"in c&&c.type==="connector"?s(c):t.getConnectors(l).forEach(s))}),t.elementUpdated.on(({id:l,props:c})=>{const d=e(l);(c.xywh||c.rotate)&&t.getConnectors(l).forEach(s),"type"in d&&d.type==="connector"&&(c.target||c.source||c.xywh&&!d.updatingPath)&&s(d)}),t.page.slots.blockUpdated.on(l=>{l.type==="update"&&l.props.key==="xywh"&&t.getConnectors(l.id).forEach(s)})];return t.getElementsByType("connector").forEach(l=>i(l)),()=>{a.forEach(l=>l.dispose())}}function $Y(t){const e=[t.elementRemoved.on(({id:n})=>{t.getGroup(n)?.removeChild(n)}),t.elementUpdated.on(({id:n,props:i})=>{const r=t.getElementById(n);r.type==="group"&&i.childIds&&r.childIds.length===0&&t.removeElement(n)})];return()=>{e.forEach(n=>n.dispose())}}const Rx="affine:surface:text",Nx="affine:surface:ymap";class BY extends ak{_toJSON(e){return e instanceof nt.Y.Text?{[Rx]:!0,delta:e.toDelta()}:e instanceof nt.Y.Map?{[Nx]:!0,json:e.toJSON()}:e}_fromJSON(e){if(e instanceof Object){if(Reflect.has(e,Rx)){const n=new nt.Y.Text;return n.applyDelta(Reflect.get(e,"delta")),n}else if(Reflect.has(e,Nx)){const n=new nt.Y.Map,i=Reflect.get(e,"json");return Object.entries(i).forEach(([r,o])=>{n.set(r,o)}),n}}return e}_elementToJSON(e){const n={};return e.forEach((i,r)=>{n[r]=this._toJSON(i)}),n}elementFromJSON(e){const n=new nt.Y.Map;return Object.entries(e).forEach(([i,r])=>{n.set(i,this._fromJSON(r))}),n}async toSnapshot(e){const n=await super.toSnapshot(e),i=e.model.elements.getValue(),r={};return i&&i.forEach((o,s)=>{r[s]=this._elementToJSON(o)}),n.props={elements:r},n}async fromSnapshot(e){const n=await super.fromSnapshot(e),i=n.props.elements,r=new nt.Y.Map;Object.entries(i).forEach(([s,a])=>{const l=this.elementFromJSON(a);r.set(s,l)});const o=this._internal.Boxed(r);return n.props={elements:o},n}}const DY="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function y1(t,e,n){const i=n[0];if(e!=null&&t>=e)throw new Error(t+" >= "+e);if(t.slice(-1)===i||e&&e.slice(-1)===i)throw new Error("trailing zero");if(e){let s=0;for(;(t[s]||i)===e[s];)s++;if(s>0)return e.slice(0,s)+y1(t.slice(s),e.slice(s),n)}const r=t?n.indexOf(t[0]):0,o=e!=null?n.indexOf(e[0]):n.length;if(o-r>1){const s=Math.round(.5*(r+o));return n[s]}else return e&&e.length>1?e.slice(0,1):n[r]+y1(t.slice(1),null,n)}function BT(t){if(t.length!==DT(t[0]))throw new Error("invalid integer part of order key: "+t)}function DT(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-97+2;if(t>="A"&&t<="Z")return 90-t.charCodeAt(0)+2;throw new Error("invalid order key head: "+t)}function ah(t){const e=DT(t[0]);if(e>t.length)throw new Error("invalid order key: "+t);return t.slice(0,e)}function Hx(t,e){if(t==="A"+e[0].repeat(26))throw new Error("invalid order key: "+t);const n=ah(t);if(t.slice(n.length).slice(-1)===e[0])throw new Error("invalid order key: "+t)}function Fx(t,e){BT(t);const[n,...i]=t.split("");let r=!0;for(let o=i.length-1;r&&o>=0;o--){const s=e.indexOf(i[o])+1;s===e.length?i[o]=e[0]:(i[o]=e[s],r=!1)}if(r){if(n==="Z")return"a"+e[0];if(n==="z")return null;const o=String.fromCharCode(n.charCodeAt(0)+1);return o>"a"?i.push(e[0]):i.pop(),o+i.join("")}else return n+i.join("")}function OY(t,e){BT(t);const[n,...i]=t.split("");let r=!0;for(let o=i.length-1;r&&o>=0;o--){const s=e.indexOf(i[o])-1;s===-1?i[o]=e.slice(-1):(i[o]=e[s],r=!1)}if(r){if(n==="a")return"Z"+e.slice(-1);if(n==="A")return null;const o=String.fromCharCode(n.charCodeAt(0)-1);return o<"Z"?i.push(e.slice(-1)):i.pop(),o+i.join("")}else return n+i.join("")}function ds(t,e,n=DY){if(t!=null&&Hx(t,n),e!=null&&Hx(e,n),t!=null&&e!=null&&t>=e)throw new Error(t+" >= "+e);if(t==null){if(e==null)return"a"+n[0];const l=ah(e),c=e.slice(l.length);if(l==="A"+n[0].repeat(26))return l+y1("",c,n);if(l<e)return l;const d=OY(l,n);if(d==null)throw new Error("cannot decrement any more");return d}if(e==null){const l=ah(t),c=t.slice(l.length),d=Fx(l,n);return d??l+y1(c,null,n)}const i=ah(t),r=t.slice(i.length),o=ah(e),s=e.slice(o.length);if(i===o)return i+y1(r,s,n);const a=Fx(i,n);if(a==null)throw new Error("cannot increment any more");return a<e?a:i+y1(r,null,n)}function OT(){return VB(10)}function RT(t,e=1){const n=Math.sign(t),i=Math.abs(t),r=t2*100;i>r&&(t=r*n);let o=e-t/100;return o+=Math.log10(Math.max(1,e))*-n*Math.min(1,i/20),o}const Ux={toV4:t=>{const{elements:e}=t;if(e instanceof N4){const n=e.getValue();if(!n)return;for(const[i,r]of n.entries()){const o=r.get("type");if(o==="shape"||o==="text"){const s=r.get("isBold"),a=r.get("isItalic");r.delete("isBold"),r.delete("isItalic"),s&&r.set("bold",!0),a&&r.set("italic",!0)}if(o==="connector"){const s=r.get("source"),a=r.get("target"),l=s.id,c=a.id;if(!s.position&&(!l||!n.get(l))){n.delete(i);return}if(!a.position&&(!c||!n.get(c))){n.delete(i);return}}}}else for(const n of Object.keys(e)){const i=e[n],r=i.type;if(r==="shape"||r==="text"){const o=i.isBold,s=i.isItalic;delete i.isBold,delete i.isItalic,o&&(i.bold=!0),s&&(i.italic=!0)}if(r==="connector"){const o=i.source,s=i.target,a=o.id,l=s.id;if(!o.position&&(!a||!e[a])){delete e[n];return}if(!s.position&&(!l||!e[l])){delete e[n];return}}}},toV5:t=>{const{elements:e}=t;if(!(e instanceof N4)){const n=new nt.Y.Map;Object.entries(e).forEach(([r,o])=>{const s=new nt.Y.Map;Object.entries(o).forEach(([a,l])=>{s.set(a,l instanceof nt.Y.Text?l.clone():l instanceof Oi?l.yText.clone():l)}),n.set(r,s)});const i=new N4(n);t.elements=i}}},a3=_i({flavour:"affine:surface",props:t=>({elements:t.Boxed(new nt.Y.Map)}),metadata:{version:5,role:"hub",parent:["affine:page"],children:["affine:frame","affine:image","affine:embed-*","affine:bookmark"]},onUpgrade:(t,e,n)=>{e<4&&n>=4&&Ux.toV4(t),e<5&&n>=5&&Ux.toV5(t)},transformer:()=>new BY,toModel:()=>new RY});class RY extends Bn{constructor(){super(),this._elementModels=new Map,this._disposables=[],this._groupToElements=new Map,this._elementToGroup=new Map,this._connectorToElements=new Map,this._elementToConnector=new Map,this.elementUpdated=new Ve,this.elementAdded=new Ve,this.elementRemoved=new Ve,this.created.once(()=>this._init())}get elementModels(){const e=[];return this._elementModels.forEach(n=>e.push(n.model)),e}_init(){this._initElementModels(),this._watchGroupRelationChange(),this._watchConnectorRelationChange(),this._applyMiddlewares()}_applyMiddlewares(){this._disposables.push(AY(this),$Y(this))}_initElementModels(){const e=this.elements.getValue(),n=i=>{const{changes:r,keysChanged:o}=i;o.forEach(s=>{const a=r.keys.get(s),l=this.elements.getValue().get(s);switch(a?.action){case"add":if(l){if(!this._elementModels.has(s)){const d=S7(l.get("type"),l.get("id"),l,this,{onChange:u=>this.elementUpdated.emit(u),skipFieldInit:!0});this._elementModels.set(s,d)}const{mount:c}=this._elementModels.get(s);c(),this.elementAdded.emit({id:s})}break;case"delete":if(this._elementModels.has(s)){const{model:c,unmount:d}=this._elementModels.get(s);d(),this.elementRemoved.emit({id:s,type:c.type,model:c}),this._elementToGroup.delete(s),this._elementToConnector.delete(s),this._elementModels.delete(s)}break}})};e.forEach((i,r)=>{const o=S7(i.get("type"),i.get("id"),i,this,{onChange:s=>this.elementUpdated.emit(s),skipFieldInit:!0});this._elementModels.set(r,o),o.mount()}),e.observe(n),this._disposables.push(()=>{e.unobserve(n)})}_watchGroupRelationChange(){const e=(i,r)=>{this._elementToGroup.set(i,r),this._groupToElements.set(r,(this._groupToElements.get(r)||[]).concat(i))},n=(i,r)=>{if(this._elementToGroup.has(i)&&this._elementToGroup.get(i)===r&&this._elementToGroup.delete(i),this._groupToElements.has(r)){const o=this._groupToElements.get(r),s=o.indexOf(i);s!==-1&&(o.splice(s,1),o.length===0&&this._groupToElements.delete(r))}};this.elementModels.forEach(i=>{i.type==="group"&&i.childIds.forEach(r=>{e(r,i.id)})}),this.elementUpdated.on(({id:i,oldValues:r})=>{const o=this.getElementById(i);o.type==="group"&&r.childIds&&(r.childIds.forEach(s=>{n(s,i)}),o.childIds.forEach(s=>{e(s,i)}),o.childIds.length===0&&this.removeElement(i))}),this.elementAdded.on(({id:i})=>{const r=this.getElementById(i);r.type==="group"&&r.childIds.forEach(o=>{e(o,i)})}),this.elementRemoved.on(({id:i,type:r})=>{r==="group"&&[...this._groupToElements.get(i)||[]].forEach(s=>n(s,i))})}_watchConnectorRelationChange(){const e=(r,o)=>{const s=this._elementToConnector.get(r);s?s.push(o):this._elementToConnector.set(r,[o]),this._connectorToElements.set(o,(this._connectorToElements.get(o)||[]).concat(r))},n=(r,o)=>{if(this._elementToConnector.has(r)){const s=this._elementToConnector.get(r),a=s.indexOf(o);a!==-1&&(s.splice(a,1),s.length===0&&this._elementToConnector.delete(r))}if(this._connectorToElements.has(o)){const s=this._connectorToElements.get(o),a=s.indexOf(r);a!==-1&&(s.splice(a,1),s.length===0&&this._connectorToElements.delete(o))}},i=(r,o)=>{if(r.type!=="connector")return;const s=r,a=[s.source.id,s.target.id],l=o==="add"?e:n;a.forEach(c=>{c&&l(c,s.id)})};this.elementModels.forEach(r=>i(r,"add")),this.elementUpdated.on(({id:r,oldValues:o})=>{const s=this.getElementById(r);if(s.type!=="connector"||!o.source&&!o.target)return;[o.source?.id,o.target?.id].forEach(l=>{l&&n(l,s.id)}),i(s,"add")}),this.elementAdded.on(r=>i(this.getElementById(r.id),"add")),this.elementRemoved.on(({id:r,type:o})=>{o==="connector"&&[...this._connectorToElements.get(r)||[]].forEach(a=>n(a,r))})}dispose(){super.dispose(),this._disposables.forEach(e=>e()),this.elementAdded.dispose(),this.elementRemoved.dispose(),this.elementUpdated.dispose(),this._elementModels.forEach(({unmount:e})=>e()),this._elementModels.clear()}getConnectors(e){return(this._elementToConnector.get(e)||[]).map(n=>this.getElementById(n))}getGroup(e){return this._elementToGroup.has(e)?this.getElementById(this._elementToGroup.get(e)):null}getGroups(e){const n=[];let i=this.getGroup(e);for(;i;)n.push(i),i=this.getGroup(i.id);return n}getElementsByType(e){return this.elementModels.filter(n=>n.type===e)}getElementById(e){return this._elementModels.get(e)?.model??null}addElement(e){if(this.page.readonly)throw new Error("Cannot add element in readonly mode");const n=OT();e.id=n;const i=iO(e,this,{onChange:r=>this.elementUpdated.emit(r)});return this._elementModels.set(n,i),this.page.transact(()=>{this.elements.getValue().set(n,i.model.yMap)}),n}removeElement(e){if(this.page.readonly)throw new Error("Cannot remove element in readonly mode");this.page.transact(()=>{this.elements.getValue().delete(e)})}updateElement(e,n){if(this.page.readonly)throw new Error("Cannot update element in readonly mode");const i=this.getElementById(e);if(!i)throw new Error(`Element ${e} is not found`);this.page.transact(()=>{n=Ik(i.type,n),Object.entries(n).forEach(([r,o])=>{i[r]=o})})}}function NY(t=0,e=X`default`){return X`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cg transform='rotate(${t} 16 16)'%3E%3Cpath fill='white' d='M13.7,18.5h3.9l0-1.5c0-1.4-1.2-2.6-2.6-2.6h-1.5v3.9l-5.8-5.8l5.8-5.8v3.9h2.3c3.1,0,5.6,2.5,5.6,5.6v2.3h3.9l-5.8,5.8L13.7,18.5z'/%3E%3Cpath d='M20.4,19.4v-3.2c0-2.6-2.1-4.7-4.7-4.7h-3.2l0,0V9L9,12.6l3.6,3.6v-2.6l0,0H15c1.9,0,3.5,1.6,3.5,3.5v2.4l0,0h-2.6l3.6,3.6l3.6-3.6L20.4,19.4L20.4,19.4z'/%3E%3C/g%3E%3C/svg%3E") 16 16, ${e}`}function HY(t,e){const n=i=>{i.composedPath().includes(t)||e()};return document.addEventListener("click",n),{dispose:()=>{document.removeEventListener("click",n)}}}const b6="data-show";function Nt(t,e,n=()=>{},i,r){function o(){ii(t,e,{placement:"top",middleware:[Dt({mainAxis:i??14,crossAxis:r??0}),Dn({fallbackPlacements:["bottom"]})]}).then(({x:d,y:u})=>{Object.assign(e.style,{position:"absolute",zIndex:1,left:`${d}px`,top:`${u}px`})}).catch(console.error)}const s=()=>{e.setAttribute(b6,""),o(),n({display:"show"})},a=()=>{e&&(e.removeAttribute(b6),o(),n({display:"hidden"}))},l=()=>{e.hasAttribute(b6)?a():s()},c=HY(t,()=>a());return{show:s,hide:a,toggle:l,dispose:()=>{c.dispose()}}}function yr(t,e){const n=X`
    .tooltip-with-shortcut {
      display: flex;
      flex-wrap: nowrap;
      align-items: center;
      gap: 10px;
    }
    .tooltip__shortcut {
      font-size: 12px;
      position: relative;

      display: flex;
      align-items: center;
      justify-content: center;
      height: 16px;
      min-width: 16px;
    }
    .tooltip__shortcut::before {
      content: '';
      border-radius: 4px;
      position: absolute;
      inset: 0;
      background: currentColor;
      opacity: 0.2;
    }
  `;return b`<style>
      ${n}
    </style>
    <div class="tooltip-with-shortcut">
      <span class="tooltip__label">${t}</span>
      <span class="tooltip__shortcut">${e}</span>
    </div>`}function FY(t){return new Promise(e=>{const n=new FileReader,i={width:0,height:0};n.addEventListener("load",r=>{const o=new Image;o.onload=()=>{i.width=o.width,i.height=o.height,e(i)},o.onerror=()=>e(i),o.src=n.result}),n.addEventListener("error",()=>e(i)),n.readAsDataURL(t)})}const Vx=["ew","nwse","ns","nesw"];function UY(t){const e=Math.round(t/(Math.PI/4));return Vx[e%Vx.length]}function VY(t,e,n=0){const i=t.closest(".affine-edgeless-selected-rect")?.getBoundingClientRect();D(i);const{left:r,top:o,right:s,bottom:a}=i,l=te.med([r,o],[s,a]);return e0((te.angle(l,e)+n)*180/Math.PI)}function zY(t,e,n,i){const r=t.parentElement;D(r);const o=r.getAttribute("aria-label");D(o);const{left:s,top:a,right:l,bottom:c,width:d,height:u}=n,h=Math.min(d,u),p=h/d,g=h/u,f=te.med([s,a],[l,c]),v=[0,0];switch(o){case"top-left":{v[0]=s,v[1]=a;break}case"top-right":{v[0]=l,v[1]=a;break}case"bottom-right":{v[0]=l,v[1]=c;break}case"bottom-left":{v[0]=s,v[1]=c;break}}const m=new DOMMatrix().translateSelf(f[0],f[1]).rotateSelf(i).translateSelf(-f[0],-f[1]).transformPoint(new DOMPoint(...v)),y=new DOMMatrix().translateSelf(m.x,m.y).rotateSelf(i).translateSelf(-m.x,-m.y).scaleSelf(p,g,1,m.x,m.y,0).translateSelf(m.x,m.y).rotateSelf(-i).translateSelf(-m.x,-m.y),x=new DOMPoint(...f).matrixTransform(y);return e0(te.angle([x.x,x.y],e)*180/Math.PI)}function jY(t,e){let n=0;const i=t.parentElement;D(i);const r=i.getAttribute("aria-label");switch(D(r),r){case"top":{n=270;break}case"bottom":{n=90;break}case"left":{n=180;break}case"right":{n=0;break}}return n+e}function GY(t){const e=t.parentElement;D(e);const n=e.getAttribute("aria-label");return D(n),n}function ZY(t){t.requestFullscreen?t.requestFullscreen().catch(console.error):"mozRequestFullScreen"in t&&t.mozRequestFullScreen instanceof Function?t.mozRequestFullScreen():"webkitRequestFullscreen"in t&&t.webkitRequestFullscreen instanceof Function?t.webkitRequestFullscreen():"msRequestFullscreen"in t&&t.msRequestFullscreen instanceof Function&&t.msRequestFullscreen()}var WY=Object.defineProperty,qY=Object.getOwnPropertyDescriptor,ro=(t,e,n,i)=>{for(var r=i>1?void 0:i?qY(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&WY(e,n,r),r};let Hi=class extends Ae{constructor(){super(),this.disabled=!1,this.coming=!1,this.tipPosition="top",this.arrow=!0,this.tooltipOffset=8,this.active=!1,this.activeMode="color",this.iconContainerPadding=6,this.hover=!0,this.addEventListener("click",t=>{this.disabled&&(t.stopPropagation(),t.preventDefault())},{capture:!0})}render(){const t=this.coming?"(Coming soon)":this.tooltip,e=`icon-container active-mode-${this.activeMode}`,n=we({"--icon-container-padding":`${this.iconContainerPadding}px`});return b`
      <style>
        .icon-container:hover {
          background: ${this.hover?"var(--affine-hover-color)":"inherit"};
        }
      </style>
      <div
        class=${e}
        style=${n}
        role="button"
        ?disabled=${this.disabled}
        ?active=${this.active}
      >
        <slot></slot>
        ${t?b`<affine-tooltip
              tip-position=${this.tipPosition}
              .arrow=${this.arrow}
              .offset=${this.tooltipOffset}
              >${t}</affine-tooltip
            >`:ae}
      </div>
    `}};Hi.styles=X`
    .icon-container {
      position: relative;
      display: flex;
      align-items: center;
      padding: var(--icon-container-padding);
      color: var(--affine-icon-color);
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
    }

    .icon-container.active-mode-color[active] {
      color: var(--affine-primary-color);
    }

    .icon-container.active-mode-background[active] {
      background: var(--affine-hover-color);
    }

    .icon-container > svg {
      flex-shrink: 0;
    }

    .icon-container[disabled] {
      pointer-events: none;
      cursor: not-allowed;
      color: var(--affine-text-disable-color);
    }

    .icon-container[coming] {
      cursor: not-allowed;
      color: var(--affine-text-disable-color);
    }
  `;ro([L({attribute:!1})],Hi.prototype,"disabled",2);ro([L({attribute:!1})],Hi.prototype,"coming",2);ro([L({attribute:!1})],Hi.prototype,"tooltip",2);ro([L({attribute:!1})],Hi.prototype,"tipPosition",2);ro([L({attribute:!1})],Hi.prototype,"arrow",2);ro([L({attribute:!1})],Hi.prototype,"tooltipOffset",2);ro([L({attribute:!1})],Hi.prototype,"active",2);ro([L({attribute:!1})],Hi.prototype,"activeMode",2);ro([L({attribute:!1})],Hi.prototype,"iconContainerPadding",2);ro([L({attribute:!1})],Hi.prototype,"hover",2);Hi=ro([W("edgeless-tool-icon-button")],Hi);var YY=Object.defineProperty,XY=Object.getOwnPropertyDescriptor,KY=(t,e,n,i)=>{for(var r=i>1?void 0:i?XY(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&YY(e,n,r),r};let i8=class extends Hi{render(){return b` ${super.render()} `}};i8.styles=X`
    .icon-container {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      color: var(--affine-icon-color);
      border-radius: 4px;
      cursor: pointer;
    }

    .icon-container.active-mode-color[active] {
      color: var(--affine-primary-color);
    }

    .icon-container.active-mode-background[active] {
      background: var(--affine-hover-color);
    }

    .icon-container[disabled] {
      pointer-events: none;
      cursor: not-allowed;
    }

    .icon-container[coming] {
      cursor: not-allowed;
      color: var(--affine-text-disable-color);
    }
  `;i8=KY([W("edgeless-toolbar-button")],i8);const NT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.75 9.5C3.75 6.32436 6.32436 3.75 9.5 3.75C12.6756 3.75 15.25 6.32436 15.25 9.5C15.25 12.6756 12.6756 15.25 9.5 15.25C6.32436 15.25 3.75 12.6756 3.75 9.5ZM9.5 2.25C5.49594 2.25 2.25 5.49594 2.25 9.5C2.25 13.5041 5.49594 16.75 9.5 16.75C11.2319 16.75 12.8219 16.1427 14.0689 15.1295L19.4697 20.5303C19.7626 20.8232 20.2374 20.8232 20.5303 20.5303C20.8232 20.2374 20.8232 19.7626 20.5303 19.4697L15.1295 14.0689C16.1427 12.8219 16.75 11.2319 16.75 9.5C16.75 5.49594 13.5041 2.25 9.5 2.25Z"
    fill="currentColor"
  />
</svg> `,I9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V14C3.25 15.5188 4.48122 16.75 6 16.75H7.25V18C7.25 19.5188 8.48122 20.75 10 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V10C20.75 8.48122 19.5188 7.25 18 7.25H16.75V6C16.75 4.48122 15.5188 3.25 14 3.25H6ZM10 7.25H15.25V6C15.25 5.30964 14.6904 4.75 14 4.75H6C5.30964 4.75 4.75 5.30964 4.75 6V14C4.75 14.6904 5.30964 15.25 6 15.25H8C8.41421 15.25 8.75 15.5858 8.75 16V18C8.75 18.6904 9.30964 19.25 10 19.25H18C18.6904 19.25 19.25 18.6904 19.25 18V10C19.25 9.30964 18.6904 8.75 18 8.75H16H10C9.46561 8.75 9.00774 9.08568 8.82933 9.56024C8.68357 9.94796 8.2511 10.1441 7.86338 9.99835C7.47566 9.85259 7.27951 9.42012 7.42527 9.0324C7.81633 7.99216 8.82056 7.25 10 7.25ZM12.8871 10.489C12.6049 10.1858 12.1303 10.1688 11.8271 10.451C11.524 10.7333 11.507 11.2078 11.7892 11.511L12.4771 12.25H7.79999C7.38577 12.25 7.04999 12.5858 7.04999 13C7.04999 13.4142 7.38577 13.75 7.79999 13.75H12.4771L11.7892 14.489C11.507 14.7922 11.524 15.2667 11.8271 15.549C12.1303 15.8312 12.6049 15.8142 12.8871 15.511L14.7489 13.511C15.017 13.2231 15.017 12.7769 14.7489 12.489L12.8871 10.489Z"
    fill="currentColor"
  />
</svg> `,HT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M14 3.75C13.0335 3.75 12.25 4.5335 12.25 5.5V18.5C12.25 19.4665 13.0335 20.25 14 20.25H18C18.9665 20.25 19.75 19.4665 19.75 18.5V5.5C19.75 4.5335 18.9665 3.75 18 3.75H14ZM13.75 5.5C13.75 5.36193 13.8619 5.25 14 5.25H18C18.1381 5.25 18.25 5.36193 18.25 5.5V18.5C18.25 18.6381 18.1381 18.75 18 18.75H14C13.8619 18.75 13.75 18.6381 13.75 18.5V5.5ZM8.25 9.5C8.25 9.08579 7.91421 8.75 7.5 8.75C7.08579 8.75 6.75 9.08579 6.75 9.5V11.25H5C4.58579 11.25 4.25 11.5858 4.25 12C4.25 12.4142 4.58579 12.75 5 12.75H6.75V14.5C6.75 14.9142 7.08579 15.25 7.5 15.25C7.91421 15.25 8.25 14.9142 8.25 14.5V12.75H10C10.4142 12.75 10.75 12.4142 10.75 12C10.75 11.5858 10.4142 11.25 10 11.25H8.25V9.5Z"
    fill="currentColor"
  />
</svg> `,FT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6 3.75C5.0335 3.75 4.25 4.5335 4.25 5.5V18.5C4.25 19.4665 5.0335 20.25 6 20.25H10C10.9665 20.25 11.75 19.4665 11.75 18.5V5.5C11.75 4.5335 10.9665 3.75 10 3.75H6ZM5.75 5.5C5.75 5.36193 5.86193 5.25 6 5.25H10C10.1381 5.25 10.25 5.36193 10.25 5.5V18.5C10.25 18.6381 10.1381 18.75 10 18.75H6C5.86193 18.75 5.75 18.6381 5.75 18.5V5.5ZM17.25 9.5C17.25 9.08579 16.9142 8.75 16.5 8.75C16.0858 8.75 15.75 9.08579 15.75 9.5V11.25H14C13.5858 11.25 13.25 11.5858 13.25 12C13.25 12.4142 13.5858 12.75 14 12.75H15.75V14.5C15.75 14.9142 16.0858 15.25 16.5 15.25C16.9142 15.25 17.25 14.9142 17.25 14.5V12.75H19C19.4142 12.75 19.75 12.4142 19.75 12C19.75 11.5858 19.4142 11.25 19 11.25H17.25V9.5Z"
    fill="currentColor"
  />
</svg> `,L9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M4 4V20M8 12H20M8 12L12 8M8 12L12 16"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
    stroke-linejoin="round"
  />
</svg>`,M9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M20 4V20M4 12H16M16 12L12 8M16 12L12 16"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
    stroke-linejoin="round"
  />
</svg>`,QY=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M4 5L6.42929 7.42929C6.46834 7.46834 6.53166 7.46834 6.57071 7.42929L9 5"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M4 11L6.42929 13.4293C6.46834 13.4683 6.53166 13.4683 6.57071 13.4293L9 11"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M4 17L6.42929 19.4293C6.46834 19.4683 6.53166 19.4683 6.57071 19.4293L9 17"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M12 6L20 6"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M12 12L20 12"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M12 18L20 18"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
</svg>`,JY=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M18.5 4L12.5 20"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M12 4L6 20"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M20 8.5H5.5"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
  <path
    d="M19 15L4 15"
    stroke="currentColor"
    stroke-width="1.5"
    stroke-linecap="round"
  />
</svg>`,eX=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill="currentColor"
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M12 3.75C7.44365 3.75 3.75 7.44365 3.75 12C3.75 16.5563 7.44365 20.25 12 20.25C16.5563 20.25 20.25 16.5563 20.25 12C20.25 7.44365 16.5563 3.75 12 3.75ZM2.25 12C2.25 6.61522 6.61522 2.25 12 2.25C17.3848 2.25 21.75 6.61522 21.75 12C21.75 17.3848 17.3848 21.75 12 21.75C6.61522 21.75 2.25 17.3848 2.25 12Z"
  />
  <path
    fill="currentColor"
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M7.46967 10.4697C7.76256 10.1768 8.23744 10.1768 8.53033 10.4697L12 13.9393L15.4697 10.4697C15.7626 10.1768 16.2374 10.1768 16.5303 10.4697C16.8232 10.7626 16.8232 11.2374 16.5303 11.5303L12.601 15.4596C12.2691 15.7916 11.7309 15.7916 11.399 15.4596L7.46967 11.5303C7.17678 11.2374 7.17678 10.7626 7.46967 10.4697Z"
  />
</svg>`,tX=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill="currentColor"
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M15 4.25C15.4142 4.25 15.75 4.58579 15.75 5V6.25H18C20.0711 6.25 21.75 7.92893 21.75 10V14C21.75 16.0711 20.0711 17.75 18 17.75H15.75V19C15.75 19.4142 15.4142 19.75 15 19.75C14.5858 19.75 14.25 19.4142 14.25 19V17.75H6C3.92893 17.75 2.25 16.0711 2.25 14V10C2.25 7.92893 3.92893 6.25 6 6.25H14.25V5C14.25 4.58579 14.5858 4.25 15 4.25ZM14.25 7.75H6C4.75736 7.75 3.75 8.75736 3.75 10V14C3.75 15.2426 4.75736 16.25 6 16.25H14.25V7.75ZM15.75 16.25H18C19.2426 16.25 20.25 15.2426 20.25 14V10C20.25 8.75736 19.2426 7.75 18 7.75H15.75V16.25ZM6 9.25C6.41421 9.25 6.75 9.58579 6.75 10V14C6.75 14.4142 6.41421 14.75 6 14.75C5.58579 14.75 5.25 14.4142 5.25 14L5.25 10C5.25 9.58579 5.58579 9.25 6 9.25ZM9 9.25C9.41421 9.25 9.75 9.58579 9.75 10L9.75 14C9.75 14.4142 9.41421 14.75 9 14.75C8.58579 14.75 8.25 14.4142 8.25 14L8.25 10C8.25 9.58579 8.58579 9.25 9 9.25ZM12 9.25C12.4142 9.25 12.75 9.58579 12.75 10V14C12.75 14.4142 12.4142 14.75 12 14.75C11.5858 14.75 11.25 14.4142 11.25 14V10C11.25 9.58579 11.5858 9.25 12 9.25Z"
  />
</svg>`,l3=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
  fill="none"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.22872 4.22878C4.42398 4.03352 4.74057 4.03352 4.93583 4.22878L7.99996 7.29291L11.0641 4.22878C11.2593 4.03352 11.5759 4.03352 11.7712 4.22878C11.9665 4.42405 11.9665 4.74063 11.7712 4.93589L8.70707 8.00002L11.7712 11.0641C11.9665 11.2594 11.9665 11.576 11.7712 11.7713C11.5759 11.9665 11.2593 11.9665 11.0641 11.7713L7.99996 8.70713L4.93583 11.7713C4.74057 11.9665 4.42398 11.9665 4.22872 11.7713C4.03346 11.576 4.03346 11.2594 4.22872 11.0641L7.29285 8.00002L4.22872 4.93589C4.03346 4.74063 4.03346 4.42405 4.22872 4.22878Z"
  />
</svg>`,nX=`
  width: 12px;
  height: 12px;
  fill: var(--affine-text-primary-color);
`,iX=b`<svg
  viewBox="0 0 16 16"
  style=${nX}
>
  <path
    d="M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"
  ></path>
</svg>`,rX=b`<svg
  width="10"
  height="14"
  viewBox="0 0 10 14"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <rect width="10" height="14" rx="2" />
  <rect width="10" height="14" rx="2" fill-opacity="0.08" />
  <g clip-path="url(#clip0_179_9218)">
    <circle cx="3" cy="3" r="1" fill="var(--affine-icon-color)" />
    <circle cx="3" cy="6.79163" r="1" fill="var(--affine-icon-color)" />
    <circle cx="3" cy="10.5833" r="1" fill="var(--affine-icon-color)" />
    <circle cx="7" cy="3" r="1" fill="var(--affine-icon-color)" />
    <circle cx="7" cy="6.79163" r="1" fill="var(--affine-icon-color)" />
    <circle cx="7" cy="10.5833" r="1" fill="var(--affine-icon-color)" />
  </g>
  <defs>
    <clipPath id="clip0_179_9218">
      <rect width="6" height="10" transform="translate(2 2)" />
    </clipPath>
  </defs>
</svg>`,oX=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M11.4697 3.46967C11.7626 3.17678 12.2374 3.17678 12.5303 3.46967L17.5303 8.46967C17.8232 8.76256 17.8232 9.23744 17.5303 9.53033C17.2374 9.82322 16.7626 9.82322 16.4697 9.53033L12 5.06066L7.53033 9.53033C7.23744 9.82322 6.76256 9.82322 6.46967 9.53033C6.17678 9.23744 6.17678 8.76256 6.46967 8.46967L11.4697 3.46967ZM6.46967 14.4697C6.76256 14.1768 7.23744 14.1768 7.53033 14.4697L12 18.9393L16.4697 14.4697C16.7626 14.1768 17.2374 14.1768 17.5303 14.4697C17.8232 14.7626 17.8232 15.2374 17.5303 15.5303L12.5303 20.5303C12.2374 20.8232 11.7626 20.8232 11.4697 20.5303L6.46967 15.5303C6.17678 15.2374 6.17678 14.7626 6.46967 14.4697Z"
    />
  </svg>
`,sX=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M6.34314 6.34321C6.63604 6.05031 7.11091 6.05031 7.4038 6.34321L12 10.9394L16.5962 6.34321C16.8891 6.05031 17.364 6.05031 17.6569 6.34321C17.9497 6.6361 17.9497 7.11097 17.6569 7.40387L13.0607 12.0001L17.6569 16.5963C17.9497 16.8891 17.9497 17.364 17.6569 17.6569C17.364 17.9498 16.8891 17.9498 16.5962 17.6569L12 13.0607L7.4038 17.6569C7.11091 17.9498 6.63604 17.9498 6.34314 17.6569C6.05025 17.364 6.05025 16.8891 6.34314 16.5963L10.9393 12.0001L6.34314 7.40387C6.05025 7.11097 6.05025 6.6361 6.34314 6.34321Z"
    />
  </svg>
`,aX=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8 2.75C8.41421 2.75 8.75 3.08579 8.75 3.5V4.25H15.25V3.5C15.25 3.08579 15.5858 2.75 16 2.75C16.4142 2.75 16.75 3.08579 16.75 3.5V4.25H19C20.5188 4.25 21.75 5.48122 21.75 7V9.5V19C21.75 20.5188 20.5188 21.75 19 21.75H5C3.48122 21.75 2.25 20.5188 2.25 19V9.5V7C2.25 5.48122 3.48122 4.25 5 4.25H7.25V3.5C7.25 3.08579 7.58579 2.75 8 2.75ZM15.25 5.75V6.5C15.25 6.91421 15.5858 7.25 16 7.25C16.4142 7.25 16.75 6.91421 16.75 6.5V5.75H19C19.6904 5.75 20.25 6.30964 20.25 7V8.75H3.75V7C3.75 6.30964 4.30964 5.75 5 5.75H7.25V6.5C7.25 6.91421 7.58579 7.25 8 7.25C8.41421 7.25 8.75 6.91421 8.75 6.5V5.75H15.25ZM3.75 10.25H20.25V19C20.25 19.6904 19.6904 20.25 19 20.25H5C4.30964 20.25 3.75 19.6904 3.75 19V10.25Z"
    fill="currentColor"
  />
</svg> `,P9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.19232 4.25C7.7781 4.25 7.44232 4.58579 7.44232 5C7.44232 5.41421 7.7781 5.75 8.19232 5.75H16.7308C17.4211 5.75 17.9808 6.30965 17.9808 7V14.7278L16.3765 13.1235C16.0836 12.8306 15.6087 12.8306 15.3158 13.1235C15.0229 13.4164 15.0229 13.8913 15.3158 14.1842L18.2005 17.0688C18.3411 17.2094 18.5319 17.2885 18.7308 17.2885C18.9297 17.2885 19.1205 17.2094 19.2611 17.0688L22.1457 14.1842C22.4386 13.8913 22.4386 13.4164 22.1457 13.1235C21.8528 12.8306 21.378 12.8306 21.0851 13.1235L19.4808 14.7278V7C19.4808 5.48122 18.2496 4.25 16.7308 4.25H8.19232ZM15.4231 19.75C15.8373 19.75 16.1731 19.4142 16.1731 19C16.1731 18.5858 15.8373 18.25 15.4231 18.25H6.88462C6.19426 18.25 5.63461 17.6904 5.63461 17V9.2722L7.2389 10.8765C7.53179 11.1694 8.00667 11.1694 8.29956 10.8765C8.59245 10.5836 8.59245 10.1087 8.29956 9.81582L5.41494 6.93121C5.27429 6.79056 5.08353 6.71154 4.88461 6.71154C4.6857 6.71154 4.49494 6.79056 4.35429 6.93121L1.46967 9.81582C1.17678 10.1087 1.17678 10.5836 1.46967 10.8765C1.76256 11.1694 2.23744 11.1694 2.53033 10.8765L4.13461 9.2722V17C4.13461 18.5188 5.36583 19.75 6.88462 19.75H15.4231Z"
    fill="currentColor"
  />
</svg> `,c3=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.75 12C3.75 7.44365 7.44365 3.75 12 3.75C16.5563 3.75 20.25 7.44365 20.25 12C20.25 16.5563 16.5563 20.25 12 20.25C7.44365 20.25 3.75 16.5563 3.75 12ZM12 2.25C6.61522 2.25 2.25 6.61522 2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25ZM8 8.75C7.58579 8.75 7.25 9.08579 7.25 9.5C7.25 9.91421 7.58579 10.25 8 10.25H16C16.4142 10.25 16.75 9.91421 16.75 9.5C16.75 9.08579 16.4142 8.75 16 8.75H8ZM8.25 12.5C8.25 12.0858 8.58579 11.75 9 11.75H15C15.4142 11.75 15.75 12.0858 15.75 12.5C15.75 12.9142 15.4142 13.25 15 13.25H9C8.58579 13.25 8.25 12.9142 8.25 12.5ZM11 14.75C10.5858 14.75 10.25 15.0858 10.25 15.5C10.25 15.9142 10.5858 16.25 11 16.25H13C13.4142 16.25 13.75 15.9142 13.75 15.5C13.75 15.0858 13.4142 14.75 13 14.75H11Z"
    fill="currentColor"
  />
</svg> `,A9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.75 6C2.75 4.48122 3.98122 3.25 5.5 3.25H9H15H18.5C20.0188 3.25 21.25 4.48122 21.25 6V18C21.25 19.5188 20.0188 20.75 18.5 20.75H5.5C3.98122 20.75 2.75 19.5188 2.75 18V6ZM14.25 4.75H9.75V19.25H14.25V4.75ZM15.75 19.25V4.75H18.5C19.1904 4.75 19.75 5.30964 19.75 6V18C19.75 18.6904 19.1904 19.25 18.5 19.25H15.75ZM5.5 4.75H8.25V19.25H5.5C4.80964 19.25 4.25 18.6904 4.25 18V6C4.25 5.30964 4.80964 4.75 5.5 4.75Z"
    fill="currentColor"
  />
</svg> `,UT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M20.75 6C20.75 6.41421 20.4142 6.75 20 6.75L10.6465 6.75C10.32 7.90425 9.25878 8.75 8 8.75C6.74122 8.75 5.67998 7.90425 5.35352 6.75L4 6.75C3.58579 6.75 3.25 6.41421 3.25 6C3.25 5.58579 3.58579 5.25 4 5.25L5.35352 5.25C5.67998 4.09575 6.74122 3.25 8 3.25C9.25878 3.25 10.32 4.09575 10.6465 5.25L20 5.25C20.4142 5.25 20.75 5.58579 20.75 6ZM20.75 12C20.75 12.4142 20.4142 12.75 20 12.75L18.6465 12.75C18.32 13.9043 17.2588 14.75 16 14.75C14.7412 14.75 13.68 13.9043 13.3535 12.75L4 12.75C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25L13.3535 11.25C13.68 10.0957 14.7412 9.25 16 9.25C17.2588 9.25 18.32 10.0957 18.6465 11.25L20 11.25C20.4142 11.25 20.75 11.5858 20.75 12ZM20.75 18C20.75 18.4142 20.4142 18.75 20 18.75L10.6465 18.75C10.32 19.9043 9.25878 20.75 8 20.75C6.74122 20.75 5.67998 19.9043 5.35352 18.75L4 18.75C3.58579 18.75 3.25 18.4142 3.25 18C3.25 17.5858 3.58579 17.25 4 17.25L5.35352 17.25C5.67998 16.0957 6.74122 15.25 8 15.25C9.25878 15.25 10.32 16.0957 10.6465 17.25L20 17.25C20.4142 17.25 20.75 17.5858 20.75 18ZM17.25 12C17.25 11.3096 16.6904 10.75 16 10.75C15.3096 10.75 14.75 11.3096 14.75 12C14.75 12.6904 15.3096 13.25 16 13.25C16.6904 13.25 17.25 12.6904 17.25 12ZM9.25 6C9.25 5.30964 8.69036 4.75 8 4.75C7.30964 4.75 6.75 5.30964 6.75 6C6.75 6.69036 7.30964 7.25 8 7.25C8.69036 7.25 9.25 6.69036 9.25 6ZM9.25 18C9.25 17.3096 8.69036 16.75 8 16.75C7.30964 16.75 6.75 17.3096 6.75 18C6.75 18.6904 7.30964 19.25 8 19.25C8.69036 19.25 9.25 18.6904 9.25 18Z"
    fill="currentColor"
  />
</svg> `,$9=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M19.5303 6.46967C19.8232 6.76256 19.8232 7.23744 19.5303 7.53033L9.53033 17.5303C9.23744 17.8232 8.76256 17.8232 8.46967 17.5303L4.46967 13.5303C4.17678 13.2374 4.17678 12.7626 4.46967 12.4697C4.76256 12.1768 5.23744 12.1768 5.53033 12.4697L9 15.9393L18.4697 6.46967C18.7626 6.17678 19.2374 6.17678 19.5303 6.46967Z"
    fill="currentColor"
  />
</svg> `,VT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M4.01187 4.35093C3.84224 2.84994 5.52622 1.85358 6.76018 2.72484L19.9822 12.0605C21.3649 13.0368 20.694 15.2119 19.0017 15.2398L12.3409 15.3498C12.2524 15.3512 12.1712 15.3994 12.1275 15.4765L9.0661 20.8799C8.23029 22.3552 5.99497 21.8986 5.80456 20.2138L4.01187 4.35093ZM5.895 3.95019C5.71872 3.82572 5.47815 3.96805 5.50239 4.18248L7.29508 20.0454C7.32228 20.2861 7.64161 20.3513 7.76101 20.1405L10.8224 14.7371C11.128 14.1976 11.6963 13.8602 12.3162 13.85L18.9769 13.7401C19.2187 13.7361 19.3145 13.4253 19.117 13.2859L5.895 3.95019Z"
  />
</svg>`,lX=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V16V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V14V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 18V16.3107L9.11612 11.9445C9.60427 11.4564 10.3957 11.4564 10.8839 11.9445L13.4697 14.5303L15.4697 16.5303C15.7626 16.8232 16.2374 16.8232 16.5303 16.5303C16.8232 16.2374 16.8232 15.7626 16.5303 15.4697L15.0607 14L16.1161 12.9445C16.6043 12.4564 17.3957 12.4564 17.8839 12.9445L19.25 14.3107V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18ZM11.9445 10.8839L14 12.9393L15.0555 11.8839C16.1294 10.8099 17.8706 10.8099 18.9445 11.8839L19.25 12.1893V6C19.25 5.30964 18.6904 4.75 18 4.75H6C5.30964 4.75 4.75 5.30964 4.75 6V14.1893L8.05546 10.8839C9.1294 9.80994 10.8706 9.80994 11.9445 10.8839ZM14 9C14.5523 9 15 8.55228 15 8C15 7.44772 14.5523 7 14 7C13.4477 7 13 7.44772 13 8C13 8.55228 13.4477 9 14 9Z"
      fill="#77757D"
    />
  </svg>
`,cX=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
  >
    <circle cx="10" cy="10" r="8" fill="url(#pattern0)" fill-opacity="0.2" />
    <defs>
      <pattern
        id="pattern0"
        patternContentUnits="objectBoundingBox"
        width="1"
        height="1"
      >
        <use xlink:href="#image0_8620_86273" transform="scale(0.015625)" />
      </pattern>
      <image
        id="image0_8620_86273"
        width="64"
        height="64"
        xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAONJREFUeF7t20EOhEAIRFG4/6F7DvEnYeFzryQIv6pBd2behOu9dPvsbog+k+NLgArQAqmJcw9iAAhSgZKB3IJkkAySQTJ4CiE+gA8oBeg0mH3Ai084P89HhqwEqIA209ICsQdjAeaZIgaAYKxBDMCAYy8fXwAIgiAIcoJpJEYGI4VjB3YrbC9gL2AvkCB43cM5PgZgAAZgQFnNZAhdGykQBEEQBEEQDBmgAm2glM/z+QUYisYUGoldO7kY32IEAzCg6RgIRgjFAsw+AgRBMNYgBmCAT2TCYfoPPz/HCqQCX1eBHzHnv7C7WhBSAAAAAElFTkSuQmCC"
      />
    </defs>
  </svg>
`,B9=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M18.3032 4.49775C18.6342 4.16742 19.1714 4.16742 19.5024 4.49775C19.8326 4.82726 19.8326 5.3609 19.5024 5.69041L19.0739 6.1181L17.8768 4.92334L18.3032 4.49775ZM16.8151 5.98296L18.0122 7.17771L10.9259 14.25H9.75006V13.0341L16.8151 5.98296ZM20.562 3.43604C19.6455 2.52132 18.1601 2.52132 17.2436 3.43604L8.47025 12.1921C8.32928 12.3328 8.25006 12.5238 8.25006 12.723V15C8.25006 15.4142 8.58585 15.75 9.00006 15.75H11.2362C11.4348 15.75 11.6254 15.6712 11.766 15.5309L20.562 6.75212C21.4794 5.83658 21.4794 4.35158 20.562 3.43604ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H12C12.4142 4.75 12.75 4.41421 12.75 4C12.75 3.58579 12.4142 3.25 12 3.25H6C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V12C20.75 11.5858 20.4142 11.25 20 11.25C19.5858 11.25 19.25 11.5858 19.25 12V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6Z"
      fill="currentColor"
    />
  </svg>
`,dX=b`
  <svg
    width="64"
    height="24"
    viewBox="0 0 64 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M7.83325 19.2923C7.48807 19.2923 7.20825 19.0125 7.20825 18.6673V16.7923H5.33325C4.98807 16.7923 4.70825 16.5125 4.70825 16.1673C4.70825 15.8221 4.98807 15.5423 5.33325 15.5423H7.20825L7.20825 8.45898H5.33325C4.98807 8.45898 4.70825 8.17916 4.70825 7.83398C4.70825 7.48881 4.98807 7.20898 5.33325 7.20898H7.20825V5.33398C7.20825 4.98881 7.48807 4.70898 7.83325 4.70898C8.17843 4.70898 8.45825 4.98881 8.45825 5.33398V7.20898H15.5416V5.33398C15.5416 4.98881 15.8214 4.70898 16.1666 4.70898C16.5118 4.70898 16.7916 4.98881 16.7916 5.33398V7.20898H18.6666C19.0118 7.20898 19.2916 7.48881 19.2916 7.83398C19.2916 8.17916 19.0118 8.45898 18.6666 8.45898H16.7916L16.7916 15.5423H18.6666C19.0118 15.5423 19.2916 15.8221 19.2916 16.1673C19.2916 16.5125 19.0118 16.7923 18.6666 16.7923H16.7916V18.6673C16.7916 19.0125 16.5118 19.2923 16.1666 19.2923C15.8214 19.2923 15.5416 19.0125 15.5416 18.6673V16.7923H8.45825V18.6673C8.45825 19.0125 8.17843 19.2923 7.83325 19.2923ZM15.5416 15.5423L15.5416 8.45898H8.45825L8.45825 15.5423H15.5416Z"
      fill="currentColor"
    />
    <path
      d="M27.0568 16V7.27273H32.2898V8.21023H28.1136V11.1591H31.8977V12.0966H28.1136V16H27.0568ZM33.8931 16V9.45455H34.8647V10.4432H34.9329C35.0522 10.1193 35.2681 9.85653 35.5806 9.65483C35.8931 9.45312 36.2454 9.35227 36.6374 9.35227C36.7113 9.35227 36.8036 9.35369 36.9144 9.35653C37.0252 9.35937 37.109 9.36364 37.1658 9.36932V10.392C37.1317 10.3835 37.0536 10.3707 36.9315 10.3537C36.8121 10.3338 36.6857 10.3239 36.5522 10.3239C36.234 10.3239 35.9499 10.3906 35.6999 10.5241C35.4528 10.6548 35.2567 10.8366 35.1119 11.0696C34.9698 11.2997 34.8988 11.5625 34.8988 11.858V16H33.8931ZM40.2841 16.1534C39.8693 16.1534 39.4929 16.0753 39.1548 15.919C38.8168 15.7599 38.5483 15.5312 38.3494 15.233C38.1506 14.9318 38.0511 14.5682 38.0511 14.142C38.0511 13.767 38.125 13.4631 38.2727 13.2301C38.4205 12.9943 38.6179 12.8097 38.8651 12.6761C39.1122 12.5426 39.3849 12.4432 39.6832 12.3778C39.9844 12.3097 40.2869 12.2557 40.5909 12.2159C40.9886 12.1648 41.3111 12.1264 41.5582 12.1009C41.8082 12.0724 41.9901 12.0256 42.1037 11.9602C42.2202 11.8949 42.2784 11.7812 42.2784 11.6193V11.5852C42.2784 11.1648 42.1634 10.8381 41.9332 10.6051C41.706 10.3722 41.3608 10.2557 40.8977 10.2557C40.4176 10.2557 40.0412 10.3608 39.7685 10.571C39.4957 10.7812 39.304 11.0057 39.1932 11.2443L38.2386 10.9034C38.4091 10.5057 38.6364 10.196 38.9205 9.97443C39.2074 9.75 39.5199 9.59375 39.858 9.50568C40.1989 9.41477 40.5341 9.36932 40.8636 9.36932C41.0739 9.36932 41.3153 9.39489 41.5881 9.44602C41.8636 9.49432 42.1293 9.59517 42.3849 9.74858C42.6435 9.90199 42.858 10.1335 43.0284 10.4432C43.1989 10.7528 43.2841 11.1676 43.2841 11.6875V16H42.2784V15.1136H42.2273C42.1591 15.2557 42.0455 15.4077 41.8864 15.5696C41.7273 15.7315 41.5156 15.8693 41.2514 15.983C40.9872 16.0966 40.6648 16.1534 40.2841 16.1534ZM40.4375 15.25C40.8352 15.25 41.1705 15.1719 41.4432 15.0156C41.7188 14.8594 41.9261 14.6577 42.0653 14.4105C42.2074 14.1634 42.2784 13.9034 42.2784 13.6307V12.7102C42.2358 12.7614 42.142 12.8082 41.9972 12.8509C41.8551 12.8906 41.6903 12.9261 41.5028 12.9574C41.3182 12.9858 41.1378 13.0114 40.9616 13.0341C40.7884 13.054 40.6477 13.071 40.5398 13.0852C40.2784 13.1193 40.0341 13.1747 39.8068 13.2514C39.5824 13.3253 39.4006 13.4375 39.2614 13.5881C39.125 13.7358 39.0568 13.9375 39.0568 14.1932C39.0568 14.5426 39.1861 14.8068 39.4446 14.9858C39.706 15.1619 40.0369 15.25 40.4375 15.25ZM45.1197 16V9.45455H46.0913V10.4773H46.1765C46.3129 10.1278 46.533 9.85653 46.837 9.66335C47.141 9.46733 47.506 9.36932 47.9322 9.36932C48.364 9.36932 48.7234 9.46733 49.0103 9.66335C49.3001 9.85653 49.5259 10.1278 49.6879 10.4773H49.756C49.9237 10.1392 50.1751 9.87074 50.5103 9.67188C50.8455 9.47017 51.2475 9.36932 51.7163 9.36932C52.3015 9.36932 52.7802 9.55256 53.1523 9.91903C53.5245 10.2827 53.7106 10.8494 53.7106 11.6193V16H52.7049V11.6193C52.7049 11.1364 52.5728 10.7912 52.3086 10.5838C52.0444 10.3764 51.7333 10.2727 51.3754 10.2727C50.9151 10.2727 50.5586 10.4119 50.3058 10.6903C50.0529 10.9659 49.9265 11.3153 49.9265 11.7386V16H48.9038V11.517C48.9038 11.1449 48.783 10.8452 48.5415 10.6179C48.3001 10.3878 47.989 10.2727 47.6083 10.2727C47.3469 10.2727 47.1026 10.3423 46.8754 10.4815C46.6509 10.6207 46.4691 10.8139 46.3299 11.0611C46.1935 11.3054 46.1254 11.5881 46.1254 11.9091V16H45.1197ZM58.2937 16.1364C57.663 16.1364 57.119 15.9972 56.6616 15.7188C56.207 15.4375 55.8562 15.0455 55.609 14.5426C55.3647 14.0369 55.2425 13.4489 55.2425 12.7784C55.2425 12.108 55.3647 11.517 55.609 11.0057C55.8562 10.4915 56.1999 10.0909 56.6403 9.80398C57.0835 9.5142 57.6005 9.36932 58.1914 9.36932C58.5323 9.36932 58.869 9.42614 59.2013 9.53977C59.5337 9.65341 59.8363 9.83807 60.109 10.0938C60.3817 10.3466 60.5991 10.6818 60.761 11.0994C60.9229 11.517 61.0039 12.0312 61.0039 12.642V13.0682H55.9585V12.1989H59.9812C59.9812 11.8295 59.9073 11.5 59.7596 11.2102C59.6147 10.9205 59.4073 10.6918 59.1374 10.5241C58.8704 10.3565 58.555 10.2727 58.1914 10.2727C57.7908 10.2727 57.4442 10.3722 57.1516 10.571C56.8619 10.767 56.6388 11.0227 56.4826 11.3381C56.3263 11.6534 56.2482 11.9915 56.2482 12.3523V12.9318C56.2482 13.4261 56.3335 13.8452 56.5039 14.1889C56.6772 14.5298 56.9173 14.7898 57.2241 14.9688C57.5309 15.1449 57.8874 15.233 58.2937 15.233C58.5579 15.233 58.7965 15.196 59.0096 15.1222C59.2255 15.0455 59.4116 14.9318 59.5678 14.7812C59.7241 14.6278 59.8448 14.4375 59.93 14.2102L60.9016 14.483C60.7994 14.8125 60.6275 15.1023 60.386 15.3523C60.1445 15.5994 59.8462 15.7926 59.4911 15.9318C59.136 16.0682 58.7369 16.1364 58.2937 16.1364Z"
      fill="currentColor"
    />
  </svg>
`,D9=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="currentColor"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M4.81473 3.9585C4.3451 3.9585 3.95825 4.34534 3.95825 4.81498V6.29646C3.95825 6.64164 3.67843 6.92146 3.33325 6.92146C2.98807 6.92146 2.70825 6.64164 2.70825 6.29646V4.81498C2.70825 3.65498 3.65474 2.7085 4.81473 2.7085H6.29621C6.64139 2.7085 6.92121 2.98832 6.92121 3.3335C6.92121 3.67867 6.64139 3.9585 6.29621 3.9585H4.81473Z"
    />
    <path
      d="M13.0786 3.3335C13.0786 2.98832 13.3584 2.7085 13.7036 2.7085H15.1851C16.3451 2.7085 17.2916 3.65498 17.2916 4.81498V6.29646C17.2916 6.64164 17.0118 6.92146 16.6666 6.92146C16.3214 6.92146 16.0416 6.64164 16.0416 6.29646V4.81498C16.0416 4.34534 15.6547 3.9585 15.1851 3.9585H13.7036C13.3584 3.9585 13.0786 3.67867 13.0786 3.3335Z"
    />
    <path
      d="M3.33325 13.0789C3.67843 13.0789 3.95825 13.3587 3.95825 13.7039V15.1853C3.95825 15.655 4.3451 16.0418 4.81473 16.0418H6.29621C6.64139 16.0418 6.92121 16.3217 6.92121 16.6668C6.92121 17.012 6.64139 17.2918 6.29621 17.2918H4.81473C3.65474 17.2918 2.70825 16.3453 2.70825 15.1853V13.7039C2.70825 13.3587 2.98807 13.0789 3.33325 13.0789Z"
    />
    <path
      d="M16.6666 13.0789C17.0118 13.0789 17.2916 13.3587 17.2916 13.7039V15.1853C17.2916 16.3453 16.3451 17.2918 15.1851 17.2918H13.7036C13.3584 17.2918 13.0786 17.012 13.0786 16.6668C13.0786 16.3217 13.3584 16.0418 13.7036 16.0418H15.1851C15.6547 16.0418 16.0416 15.655 16.0416 15.1853V13.7039C16.0416 13.3587 16.3214 13.0789 16.6666 13.0789Z"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12.2909 9.37516C12.2914 9.36135 12.2916 9.34746 12.2916 9.3335V7.3335C12.2916 6.58021 11.6507 6.04183 10.9523 6.04183H7.38087C6.68252 6.04183 6.04159 6.58021 6.04159 7.3335V9.3335C6.04159 10.0868 6.68252 10.6252 7.38087 10.6252H7.70891C7.70847 10.639 7.70825 10.6529 7.70825 10.6668V12.6668C7.70825 13.4201 8.34918 13.9585 9.04754 13.9585H12.619C13.3173 13.9585 13.9583 13.4201 13.9583 12.6668V10.6668C13.9583 9.91355 13.3173 9.37516 12.619 9.37516H12.2909ZM7.29158 7.3335V9.3335L7.29199 9.33501C7.29277 9.33673 7.29545 9.34165 7.30224 9.34799C7.31611 9.36094 7.3424 9.37516 7.38087 9.37516H10.9523C10.9908 9.37516 11.0171 9.36094 11.0309 9.34799C11.0377 9.34165 11.0404 9.33673 11.0412 9.33501L11.0416 9.3335V7.3335L11.0412 7.33198C11.0404 7.33027 11.0377 7.32535 11.0309 7.319C11.0171 7.30606 10.9908 7.29183 10.9523 7.29183H7.38087C7.3424 7.29183 7.31611 7.30606 7.30224 7.319C7.29545 7.32535 7.29277 7.33027 7.29199 7.33198L7.29158 7.3335ZM9.04754 10.6252C9.00907 10.6252 8.98278 10.6394 8.96891 10.6523C8.96211 10.6587 8.95943 10.6636 8.95866 10.6653L8.95825 10.6666L8.95825 12.6668L8.95866 12.6683C8.95943 12.6701 8.96211 12.675 8.96891 12.6813C8.98278 12.6943 9.00907 12.7085 9.04754 12.7085H12.619C12.6574 12.7085 12.6837 12.6943 12.6976 12.6813C12.7044 12.675 12.7071 12.6701 12.7078 12.6683L12.7083 12.6668V10.6668L12.7078 10.6653C12.7071 10.6636 12.7044 10.6587 12.6976 10.6523C12.6837 10.6394 12.6574 10.6252 12.619 10.6252H9.04754Z"
    />
  </svg>
`,zT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.77778 4.75C5.21421 4.75 4.75 5.21421 4.75 5.77778V7.55556C4.75 7.96977 4.41421 8.30556 4 8.30556C3.58579 8.30556 3.25 7.96977 3.25 7.55556V5.77778C3.25 4.38579 4.38579 3.25 5.77778 3.25H7.55556C7.96977 3.25 8.30556 3.58579 8.30556 4C8.30556 4.41421 7.96977 4.75 7.55556 4.75H5.77778ZM15.6944 4C15.6944 3.58579 16.0302 3.25 16.4444 3.25H18.2222C19.6142 3.25 20.75 4.38579 20.75 5.77778V7.55556C20.75 7.96977 20.4142 8.30556 20 8.30556C19.5858 8.30556 19.25 7.96977 19.25 7.55556V5.77778C19.25 5.21421 18.7858 4.75 18.2222 4.75H16.4444C16.0302 4.75 15.6944 4.41421 15.6944 4ZM4 15.6944C4.41421 15.6944 4.75 16.0302 4.75 16.4444V18.2222C4.75 18.7858 5.21421 19.25 5.77778 19.25H7.55556C7.96977 19.25 8.30556 19.5858 8.30556 20C8.30556 20.4142 7.96977 20.75 7.55556 20.75H5.77778C4.38579 20.75 3.25 19.6142 3.25 18.2222V16.4444C3.25 16.0302 3.58579 15.6944 4 15.6944Z"
      fill="#77757D"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M8.75 8.8C8.75 8.79991 8.75 8.80006 8.75 8.8V11.2C8.75 11.2001 8.75 11.1999 8.75 11.2C8.74998 11.2003 8.74997 11.2007 8.75049 11.2018C8.75142 11.2039 8.75463 11.2098 8.76279 11.2174C8.77943 11.2329 8.81098 11.25 8.85714 11.25H13.1429C13.189 11.25 13.2206 11.2329 13.2372 11.2174C13.2454 11.2098 13.2486 11.2039 13.2495 11.2018C13.2501 11.2005 13.25 11.2005 13.25 11.2V8.8C13.25 8.79945 13.2501 8.79953 13.2495 8.79818C13.2486 8.79612 13.2454 8.79022 13.2372 8.78261C13.2206 8.76707 13.189 8.75 13.1429 8.75H8.85714C8.81098 8.75 8.77943 8.76707 8.76279 8.78261C8.75463 8.79022 8.75142 8.79612 8.75049 8.79818C8.74997 8.79931 8.74998 8.79967 8.75 8.8ZM7.25 8.8C7.25 7.89606 8.01912 7.25 8.85714 7.25H13.1429C13.9809 7.25 14.75 7.89606 14.75 8.8V11.2C14.75 12.1039 13.9809 12.75 13.1429 12.75H8.85714C8.01912 12.75 7.25 12.1039 7.25 11.2V8.8Z"
      fill="#77757D"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M15.75 15.8C15.75 15.7999 15.75 15.8001 15.75 15.8V18.2C15.75 18.2001 15.75 18.1999 15.75 18.2C15.75 18.2003 15.75 18.2007 15.7505 18.2018C15.7514 18.2039 15.7546 18.2098 15.7628 18.2174C15.7794 18.2329 15.811 18.25 15.8571 18.25H20.1429C20.189 18.25 20.2206 18.2329 20.2372 18.2174C20.2454 18.2098 20.2486 18.2039 20.2495 18.2018C20.25 18.2007 20.25 18.2006 20.25 18.2002C20.25 18.2002 20.25 18.2003 20.25 18.2002L20.25 15.8C20.25 15.7995 20.2501 15.7995 20.2495 15.7982C20.2486 15.7961 20.2454 15.7902 20.2372 15.7826C20.2206 15.7671 20.189 15.75 20.1429 15.75H15.8571C15.811 15.75 15.7794 15.7671 15.7628 15.7826C15.7546 15.7902 15.7514 15.7961 15.7505 15.7982C15.75 15.7993 15.75 15.7997 15.75 15.8ZM14.25 15.8C14.25 14.8961 15.0191 14.25 15.8571 14.25H20.1429C20.9809 14.25 21.75 14.8961 21.75 15.8V18.2C21.75 19.1039 20.9809 19.75 20.1429 19.75H15.8571C15.0191 19.75 14.25 19.1039 14.25 18.2V15.8Z"
      fill="#77757D"
    />
  </svg>
`,jT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.28571 4.75C4.94027 4.75 4.75 4.99937 4.75 5.2V8.8C4.75 9.00063 4.94027 9.25 5.28571 9.25H11.7143C12.0597 9.25 12.25 9.00063 12.25 8.8V5.2C12.25 4.99937 12.0597 4.75 11.7143 4.75H5.28571ZM3.25 5.2C3.25 4.07515 4.211 3.25 5.28571 3.25H11.7143C12.789 3.25 13.75 4.07515 13.75 5.2V8.8C13.75 9.92485 12.789 10.75 11.7143 10.75H5.28571C4.211 10.75 3.25 9.92485 3.25 8.8V5.2Z"
      fill="#77757D"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12.2857 14.75C11.9403 14.75 11.75 14.9994 11.75 15.2V18.8C11.75 19.0006 11.9403 19.25 12.2857 19.25H18.7143C19.0597 19.25 19.25 19.0006 19.25 18.8V15.2C19.25 14.9994 19.0597 14.75 18.7143 14.75H12.2857ZM10.25 15.2C10.25 14.0751 11.211 13.25 12.2857 13.25H18.7143C19.789 13.25 20.75 14.0751 20.75 15.2V18.8C20.75 19.9249 19.789 20.75 18.7143 20.75H12.2857C11.211 20.75 10.25 19.9249 10.25 18.8V15.2Z"
      fill="#77757D"
    />
  </svg>
`,GT=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.17432 3.95175C3.17432 3.52535 3.51998 3.17969 3.94638 3.17969H5.08608H18.7626H19.9023C20.3287 3.17969 20.6743 3.52535 20.6743 3.95175C20.6743 4.37814 20.3287 4.7238 19.9023 4.7238H19.5346V14.5771H19.9023C20.3287 14.5771 20.6743 14.9228 20.6743 15.3492C20.6743 15.7756 20.3287 16.1212 19.9023 16.1212H12.6964V17.7827L16.6382 20.0352C17.0085 20.2467 17.1371 20.7183 16.9255 21.0885C16.714 21.4588 16.2424 21.5874 15.8722 21.3758L12.6964 19.5611V21.0477C12.6964 21.4741 12.3507 21.8197 11.9243 21.8197C11.4979 21.8197 11.1523 21.4741 11.1523 21.0477V19.6262L8.09045 21.3758C7.72024 21.5874 7.24862 21.4588 7.03707 21.0885C6.82552 20.7183 6.95414 20.2467 7.32436 20.0352L11.1523 17.8478V16.1212H3.94638C3.51998 16.1212 3.17432 15.7756 3.17432 15.3492C3.17432 14.9228 3.51998 14.5771 3.94638 14.5771H4.31402V4.7238H3.94638C3.51998 4.7238 3.17432 4.37814 3.17432 3.95175ZM5.85814 4.7238H17.9905V14.5767H5.85814V4.7238ZM9.27726 9.08046C9.27726 8.65406 8.9316 8.3084 8.5052 8.3084C8.0788 8.3084 7.73314 8.65406 7.73314 9.08046V11.3599C7.73314 11.7863 8.0788 12.1319 8.5052 12.1319C8.9316 12.1319 9.27726 11.7863 9.27726 11.3599V9.08046ZM11.9243 6.59891C12.3507 6.59891 12.6964 6.94457 12.6964 7.37097V11.3599C12.6964 11.7863 12.3507 12.132 11.9243 12.132C11.4979 12.132 11.1523 11.7863 11.1523 11.3599V7.37097C11.1523 6.94457 11.4979 6.59891 11.9243 6.59891ZM16.1155 10.2205C16.1155 9.79405 15.7698 9.44839 15.3434 9.44839C14.917 9.44839 14.5714 9.79405 14.5714 10.2205V11.3602C14.5714 11.7866 14.917 12.1322 15.3434 12.1322C15.7698 12.1322 16.1155 11.7866 16.1155 11.3602V10.2205Z"
  />
</svg> `,ZT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M9.53033 7.46967C9.82322 7.76256 9.82322 8.23744 9.53033 8.53033L6.81066 11.25H19C19.4142 11.25 19.75 11.5858 19.75 12C19.75 12.4142 19.4142 12.75 19 12.75H6.81066L9.53033 15.4697C9.82322 15.7626 9.82322 16.2374 9.53033 16.5303C9.23744 16.8232 8.76256 16.8232 8.46967 16.5303L4.46967 12.5303C4.17678 12.2374 4.17678 11.7626 4.46967 11.4697L8.46967 7.46967C8.76256 7.17678 9.23744 7.17678 9.53033 7.46967Z"
    />
  </svg>
`,WT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M14.4697 7.46967C14.7626 7.17678 15.2374 7.17678 15.5303 7.46967L19.5303 11.4697C19.8232 11.7626 19.8232 12.2374 19.5303 12.5303L15.5303 16.5303C15.2374 16.8232 14.7626 16.8232 14.4697 16.5303C14.1768 16.2374 14.1768 15.7626 14.4697 15.4697L17.1893 12.75H5C4.58579 12.75 4.25 12.4142 4.25 12C4.25 11.5858 4.58579 11.25 5 11.25H17.1893L14.4697 8.53033C14.1768 8.23744 14.1768 7.76256 14.4697 7.46967Z"
    />
  </svg>
`,qT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M15.25 4C15.25 3.58579 15.5858 3.25 16 3.25H20C20.4142 3.25 20.75 3.58579 20.75 4V8C20.75 8.41421 20.4142 8.75 20 8.75C19.5858 8.75 19.25 8.41421 19.25 8V5.81066L15.0303 10.0303C14.7374 10.3232 14.2626 10.3232 13.9697 10.0303C13.6768 9.73744 13.6768 9.26256 13.9697 8.96967L18.1893 4.75H16C15.5858 4.75 15.25 4.41421 15.25 4ZM10.0303 13.9697C10.3232 14.2626 10.3232 14.7374 10.0303 15.0303L5.81066 19.25H8C8.41421 19.25 8.75 19.5858 8.75 20C8.75 20.4142 8.41421 20.75 8 20.75H4C3.58579 20.75 3.25 20.4142 3.25 20V16C3.25 15.5858 3.58579 15.25 4 15.25C4.41421 15.25 4.75 15.5858 4.75 16V18.1893L8.96967 13.9697C9.26256 13.6768 9.73744 13.6768 10.0303 13.9697Z"
    />
  </svg>
`,YT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M20.5303 3.46967C20.8232 3.76256 20.8232 4.23744 20.5303 4.53033L16.3107 8.75H18.5C18.9142 8.75 19.25 9.08579 19.25 9.5C19.25 9.91421 18.9142 10.25 18.5 10.25H14.5C14.0858 10.25 13.75 9.91421 13.75 9.5V5.5C13.75 5.08579 14.0858 4.75 14.5 4.75C14.9142 4.75 15.25 5.08579 15.25 5.5V7.68934L19.4697 3.46967C19.7626 3.17678 20.2374 3.17678 20.5303 3.46967ZM5.5 15.25C5.08579 15.25 4.75 14.9142 4.75 14.5C4.75 14.0858 5.08579 13.75 5.5 13.75H9.5C9.91421 13.75 10.25 14.0858 10.25 14.5V18.5C10.25 18.9142 9.91421 19.25 9.5 19.25C9.08579 19.25 8.75 18.9142 8.75 18.5V16.3107L4.53033 20.5303C4.23744 20.8232 3.76256 20.8232 3.46967 20.5303C3.17678 20.2374 3.17678 19.7626 3.46967 19.4697L7.68934 15.25H5.5Z"
      fill="currentColor"
    />
  </svg>
`,XT=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M2.70825 4.99967C2.70825 3.73402 3.73427 2.70801 4.99992 2.70801H7.08325C7.42843 2.70801 7.70825 2.98783 7.70825 3.33301C7.70825 3.67819 7.42843 3.95801 7.08325 3.95801H4.99992C4.42462 3.95801 3.95825 4.42438 3.95825 4.99967V7.08301C3.95825 7.42819 3.67843 7.70801 3.33325 7.70801C2.98807 7.70801 2.70825 7.42819 2.70825 7.08301V4.99967ZM12.2916 3.33301C12.2916 2.98783 12.5714 2.70801 12.9166 2.70801H14.9999C16.2656 2.70801 17.2916 3.73402 17.2916 4.99967V7.08301C17.2916 7.42819 17.0118 7.70801 16.6666 7.70801C16.3214 7.70801 16.0416 7.42819 16.0416 7.08301V4.99967C16.0416 4.42438 15.5752 3.95801 14.9999 3.95801H12.9166C12.5714 3.95801 12.2916 3.67819 12.2916 3.33301ZM3.33325 12.2913C3.67843 12.2913 3.95825 12.5712 3.95825 12.9163V14.9997C3.95825 15.575 4.42462 16.0413 4.99992 16.0413H7.49992C7.8451 16.0413 8.12492 16.3212 8.12492 16.6663C8.12492 17.0115 7.8451 17.2913 7.49992 17.2913H4.99992C3.73427 17.2913 2.70825 16.2653 2.70825 14.9997V12.9163C2.70825 12.5712 2.98807 12.2913 3.33325 12.2913ZM16.6666 12.2913C17.0118 12.2913 17.2916 12.5712 17.2916 12.9163V14.9997C17.2916 16.2653 16.2656 17.2913 14.9999 17.2913H12.4999C12.1547 17.2913 11.8749 17.0115 11.8749 16.6663C11.8749 16.3212 12.1547 16.0413 12.4999 16.0413H14.9999C15.5752 16.0413 16.0416 15.575 16.0416 14.9997V12.9163C16.0416 12.5712 16.3214 12.2913 16.6666 12.2913Z"
      fill="#77757D"
    />
  </svg>
`,KT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_2769_5668)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M9.5958 4.14037C10.2077 1.61987 13.7923 1.61988 14.4042 4.14037C14.5598 4.7814 15.2943 5.08561 15.8576 4.74238C18.0725 3.39279 20.6072 5.9275 19.2576 8.14243C18.9144 8.70575 19.2186 9.44017 19.8596 9.5958C22.3801 10.2077 22.3801 13.7923 19.8596 14.4042C19.2186 14.5598 18.9144 15.2942 19.2576 15.8576C20.6072 18.0725 18.0725 20.6072 15.8576 19.2576C15.2943 18.9144 14.5598 19.2186 14.4042 19.8596C13.7923 22.3801 10.2077 22.3801 9.5958 19.8596C9.44018 19.2186 8.70575 18.9144 8.14243 19.2576C5.9275 20.6072 3.39279 18.0725 4.74238 15.8576C5.08561 15.2942 4.7814 14.5598 4.14037 14.4042C1.61988 13.7923 1.61987 10.2077 4.14037 9.5958C4.7814 9.44017 5.08561 8.70575 4.74238 8.14243C3.39279 5.9275 5.9275 3.39279 8.14243 4.74238C8.70575 5.08561 9.44018 4.7814 9.5958 4.14037ZM12.9465 4.49425C12.7056 3.50192 11.2944 3.50192 11.0535 4.49425C10.6582 6.12246 8.79276 6.89514 7.36194 6.02332C6.48991 5.49199 5.49199 6.48991 6.02332 7.36194C6.89514 8.79276 6.12245 10.6582 4.49425 11.0535C3.50192 11.2944 3.50192 12.7056 4.49425 12.9465C6.12246 13.3418 6.89514 15.2072 6.02332 16.6381C5.49199 17.5101 6.48991 18.508 7.36194 17.9767C8.79276 17.1049 10.6582 17.8775 11.0535 19.5058C11.2944 20.4981 12.7056 20.4981 12.9465 19.5058C13.3418 17.8775 15.2072 17.1049 16.6381 17.9767C17.5101 18.508 18.508 17.5101 17.9767 16.6381C17.1049 15.2072 17.8775 13.3418 19.5058 12.9465C20.4981 12.7056 20.4981 11.2944 19.5058 11.0535C17.8775 10.6582 17.1049 8.79276 17.9767 7.36194C18.508 6.48991 17.5101 5.49199 16.6381 6.02332C15.2072 6.89514 13.3418 6.12246 12.9465 4.49425ZM12 9.75C10.7574 9.75 9.75 10.7574 9.75 12C9.75 13.2426 10.7574 14.25 12 14.25C13.2426 14.25 14.25 13.2426 14.25 12C14.25 10.7574 13.2426 9.75 12 9.75ZM8.25 12C8.25 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.25 14.0711 8.25 12Z"
        fill="#77757D"
      />
    </g>
    <defs>
      <clipPath id="clip0_2769_5668">
        <rect width="24" height="24" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,QT=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M2.70825 4.99967C2.70825 3.73402 3.73427 2.70801 4.99992 2.70801H7.08325C7.42843 2.70801 7.70825 2.98783 7.70825 3.33301C7.70825 3.67819 7.42843 3.95801 7.08325 3.95801H4.99992C4.42462 3.95801 3.95825 4.42438 3.95825 4.99967V7.08301C3.95825 7.42819 3.67843 7.70801 3.33325 7.70801C2.98807 7.70801 2.70825 7.42819 2.70825 7.08301V4.99967ZM12.2916 3.33301C12.2916 2.98783 12.5714 2.70801 12.9166 2.70801H14.9999C16.2656 2.70801 17.2916 3.73402 17.2916 4.99967V7.08301C17.2916 7.42819 17.0118 7.70801 16.6666 7.70801C16.3214 7.70801 16.0416 7.42819 16.0416 7.08301V4.99967C16.0416 4.42438 15.5752 3.95801 14.9999 3.95801H12.9166C12.5714 3.95801 12.2916 3.67819 12.2916 3.33301ZM3.33325 12.2913C3.67843 12.2913 3.95825 12.5712 3.95825 12.9163V14.9997C3.95825 15.575 4.42462 16.0413 4.99992 16.0413H7.49992C7.8451 16.0413 8.12492 16.3212 8.12492 16.6663C8.12492 17.0115 7.8451 17.2913 7.49992 17.2913H4.99992C3.73427 17.2913 2.70825 16.2653 2.70825 14.9997V12.9163C2.70825 12.5712 2.98807 12.2913 3.33325 12.2913ZM16.6666 12.2913C17.0118 12.2913 17.2916 12.5712 17.2916 12.9163V14.9997C17.2916 16.2653 16.2656 17.2913 14.9999 17.2913H12.4999C12.1547 17.2913 11.8749 17.0115 11.8749 16.6663C11.8749 16.3212 12.1547 16.0413 12.4999 16.0413H14.9999C15.5752 16.0413 16.0416 15.575 16.0416 14.9997V12.9163C16.0416 12.5712 16.3214 12.2913 16.6666 12.2913Z"
      fill="#77757D"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M6.04159 7.49967C6.04159 6.69426 6.6945 6.04134 7.49992 6.04134H12.4999C13.3053 6.04134 13.9583 6.69426 13.9583 7.49967V12.4997C13.9583 13.3051 13.3053 13.958 12.4999 13.958H7.49992C6.6945 13.958 6.04159 13.3051 6.04159 12.4997V7.49967ZM7.49992 7.29134C7.38486 7.29134 7.29158 7.38461 7.29158 7.49967V12.4997C7.29158 12.6147 7.38486 12.708 7.49992 12.708H12.4999C12.615 12.708 12.7083 12.6147 12.7083 12.4997V7.49967C12.7083 7.38461 12.615 7.29134 12.4999 7.29134H7.49992Z"
      fill="#77757D"
    />
  </svg>
`,JT=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M11.7543 3.80319C11.953 3.70722 12.1838 3.70359 12.3854 3.79325L20.3048 7.31578C20.5716 7.43446 20.7452 7.69723 20.7498 7.98922C20.7545 8.28122 20.5891 8.54933 20.3262 8.67637L12.2456 12.5802C12.0469 12.6762 11.8161 12.6798 11.6145 12.5901L3.69514 9.06761C3.42831 8.94893 3.25464 8.68616 3.25004 8.39417C3.24544 8.10217 3.41074 7.83406 3.67369 7.70703L11.7543 3.80319ZM12.0936 5.30516L5.78221 8.35425L11.9063 11.0782L18.2177 8.02914L12.0936 5.30516ZM20.6753 11.8653C20.8555 12.2383 20.6992 12.6867 20.3262 12.8669L12.2456 16.7707C12.0469 16.8667 11.8161 16.8703 11.6145 16.7807L3.69514 13.2581C3.31667 13.0898 3.14634 12.6465 3.31468 12.268C3.48302 11.8896 3.92629 11.7192 4.30475 11.8876L11.9063 15.2687L19.6737 11.5162C20.0467 11.336 20.4951 11.4923 20.6753 11.8653ZM20.6753 16.1746C20.8554 16.5476 20.6992 16.996 20.3262 17.1762L12.2456 21.08C12.0469 21.176 11.8161 21.1796 11.6145 21.09L3.69514 17.5674C3.31667 17.3991 3.14633 16.9558 3.31467 16.5773C3.48301 16.1989 3.92629 16.0285 4.30475 16.1969L11.9063 19.578L19.6737 15.8255C20.0467 15.6453 20.4951 15.8016 20.6753 16.1746Z"
    />
  </svg>
`,eI=b`
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M11.6717 7.3309C11.4683 7.51769 11.152 7.50423 10.9652 7.30084L8.50016 4.61665L8.50016 12.6663C8.50016 12.9425 8.2763 13.1663 8.00016 13.1663C7.72402 13.1663 7.50016 12.9425 7.50016 12.6663L7.50016 4.61665L5.03509 7.30084C4.84831 7.50423 4.53201 7.51769 4.32862 7.3309C4.12524 7.14412 4.11178 6.82782 4.29856 6.62444L7.6319 2.99481C7.72659 2.8917 7.86017 2.83301 8.00016 2.83301C8.14015 2.83301 8.27373 2.8917 8.36842 2.99481L11.7018 6.62443C11.8885 6.82782 11.8751 7.14412 11.6717 7.3309Z"
    />
  </svg>
`,tI=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 25"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12 17.4883C11.7239 17.4883 11.5 17.2644 11.5 16.9883V13.4883H8C7.72386 13.4883 7.5 13.2644 7.5 12.9883C7.5 12.7121 7.72386 12.4883 8 12.4883H11.5V8.98828C11.5 8.71214 11.7239 8.48828 12 8.48828C12.2761 8.48828 12.5 8.71214 12.5 8.98828V12.4883H16C16.2761 12.4883 16.5 12.7121 16.5 12.9883C16.5 13.2644 16.2761 13.4883 16 13.4883H12.5V16.9883C12.5 17.2644 12.2761 17.4883 12 17.4883Z"
    />
  </svg>
`,nI=Ht`<path
  fill-rule="evenodd"
  clip-rule="evenodd"
  fill="currentColor"
  d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V16V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V14V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 18V16.3107L9.11612 11.9445C9.60427 11.4564 10.3957 11.4564 10.8839 11.9445L13.4697 14.5303L15.4697 16.5303C15.7626 16.8232 16.2374 16.8232 16.5303 16.5303C16.8232 16.2374 16.8232 15.7626 16.5303 15.4697L15.0607 14L16.1161 12.9445C16.6043 12.4564 17.3957 12.4564 17.8839 12.9445L19.25 14.3107V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18ZM11.9445 10.8839L14 12.9393L15.0555 11.8839C16.1294 10.8099 17.8706 10.8099 18.9445 11.8839L19.25 12.1893V6C19.25 5.30964 18.6904 4.75 18 4.75H6C5.30964 4.75 4.75 5.30964 4.75 6V14.1893L8.05546 10.8839C9.1294 9.80994 10.8706 9.80994 11.9445 10.8839ZM14 9C14.5523 9 15 8.55228 15 8C15 7.44772 14.5523 7 14 7C13.4477 7 13 7.44772 13 8C13 8.55228 13.4477 9 14 9Z"
/>`,iI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  ${nI}
</svg>`,rI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  ${nI}
</svg>`,Yo=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5 3.25C3.48122 3.25 2.25 4.48122 2.25 6V13C2.25 13.4142 2.58579 13.75 3 13.75C3.41421 13.75 3.75 13.4142 3.75 13V6C3.75 5.30964 4.30964 4.75 5 4.75H19C19.6904 4.75 20.25 5.30964 20.25 6V18C20.25 18.6904 19.6904 19.25 19 19.25H12C11.5858 19.25 11.25 19.5858 11.25 20C11.25 20.4142 11.5858 20.75 12 20.75H19C20.5188 20.75 21.75 19.5188 21.75 18V6C21.75 4.48122 20.5188 3.25 19 3.25H5ZM9.11612 13.1161C9.60427 12.628 10.3957 12.628 10.8839 13.1161C11.372 13.6043 11.372 14.3957 10.8839 14.8839L8.88388 16.8839C8.39573 17.372 7.60427 17.372 7.11612 16.8839C6.82322 16.591 6.34835 16.591 6.05546 16.8839C5.76256 17.1768 5.76256 17.6517 6.05546 17.9445C7.1294 19.0185 8.8706 19.0185 9.94454 17.9445L11.9445 15.9445C13.0185 14.8706 13.0185 13.1294 11.9445 12.0555C10.8706 10.9815 9.1294 10.9815 8.05546 12.0555L7.50565 12.6053C7.21276 12.8982 7.21276 13.373 7.50565 13.6659C7.79854 13.9588 8.27342 13.9588 8.56631 13.6659L9.11612 13.1161ZM6.11612 16.1161C6.60427 15.628 7.39573 15.628 7.88388 16.1161C8.17678 16.409 8.65165 16.409 8.94454 16.1161C9.23744 15.8232 9.23744 15.3483 8.94454 15.0555C7.8706 13.9815 6.1294 13.9815 5.05546 15.0555L3.05546 17.0555C1.98151 18.1294 1.98151 19.8706 3.05546 20.9445C4.1294 22.0185 5.8706 22.0185 6.94454 20.9445L7.49532 20.3938C7.78822 20.1009 7.78822 19.626 7.49533 19.3331C7.20243 19.0402 6.72756 19.0402 6.43467 19.3331L5.88388 19.8839C5.39573 20.372 4.60427 20.372 4.11612 19.8839C3.62796 19.3957 3.62796 18.6043 4.11612 18.1161L6.11612 16.1161Z"
  />
</svg>`,oI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M19.2786 4.72105C18.6493 4.09298 17.6284 4.09298 16.9991 4.72105L16.1143 5.60408L18.3917 7.87702L19.2786 6.9919C19.9071 6.36465 19.9071 5.3483 19.2786 4.72105ZM17.33 8.93664L15.0526 6.6637L4.24997 17.4451V19.7501H6.49531L17.33 8.93664ZM15.9395 3.65934C17.1543 2.44689 19.1234 2.44689 20.3382 3.65934C21.5539 4.87262 21.5539 6.84033 20.3382 8.05361L7.33534 21.0309C7.19473 21.1712 7.00419 21.2501 6.80554 21.2501H3.49997C3.08576 21.2501 2.74997 20.9143 2.74997 20.5001V17.134C2.74997 16.9348 2.82919 16.7438 2.97016 16.6032L15.9395 3.65934Z"
  />
</svg> `,sI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill="currentColor"
    d="M14.7333 20.7491C13.2101 20.7188 11.7085 20.3814 10.318 19.757L4.87829 17.1973C4.34611 16.9441 3.93572 16.4896 3.73708 15.9334C3.53844 15.3772 3.56776 14.7647 3.81861 14.2301C4.0693 13.697 4.52083 13.2855 5.07393 13.0862C5.62702 12.8869 6.2364 12.916 6.76806 13.1673L7.78359 13.6455C7.30673 12.0247 6.35302 9.34093 4.92245 7.7732L4.03938 7.05577C3.61069 6.70638 3.33352 6.20406 3.26602 5.65417C3.19852 5.10429 3.34593 4.54956 3.67732 4.1063C4.01168 3.66165 4.50487 3.3643 5.05324 3.27676C5.60161 3.18922 6.16247 3.3183 6.61794 3.63687C7.68536 4.4013 8.62184 5.33461 9.39078 6.40032C9.65039 6.01099 10.0282 5.71593 10.4681 5.55889C10.7401 5.45759 11.0297 5.41243 11.3196 5.42613C11.6094 5.43983 11.8935 5.51209 12.1548 5.6386C12.3904 5.74876 12.6054 5.89855 12.7906 6.08146C13.0286 5.81011 13.3329 5.60559 13.6737 5.48803C13.9277 5.39526 14.1977 5.35453 14.4676 5.36822C14.7376 5.38191 15.0021 5.44975 15.2455 5.56774C15.5246 5.6943 15.7698 5.88556 15.9608 6.12575C16.0596 6.06152 16.1665 6.01088 16.2787 5.97518C16.6663 5.83573 17.0933 5.85626 17.4658 6.0323C17.8384 6.20833 18.126 6.52546 18.2656 6.91405L20.3762 12.7953C20.8746 14.2018 20.8746 15.7376 20.3762 17.1442C20.1126 17.8897 19.6865 18.5667 19.1289 19.126C18.5713 19.6853 17.8962 20.1127 17.153 20.3771C16.373 20.6365 15.555 20.7623 14.7333 20.7491ZM5.93087 14.3364C5.80289 14.3092 5.61036 14.3014 5.51411 14.3364C5.40235 14.3749 5.29944 14.4355 5.21147 14.5146C5.12349 14.5937 5.05223 14.6898 5.00192 14.797C4.95016 14.9037 4.92031 15.0197 4.91412 15.1382C4.90793 15.2567 4.92553 15.3752 4.96589 15.4867C5.00625 15.5983 5.06854 15.7005 5.14906 15.7874C5.22958 15.8744 5.32669 15.9442 5.43463 15.9927L10.839 18.6056C10.839 18.6056 14.0357 20.0936 16.6673 19.1459C17.2293 18.9564 17.7408 18.6409 18.1632 18.2235C18.5855 17.8061 18.9074 17.2976 19.1045 16.7367C19.5014 15.6227 19.5014 14.4053 19.1045 13.2913L16.9852 7.41005C16.9763 7.38088 16.9615 7.35386 16.9418 7.33069C16.922 7.30751 16.8977 7.28868 16.8703 7.27537C16.843 7.26207 16.8131 7.25458 16.7828 7.25337C16.7524 7.25216 16.7221 7.25725 16.6938 7.26833C16.6381 7.29017 16.5931 7.33292 16.5684 7.38751C16.5436 7.44209 16.5411 7.50419 16.5613 7.56062L16.8615 8.44635C16.8967 8.53035 16.9142 8.62071 16.913 8.71179C16.9118 8.80288 16.892 8.89274 16.8547 8.97581C16.8175 9.05888 16.7635 9.13337 16.6964 9.19466C16.6292 9.25595 16.5501 9.30272 16.4642 9.33207C16.3804 9.36729 16.2903 9.38486 16.1995 9.38368C16.1087 9.38251 16.0191 9.36261 15.9363 9.32523C15.8535 9.28785 15.7792 9.23378 15.7181 9.16639C15.657 9.099 15.6104 9.01973 15.5811 8.9335L14.9983 7.30377C14.9265 7.12321 14.7915 6.97517 14.6185 6.88748C14.5305 6.8502 14.4359 6.831 14.3404 6.831C14.2448 6.831 14.1502 6.8502 14.0622 6.88748C13.8857 6.94651 13.7386 7.07145 13.6514 7.23637C13.5643 7.40129 13.5438 7.59353 13.5942 7.7732L13.8414 8.70321C13.8851 8.86876 13.8624 9.04485 13.7782 9.19382C13.694 9.3428 13.5551 9.45282 13.3911 9.50036C13.2294 9.55136 13.0543 9.53738 12.9028 9.46137C12.7512 9.38535 12.635 9.25324 12.5787 9.09292L11.9958 7.48091C11.9143 7.26388 11.7512 7.08756 11.5415 6.98985C11.3318 6.89214 11.0923 6.88083 10.8743 6.95834C10.658 7.04009 10.4822 7.20369 10.3848 7.41402C10.2873 7.62435 10.276 7.86461 10.3533 8.08319L10.7772 9.27008C10.8123 9.35408 10.8298 9.44443 10.8287 9.53551C10.8275 9.6266 10.8076 9.71646 10.7704 9.79953C10.7331 9.8826 10.6792 9.95709 10.612 10.0184C10.5448 10.0797 10.4658 10.1264 10.3798 10.1558C10.2961 10.191 10.206 10.2086 10.1152 10.2074C10.0244 10.2062 9.93476 10.1863 9.85194 10.1489C9.76912 10.1116 9.69485 10.0575 9.63374 9.99012C9.57264 9.92273 9.52601 9.84345 9.49675 9.75721C8.77492 7.80197 7.47469 6.11463 5.7702 4.92117C5.60002 4.79896 5.38865 4.74903 5.18198 4.78219C4.97531 4.81536 4.79003 4.92895 4.66636 5.09831C4.5387 5.26644 4.54989 5.42432 4.5746 5.63419C4.59932 5.84407 4.70436 6.0361 4.86755 6.16977L5.75062 6.91377L5.81244 6.97577C8.22322 9.57094 9.34471 14.6373 9.38886 14.8499C9.41539 14.9719 9.40709 15.0989 9.36492 15.2164C9.32275 15.3339 9.24841 15.4371 9.15044 15.5142C9.05374 15.5891 8.93848 15.6361 8.8171 15.6501C8.69571 15.6642 8.57281 15.6447 8.46164 15.5939L6.92105 14.797C6.5371 14.5875 6.45627 14.5146 5.93087 14.3364Z"
  />
</svg> `,aI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.70825 2.70898H17.2916V17.2923H2.70825V2.70898ZM3.95825 3.95898V16.0423H16.0416V3.95898H3.95825Z"
  />
</svg> `,lI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M10 3.125C6.20304 3.125 3.125 6.20304 3.125 10C3.125 13.797 6.20304 16.875 10 16.875C13.797 16.875 16.875 13.797 16.875 10C16.875 6.20304 13.797 3.125 10 3.125ZM1.875 10C1.875 5.51269 5.51269 1.875 10 1.875C14.4873 1.875 18.125 5.51269 18.125 10C18.125 14.4873 14.4873 18.125 10 18.125C5.51269 18.125 1.875 14.4873 1.875 10Z"
  />
</svg>`,cI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M10.0001 1.61523L18.384 9.99912L10.0001 18.383L1.61621 9.99912L10.0001 1.61523ZM3.38398 9.99912L10.0001 16.6152L16.6162 9.99912L10.0001 3.383L3.38398 9.99912Z"
  />
</svg>`,dI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M10.0001 2.08398L18.2995 16.459H1.70068L10.0001 2.08398ZM10.0001 4.58398L3.86575 15.209H16.1344L10.0001 4.58398Z"
  />
</svg>`,uI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M1.875 14.1673C1.875 15.433 2.90101 16.459 4.16667 16.459H15.8333C17.099 16.459 18.125 15.433 18.125 14.1673V5.83398C18.125 4.56833 17.099 3.54232 15.8333 3.54232H4.16667C2.90101 3.54232 1.875 4.56833 1.875 5.83398V14.1673ZM4.16667 15.209C3.59137 15.209 3.125 14.7426 3.125 14.1673V5.83398C3.125 5.25869 3.59137 4.79232 4.16667 4.79232H15.8333C16.4086 4.79232 16.875 5.25869 16.875 5.83398V14.1673C16.875 14.7426 16.4086 15.209 15.8333 15.209H4.16667Z"
  />
</svg>`,hI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.45993 3.83639C2.64271 3.81446 2.80866 3.94487 2.83059 4.12765C2.92285 4.89681 3.01537 5.61006 3.10321 6.28727C3.55933 9.80379 3.88941 12.3486 3.40424 16.7043C3.38386 16.8872 3.21901 17.019 3.03605 16.9986C2.85309 16.9783 2.72129 16.8134 2.74167 16.6304C3.21749 12.3587 2.89776 9.89136 2.44329 6.38415C2.3552 5.70441 2.26206 4.98561 2.16867 4.20705C2.14674 4.02427 2.27714 3.85832 2.45993 3.83639Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M14.6788 16.6731C13.5378 16.6615 12.1261 16.6616 11.0279 16.7078C9.45128 16.7741 7.43455 16.9812 5.80651 17.1726C4.99366 17.2682 4.27987 17.3596 3.76935 17.4271C3.51411 17.4609 3.30974 17.4887 3.16929 17.508L3.00817 17.5303L2.95355 17.538L2.90588 17.2081L2.85912 16.878L2.91585 16.8701L3.07845 16.8475C3.21994 16.8281 3.42545 16.8001 3.68194 16.7662C4.19488 16.6984 4.91194 16.6066 5.72866 16.5105C7.35976 16.3187 9.39704 16.1091 10.9999 16.0417C12.1163 15.9947 13.5424 15.9948 14.6856 16.0065C15.258 16.0123 15.761 16.0211 16.1209 16.0284C16.3009 16.032 16.4451 16.0353 16.5445 16.0377L16.6586 16.0405L16.6978 16.0415L16.6895 16.3747L16.6805 16.708L16.6416 16.7069L16.5285 16.7042C16.4299 16.7018 16.2865 16.6985 16.1074 16.6949C15.7492 16.6876 15.2485 16.6789 14.6788 16.6731ZM17.0228 16.3837C17.0178 16.5677 16.8646 16.7129 16.6805 16.708L16.6895 16.3747L16.6978 16.0415C16.8819 16.0465 17.0277 16.1997 17.0228 16.3837ZM2.57586 17.2549C2.54999 17.0727 2.67685 16.9039 2.85912 16.878L2.90588 17.2081L2.95355 17.538C2.77128 17.5639 2.60173 17.4372 2.57586 17.2549Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M16.2785 3.00004C16.4626 2.99705 16.6142 3.14384 16.6172 3.32791L16.2839 3.33333L15.9506 3.33875C15.9476 3.15468 16.0944 3.00304 16.2785 3.00004ZM15.8785 17.5L15.5461 17.4759L15.5604 17.2746C15.5695 17.1442 15.5827 16.9546 15.5988 16.7179C15.631 16.2445 15.6746 15.5827 15.7206 14.8294C15.8126 13.3217 15.9136 11.4516 15.9507 9.99154C15.9836 8.69575 15.9836 7.03343 15.9754 5.69274C15.9712 5.02289 15.9651 4.43425 15.9599 4.01309C15.9573 3.80252 15.955 3.63385 15.9533 3.51786L15.9506 3.33875L16.2839 3.33333L16.6172 3.32791L16.6199 3.50823C16.6216 3.62466 16.6239 3.79382 16.6265 4.00493C16.6317 4.42711 16.6379 5.01714 16.642 5.68864C16.6503 7.03063 16.6503 8.70165 16.6171 10.0085C16.5797 11.4809 16.4781 13.3608 16.386 14.87C16.3399 15.6251 16.2962 16.2885 16.2639 16.7631C16.2478 17.0004 16.2346 17.1905 16.2254 17.3214L16.211 17.5232L15.8785 17.5ZM15.8785 17.5L15.5461 17.4759C15.5327 17.6595 15.6708 17.8192 15.8544 17.8325C16.038 17.8458 16.1977 17.7077 16.211 17.5241L15.8785 17.5Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.8222 4.25378L17.8204 4.26045L17.8149 4.2812L17.7936 4.36248C17.7751 4.43352 17.7485 4.53713 17.7161 4.66674C17.6512 4.92604 17.5634 5.28896 17.4713 5.70299C17.2862 6.53525 17.0878 7.55848 17.0216 8.36138C16.9302 9.47192 16.9847 10.3393 17.0561 11.223C17.0633 11.3116 17.0706 11.4004 17.078 11.4898C17.1443 12.2918 17.2137 13.1322 17.1847 14.1766C17.1687 14.7528 17.1279 15.4868 17.0913 16.0741C17.073 16.3683 17.0556 16.6267 17.0429 16.8116C17.0365 16.9041 17.0312 16.9782 17.0276 17.0292L17.0219 17.1081L16.6894 17.084L16.357 17.0596L16.3626 16.9817C16.3662 16.9312 16.3714 16.8576 16.3778 16.7657C16.3905 16.5819 16.4077 16.325 16.4259 16.0326C16.4624 15.4467 16.5027 14.7223 16.5183 14.1581C16.5462 13.1522 16.4798 12.3467 16.4135 11.5437C16.4062 11.4547 16.3988 11.3658 16.3916 11.2767C16.3193 10.3821 16.2613 9.47185 16.3572 8.30666C16.4273 7.45607 16.6342 6.39597 16.8205 5.55827C16.9141 5.13732 17.0034 4.7686 17.0693 4.50502C17.1023 4.37318 17.1294 4.26753 17.1484 4.19467L17.1704 4.11077L17.1762 4.08879L17.1781 4.08154C17.2259 3.90374 17.4089 3.79769 17.5867 3.84542C17.7645 3.89315 17.8699 4.07598 17.8222 4.25378ZM16.6894 17.084L16.357 17.0596C16.3435 17.2432 16.4814 17.403 16.665 17.4165C16.8486 17.4299 17.0084 17.2917 17.0219 17.1081L16.6894 17.084Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.17283 3.02528C2.20726 2.84434 2.38177 2.72526 2.5626 2.75931L2.50025 3.08692L2.43789 3.41454C2.25707 3.38049 2.13839 3.20622 2.17283 3.02528ZM16.7595 4.58093L16.7545 4.91426L16.7174 4.91377L16.6111 4.91221C16.5186 4.9108 16.3842 4.9086 16.2166 4.90547C15.8815 4.89921 15.4131 4.88922 14.8802 4.87428C13.8159 4.84446 12.4887 4.79477 11.451 4.71525C9.67135 4.57888 7.41581 4.25301 5.61119 3.96257C4.70758 3.81715 3.91464 3.68021 3.34754 3.57961C3.06396 3.52931 2.83678 3.48809 2.68039 3.45942C2.60219 3.44508 2.54168 3.43388 2.50067 3.42626L2.43789 3.41454C2.43784 3.41453 2.43789 3.41454 2.50025 3.08692L2.5626 2.75931L2.62388 2.77075C2.66438 2.77828 2.72434 2.78937 2.80196 2.80361C2.95722 2.83207 3.18314 2.87307 3.46534 2.92312C4.0298 3.02325 4.81916 3.15957 5.7185 3.30431C7.51977 3.59421 9.75269 3.91632 11.5034 4.05047C12.5242 4.1287 13.8381 4.17805 14.9003 4.20782C15.4307 4.22268 15.8969 4.23263 16.2305 4.23886C16.3973 4.24197 16.5309 4.24416 16.6228 4.24556L16.7281 4.24711L16.7638 4.24758L16.7595 4.58093ZM16.7595 4.58093L16.7545 4.91426C16.9386 4.91657 17.09 4.76919 17.0927 4.5851C17.0954 4.401 16.9479 4.24989 16.7638 4.24758L16.7595 4.58093Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.28443 2.99528C6.67178 2.78395 8.41647 2.57209 9.79924 2.58239C11.1018 2.59209 12.7438 2.80384 14.0493 3.01027C14.7044 3.11385 15.2791 3.21681 15.6901 3.29389C15.8957 3.33244 16.0604 3.36454 16.174 3.38705C16.2308 3.3983 16.2747 3.40715 16.3046 3.41322L16.3387 3.42017L16.3499 3.42246C16.3499 3.42247 16.3508 3.42264 16.2832 3.74905L16.2156 4.07546L16.2049 4.07326L16.1721 4.06658C16.1432 4.06071 16.1001 4.05205 16.0444 4.041C15.9328 4.01889 15.7703 3.98723 15.5672 3.94914C15.1609 3.87294 14.5926 3.77113 13.9452 3.66876C12.6456 3.46327 11.0445 3.25835 9.79428 3.24904C8.46713 3.23916 6.7659 3.44397 5.38482 3.65435C4.69677 3.75916 4.09275 3.86462 3.66085 3.94386C3.44495 3.98348 3.2722 4.01651 3.15363 4.0396C3.09434 4.05115 3.04861 4.0602 3.01781 4.06635L2.98298 4.07334L2.97218 4.07553L2.90493 3.74905C2.83827 3.42245 2.83831 3.42244 2.83836 3.42243L2.85104 3.41986L2.8873 3.41259C2.91908 3.40624 2.96584 3.39698 3.0262 3.38523C3.1469 3.36172 3.32204 3.32823 3.54054 3.28814C3.97744 3.20798 4.58826 3.10133 5.28443 2.99528ZM2.90493 3.74905L2.83836 3.42243C2.65798 3.45925 2.54151 3.63533 2.57833 3.81571C2.61514 3.99608 2.7918 4.11234 2.97218 4.07553L2.90493 3.74905ZM16.6096 3.81662C16.5723 3.99689 16.3959 4.11278 16.2156 4.07546L16.2832 3.74905L16.3508 3.42264C16.531 3.45996 16.6469 3.63635 16.6096 3.81662Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.28464 4.25107C3.46815 4.23644 3.62878 4.37334 3.64341 4.55685L3.31113 4.58335L2.97886 4.60985C2.96422 4.42634 3.10112 4.26571 3.28464 4.25107ZM4.12194 17.0834L3.78903 17.1002L3.77925 16.9095C3.77288 16.7861 3.76358 16.6067 3.75184 16.3828C3.72836 15.9349 3.69511 15.3089 3.65607 14.5966C3.57795 13.1716 3.47669 11.4024 3.38395 10.0224C3.31295 8.96574 3.2117 7.61287 3.12814 6.52347C3.08637 5.97892 3.04905 5.50047 3.02217 5.15816L2.97886 4.60985L3.31113 4.58335L3.64341 4.55685L3.68679 5.10597C3.71369 5.44858 3.75105 5.92744 3.79285 6.47249C3.87644 7.56228 3.97789 8.91775 4.04912 9.97767C4.14215 11.362 4.24359 13.1346 4.32174 14.5601C4.36082 15.2731 4.39409 15.8996 4.41759 16.3479C4.42935 16.572 4.43866 16.7516 4.44503 16.8752L4.4548 17.0656L4.12194 17.0834ZM4.12194 17.0834L3.78903 17.1002C3.79838 17.2841 3.95501 17.4256 4.13887 17.4163C4.32272 17.4069 4.46415 17.2495 4.4548 17.0656L4.12194 17.0834Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.60257 16.7254C6.90834 16.7169 8.53454 16.7169 9.80648 16.751C11.2396 16.7895 13.0691 16.894 14.5375 16.9886C15.2723 17.036 15.9178 17.0809 16.3797 17.1141C16.6106 17.1306 16.7956 17.1442 16.923 17.1537L17.1194 17.1685L17.0948 17.5009L17.0693 17.8333L16.8735 17.8185C16.7467 17.8091 16.5623 17.7956 16.332 17.779C15.8714 17.746 15.2275 17.7011 14.4947 17.6539C13.0278 17.5594 11.2086 17.4555 9.78861 17.4174C8.52831 17.3836 6.91129 17.3836 5.60691 17.3921C4.95524 17.3963 4.38257 17.4027 3.97284 17.408C3.76798 17.4106 3.60389 17.413 3.49105 17.4147L3.31753 17.4175L3.31112 17.0842L3.30545 16.7509L3.48089 16.7481C3.59419 16.7464 3.7588 16.744 3.96421 16.7414C4.37503 16.7361 4.94916 16.7297 5.60257 16.7254ZM3.31112 17.0842L3.30545 16.7509C3.12138 16.7541 2.97467 16.9059 2.97783 17.09C2.981 17.274 3.13346 17.4207 3.31753 17.4175L3.31112 17.0842ZM17.4271 17.5263C17.4131 17.7099 17.2529 17.8473 17.0693 17.8333L17.0948 17.5009L17.1202 17.1685C17.3038 17.1826 17.4412 17.3428 17.4271 17.5263Z"
  />
</svg>`,pI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.55739 3.93568C7.46902 0.8947 12.2002 1.1564 15.2608 3.91876C16.5142 5.04996 17.2816 6.49066 17.5878 8.01768C18.0083 8.94994 18.234 9.92054 18.249 10.8891C18.2779 12.7636 17.5162 14.6002 15.9043 16.0977C14.392 17.5028 12.5814 18.2375 10.7098 18.2491C9.97219 18.2537 9.22899 18.146 8.49453 17.9255C6.64295 17.767 4.87334 16.9658 3.58343 15.4367C1.676 13.1755 1.2832 10.344 2.28148 7.79433C2.57576 6.38916 3.46976 5.07164 4.55739 3.93568ZM2.42485 10.2275C2.34071 11.9006 2.88716 13.5774 4.093 15.0069C4.3286 15.2861 4.5828 15.5389 4.85254 15.7656C3.68056 14.5772 3.28103 13.0713 3.22018 11.7016C3.04507 11.4605 2.8826 11.214 2.75731 10.9819C2.62124 10.7297 2.51108 10.4781 2.42485 10.2275ZM3.2485 10.4782C2.84526 9.64052 2.76482 8.80019 2.9267 7.97457C3.20512 7.28242 3.59656 6.61183 4.09876 5.98247C6.83382 2.55491 12.419 2.76331 15.4335 6.00168C16.083 6.69948 16.589 7.44767 16.9464 8.21807C17.3965 10.5743 16.656 13.1556 14.8033 14.9846C13.1298 16.6366 10.8047 17.4377 8.61442 17.265C7.6035 16.9502 6.60135 16.3988 5.65306 15.5988C4.68607 14.7829 4.20276 13.7377 4.0001 12.6734C4.13559 12.8295 4.25734 12.9645 4.35215 13.0679C4.41501 13.1364 4.46616 13.1911 4.50176 13.2288L4.54306 13.2724L4.5541 13.2839L4.55706 13.287L4.55788 13.2879C4.6857 13.4204 4.8971 13.4246 5.02959 13.2967C5.16207 13.1689 5.16587 12.9579 5.03807 12.8254C5.03807 12.8254 5.03808 12.8254 5.03807 12.8254L5.03746 12.8248L5.03511 12.8224L5.02535 12.8121L4.98676 12.7714C4.95304 12.7357 4.90399 12.6832 4.84339 12.6172C4.7221 12.485 4.55505 12.2989 4.3723 12.0836C4.21091 11.8934 4.04049 11.6842 3.87965 11.4717C3.87539 11.2461 3.88058 11.0233 3.89318 10.8054C3.9396 10.0027 4.08633 9.28214 4.22199 8.76145C4.2897 8.50157 4.35434 8.29272 4.40167 8.14979C4.42533 8.07836 4.44464 8.02349 4.45781 7.98704C4.4644 7.96882 4.46945 7.95521 4.47274 7.94645L4.47632 7.93698L4.47707 7.93503C4.47705 7.93508 4.47709 7.93498 4.47707 7.93503C4.47705 7.9351 4.4771 7.93496 4.16643 7.81414M12.2502 17.3881C13.3911 17.104 14.4816 16.5096 15.4506 15.6093C16.8479 14.3111 17.5284 12.7623 17.5799 11.1863C17.2636 12.7577 16.4855 14.2608 15.2717 15.459C14.4028 16.3168 13.3632 16.9667 12.2502 17.3881ZM15.4936 5.12111C12.8787 2.70257 8.80143 2.11296 5.76705 3.74252C8.4055 1.71255 12.2223 2.07439 14.8142 4.41366C15.0612 4.63662 15.2876 4.87313 15.4936 5.12111Z"
  />
</svg>`,fI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.1077 1.89441C11.212 2.04607 11.1737 2.25361 11.022 2.35797L11.0139 2.36353L10.9891 2.38073C10.9672 2.39597 10.9346 2.41866 10.8925 2.44821C10.8083 2.50731 10.686 2.59381 10.5341 2.70295C10.2302 2.9213 9.80858 3.22993 9.33796 3.59077C8.39262 4.31558 7.26483 5.23952 6.49268 6.06158C5.75373 6.84829 4.9324 7.97618 4.29023 8.91779C3.97053 9.38655 3.69777 9.80539 3.50499 10.1069C3.40863 10.2577 3.33233 10.379 3.28022 10.4625C3.25417 10.5042 3.23417 10.5364 3.22074 10.5582L3.20559 10.5827L3.20093 10.5903C3.10482 10.7473 2.89938 10.7971 2.74236 10.701C2.58535 10.6049 2.53598 10.3997 2.63209 10.2427L2.63771 10.2335L2.65361 10.2077C2.66756 10.1852 2.6881 10.152 2.71472 10.1094C2.76796 10.0241 2.84553 9.90079 2.94329 9.74786C3.13876 9.4421 3.41522 9.01758 3.73945 8.54216C4.38514 7.5954 5.23047 6.43162 6.00676 5.60515C6.81794 4.74154 7.98182 3.79048 8.93232 3.06171C9.40961 2.69576 9.83695 2.38295 10.1451 2.16156C10.2992 2.05083 10.4235 1.96289 10.5096 1.90251C10.5526 1.87232 10.586 1.84901 10.6088 1.83319L10.6349 1.81514L10.6434 1.80924C10.6434 1.80921 10.6441 1.80876 10.8331 2.08336L10.6441 1.80876C10.7958 1.7044 11.0033 1.74275 11.1077 1.89441Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M1.82582 10.6214C1.94287 10.4793 2.15295 10.459 2.29504 10.5761L2.0831 10.8333L1.87116 11.0906C1.72907 10.9736 1.70877 10.7635 1.82582 10.6214ZM9.16643 17.9167L8.90914 18.1286L8.88737 18.1022L8.82364 18.0254C8.768 17.9584 8.68686 17.8611 8.58513 17.7399C8.38164 17.4975 8.09589 17.1598 7.76706 16.7791C7.1079 16.0159 6.28112 15.0861 5.5974 14.4024C4.91367 13.7187 3.98383 12.8919 3.22065 12.2327C2.83993 11.9039 2.5023 11.6181 2.25988 11.4146C2.1387 11.3129 2.04135 11.2318 1.97438 11.1761L1.89753 11.1124L1.87116 11.0906L2.0831 10.8333L2.29504 10.5761L2.32245 10.5987L2.40042 10.6634C2.46817 10.7197 2.56638 10.8015 2.68852 10.904C2.93274 11.1091 3.27283 11.3969 3.65642 11.7282C4.42187 12.3893 5.36702 13.2292 6.0688 13.931C6.77058 14.6328 7.61046 15.5779 8.27159 16.3434C8.60291 16.7269 8.89072 17.067 9.09574 17.3113C9.19826 17.4334 9.28012 17.5316 9.33641 17.5993L9.40107 17.6773L9.4233 17.7042L9.16643 17.9167ZM9.16643 17.9167L8.90914 18.1286C9.0262 18.2707 9.23628 18.291 9.37837 18.174C9.52046 18.0569 9.54035 17.8463 9.4233 17.7042L9.16643 17.9167Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.6976 10.1657C17.8365 10.045 18.0471 10.0597 18.1678 10.1987C18.2886 10.3376 18.2739 10.5481 18.1349 10.6689L17.9162 10.4173L17.6976 10.1657ZM9.99958 17.9173L9.76008 17.6855L9.86002 17.5825C9.9246 17.516 10.0185 17.4195 10.1358 17.2992C10.3704 17.0587 10.6989 16.7232 11.0744 16.343C11.8247 15.5834 12.7652 14.6428 13.52 13.9257C14.3177 13.1677 15.3629 12.2271 16.2067 11.4776C16.629 11.1026 17.0016 10.7747 17.2686 10.5406C17.4022 10.4235 17.5093 10.3299 17.5831 10.2654L17.6976 10.1657L17.9162 10.4173L18.1349 10.6689L18.0215 10.7678C17.948 10.8319 17.8412 10.9252 17.7081 11.0419C17.4419 11.2753 17.0704 11.6022 16.6494 11.9761C15.8066 12.7246 14.7684 13.6591 13.9792 14.409C13.2325 15.1184 12.2981 16.0528 11.5487 16.8115C11.1744 17.1905 10.8469 17.525 10.613 17.7648C10.496 17.8846 10.4025 17.9808 10.3382 18.047L10.2395 18.1487L9.99958 17.9173ZM9.99958 17.9173L9.76008 17.6855C9.63205 17.8178 9.63548 18.0288 9.76777 18.1569C9.90005 18.2849 10.1115 18.281 10.2395 18.1487L9.99958 17.9173Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.86605 1.93879C8.94592 1.77293 9.14513 1.70321 9.31099 1.78308L9.16638 2.08341C9.31099 1.78308 9.31095 1.78306 9.31099 1.78308L9.31301 1.78405L9.31817 1.78655L9.33763 1.79603C9.35457 1.80431 9.37932 1.81647 9.41107 1.83223C9.47457 1.86376 9.56614 1.90976 9.67943 1.9681C9.90588 2.08472 10.2198 2.251 10.57 2.44996C11.2644 2.84444 12.1242 3.37987 12.7228 3.91908C13.7803 4.87171 14.411 5.77009 15.1185 6.77795C15.4184 7.20516 15.7321 7.65205 16.0979 8.13108C16.36 8.47421 16.6824 9.01299 16.9328 9.45249C17.0596 9.67498 17.1707 9.87686 17.2501 10.0231C17.2898 10.0963 17.3217 10.1556 17.3437 10.1968L17.369 10.2444L17.3756 10.257L17.3778 10.2611C17.4636 10.4241 17.4012 10.626 17.2383 10.7117C17.0754 10.7975 16.8738 10.7349 16.7881 10.572C16.7881 10.572 16.7881 10.572 16.7881 10.572L16.7861 10.5682L16.7799 10.5565L16.7555 10.5107C16.7342 10.4708 16.7031 10.4128 16.6642 10.3412C16.5864 10.1978 16.4776 10.0001 16.3536 9.78259C16.1026 9.34207 15.7999 8.83917 15.5681 8.53574C15.1665 8.00993 14.837 7.54007 14.5307 7.10341C13.845 6.12584 13.2759 5.31463 12.2766 4.41441C11.7346 3.92618 10.9278 3.41994 10.2407 3.02962C9.90015 2.83617 9.59455 2.67427 9.37421 2.56079C9.2641 2.50409 9.17545 2.45957 9.11458 2.42934C9.08414 2.41423 9.06066 2.4027 9.04493 2.39501L9.02723 2.38639L9.02293 2.3843L9.02195 2.38383C9.02194 2.38383 9.02196 2.38383 9.02195 2.38383C8.8561 2.30395 8.78618 2.10465 8.86605 1.93879Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.1351 1.77876C10.3033 1.85355 10.379 2.05054 10.3042 2.21876L9.99966 2.08335C10.3042 2.21876 10.3043 2.21867 10.3042 2.21876L10.3038 2.21976L10.303 2.22152L10.3004 2.2273L10.291 2.24778C10.2828 2.26534 10.2709 2.29066 10.255 2.32333C10.2233 2.38866 10.1759 2.48339 10.1117 2.60425C9.9834 2.84595 9.78793 3.19226 9.51656 3.61699C8.97388 4.46634 8.12722 5.63001 6.90645 6.89788C5.76129 8.08722 4.70343 8.93382 3.92952 9.48433C3.54251 9.75963 3.22631 9.96102 3.00544 10.0943C2.89499 10.161 2.80836 10.2106 2.7486 10.244C2.71871 10.2607 2.69555 10.2733 2.67948 10.2819L2.66074 10.2919L2.65545 10.2947L2.65384 10.2955L2.65309 10.2959C2.65301 10.296 2.65293 10.296 2.49966 10L2.65309 10.2959C2.48961 10.3806 2.2883 10.3168 2.20366 10.1533C2.11903 9.98984 2.18288 9.78875 2.34627 9.70407C2.34623 9.70409 2.34631 9.70405 2.34627 9.70407L2.34968 9.70228L2.36383 9.69474C2.37682 9.68775 2.39686 9.67685 2.42359 9.66193C2.47703 9.63209 2.55716 9.5862 2.66095 9.52356C2.86854 9.39827 3.17066 9.206 3.54309 8.94108C4.28804 8.41117 5.31352 7.5911 6.42621 6.43548C7.61256 5.20335 8.43257 4.07535 8.95477 3.25804C9.21585 2.84943 9.40237 2.51866 9.52292 2.29161C9.5832 2.1781 9.62696 2.09053 9.6553 2.03217C9.66947 2.00298 9.67978 1.9811 9.68636 1.96693L9.69346 1.9515L9.69495 1.94821C9.76978 1.78008 9.9669 1.70399 10.1351 1.77876Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.20044 11.1035C2.28101 10.938 2.48051 10.8691 2.64604 10.9497L2.65448 10.9538L2.67799 10.9654C2.69853 10.9755 2.72864 10.9904 2.76738 11.0097C2.84485 11.0484 2.95685 11.1047 3.09572 11.176C3.37337 11.3186 3.75901 11.5212 4.19138 11.7614C5.05137 12.2392 6.11398 12.8756 6.87603 13.4899C7.75522 14.1987 8.71011 15.2618 9.43707 16.1347C9.80256 16.5736 10.1142 16.969 10.3345 17.2547C10.4447 17.3977 10.5322 17.5133 10.5923 17.5934C10.6223 17.6335 10.6455 17.6647 10.6613 17.686L10.6793 17.7104L10.684 17.7167L10.6852 17.7184C10.6853 17.7185 10.6857 17.7191 10.4168 17.9161L10.6857 17.7191C10.7945 17.8676 10.7623 18.0762 10.6138 18.185C10.4653 18.2938 10.2567 18.2616 10.1479 18.1131C10.1479 18.1131 10.1479 18.1131 10.1479 18.1131L10.1425 18.1057L10.1256 18.0828C10.1105 18.0625 10.0881 18.0324 10.0589 17.9934C10.0004 17.9154 9.91477 17.8021 9.80657 17.6618C9.59008 17.381 9.28376 16.9924 8.92478 16.5613C8.20281 15.6944 7.2827 14.6741 6.45761 14.0089C5.74236 13.4323 4.72163 12.8186 3.86761 12.3442C3.44298 12.1083 3.06395 11.9092 2.79118 11.7691C2.65485 11.6991 2.54519 11.6439 2.46982 11.6063C2.43213 11.5875 2.40303 11.5731 2.38345 11.5635L2.36135 11.5526L2.3546 11.5493"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.1157 2.32268C11.1157 2.32267 11.1157 2.32268 11.1157 2.32268L11.1168 2.32437L11.1208 2.33079L11.1378 2.35749C11.1531 2.38131 11.1762 2.417 11.2067 2.46344C11.2679 2.55632 11.3589 2.69213 11.4775 2.86197C11.7147 3.20175 12.0615 3.67705 12.4984 4.21674C13.3744 5.29881 14.6027 6.6276 16.0268 7.64481C16.362 7.88419 16.7818 8.19911 17.1162 8.45286C17.2837 8.58001 17.4305 8.69231 17.5354 8.77284L17.6588 8.86774L17.7036 8.90235L17.4997 9.16606L17.2958 9.42971L17.2518 9.39574L17.1294 9.30165C17.0253 9.2217 16.8795 9.11016 16.7132 8.98393C16.3797 8.7309 15.9662 8.42081 15.6393 8.1873C14.1468 7.12119 12.8751 5.74164 11.9802 4.63621C11.5317 4.08215 11.1754 3.5939 10.9308 3.24358C10.8085 3.06837 10.714 2.92749 10.6498 2.82994C10.6177 2.78116 10.5932 2.7432 10.5765 2.71718L10.5575 2.68725L10.5524 2.67926L10.551 2.67705L10.5505 2.67619C10.5504 2.67612 10.5504 2.67606 10.8331 2.49939L10.5505 2.67619C10.4529 2.52008 10.5003 2.31429 10.6564 2.21672C10.8125 2.11917 11.0181 2.16661 11.1157 2.32268ZM17.4997 9.16606L17.2958 9.42971C17.4414 9.54235 17.6508 9.51562 17.7634 9.37001C17.876 9.22439 17.8492 9.01499 17.7036 8.90235L17.4997 9.16606Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.0171 9.57164C17.1434 9.43772 17.3544 9.43155 17.4883 9.55787C17.6222 9.68418 17.6284 9.89515 17.5021 10.0291L17.2596 9.80035L17.0171 9.57164ZM11.0737 17.7016L10.794 17.5203L10.8145 17.4887L10.8734 17.3985C10.9246 17.3201 10.9992 17.2065 11.0926 17.065C11.2796 16.7822 11.5424 16.388 11.8458 15.9426C12.4514 15.0538 13.2238 13.9538 13.8796 13.1278C14.459 12.3981 15.2447 11.5079 15.8823 10.8034C16.2017 10.4504 16.4852 10.1427 16.6889 9.92319C16.7908 9.81342 16.8727 9.72566 16.9292 9.66529L16.9943 9.59593L17.0171 9.57164L17.2596 9.80035L17.5021 10.0291L17.48 10.0525L17.4159 10.1209C17.36 10.1806 17.2787 10.2677 17.1776 10.3766C16.9754 10.5946 16.6938 10.9003 16.3766 11.2508C15.7408 11.9532 14.9671 12.8304 14.4017 13.5424C13.7618 14.3484 13.0007 15.4316 12.3968 16.318C12.0954 16.7603 11.8344 17.1517 11.6488 17.4326C11.556 17.573 11.4821 17.6857 11.4314 17.7633L11.3734 17.8522L11.3538 17.8824L11.0737 17.7016ZM11.0737 17.7016L10.794 17.5203C10.6939 17.6748 10.738 17.8813 10.8925 17.9814C11.047 18.0814 11.2537 18.0369 11.3538 17.8824L11.0737 17.7016Z"
  />
</svg>`,gI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.1042 1.55591C10.2801 1.61017 10.3787 1.79676 10.3245 1.97268L10.0059 1.87444L9.6874 1.7762C9.74166 1.60028 9.92825 1.50165 10.1042 1.55591ZM2.92782 15.5656L2.66613 15.3592L2.67298 15.3505L2.69374 15.324C2.71206 15.3007 2.7392 15.2659 2.77423 15.2209C2.84431 15.1308 2.94597 14.9995 3.07196 14.8347C3.32399 14.5053 3.6731 14.0427 4.0612 13.5107C4.83961 12.4437 5.76667 11.1085 6.38444 10.0089C7.22603 8.51089 8.05125 6.4576 8.66899 4.76689C8.97699 3.92394 9.23181 3.17556 9.4096 2.63803C9.49848 2.36931 9.56806 2.15343 9.61536 2.00491C9.63902 1.93066 9.65709 1.87326 9.66922 1.83453L9.68291 1.79067L9.6874 1.7762L10.0059 1.87444C10.3245 1.97268 10.3245 1.97262 10.3245 1.97268L10.3241 1.97381L10.3195 1.98852L10.3054 2.0338C10.293 2.0735 10.2746 2.13192 10.2506 2.20723C10.2026 2.35785 10.1323 2.5761 10.0425 2.84738C9.86313 3.38983 9.60604 4.14488 9.29517 4.99568C8.67521 6.69249 7.835 8.78805 6.96567 10.3354C6.32758 11.4712 5.38103 12.8327 4.59978 13.9036C4.20806 14.4406 3.85583 14.9073 3.60148 15.2398C3.47429 15.4061 3.3715 15.5389 3.30042 15.6303C3.26488 15.6759 3.23727 15.7113 3.21848 15.7352L3.19704 15.7626L3.19006 15.7714L2.92782 15.5656ZM2.92782 15.5656L2.66613 15.3592C2.55211 15.5037 2.57684 15.7133 2.72137 15.8274C2.86591 15.9414 3.07551 15.9166 3.18953 15.7721L2.92782 15.5656Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.15809 16.0728C6.66763 16.0543 8.54993 16.0541 10.0224 16.1288C11.5853 16.2081 13.5722 16.4167 15.1634 16.6046C15.9601 16.6987 16.6596 16.7879 17.1599 16.8535C17.4101 16.8863 17.6106 16.9133 17.7486 16.932L17.9071 16.9537L17.9624 16.9614C18.1448 16.9869 18.272 17.1554 18.2465 17.3377C18.221 17.52 18.0525 17.6471 17.8702 17.6216L17.816 17.6141L17.6588 17.5926C17.5217 17.574 17.3223 17.5472 17.0732 17.5145C16.575 17.4492 15.8785 17.3604 15.0853 17.2667C13.4967 17.0791 11.5282 16.8728 9.98864 16.7947C8.53815 16.7211 6.67322 16.7209 5.16628 16.7394C4.4138 16.7487 3.7524 16.7626 3.27918 16.7741C3.04259 16.7799 2.85308 16.7851 2.72281 16.7889L2.57336 16.7933L2.52264 16.7949L2.51107 16.4618L2.50033 16.1286L2.55289 16.1269L2.70361 16.1225C2.83476 16.1187 3.02524 16.1135 3.26289 16.1077C3.73816 16.096 4.40233 16.0821 5.15809 16.0728ZM2.17791 16.4726C2.17194 16.2886 2.31633 16.1346 2.50033 16.1286L2.51107 16.4618L2.52264 16.7949C2.33865 16.8009 2.18388 16.6566 2.17791 16.4726Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.94721 2.04509C9.08267 1.92043 9.29354 1.92918 9.41821 2.06464L9.17293 2.29037L8.92766 2.51609C8.803 2.38063 8.81175 2.16976 8.94721 2.04509ZM17.5001 16.3965L17.1832 16.4996L17.1792 16.4874L17.1669 16.4503C17.1561 16.4175 17.14 16.3688 17.1189 16.3058C17.0767 16.1799 17.0146 15.9968 16.9356 15.7688C16.7775 15.3128 16.5516 14.6777 16.2801 13.9621C15.7356 12.5263 15.0142 10.7827 14.2952 9.50708C13.4583 8.02226 12.1209 6.27766 10.9829 4.89499C10.4157 4.20581 9.90135 3.61049 9.52889 3.18756C9.34269 2.97614 9.19206 2.80792 9.08812 2.69271C9.03616 2.63511 8.99587 2.59077 8.96866 2.56093L8.93783 2.52718L8.92766 2.51609L9.17293 2.29037C9.41821 2.06464 9.41816 2.06459 9.41821 2.06464L9.42942 2.07686L9.46134 2.1118C9.48929 2.14246 9.53035 2.18765 9.58312 2.24614C9.68866 2.36312 9.84107 2.53334 10.0292 2.74696C10.4054 3.17409 10.9247 3.77517 11.4976 4.47135C12.64 5.85938 14.0089 7.64131 14.876 9.17975C15.6209 10.5013 16.3567 12.2842 16.9035 13.7257C17.1777 14.4486 17.4059 15.0899 17.5655 15.5505C17.6454 15.7808 17.7081 15.9661 17.751 16.094C17.7724 16.158 17.7889 16.2076 17.8 16.2413L17.8127 16.2798L17.817 16.2932C17.8171 16.2932 17.8171 16.2933 17.5001 16.3965ZM17.5001 16.3965L17.1832 16.4996C17.2401 16.6747 17.4283 16.7704 17.6033 16.7134C17.7784 16.6564 17.874 16.4682 17.817 16.2932L17.5001 16.3965Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M9.73652 3.33805C9.84503 3.18934 10.0536 3.15674 10.2023 3.26525C10.351 3.37377 10.3836 3.58229 10.2751 3.731L10.0058 3.53453L9.73652 3.33805ZM3.76041 15.5662L3.44364 15.4624L3.44694 15.4524L3.4565 15.4234L3.4934 15.3123C3.52562 15.2158 3.57267 15.0759 3.63218 14.9017C3.75116 14.5534 3.92007 14.0677 4.11982 13.5182C4.51824 12.422 5.04339 11.0605 5.54203 10.0278C6.21751 8.62874 7.26905 6.95347 8.14522 5.63598C8.5845 4.97543 8.98196 4.40146 9.26965 3.99255C9.41352 3.78805 9.53001 3.62474 9.61064 3.51241C9.65096 3.45624 9.68231 3.41281 9.70364 3.38334L9.72799 3.34977L9.73652 3.33805C9.73655 3.33801 9.73652 3.33805 10.0058 3.53453L10.2751 3.731L10.2673 3.74174L10.2436 3.77428C10.2228 3.80305 10.192 3.84574 10.1522 3.90114C10.0727 4.01194 9.95745 4.17354 9.81489 4.37615C9.52974 4.78146 9.13569 5.35051 8.70034 6.00515C7.82723 7.31804 6.79698 8.96185 6.14238 10.3176C5.65914 11.3185 5.14339 12.6537 4.74638 13.7459C4.54842 14.2905 4.38098 14.772 4.26305 15.1172C4.20409 15.2898 4.15754 15.4282 4.12577 15.5234L4.0895 15.6326L4.08024 15.6606L4.07736 15.6694L3.76041 15.5662ZM3.76041 15.5662L3.44364 15.4624C3.38636 15.6374 3.48174 15.8257 3.6567 15.883C3.83166 15.9403 4.02009 15.8444 4.07736 15.6694L3.76041 15.5662Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.3149 2.38886C10.4893 2.32971 10.6785 2.42308 10.7377 2.59741L10.422 2.70452L10.1064 2.81163C10.0472 2.6373 10.1406 2.44802 10.3149 2.38886ZM10.422 2.70452C10.1064 2.81163 10.1064 2.81156 10.1064 2.81163L10.108 2.8163L10.1124 2.82938L10.1298 2.87998C10.1452 2.92432 10.1678 2.98953 10.1974 3.07354C10.2565 3.24157 10.3432 3.48485 10.4541 3.78682C10.6757 4.39063 10.9939 5.22977 11.3805 6.17156C12.1512 8.04929 13.2023 10.3568 14.3082 12.0168C14.83 12.7999 15.5668 13.7434 16.1684 14.486C16.4702 14.8584 16.7397 15.1824 16.9338 15.4134C17.0308 15.5289 17.1091 15.6212 17.1632 15.6847L17.2255 15.7577L17.2471 15.7829C17.3672 15.9225 17.5781 15.9387 17.7176 15.8186C17.8571 15.6985 17.8729 15.488 17.7528 15.3485L17.7476 15.3425L17.7319 15.3241L17.6708 15.2525C17.6175 15.19 17.5402 15.0988 17.4441 14.9845C17.252 14.7558 16.9851 14.435 16.6864 14.0663C16.0871 13.3267 15.3667 12.4031 14.863 11.6472C13.7957 10.0451 12.765 7.78891 11.9972 5.91841C11.6145 4.98608 11.2994 4.15499 11.0799 3.5571C10.9702 3.25822 10.8845 3.01778 10.8263 2.85229C10.7971 2.76955 10.7749 2.70557 10.76 2.6624L10.7432 2.61351L10.739 2.60126L10.7377 2.59741L10.422 2.70452Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.61027 17.5168C2.43001 17.5541 2.25355 17.4382 2.21619 17.2579C2.17883 17.0776 2.29468 16.9013 2.47494 16.864L2.54259 17.1904C2.47496 16.864 2.47489 16.864 2.47494 16.864L2.49141 16.8606L2.53887 16.8509C2.58054 16.8424 2.64195 16.83 2.7213 16.8142C2.87999 16.7825 3.11044 16.7372 3.3981 16.6823C3.97333 16.5726 4.77773 16.4247 5.69478 16.2721C7.52506 15.9674 9.81818 15.6413 11.634 15.5644C12.7876 15.5156 14.259 15.5457 15.4363 15.5876C16.0262 15.6086 16.5444 15.6325 16.9153 15.6513C17.1008 15.6607 17.2495 15.6688 17.3519 15.6745L17.4696 15.6812L17.5102 15.6836C17.6939 15.6947 17.8347 15.8527 17.8236 16.0365C17.8126 16.2202 17.6547 16.3602 17.4709 16.3491L17.4311 16.3467L17.3149 16.3401C17.2136 16.3344 17.0661 16.3264 16.8819 16.3171C16.5136 16.2985 15.9987 16.2746 15.4129 16.2538C14.2389 16.2121 12.7889 16.1828 11.6625 16.2305C9.88958 16.3055 7.62989 16.6259 5.80453 16.9297C4.89375 17.0813 4.09463 17.2282 3.52328 17.3372C3.23765 17.3916 3.00905 17.4366 2.85202 17.4679C2.77351 17.4836 2.71289 17.4959 2.67198 17.5042L2.62565 17.5136L2.61027 17.5168Z"
  />
</svg>`,mI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.44887 6.33792C2.63082 6.30988 2.80104 6.43465 2.82908 6.61659C2.92357 7.22966 3.01845 7.79891 3.10866 8.34005C3.57794 11.1554 3.92041 13.2099 3.41887 16.7146C3.39279 16.8968 3.22391 17.0234 3.04168 16.9973C2.85944 16.9713 2.73284 16.8024 2.75892 16.6201C3.24508 13.2229 2.91967 11.2677 2.45308 8.4641C2.36247 7.91969 2.26654 7.34329 2.1702 6.71814C2.14216 6.53619 2.26692 6.36596 2.44887 6.33792Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M15.1061 16.1731C13.9651 16.1615 12.5534 16.1616 11.4552 16.2078C9.87853 16.2741 7.86179 16.4812 6.23376 16.6726C5.42091 16.7682 4.70712 16.8596 4.19659 16.9271C3.94136 16.9609 3.73699 16.9887 3.59653 17.008L3.43542 17.0303L3.38079 17.038L3.33313 16.7081L3.28636 16.378L3.34309 16.3701L3.50569 16.3475C3.64718 16.3281 3.8527 16.3001 4.10919 16.2662C4.62212 16.1984 5.33918 16.1066 6.1559 16.0105C7.787 15.8187 9.82429 15.6091 11.4272 15.5417C12.5436 15.4947 13.9697 15.4948 15.1129 15.5065C15.6853 15.5123 16.1882 15.5211 16.5482 15.5284C16.7281 15.532 16.8724 15.5353 16.9717 15.5377L17.0859 15.5405L17.1251 15.5415L17.1168 15.8747L17.1078 16.208L17.0689 16.2069L16.9558 16.2042C16.8572 16.2018 16.7137 16.1985 16.5346 16.1949C16.1764 16.1876 15.6757 16.1789 15.1061 16.1731ZM17.45 15.8837C17.445 16.0677 17.2918 16.2129 17.1078 16.208L17.1168 15.8747L17.1251 15.5415C17.3091 15.5465 17.455 15.6997 17.45 15.8837ZM3.0031 16.7549C2.97723 16.5727 3.10409 16.4039 3.28636 16.378L3.33313 16.7081L3.38079 17.038C3.19852 17.0639 3.02898 16.9372 3.0031 16.7549Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.4298 5.50028C17.6138 5.49278 17.769 5.63582 17.7765 5.81976L17.4434 5.83334L17.1104 5.84691C17.1029 5.66297 17.2459 5.50778 17.4298 5.50028ZM16.6664 16.6667L16.3384 16.6071L16.3454 16.5681L16.3657 16.4543C16.3832 16.355 16.4084 16.2105 16.4391 16.03C16.5006 15.6689 16.584 15.1641 16.6719 14.5896C16.848 13.4377 17.0404 12.016 17.1108 10.9102C17.1732 9.92887 17.1734 8.66525 17.1576 7.64117C17.1498 7.13036 17.1379 6.68143 17.1281 6.36026C17.1231 6.1997 17.1187 6.07114 17.1155 5.98282L17.1117 5.88158L17.1104 5.84691L17.4434 5.83334L17.7765 5.81976L17.7779 5.85588L17.7817 5.95871C17.785 6.04812 17.7894 6.17791 17.7944 6.3398C17.8044 6.66354 17.8163 7.11595 17.8242 7.63088C17.8401 8.65825 17.8403 9.94366 17.7761 10.9526C17.7037 12.0892 17.5076 13.5351 17.3309 14.6903C17.2423 15.2693 17.1583 15.7779 17.0963 16.1418C17.0654 16.3238 17.0399 16.4696 17.0222 16.5701L17.0017 16.6857L16.9945 16.7255L16.6664 16.6667ZM16.6664 16.6667L16.3384 16.6071C16.3055 16.7882 16.4257 16.9617 16.6068 16.9946C16.788 17.0275 16.9616 16.9066 16.9945 16.7255L16.6664 16.6667Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M18.6816 4.25378C18.6816 4.25378 18.6816 4.25377 18.6816 4.25378L18.6798 4.26045L18.6743 4.2812L18.653 4.36248C18.6345 4.43352 18.6079 4.53713 18.5755 4.66674C18.5106 4.92604 18.4227 5.28896 18.3307 5.70299C18.1456 6.53525 17.9471 7.55848 17.881 8.36138C17.7896 9.47192 17.8441 10.3393 17.9155 11.223C17.9227 11.3116 17.93 11.4004 17.9374 11.4898C18.0036 12.2918 18.0731 13.1322 18.0441 14.1766C18.0281 14.7528 17.9873 15.4868 17.9507 16.0741C17.9323 16.3683 17.915 16.6267 17.9022 16.8116C17.8958 16.9041 17.8906 16.9782 17.887 17.0292L17.8813 17.1081L17.5488 17.084L17.2164 17.0596L17.222 16.9817C17.2256 16.9312 17.2308 16.8576 17.2371 16.7657C17.2498 16.5819 17.2671 16.325 17.2853 16.0326C17.3218 15.4467 17.362 14.7223 17.3777 14.1581C17.4056 13.1522 17.3391 12.3467 17.2729 11.5437C17.2655 11.4547 17.2582 11.3658 17.251 11.2767C17.1787 10.3821 17.1206 9.47185 17.2166 8.30666C17.2867 7.45607 17.4936 6.39597 17.6799 5.55827C17.7735 5.13732 17.8628 4.7686 17.9287 4.50502C17.9617 4.37318 17.9888 4.26753 18.0078 4.19467L18.0298 4.11077L18.0356 4.08879L18.0375 4.08154C18.0852 3.90374 18.2682 3.79769 18.446 3.84542C18.6238 3.89315 18.7293 4.07598 18.6816 4.25378ZM17.5488 17.084L17.2164 17.0596C17.2029 17.2432 17.3408 17.403 17.5244 17.4165C17.708 17.4299 17.8678 17.2917 17.8813 17.1081L17.5488 17.084Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.83426 4.14247C3.84818 3.95882 4.00824 3.82092 4.19176 3.83446L4.16655 4.16698L4.14133 4.49951C3.95782 4.48597 3.82033 4.32611 3.83426 4.14247ZM4.16655 4.16698L4.14133 4.49951L4.18765 4.50286L4.32 4.5122C4.43514 4.5202 4.60234 4.53155 4.81097 4.54497C5.22818 4.5718 5.81134 4.60694 6.47532 4.64014C7.80099 4.70644 9.45741 4.76549 10.7588 4.73432C11.5177 4.71615 12.4849 4.65942 13.2592 4.60755C13.647 4.58156 13.9877 4.55671 14.2315 4.53835C14.3534 4.52917 14.4511 4.52161 14.5184 4.51634L14.6223 4.50811C14.8058 4.49328 14.9433 4.33243 14.9289 4.14888C14.9144 3.96534 14.754 3.82856 14.5705 3.84339L14.4678 3.85152C14.4011 3.85675 14.304 3.86425 14.1829 3.87338C13.9405 3.89163 13.6017 3.91635 13.2161 3.94218C12.4435 3.99394 11.4882 4.04985 10.7443 4.06766C9.46869 4.09821 7.8326 4.04026 6.51001 3.97412C5.84987 3.94111 5.26996 3.90617 4.85514 3.87949C4.64776 3.86615 4.48171 3.85488 4.36759 3.84695L4.23672 3.83772L4.19176 3.83446L4.16655 4.16698Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6.90557 4.249C8.03011 4.03755 9.45202 3.82395 10.5835 3.83435C11.6494 3.84415 12.9876 4.05759 14.0458 4.26413C14.5778 4.36796 15.0444 4.47116 15.3782 4.54842C15.5451 4.58707 15.679 4.61926 15.7713 4.64185C15.8175 4.65315 15.8533 4.66204 15.8777 4.66815L15.9056 4.67516L15.9148 4.6775C15.9148 4.67751 15.9155 4.67769 15.833 5.00065L15.9148 4.6775C16.0931 4.72308 16.2015 4.90481 16.156 5.08318C16.1104 5.26154 15.9288 5.36918 15.7505 5.32361M5.0811 5.32388L5.08316 5.32337L5.09006 5.32164L5.11799 5.31473C5.14274 5.30863 5.17957 5.29962 5.22737 5.28813C5.32297 5.26515 5.46239 5.23224 5.63671 5.19276C5.98546 5.11377 6.47323 5.00865 7.02876 4.90419C8.14602 4.6941 9.51451 4.49122 10.5774 4.50099C11.5787 4.51019 12.8668 4.71325 13.9181 4.91845C14.4408 5.02048 14.8997 5.12196 15.2278 5.19791C15.3918 5.23588 15.523 5.26742 15.6129 5.28942C15.6578 5.30042 15.6925 5.30903 15.7158 5.31486L15.742 5.32147L15.7505 5.32361M4.99967 5.00065C4.91823 4.67742 4.91827 4.67741 4.91832 4.67739L4.9211 4.6767L4.92884 4.67476L4.95848 4.66742C4.9844 4.66103 5.02247 4.65173 5.07155 4.63993C5.16971 4.61633 5.312 4.58275 5.48945 4.54256C5.84422 4.46221 6.3402 4.35531 6.90557 4.249M4.99967 5.00065L4.91832 4.67739C4.73981 4.72237 4.63146 4.90357 4.67643 5.08208C4.72141 5.2606 4.90259 5.36885 5.0811 5.32388"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.09851 7.16634C2.28243 7.17439 2.425 7.33002 2.41694 7.51394L2.08393 7.49935L1.75092 7.48477C1.75897 7.30085 1.91459 7.15829 2.09851 7.16634ZM2.91732 16.666L2.59179 16.7377L2.5897 16.7282L2.58376 16.7009L2.56129 16.5965C2.5419 16.5058 2.5141 16.3741 2.48032 16.2097C2.41279 15.8811 2.32128 15.4215 2.22534 14.8975C2.0341 13.8528 1.82281 12.5389 1.75124 11.4944C1.69721 10.7057 1.6975 9.70092 1.71081 8.89957C1.71749 8.49756 1.7275 8.14425 1.73585 7.89139C1.74002 7.76493 1.74377 7.66352 1.74649 7.59361L1.74972 7.51316L1.75092 7.48477L2.08393 7.49935L2.41694 7.51394L2.41581 7.54077L2.41266 7.61951C2.40998 7.68825 2.40627 7.78834 2.40215 7.91337C2.3939 8.16348 2.38399 8.51306 2.37739 8.91065C2.36413 9.7085 2.36435 10.6898 2.41635 11.4488C2.48522 12.454 2.6907 13.7373 2.88111 14.7774C2.976 15.2957 3.06654 15.7505 3.13334 16.0755C3.16674 16.238 3.19418 16.368 3.21324 16.4573L3.23525 16.5595L3.24096 16.5857L3.24274 16.5938L2.91732 16.666ZM2.91732 16.666L2.59179 16.7377C2.63141 16.9175 2.80929 17.0312 2.98907 16.9915C3.16885 16.9519 3.28237 16.7736 3.24274 16.5938L2.91732 16.666Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.62454 15.5047C6.93031 15.4962 8.55651 15.4962 9.82846 15.5303C11.2616 15.5688 13.0911 15.6733 14.5595 15.7679C15.2943 15.8153 15.9398 15.8602 16.4016 15.8934C16.6326 15.9099 16.8176 15.9235 16.9449 15.933L17.1413 15.9478L17.1167 16.2802L17.0913 16.6126L16.8955 16.5978C16.7687 16.5884 16.5842 16.5748 16.3539 16.5583C15.8933 16.5253 15.2495 16.4804 14.5166 16.4332C13.0497 16.3387 11.2306 16.2348 9.81058 16.1967C8.55028 16.1629 6.93327 16.1629 5.62888 16.1714C4.97721 16.1756 4.40454 16.182 3.99481 16.1873C3.78996 16.1899 3.62586 16.1923 3.51303 16.194L3.3395 16.1968L3.33309 15.8635L3.32742 15.5302L3.50286 15.5274C3.61616 15.5257 3.78077 15.5233 3.98619 15.5207C4.397 15.5154 4.97114 15.509 5.62454 15.5047ZM3.33309 15.8635L3.32742 15.5302C3.14335 15.5334 2.99664 15.6852 2.99981 15.8693C3.00297 16.0533 3.15543 16.2 3.3395 16.1968L3.33309 15.8635ZM17.4491 16.3056C17.4351 16.4892 17.2748 16.6266 17.0913 16.6126L17.1167 16.2802L17.1422 15.9478C17.3257 15.9619 17.4632 16.1221 17.4491 16.3056Z"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M15.4164 4.16586L15.3112 3.84959C15.1365 3.90772 15.042 4.09645 15.1002 4.27112C15.1583 4.4458 15.347 4.54027 15.5217 4.48214M15.4164 4.16586C15.3112 3.84959 15.3111 3.84961 15.3112 3.84959L15.312 3.8493L15.3136 3.8488L15.3186 3.84714L15.3364 3.84145C15.3515 3.83665 15.3731 3.82992 15.4003 3.82175C15.4547 3.80544 15.5319 3.78331 15.6251 3.75941C15.8101 3.71193 16.0639 3.65588 16.3298 3.62566C16.59 3.59607 16.8897 3.58772 17.1539 3.65441C17.4241 3.72264 17.7106 3.88695 17.8181 4.23381C17.8763 4.42122 17.8713 4.64093 17.8612 4.78275C17.8557 4.85982 17.8475 4.92756 17.8407 4.97617C17.8373 5.0006 17.8342 5.02054 17.8319 5.03479L17.829 5.05185L17.8281 5.05697L17.8278 5.05862L17.8276 5.05946C17.8276 5.05951 17.8276 5.05967 17.4998 4.9992L17.8276 5.05946C17.7942 5.2405 17.6203 5.3604 17.4393 5.327C17.2584 5.29363 17.1387 5.12 17.1719 4.9391"
    fill="currentColor"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.77882 6.55857C3.83811 6.73279 3.74499 6.92211 3.57078 6.98148C3.39653 7.04086 3.20713 6.94774 3.14774 6.77348L3.46323 6.66597C3.14774 6.77348 3.14777 6.77356 3.14774 6.77348L3.14716 6.77175L3.14616 6.76876L3.14299 6.7591C3.14038 6.75108 3.13683 6.73992 3.13255 6.72595C3.12399 6.69804 3.11247 6.65872 3.09978 6.61065C3.07458 6.51517 3.04391 6.38195 3.02326 6.23325C3.00283 6.08609 2.99073 5.91351 3.00806 5.74242C3.02512 5.57403 3.07338 5.38024 3.19659 5.21596C3.36782 4.98767 3.65782 4.85635 3.84492 4.7863C3.94807 4.74768 4.0425 4.71975 4.11102 4.70144C4.14549 4.69222 4.17396 4.6853 4.19437 4.68056L4.21882 4.67505L4.22612 4.67349L4.22846 4.673L4.2293 4.67283C4.22936 4.67281 4.2299 4.6727 4.29659 4.9993L4.2293 4.67283C4.40967 4.63599 4.58636 4.75223 4.62319 4.93261M4.36352 5.32584C4.36356 5.32583 4.36377 5.32579 4.36352 5.32584V5.32584Z"
    fill="currentColor"
  />
</svg>`,bI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5.25 12C5.25 11.5858 5.58579 11.25 6 11.25H18C18.4142 11.25 18.75 11.5858 18.75 12C18.75 12.4142 18.4142 12.75 18 12.75H6C5.58579 12.75 5.25 12.4142 5.25 12Z"
  />
</svg>`,Sr=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M12 5.25C12.4142 5.25 12.75 5.58579 12.75 6V11.25H18C18.4142 11.25 18.75 11.5858 18.75 12C18.75 12.4142 18.4142 12.75 18 12.75H12.75V18C12.75 18.4142 12.4142 18.75 12 18.75C11.5858 18.75 11.25 18.4142 11.25 18V12.75H6C5.58579 12.75 5.25 12.4142 5.25 12C5.25 11.5858 5.58579 11.25 6 11.25H11.25V6C11.25 5.58579 11.5858 5.25 12 5.25Z"
  />
</svg>`,vI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.25 20C2.83579 20 2.5 19.6642 2.5 19.25V4.75C2.5 4.33579 2.83579 4 3.25 4C3.66421 4 4 4.33579 4 4.75L4 19.25C4 19.6642 3.66421 20 3.25 20ZM9.66494 8.43945C9.97453 8.71464 10.0024 9.18869 9.72722 9.49828L8.17013 11.25H15.8298L14.2728 9.49828C13.9976 9.18869 14.0255 8.71464 14.335 8.43945C14.6446 8.16426 15.1187 8.19215 15.3939 8.50174L18.0605 11.5017C18.3131 11.7859 18.3131 12.2141 18.0605 12.4983L15.3939 15.4983C15.1187 15.8079 14.6446 15.8358 14.335 15.5606C14.0255 15.2854 13.9976 14.8113 14.2728 14.5017L15.8298 12.75H8.17013L9.72722 14.5017C10.0024 14.8113 9.97453 15.2854 9.66494 15.5606C9.35535 15.8358 8.8813 15.8079 8.60611 15.4983L5.93944 12.4983C5.68685 12.2141 5.68685 11.7859 5.93944 11.5017L8.60611 8.50174C8.8813 8.19215 9.35535 8.16426 9.66494 8.43945ZM21.5 4.75C21.5 4.33579 21.1642 4 20.75 4C20.3358 4 20 4.33579 20 4.75V19.25C20 19.6642 20.3358 20 20.75 20C21.1642 20 21.5 19.6642 21.5 19.25V4.75Z"
  />
</svg>`,yI=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M-0.939238 4.14286C-0.979281 4.4228 -1 4.70898 -1 5V6.71429H1.57143V9.28571H-1V11C-1 11.291 -0.979281 11.5772 -0.939238 11.8571H1.57143V14.4286H0.0754482C0.481795 15.0111 0.988871 15.5182 1.57143 15.9246V14.4286L4.14286 14.4286V16.9392C4.4228 16.9793 4.70898 17 5 17H6.71429V14.4286H9.28571V17H11C11.291 17 11.5772 16.9793 11.8571 16.9392V14.4286H14.4286L14.4286 15.9246C15.0111 15.5182 15.5182 15.0111 15.9246 14.4286L14.4286 14.4286V11.8571H16.9392C16.9793 11.5772 17 11.291 17 11V9.28571H14.4286V6.71429H17V5C17 4.70898 16.9793 4.4228 16.9392 4.14286H14.4286V1.57143H15.9246C15.5182 0.988871 15.0111 0.481795 14.4286 0.075448L14.4286 1.57143H11.8571V-0.939238C11.5772 -0.979281 11.291 -1 11 -1H9.28571V1.57143H6.71429V-1H5C4.70898 -1 4.4228 -0.979281 4.14286 -0.939238V1.57143H1.57143V0.0754479C0.988871 0.481795 0.481795 0.988871 0.0754479 1.57143H1.57143V4.14286H-0.939238ZM4.14286 4.14286V1.57143H6.71429V4.14286H4.14286ZM4.14286 6.71429H1.57143V4.14286H4.14286V6.71429ZM6.71429 6.71429V4.14286H9.28571V6.71429H6.71429ZM6.71429 9.28571V6.71429H4.14286V9.28571H1.57143V11.8571H4.14286V14.4286H6.71429V11.8571H9.28571V14.4286H11.8571V11.8571H14.4286V9.28571H11.8571V6.71429H14.4286V4.14286H11.8571V1.57143H9.28571V4.14286H11.8571V6.71429H9.28571V9.28571H6.71429ZM6.71429 9.28571V11.8571H4.14286V9.28571H6.71429ZM9.28571 9.28571H11.8571V11.8571H9.28571V9.28571Z"
    fill="#D9D9D9"
  />
</svg>`,Xo=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.5 12.0001C4.5 12.9559 5.27489 13.7308 6.23077 13.7308C7.18665 13.7308 7.96154 12.9559 7.96154 12.0001C7.96154 11.0442 7.18665 10.2693 6.23077 10.2693C5.27489 10.2693 4.5 11.0442 4.5 12.0001ZM12 13.7308C11.0441 13.7308 10.2692 12.9559 10.2692 12.0001C10.2692 11.0442 11.0441 10.2693 12 10.2693C12.9559 10.2693 13.7308 11.0442 13.7308 12.0001C13.7308 12.9559 12.9559 13.7308 12 13.7308ZM17.7692 13.7308C16.8134 13.7308 16.0385 12.9559 16.0385 12.0001C16.0385 11.0442 16.8134 10.2693 17.7692 10.2693C18.7251 10.2693 19.5 11.0442 19.5 12.0001C19.5 12.9559 18.7251 13.7308 17.7692 13.7308Z"
    fill="currentColor"
  />
</svg> `,d0=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.25 5C11.25 5.69036 10.6904 6.25 10 6.25C9.30964 6.25 8.75 5.69036 8.75 5C8.75 4.30964 9.30964 3.75 10 3.75C10.6904 3.75 11.25 4.30964 11.25 5ZM11.25 10C11.25 10.6904 10.6904 11.25 10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10ZM10 16.25C10.6904 16.25 11.25 15.6904 11.25 15C11.25 14.3096 10.6904 13.75 10 13.75C9.30964 13.75 8.75 14.3096 8.75 15C8.75 15.6904 9.30964 16.25 10 16.25Z"
    fill="currentColor"
  />
</svg> `,d3=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.64999 5C3.64999 4.58579 3.98577 4.25 4.39999 4.25H7.39999C7.8142 4.25 8.14999 4.58579 8.14999 5C8.14999 5.41421 7.8142 5.75 7.39999 5.75H4.39999C3.98577 5.75 3.64999 5.41421 3.64999 5ZM9.74999 5C9.74999 4.58579 10.0858 4.25 10.5 4.25H13.5C13.9142 4.25 14.25 4.58579 14.25 5C14.25 5.41421 13.9142 5.75 13.5 5.75L10.5 5.75C10.0858 5.75 9.74999 5.41421 9.74999 5ZM16.8 4.25C16.3858 4.25 16.05 4.58579 16.05 5C16.05 5.41421 16.3858 5.75 16.8 5.75L19.8 5.75C20.2142 5.75 20.55 5.41421 20.55 5C20.55 4.58579 20.2142 4.25 19.8 4.25H16.8ZM3.245 12C3.245 11.5306 3.62555 11.15 4.095 11.15H19.8842C20.3536 11.15 20.7342 11.5306 20.7342 12C20.7342 12.4694 20.3536 12.85 19.8842 12.85H4.095C3.62555 12.85 3.245 12.4694 3.245 12ZM4.49999 17.75C3.80964 17.75 3.24999 18.3096 3.24999 19C3.24999 19.6904 3.80964 20.25 4.49999 20.25H19.5C20.1903 20.25 20.75 19.6904 20.75 19C20.75 18.3096 20.1903 17.75 19.5 17.75H4.49999Z"
  />
</svg>`,c2=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M1.875 10C1.875 9.65482 2.15482 9.375 2.5 9.375H17.5C17.8452 9.375 18.125 9.65482 18.125 10C18.125 10.3452 17.8452 10.625 17.5 10.625H2.5C2.15482 10.625 1.875 10.3452 1.875 10Z"
  />
</svg>`,r8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6.27528 6.22471C6.51935 6.46879 6.51935 6.86452 6.27528 7.1086L4.00888 9.37499H17.5C17.8452 9.37499 18.125 9.65481 18.125 9.99999C18.125 10.3452 17.8452 10.625 17.5 10.625H4.00888L6.27528 12.8914C6.51935 13.1355 6.51935 13.5312 6.27528 13.7753C6.0312 14.0193 5.63547 14.0193 5.39139 13.7753L2.05806 10.4419C1.81398 10.1979 1.81398 9.80213 2.05806 9.55805L5.39139 6.22471C5.63547 5.98064 6.0312 5.98064 6.27528 6.22471Z"
  />
</svg>`,o8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M6.45833 6.66667C6.45833 6.41389 6.30606 6.18599 6.07251 6.08925C5.83896 5.99251 5.57014 6.04598 5.39139 6.22473L2.05806 9.55807C1.81398 9.80214 1.81398 10.1979 2.05806 10.442L5.39139 13.7753C5.57014 13.954 5.83896 14.0075 6.07251 13.9108C6.30606 13.814 6.45833 13.5861 6.45833 13.3333V10.625L17.5 10.625C17.8452 10.625 18.125 10.3452 18.125 9.99999C18.125 9.65481 17.8452 9.37499 17.5 9.37499L6.45833 9.37499V6.66667Z"
  />
</svg>`,s8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M5 6.875C3.27411 6.875 1.875 8.27411 1.875 10C1.875 11.7259 3.27411 13.125 5 13.125C6.51185 13.125 7.77294 12.0514 8.06249 10.625H17.5C17.8452 10.625 18.125 10.3452 18.125 10C18.125 9.65482 17.8452 9.375 17.5 9.375H8.06249C7.77294 7.9486 6.51185 6.875 5 6.875Z"
  />
</svg>`,a8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M4.55806 7.05806C4.80214 6.81398 5.19787 6.81398 5.44195 7.05806L7.75889 9.37501H17.5C17.8452 9.37501 18.125 9.65483 18.125 10C18.125 10.3452 17.8452 10.625 17.5 10.625H7.75889L5.44195 12.9419C5.19787 13.186 4.80214 13.186 4.55806 12.9419L2.05806 10.4419C1.81398 10.1979 1.81398 9.80214 2.05806 9.55806L4.55806 7.05806Z"
  />
</svg>`,l8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M13.7247 6.22472C13.4806 6.4688 13.4806 6.86453 13.7247 7.10861L15.9911 9.375H2.5C2.15482 9.375 1.875 9.65482 1.875 10C1.875 10.3452 2.15482 10.625 2.5 10.625H15.9911L13.7247 12.8914C13.4806 13.1355 13.4806 13.5312 13.7247 13.7753C13.9688 14.0194 14.3645 14.0194 14.6086 13.7753L17.9419 10.4419C18.186 10.1979 18.186 9.80213 17.9419 9.55806L14.6086 6.22472C14.3645 5.98064 13.9688 5.98064 13.7247 6.22472Z"
  />
</svg>`,c8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M13.5417 6.66668C13.5417 6.41389 13.6939 6.186 13.9275 6.08926C14.161 5.99252 14.4299 6.04599 14.6086 6.22474L17.9419 9.55807C18.186 9.80215 18.186 10.1979 17.9419 10.442L14.6086 13.7753C14.4299 13.954 14.161 14.0075 13.9275 13.9108C13.6939 13.814 13.5417 13.5861 13.5417 13.3333V10.625L2.5 10.625C2.15482 10.625 1.875 10.3452 1.875 10C1.875 9.65482 2.15482 9.375 2.5 9.375L13.5417 9.375V6.66668Z"
  />
</svg>`,d8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M15 6.875C16.7259 6.875 18.125 8.27411 18.125 10C18.125 11.7259 16.7259 13.125 15 13.125C13.4882 13.125 12.2271 12.0514 11.9375 10.625H2.5C2.15482 10.625 1.875 10.3452 1.875 10C1.875 9.65482 2.15482 9.375 2.5 9.375H11.9375C12.2271 7.9486 13.4882 6.875 15 6.875Z"
  />
</svg>`,u8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M15.4419 7.05806C15.1979 6.81398 14.8021 6.81398 14.5581 7.05806L12.2411 9.37501H2.5C2.15482 9.37501 1.875 9.65483 1.875 10C1.875 10.3452 2.15482 10.625 2.5 10.625H12.2411L14.5581 12.9419C14.8021 13.186 15.1979 13.186 15.4419 12.9419L17.9419 10.4419C18.186 10.1979 18.186 9.80214 17.9419 9.55806L15.4419 7.05806Z"
  />
</svg>`,wI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M4.33973 9.2551L4.91807 8.74116C5.17609 8.51188 5.57114 8.53517 5.80042 8.79319C6.02971 9.05122 6.00641 9.44626 5.74839 9.67554L4.11562 11.1265C3.87353 11.3416 3.50719 11.3362 3.2716 11.1139L1.73349 9.66299C1.4824 9.42613 1.47086 9.03057 1.70772 8.77948C1.94457 8.5284 2.34013 8.51686 2.59122 8.75372L3.08487 9.21938C3.47287 5.74386 6.42082 3.04169 9.9999 3.04169C11.9215 3.04169 13.6621 3.82143 14.9207 5.08026C15.1648 5.32437 15.1647 5.72009 14.9206 5.96415C14.6765 6.2082 14.2808 6.20816 14.0367 5.96405C13.003 4.93011 11.5766 4.29169 9.9999 4.29169C7.09975 4.29169 4.70473 6.45445 4.33973 9.2551ZM16.3378 8.81764C16.5082 8.8255 16.6681 8.90271 16.7802 9.03134L18.3014 10.7769C18.5282 11.0371 18.5011 11.4319 18.2409 11.6587C17.9807 11.8855 17.5859 11.8584 17.3591 11.5982L16.8798 11.0482C16.3743 14.3939 13.4866 16.9584 9.9999 16.9584C8.02441 16.9584 6.24033 16.1343 4.97449 14.8129C4.73571 14.5636 4.74421 14.168 4.99348 13.9292C5.24274 13.6904 5.63837 13.6989 5.87716 13.9482C6.917 15.0337 8.37914 15.7084 9.9999 15.7084C12.8274 15.7084 15.1747 13.6527 15.6288 10.9543L14.9101 11.6398C14.6603 11.878 14.2647 11.8687 14.0264 11.6189C13.7882 11.3691 13.7976 10.9735 14.0474 10.7352L15.8776 8.98969C16.0011 8.87193 16.1674 8.80977 16.3378 8.81764Z"
  />
</svg>`,h8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M9.375 5.83332C9.375 4.56767 10.401 3.54166 11.6667 3.54166H17.5C17.8452 3.54166 18.125 3.82148 18.125 4.16666C18.125 4.51183 17.8452 4.79166 17.5 4.79166H11.6667C11.0914 4.79166 10.625 5.25803 10.625 5.83332V14.1667C10.625 15.4323 9.59899 16.4583 8.33333 16.4583H2.5C2.15482 16.4583 1.875 16.1785 1.875 15.8333C1.875 15.4881 2.15482 15.2083 2.5 15.2083H8.33333C8.90863 15.2083 9.375 14.742 9.375 14.1667V5.83332Z"
  />
</svg>`,p8=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.792 5.05542C11.834 3.58437 13.6266 2.70834 16.6666 2.70834C17.0118 2.70834 17.2916 2.98817 17.2916 3.33334C17.2916 3.67852 17.0118 3.95834 16.6666 3.95834C13.8732 3.95834 12.5409 4.74898 11.812 5.77794C11.0346 6.8755 10.8336 8.36976 10.6201 10.0775C10.6167 10.1048 10.6133 10.1321 10.6099 10.1595C10.4094 11.7647 10.1846 13.5657 9.20785 14.9446C8.16586 16.4156 6.37323 17.2917 3.33325 17.2917C2.98807 17.2917 2.70825 17.0119 2.70825 16.6667C2.70825 16.3215 2.98807 16.0417 3.33325 16.0417C6.1266 16.0417 7.45898 15.251 8.18782 14.2221C8.96526 13.1245 9.16627 11.6303 9.37975 9.92249C9.38315 9.89522 9.38656 9.8679 9.38998 9.84052C9.59039 8.23535 9.81526 6.43433 10.792 5.05542Z"
  />
</svg>`,xI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="currentColor"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M15.9697 2.0199C16.2626 1.72701 16.7374 1.72701 17.0303 2.0199L21.9094 6.89894C22.2413 7.23089 22.2413 7.76908 21.9094 8.10102L17.0303 12.9801C16.7374 13.273 16.2626 13.273 15.9697 12.9801C15.6768 12.6872 15.6768 12.2123 15.9697 11.9194L19.6391 8.24998H18C14.8489 8.24998 13.4484 9.00822 12.7495 9.91192C12.0048 10.8749 11.877 12.1919 11.7476 13.8098C11.7449 13.8434 11.7422 13.8771 11.7395 13.911C11.6211 15.3973 11.481 17.1557 10.437 18.5057C9.3234 19.9457 7.34889 20.75 4 20.75C3.58579 20.75 3.25 20.4142 3.25 20C3.25 19.5858 3.58579 19.25 4 19.25C7.15111 19.25 8.5516 18.4917 9.25046 17.588C9.99517 16.6251 10.123 15.308 10.2524 13.6902C10.2551 13.6566 10.2578 13.6229 10.2605 13.589C10.3789 12.1027 10.519 10.3443 11.563 8.9943C12.6766 7.55424 14.6511 6.74998 18 6.74998H19.6391L15.9697 3.08056C15.6768 2.78767 15.6768 2.31279 15.9697 2.0199Z"
    />
  </svg>
`,_I=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_8946_169583)">
    <path
      d="M14.1919 1.6833C13.9479 1.43922 13.5521 1.43922 13.3081 1.6833C13.064 1.92738 13.064 2.32311 13.3081 2.56719L16.3659 5.62501H11.6667C10.401 5.62501 9.375 6.65102 9.375 7.91667V15C9.375 15.5753 8.90863 16.0417 8.33333 16.0417H2.5C2.15482 16.0417 1.875 16.3215 1.875 16.6667C1.875 17.0119 2.15482 17.2917 2.5 17.2917H8.33333C9.59899 17.2917 10.625 16.2657 10.625 15V7.91667C10.625 7.34138 11.0914 6.87501 11.6667 6.87501H16.3659L13.3081 9.93288C13.064 10.177 13.064 10.5727 13.3081 10.8168C13.5521 11.0608 13.9479 11.0608 14.1919 10.8168L18.2578 6.7509C18.5344 6.47428 18.5344 6.02579 18.2578 5.74917L14.1919 1.6833Z"
    />
  </g>
  <defs>
    <clipPath id="clip0_8946_169583">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>`,CI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M10.833 2.70834C10.4878 2.70834 10.208 2.98817 10.208 3.33334C10.208 3.67852 10.4878 3.95834 10.833 3.95834H15.1574L2.89107 16.2247C2.64699 16.4688 2.64699 16.8645 2.89107 17.1086C3.13514 17.3527 3.53087 17.3527 3.77495 17.1086L16.0413 4.84222V9.16668C16.0413 9.51185 16.3212 9.79168 16.6663 9.79168C17.0115 9.79168 17.2913 9.51185 17.2913 9.16668V3.41668C17.2913 3.02548 16.9742 2.70834 16.583 2.70834H10.833Z"
  />
</svg>`,O9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M17.1086 2.94282C17.3527 3.1869 17.3527 3.58263 17.1086 3.82671L14.4509 6.48449C14.2068 6.72857 13.811 6.72857 13.567 6.48449C13.3229 6.24041 13.3229 5.84469 13.567 5.60061L16.2248 2.94282C16.4688 2.69875 16.8646 2.69875 17.1086 2.94282ZM11.7961 8.25532C12.0402 8.4994 12.0402 8.89513 11.7961 9.13921L9.13835 11.797C8.89428 12.0411 8.49855 12.0411 8.25447 11.797C8.01039 11.5529 8.01039 11.1572 8.25447 10.9131L10.9123 8.25532C11.1563 8.01125 11.5521 8.01125 11.7961 8.25532ZM6.48364 14.4517C6.72771 14.2076 6.72771 13.8119 6.48364 13.5678C6.23956 13.3237 5.84383 13.3237 5.59975 13.5678L2.94197 16.2256C2.69789 16.4697 2.69789 16.8654 2.94197 17.1095C3.18605 17.3536 3.58178 17.3536 3.82585 17.1095L6.48364 14.4517Z"
  />
</svg>`,Mh=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M17.1086 2.89204C17.3527 3.13612 17.3527 3.53185 17.1086 3.77593L3.77532 17.1093C3.53124 17.3533 3.13551 17.3533 2.89143 17.1093C2.64735 16.8652 2.64735 16.4695 2.89143 16.2254L16.2248 2.89204C16.4688 2.64796 16.8646 2.64796 17.1086 2.89204Z"
  />
</svg>`,kI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5.6004 4.71652L15.2835 14.3996C17.5379 11.6986 17.3972 7.67452 14.8614 5.13864C12.3255 2.60276 8.30143 2.46205 5.6004 4.71652ZM14.3996 15.2835L4.71652 5.6004C2.46205 8.30143 2.60276 12.3255 5.13864 14.8614C7.67452 17.3972 11.6986 17.5379 14.3996 15.2835ZM4.25476 4.25476C7.42777 1.08175 12.5722 1.08175 15.7452 4.25476C18.9183 7.42777 18.9183 12.5722 15.7452 15.7452C12.5722 18.9183 7.42777 18.9183 4.25476 15.7452C1.08175 12.5722 1.08175 7.42777 4.25476 4.25476Z"
  />
</svg>`,uX=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_2153_4975)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M4.66665 2.1665C3.65412 2.1665 2.83331 2.98732 2.83331 3.99984V11.9998C2.83331 13.0124 3.65412 13.8332 4.66665 13.8332H11.3333C12.3458 13.8332 13.1666 13.0124 13.1666 11.9998V3.99984C13.1666 2.98732 12.3458 2.1665 11.3333 2.1665H4.66665ZM3.83331 3.99984C3.83331 3.5396 4.20641 3.1665 4.66665 3.1665H11.3333C11.7936 3.1665 12.1666 3.5396 12.1666 3.99984V11.9998C12.1666 12.4601 11.7936 12.8332 11.3333 12.8332H4.66665C4.20641 12.8332 3.83331 12.4601 3.83331 11.9998V3.99984ZM5.99998 4.83317C5.72384 4.83317 5.49998 5.05703 5.49998 5.33317C5.49998 5.60931 5.72384 5.83317 5.99998 5.83317H8.33331C8.60946 5.83317 8.83331 5.60931 8.83331 5.33317C8.83331 5.05703 8.60946 4.83317 8.33331 4.83317H5.99998ZM5.49998 7.6665C5.49998 7.39036 5.72384 7.1665 5.99998 7.1665H9.99998C10.2761 7.1665 10.5 7.39036 10.5 7.6665C10.5 7.94265 10.2761 8.1665 9.99998 8.1665H5.99998C5.72384 8.1665 5.49998 7.94265 5.49998 7.6665ZM5.99998 9.49984C5.72384 9.49984 5.49998 9.72369 5.49998 9.99984C5.49998 10.276 5.72384 10.4998 5.99998 10.4998H9.33331C9.60946 10.4998 9.83331 10.276 9.83331 9.99984C9.83331 9.72369 9.60946 9.49984 9.33331 9.49984H5.99998Z"
      fill="#77757D"
    />
  </g>
  <defs>
    <clipPath id="clip0_2153_4975">
      <rect width="16" height="16" fill="white" />
    </clipPath>
  </defs>
</svg>`,u3=b` <svg
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M7 3.25C5.48122 3.25 4.25 4.48122 4.25 6V18C4.25 19.5188 5.48122 20.75 7 20.75H17C18.5188 20.75 19.75 19.5188 19.75 18V6C19.75 4.48122 18.5188 3.25 17 3.25H7ZM5.75 6C5.75 5.30964 6.30964 4.75 7 4.75H17C17.6904 4.75 18.25 5.30964 18.25 6V18C18.25 18.6904 17.6904 19.25 17 19.25H7C6.30964 19.25 5.75 18.6904 5.75 18V6ZM9 7.25C8.58579 7.25 8.25 7.58579 8.25 8C8.25 8.41421 8.58579 8.75 9 8.75H12.5C12.9142 8.75 13.25 8.41421 13.25 8C13.25 7.58579 12.9142 7.25 12.5 7.25H9ZM8.25 11.5C8.25 11.0858 8.58579 10.75 9 10.75H15C15.4142 10.75 15.75 11.0858 15.75 11.5C15.75 11.9142 15.4142 12.25 15 12.25H9C8.58579 12.25 8.25 11.9142 8.25 11.5ZM9 14.25C8.58579 14.25 8.25 14.5858 8.25 15C8.25 15.4142 8.58579 15.75 9 15.75H14C14.4142 15.75 14.75 15.4142 14.75 15C14.75 14.5858 14.4142 14.25 14 14.25H9Z"
  />
</svg>`,EI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M3.99998 2.70825H2.70831V3.99992H3.95831V3.95825H3.99998V2.70825Z"
      fill="#77757D"
    />
    <path
      d="M6.66665 2.70825H5.33331V3.95825H6.66665V2.70825Z"
      fill="#77757D"
    />
    <path
      d="M7.99998 2.70825V3.95825H13.3333C14.8291 3.95825 16.0416 5.17081 16.0416 6.66659V11.9999H17.2916V6.66659C17.2916 4.48046 15.5194 2.70825 13.3333 2.70825H7.99998Z"
      fill="#77757D"
    />
    <path
      d="M2.70831 5.33325V6.66659H3.95831V5.33325H2.70831Z"
      fill="#77757D"
    />
    <path
      d="M2.70831 7.99992V9.33325H3.95831V7.99992H2.70831Z"
      fill="#77757D"
    />
    <path
      d="M2.70831 10.6666V11.9999H3.95831V10.6666H2.70831Z"
      fill="#77757D"
    />
    <path
      d="M17.2916 14.6666V13.3333H16.0416V14.6666H17.2916Z"
      fill="#77757D"
    />
    <path
      d="M2.70831 13.3333V14.6666H3.95831V13.3333H2.70831Z"
      fill="#77757D"
    />
    <path
      d="M17.2916 17.2916V15.9999H16.0416V16.0416H16V17.2916H17.2916Z"
      fill="#77757D"
    />
    <path
      d="M3.95831 15.9999H2.70831V17.2916H3.99998V16.0416H3.95831V15.9999Z"
      fill="#77757D"
    />
    <path
      d="M5.33331 17.2916H6.66665V16.0416H5.33331V17.2916Z"
      fill="#77757D"
    />
    <path
      d="M7.99998 17.2916H9.33331V16.0416H7.99998V17.2916Z"
      fill="#77757D"
    />
    <path d="M10.6666 17.2916H12V16.0416H10.6666V17.2916Z" fill="#77757D" />
    <path
      d="M13.3333 17.2916H14.6666V16.0416H13.3333V17.2916Z"
      fill="#77757D"
    />
  </svg>
`,SI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_1189_4373)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M2.70831 4.16667C2.70831 2.90101 3.73433 1.875 4.99998 1.875H12.5C13.7656 1.875 14.7916 2.90101 14.7916 4.16667V13.2143C14.7916 14.4799 13.7656 15.506 12.5 15.506H4.99998C3.73433 15.506 2.70831 14.4799 2.70831 13.2143V4.16667ZM4.99998 3.125C4.42468 3.125 3.95831 3.59137 3.95831 4.16667V13.2143C3.95831 13.7896 4.42468 14.256 4.99998 14.256H12.5C13.0753 14.256 13.5416 13.7896 13.5416 13.2143V4.16667C13.5416 3.59137 13.0753 3.125 12.5 3.125H4.99998Z"
        fill="#77757D"
      />
      <path
        d="M5.20831 15.506H12.5C13.7656 15.506 14.7916 14.4799 14.7916 13.2143V4.375H15C16.2656 4.375 17.2916 5.40101 17.2916 6.66667V15.7143C17.2916 16.9799 16.2656 18.006 15 18.006H7.49998C6.23433 18.006 5.20831 16.9799 5.20831 15.7143V15.506Z"
        fill="#77757D"
        fill-opacity="0.6"
      />
    </g>
    <defs>
      <clipPath id="clip0_1189_4373">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,TI=b`
  <svg
    width="60"
    height="72"
    viewBox="0 0 60 72"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect width="60" height="72" />
    <rect
      x="0.5"
      y="0.5"
      width="58.0769"
      height="71"
      stroke="black"
      stroke-opacity="0.1"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M21.9576 26.8962L38.6423 43.5809C42.5269 38.9268 42.2845 31.993 37.9149 27.6235C33.5454 23.254 26.6117 23.0115 21.9576 26.8962ZM37.1193 45.1038L20.4346 28.4192C16.55 33.0732 16.7924 40.007 21.162 44.3765C25.5315 48.746 32.4652 48.9885 37.1193 45.1038ZM19.639 26.1005C25.1063 20.6332 33.9706 20.6332 39.4379 26.1005C44.9053 31.5678 44.9053 40.4322 39.4379 45.8995C33.9706 51.3668 25.1063 51.3668 19.639 45.8995C14.1716 40.4322 14.1716 31.5678 19.639 26.1005Z"
      fill="black"
      fill-opacity="0.1"
    />
  </svg>
`,II=b`
  <svg
    width="60"
    height="72"
    viewBox="0 0 60 72"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect width="60" height="72" />
    <rect
      x="9.23071"
      y="12.0771"
      width="32.3077"
      height="4.61538"
      rx="2"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="9.23071"
      y="25.8462"
      width="40.6154"
      height="2.76923"
      rx="1.38462"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="9.23071"
      y="35.6152"
      width="40.6154"
      height="2.76923"
      rx="1.38462"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="9.23071"
      y="45.3843"
      width="40.6154"
      height="2.76923"
      rx="1.38462"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="9.23071"
      y="55.1533"
      width="13.8462"
      height="2.76923"
      rx="1.38462"
      fill="black"
      fill-opacity="0.1"
    />
  </svg>
`,LI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5.83329 2.70837C4.56764 2.70837 3.54163 3.73439 3.54163 5.00004V15C3.54163 16.2657 4.56764 17.2917 5.83329 17.2917H14.1666C15.4323 17.2917 16.4583 16.2657 16.4583 15V5.00004C16.4583 3.73439 15.4323 2.70837 14.1666 2.70837H5.83329ZM4.79163 5.00004C4.79163 4.42474 5.258 3.95837 5.83329 3.95837H14.1666C14.7419 3.95837 15.2083 4.42474 15.2083 5.00004V15C15.2083 15.5753 14.7419 16.0417 14.1666 16.0417H5.83329C5.258 16.0417 4.79163 15.5753 4.79163 15V5.00004ZM7.49996 6.04171C7.15478 6.04171 6.87496 6.32153 6.87496 6.66671C6.87496 7.01189 7.15478 7.29171 7.49996 7.29171H10.4166C10.7618 7.29171 11.0416 7.01189 11.0416 6.66671C11.0416 6.32153 10.7618 6.04171 10.4166 6.04171H7.49996ZM6.87496 9.58337C6.87496 9.2382 7.15478 8.95837 7.49996 8.95837H12.5C12.8451 8.95837 13.125 9.2382 13.125 9.58337C13.125 9.92855 12.8451 10.2084 12.5 10.2084H7.49996C7.15478 10.2084 6.87496 9.92855 6.87496 9.58337ZM7.49996 11.875C7.15478 11.875 6.87496 12.1549 6.87496 12.5C6.87496 12.8452 7.15478 13.125 7.49996 13.125H11.6666C12.0118 13.125 12.2916 12.8452 12.2916 12.5C12.2916 12.1549 12.0118 11.875 11.6666 11.875H7.49996Z"
  />
</svg>`,Lc=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="currentColor"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_15920)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M5.83337 17.2923C5.4882 17.2923 5.20837 17.0125 5.20837 16.6673V14.7923H3.33337C2.9882 14.7923 2.70837 14.5125 2.70837 14.1673C2.70837 13.8221 2.9882 13.5423 3.33337 13.5423H5.20837L5.20837 6.45898H3.33337C2.9882 6.45898 2.70837 6.17916 2.70837 5.83398C2.70837 5.48881 2.9882 5.20898 3.33337 5.20898H5.20837V3.33398C5.20837 2.98881 5.4882 2.70898 5.83337 2.70898C6.17855 2.70898 6.45837 2.98881 6.45837 3.33398V5.20898H13.5417V3.33398C13.5417 2.98881 13.8215 2.70898 14.1667 2.70898C14.5119 2.70898 14.7917 2.98881 14.7917 3.33398V5.20898H16.6667C17.0119 5.20898 17.2917 5.48881 17.2917 5.83398C17.2917 6.17916 17.0119 6.45898 16.6667 6.45898H14.7917L14.7917 13.5423H16.6667C17.0119 13.5423 17.2917 13.8221 17.2917 14.1673C17.2917 14.5125 17.0119 14.7923 16.6667 14.7923H14.7917V16.6673C14.7917 17.0125 14.5119 17.2923 14.1667 17.2923C13.8215 17.2923 13.5417 17.0125 13.5417 16.6673V14.7923H6.45837V16.6673C6.45837 17.0125 6.17855 17.2923 5.83337 17.2923ZM13.5417 13.5423L13.5417 6.45898H6.45837L6.45837 13.5423H13.5417Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_15920">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,MI=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M7 20.75C6.58579 20.75 6.25 20.4142 6.25 20V17.75H4C3.58579 17.75 3.25 17.4142 3.25 17C3.25 16.5858 3.58579 16.25 4 16.25H6.25L6.25 7.75H4C3.58579 7.75 3.25 7.41421 3.25 7C3.25 6.58579 3.58579 6.25 4 6.25H6.25V4C6.25 3.58579 6.58579 3.25 7 3.25C7.41421 3.25 7.75 3.58579 7.75 4V6.25H16.25V4C16.25 3.58579 16.5858 3.25 17 3.25C17.4142 3.25 17.75 3.58579 17.75 4V6.25H20C20.4142 6.25 20.75 6.58579 20.75 7C20.75 7.41421 20.4142 7.75 20 7.75H17.75L17.75 16.25H20C20.4142 16.25 20.75 16.5858 20.75 17C20.75 17.4142 20.4142 17.75 20 17.75H17.75V20C17.75 20.4142 17.4142 20.75 17 20.75C16.5858 20.75 16.25 20.4142 16.25 20V17.75H7.75V20C7.75 20.4142 7.41421 20.75 7 20.75ZM16.25 16.25L16.25 7.75H7.75L7.75 16.25H16.25Z"
  />
</svg> `,R9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.2916 5C17.2916 4.65482 17.0118 4.375 16.6666 4.375H4.16663C3.82145 4.375 3.54163 4.65482 3.54163 5C3.54163 5.34518 3.82145 5.625 4.16663 5.625H16.6666C17.0118 5.625 17.2916 5.34518 17.2916 5ZM11.4583 10C11.4583 9.65482 11.1785 9.375 10.8333 9.375H4.16663C3.82145 9.375 3.54163 9.65482 3.54163 10C3.54163 10.3452 3.82145 10.625 4.16663 10.625H10.8333C11.1785 10.625 11.4583 10.3452 11.4583 10ZM13.9583 15C13.9583 14.6548 13.6785 14.375 13.3333 14.375H4.16663C3.82145 14.375 3.54163 14.6548 3.54163 15C3.54163 15.3452 3.82145 15.625 4.16663 15.625H13.3333C13.6785 15.625 13.9583 15.3452 13.9583 15Z"
  />
</svg>`,N9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.125 5C3.125 4.65482 3.40482 4.375 3.75 4.375H16.25C16.5952 4.375 16.875 4.65482 16.875 5C16.875 5.34518 16.5952 5.625 16.25 5.625H3.75C3.40482 5.625 3.125 5.34518 3.125 5ZM6.04167 10C6.04167 9.65482 6.32149 9.375 6.66667 9.375H13.3333C13.6785 9.375 13.9583 9.65482 13.9583 10C13.9583 10.3452 13.6785 10.625 13.3333 10.625H6.66667C6.32149 10.625 6.04167 10.3452 6.04167 10ZM5 14.375C4.65482 14.375 4.375 14.6548 4.375 15C4.375 15.3452 4.65482 15.625 5 15.625H15C15.3452 15.625 15.625 15.3452 15.625 15C15.625 14.6548 15.3452 14.375 15 14.375H5Z"
  />
</svg>`,H9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.54163 5C3.54163 4.65482 3.82145 4.375 4.16663 4.375H16.6666C17.0118 4.375 17.2916 4.65482 17.2916 5C17.2916 5.34518 17.0118 5.625 16.6666 5.625H4.16663C3.82145 5.625 3.54163 5.34518 3.54163 5ZM9.37496 10C9.37496 9.65482 9.65478 9.375 9.99996 9.375H16.6666C17.0118 9.375 17.2916 9.65482 17.2916 10C17.2916 10.3452 17.0118 10.625 16.6666 10.625H9.99996C9.65478 10.625 9.37496 10.3452 9.37496 10ZM6.87496 15C6.87496 14.6548 7.15478 14.375 7.49996 14.375H16.6666C17.0118 14.375 17.2916 14.6548 17.2916 15C17.2916 15.3452 17.0118 15.625 16.6666 15.625H7.49996C7.15478 15.625 6.87496 15.3452 6.87496 15Z"
  />
</svg>`,PI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.83277 6.29118C3.62547 6.01519 3.23368 5.9595 2.95769 6.16681C2.68169 6.37411 2.62601 6.76591 2.83331 7.0419C3.50188 7.93198 4.33282 8.69373 5.28223 9.28306L3.64659 11.7365C3.45512 12.0237 3.53273 12.4118 3.81994 12.6032C4.10714 12.7947 4.49519 12.7171 4.68666 12.4299L6.35332 9.92989C6.36688 9.90956 6.37909 9.88872 6.38997 9.86748C7.31361 10.2747 8.31912 10.5306 9.37496 10.6034V14.5832C9.37496 14.9284 9.65478 15.2082 9.99996 15.2082C10.3451 15.2082 10.625 14.9284 10.625 14.5832V10.6035C11.6808 10.5307 12.6864 10.2749 13.6101 9.86776C13.6209 9.8889 13.6331 9.90965 13.6466 9.92989L15.3133 12.4299C15.5047 12.7171 15.8928 12.7947 16.18 12.6032C16.4672 12.4118 16.5448 12.0237 16.3533 11.7365L14.7179 9.2834C15.6675 8.69402 16.4987 7.93215 17.1674 7.0419C17.3747 6.76591 17.319 6.37411 17.043 6.16681C16.767 5.9595 16.3752 6.01519 16.1679 6.29118C14.7605 8.16488 12.5218 9.3749 10.0003 9.3749C7.47885 9.3749 5.24015 8.16488 3.83277 6.29118Z"
    fill="currentColor"
  />
</svg>`,hX=b`<svg
  width="17"
  height="16"
  viewBox="0 0 17 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M2 4.66683C2 3.65431 2.82081 2.8335 3.83333 2.8335H13.1667C14.1792 2.8335 15 3.65431 15 4.66683V11.3335C15 12.346 14.1792 13.1668 13.1667 13.1668H3.83333C2.82081 13.1668 2 12.346 2 11.3335V4.66683ZM3.83333 3.8335C3.3731 3.8335 3 4.20659 3 4.66683V11.3335C3 11.7937 3.3731 12.1668 3.83333 12.1668H13.1667C13.6269 12.1668 14 11.7937 14 11.3335V4.66683C14 4.20659 13.6269 3.8335 13.1667 3.8335H3.83333Z"
    fill="currentColor"
  />
</svg> `,pX=b`<svg
  width="17"
  height="16"
  viewBox="0 0 17 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.5 2.5C5.46243 2.5 3 4.96243 3 8C3 11.0376 5.46243 13.5 8.5 13.5C11.5376 13.5 14 11.0376 14 8C14 4.96243 11.5376 2.5 8.5 2.5ZM2 8C2 4.41015 4.91015 1.5 8.5 1.5C12.0899 1.5 15 4.41015 15 8C15 11.5899 12.0899 14.5 8.5 14.5C4.91015 14.5 2 11.5899 2 8Z"
    fill="currentColor"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5 8C5 7.72386 5.22386 7.5 5.5 7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H5.5C5.22386 8.5 5 8.27614 5 8Z"
    fill="currentColor"
  />
</svg> `,fX=b`
  <svg
    width="17"
    height="16"
    viewBox="0 0 17 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12.3702 9.68705C12.175 9.88231 11.8584 9.88231 11.6631 9.68705L8.91906 6.94297C8.78889 6.8128 8.57783 6.8128 8.44766 6.94297L5.70358 9.68705C5.50832 9.88231 5.19173 9.88231 4.99647 9.68705C4.80121 9.49179 4.80121 9.1752 4.99647 8.97994L7.74055 6.23586C8.26125 5.71517 9.10547 5.71516 9.62617 6.23586L12.3702 8.97994C12.5655 9.1752 12.5655 9.49179 12.3702 9.68705Z"
      fill="currentColor"
    />
  </svg>
`,AI=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.44444 3.16699C3.73875 3.16699 3.16667 3.73907 3.16667 4.44477C3.16667 5.15047 3.73875 5.72255 4.44444 5.72255C5.15014 5.72255 5.72222 5.15047 5.72222 4.44477C5.72222 3.73907 5.15014 3.16699 4.44444 3.16699ZM2.16667 4.44477C2.16667 3.18679 3.18646 2.16699 4.44444 2.16699C5.70243 2.16699 6.72222 3.18679 6.72222 4.44477C6.72222 4.8864 6.59654 5.29867 6.37899 5.64777L8.19286 7.32048L12.9943 2.89204C13.1973 2.70482 13.5137 2.71761 13.7009 2.9206C13.8881 3.12359 13.8753 3.43991 13.6723 3.62713L6.37936 10.3535C6.59668 10.7024 6.72222 11.1145 6.72222 11.5559C6.72222 12.8139 5.70243 13.8337 4.44444 13.8337C3.18646 13.8337 2.16667 12.8139 2.16667 11.5559C2.16667 10.2979 3.18646 9.2781 4.44444 9.2781C4.89882 9.2781 5.32212 9.41115 5.67752 9.6404L7.45537 8.00068L5.67692 6.36063C5.32165 6.58965 4.89856 6.72255 4.44444 6.72255C3.18646 6.72255 2.16667 5.70275 2.16667 4.44477ZM9.41021 9.12325C9.59741 8.92024 9.91374 8.90744 10.1167 9.09464L13.6723 12.3735C13.8753 12.5607 13.8881 12.877 13.7009 13.08C13.5137 13.283 13.1974 13.2958 12.9944 13.1086L9.43882 9.82977C9.23581 9.64257 9.22301 9.32625 9.41021 9.12325ZM4.44444 10.2781C3.73875 10.2781 3.16667 10.8502 3.16667 11.5559C3.16667 12.2616 3.73875 12.8337 4.44444 12.8337C5.15014 12.8337 5.72222 12.2616 5.72222 11.5559C5.72222 10.8502 5.15014 10.2781 4.44444 10.2781Z"
    fill="currentColor"
  />
</svg>`,$I=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5.5556 3.9585C4.67347 3.9585 3.95837 4.6736 3.95837 5.55572C3.95837 6.43784 4.67347 7.15294 5.5556 7.15294C6.43772 7.15294 7.15282 6.43784 7.15282 5.55572C7.15282 4.6736 6.43772 3.9585 5.5556 3.9585ZM2.70837 5.55572C2.70837 3.98324 3.98312 2.7085 5.5556 2.7085C7.12807 2.7085 8.40282 3.98324 8.40282 5.55572C8.40282 6.10775 8.24572 6.62309 7.97378 7.05947L10.2411 9.15036L16.243 3.61481C16.4967 3.38079 16.8921 3.39677 17.1261 3.6505C17.3602 3.90424 17.3442 4.29964 17.0904 4.53366L7.97424 12.9416C8.24589 13.3778 8.40282 13.8929 8.40282 14.4446C8.40282 16.0171 7.12807 17.2918 5.5556 17.2918C3.98312 17.2918 2.70837 16.0171 2.70837 14.4446C2.70837 12.8721 3.98312 11.5974 5.5556 11.5974C6.12357 11.5974 6.65269 11.7637 7.09694 12.0503L9.31925 10.0006L7.09619 7.95055C6.6521 8.23682 6.12325 8.40294 5.5556 8.40294C3.98312 8.40294 2.70837 7.1282 2.70837 5.55572ZM11.7628 11.4038C11.9968 11.1501 12.3922 11.1341 12.646 11.3681L17.0904 15.4666C17.3442 15.7006 17.3602 16.096 17.1262 16.3498C16.8922 16.6035 16.4968 16.6196 16.243 16.3855L11.7986 12.287C11.5448 12.053 11.5288 11.6576 11.7628 11.4038ZM5.5556 12.8474C4.67347 12.8474 3.95837 13.5625 3.95837 14.4446C3.95837 15.3267 4.67347 16.0418 5.5556 16.0418C6.43772 16.0418 7.15282 15.3267 7.15282 14.4446C7.15282 13.5625 6.43772 12.8474 5.5556 12.8474Z"
    fill="currentColor"
  />
</svg>`,u0=b`<svg
  width="8"
  height="4"
  viewBox="0 0 8 4"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M7.22586 3.47595C7.05501 3.64681 6.778 3.64681 6.60714 3.47595L4.20608 1.07489C4.09217 0.960983 3.9075 0.960983 3.7936 1.07489L1.39253 3.47595C1.22168 3.64681 0.944665 3.64681 0.773811 3.47595C0.602957 3.3051 0.602957 3.02809 0.773811 2.85724L3.17488 0.456168C3.63049 0.000556783 4.36918 0.000555735 4.82479 0.456168L7.22586 2.85724C7.39672 3.02809 7.39672 3.3051 7.22586 3.47595Z"
    fill="currentColor"
  />
</svg>`,F9=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g>
      <path
        id="Union"
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M5.6818 3.9585C4.82197 3.9585 4.12494 4.65553 4.12494 5.51536C4.12494 6.37519 4.82197 7.07222 5.6818 7.07222C6.54163 7.07222 7.23866 6.37519 7.23866 5.51536C7.23866 4.65553 6.54163 3.9585 5.6818 3.9585ZM2.87494 5.51536C2.87494 3.96517 4.13161 2.7085 5.6818 2.7085C7.1686 2.7085 8.38541 3.8645 8.48243 5.32674C9.18444 5.32742 9.85859 5.3384 10.56 5.50781C11.3377 5.69568 12.1143 6.06747 13.0388 6.76082L13.0558 6.77356L13.0719 6.78743C14.3773 7.91276 15.0307 9.73181 15.0342 11.4359H16.4166C16.7618 11.4359 17.0416 11.7157 17.0416 12.0609V15.9883C17.0416 16.3334 16.7618 16.6133 16.4166 16.6133H12.4893C12.1441 16.6133 11.8643 16.3334 11.8643 15.9883V12.0609C11.8643 11.7157 12.1441 11.4359 12.4893 11.4359H13.7842C13.7806 10.0149 13.2312 8.58544 12.2713 7.74773C11.4589 7.14103 10.8395 6.86129 10.2665 6.72287C9.67341 6.57962 9.09406 6.5767 8.30005 6.5767V6.52901C7.96678 7.38925 7.22178 8.04431 6.30684 8.25237V11.5058C7.55618 11.7899 8.48866 12.9074 8.48866 14.2428C8.48866 15.793 7.23199 17.0496 5.6818 17.0496C4.13161 17.0496 2.87494 15.793 2.87494 14.2428C2.87494 12.9074 3.80747 11.7898 5.05684 11.5057V8.25239C3.80747 7.96831 2.87494 6.85074 2.87494 5.51536ZM5.6818 12.6859C4.82197 12.6859 4.12494 13.3829 4.12494 14.2428C4.12494 15.1026 4.82197 15.7996 5.6818 15.7996C6.54163 15.7996 7.23866 15.1026 7.23866 14.2428C7.23866 13.3829 6.54163 12.6859 5.6818 12.6859ZM13.1143 15.3633V12.6859H15.7916V15.3633H13.1143Z"
        fill="#77757D"
      />
    </g>
  </svg>
`,BI=b`
  <svg
    width="36"
    height="61"
    viewBox="0 0 36 61"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    id="edgeless-pen-icon"
  >
    <g filter="url(#filter0_d_8344_17221)">
      <path
        d="M8.00024 40.8966L12.283 39.469V108.538H8.00024V40.8966Z"
        fill="currentColor"
      />
      <path
        d="M8.00024 40.8966L12.283 39.469V108.538H8.00024V40.8966Z"
        fill="white"
        fill-opacity="0.1"
      />
      <path
        d="M12.283 38.9929H17.5174V108.538H12.283V38.9929Z"
        fill="currentColor"
      />
      <path
        d="M17.5175 38.9929H22.7519V108.538H17.5175V38.9929Z"
        fill="currentColor"
      />
      <path
        d="M17.5175 38.9929H22.7519V108.538H17.5175V38.9929Z"
        fill="black"
        fill-opacity="0.1"
      />
      <path
        d="M22.752 32.9448L27.0347 40.8965V108.538H22.752V32.9448Z"
        fill="currentColor"
      />
      <path
        d="M22.752 32.9448L27.0347 40.8965V108.538H22.752V32.9448Z"
        fill="black"
        fill-opacity="0.2"
      />
      <path
        d="M16.5909 4.88078C16.8233 3.90625 18.2099 3.90623 18.4423 4.88075L19.896 10.9741L22.2755 20.9483L27.0345 40.8965L23.9871 40.0231C23.1982 39.7969 22.3511 39.9039 21.6431 40.3189L18.023 42.4414C17.7107 42.6245 17.3238 42.6245 17.0115 42.4414L13.0218 40.1023C12.5499 39.8256 11.9851 39.7543 11.4592 39.905L8 40.8965L12.7583 20.9483L15.1374 10.9741L16.5909 4.88078Z"
        fill="#F1F1F1"
      />
      <path
        d="M16.5909 4.88078C16.8233 3.90625 18.2099 3.90623 18.4423 4.88075L19.896 10.9741L22.2755 20.9483L27.0345 40.8965L23.9871 40.0231C23.1982 39.7969 22.3511 39.9039 21.6431 40.3189L18.023 42.4414C17.7107 42.6245 17.3238 42.6245 17.0115 42.4414L13.0218 40.1023C12.5499 39.8256 11.9851 39.7543 11.4592 39.905L8 40.8965L12.7583 20.9483L15.1374 10.9741L16.5909 4.88078Z"
        fill="url(#paint0_linear_8344_17221)"
        fill-opacity="0.1"
      />
      <g filter="url(#filter1_b_8344_17221)">
        <path
          d="M16.5915 4.88076C16.824 3.90624 18.2106 3.90625 18.443 4.88077L20.3725 12.969H14.6621L16.5915 4.88076Z"
          fill="currentColor"
        />
      </g>
    </g>
    <defs>
      <filter
        id="filter0_d_8344_17221"
        x="0"
        y="-3"
        width="35.0347"
        height="123.538"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset dy="4" />
        <feGaussianBlur stdDeviation="4" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_8344_17221"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_8344_17221"
          result="shape"
        />
      </filter>
      <filter
        id="filter1_b_8344_17221"
        x="12.7587"
        y="2.24645"
        width="9.51722"
        height="12.626"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feGaussianBlur in="BackgroundImageFix" stdDeviation="0.951724" />
        <feComposite
          in2="SourceAlpha"
          operator="in"
          result="effect1_backgroundBlur_8344_17221"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_backgroundBlur_8344_17221"
          result="shape"
        />
      </filter>
      <linearGradient
        id="paint0_linear_8344_17221"
        x1="22.1949"
        y1="21.2552"
        x2="16.9439"
        y2="22.5016"
        gradientUnits="userSpaceOnUse"
      >
        <stop />
        <stop offset="0.302413" stop-opacity="0" />
        <stop offset="0.557292" stop-opacity="0" />
        <stop offset="1" stop-opacity="0" />
      </linearGradient>
    </defs>
  </svg>
`,DI=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="54"
    height="72"
    viewBox="0 0 54 52"
    fill="none"
    id="edgeless-eraser-icon"
  >
    <g filter="url(#filter0_d_8344_9244)">
      <rect
        x="10.575"
        y="4.575"
        width="33.35"
        height="57.5"
        rx="5.175"
        fill="#F1F1F1"
        stroke="#DDDDDD"
        stroke-width="1.15"
      />
      <g filter="url(#filter1_f_8344_9244)">
        <rect
          x="42.2"
          y="7.45001"
          width="18.4"
          height="3.45"
          rx="1.725"
          transform="rotate(90 42.2 7.45001)"
          fill="white"
        />
      </g>
      <g filter="url(#filter2_f_8344_9244)">
        <rect
          width="32.2"
          height="5.75"
          transform="matrix(1 0 0 -1 11.15 25.85)"
          fill="#AFAFAF"
        />
      </g>
      <path
        d="M21.5 18.375H22.075V18.95V62.65V63.225H21.5H10H9.425V62.65V40.8V29.875V24.4125V23.0013C9.425 21.9592 10.1672 21.0649 11.1915 20.8728C11.5816 20.7997 11.8933 20.506 11.9896 20.121L12.0015 20.0733L12.5593 20.2128L12.0015 20.0733C12.251 19.0752 13.1478 18.375 14.1767 18.375H15.75H21.5Z"
        fill="#173654"
      />
      <path
        d="M21.5 18.375H22.075V18.95V62.65V63.225H21.5H10H9.425V62.65V40.8V29.875V24.4125V23.0013C9.425 21.9592 10.1672 21.0649 11.1915 20.8728C11.5816 20.7997 11.8933 20.506 11.9896 20.121L12.0015 20.0733L12.5593 20.2128L12.0015 20.0733C12.251 19.0752 13.1478 18.375 14.1767 18.375H15.75H21.5Z"
        fill="url(#paint0_linear_8344_9244)"
        fill-opacity="0.2"
      />
      <path
        d="M21.5 18.375H22.075V18.95V62.65V63.225H21.5H10H9.425V62.65V40.8V29.875V24.4125V23.0013C9.425 21.9592 10.1672 21.0649 11.1915 20.8728C11.5816 20.7997 11.8933 20.506 11.9896 20.121L12.0015 20.0733L12.5593 20.2128L12.0015 20.0733C12.251 19.0752 13.1478 18.375 14.1767 18.375H15.75H21.5Z"
        stroke="#E0E0E0"
        stroke-width="1.15"
      />
      <path
        d="M33 18.375H32.425V18.95V62.65V63.225H33H44.5H45.075V62.65V40.8V29.875V24.4125V23.0013C45.075 21.9592 44.3328 21.0649 43.3085 20.8728C42.9184 20.7997 42.6067 20.506 42.5104 20.121L42.4985 20.0733L41.9407 20.2128L42.4985 20.0733C42.249 19.0752 41.3522 18.375 40.3233 18.375H38.75H33Z"
        fill="#1E96EB"
      />
      <path
        d="M33 18.375H32.425V18.95V62.65V63.225H33H44.5H45.075V62.65V40.8V29.875V24.4125V23.0013C45.075 21.9592 44.3328 21.0649 43.3085 20.8728C42.9184 20.7997 42.6067 20.506 42.5104 20.121L42.4985 20.0733L41.9407 20.2128L42.4985 20.0733C42.249 19.0752 41.3522 18.375 40.3233 18.375H38.75H33Z"
        fill="url(#paint1_linear_8344_9244)"
        fill-opacity="0.2"
      />
      <path
        d="M33 18.375H32.425V18.95V62.65V63.225H33H44.5H45.075V62.65V40.8V29.875V24.4125V23.0013C45.075 21.9592 44.3328 21.0649 43.3085 20.8728C42.9184 20.7997 42.6067 20.506 42.5104 20.121L42.4985 20.0733L41.9407 20.2128L42.4985 20.0733C42.249 19.0752 41.3522 18.375 40.3233 18.375H38.75H33Z"
        stroke="#E0E0E0"
        stroke-width="1.15"
      />
      <rect
        x="0.575"
        y="-0.575"
        width="12.65"
        height="44.85"
        transform="matrix(-1 0 0 1 34.15 18.95)"
        fill="#EFFAFF"
      />
      <rect
        x="0.575"
        y="-0.575"
        width="12.65"
        height="44.85"
        transform="matrix(-1 0 0 1 34.15 18.95)"
        fill="url(#paint2_linear_8344_9244)"
        fill-opacity="0.2"
      />
      <rect
        x="0.575"
        y="-0.575"
        width="12.65"
        height="44.85"
        transform="matrix(-1 0 0 1 34.15 18.95)"
        stroke="#E0E0E0"
        stroke-width="1.15"
      />
    </g>
    <defs>
      <filter
        id="filter0_d_8344_9244"
        x="0"
        y="0"
        width="54"
        height="75.8"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset dy="4" />
        <feGaussianBlur stdDeviation="4" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_8344_9244"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_8344_9244"
          result="shape"
        />
      </filter>
      <filter
        id="filter1_f_8344_9244"
        x="36.45"
        y="5.15001"
        width="8.05001"
        height="23"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="BackgroundImageFix"
          result="shape"
        />
        <feGaussianBlur
          stdDeviation="1.15"
          result="effect1_foregroundBlur_8344_9244"
        />
      </filter>
      <filter
        id="filter2_f_8344_9244"
        x="6.54999"
        y="15.5"
        width="41.4"
        height="14.95"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="BackgroundImageFix"
          result="shape"
        />
        <feGaussianBlur
          stdDeviation="2.3"
          result="effect1_foregroundBlur_8344_9244"
        />
      </filter>
      <linearGradient
        id="paint0_linear_8344_9244"
        x1="15.75"
        y1="18.95"
        x2="15.75"
        y2="62.65"
        gradientUnits="userSpaceOnUse"
      >
        <stop stop-opacity="0" />
        <stop offset="1" />
      </linearGradient>
      <linearGradient
        id="paint1_linear_8344_9244"
        x1="38.75"
        y1="18.95"
        x2="38.75"
        y2="62.65"
        gradientUnits="userSpaceOnUse"
      >
        <stop stop-color="white" />
        <stop offset="1" stop-opacity="0" />
      </linearGradient>
      <linearGradient
        id="paint2_linear_8344_9244"
        x1="5.75"
        y1="0"
        x2="5.75"
        y2="43.7"
        gradientUnits="userSpaceOnUse"
      >
        <stop stop-color="#FFF8F8" stop-opacity="0" />
        <stop offset="1" />
      </linearGradient>
    </defs>
  </svg>
`,U9=b`<svg
  width="54"
  height="44"
  viewBox="0 0 54 44"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M25.0402 21.688C25.6802 21.688 26.1362 21.752 26.4082 21.88C26.6962 21.992 26.8402 22.208 26.8402 22.528C26.8402 22.96 26.1442 23.4 24.7522 23.848C24.7842 25.064 24.8002 26.232 24.8002 27.352C24.8002 28.456 24.7122 29.288 24.5362 29.848C24.3602 30.392 24.0802 30.664 23.6962 30.664C23.3122 30.664 23.0082 30.472 22.7842 30.088C22.5762 29.688 22.4002 29.04 22.2562 28.144C22.1282 27.248 21.9922 26.064 21.8482 24.592C20.2162 24.96 19.0402 25.256 18.3202 25.48C17.0722 28.936 16.2402 30.664 15.8242 30.664C15.4882 30.664 15.0402 30.44 14.4802 29.992C13.9362 29.544 13.6642 29.08 13.6642 28.6C13.6642 28.328 13.9762 27.48 14.6002 26.056C14.3282 25.88 14.0882 25.632 13.8802 25.312C13.6882 24.976 13.5922 24.656 13.5922 24.352C13.5922 23.824 14.3842 23.32 15.9682 22.84C16.0962 22.52 16.2242 22.16 16.3522 21.76C16.4962 21.344 16.8402 20.384 17.3842 18.88C17.9442 17.376 18.3842 16.12 18.7042 15.112C18.8482 14.632 19.3442 14.184 20.1922 13.768C21.0562 13.352 21.7282 13.144 22.2082 13.144C22.7682 13.144 23.2642 13.92 23.6962 15.472C24.1442 17.024 24.4562 19.096 24.6322 21.688H25.0402ZM19.4962 22.096C19.9762 22.032 20.6722 21.952 21.5842 21.856C21.5362 21.392 21.4562 20.6 21.3442 19.48C21.2482 18.36 21.1762 17.552 21.1282 17.056C20.8562 17.952 20.3122 19.632 19.4962 22.096ZM38.7414 23.896C39.0294 24.152 39.1734 24.384 39.1734 24.592C39.1734 24.8 39.0774 25.232 38.8854 25.888C38.6934 26.544 38.5654 27.056 38.5014 27.424C38.4374 27.776 38.3814 28.056 38.3334 28.264C38.3014 28.472 38.2774 28.64 38.2614 28.768C38.2454 28.88 38.2134 29.024 38.1654 29.2C38.1334 29.376 38.1014 29.52 38.0694 29.632C38.0534 29.728 38.0214 29.848 37.9734 29.992C37.9414 30.12 37.9014 30.224 37.8534 30.304C37.8054 30.368 37.7494 30.44 37.6854 30.52C37.5894 30.648 37.4294 30.712 37.2054 30.712C36.9814 30.712 36.7014 30.488 36.3654 30.04C36.0454 29.592 35.8054 29.048 35.6454 28.408C34.1414 29.944 32.8774 30.712 31.8534 30.712C31.1654 30.712 30.4214 30.336 29.6214 29.584C28.8214 28.816 28.4214 28.056 28.4214 27.304C28.4214 26.536 28.7654 25.448 29.4534 24.04C30.1414 22.632 31.0774 21.328 32.2614 20.128C33.4614 18.928 34.6454 18.328 35.8134 18.328C36.4854 18.328 37.2614 18.72 38.1414 19.504C39.0214 20.288 39.4614 21.008 39.4614 21.664C39.4614 22.304 39.2214 23.048 38.7414 23.896ZM31.7574 27.688C32.3974 27.688 33.2454 27.256 34.3014 26.392C35.3734 25.512 36.0374 24.408 36.2934 23.08C36.3094 22.888 36.4454 22.776 36.7014 22.744C36.6534 21.832 36.5014 21.376 36.2454 21.376C35.6054 21.376 34.8854 21.792 34.0854 22.624C33.3014 23.456 32.6534 24.344 32.1414 25.288C31.6454 26.232 31.3974 26.928 31.3974 27.376C31.3974 27.504 31.4134 27.592 31.4454 27.64C31.4934 27.672 31.5974 27.688 31.7574 27.688Z"
    fill="currentColor"
  />
  <path
    d="M26.4082 21.88L26.1953 22.3324L26.2109 22.3398L26.227 22.346L26.4082 21.88ZM24.7522 23.848L24.599 23.372L24.2425 23.4868L24.2524 23.8612L24.7522 23.848ZM24.5362 29.848L25.012 30.0019L25.0132 29.9979L24.5362 29.848ZM22.7842 30.088L22.3406 30.3187L22.3462 30.3294L22.3523 30.3399L22.7842 30.088ZM22.2562 28.144L21.7612 28.2147L21.7626 28.2233L22.2562 28.144ZM21.8482 24.592L22.3458 24.5433L22.2907 23.9797L21.7382 24.1042L21.8482 24.592ZM18.3202 25.48L18.1717 25.0026L17.9344 25.0764L17.8499 25.3102L18.3202 25.48ZM14.4802 29.992L14.1623 30.378L14.1679 30.3824L14.4802 29.992ZM14.6002 26.056L15.0582 26.2567L15.2288 25.8672L14.8718 25.6362L14.6002 26.056ZM13.8802 25.312L13.4461 25.5601L13.4532 25.5725L13.461 25.5845L13.8802 25.312ZM15.9682 22.84L16.1132 23.3185L16.3432 23.2488L16.4325 23.0257L15.9682 22.84ZM16.3522 21.76L15.8796 21.5964L15.876 21.6076L16.3522 21.76ZM17.3842 18.88L16.9156 18.7055L16.914 18.7099L17.3842 18.88ZM18.7042 15.112L19.1808 15.2633L19.1831 15.2557L18.7042 15.112ZM20.1922 13.768L19.9753 13.3175L19.972 13.3191L20.1922 13.768ZM23.6962 15.472L23.2145 15.6061L23.2158 15.6107L23.6962 15.472ZM24.6322 21.688L24.1334 21.7219L24.165 22.188H24.6322V21.688ZM19.4962 22.096L19.0216 21.9388L18.7704 22.6972L19.5623 22.5916L19.4962 22.096ZM21.5842 21.856L21.6366 22.3533L22.1329 22.301L22.0816 21.8046L21.5842 21.856ZM21.3442 19.48L20.846 19.5227L20.8467 19.5298L21.3442 19.48ZM21.1282 17.056L21.6259 17.0078L20.6498 16.9108L21.1282 17.056ZM25.0402 22.188C25.6714 22.188 26.0307 22.2549 26.1953 22.3324L26.6211 21.4276C26.2418 21.2491 25.689 21.188 25.0402 21.188V22.188ZM26.227 22.346C26.2939 22.372 26.3114 22.3961 26.3162 22.4033C26.3219 22.4119 26.3402 22.4436 26.3402 22.528H27.3402C27.3402 22.2924 27.2866 22.0561 27.1482 21.8486C27.0091 21.6399 26.8106 21.5 26.5894 21.414L26.227 22.346ZM26.3402 22.528C26.3402 22.4636 26.3799 22.5515 26.051 22.7594C25.756 22.9459 25.2808 23.1526 24.599 23.372L24.9054 24.324C25.6157 24.0954 26.1845 23.8581 26.5854 23.6046C26.9526 23.3725 27.3402 23.0244 27.3402 22.528H26.3402ZM24.2524 23.8612C24.2843 25.0731 24.3002 26.2367 24.3002 27.352H25.3002C25.3002 26.2273 25.2842 25.0549 25.252 23.8348L24.2524 23.8612ZM24.3002 27.352C24.3002 28.4416 24.2119 29.2121 24.0592 29.6981L25.0132 29.9979C25.2125 29.3639 25.3002 28.4704 25.3002 27.352H24.3002ZM24.0605 29.6941C23.9868 29.9219 23.9064 30.0425 23.8458 30.1014C23.7974 30.1484 23.7557 30.164 23.6962 30.164V31.164C24.0207 31.164 24.311 31.0436 24.5426 30.8186C24.762 30.6055 24.9097 30.3181 25.0119 30.0019L24.0605 29.6941ZM23.6962 30.164C23.5211 30.164 23.3673 30.0953 23.2161 29.8361L22.3523 30.3399C22.6491 30.8487 23.1033 31.164 23.6962 31.164V30.164ZM23.2278 29.8573C23.0585 29.5318 22.8922 28.9501 22.7499 28.0647L21.7626 28.2233C21.9083 29.1299 22.0939 29.8442 22.3406 30.3187L23.2278 29.8573ZM22.7512 28.0733C22.6247 27.1877 22.4895 26.0119 22.3458 24.5433L21.3506 24.6407C21.4949 26.1161 21.6318 27.3083 21.7612 28.2147L22.7512 28.0733ZM21.7382 24.1042C20.105 24.4725 18.9122 24.7722 18.1717 25.0026L18.4688 25.9574C19.1682 25.7398 20.3275 25.4475 21.9582 25.0798L21.7382 24.1042ZM17.8499 25.3102C17.2275 27.0338 16.7144 28.3106 16.3097 29.1511C16.1061 29.574 15.9391 29.8669 15.8089 30.0473C15.7431 30.1383 15.6998 30.1821 15.6802 30.1984C15.6527 30.2213 15.706 30.164 15.8242 30.164V31.164C16.0464 31.164 16.2167 31.0527 16.3192 30.9676C16.4296 30.8759 16.5293 30.7577 16.6196 30.6327C16.8013 30.3811 16.9983 30.026 17.2107 29.5849C17.638 28.6974 18.1649 27.3822 18.7905 25.6498L17.8499 25.3102ZM15.8242 30.164C15.7625 30.164 15.6457 30.1417 15.4598 30.0488C15.2776 29.9577 15.0558 29.8121 14.7926 29.6016L14.1679 30.3824C14.4647 30.6199 14.7468 30.8103 15.0126 30.9432C15.2748 31.0743 15.5499 31.164 15.8242 31.164V30.164ZM14.7981 29.606C14.3139 29.2073 14.1642 28.8711 14.1642 28.6H13.1642C13.1642 29.2889 13.5586 29.8807 14.1624 30.378L14.7981 29.606ZM14.1642 28.6C14.1642 28.6046 14.167 28.5564 14.2044 28.4222C14.2384 28.3002 14.2919 28.1381 14.3675 27.9326C14.5184 27.5225 14.7478 26.965 15.0582 26.2567L14.1423 25.8553C13.8286 26.571 13.5901 27.1495 13.429 27.5874C13.3486 27.8059 13.2851 27.9958 13.2411 28.1538C13.2004 28.2996 13.1642 28.4594 13.1642 28.6H14.1642ZM14.8718 25.6362C14.6684 25.5046 14.4759 25.3109 14.2994 25.0395L13.461 25.5845C13.7006 25.9531 13.988 26.2554 14.3286 26.4758L14.8718 25.6362ZM14.3143 25.0639C14.1539 24.7832 14.0922 24.5483 14.0922 24.352H13.0922C13.0922 24.7637 13.2225 25.1688 13.4461 25.5601L14.3143 25.0639ZM14.0922 24.352C14.0922 24.35 14.0923 24.3443 14.0968 24.3325C14.1017 24.3196 14.1128 24.297 14.1374 24.2649C14.1888 24.1979 14.286 24.1072 14.4547 23.9998C14.7938 23.784 15.337 23.5537 16.1132 23.3185L15.8232 22.3615C15.0154 22.6063 14.3707 22.868 13.9178 23.1562C13.4886 23.4293 13.0922 23.8176 13.0922 24.352H14.0922ZM16.4325 23.0257C16.5657 22.6927 16.6976 22.3213 16.8284 21.9124L15.876 21.6076C15.7509 21.9987 15.6268 22.3473 15.504 22.6543L16.4325 23.0257ZM16.8247 21.9236C16.9673 21.5115 17.31 20.5551 17.8544 19.0501L16.914 18.7099C16.3704 20.2129 16.0251 21.1765 15.8797 21.5964L16.8247 21.9236ZM17.8528 19.0545C18.4144 17.5463 18.8574 16.282 19.1808 15.2633L18.2277 14.9607C17.911 15.958 17.4741 17.2057 16.9156 18.7055L17.8528 19.0545ZM19.1831 15.2557C19.2636 14.9873 19.5895 14.6206 20.4124 14.2169L19.972 13.3191C19.099 13.7474 18.4328 14.2767 18.2253 14.9683L19.1831 15.2557ZM20.4091 14.2185C21.2599 13.8089 21.8465 13.644 22.2082 13.644V12.644C21.6099 12.644 20.8526 12.8951 19.9753 13.3175L20.4091 14.2185ZM22.2082 13.644C22.2293 13.644 22.3621 13.656 22.5789 13.9953C22.7874 14.3215 23.0035 14.8478 23.2145 15.6061L24.1779 15.3379C23.957 14.5442 23.709 13.9065 23.4215 13.4567C23.1424 13.02 22.7472 12.644 22.2082 12.644V13.644ZM23.2158 15.6107C23.6499 17.1143 23.9585 19.1467 24.1334 21.7219L25.1311 21.6541C24.9539 19.0453 24.6386 16.9337 24.1766 15.3333L23.2158 15.6107ZM24.6322 22.188H25.0402V21.188H24.6322V22.188ZM19.5623 22.5916C20.0353 22.5285 20.7259 22.4491 21.6366 22.3533L21.5319 21.3587C20.6186 21.4549 19.9171 21.5355 19.4301 21.6004L19.5623 22.5916ZM22.0816 21.8046C22.0337 21.3415 21.9537 20.5502 21.8417 19.4302L20.8467 19.5298C20.9587 20.6498 21.0388 21.4425 21.0869 21.9074L22.0816 21.8046ZM21.8424 19.4373C21.7464 18.3172 21.6742 17.5068 21.6259 17.0078L20.6305 17.1042C20.6783 17.5972 20.7501 18.4028 20.846 19.5227L21.8424 19.4373ZM20.6498 16.9108C20.3799 17.7999 19.8378 19.4742 19.0216 21.9388L19.9709 22.2532C20.7867 19.7898 21.3326 18.1041 21.6067 17.2012L20.6498 16.9108ZM38.7414 23.896L38.3063 23.6497L38.1073 24.0013L38.4092 24.2697L38.7414 23.896ZM38.8854 25.888L38.4055 25.7476L38.8854 25.888ZM38.5014 27.424L38.9934 27.5134L38.994 27.5097L38.5014 27.424ZM38.3334 28.264L37.8462 28.1516L37.842 28.1696L37.8392 28.188L38.3334 28.264ZM38.2614 28.768L38.7565 28.8387L38.7575 28.83L38.2614 28.768ZM38.1654 29.2L37.683 29.0684L37.6773 29.0893L37.6735 29.1106L38.1654 29.2ZM38.0694 29.632L37.5886 29.4946L37.5809 29.5219L37.5762 29.5498L38.0694 29.632ZM37.9734 29.992L37.4991 29.8339L37.493 29.8521L37.4883 29.8707L37.9734 29.992ZM37.8534 30.304L38.2534 30.604L38.2689 30.5834L38.2822 30.5612L37.8534 30.304ZM37.6854 30.52L37.295 30.2077L37.2901 30.2138L37.2854 30.22L37.6854 30.52ZM36.3654 30.04L35.9584 30.3307L35.9654 30.34L36.3654 30.04ZM35.6454 28.408L36.1305 28.2867L35.9136 27.4194L35.2882 28.0582L35.6454 28.408ZM29.6214 29.584L29.2751 29.9447L29.279 29.9483L29.6214 29.584ZM29.4534 24.04L29.0042 23.8205L29.4534 24.04ZM32.2614 20.128L31.9078 19.7744L31.9055 19.7768L32.2614 20.128ZM38.1414 19.504L38.474 19.1307L38.474 19.1307L38.1414 19.504ZM34.3014 26.392L34.618 26.779L34.6187 26.7785L34.3014 26.392ZM36.2934 23.08L36.7844 23.1746L36.7894 23.1483L36.7917 23.1215L36.2934 23.08ZM36.7014 22.744L36.7634 23.2401L37.2252 23.1824L37.2007 22.7177L36.7014 22.744ZM34.0854 22.624L33.725 22.2774L33.7215 22.2811L34.0854 22.624ZM32.1414 25.288L31.7019 25.0496L31.6988 25.0554L32.1414 25.288ZM31.4454 27.64L31.0294 27.9173L31.0849 28.0006L31.1681 28.056L31.4454 27.64ZM38.4092 24.2697C38.5307 24.3777 38.6021 24.4636 38.6406 24.5257C38.6785 24.5867 38.6734 24.6061 38.6734 24.592H39.6734C39.6734 24.1584 39.3849 23.799 39.0736 23.5223L38.4092 24.2697ZM38.6734 24.592C38.6734 24.6378 38.6602 24.7526 38.6133 24.9635C38.5686 25.1647 38.4999 25.4251 38.4055 25.7476L39.3653 26.0284C39.4629 25.6949 39.5382 25.4113 39.5895 25.1805C39.6386 24.9594 39.6734 24.7542 39.6734 24.592H38.6734ZM38.4055 25.7476C38.2118 26.4094 38.0776 26.9426 38.0088 27.3383L38.994 27.5097C39.0532 27.1694 39.175 26.6786 39.3653 26.0284L38.4055 25.7476ZM38.0095 27.3346C37.9461 27.6832 37.8917 27.9546 37.8462 28.1516L38.8206 28.3764C38.8711 28.1574 38.9287 27.8688 38.9933 27.5134L38.0095 27.3346ZM37.8392 28.188C37.8069 28.3981 37.7821 28.5713 37.7653 28.706L38.7575 28.83C38.7727 28.7087 38.7959 28.5459 38.8276 28.34L37.8392 28.188ZM37.7664 28.6973C37.7546 28.7802 37.7284 28.9019 37.683 29.0684L38.6478 29.3316C38.6984 29.1461 38.7362 28.9798 38.7564 28.8387L37.7664 28.6973ZM37.6735 29.1106C37.643 29.278 37.6144 29.4044 37.5886 29.4946L38.5502 29.7694C38.5884 29.6356 38.6238 29.474 38.6573 29.2894L37.6735 29.1106ZM37.5762 29.5498C37.5662 29.61 37.5428 29.7026 37.4991 29.8339L38.4477 30.1501C38.5 29.9934 38.5406 29.846 38.5626 29.7142L37.5762 29.5498ZM37.4883 29.8707C37.4638 29.969 37.4392 30.0225 37.4247 30.0468L38.2822 30.5612C38.3636 30.4255 38.419 30.271 38.4585 30.1133L37.4883 29.8707ZM37.4534 30.004C37.4093 30.0629 37.3566 30.1307 37.295 30.2077L38.0758 30.8323C38.1422 30.7493 38.2016 30.6731 38.2534 30.604L37.4534 30.004ZM37.2854 30.22C37.2898 30.2141 37.2955 30.2084 37.3014 30.204C37.3071 30.1997 37.3101 30.1988 37.3077 30.1998C37.3016 30.2022 37.2719 30.212 37.2054 30.212V31.212C37.5197 31.212 37.8609 31.1193 38.0854 30.82L37.2854 30.22ZM37.2054 30.212C37.2574 30.212 37.2408 30.2344 37.1398 30.1536C37.0457 30.0783 36.9206 29.9469 36.7654 29.74L35.9654 30.34C36.1462 30.5811 36.3291 30.7857 36.5151 30.9344C36.694 31.0776 36.9294 31.212 37.2054 31.212V30.212ZM36.7723 29.7494C36.4952 29.3615 36.2782 28.8777 36.1305 28.2867L35.1603 28.5293C35.3326 29.2183 35.5956 29.8225 35.9585 30.3306L36.7723 29.7494ZM35.2882 28.0582C34.5534 28.8086 33.894 29.3537 33.3098 29.7087C32.7232 30.0651 32.2418 30.212 31.8534 30.212V31.212C32.489 31.212 33.1516 30.9749 33.829 30.5633C34.5088 30.1503 35.2334 29.5434 36.0027 28.7578L35.2882 28.0582ZM31.8534 30.212C31.3502 30.212 30.7239 29.9341 29.9639 29.2197L29.279 29.9483C30.1189 30.7379 30.9806 31.212 31.8534 31.212V30.212ZM29.9677 29.2233C29.2192 28.5048 28.9214 27.8665 28.9214 27.304H27.9214C27.9214 28.2455 28.4236 29.1272 29.2751 29.9447L29.9677 29.2233ZM28.9214 27.304C28.9214 26.6568 29.2203 25.6559 29.9026 24.2595L29.0042 23.8205C28.3105 25.2401 27.9214 26.4152 27.9214 27.304H28.9214ZM29.9026 24.2595C30.5651 22.9037 31.4685 21.6435 32.6173 20.4792L31.9055 19.7768C30.6863 21.0125 29.7177 22.3603 29.0042 23.8205L29.9026 24.2595ZM32.615 20.4816C33.7637 19.3328 34.828 18.828 35.8134 18.828V17.828C34.4628 17.828 33.1591 18.5232 31.9079 19.7744L32.615 20.4816ZM35.8134 18.828C36.2989 18.828 36.9576 19.119 37.8088 19.8773L38.474 19.1307C37.5652 18.321 36.6719 17.828 35.8134 17.828V18.828ZM37.8088 19.8773C38.6612 20.6368 38.9614 21.2301 38.9614 21.664H39.9614C39.9614 20.7859 39.3816 19.9392 38.474 19.1307L37.8088 19.8773ZM38.9614 21.664C38.9614 22.184 38.7642 22.8408 38.3063 23.6497L39.1765 24.1423C39.6786 23.2552 39.9614 22.424 39.9614 21.664H38.9614ZM31.7574 28.188C32.1853 28.188 32.6376 28.0453 33.1004 27.8095C33.5667 27.572 34.0732 27.2248 34.618 26.779L33.9848 26.005C33.4736 26.4232 33.0281 26.724 32.6464 26.9185C32.2612 27.1147 31.9695 27.188 31.7574 27.188V28.188ZM34.6187 26.7785C35.7783 25.8265 36.5057 24.6203 36.7844 23.1746L35.8024 22.9854C35.5691 24.1957 34.9685 25.1975 33.9842 26.0055L34.6187 26.7785ZM36.7917 23.1215C36.7911 23.1285 36.7881 23.1486 36.7751 23.1746C36.7617 23.2015 36.7432 23.2232 36.7253 23.238C36.7086 23.2517 36.6986 23.2544 36.7043 23.2523C36.7105 23.2501 36.7287 23.2445 36.7634 23.2401L36.6394 22.2479C36.4585 22.2705 36.2572 22.328 36.0896 22.466C35.9071 22.6163 35.8132 22.8219 35.7951 23.0385L36.7917 23.1215ZM37.2007 22.7177C37.1761 22.2494 37.1235 21.8531 37.0257 21.5599C36.9771 21.4141 36.9056 21.2567 36.7905 21.1281C36.6649 20.9877 36.4794 20.876 36.2454 20.876V21.876C36.1394 21.876 36.0689 21.8213 36.0453 21.7949C36.0322 21.7803 36.0497 21.7939 36.0771 21.8761C36.1313 22.0389 36.1787 22.3266 36.2021 22.7703L37.2007 22.7177ZM36.2454 20.876C35.3942 20.876 34.5497 21.4197 33.725 22.2774L34.4458 22.9706C35.2211 22.1643 35.8166 21.876 36.2454 21.876V20.876ZM33.7215 22.2811C32.9098 23.1425 32.2358 24.0653 31.7019 25.0496L32.5809 25.5264C33.0711 24.6227 33.693 23.7695 34.4493 22.9669L33.7215 22.2811ZM31.6988 25.0554C31.4442 25.54 31.247 25.9726 31.1124 26.3502C30.98 26.7218 30.8974 27.0697 30.8974 27.376H31.8974C31.8974 27.2343 31.9388 27.0102 32.0544 26.6858C32.1679 26.3674 32.3426 25.98 32.584 25.5206L31.6988 25.0554ZM30.8974 27.376C30.8974 27.4583 30.9024 27.5443 30.9175 27.6274C30.9317 27.7055 30.9605 27.814 31.0294 27.9173L31.8614 27.3626C31.8813 27.3925 31.8914 27.4172 31.8959 27.4301C31.9006 27.4433 31.9017 27.4503 31.9013 27.4486C31.9011 27.4471 31.9 27.4405 31.899 27.4276C31.8981 27.4148 31.8974 27.3978 31.8974 27.376H30.8974ZM31.1681 28.056C31.2839 28.1333 31.4092 28.1588 31.4834 28.1702C31.5699 28.1835 31.6636 28.188 31.7574 28.188V27.188C31.7255 27.188 31.6993 27.1872 31.6782 27.1859C31.6568 27.1846 31.643 27.183 31.6354 27.1818C31.6272 27.1805 31.6308 27.1805 31.6425 27.1842C31.6487 27.1862 31.6589 27.1897 31.6718 27.1956C31.6847 27.2014 31.7024 27.2104 31.7228 27.224L31.1681 28.056Z"
    fill="black"
    fill-opacity="0.1"
  />
  <rect
    x="1"
    y="1"
    width="51"
    height="42"
    rx="4"
    stroke="#E3E2E4"
    stroke-dasharray="2 2"
  />
</svg> `,gX=b`<svg
  width="58"
  height="48"
  viewBox="0 0 58 48"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
  class="shape-icon-shape-group"
>
  <g>
    <g>
      <path
        d="M21.3608 1.8C21.8227 0.999997 22.9774 1 23.4392 1.8L40.7597 31.8C41.2216 32.6 40.6443 33.6 39.7205 33.6H5.07949C4.15573 33.6 3.57838 32.6 4.04026 31.8L21.3608 1.8Z"
      />
      <path
        d="M21.7072 2C22.0151 1.46667 22.7849 1.46667 23.0928 2L40.4133 32C40.7212 32.5333 40.3363 33.2 39.7205 33.2H5.07949C4.46365 33.2 4.07875 32.5333 4.38667 32L21.7072 2Z"
        stroke="black"
        stroke-opacity="0.1"
        stroke-width="0.8"
      />
    </g>
    <g>
      <circle cx="41.6001" cy="19.8008" r="16" />
      <circle
        cx="41.6001"
        cy="19.8008"
        r="15.6"
        stroke="black"
        stroke-opacity="0.1"
        stroke-width="0.8"
      />
    </g>
    <g>
      <rect x="7" y="11.4004" width="45" height="36" rx="1.5" />
      <rect
        x="7.5"
        y="11.9004"
        width="44"
        height="35"
        rx="1"
        stroke="black"
        stroke-opacity="0.1"
      />
    </g>
  </g>
</svg>`,OI=b` <svg
  width="100"
  height="100"
  viewBox="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <rect stroke="inherit" width="100" y="20" height="80" fill="currentColor" />
</svg>`,RI=b` <svg
  width="100"
  height="100"
  viewBox="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <circle stroke="inherit" cx="50" cy="50" r="50" fill="currentColor" />
</svg>`,NI=b` <svg
  width="100"
  height="100"
  viewBox="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <polygon stroke="inherit" points="50,0 100,100 0,100" fill="currentColor" />
</svg>`,HI=b` <svg
  width="100"
  height="100"
  viewBox="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <polygon
    stroke="inherit"
    points="50,0 100,50 50,100 0,50"
    fill="currentColor"
  />
</svg>`,FI=b` <svg
  width="100"
  height="100"
  viewBox="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <rect
    stroke="inherit"
    width="100"
    y="20"
    height="80"
    rx="10"
    fill="currentColor"
  />
</svg>`,UI=b`<svg
  width="66"
  height="50"
  viewBox="0 0 66 50"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_3760_84867)">
    <g clip-path="url(#clip0_3760_84867)">
      <g clip-path="url(#clip1_3760_84867)">
        <g opacity="0.8" filter="url(#filter1_f_3760_84867)">
          <ellipse
            cx="18.0344"
            cy="24.2565"
            rx="18.0344"
            ry="24.2565"
            transform="matrix(-0.155936 -0.987767 0.999908 0.0135939 13.7056 34.4636)"
            fill="#FFCFAC"
          />
        </g>
        <g opacity="0.8" filter="url(#filter2_f_3760_84867)">
          <ellipse
            cx="19.6507"
            cy="19.8311"
            rx="19.6507"
            ry="19.8311"
            transform="matrix(-0.409404 -0.912353 0.978013 -0.208546 8.12207 36.8379)"
            fill="#FF7715"
          />
        </g>
        <g opacity="0.8" filter="url(#filter3_f_3760_84867)">
          <path
            d="M63.5789 9.77916C72.9851 18.853 56.3243 47.3862 52.5954 44.2186C50.3206 42.2863 50.0377 31.0205 43.0574 24.3547C38.5951 20.0935 28.6749 19.6723 22.6336 18.3699C7.14186 15.0301 54.0943 0.629664 63.5789 9.77916Z"
            fill="#DDBC68"
          />
        </g>
      </g>
    </g>
    <rect
      x="0.62962"
      y="1.09053"
      width="49.6656"
      height="33.0444"
      rx="3.56167"
      transform="matrix(0.965926 0.258818 -0.25882 0.965926 13.0395 3.55023)"
      stroke="#E3E2E4"
      stroke-width="1.78084"
    />
    <path
      d="M19.8753 18.8153C19.2887 21.0045 20.6767 23.2781 22.975 23.8939C25.2732 24.5097 27.612 23.2347 28.1986 21.0455C28.7852 18.8563 27.3973 16.5827 25.099 15.9669C22.8007 15.3511 20.4619 16.6261 19.8753 18.8153Z"
      fill="url(#paint0_linear_3760_84867)"
    />
    <path
      d="M39.5992 38.4261L39.23 39.8041C38.985 40.7181 38.8256 41.308 38.6667 41.7469C38.5143 42.1677 38.4088 42.3105 38.3459 42.3777C38.1064 42.6332 37.7867 42.8075 37.4328 42.8756C37.3398 42.8935 37.1561 42.9083 36.6944 42.8223C36.2129 42.7326 35.5929 42.5678 34.6331 42.3107L18.6523 38.0286C17.6925 37.7714 17.0731 37.6042 16.6113 37.4411C16.1685 37.2847 16.0169 37.1801 15.9453 37.1181C15.6728 36.8821 15.4831 36.5714 15.4034 36.2303C15.3825 36.1407 15.3626 35.9642 15.441 35.5236C15.5228 35.0641 15.6797 34.4735 15.9246 33.5595L17.0846 29.2304C17.1673 29.1894 17.2483 29.1503 17.3276 29.1134C17.9411 28.8273 18.5874 28.5994 19.3224 28.561C20.4178 28.5038 21.5121 28.7842 22.4456 29.3613C23.0721 29.7486 23.53 30.2594 23.9312 30.8055C24.1946 31.1639 24.4705 31.5905 24.7719 32.0732L26.8414 30.956C27.6317 30.5292 28.3131 30.1614 28.9008 29.9035C29.5206 29.6315 30.1719 29.4181 30.9073 29.3957C32.0034 29.3623 33.0905 29.6657 34.0102 30.2615C34.6274 30.6613 35.0734 31.1808 35.462 31.7342C35.462 31.7342 38.226 36.2071 39.5992 38.4261Z"
      fill="url(#paint1_linear_3760_84867)"
    />
  </g>
  <g filter="url(#filter4_d_3760_84867)">
    <rect
      x="5.67139"
      y="9.23291"
      width="52.5347"
      height="35.6167"
      rx="4.45209"
      fill="white"
      shape-rendering="crispEdges"
    />
    <g clip-path="url(#clip2_3760_84867)">
      <g clip-path="url(#clip3_3760_84867)">
        <g opacity="0.8" filter="url(#filter5_f_3760_84867)">
          <ellipse
            cx="18.0344"
            cy="24.2565"
            rx="18.0344"
            ry="24.2565"
            transform="matrix(-0.406276 -0.91375 0.969355 -0.245664 15.2515 39.2395)"
            fill="#5076FF"
          />
        </g>
        <g opacity="0.8" filter="url(#filter6_f_3760_84867)">
          <ellipse
            cx="19.6507"
            cy="19.8312"
            rx="19.6507"
            ry="19.8312"
            transform="matrix(-0.631588 -0.775304 0.890712 -0.454568 10.4727 42.9778)"
            fill="#77FFCE"
          />
        </g>
        <g opacity="0.8" filter="url(#filter7_f_3760_84867)">
          <path
            d="M57.0367 2.48772C68.4709 8.81785 59.7628 40.691 55.3411 38.5964C52.6437 37.3187 49.4547 26.51 40.9869 21.878C35.5738 18.9169 25.8826 21.0775 19.71 21.3831C3.88181 22.1667 45.5072 -3.89522 57.0367 2.48772Z"
            fill="#35B7E0"
          />
        </g>
      </g>
    </g>
    <rect
      x="6.5618"
      y="10.1231"
      width="50.7539"
      height="33.8358"
      rx="3.56167"
      stroke="#E3E2E4"
      stroke-width="1.78084"
    />
    <path
      d="M17.1606 22.5276C17.1606 24.7941 19.0897 26.6309 21.4691 26.6309C23.8484 26.6309 25.7776 24.7941 25.7776 22.5276C25.7776 20.2612 23.8484 18.4243 21.4691 18.4243C19.0897 18.4243 17.1606 20.2612 17.1606 22.5276Z"
      fill="url(#paint2_linear_3760_84867)"
    />
    <path
      d="M41.2881 36.3653L41.2881 37.7919C41.2881 38.7382 41.2867 39.3492 41.2468 39.8143C41.2086 40.2602 41.1437 40.4255 41.1002 40.5066C40.935 40.8155 40.6714 41.0666 40.3471 41.2239C40.2619 41.2653 40.0883 41.3271 39.6201 41.3635C39.1318 41.4015 38.4902 41.4028 37.4966 41.4028H20.9521C19.9584 41.4028 19.3169 41.4015 18.8286 41.3635C18.3604 41.3271 18.1868 41.2653 18.1016 41.2239C17.7773 41.0666 17.5137 40.8155 17.3484 40.5066C17.305 40.4255 17.2401 40.2602 17.2018 39.8143C17.1619 39.3492 17.1606 38.7382 17.1606 37.7919L17.1606 33.3102C17.2299 33.2491 17.2981 33.1904 17.3651 33.1342C17.8836 32.6991 18.4489 32.3117 19.149 32.0844C20.1922 31.7456 21.3217 31.7333 22.3729 32.0491C23.0782 32.261 23.6527 32.6359 24.1816 33.0595C24.5288 33.3376 24.9057 33.6783 25.3218 34.0665L27.0315 32.4517C27.6845 31.8349 28.2474 31.3033 28.7484 30.902C29.2767 30.4789 29.8506 30.1042 30.5552 29.8922C31.6052 29.5763 32.7338 29.5879 33.7764 29.9254C34.476 30.1519 35.0412 30.5383 35.5598 30.9722C35.5598 30.9722 39.3873 34.5773 41.2881 36.3653Z"
      fill="url(#paint3_linear_3760_84867)"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_3760_84867"
      x="-0.561671"
      y="-0.561671"
      width="67.0862"
      height="55.1233"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.78084" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3760_84867"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3760_84867"
        result="shape"
      />
    </filter>
    <filter
      id="filter1_f_3760_84867"
      x="1.23073"
      y="-10.3352"
      width="67.834"
      height="54.6294"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.74889"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <filter
      id="filter2_f_3760_84867"
      x="-11.0286"
      y="-13.1272"
      width="61.0014"
      height="55.802"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.7489"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <filter
      id="filter3_f_3760_84867"
      x="10.0266"
      y="-2.71654"
      width="65.8896"
      height="56.6772"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.7489"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <filter
      id="filter4_d_3760_84867"
      x="2.10972"
      y="5.67099"
      width="59.658"
      height="42.7403"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.78084" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3760_84867"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3760_84867"
        result="shape"
      />
    </filter>
    <filter
      id="filter5_f_3760_84867"
      x="-2.69506"
      y="-10.2244"
      width="68.2656"
      height="54.0517"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.74889"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <filter
      id="filter6_f_3760_84867"
      x="-15.3625"
      y="-8.47509"
      width="62.1758"
      height="54.406"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.7489"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <filter
      id="filter7_f_3760_84867"
      x="6.66676"
      y="-8.01757"
      width="65.5259"
      height="56.2104"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="BackgroundImageFix"
        result="shape"
      />
      <feGaussianBlur
        stdDeviation="4.7489"
        result="effect1_foregroundBlur_3760_84867"
      />
    </filter>
    <linearGradient
      id="paint0_linear_3760_84867"
      x1="32.59"
      y1="17.9741"
      x2="26.6427"
      y2="40.1696"
      gradientUnits="userSpaceOnUse"
    >
      <stop offset="0.578125" stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0" />
    </linearGradient>
    <linearGradient
      id="paint1_linear_3760_84867"
      x1="32.59"
      y1="17.9741"
      x2="26.6427"
      y2="40.1696"
      gradientUnits="userSpaceOnUse"
    >
      <stop offset="0.578125" stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0" />
    </linearGradient>
    <linearGradient
      id="paint2_linear_3760_84867"
      x1="29.2243"
      y1="18.4243"
      x2="29.2243"
      y2="41.4028"
      gradientUnits="userSpaceOnUse"
    >
      <stop offset="0.578125" stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0" />
    </linearGradient>
    <linearGradient
      id="paint3_linear_3760_84867"
      x1="29.2243"
      y1="18.4243"
      x2="29.2243"
      y2="41.4028"
      gradientUnits="userSpaceOnUse"
    >
      <stop offset="0.578125" stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0" />
    </linearGradient>
    <clipPath id="clip0_3760_84867">
      <rect
        width="51.4464"
        height="34.8252"
        rx="4.45209"
        transform="matrix(0.965926 0.258818 -0.25882 0.965926 12.7358 3.67603)"
        fill="white"
      />
    </clipPath>
    <clipPath id="clip1_3760_84867">
      <rect
        width="51.4464"
        height="34.8252"
        fill="white"
        transform="matrix(0.965926 0.258818 -0.25882 0.965926 12.7358 3.67603)"
      />
    </clipPath>
    <clipPath id="clip2_3760_84867">
      <rect
        x="5.67139"
        y="9.23267"
        width="52.5347"
        height="35.6167"
        rx="4.45209"
        fill="white"
      />
    </clipPath>
    <clipPath id="clip3_3760_84867">
      <rect
        width="51.4464"
        height="34.8252"
        fill="white"
        transform="translate(6.34619 9.75171)"
      />
    </clipPath>
  </defs>
</svg> `,V9=b` <svg
  width="24"
  height="25"
  viewBox="0 0 24 25"
  fill="currentColor"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M5 11.0498C4.17157 11.0498 3.5 11.7214 3.5 12.5498C3.5 13.3782 4.17157 14.0498 5 14.0498C5.82843 14.0498 6.5 13.3782 6.5 12.5498C6.5 11.7214 5.82843 11.0498 5 11.0498Z"
  />
  <path
    d="M12 11.0498C11.1716 11.0498 10.5 11.7214 10.5 12.5498C10.5 13.3782 11.1716 14.0498 12 14.0498C12.8284 14.0498 13.5 13.3782 13.5 12.5498C13.5 11.7214 12.8284 11.0498 12 11.0498Z"
  />
  <path
    d="M19 11.0498C18.1716 11.0498 17.5 11.7214 17.5 12.5498C17.5 13.3782 18.1716 14.0498 19 14.0498C19.8284 14.0498 20.5 13.3782 20.5 12.5498C20.5 11.7214 19.8284 11.0498 19 11.0498Z"
  />
</svg>`,VI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M4.16663 2.70898C3.82145 2.70898 3.54163 2.98881 3.54163 3.33398C3.54163 3.67916 3.82145 3.95898 4.16663 3.95898H15.8333C16.1785 3.95898 16.4583 3.67916 16.4583 3.33398C16.4583 2.98881 16.1785 2.70898 15.8333 2.70898H4.16663ZM10.625 16.6673C10.625 17.0125 10.3451 17.2923 9.99996 17.2923C9.65478 17.2923 9.37496 17.0125 9.37496 16.6673L9.37496 8.1762L7.10857 10.4426C6.86449 10.6867 6.46876 10.6867 6.22468 10.4426C5.98061 10.1985 5.98061 9.80279 6.22468 9.55871L9.55802 6.22538C9.67523 6.10817 9.8342 6.04232 9.99996 6.04232C10.1657 6.04232 10.3247 6.10817 10.4419 6.22538L13.7752 9.55871C14.0193 9.80279 14.0193 10.1985 13.7752 10.4426C13.5312 10.6867 13.1354 10.6867 12.8914 10.4426L10.625 8.1762L10.625 16.6673Z"
      fill="currentColor"
    />
  </svg>
`,zI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_33410)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M14.5894 9.16338C14.3351 9.39686 13.9398 9.38004 13.7063 9.12581L10.625 5.77057L10.625 15.8327C10.625 16.1779 10.3451 16.4577 9.99996 16.4577C9.65478 16.4577 9.37496 16.1779 9.37496 15.8327L9.37496 5.77057L6.29362 9.12581C6.06014 9.38004 5.66477 9.39686 5.41054 9.16338C5.1563 8.9299 5.13948 8.53453 5.37296 8.2803L9.53962 3.74326C9.65799 3.61438 9.82496 3.54102 9.99996 3.54102C10.1749 3.54102 10.3419 3.61438 10.4603 3.74326L14.627 8.2803C14.8604 8.53453 14.8436 8.9299 14.5894 9.16338Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_33410">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,jI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_42473)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M14.5894 10.8366C14.3351 10.6031 13.9398 10.62 13.7063 10.8742L10.625 14.2294L10.625 4.16732C10.625 3.82214 10.3451 3.54232 9.99996 3.54232C9.65478 3.54232 9.37496 3.82214 9.37496 4.16732L9.37496 14.2294L6.29362 10.8742C6.06014 10.62 5.66477 10.6031 5.41054 10.8366C5.1563 11.0701 5.13948 11.4655 5.37296 11.7197L9.53962 16.2567C9.65799 16.3856 9.82496 16.459 9.99996 16.459C10.1749 16.459 10.3419 16.3856 10.4603 16.2567L14.627 11.7197C14.8604 11.4655 14.8436 11.0701 14.5894 10.8366Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_42473">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,GI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_43486)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M10.625 3.33398C10.625 2.98881 10.3451 2.70898 9.99996 2.70898C9.65478 2.70898 9.37496 2.98881 9.37496 3.33398L9.37496 11.8251L7.10857 9.55871C6.86449 9.31463 6.46876 9.31463 6.22468 9.55871C5.98061 9.80279 5.98061 10.1985 6.22468 10.4426L9.55802 13.7759C9.67523 13.8931 9.8342 13.959 9.99996 13.959C10.1657 13.959 10.3247 13.8931 10.4419 13.7759L13.7752 10.4426C14.0193 10.1985 14.0193 9.80279 13.7752 9.55871C13.5312 9.31463 13.1354 9.31463 12.8914 9.55871L10.625 11.8251L10.625 3.33398ZM4.16663 16.0423C3.82145 16.0423 3.54163 16.3221 3.54163 16.6673C3.54163 17.0125 3.82145 17.2923 4.16663 17.2923H15.8333C16.1785 17.2923 16.4583 17.0125 16.4583 16.6673C16.4583 16.3221 16.1785 16.0423 15.8333 16.0423H4.16663Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_43486">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,z9=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_38897)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M2.70837 5.00065C2.70837 3.735 3.73439 2.70898 5.00004 2.70898H11.6667C12.9324 2.70898 13.9584 3.735 13.9584 5.00065V6.04232H15C16.2657 6.04232 17.2917 7.06833 17.2917 8.33398V15.0007C17.2917 16.2663 16.2657 17.2923 15 17.2923H8.33337C7.06772 17.2923 6.04171 16.2663 6.04171 15.0007V13.959H5.00004C3.73439 13.959 2.70837 12.933 2.70837 11.6673V5.00065ZM7.29171 15.0007C7.29171 15.5759 7.75808 16.0423 8.33337 16.0423H15C15.5753 16.0423 16.0417 15.5759 16.0417 15.0007V8.33398C16.0417 7.75869 15.5753 7.29232 15 7.29232H8.33337C7.75808 7.29232 7.29171 7.75869 7.29171 8.33398V15.0007ZM12.7084 6.04232H8.33337C7.06772 6.04232 6.04171 7.06833 6.04171 8.33398V12.709H5.00004C4.42474 12.709 3.95837 12.2426 3.95837 11.6673V5.00065C3.95837 4.42535 4.42474 3.95898 5.00004 3.95898H11.6667C12.242 3.95898 12.7084 4.42535 12.7084 5.00065V6.04232Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_38897">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,j9=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_42427)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M6.66671 1.875C5.40105 1.875 4.37504 2.90101 4.37504 4.16667V6.66667C4.37504 7.01184 4.65486 7.29167 5.00004 7.29167C5.34522 7.29167 5.62504 7.01184 5.62504 6.66667V4.16667C5.62504 3.59137 6.09141 3.125 6.66671 3.125H10.8334H12.9349C13.2563 3.125 13.5598 3.27341 13.7571 3.52714L15.8223 6.18232C15.9645 6.36517 16.0417 6.5902 16.0417 6.82185V10V15C16.0417 15.5753 15.5753 16.0417 15 16.0417H6.66671C6.09141 16.0417 5.62504 15.5753 5.62504 15V13.75C5.62504 13.4048 5.34522 13.125 5.00004 13.125C4.65486 13.125 4.37504 13.4048 4.37504 13.75V15C4.37504 16.2657 5.40105 17.2917 6.66671 17.2917H15C16.2657 17.2917 17.2917 16.2657 17.2917 15V10V6.82185C17.2917 6.31223 17.1218 5.81716 16.809 5.4149L14.7438 2.75972C14.3097 2.2015 13.6421 1.875 12.9349 1.875H10.8334H6.66671ZM2.32751 11.6024C2.32751 11.9491 2.5155 12.1444 2.84509 12.1444C3.17468 12.1444 3.36267 11.9491 3.36267 11.6024V11.1214H3.8656C4.68835 11.1214 5.24744 10.6209 5.24744 9.84456C5.24744 9.06087 4.72009 8.56038 3.9364 8.56038H2.84509C2.5155 8.56038 2.32751 8.7557 2.32751 9.10238V11.6024ZM3.6532 10.3573H3.36267V9.33919H3.66052C3.99744 9.33919 4.20251 9.51253 4.20251 9.847C4.20251 10.1839 3.99744 10.3573 3.6532 10.3573ZM5.61365 11.6317C5.61365 11.9637 5.79187 12.1444 6.10193 12.1444C6.40955 12.1444 6.59021 11.9637 6.59021 11.6317V10.2279H6.60974L7.81335 11.8612C7.95984 12.0614 8.099 12.1444 8.29675 12.1444C8.60437 12.1444 8.77283 11.9759 8.77283 11.6659V9.01204C8.77283 8.68001 8.5946 8.49935 8.28455 8.49935C7.97693 8.49935 7.79626 8.68001 7.79626 9.01204V10.3866H7.77673L6.58289 8.78255C6.43396 8.5848 6.28992 8.49935 6.10193 8.49935C5.78455 8.49935 5.61365 8.66536 5.61365 8.97786V11.6317ZM9.17566 10.3182C9.17566 11.4876 9.83728 12.1444 10.9554 12.1444C12.0052 12.1444 12.5863 11.4998 12.5863 10.6624C12.5863 10.3158 12.3983 10.1204 12.0687 10.1204H11.3876C11.1532 10.1204 11.0043 10.2425 11.0043 10.4647C11.0043 10.6868 11.1556 10.8089 11.3876 10.8089H11.5902L11.5853 10.8577C11.556 11.141 11.3168 11.3289 10.9799 11.3289C10.5258 11.3289 10.2303 10.9456 10.2303 10.3035C10.2303 9.67611 10.4891 9.31478 10.9286 9.31478C11.1776 9.31478 11.3461 9.40755 11.5121 9.62972C11.639 9.79818 11.7928 9.8763 11.9955 9.8763C12.2592 9.8763 12.4398 9.69808 12.4398 9.43929C12.4398 9.3514 12.4203 9.26839 12.369 9.17318C12.1615 8.80208 11.6293 8.49935 10.9237 8.49935C9.83728 8.49935 9.17566 9.16341 9.17566 10.3182Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_42427">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,G9=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_38947)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M5.00004 2.70898C3.73439 2.70898 2.70837 3.735 2.70837 5.00065V11.6673C2.70837 12.933 3.73439 13.959 5.00004 13.959H6.04171V15.0007C6.04171 16.2663 7.06772 17.2923 8.33337 17.2923H15C16.2657 17.2923 17.2917 16.2663 17.2917 15.0007V8.33398C17.2917 7.06833 16.2657 6.04232 15 6.04232H13.9584V5.00065C13.9584 3.735 12.9324 2.70898 11.6667 2.70898H5.00004ZM8.33337 6.04232H12.7084V5.00065C12.7084 4.42535 12.242 3.95898 11.6667 3.95898H5.00004C4.42474 3.95898 3.95837 4.42535 3.95837 5.00065V11.6673C3.95837 12.2426 4.42474 12.709 5.00004 12.709H6.66671C7.01189 12.709 7.29171 12.9888 7.29171 13.334V15.0007C7.29171 15.5759 7.75808 16.0423 8.33337 16.0423H15C15.5753 16.0423 16.0417 15.5759 16.0417 15.0007V8.33398C16.0417 7.75869 15.5753 7.29232 15 7.29232H13.3334H8.33337C7.88805 7.29232 7.50649 7.57205 7.35782 7.96752C7.23635 8.29062 6.87596 8.45408 6.55286 8.33261C6.22976 8.21114 6.0663 7.85075 6.18777 7.52765C6.51365 6.66078 7.3505 6.04232 8.33337 6.04232ZM10.7393 8.74146C10.5041 8.48881 10.1086 8.47466 9.85599 8.70986C9.60334 8.94505 9.58919 9.34052 9.82438 9.59317L10.3976 10.209H6.50003C6.15485 10.209 5.87503 10.4888 5.87503 10.834C5.87503 11.1792 6.15485 11.459 6.50003 11.459H10.3976L9.82438 12.0748C9.58919 12.3274 9.60334 12.7229 9.85599 12.9581C10.1086 13.1933 10.5041 13.1792 10.7393 12.9265L12.2908 11.2598C12.5142 11.0199 12.5142 10.6481 12.2908 10.4081L10.7393 8.74146Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_38947">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,h3=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_12840_42716)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M9.16667 1.875C7.90101 1.875 6.875 2.90101 6.875 4.16667V5.12492H3.33333C2.94213 5.12492 2.625 5.44205 2.625 5.83325C2.625 6.22445 2.94213 6.54159 3.33333 6.54159H3.59066L4.26602 15.9966C4.35168 17.1958 5.34957 18.125 6.55186 18.125H13.4481C14.6504 18.125 15.6483 17.1959 15.734 15.9966L16.4093 6.54159H16.6667C17.0579 6.54159 17.375 6.22445 17.375 5.83325C17.375 5.44205 17.0579 5.12492 16.6667 5.12492H13.125V4.16667C13.125 2.90101 12.099 1.875 10.8333 1.875H9.16667ZM11.875 5.12492V4.16667C11.875 3.59137 11.4086 3.125 10.8333 3.125H9.16667C8.59137 3.125 8.125 3.59137 8.125 4.16667V5.12492H11.875ZM15.1562 6.54159H4.84385L5.51285 15.9075C5.55178 16.4527 6.00537 16.875 6.55186 16.875H13.4481C13.9946 16.875 14.4482 16.4527 14.4872 15.9075L15.1562 6.54159ZM8.95833 9.16667C8.95833 8.82149 8.67851 8.54167 8.33333 8.54167C7.98815 8.54167 7.70833 8.82149 7.70833 9.16667V14.1667C7.70833 14.5118 7.98815 14.7917 8.33333 14.7917C8.67851 14.7917 8.95833 14.5118 8.95833 14.1667V9.16667ZM11.6667 8.54167C12.0118 8.54167 12.2917 8.82149 12.2917 9.16667V14.1667C12.2917 14.5118 12.0118 14.7917 11.6667 14.7917C11.3215 14.7917 11.0417 14.5118 11.0417 14.1667V9.16667C11.0417 8.82149 11.3215 8.54167 11.6667 8.54167Z"
        fill="currentColor"
      />
    </g>
    <defs>
      <clipPath id="clip0_12840_42716">
        <rect width="20" height="20" fill="white" />
      </clipPath>
    </defs>
  </svg>
`,Pi=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.31344 6.31295C4.5087 6.11769 4.82528 6.11769 5.02055 6.31295L7.76462 9.05703C7.8948 9.1872 8.10585 9.1872 8.23603 9.05703L10.9801 6.31295C11.1754 6.11769 11.492 6.11769 11.6872 6.31295C11.8825 6.50821 11.8825 6.8248 11.6872 7.02006L8.94313 9.76414C8.42244 10.2848 7.57822 10.2848 7.05752 9.76414L4.31344 7.02006C4.11818 6.8248 4.11818 6.50821 4.31344 6.31295Z"
    fill="currentColor"
  />
</svg>`,G1=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.39177 2.9553C3.6006 2.68046 3.9927 2.62696 4.26753 2.83579C9.95831 7.15993 14.1901 12.9846 15.8532 16.3578C16.0058 16.6674 15.8786 17.0421 15.569 17.1948C15.2594 17.3474 14.8847 17.2202 14.7321 16.9106C13.1515 13.7047 9.04214 8.0337 3.51127 3.83107C3.23644 3.62223 3.18293 3.23014 3.39177 2.9553Z"
  />
</svg> `,Z1=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.7244 3.19359C2.80201 2.85725 3.13759 2.64751 3.47393 2.72513C8.98708 3.99739 13.9297 6.80233 16.2292 8.68373C16.5303 8.93011 16.7797 9.18308 16.9343 9.44907C17.0965 9.72811 17.1885 10.0903 17.0251 10.4573C16.8794 10.7848 16.5897 10.972 16.3532 11.0832C16.1035 11.2007 15.8045 11.2839 15.4933 11.3483C14.8692 11.4775 14.0641 11.5565 13.211 11.6286C13.0041 11.646 12.7937 11.6632 12.5807 11.6805C11.8997 11.7359 11.1915 11.7936 10.4857 11.872C8.6165 12.0797 7.12382 12.3464 6.2104 12.666C5.84171 12.795 5.63227 12.9113 5.52734 12.9914C5.86905 13.3958 6.43971 13.7994 7.16558 14.1805C7.90858 14.5706 8.76171 14.9103 9.57823 15.191C10.3927 15.4709 11.1581 15.6879 11.7206 15.8349C12.0015 15.9083 12.2308 15.964 12.3891 16.0013C12.4683 16.0199 12.5296 16.0338 12.5708 16.043L12.617 16.0533L12.6281 16.0557L12.6306 16.0562C12.9681 16.1286 13.1835 16.4609 13.1112 16.7984C13.0389 17.1359 12.7066 17.3509 12.3691 17.2786L12.5001 16.6675C12.3691 17.2786 12.3692 17.2786 12.3691 17.2786L12.3674 17.2782L12.3635 17.2774L12.3495 17.2743L12.2975 17.2628C12.2524 17.2527 12.1868 17.2377 12.1032 17.2181C11.936 17.1788 11.6966 17.1206 11.4045 17.0443C10.8212 16.8918 10.0241 16.6661 9.17188 16.3731C8.32174 16.0809 7.40404 15.7175 6.58454 15.2872C5.77645 14.863 5.00904 14.3458 4.51201 13.7246C4.35483 13.5281 4.22952 13.2782 4.22579 12.9843C4.22198 12.6841 4.34606 12.4334 4.50705 12.2436C4.80009 11.8982 5.29046 11.6635 5.79762 11.4861C6.85378 11.1166 8.46695 10.8386 10.3477 10.6296C11.0736 10.549 11.8076 10.4892 12.492 10.4336C12.7018 10.4165 12.9069 10.3998 13.1057 10.383C13.9678 10.3102 14.7002 10.236 15.2399 10.1243C15.4794 10.0747 15.6554 10.0226 15.7766 9.97188C15.7097 9.89286 15.6027 9.78628 15.4376 9.65118C13.2821 7.88756 8.51304 5.17085 3.19285 3.94312C2.85651 3.8655 2.64678 3.52992 2.7244 3.19359Z"
  />
</svg> `,ZI=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
  fill="currentColor"
>
  <g clip-path="url(#clip0_12129_30774)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M9.99992 2.70898C10.2242 2.70898 10.4313 2.82916 10.5426 3.0239L13.5055 8.20908C13.6161 8.40252 13.6153 8.64018 13.5035 8.83287C13.3916 9.02557 13.1857 9.14417 12.9629 9.14417H7.03696C6.81416 9.14417 6.60821 9.02557 6.49639 8.83287C6.38456 8.64018 6.38377 8.40252 6.4943 8.20908L9.45727 3.0239C9.56854 2.82916 9.77563 2.70898 9.99992 2.70898ZM8.11394 7.89417H11.8859L9.99992 4.59371L8.11394 7.89417ZM5.92584 12.1071C4.83917 12.1071 3.95825 12.9881 3.95825 14.0747C3.95825 15.1614 4.83917 16.0423 5.92584 16.0423C7.01252 16.0423 7.89344 15.1614 7.89344 14.0747C7.89344 12.9881 7.01252 12.1071 5.92584 12.1071ZM2.70825 14.0747C2.70825 12.2977 4.14882 10.8571 5.92584 10.8571C7.70287 10.8571 9.14344 12.2977 9.14344 14.0747C9.14344 15.8518 7.70287 17.2923 5.92584 17.2923C4.14882 17.2923 2.70825 15.8518 2.70825 14.0747ZM10.8564 11.4821C10.8564 11.137 11.1362 10.8571 11.4814 10.8571H16.6666C17.0118 10.8571 17.2916 11.137 17.2916 11.4821V16.6673C17.2916 17.0125 17.0118 17.2923 16.6666 17.2923H11.4814C11.1362 17.2923 10.8564 17.0125 10.8564 16.6673V11.4821ZM12.1064 12.1071V16.0423H16.0416V12.1071H12.1064Z"
    />
  </g>
  <defs>
    <clipPath id="clip0_12129_30774">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg>`,ya=Ht`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.46967 6.46967C8.17678 6.76256 8.17678 7.23744 8.46967 7.53033L12.9393 12L8.46967 16.4697C8.17678 16.7626 8.17678 17.2374 8.46967 17.5303C8.76256 17.8232 9.23744 17.8232 9.53033 17.5303L14.5303 12.5303C14.8232 12.2374 14.8232 11.7626 14.5303 11.4697L9.53033 6.46967C9.23744 6.17678 8.76256 6.17678 8.46967 6.46967Z" fill="currentColor"/>
</svg>`,f8=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="currentColor"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.75 3.25C6.16421 3.25 6.5 3.58579 6.5 4V8.0315C6.57991 8.01094 6.66368 8 6.75 8H18.75C19.3023 8 19.75 8.44772 19.75 9V10C19.75 10.5523 19.3023 11 18.75 11H6.75C6.66368 11 6.57991 10.9891 6.5 10.9685V13.0315C6.57991 13.0109 6.66368 13 6.75 13H12.75C13.3023 13 13.75 13.4477 13.75 14V15C13.75 15.5523 13.3023 16 12.75 16H6.75C6.66368 16 6.57991 15.9891 6.5 15.9685V20C6.5 20.4142 6.16421 20.75 5.75 20.75C5.33579 20.75 5 20.4142 5 20V15V9V4C5 3.58579 5.33579 3.25 5.75 3.25Z"
    />
  </svg>
`,WI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M19 3.25C19.4142 3.25 19.75 3.58579 19.75 4V9V15V20C19.75 20.4142 19.4142 20.75 19 20.75C18.5858 20.75 18.25 20.4142 18.25 20V15.9685C18.1701 15.9891 18.0863 16 18 16H12C11.4477 16 11 15.5523 11 15V14C11 13.4477 11.4477 13 12 13H18C18.0863 13 18.1701 13.0109 18.25 13.0315V10.9685C18.1701 10.9891 18.0863 11 18 11H6C5.44772 11 5 10.5523 5 10V9C5 8.44771 5.44772 8 6 8H18C18.0863 8 18.1701 8.01094 18.25 8.0315V4C18.25 3.58579 18.5858 3.25 19 3.25Z"
      fill="#77757D"
    />
  </svg>
`,qI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12 3.25C12.4142 3.25 12.75 3.58579 12.75 4V8H18C18.5523 8 19 8.44772 19 9V10C19 10.5523 18.5523 11 18 11H12.75V13H15C15.5523 13 16 13.4477 16 14V15C16 15.5523 15.5523 16 15 16H12.75V20C12.75 20.4142 12.4142 20.75 12 20.75C11.5858 20.75 11.25 20.4142 11.25 20V16H9C8.44771 16 8 15.5523 8 15V14C8 13.4477 8.44771 13 9 13H11.25V11H6C5.44772 11 5 10.5523 5 10V9C5 8.44771 5.44772 8 6 8H11.25V4C11.25 3.58579 11.5858 3.25 12 3.25Z"
      fill="#77757D"
    />
  </svg>
`,YI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5 3.25C5.41421 3.25 5.75 3.58579 5.75 4V9V15V20C5.75 20.4142 5.41421 20.75 5 20.75C4.58579 20.75 4.25 20.4142 4.25 20V15V9V4C4.25 3.58579 4.58579 3.25 5 3.25ZM19 3.25C19.4142 3.25 19.75 3.58579 19.75 4V9V15V20C19.75 20.4142 19.4142 20.75 19 20.75C18.5858 20.75 18.25 20.4142 18.25 20V15V9V4C18.25 3.58579 18.5858 3.25 19 3.25ZM10.5 16C10.5 16.5523 10.9477 17 11.5 17H12.5C13.0523 17 13.5 16.5523 13.5 16V7C13.5 6.44772 13.0523 6 12.5 6H11.5C10.9477 6 10.5 6.44771 10.5 7V16Z"
      fill="#77757D"
    />
  </svg>
`,XI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M3 5.75C3 5.33579 3.33579 5 3.75 5H19.75C20.1642 5 20.5 5.33579 20.5 5.75C20.5 6.16421 20.1642 6.5 19.75 6.5H15.7185C15.7391 6.57991 15.75 6.66368 15.75 6.75L15.75 18.75C15.75 19.3023 15.3023 19.75 14.75 19.75H13.75C13.1977 19.75 12.75 19.3023 12.75 18.75L12.75 6.75C12.75 6.66368 12.7609 6.57991 12.7815 6.5H10.7185C10.7391 6.57991 10.75 6.66368 10.75 6.75V12.75C10.75 13.3023 10.3023 13.75 9.75 13.75H8.75C8.19771 13.75 7.75 13.3023 7.75 12.75L7.75 6.75C7.75 6.66368 7.76094 6.57991 7.7815 6.5H3.75C3.33579 6.5 3 6.16421 3 5.75Z"
      fill="#77757D"
    />
  </svg>
`,KI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M15 4C15.5523 4 16 4.44772 16 5L16 17C16 17.0863 15.9891 17.1701 15.9685 17.25H20C20.4142 17.25 20.75 17.5858 20.75 18C20.75 18.4142 20.4142 18.75 20 18.75H4C3.58579 18.75 3.25 18.4142 3.25 18C3.25 17.5858 3.58579 17.25 4 17.25H8.0315C8.01094 17.1701 8 17.0863 8 17L8 11C8 10.4477 8.44772 10 9 10H10C10.5523 10 11 10.4477 11 11V17C11 17.0863 10.9891 17.1701 10.9685 17.25H13.0315C13.0109 17.1701 13 17.0863 13 17L13 5C13 4.44772 13.4477 4 14 4H15Z"
      fill="#77757D"
    />
  </svg>
`,QI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M15 5C15.5523 5 16 5.44772 16 6V11.25H20C20.4142 11.25 20.75 11.5858 20.75 12C20.75 12.4142 20.4142 12.75 20 12.75H16V18C16 18.5523 15.5523 19 15 19H14C13.4477 19 13 18.5523 13 18V12.75H11V15C11 15.5523 10.5523 16 10 16H9C8.44771 16 8 15.5523 8 15V12.75H4C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25H8V9C8 8.44771 8.44772 8 9 8H10C10.5523 8 11 8.44771 11 9V11.25H13V6C13 5.44772 13.4477 5 14 5H15Z"
      fill="#77757D"
    />
  </svg>
`,JI=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M20.75 5C20.75 5.41421 20.4142 5.75 20 5.75L15 5.75L9 5.75L4 5.75C3.58579 5.75 3.25 5.41421 3.25 5C3.25 4.58579 3.58579 4.25 4 4.25H9H15H20C20.4142 4.25 20.75 4.58579 20.75 5ZM20.75 19C20.75 19.4142 20.4142 19.75 20 19.75H15L9 19.75H4C3.58579 19.75 3.25 19.4142 3.25 19C3.25 18.5858 3.58579 18.25 4 18.25H9L15 18.25H20C20.4142 18.25 20.75 18.5858 20.75 19ZM7.5 10.5C6.94772 10.5 6.5 10.9477 6.5 11.5V12.5C6.5 13.0523 6.94772 13.5 7.5 13.5H16.5C17.0523 13.5 17.5 13.0523 17.5 12.5V11.5C17.5 10.9477 17.0523 10.5 16.5 10.5H7.5Z"
      fill="#77757D"
    />
  </svg>
`,eL=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 26 28"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g filter="url(#filter0_d_13854_6171)">
      <path
        d="M4.0303 5.3021C3.7524 3.69583 5.44009 2.4703 6.88148 3.23168L20.3992 10.3721C21.9413 11.1867 21.7347 13.4578 20.0708 13.9806L14.5448 15.7171C14.1371 15.8452 13.7823 16.1029 13.5343 16.4511L10.1705 21.1742C9.1586 22.5951 6.93463 22.0889 6.63725 20.3701L4.0303 5.3021Z"
        fill="currentColor"
      />
      <path
        d="M4.52298 5.21686C4.31586 4.01972 5.57368 3.10633 6.64795 3.67379L20.1656 10.8142C21.315 11.4213 21.161 13.1139 19.9209 13.5036L14.3949 15.2401C13.8833 15.4009 13.4382 15.7242 13.1271 16.161L9.76325 20.8842C9.00907 21.9431 7.35156 21.5659 7.12993 20.2848L4.52298 5.21686Z"
        stroke="black"
        stroke-opacity="0.2"
      />
    </g>
    <defs>
      <filter
        id="filter0_d_13854_6171"
        x="-3"
        y="-2"
        width="32"
        height="32"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset dy="2" />
        <feGaussianBlur stdDeviation="2" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.28 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13854_6171"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13854_6171"
          result="shape"
        />
      </filter>
    </defs>
  </svg>
`,tL=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M14.25 6.5C14.25 4.70507 15.7051 3.25 17.5 3.25C19.2949 3.25 20.75 4.70507 20.75 6.5C20.75 8.29493 19.2949 9.75 17.5 9.75C16.89 9.75 16.3193 9.58196 15.8316 9.28964L9.28964 15.8316C9.58196 16.3193 9.75 16.89 9.75 17.5C9.75 19.2949 8.29493 20.75 6.5 20.75C4.70507 20.75 3.25 19.2949 3.25 17.5C3.25 15.7051 4.70507 14.25 6.5 14.25C7.14146 14.25 7.73952 14.4358 8.24327 14.7566L14.7566 8.24327C14.4358 7.73952 14.25 7.14146 14.25 6.5ZM17.5 4.75C16.5335 4.75 15.75 5.5335 15.75 6.5C15.75 7.4665 16.5335 8.25 17.5 8.25C18.4665 8.25 19.25 7.4665 19.25 6.5C19.25 5.5335 18.4665 4.75 17.5 4.75ZM6.5 15.75C5.5335 15.75 4.75 16.5335 4.75 17.5C4.75 18.4665 5.5335 19.25 6.5 19.25C7.4665 19.25 8.25 18.4665 8.25 17.5C8.25 16.5335 7.4665 15.75 6.5 15.75Z"
      fill="currentColor"
    />
  </svg>
`,nL=Ht`
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M9.68689 4.31313C9.88215 4.5084 9.88215 4.82498 9.68689 5.02024L6.70711 8.00002L9.68689 10.9798C9.88215 11.1751 9.88215 11.4916 9.68689 11.6869C9.49162 11.8822 9.17504 11.8822 8.97978 11.6869L5.64645 8.35357C5.45118 8.15831 5.45118 7.84173 5.64645 7.64647L8.97978 4.31313C9.17504 4.11787 9.49162 4.11787 9.68689 4.31313Z" fill="#77757D"/>
</svg>
`,iL=Ht`
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5.64661 4.31313C5.45135 4.5084 5.45135 4.82498 5.64661 5.02024L8.62639 8.00002L5.64661 10.9798C5.45135 11.1751 5.45135 11.4916 5.64661 11.6869C5.84187 11.8822 6.15845 11.8822 6.35372 11.6869L9.68705 8.35357C9.88231 8.15831 9.88231 7.84173 9.68705 7.64647L6.35372 4.31313C6.15845 4.11787 5.84187 4.11787 5.64661 4.31313Z" fill="#77757D"/>
</svg>

`,mX=Ht`
  <svg 
    width="20" 
    height="20" 
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path 
      fill-rule="evenodd" 
      clip-rule="evenodd" 
      d="M7.9965 3.45031C8.50641 1.3499 11.4936 1.3499 12.0035 3.45031C12.1332 3.9845 12.7452 4.23801 13.2146 3.95198C15.0604 2.82733 17.1727 4.93958 16.048 6.78536C15.762 7.25479 16.0155 7.86681 16.5497 7.9965C18.6501 8.50641 18.6501 11.4936 16.5497 12.0035C16.0155 12.1332 15.762 12.7452 16.048 13.2146C17.1727 15.0604 15.0604 17.1727 13.2146 16.048C12.7452 15.762 12.1332 16.0155 12.0035 16.5497C11.4936 18.6501 8.50641 18.6501 7.9965 16.5497C7.86681 16.0155 7.25479 15.762 6.78536 16.048C4.93958 17.1727 2.82733 15.0604 3.95198 13.2146C4.23801 12.7452 3.9845 12.1332 3.45031 12.0035C1.3499 11.4936 1.3499 8.50641 3.45031 7.9965C3.9845 7.86681 4.23801 7.25479 3.95198 6.78536C2.82733 4.93958 4.93958 2.82733 6.78536 3.95198C7.25479 4.23801 7.86681 3.9845 7.9965 3.45031ZM10.7888 3.74521C10.588 2.91826 9.41197 2.91827 9.21121 3.7452C8.88182 5.10205 7.3273 5.74595 6.13495 5.01944C5.40826 4.57666 4.57666 5.40826 5.01944 6.13495C5.74595 7.3273 5.10205 8.88182 3.7452 9.21121C2.91827 9.41197 2.91826 10.588 3.74521 10.7888C5.10205 11.1182 5.74595 12.6727 5.01944 13.8651C4.57666 14.5917 5.40826 15.4233 6.13495 14.9806C7.3273 14.2541 8.88182 14.898 9.21121 16.2548C9.41197 17.0817 10.588 17.0817 10.7888 16.2548C11.1182 14.898 12.6727 14.2541 13.8651 14.9806C14.5917 15.4233 15.4233 14.5917 14.9806 13.8651C14.2541 12.6727 14.898 11.1182 16.2548 10.7888C17.0817 10.588 17.0817 9.41197 16.2548 9.21121C14.898 8.88182 14.2541 7.3273 14.9806 6.13495C15.4233 5.40826 14.5917 4.57666 13.8651 5.01944C12.6727 5.74595 11.1182 5.10205 10.7888 3.74521ZM10 8.125C8.96447 8.125 8.125 8.96447 8.125 10C8.125 11.0355 8.96447 11.875 10 11.875C11.0355 11.875 11.875 11.0355 11.875 10C11.875 8.96447 11.0355 8.125 10 8.125ZM6.875 10C6.875 8.27411 8.27411 6.875 10 6.875C11.7259 6.875 13.125 8.27411 13.125 10C13.125 11.7259 11.7259 13.125 10 13.125C8.27411 13.125 6.875 11.7259 6.875 10Z"
      fill="currentColor"
      />
  </svg>
`,rL=b`<svg
  width="34"
  height="29"
  viewBox="0 0 34 29"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M3 14.4292L16.8345 18.9019C17.0345 18.9665 17.2498 18.9665 17.4498 18.9019L31.2843 14.4292"
    stroke="black"
    stroke-opacity="0.3"
    stroke-width="5"
    stroke-linecap="round"
  />
</svg>`,g8=Ht`
  <svg 
    width="20" 
    height="20" 
    viewBox="0 0 20 20" 
    xmlns="http://www.w3.org/2000/svg"
  >
    <path 
      fill-rule="evenodd" 
      clip-rule="evenodd" 
      d="M5.97361 3.9585C5.11378 3.9585 4.41675 4.65553 4.41675 5.51536C4.41675 6.37519 5.11378 7.07222 5.97361 7.07222C6.83344 7.07222 7.53047 6.37519 7.53047 5.51536C7.53047 4.65553 6.83344 3.9585 5.97361 3.9585ZM3.16675 5.51536C3.16675 3.96517 4.42342 2.7085 5.97361 2.7085C7.46041 2.7085 8.67721 3.8645 8.77424 5.32674C9.47625 5.32742 10.1504 5.3384 10.8518 5.50781C11.6295 5.69568 12.4061 6.06747 13.3306 6.76082L13.3476 6.77356L13.3637 6.78743C14.6691 7.91276 15.3225 9.73181 15.3261 11.4359H16.7085C17.0536 11.4359 17.3335 11.7157 17.3335 12.0609V15.9883C17.3335 16.3334 17.0536 16.6133 16.7085 16.6133H12.7811C12.4359 16.6133 12.1561 16.3334 12.1561 15.9883V12.0609C12.1561 11.7157 12.4359 11.4359 12.7811 11.4359H14.0761C14.0724 10.0149 13.523 8.58544 12.5631 7.74773C11.7507 7.14103 11.1313 6.86129 10.5583 6.72287C9.96522 6.57962 9.38587 6.5767 8.59186 6.5767V6.52901C8.25859 7.38925 7.51359 8.04431 6.59865 8.25237V11.5058C7.84798 11.7899 8.78047 12.9074 8.78047 14.2428C8.78047 15.793 7.5238 17.0496 5.97361 17.0496C4.42342 17.0496 3.16675 15.793 3.16675 14.2428C3.16675 12.9074 4.09928 11.7898 5.34865 11.5057V8.25239C4.09928 7.96831 3.16675 6.85074 3.16675 5.51536ZM5.97361 12.6859C5.11378 12.6859 4.41675 13.3829 4.41675 14.2428C4.41675 15.1026 5.11378 15.7996 5.97361 15.7996C6.83344 15.7996 7.53047 15.1026 7.53047 14.2428C7.53047 13.3829 6.83344 12.6859 5.97361 12.6859ZM13.4061 15.3633V12.6859H16.0835V15.3633H13.4061Z"
      fill="currentColor"
      />
  </svg>
`,m8=Ht`
  <svg 
    width="20" 
    height="20" 
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.83341 2.7085C4.56776 2.7085 3.54175 3.73451 3.54175 5.00016V15.0002C3.54175 16.2658 4.56776 17.2918 5.83341 17.2918H14.1667C15.4324 17.2918 16.4584 16.2658 16.4584 15.0002V5.00016C16.4584 3.73451 15.4324 2.7085 14.1667 2.7085H5.83341ZM4.79175 5.00016C4.79175 4.42487 5.25812 3.9585 5.83341 3.9585H14.1667C14.742 3.9585 15.2084 4.42487 15.2084 5.00016V15.0002C15.2084 15.5755 14.742 16.0418 14.1667 16.0418H5.83341C5.25812 16.0418 4.79175 15.5755 4.79175 15.0002V5.00016ZM7.50008 6.04183C7.1549 6.04183 6.87508 6.32165 6.87508 6.66683C6.87508 7.01201 7.1549 7.29183 7.50008 7.29183H10.4167C10.7619 7.29183 11.0417 7.01201 11.0417 6.66683C11.0417 6.32165 10.7619 6.04183 10.4167 6.04183H7.50008ZM6.87508 9.5835C6.87508 9.23832 7.1549 8.9585 7.50008 8.9585H12.5001C12.8453 8.9585 13.1251 9.23832 13.1251 9.5835C13.1251 9.92867 12.8453 10.2085 12.5001 10.2085H7.50008C7.1549 10.2085 6.87508 9.92867 6.87508 9.5835ZM7.50008 11.8752C7.1549 11.8752 6.87508 12.155 6.87508 12.5002C6.87508 12.8453 7.1549 13.1252 7.50008 13.1252H11.6667C12.0119 13.1252 12.2917 12.8453 12.2917 12.5002C12.2917 12.155 12.0119 11.8752 11.6667 11.8752H7.50008Z"
      fill="currentColor"
      />
  </svg>
`,Z9=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M5.46967 5.46967C5.76256 5.17678 6.23744 5.17678 6.53033 5.46967L12 10.9393L17.4697 5.46967C17.7626 5.17678 18.2374 5.17678 18.5303 5.46967C18.8232 5.76256 18.8232 6.23744 18.5303 6.53033L13.0607 12L18.5303 17.4697C18.8232 17.7626 18.8232 18.2374 18.5303 18.5303C18.2374 18.8232 17.7626 18.8232 17.4697 18.5303L12 13.0607L6.53033 18.5303C6.23744 18.8232 5.76256 18.8232 5.46967 18.5303C5.17678 18.2374 5.17678 17.7626 5.46967 17.4697L10.9393 12L5.46967 6.53033C5.17678 6.23744 5.17678 5.76256 5.46967 5.46967Z"
      fill="currentColor"
    />
  </svg>
`,oL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8 2.25C6.48122 2.25 5.25 3.48122 5.25 5V8C5.25 8.41421 5.58579 8.75 6 8.75C6.41421 8.75 6.75 8.41421 6.75 8V5C6.75 4.30964 7.30964 3.75 8 3.75H13H15.5218C15.9076 3.75 16.2717 3.92809 16.5085 4.23257L18.9867 7.41879C19.1573 7.63821 19.25 7.90825 19.25 8.18622V12V18C19.25 18.6904 18.6904 19.25 18 19.25H8C7.30964 19.25 6.75 18.6904 6.75 18V16.5C6.75 16.0858 6.41421 15.75 6 15.75C5.58579 15.75 5.25 16.0858 5.25 16.5V18C5.25 19.5188 6.48122 20.75 8 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V12V8.18622C20.75 7.57468 20.5462 6.98059 20.1707 6.49788L17.6926 3.31166C17.1715 2.6418 16.3705 2.25 15.5218 2.25H13H8ZM2.76855 13.8408C2.76855 14.1765 2.94849 14.3672 3.26538 14.3672C3.58228 14.3672 3.76221 14.1765 3.76221 13.8408V12.0549H3.78369L4.55444 13.9966C4.62964 14.1899 4.76123 14.2812 4.96533 14.2812C5.16675 14.2812 5.29028 14.1926 5.36816 13.9966L6.13892 12.0549H6.1604V13.8408C6.1604 14.1765 6.34033 14.3672 6.65723 14.3672C6.97412 14.3672 7.15405 14.1765 7.15405 13.8408V11.1042C7.15405 10.6262 6.89087 10.3577 6.41553 10.3577C6.01538 10.3577 5.80322 10.5161 5.64209 10.9377L4.97339 12.686H4.9519L4.28052 10.9377C4.11938 10.5161 3.90723 10.3577 3.50708 10.3577C3.03174 10.3577 2.76855 10.6262 2.76855 11.1042V13.8408ZM7.69385 13.7039C7.69385 14.0852 7.90063 14.3 8.26318 14.3H9.35083C10.5244 14.3 11.2173 13.575 11.2173 12.3342C11.2173 11.0935 10.5271 10.4248 9.35083 10.4248H8.26318C7.90063 10.4248 7.69385 10.6396 7.69385 11.021V13.7039ZM9.1897 13.395H8.83252V11.3298H9.1897C9.73486 11.3298 10.0571 11.6816 10.0571 12.3342C10.0571 13.0486 9.75903 13.395 9.1897 13.395Z"
    fill="currentColor"
  />
</svg> `,sL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8 2.25C6.48122 2.25 5.25 3.48122 5.25 5V8C5.25 8.41421 5.58579 8.75 6 8.75C6.41421 8.75 6.75 8.41421 6.75 8V5C6.75 4.30964 7.30964 3.75 8 3.75H15.5218C15.9076 3.75 16.2717 3.92809 16.5085 4.23257L18.9867 7.41879C19.1573 7.63821 19.25 7.90825 19.25 8.18622V18C19.25 18.6904 18.6904 19.25 18 19.25H8C7.30964 19.25 6.75 18.6904 6.75 18V16.5C6.75 16.0858 6.41421 15.75 6 15.75C5.58579 15.75 5.25 16.0858 5.25 16.5V18C5.25 19.5188 6.48122 20.75 8 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V8.18622C20.75 7.57468 20.5462 6.98059 20.1707 6.49788L17.6926 3.31166C17.1715 2.6418 16.3705 2.25 15.5218 2.25H8ZM2.76855 13.771C2.76855 14.1523 2.97534 14.3672 3.33789 14.3672C3.70044 14.3672 3.90723 14.1523 3.90723 13.771V12.8015H5.27148V13.771C5.27148 14.1523 5.47827 14.3672 5.84082 14.3672C6.20337 14.3672 6.41016 14.1523 6.41016 13.771V10.9539C6.41016 10.5725 6.20337 10.3577 5.84082 10.3577C5.47827 10.3577 5.27148 10.5725 5.27148 10.9539V11.8965H3.90723V10.9539C3.90723 10.5725 3.70044 10.3577 3.33789 10.3577C2.97534 10.3577 2.76855 10.5725 2.76855 10.9539V13.771ZM7.82007 13.771C7.82007 14.1523 8.02686 14.3672 8.3894 14.3672C8.75195 14.3672 8.95874 14.1523 8.95874 13.771V11.3325H9.53076C9.83154 11.3325 10.033 11.1687 10.033 10.8787C10.033 10.5886 9.83691 10.4248 9.53076 10.4248H7.24805C6.94189 10.4248 6.74585 10.5886 6.74585 10.8787C6.74585 11.1687 6.94727 11.3325 7.24805 11.3325H7.82007V13.771ZM10.8655 14.3672C10.5486 14.3672 10.3687 14.1765 10.3687 13.8408V11.1042C10.3687 10.6262 10.6318 10.3577 11.1072 10.3577C11.5073 10.3577 11.7195 10.5161 11.8806 10.9377L12.552 12.686H12.5735L13.2422 10.9377C13.4033 10.5161 13.6155 10.3577 14.0156 10.3577C14.491 10.3577 14.7542 10.6262 14.7542 11.1042V13.8408C14.7542 14.1765 14.5742 14.3672 14.2573 14.3672C13.9404 14.3672 13.7605 14.1765 13.7605 13.8408V12.0549H13.739L12.9683 13.9966C12.8904 14.1926 12.7668 14.2812 12.5654 14.2812C12.3613 14.2812 12.2297 14.1899 12.1545 13.9966L11.3838 12.0549H11.3623V13.8408C11.3623 14.1765 11.1824 14.3672 10.8655 14.3672ZM15.2939 13.7039C15.2939 14.0852 15.5007 14.3 15.8633 14.3H17.5042C17.8103 14.3 18.0063 14.1362 18.0063 13.8462C18.0063 13.5562 17.8049 13.3923 17.5042 13.3923H16.4326V10.9539C16.4326 10.5725 16.2258 10.3577 15.8633 10.3577C15.5007 10.3577 15.2939 10.5725 15.2939 10.9539V13.7039Z"
    fill="currentColor"
  />
</svg> `,aL=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M6.26795 6.19873C6.83575 6.65959 7.04771 6.62458 8.11333 6.55361L18.1589 5.9508C18.3728 5.9508 18.1949 5.7369 18.1239 5.70189L16.4555 4.49627C16.1356 4.24834 15.7097 3.96346 14.894 4.03444L5.16636 4.7442C4.81245 4.7792 4.74147 4.95713 4.88245 5.09908L6.26795 6.19873ZM6.87076 8.53997V19.1086C6.87076 19.6774 7.15466 19.8893 7.79442 19.8543L18.8336 19.2156C19.4724 19.1806 19.5434 18.7897 19.5434 18.3288V7.83021C19.5434 7.36935 19.3664 7.12044 18.9756 7.15642L7.43857 7.83021C7.01271 7.86521 6.87076 8.07814 6.87076 8.53997ZM17.77 9.1068C17.84 9.42571 17.77 9.74559 17.4491 9.78156L16.9173 9.88754V17.6901C16.4555 17.939 16.0296 18.0809 15.6747 18.0809C15.1069 18.0809 14.965 17.903 14.5391 17.3712L11.0593 11.9089V17.1942L12.1609 17.4421C12.1609 17.4421 12.1609 18.0809 11.2723 18.0809L8.82309 18.2229C8.75211 18.0809 8.82309 17.727 9.07199 17.6551L9.71078 17.4781V10.4904L8.82309 10.4194C8.75211 10.0995 8.93004 9.63864 9.42687 9.60267L12.054 9.42668L15.6747 14.9589V10.0655L14.7511 9.95949C14.6811 9.56864 14.965 9.2857 15.3198 9.24973L17.77 9.1068ZM4.34964 3.78651L14.4672 3.04175C15.7087 2.9348 16.0286 3.00674 16.8103 3.57358L20.0393 5.84385C20.5721 6.23373 20.75 6.33971 20.75 6.76556V19.2156C20.75 19.9963 20.4661 20.4572 19.4724 20.5281L7.72247 21.2379C6.97673 21.2729 6.62185 21.1669 6.231 20.6701L3.85281 17.5841C3.42695 17.0163 3.25 16.5914 3.25 16.0936V5.02811C3.25 4.38932 3.53293 3.85749 4.34964 3.78651Z"
      fill="currentColor"
    />
  </svg>
`,lL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M7.43531 5.11765C7.43531 3.53389 8.7192 2.25 10.303 2.25C11.1416 2.25 11.8962 2.61004 12.4206 3.18398C12.945 2.61004 13.6996 2.25 14.5382 2.25C16.122 2.25 17.4059 3.53389 17.4059 5.11765C17.4059 5.61288 17.2804 6.07879 17.0594 6.48529H19.8912C20.8577 6.48529 21.6412 7.2688 21.6412 8.23529V10.4706C21.6412 11.1916 21.2051 11.8108 20.5824 12.0788V19C20.5824 20.5188 19.3511 21.75 17.8324 21.75H7.00884C5.49006 21.75 4.25884 20.5188 4.25884 19V12.0788C3.63606 11.8108 3.20001 11.1916 3.20001 10.4706V8.2353C3.20001 7.2688 3.98351 6.48529 4.95001 6.48529H7.78183C7.56084 6.07879 7.43531 5.61288 7.43531 5.11765ZM10.303 6.48529H11.6706V5.11765C11.6706 4.36232 11.0583 3.75 10.303 3.75C9.54762 3.75 8.93531 4.36232 8.93531 5.11765C8.93531 5.87298 9.54762 6.48529 10.303 6.48529ZM13.1706 5.11765V6.48529H14.5382C15.2936 6.48529 15.9059 5.87298 15.9059 5.11765C15.9059 4.36232 15.2936 3.75 14.5382 3.75C13.7829 3.75 13.1706 4.36232 13.1706 5.11765ZM4.95001 7.98529C4.81194 7.98529 4.70001 8.09722 4.70001 8.2353V10.4706C4.70001 10.6087 4.81194 10.7206 4.95001 10.7206H19.8912C20.0293 10.7206 20.1412 10.6087 20.1412 10.4706V8.23529C20.1412 8.09722 20.0293 7.98529 19.8912 7.98529H4.95001ZM5.75884 12.2206V19C5.75884 19.6904 6.31848 20.25 7.00884 20.25H11.6706V12.2206H5.75884ZM13.1706 12.2206V20.25H17.8324C18.5227 20.25 19.0824 19.6904 19.0824 19V12.2206H13.1706Z"
    fill="currentColor"
  />
</svg>`,cL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.75 12C3.75 7.44365 7.44365 3.75 12 3.75C16.5563 3.75 20.25 7.44365 20.25 12C20.25 16.5563 16.5563 20.25 12 20.25C7.44365 20.25 3.75 16.5563 3.75 12ZM12 2.25C6.61522 2.25 2.25 6.61522 2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25ZM12.2385 10.9834C11.3157 11.708 10.9944 12.166 10.9944 12.9727C10.9944 13.4102 11.2678 13.7383 11.7668 13.7383C12.2454 13.7383 12.4231 13.4648 12.594 13.0615C12.7512 12.4873 12.9768 12.248 13.6399 11.7422C14.5149 11.0928 15.0959 10.5117 15.0959 9.45215C15.0959 7.92773 13.845 6.99121 12.0471 6.99121C11.0764 6.99121 10.3313 7.24414 9.83228 7.66797C9.42212 8.03027 9.15552 8.50879 9.15552 8.95996C9.15552 9.33594 9.39478 9.64355 9.82544 9.64355C10.1125 9.64355 10.2766 9.51367 10.4885 9.2334C10.8167 8.67285 11.2678 8.41992 11.9241 8.41992C12.676 8.41992 13.2708 8.86426 13.2708 9.53418C13.2708 10.1357 12.9016 10.4639 12.2385 10.9834ZM11.7668 14.709C11.1995 14.709 10.7346 15.1055 10.7346 15.6729C10.7346 16.2402 11.1995 16.6367 11.7668 16.6367C12.3342 16.6367 12.8059 16.2402 12.8059 15.6729C12.8059 15.1055 12.3342 14.709 11.7668 14.709Z"
    fill="currentColor"
  />
</svg> `,dL=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M12 3.25C12.4142 3.25 12.75 3.58579 12.75 4L12.75 14.1893L15.4697 11.4697C15.7626 11.1768 16.2374 11.1768 16.5303 11.4697C16.8232 11.7626 16.8232 12.2374 16.5303 12.5303L12.5303 16.5303C12.2374 16.8232 11.7626 16.8232 11.4697 16.5303L7.46967 12.5303C7.17678 12.2374 7.17678 11.7626 7.46967 11.4697C7.76256 11.1768 8.23744 11.1768 8.53033 11.4697L11.25 14.1893L11.25 4C11.25 3.58579 11.5858 3.25 12 3.25ZM4 15.25C4.41421 15.25 4.75 15.5858 4.75 16V17C4.75 18.2426 5.75736 19.25 7 19.25H17C18.2426 19.25 19.25 18.2426 19.25 17V16C19.25 15.5858 19.5858 15.25 20 15.25C20.4142 15.25 20.75 15.5858 20.75 16V17C20.75 19.0711 19.0711 20.75 17 20.75H7C4.92893 20.75 3.25 19.0711 3.25 17V16C3.25 15.5858 3.58579 15.25 4 15.25Z"
      fill="currentColor"
    />
  </svg>
`;function p3(t,e=20){const n=e/16,i=`
    width: ${n}em;
    height: ${n}em;
    vertical-align: middle;
    font-size: inherit;
    margin-bottom: 0.1em;
  `;return b`<svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
    style=${i}
  >
    ${t}
  </svg>`}function rn(t,e=24){return b`<svg
    width="${e}"
    height="${e}"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    ${t}
  </svg>`}const bX=Ht`<path fill-rule="evenodd" clip-rule="evenodd" d="M8.26257 2.48082C7.85697 2.49584 7.54034 2.83683 7.55536 3.24243C7.57038 3.64803 7.91137 3.96466 8.31697 3.94964L12.5926 3.79128C12.9329 3.77867 13.2632 3.90835 13.504 4.14919L19.8106 10.4558C20.0976 10.7428 20.5629 10.7428 20.8499 10.4558C21.1369 10.1688 21.1369 9.70348 20.8499 9.41648L14.5433 3.10987C14.0135 2.58003 13.287 2.29473 12.5382 2.32247L8.26257 2.48082ZM7.72668 6.72224C6.0604 6.78396 4.72384 8.12053 4.66212 9.7868L4.53585 13.1963C4.52324 13.5366 4.65292 13.8669 4.89376 14.1077L10.5116 19.7256C10.99 20.2039 11.7655 20.2039 12.2438 19.7256L17.6655 14.304C18.1438 13.8256 18.1438 13.0501 17.6655 12.5718L12.0476 6.95388C11.8068 6.71304 11.4765 6.58336 11.1362 6.59597L7.72668 6.72224ZM3.19331 9.7324C3.28351 7.29707 5.23695 5.34363 7.67228 5.25343L11.0818 5.12716C11.8305 5.09942 12.5571 5.38472 13.0869 5.91456L18.7048 11.5324C19.7571 12.5848 19.7571 14.2909 18.7048 15.3433L13.2832 20.7649C12.2308 21.8173 10.5246 21.8173 9.47232 20.7649L3.85444 15.147C3.3246 14.6172 3.0393 13.8907 3.06703 13.1419L3.19331 9.7324ZM7.8664 8.75593C8.18961 9.07914 8.18961 9.60317 7.8664 9.92638C7.54319 10.2496 7.01916 10.2496 6.69595 9.92638C6.37274 9.60317 6.37274 9.07914 6.69595 8.75593C7.01916 8.43272 7.54319 8.43272 7.8664 8.75593Z" fill="currentColor"/>`,t5=rn(bX,16),uL=Ht`<path fill-rule="evenodd" clip-rule="evenodd" d="M3.25 4C3.25 3.58579 3.58579 3.25 4 3.25H20C20.4142 3.25 20.75 3.58579 20.75 4V6.66667C20.75 7.08088 20.4142 7.41667 20 7.41667C19.5858 7.41667 19.25 7.08088 19.25 6.66667V4.75H12.75V19.25H16C16.4142 19.25 16.75 19.5858 16.75 20C16.75 20.4142 16.4142 20.75 16 20.75H8C7.58579 20.75 7.25 20.4142 7.25 20C7.25 19.5858 7.58579 19.25 8 19.25H11.25V4.75H4.75V6.66667C4.75 7.08088 4.41421 7.41667 4 7.41667C3.58579 7.41667 3.25 7.08088 3.25 6.66667V4Z" fill="currentColor"/>`,h0=rn(uL,20),vX=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.84088 5.25C2.42667 5.25 2.09088 5.58579 2.09088 6V8C2.09088 8.41421 2.42667 8.75 2.84088 8.75C3.25509 8.75 3.59088 8.41421 3.59088 8V6.75H6.99997V17.25H5.0227C4.60849 17.25 4.2727 17.5858 4.2727 18C4.2727 18.4142 4.60849 18.75 5.0227 18.75H7.74997H10.4772C10.8915 18.75 11.2272 18.4142 11.2272 18C11.2272 17.5858 10.8915 17.25 10.4772 17.25H8.49997V6.75H11.9091V8C11.9091 8.41421 12.2449 8.75 12.6591 8.75C13.0733 8.75 13.4091 8.41421 13.4091 8V6C13.4091 5.58579 13.0733 5.25 12.6591 5.25H7.74997H2.84088ZM15.6045 5.25C15.1903 5.25 14.8545 5.58579 14.8545 6C14.8545 6.41421 15.1903 6.75 15.6045 6.75H21.059C21.4733 6.75 21.809 6.41421 21.809 6C21.809 5.58579 21.4733 5.25 21.059 5.25H15.6045ZM14.8545 12C14.8545 11.5858 15.1903 11.25 15.6045 11.25H21.059C21.4733 11.25 21.809 11.5858 21.809 12C21.809 12.4142 21.4733 12.75 21.059 12.75H15.6045C15.1903 12.75 14.8545 12.4142 14.8545 12ZM15.6045 17.25C15.1903 17.25 14.8545 17.5858 14.8545 18C14.8545 18.4142 15.1903 18.75 15.6045 18.75H21.059C21.4733 18.75 21.809 18.4142 21.809 18C21.809 17.5858 21.4733 17.25 21.059 17.25H15.6045Z"
    fill="currentColor"
  />
</svg> `,hL=rn(uL),W9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M17.9256 6.5784V17.4764C17.9256 18.078 18.2564 18.4389 18.7878 18.4389C19.3292 18.4389 19.65 18.088 19.65 17.4764V5.72621C19.65 5.04445 19.1988 4.57324 18.5572 4.57324C18.1662 4.57324 17.8153 4.72363 17.1836 5.19484L15.1584 6.69871C14.7574 6.98946 14.5669 7.26016 14.5669 7.55091C14.5669 7.93189 14.8677 8.24269 15.2386 8.24269C15.4592 8.24269 15.6697 8.16248 15.9605 7.95194L17.8453 6.5784H17.9256ZM4.41998 4.90259C4.84523 4.90259 5.18996 5.24732 5.18996 5.67257V11.0239H11.3584V5.67257C11.3584 5.24732 11.7031 4.90259 12.1284 4.90259C12.5536 4.90259 12.8983 5.24732 12.8983 5.67257V11.7939V17.9153C12.8983 18.3405 12.5536 18.6853 12.1284 18.6853C11.7031 18.6853 11.3584 18.3405 11.3584 17.9153V12.5639H5.18996V17.9153C5.18996 18.3405 4.84523 18.6853 4.41998 18.6853C3.99473 18.6853 3.64999 18.3405 3.64999 17.9153V5.67257C3.64999 5.24732 3.99473 4.90259 4.41998 4.90259Z"
  />
</svg>`,q9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M14.1588 15.9996C13.5966 16.6381 13.4346 16.9049 13.4346 17.2479C13.4346 17.8006 13.873 18.1342 14.5686 18.1342H20.8578C21.3819 18.1342 21.6869 17.8578 21.6869 17.4099C21.6869 16.9525 21.3629 16.6762 20.8578 16.6762H15.5691V16.5618L19.0949 12.531C20.8102 10.5775 21.2962 9.67223 21.2962 8.43344C21.2962 6.33702 19.6476 4.85046 17.3035 4.85046C14.7878 4.85046 13.2154 6.54666 13.2154 8.16662C13.2154 8.6812 13.5204 9.03378 13.9873 9.03378C14.378 9.03378 14.6448 8.77649 14.7782 8.27144C15.0641 7.03265 15.9694 6.2989 17.1986 6.2989C18.6471 6.2989 19.6095 7.19464 19.6095 8.53826C19.6095 9.434 19.1998 10.2345 18.123 11.4637L14.1588 15.9996ZM3.41871 5.36361C3.82289 5.36361 4.15055 5.69127 4.15055 6.09545V11.1818H10.0134V6.09545C10.0134 5.69127 10.341 5.36361 10.7452 5.36361C11.1494 5.36361 11.4771 5.69127 11.4771 6.09545V11.9136V17.7317C11.4771 18.1359 11.1494 18.4636 10.7452 18.4636C10.341 18.4636 10.0134 18.1359 10.0134 17.7317V12.6454H4.15055V17.7317C4.15055 18.1359 3.82289 18.4636 3.41871 18.4636C3.01452 18.4636 2.68687 18.1359 2.68687 17.7317V6.09545C2.68687 5.69127 3.01452 5.36361 3.41871 5.36361Z"
  />
</svg>`,Y9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M4.04957 5.85587C4.04957 5.44177 3.71388 5.10608 3.29979 5.10608C2.88569 5.10608 2.55 5.44177 2.55 5.85587V17.7775C2.55 18.1916 2.88569 18.5273 3.29979 18.5273C3.71388 18.5273 4.04957 18.1916 4.04957 17.7775V12.5665H10.0562V17.7775C10.0562 18.1916 10.3919 18.5273 10.806 18.5273C11.2201 18.5273 11.5558 18.1916 11.5558 17.7775V11.8167V5.85587C11.5558 5.44177 11.2201 5.10608 10.806 5.10608C10.3919 5.10608 10.0562 5.44177 10.0562 5.85587V11.0669H4.04957V5.85587ZM13.5289 15.0901C13.1108 15.0901 12.8162 15.3942 12.8162 15.8218C12.8162 17.2759 14.6124 18.7585 17.0643 18.7585C19.7063 18.7585 21.55 17.1999 21.55 14.976C21.55 13.3414 20.324 11.9349 18.7179 11.7543V11.6592C20.0389 11.4312 21.1128 10.0626 21.1128 8.62759C21.1128 6.65084 19.4212 5.2348 17.0453 5.2348C14.7074 5.2348 13.1203 6.66034 13.1203 8.1334C13.1203 8.60859 13.4054 8.92221 13.8426 8.92221C14.2132 8.92221 14.4508 8.72263 14.6409 8.19993C15.021 7.22106 15.8763 6.66034 17.0073 6.66034C18.4613 6.66034 19.4402 7.53468 19.4402 8.83667C19.4402 10.1387 18.4328 11.0795 17.0453 11.0795H15.9239C15.4677 11.0795 15.1636 11.3741 15.1636 11.7923C15.1636 12.201 15.4867 12.5146 15.9239 12.5146H17.1118C18.7654 12.5146 19.8774 13.4934 19.8774 14.9475C19.8774 16.4016 18.7939 17.3329 17.0928 17.3329C15.8003 17.3329 14.8119 16.7627 14.3177 15.7458C14.0707 15.2611 13.8616 15.0901 13.5289 15.0901Z"
  />
</svg>`,X9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M18.7933 15.7548V17.6864C18.7933 18.2383 19.0787 18.5523 19.583 18.5523C20.0968 18.5523 20.3823 18.2383 20.3823 17.6864V15.7548H21.3719C21.9143 15.7548 22.2188 15.4884 22.2188 15.0317C22.2188 14.5654 21.9047 14.299 21.3719 14.299H20.3823V6.69626C20.3823 5.81134 19.897 5.31654 19.0311 5.31654C18.3746 5.31654 17.9369 5.602 17.3755 6.42983C15.2155 9.66503 14.3591 11.0352 12.9984 13.4426C12.6654 14.0516 12.5512 14.3846 12.5512 14.7367C12.5512 15.3647 13.046 15.7548 13.7882 15.7548H18.7933ZM18.7933 14.299H14.1498V14.2038C15.3963 12.0439 17.09 9.32248 18.7076 6.93414H18.7933V14.299ZM2.94953 5.70536C3.35312 5.70536 3.6803 6.03254 3.6803 6.43613V11.515H9.53462V6.43613C9.53462 6.03254 9.86179 5.70536 10.2654 5.70536C10.669 5.70536 10.9962 6.03254 10.9962 6.43613V12.2458V18.0555C10.9962 18.459 10.669 18.7862 10.2654 18.7862C9.86179 18.7862 9.53462 18.459 9.53462 18.0555V12.9766H3.6803V18.0555C3.6803 18.459 3.35312 18.7862 2.94953 18.7862C2.54593 18.7862 2.21875 18.459 2.21875 18.0555V6.43613C2.21875 6.03254 2.54593 5.70536 2.94953 5.70536Z"
  />
</svg>`,K9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M13.6153 15.0526C13.2062 15.0526 12.9366 15.3687 12.9366 15.8335C12.9366 17.135 14.4705 18.6316 16.9246 18.6316C19.5182 18.6316 21.3682 16.8096 21.3682 14.2439C21.3682 11.8362 19.7042 10.1443 17.343 10.1443C16.2739 10.1443 15.1863 10.5905 14.768 11.2134H14.675L15.0283 7.0766H20.0388C20.5873 7.0766 20.8941 6.8256 20.8941 6.37939C20.8941 5.92388 20.578 5.6543 20.0388 5.6543H14.8237C14.0243 5.6543 13.6246 5.97966 13.5688 6.66757L13.1598 11.8734C13.1133 12.5892 13.3829 13.0075 13.9127 13.0075C14.2102 13.0075 14.3961 12.8959 15.0747 12.2638C15.6139 11.7804 16.2553 11.5387 16.9804 11.5387C18.5886 11.5387 19.7321 12.6914 19.7321 14.3275C19.7321 16.038 18.5515 17.2279 16.8596 17.2279C15.7441 17.2279 14.8888 16.6887 14.3775 15.6941C14.1358 15.22 13.9313 15.0526 13.6153 15.0526ZM3.08209 5.90389C3.47639 5.90389 3.79603 6.22353 3.79603 6.61783V11.5797H9.51545V6.61783C9.51545 6.22353 9.83509 5.90389 10.2294 5.90389C10.6237 5.90389 10.9433 6.22353 10.9433 6.61783V12.2936V17.9695C10.9433 18.3638 10.6237 18.6834 10.2294 18.6834C9.83509 18.6834 9.51545 18.3638 9.51545 17.9695V13.0076H3.79603V17.9695C3.79603 18.3638 3.47639 18.6834 3.08209 18.6834C2.6878 18.6834 2.36816 18.3638 2.36816 17.9695V6.61783C2.36816 6.22353 2.6878 5.90389 3.08209 5.90389Z"
  />
</svg>`,Q9=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M17.6502 5.51672C14.5518 5.51672 12.8253 8.00853 12.8253 12.4975C12.8253 14.4294 13.1426 15.8759 13.7865 16.9025C14.5518 18.1064 15.8117 18.7597 17.3889 18.7597C19.9834 18.7597 21.7379 17.0145 21.7379 14.448C21.7379 12.0122 20.0767 10.3043 17.7062 10.3043C16.2503 10.3043 14.9158 11.107 14.4865 12.2455H14.4118C14.4398 8.75514 15.5411 6.92595 17.6222 6.92595C18.4528 6.92595 19.1528 7.22459 19.8247 7.8872C20.1607 8.21385 20.3567 8.3165 20.618 8.3165C21.0193 8.3165 21.3086 8.01786 21.3086 7.61656C21.3086 7.18726 20.9353 6.67397 20.3193 6.27266C19.6101 5.78737 18.6488 5.51672 17.6502 5.51672ZM17.4542 17.3598C15.8024 17.3598 14.6451 16.1746 14.6451 14.504C14.6451 12.8521 15.7744 11.6949 17.3889 11.6949C19.0501 11.6949 20.1327 12.8148 20.1327 14.5134C20.1327 16.2306 19.0594 17.3598 17.4542 17.3598ZM3.45463 5.99129C3.85047 5.99129 4.17137 6.31218 4.17137 6.70803V11.6894H9.91326V6.70803C9.91326 6.31218 10.2342 5.99129 10.63 5.99129C11.0259 5.99129 11.3467 6.31218 11.3467 6.70803V12.4061V18.1043C11.3467 18.5001 11.0259 18.821 10.63 18.821C10.2342 18.821 9.91326 18.5001 9.91326 18.1043V13.1229H4.17137V18.1043C4.17137 18.5001 3.85047 18.821 3.45463 18.821C3.05878 18.821 2.73788 18.5001 2.73788 18.1043V6.70803C2.73788 6.31218 3.05878 5.99129 3.45463 5.99129Z"
  />
</svg>`,pL=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4.29999 7.5C4.85227 7.5 5.29999 7.05228 5.29999 6.5C5.29999 5.94772 4.85227 5.5 4.29999 5.5C3.7477 5.5 3.29999 5.94772 3.29999 6.5C3.29999 7.05228 3.7477 7.5 4.29999 7.5ZM8.33335 5.75073C7.91914 5.75071 7.58334 6.08648 7.58331 6.50069C7.58329 6.9149 7.91906 7.25071 8.33327 7.25073L20.2499 7.2514C20.6641 7.25142 20.9999 6.91565 21 6.50144C21 6.08722 20.6642 5.75142 20.25 5.7514L8.33335 5.75073ZM8.33336 11.2508C7.91914 11.2508 7.58334 11.5865 7.58331 12.0007C7.58329 12.415 7.91905 12.7508 8.33327 12.7508L20.25 12.7515C20.6642 12.7515 21 12.4158 21 12.0015C21 11.5873 20.6643 11.2515 20.2501 11.2515L8.33336 11.2508ZM8.33336 16.7508C7.91914 16.7508 7.58334 17.0865 7.58331 17.5007C7.58329 17.915 7.91905 18.2508 8.33327 18.2508L20.25 18.2515C20.6642 18.2515 21 17.9158 21 17.5016C21 17.0873 20.6643 16.7515 20.25 16.7515L8.33336 16.7508ZM5.29999 12C5.29999 12.5523 4.85227 13 4.29999 13C3.7477 13 3.29999 12.5523 3.29999 12C3.29999 11.4477 3.7477 11 4.29999 11C4.85227 11 5.29999 11.4477 5.29999 12ZM4.29999 18.5C4.85227 18.5 5.29999 18.0523 5.29999 17.5C5.29999 16.9477 4.85227 16.5 4.29999 16.5C3.7477 16.5 3.29999 16.9477 3.29999 17.5C3.29999 18.0523 3.7477 18.5 4.29999 18.5Z"/>`,J9=rn(pL,20),yX=rn(pL,24),fL=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4.1287 5.76205C4.18101 5.74447 4.22813 5.71723 4.27846 5.68228L4.53386 5.50534V7.63997C4.53386 7.82761 4.59717 7.9904 4.71548 8.10631C4.83355 8.222 4.99776 8.28258 5.18421 8.28258C5.37066 8.28258 5.53488 8.222 5.65295 8.10631C5.77126 7.9904 5.83457 7.82761 5.83457 7.63997V4.93384C5.83457 4.72505 5.76932 4.54353 5.6384 4.41417C5.50756 4.2849 5.32242 4.21887 5.10409 4.21887C4.88258 4.21887 4.6705 4.24086 4.42948 4.40154L3.75168 4.85427C3.57975 4.97094 3.5 5.12628 3.5 5.31379C3.5 5.58698 3.70304 5.7858 3.96426 5.7858C4.02312 5.7858 4.07561 5.7799 4.1287 5.76205ZM9.40567 5.6015C8.98147 5.60148 8.63757 5.94534 8.63755 6.36953C8.63752 6.79373 8.98138 7.13762 9.40557 7.13765L19.7319 7.13827C20.1561 7.1383 20.5 6.79444 20.5 6.37024C20.5 5.94605 20.1562 5.60215 19.732 5.60213L9.40567 5.6015ZM9.40567 11.234C8.98147 11.234 8.63757 11.5779 8.63755 12.0021C8.63752 12.4263 8.98138 12.7702 9.40557 12.7702L19.7319 12.7708C20.1561 12.7708 20.5 12.427 20.5 12.0028C20.5 11.5786 20.1562 11.2347 19.732 11.2347L9.40567 11.234ZM9.40567 16.8666C8.98147 16.8666 8.63757 17.2104 8.63755 17.6346C8.63752 18.0588 8.98138 18.4027 9.40557 18.4027L19.7319 18.4033C20.1561 18.4034 20.5 18.0595 20.5 17.6353C20.5 17.2111 20.1562 16.8672 19.732 16.8672L9.40567 16.8666ZM6.62426 11.114C6.63609 11.048 6.6419 10.9782 6.6419 10.9031C6.6419 10.2259 6.06294 9.7684 5.15573 9.7684C4.5044 9.7684 3.97971 10.045 3.78328 10.4895C3.77042 10.5192 3.76022 10.5492 3.75251 10.5798C3.76022 10.5492 3.77044 10.5191 3.78331 10.4894C3.97974 10.0449 4.50442 9.7683 5.15575 9.7683C6.06297 9.7683 6.64193 10.2258 6.64193 10.903C6.64193 10.9782 6.6361 11.048 6.62426 11.114ZM5.12474 12.7537L5.12471 12.7537V12.7744H6.30848C6.58246 12.7744 6.73753 12.9372 6.73753 13.1879C6.73753 13.2197 6.73493 13.2502 6.72981 13.2792C6.73495 13.2502 6.73756 13.2196 6.73756 13.1878C6.73756 12.9371 6.58248 12.7743 6.30851 12.7743H5.12474V12.7537ZM3.73998 12.9913C3.77464 12.8518 3.86616 12.7304 4.02368 12.5985L5.04978 11.7197C5.38832 11.4292 5.53086 11.2672 5.57304 11.0983C5.5309 11.2672 5.38836 11.4293 5.04976 11.7198L4.02365 12.5986C3.86617 12.7305 3.77466 12.8519 3.73998 12.9913ZM4.50342 11.1816C4.59839 11.1252 4.67754 11.0396 4.75422 10.9274C4.81979 10.8327 4.87897 10.7719 4.93846 10.7343C4.99601 10.6979 5.05933 10.6797 5.14025 10.6797C5.25266 10.6797 5.33878 10.7139 5.39544 10.7645C5.45119 10.8143 5.48498 10.8855 5.48498 10.9753C5.48498 11.1448 5.40603 11.2791 4.9831 11.642L3.95747 12.5204C3.73832 12.704 3.62145 12.8851 3.62145 13.1283C3.62145 13.2841 3.66578 13.4314 3.77329 13.5397C3.88112 13.6484 4.03847 13.7037 4.23562 13.7037H6.30851C6.46671 13.7037 6.60202 13.6548 6.69803 13.5592C6.79392 13.4637 6.83997 13.3323 6.83997 13.1878C6.83997 13.0412 6.79418 12.9093 6.6977 12.8141C6.60129 12.719 6.46582 12.6718 6.30851 12.6718H5.37617L5.87155 12.2443C6.15942 11.9949 6.3783 11.7967 6.52349 11.5947C6.67287 11.3868 6.74434 11.1753 6.74434 10.903C6.74434 10.5321 6.58449 10.2187 6.30157 10.0006C6.02097 9.78425 5.62548 9.66589 5.15575 9.66589C4.48013 9.66589 3.90785 9.95417 3.68934 10.4487C3.64978 10.54 3.63179 10.6341 3.63179 10.7324C3.63179 10.8869 3.68238 11.0223 3.78385 11.1187C3.8847 11.2145 4.02467 11.2613 4.18393 11.2613C4.30216 11.2613 4.40667 11.2391 4.50342 11.1816ZM3.67138 16.0785C3.82347 15.664 4.34013 15.2247 5.22801 15.2247C5.68517 15.2247 6.09277 15.3214 6.38781 15.5143C6.68486 15.7085 6.86644 15.9999 6.86644 16.3799C6.86644 16.8627 6.55828 17.1838 6.17395 17.3212C6.40817 17.3704 6.60427 17.4641 6.75036 17.5998C6.93436 17.7707 7.035 18.0045 7.035 18.2873C7.035 18.6915 6.86059 19.0236 6.54548 19.2529C6.23205 19.4811 5.78277 19.6055 5.23363 19.6055C4.27385 19.6055 3.73928 19.1473 3.59258 18.7372C3.56511 18.6608 3.55307 18.5763 3.55307 18.5092C3.55307 18.3499 3.60652 18.216 3.70785 18.1223C3.80872 18.0289 3.95152 17.9805 4.12117 17.9805C4.23774 17.9805 4.33814 17.9997 4.42613 18.0439C4.51436 18.0882 4.58653 18.1558 4.64935 18.247C4.72378 18.3559 4.79404 18.4374 4.8851 18.4925C4.97546 18.5471 5.09131 18.5788 5.26173 18.5788C5.53989 18.5788 5.7218 18.414 5.7218 18.2002C5.7218 18.0706 5.67315 17.9761 5.58111 17.9118C5.48617 17.8455 5.33953 17.8076 5.13812 17.8076H5.11003C4.96167 17.8076 4.84264 17.7662 4.76061 17.6859C4.67849 17.6054 4.64024 17.4925 4.64024 17.3631C4.64024 17.2388 4.6788 17.1269 4.76042 17.0461C4.84209 16.9653 4.96094 16.9214 5.11003 16.9214H5.13812C5.3156 16.9214 5.449 16.8827 5.53665 16.8186C5.62237 16.7559 5.66843 16.6661 5.66843 16.5512C5.66843 16.4399 5.62767 16.3529 5.5564 16.293C5.48412 16.2322 5.37547 16.1951 5.23363 16.1951C5.1199 16.1951 5.02579 16.2182 4.94752 16.2628C4.86935 16.3074 4.80383 16.3753 4.74999 16.4698C4.68013 16.5935 4.60457 16.683 4.50858 16.7408C4.41232 16.7988 4.30106 16.8216 4.16612 16.8216C3.99313 16.8216 3.85731 16.7706 3.76471 16.6781C3.67224 16.5856 3.62892 16.4576 3.62892 16.3153C3.62892 16.2303 3.64147 16.1623 3.67138 16.0785Z"/>`,gL=rn(fL,24),eb=rn(fL,20),tb=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M3.25 6C3.25 4.48122 4.48122 3.25 6 3.25H18C19.5188 3.25 20.75 4.48122 20.75 6V18C20.75 19.5188 19.5188 20.75 18 20.75H6C4.48122 20.75 3.25 19.5188 3.25 18V6ZM6 4.75C5.30964 4.75 4.75 5.30964 4.75 6V8.25H19.25V6C19.25 5.30964 18.6904 4.75 18 4.75H6ZM4.75 18V9.75H7.75V19.25H6C5.30964 19.25 4.75 18.6904 4.75 18ZM9.25 19.25H18C18.6904 19.25 19.25 18.6904 19.25 18V9.75H9.25V19.25Z"/>`,nb=rn(tb),ib=rn(tb,20),rb=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5.5 3.75C4.5335 3.75 3.75 4.5335 3.75 5.5V18C3.75 18.9665 4.5335 19.75 5.5 19.75H9.5C10.4665 19.75 11.25 18.9665 11.25 18V5.5C11.25 4.5335 10.4665 3.75 9.5 3.75H5.5ZM5.25 5.5C5.25 5.36193 5.36193 5.25 5.5 5.25H9.5C9.63807 5.25 9.75 5.36193 9.75 5.5V18C9.75 18.1381 9.63807 18.25 9.5 18.25H5.5C5.36193 18.25 5.25 18.1381 5.25 18V5.5ZM14.5 3.75C13.5335 3.75 12.75 4.5335 12.75 5.5V12.5C12.75 13.4665 13.5335 14.25 14.5 14.25H18.5C19.4665 14.25 20.25 13.4665 20.25 12.5V5.5C20.25 4.5335 19.4665 3.75 18.5 3.75H14.5ZM14.25 5.5C14.25 5.36193 14.3619 5.25 14.5 5.25H18.5C18.6381 5.25 18.75 5.36193 18.75 5.5V12.5C18.75 12.6381 18.6381 12.75 18.5 12.75H14.5C14.3619 12.75 14.25 12.6381 14.25 12.5V5.5Z"/>`,mL=rn(rb),bL=rn(rb,20),ob=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H18C18.6904 4.75 19.25 5.30964 19.25 6V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6ZM16.5303 9.53033C16.8232 9.23744 16.8232 8.76256 16.5303 8.46967C16.2374 8.17678 15.7626 8.17678 15.4697 8.46967L10.5 13.4393L9.03033 11.9697C8.73744 11.6768 8.26256 11.6768 7.96967 11.9697C7.67678 12.2626 7.67678 12.7374 7.96967 13.0303L9.96967 15.0303C10.2626 15.3232 10.7374 15.3232 11.0303 15.0303L16.5303 9.53033Z"
  />
</svg>`,sb=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.25 6C2.25 4.48122 3.48122 3.25 5 3.25H19C20.5188 3.25 21.75 4.48122 21.75 6V18C21.75 19.5188 20.5188 20.75 19 20.75H5C3.48122 20.75 2.25 19.5188 2.25 18V6ZM5 4.75C4.30964 4.75 3.75 5.30964 3.75 6V18C3.75 18.6904 4.30964 19.25 5 19.25H19C19.6904 19.25 20.25 18.6904 20.25 18V6C20.25 5.30964 19.6904 4.75 19 4.75H5ZM10.5303 9.36957C10.8232 9.66247 10.8232 10.1373 10.5303 10.4302L8.93934 12.0212L10.5303 13.6122C10.8232 13.9051 10.8232 14.38 10.5303 14.6729C10.2374 14.9658 9.76256 14.9658 9.46967 14.6729L7.34835 12.5516C7.05546 12.2587 7.05546 11.7838 7.34835 11.4909L9.46967 9.36957C9.76256 9.07668 10.2374 9.07668 10.5303 9.36957ZM13.4697 10.4302C13.1768 10.1373 13.1768 9.66247 13.4697 9.36957C13.7626 9.07668 14.2374 9.07668 14.5303 9.36957L16.6517 11.4909C16.9445 11.7838 16.9445 12.2587 16.6517 12.5516L14.5303 14.6729C14.2374 14.9658 13.7626 14.9658 13.4697 14.6729C13.1768 14.38 13.1768 13.9051 13.4697 13.6122L15.0607 12.0212L13.4697 10.4302Z"
  />
</svg>`,ab=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5 10.9655V11.0953V15.0608C5 15.6262 5.45838 16.0846 6.02382 16.0846H10.119C10.6845 16.0846 11.1429 15.6262 11.1429 15.0608V10.9655C11.1429 10.4001 10.6845 9.9417 10.119 9.9417H6.70422C7.17415 8.66255 8.40313 7.75 9.84524 7.75V6.25C7.24961 6.25 5.13069 8.29105 5.00582 10.8557C5.00197 10.8918 5 10.9284 5 10.9655ZM13 10.9655V11.0953V15.0608C13 15.6262 13.4584 16.0846 14.0238 16.0846H18.119C18.6845 16.0846 19.1429 15.6262 19.1429 15.0608V10.9655C19.1429 10.4001 18.6845 9.9417 18.119 9.9417H14.7042C15.1741 8.66255 16.4031 7.75 17.8452 7.75V6.25C15.2496 6.25 13.1307 8.29105 13.0058 10.8557C13.002 10.8918 13 10.9284 13 10.9655Z"
  />
</svg>`,lb=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M4 4.25C4.41421 4.25 4.75 4.58579 4.75 5V6C4.75 6.69036 5.30964 7.25 6 7.25H18C18.6904 7.25 19.25 6.69036 19.25 6V5C19.25 4.58579 19.5858 4.25 20 4.25C20.4142 4.25 20.75 4.58579 20.75 5V6C20.75 7.51878 19.5188 8.75 18 8.75H6C4.48122 8.75 3.25 7.51878 3.25 6V5C3.25 4.58579 3.58579 4.25 4 4.25ZM4 19.75C4.41421 19.75 4.75 19.4142 4.75 19V18C4.75 17.3096 5.30964 16.75 6 16.75H18C18.6904 16.75 19.25 17.3096 19.25 18V19C19.25 19.4142 19.5858 19.75 20 19.75C20.4142 19.75 20.75 19.4142 20.75 19V18C20.75 16.4812 19.5188 15.25 18 15.25H6C4.48122 15.25 3.25 16.4812 3.25 18V19C3.25 19.4142 3.58579 19.75 4 19.75ZM3 11.25C2.58579 11.25 2.25 11.5858 2.25 12C2.25 12.4142 2.58579 12.75 3 12.75H3.09H3.36H3.84H4.11H4.2C4.61421 12.75 4.95 12.4142 4.95 12C4.95 11.5858 4.61421 11.25 4.2 11.25H4.11H3.84H3.36H3.09H3ZM6.44995 12C6.44995 11.5858 6.78574 11.25 7.19995 11.25H7.28995H7.55995H8.03995H8.30995H8.39995C8.81416 11.25 9.14995 11.5858 9.14995 12C9.14995 12.4142 8.81416 12.75 8.39995 12.75H8.30995H8.03995H7.55995H7.28995H7.19995C6.78574 12.75 6.44995 12.4142 6.44995 12ZM11.3999 11.25C10.9857 11.25 10.6499 11.5858 10.6499 12C10.6499 12.4142 10.9857 12.75 11.3999 12.75H11.4899H11.7599H12.2399H12.5099H12.5999C13.0141 12.75 13.3499 12.4142 13.3499 12C13.3499 11.5858 13.0141 11.25 12.5999 11.25H12.5099H12.2399H11.7599H11.4899H11.3999ZM14.8499 12C14.8499 11.5858 15.1856 11.25 15.5999 11.25H15.6899H15.9599H16.4399H16.7099H16.7999C17.2141 11.25 17.5499 11.5858 17.5499 12C17.5499 12.4142 17.2141 12.75 16.7999 12.75H16.7099H16.4399H15.9599H15.6899H15.5999C15.1856 12.75 14.8499 12.4142 14.8499 12ZM19.7998 11.25C19.3856 11.25 19.0498 11.5858 19.0498 12C19.0498 12.4142 19.3856 12.75 19.7998 12.75H19.8898H20.1598H20.6398H20.9098H20.9998C21.414 12.75 21.7498 12.4142 21.7498 12C21.7498 11.5858 21.414 11.25 20.9998 11.25H20.9098H20.6398H20.1598H19.8898H19.7998Z"
  />
</svg>`,vL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M6.25 4C6.25 3.58579 6.58579 3.25 7 3.25H12.9583C15.6288 3.25 17.8333 5.35506 17.8333 8C17.8333 9.51519 17.1099 10.8532 15.9898 11.7198C17.6162 12.484 18.75 14.1032 18.75 16C18.75 18.6449 16.5455 20.75 13.875 20.75H7C6.58579 20.75 6.25 20.4142 6.25 20V4ZM7.75 12.75V19.25H13.875C15.7609 19.25 17.25 17.7733 17.25 16C17.25 14.2267 15.7609 12.75 13.875 12.75H7.75ZM7.75 11.25H12.9583C14.8442 11.25 16.3333 9.77334 16.3333 8C16.3333 6.22666 14.8442 4.75 12.9583 4.75H7.75V11.25Z"
  />
</svg>`,yL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M14.6075 3.24996H10.25C9.83579 3.24996 9.5 3.58575 9.5 3.99996C9.5 4.41417 9.83579 4.74996 10.25 4.74996H13.5896L8.83175 19.25H5C4.58579 19.25 4.25 19.5857 4.25 20C4.25 20.4142 4.58579 20.75 5 20.75H9.35778C9.36938 20.7502 9.38095 20.7502 9.39249 20.75H13.75C14.1642 20.75 14.5 20.4142 14.5 20C14.5 19.5857 14.1642 19.25 13.75 19.25H10.4104L15.1682 4.74996H19C19.4142 4.74996 19.75 4.41417 19.75 3.99996C19.75 3.58575 19.4142 3.24996 19 3.24996H14.6422C14.6306 3.24969 14.619 3.24969 14.6075 3.24996Z"
  />
</svg>`,wL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M7.74427 3.96773C7.74427 3.52145 7.38249 3.15967 6.93621 3.15967C6.48992 3.15967 6.12814 3.52145 6.12814 3.96773V10.971C6.12814 14.0949 8.66062 16.6274 11.7846 16.6274C14.9086 16.6274 17.441 14.0949 17.441 10.971V3.96773C17.441 3.52145 17.0793 3.15967 16.633 3.15967C16.1867 3.15967 15.8249 3.52145 15.8249 3.96773V10.971C15.8249 13.2024 14.016 15.0113 11.7846 15.0113C9.55318 15.0113 7.74427 13.2024 7.74427 10.971V3.96773ZM4.45809 19.321C4.01181 19.321 3.65002 19.6828 3.65002 20.129C3.65002 20.5753 4.01181 20.9371 4.45809 20.9371H19.542C19.9882 20.9371 20.35 20.5753 20.35 20.129C20.35 19.6828 19.9882 19.321 19.542 19.321H4.45809Z"
  />
</svg>`,xL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M8.40605 7.46437C8.40605 5.54921 9.9586 3.99667 11.8738 3.99667C13.2452 3.99667 14.4322 4.79274 14.9951 5.95145C15.181 6.33412 15.6419 6.49363 16.0246 6.30773C16.4072 6.12183 16.5668 5.66092 16.3809 5.27825C15.57 3.60922 13.8573 2.45605 11.8738 2.45605C9.10773 2.45605 6.86543 4.69835 6.86543 7.46437C6.86543 8.21934 7.03248 8.9353 7.33163 9.57729H9.1239C8.67373 8.99229 8.40605 8.25959 8.40605 7.46437ZM14.9176 15.9402C14.9176 15.145 14.6499 14.4123 14.1998 13.8273H15.992C16.2912 14.4693 16.4582 15.1852 16.4582 15.9402C16.4582 18.7062 14.2159 20.9485 11.4499 20.9485C9.46635 20.9485 7.75362 19.7953 6.9428 18.1263C6.7569 17.7436 6.91641 17.2827 7.29907 17.0968C7.68174 16.9109 8.14265 17.0704 8.32855 17.4531C8.89146 18.6118 10.0784 19.4079 11.4499 19.4079C13.3651 19.4079 14.9176 17.8553 14.9176 15.9402ZM4.29688 10.9054C3.85677 10.9054 3.5 11.2622 3.5 11.7023C3.5 12.1424 3.85677 12.4992 4.29688 12.4992H19.7031C20.1432 12.4992 20.5 12.1424 20.5 11.7023C20.5 11.2622 20.1432 10.9054 19.7031 10.9054H4.29688Z"
  />
</svg>`,_L=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M13.9819 4.27233C14.3837 4.37279 14.6281 4.77999 14.5276 5.18183L10.9276 19.5818C10.8271 19.9837 10.4199 20.228 10.0181 20.1275C9.61625 20.0271 9.37193 19.6199 9.47239 19.218L13.0724 4.81803C13.1729 4.41619 13.5801 4.17186 13.9819 4.27233ZM7.13033 8.0696C7.42322 8.3625 7.42322 8.83737 7.13033 9.13026L4.06066 12.1999L7.13033 15.2696C7.42322 15.5625 7.42322 16.0374 7.13033 16.3303C6.83744 16.6232 6.36256 16.6232 6.06967 16.3303L2.46967 12.7303C2.17678 12.4374 2.17678 11.9625 2.46967 11.6696L6.06967 8.0696C6.36256 7.77671 6.83744 7.77671 7.13033 8.0696ZM16.8697 8.0696C17.1626 7.77671 17.6374 7.77671 17.9303 8.0696L21.5303 11.6696C21.8232 11.9625 21.8232 12.4374 21.5303 12.7303L17.9303 16.3303C17.6374 16.6232 17.1626 16.6232 16.8697 16.3303C16.5768 16.0374 16.5768 15.5625 16.8697 15.2696L19.9393 12.1999L16.8697 9.13026C16.5768 8.83737 16.5768 8.3625 16.8697 8.0696Z"
  />
</svg>`,CL=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M18.4283 5.57173C17.3326 4.47609 15.5563 4.47609 14.4606 5.57173L13.4832 6.54916C13.1903 6.84205 12.7154 6.84205 12.4225 6.54916C12.1296 6.25627 12.1296 5.78139 12.4225 5.4885L13.4 4.51107C15.0814 2.82964 17.8075 2.82964 19.4889 4.51107C21.1704 6.19249 21.1704 8.91862 19.4889 10.6L15.9334 14.1556C14.252 15.837 11.5258 15.837 9.8444 14.1556C9.55151 13.8627 9.55151 13.3878 9.8444 13.0949C10.1373 12.802 10.6122 12.802 10.9051 13.0949C12.0007 14.1906 13.7771 14.1906 14.8727 13.0949L18.4283 9.53938C19.5239 8.44375 19.5239 6.66737 18.4283 5.57173ZM13.0949 10.9051C11.9993 9.80942 10.2229 9.80942 9.12728 10.9051L5.57173 14.4606C4.47609 15.5563 4.47609 17.3326 5.57173 18.4283C6.66737 19.5239 8.44375 19.5239 9.53938 18.4283L10.5185 17.4491C10.8114 17.1562 11.2863 17.1562 11.5792 17.4491C11.8721 17.742 11.8721 18.2169 11.5792 18.5098L10.6 19.4889C8.91862 21.1704 6.19249 21.1704 4.51107 19.4889C2.82964 17.8075 2.82964 15.0814 4.51107 13.4L8.06662 9.8444C9.74805 8.16298 12.4742 8.16298 14.1556 9.8444C14.4485 10.1373 14.4485 10.6122 14.1556 10.9051C13.8627 11.198 13.3878 11.198 13.0949 10.9051Z"/>`,Yd=rn(CL,20),wX=p3(CL),Tr=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.25 6C3.25 4.48122 4.48122 3.25 6 3.25H14C15.5188 3.25 16.75 4.48122 16.75 6V7.25H18C19.5188 7.25 20.75 8.48122 20.75 10V18C20.75 19.5188 19.5188 20.75 18 20.75H10C8.48122 20.75 7.25 19.5188 7.25 18V16.75H6C4.48122 16.75 3.25 15.5188 3.25 14V6ZM8.75 18C8.75 18.6904 9.30964 19.25 10 19.25H18C18.6904 19.25 19.25 18.6904 19.25 18V10C19.25 9.30964 18.6904 8.75 18 8.75H10C9.30964 8.75 8.75 9.30964 8.75 10V18ZM15.25 7.25H10C8.48122 7.25 7.25 8.48122 7.25 10V15.25H6C5.30964 15.25 4.75 14.6904 4.75 14V6C4.75 5.30964 5.30964 4.75 6 4.75H14C14.6904 4.75 15.25 5.30964 15.25 6V7.25Z"
  />
</svg>`,il=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V14C3.25 15.5188 4.48122 16.75 6 16.75H7.25V18C7.25 19.5188 8.48122 20.75 10 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V10C20.75 8.48122 19.5188 7.25 18 7.25H16.75V6C16.75 4.48122 15.5188 3.25 14 3.25H6ZM10 7.25H15.25V6C15.25 5.30964 14.6904 4.75 14 4.75H6C5.30964 4.75 4.75 5.30964 4.75 6V14C4.75 14.6904 5.30964 15.25 6 15.25H8C8.41421 15.25 8.75 15.5858 8.75 16V18C8.75 18.6904 9.30964 19.25 10 19.25H18C18.6904 19.25 19.25 18.6904 19.25 18V10C19.25 9.30964 18.6904 8.75 18 8.75H16H10C9.46561 8.75 9.00774 9.08568 8.82933 9.56024C8.68357 9.94796 8.2511 10.1441 7.86338 9.99835C7.47566 9.85259 7.27951 9.42012 7.42527 9.0324C7.81633 7.99216 8.82056 7.25 10 7.25ZM12.8871 10.489C12.6049 10.1858 12.1303 10.1688 11.8271 10.451C11.524 10.7333 11.507 11.2078 11.7892 11.511L12.4771 12.25H7.79999C7.38577 12.25 7.04999 12.5858 7.04999 13C7.04999 13.4142 7.38577 13.75 7.79999 13.75H12.4771L11.7892 14.489C11.507 14.7922 11.524 15.2667 11.8271 15.549C12.1303 15.8312 12.6049 15.8142 12.8871 15.511L14.7489 13.511C15.017 13.2231 15.017 12.7769 14.7489 12.489L12.8871 10.489Z"
  />
</svg>`,xn=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M11 2.25C9.48122 2.25 8.25 3.48122 8.25 5V6.1499H4C3.53056 6.1499 3.15 6.53046 3.15 6.9999C3.15 7.46934 3.53056 7.8499 4 7.8499H4.3088L5.11923 19.1959C5.22202 20.635 6.41948 21.75 7.86224 21.75H16.1378C17.5805 21.75 18.778 20.635 18.8808 19.1959L19.6912 7.8499H20C20.4694 7.8499 20.85 7.46934 20.85 6.9999C20.85 6.53046 20.4694 6.1499 20 6.1499H15.75V5C15.75 3.48122 14.5188 2.25 13 2.25H11ZM14.25 6.1499V5C14.25 4.30964 13.6904 3.75 13 3.75H11C10.3096 3.75 9.75 4.30964 9.75 5V6.1499H14.25ZM18.1874 7.8499H5.81262L6.61542 19.0891C6.66214 19.7432 7.20644 20.25 7.86224 20.25H16.1378C16.7936 20.25 17.3379 19.7432 17.3846 19.0891L18.1874 7.8499ZM10.75 11C10.75 10.5858 10.4142 10.25 10 10.25C9.58579 10.25 9.25 10.5858 9.25 11V17C9.25 17.4142 9.58579 17.75 10 17.75C10.4142 17.75 10.75 17.4142 10.75 17V11ZM14 10.25C14.4142 10.25 14.75 10.5858 14.75 11V17C14.75 17.4142 14.4142 17.75 14 17.75C13.5858 17.75 13.25 17.4142 13.25 17V11C13.25 10.5858 13.5858 10.25 14 10.25Z"
  />
</svg>`,kL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M8 2.75C8.41421 2.75 8.75 3.08579 8.75 3.5V4.25H15.25V3.5C15.25 3.08579 15.5858 2.75 16 2.75C16.4142 2.75 16.75 3.08579 16.75 3.5V4.25H19C20.5188 4.25 21.75 5.48122 21.75 7V9.5V19C21.75 20.5188 20.5188 21.75 19 21.75H5C3.48122 21.75 2.25 20.5188 2.25 19V9.5V7C2.25 5.48122 3.48122 4.25 5 4.25H7.25V3.5C7.25 3.08579 7.58579 2.75 8 2.75ZM15.25 5.75V6.5C15.25 6.91421 15.5858 7.25 16 7.25C16.4142 7.25 16.75 6.91421 16.75 6.5V5.75H19C19.6904 5.75 20.25 6.30964 20.25 7V8.75H3.75V7C3.75 6.30964 4.30964 5.75 5 5.75H7.25V6.5C7.25 6.91421 7.58579 7.25 8 7.25C8.41421 7.25 8.75 6.91421 8.75 6.5V5.75H15.25ZM20.25 10.25H3.75V19C3.75 19.6904 4.30964 20.25 5 20.25H19C19.6904 20.25 20.25 19.6904 20.25 19V10.25ZM7 11.8C6.72386 11.8 6.5 12.0239 6.5 12.3V13.8C6.5 14.0762 6.72386 14.3 7 14.3H8.5C8.77614 14.3 9 14.0762 9 13.8V12.3C9 12.0239 8.77614 11.8 8.5 11.8H7ZM6.5 16.2C6.5 15.9238 6.72386 15.7 7 15.7H8.5C8.77614 15.7 9 15.9238 9 16.2V17.7C9 17.9761 8.77614 18.2 8.5 18.2H7C6.72386 18.2 6.5 17.9761 6.5 17.7V16.2ZM11.2 11.8C10.9239 11.8 10.7 12.0239 10.7 12.3V13.8C10.7 14.0762 10.9239 14.3 11.2 14.3H12.7C12.9762 14.3 13.2 14.0762 13.2 13.8V12.3C13.2 12.0239 12.9762 11.8 12.7 11.8H11.2ZM10.7 16.2C10.7 15.9238 10.9239 15.7 11.2 15.7H12.7C12.9762 15.7 13.2 15.9238 13.2 16.2V17.7C13.2 17.9761 12.9762 18.2 12.7 18.2H11.2C10.9239 18.2 10.7 17.9761 10.7 17.7V16.2ZM15.5 11.8C15.2239 11.8 15 12.0239 15 12.3V13.8C15 14.0762 15.2239 14.3 15.5 14.3H17C17.2761 14.3 17.5 14.0762 17.5 13.8V12.3C17.5 12.0239 17.2761 11.8 17 11.8H15.5Z"
  />
</svg>`,EL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M8 2.75C8.41421 2.75 8.75 3.08579 8.75 3.5V4.25H15.25V3.5C15.25 3.08579 15.5858 2.75 16 2.75C16.4142 2.75 16.75 3.08579 16.75 3.5V4.25H19C20.5188 4.25 21.75 5.48122 21.75 7V9.5V13C21.75 13.4142 21.4142 13.75 21 13.75C20.5858 13.75 20.25 13.4142 20.25 13V10.25H3.75V19C3.75 19.6904 4.30964 20.25 5 20.25H11.5C11.9142 20.25 12.25 20.5858 12.25 21C12.25 21.4142 11.9142 21.75 11.5 21.75H5C3.48122 21.75 2.25 20.5188 2.25 19V9.5V7C2.25 5.48122 3.48122 4.25 5 4.25H7.25V3.5C7.25 3.08579 7.58579 2.75 8 2.75ZM15.25 5.75V6.5C15.25 6.91421 15.5858 7.25 16 7.25C16.4142 7.25 16.75 6.91421 16.75 6.5V5.75H19C19.6904 5.75 20.25 6.30964 20.25 7V8.75H3.75V7C3.75 6.30964 4.30964 5.75 5 5.75H7.25V6.5C7.25 6.91421 7.58579 7.25 8 7.25C8.41421 7.25 8.75 6.91421 8.75 6.5V5.75H15.25ZM19.2697 17.5303C18.9768 17.2374 18.9768 16.7626 19.2697 16.4697C19.5626 16.1768 20.0374 16.1768 20.3303 16.4697L22.4516 18.591C22.7445 18.8839 22.7445 19.3588 22.4516 19.6516L20.3303 21.773C20.0374 22.0659 19.5626 22.0659 19.2697 21.773C18.9768 21.4801 18.9768 21.0052 19.2697 20.7123L20.8606 19.1213L19.2697 17.5303ZM14.591 16.4697C14.2981 16.7626 14.2981 17.2374 14.591 17.5303L16.182 19.1213L14.591 20.7123C14.2981 21.0052 14.2981 21.4801 14.591 21.773C14.8839 22.0659 15.3588 22.0659 15.6517 21.773L17.773 19.6516C18.0659 19.3588 18.0659 18.8839 17.773 18.591L15.6517 16.4697C15.3588 16.1768 14.8839 16.1768 14.591 16.4697Z"
  />
</svg>`,SL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M8 2.75C8.41421 2.75 8.75 3.08579 8.75 3.5V4.25H15.25V3.5C15.25 3.08579 15.5858 2.75 16 2.75C16.4142 2.75 16.75 3.08579 16.75 3.5V4.25H19C20.5188 4.25 21.75 5.48122 21.75 7V13C21.75 13.4142 21.4142 13.75 21 13.75C20.5858 13.75 20.25 13.4142 20.25 13V10.35H3.75V19C3.75 19.6904 4.30964 20.25 5 20.25H11.5C11.9142 20.25 12.25 20.5858 12.25 21C12.25 21.4142 11.9142 21.75 11.5 21.75H5C3.48122 21.75 2.25 20.5188 2.25 19V7C2.25 5.48122 3.48122 4.25 5 4.25H7.25V3.5C7.25 3.08579 7.58579 2.75 8 2.75ZM15.25 5.75V6.5C15.25 6.91421 15.5858 7.25 16 7.25C16.4142 7.25 16.75 6.91421 16.75 6.5V5.75H19C19.6904 5.75 20.25 6.30964 20.25 7V8.65H3.75V7C3.75 6.30964 4.30964 5.75 5 5.75H7.25V6.5C7.25 6.91421 7.58579 7.25 8 7.25C8.41421 7.25 8.75 6.91421 8.75 6.5V5.75H15.25ZM17.0803 16.4697C17.3732 16.7626 17.3732 17.2374 17.0803 17.5303L15.4893 19.1213L17.0803 20.7123C17.3732 21.0052 17.3732 21.4801 17.0803 21.773C16.7874 22.0659 16.3126 22.0659 16.0197 21.773L13.8984 19.6516C13.6055 19.3588 13.6055 18.8839 13.8984 18.591L16.0197 16.4697C16.3126 16.1768 16.7874 16.1768 17.0803 16.4697ZM21.6517 17.5303C21.9446 17.2374 21.9446 16.7626 21.6517 16.4697C21.3588 16.1768 20.8839 16.1768 20.591 16.4697L18.4697 18.591C18.1768 18.8839 18.1768 19.3588 18.4697 19.6516L20.591 21.773C20.8839 22.0659 21.3588 22.0659 21.6517 21.773C21.9446 21.4801 21.9446 21.0052 21.6517 20.7123L20.0607 19.1213L21.6517 17.5303Z"
  />
</svg>`,TL=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M6.11366 3.67804C6.40656 3.97094 6.40656 4.44581 6.11366 4.7387L4.28033 6.57204C3.98744 6.86493 3.51256 6.86493 3.21967 6.57204C2.92678 6.27914 2.92678 5.80427 3.21967 5.51138L5.053 3.67804C5.3459 3.38515 5.82077 3.38515 6.11366 3.67804ZM17.8863 3.67804C18.1792 3.38515 18.6541 3.38515 18.947 3.67804L20.7803 5.51138C21.0732 5.80427 21.0732 6.27914 20.7803 6.57204C20.4874 6.86493 20.0126 6.86493 19.7197 6.57204L17.8863 4.7387C17.5934 4.44581 17.5934 3.97094 17.8863 3.67804ZM12 5.87504C8.36413 5.87504 5.41667 8.8225 5.41667 12.4584C5.41667 16.0942 8.36413 19.0417 12 19.0417C15.6359 19.0417 18.5833 16.0942 18.5833 12.4584C18.5833 8.8225 15.6359 5.87504 12 5.87504ZM3.91667 12.4584C3.91667 7.99407 7.5357 4.37504 12 4.37504C16.4643 4.37504 20.0833 7.99407 20.0833 12.4584C20.0833 16.9227 16.4643 20.5417 12 20.5417C7.5357 20.5417 3.91667 16.9227 3.91667 12.4584Z"
    />
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M15.197 10.3586C15.4899 10.6515 15.4899 11.1264 15.197 11.4193L11.6415 14.9748C11.3486 15.2677 10.8737 15.2677 10.5808 14.9748L8.80301 13.1971C8.51012 12.9042 8.51012 12.4293 8.80301 12.1364C9.09591 11.8435 9.57078 11.8435 9.86367 12.1364L11.1111 13.3839L14.1363 10.3586C14.4292 10.0657 14.9041 10.0657 15.197 10.3586Z"
    />
  </svg>
`,Xd=b` <svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M6.34315 6.34314C6.63604 6.05025 7.11091 6.05025 7.40381 6.34314L12 10.9393L16.5962 6.34314C16.8891 6.05025 17.364 6.05025 17.6569 6.34314C17.9497 6.63604 17.9497 7.11091 17.6569 7.4038L13.0607 12L17.6569 16.5962C17.9497 16.8891 17.9497 17.364 17.6569 17.6569C17.364 17.9497 16.8891 17.9497 16.5962 17.6569L12 13.0607L7.40381 17.6569C7.11091 17.9497 6.63604 17.9497 6.34315 17.6569C6.05025 17.364 6.05025 16.8891 6.34315 16.5962L10.9393 12L6.34315 7.4038C6.05025 7.11091 6.05025 6.63604 6.34315 6.34314Z"
  />
</svg>`,xX=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6.33333 4C4.76853 4 3.5 5.26853 3.5 6.83333V8.89394C3.5 10.4587 4.76853 11.7273 6.33333 11.7273H8.39394C9.95875 11.7273 11.2273 10.4587 11.2273 8.89394V6.83333C11.2273 5.26853 9.95875 4 8.39394 4H6.33333ZM5.04545 6.83333C5.04545 6.12206 5.62206 5.54545 6.33333 5.54545H8.39394C9.10522 5.54545 9.68182 6.12206 9.68182 6.83333V8.89394C9.68182 9.60522 9.10522 10.1818 8.39394 10.1818H6.33333C5.62206 10.1818 5.04545 9.60522 5.04545 8.89394V6.83333ZM6.33333 13.2727C4.76853 13.2727 3.5 14.5413 3.5 16.1061V18.1667C3.5 19.7315 4.76853 21 6.33333 21H8.39394C9.95875 21 11.2273 19.7315 11.2273 18.1667V16.1061C11.2273 14.5413 9.95875 13.2727 8.39394 13.2727H6.33333ZM5.04545 16.1061C5.04545 15.3948 5.62206 14.8182 6.33333 14.8182H8.39394C9.10522 14.8182 9.68182 15.3948 9.68182 16.1061V18.1667C9.68182 18.8779 9.10522 19.4545 8.39394 19.4545H6.33333C5.62206 19.4545 5.04545 18.8779 5.04545 18.1667V16.1061ZM12.7727 6.83333C12.7727 5.26853 14.0413 4 15.6061 4H17.6667C19.2315 4 20.5 5.26853 20.5 6.83333V8.89394C20.5 10.4587 19.2315 11.7273 17.6667 11.7273H15.6061C14.0413 11.7273 12.7727 10.4587 12.7727 8.89394V6.83333ZM15.6061 5.54545C14.8948 5.54545 14.3182 6.12206 14.3182 6.83333V8.89394C14.3182 9.60522 14.8948 10.1818 15.6061 10.1818H17.6667C18.3779 10.1818 18.9545 9.60522 18.9545 8.89394V6.83333C18.9545 6.12206 18.3779 5.54545 17.6667 5.54545H15.6061ZM17.4091 14.0455C17.4091 13.6187 17.0631 13.2727 16.6364 13.2727C16.2096 13.2727 15.8636 13.6187 15.8636 14.0455V16.3636H13.5455C13.1187 16.3636 12.7727 16.7096 12.7727 17.1364C12.7727 17.5631 13.1187 17.9091 13.5455 17.9091H15.8636V20.2273C15.8636 20.654 16.2096 21 16.6364 21C17.0631 21 17.4091 20.654 17.4091 20.2273V17.9091H19.7273C20.154 17.9091 20.5 17.5631 20.5 17.1364C20.5 16.7096 20.154 16.3636 19.7273 16.3636H17.4091V14.0455Z"/>`,_X=b` <svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  ${xX}
</svg>`,IL=b` <svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5.57378 3.25C5.5825 3.25 5.59124 3.25 5.6 3.25L8.42622 3.25C8.68371 3.24998 8.92019 3.24996 9.11787 3.26612C9.33101 3.28353 9.56418 3.32339 9.79449 3.44074C10.1238 3.60852 10.3915 3.87623 10.5593 4.20552C10.6766 4.43582 10.7165 4.669 10.7339 4.88213C10.75 5.07982 10.75 5.3163 10.75 5.57379V8.42621C10.75 8.6837 10.75 8.92019 10.7339 9.11787C10.7165 9.33101 10.6766 9.56418 10.5593 9.79448C10.3915 10.1238 10.1238 10.3915 9.79449 10.5593C9.56418 10.6766 9.33101 10.7165 9.11787 10.7339C8.92019 10.75 8.6837 10.75 8.42622 10.75H5.57379C5.3163 10.75 5.07982 10.75 4.88213 10.7339C4.669 10.7165 4.43583 10.6766 4.20552 10.5593C3.87624 10.3915 3.60852 10.1238 3.44074 9.79448C3.32339 9.56418 3.28353 9.33101 3.26612 9.11787C3.24997 8.92019 3.24998 8.6837 3.25 8.42622L3.25 5.6C3.25 5.59124 3.25 5.5825 3.25 5.57378C3.24998 5.3163 3.24997 5.07981 3.26612 4.88213C3.28353 4.669 3.32339 4.43582 3.44074 4.20552C3.60852 3.87623 3.87624 3.60852 4.20552 3.44074C4.43583 3.32339 4.669 3.28353 4.88213 3.26612C5.07982 3.24996 5.3163 3.24998 5.57378 3.25ZM4.88088 4.77973C4.88085 4.77972 4.88132 4.77952 4.88239 4.77917L4.88088 4.77973ZM4.88346 4.77882C4.89234 4.77607 4.92547 4.76757 5.00428 4.76113C5.13341 4.75058 5.3076 4.75 5.6 4.75H8.4C8.6924 4.75 8.8666 4.75058 8.99573 4.76113C9.07454 4.76757 9.10766 4.77607 9.11654 4.77882C9.16118 4.80234 9.19766 4.83882 9.22118 4.88346C9.22393 4.89234 9.23243 4.92547 9.23887 5.00428C9.24942 5.1334 9.25 5.3076 9.25 5.6V8.4C9.25 8.6924 9.24942 8.8666 9.23887 8.99572C9.23243 9.07453 9.22393 9.10766 9.22118 9.11654C9.19766 9.16118 9.16118 9.19766 9.11654 9.22118C9.10767 9.22393 9.07454 9.23243 8.99573 9.23887C8.8666 9.24942 8.6924 9.25 8.4 9.25H5.6C5.3076 9.25 5.13341 9.24942 5.00428 9.23887C4.92547 9.23243 4.89234 9.22393 4.88347 9.22118C4.83883 9.19766 4.80235 9.16118 4.77883 9.11654C4.77607 9.10766 4.76757 9.07453 4.76114 8.99572C4.75059 8.8666 4.75 8.6924 4.75 8.4V5.6C4.75 5.3076 4.75059 5.1334 4.76114 5.00428C4.76757 4.92547 4.77607 4.89234 4.77883 4.88346C4.80235 4.83882 4.83883 4.80234 4.88346 4.77882ZM4.77973 4.88088C4.77974 4.8809 4.77956 4.88144 4.77917 4.88239L4.77973 4.88088ZM4.77973 9.11913C4.77972 9.11915 4.77953 9.11869 4.77918 9.11764L4.77973 9.11913ZM4.88088 9.22027C4.88091 9.22026 4.88143 9.22044 4.88236 9.22082L4.88088 9.22027ZM9.11913 9.22027C9.11916 9.22028 9.11869 9.22048 9.11764 9.22082L9.11913 9.22027ZM9.22028 9.11913C9.22027 9.11909 9.22044 9.11856 9.22084 9.11761L9.22028 9.11913ZM9.22028 4.88088C9.22029 4.88085 9.22048 4.88132 9.22084 4.88239L9.22028 4.88088ZM9.11764 4.77918C9.11869 4.77952 9.11916 4.77972 9.11913 4.77973L9.11764 4.77918ZM15.5738 3.25H18.4262C18.6837 3.24998 18.9202 3.24996 19.1179 3.26612C19.331 3.28353 19.5642 3.32339 19.7945 3.44074C20.1238 3.60852 20.3915 3.87623 20.5593 4.20552C20.6766 4.43582 20.7165 4.669 20.7339 4.88213C20.75 5.07981 20.75 5.31629 20.75 5.57377V8.42623C20.75 8.68371 20.75 8.92019 20.7339 9.11787C20.7165 9.33101 20.6766 9.56418 20.5593 9.79448C20.3915 10.1238 20.1238 10.3915 19.7945 10.5593C19.5642 10.6766 19.331 10.7165 19.1179 10.7339C18.9202 10.75 18.6837 10.75 18.4262 10.75H15.5738C15.3163 10.75 15.0798 10.75 14.8821 10.7339C14.669 10.7165 14.4358 10.6766 14.2055 10.5593C13.8762 10.3915 13.6085 10.1238 13.4407 9.79448C13.3234 9.56418 13.2835 9.33101 13.2661 9.11787C13.25 8.92019 13.25 8.68371 13.25 8.42623V5.57377C13.25 5.31629 13.25 5.07981 13.2661 4.88213C13.2835 4.669 13.3234 4.43582 13.4407 4.20552C13.6085 3.87623 13.8762 3.60852 14.2055 3.44074C14.4358 3.32339 14.669 3.28353 14.8821 3.26612C15.0798 3.24996 15.3163 3.24998 15.5738 3.25ZM14.8809 4.77973C14.8808 4.77972 14.8813 4.77953 14.8824 4.77918L14.8809 4.77973ZM14.8835 4.77882C14.8923 4.77607 14.9255 4.76757 15.0043 4.76113C15.1334 4.75058 15.3076 4.75 15.6 4.75H18.4C18.6924 4.75 18.8666 4.75058 18.9957 4.76113C19.0745 4.76757 19.1077 4.77607 19.1165 4.77882C19.1612 4.80234 19.1977 4.83882 19.2212 4.88346C19.2239 4.89234 19.2324 4.92547 19.2389 5.00428C19.2494 5.1334 19.25 5.3076 19.25 5.6V8.4C19.25 8.6924 19.2494 8.8666 19.2389 8.99572C19.2324 9.07453 19.2239 9.10766 19.2212 9.11654C19.1977 9.16118 19.1612 9.19766 19.1165 9.22118C19.1077 9.22393 19.0745 9.23243 18.9957 9.23887C18.8666 9.24942 18.6924 9.25 18.4 9.25H15.6C15.3076 9.25 15.1334 9.24942 15.0043 9.23887C14.9255 9.23243 14.8923 9.22393 14.8835 9.22118C14.8388 9.19766 14.8023 9.16118 14.7788 9.11654C14.7761 9.10766 14.7676 9.07453 14.7611 8.99572C14.7506 8.8666 14.75 8.6924 14.75 8.4V5.6C14.75 5.3076 14.7506 5.1334 14.7611 5.00428C14.7676 4.92547 14.7761 4.89234 14.7788 4.88346C14.8023 4.83882 14.8388 4.80234 14.8835 4.77882ZM14.7797 4.88088C14.7797 4.8809 14.7796 4.88143 14.7792 4.88236L14.7797 4.88088ZM14.7797 9.11913C14.7797 9.11915 14.7795 9.11867 14.7792 9.11761L14.7797 9.11913ZM14.8809 9.22027C14.8809 9.22026 14.8814 9.22044 14.8824 9.22082L14.8809 9.22027ZM19.1191 9.22027C19.1192 9.22028 19.1187 9.22048 19.1176 9.22082L19.1191 9.22027ZM19.2203 9.11913C19.2203 9.11911 19.2204 9.11857 19.2208 9.11761L19.2203 9.11913ZM19.2203 4.88088C19.2203 4.88085 19.2205 4.88131 19.2208 4.88236L19.2203 4.88088ZM19.1176 4.77917C19.1187 4.77952 19.1192 4.77972 19.1191 4.77973L19.1176 4.77917ZM5.57377 13.25H8.42623C8.68372 13.25 8.92019 13.25 9.11787 13.2661C9.33101 13.2835 9.56418 13.3234 9.79449 13.4407C10.1238 13.6085 10.3915 13.8762 10.5593 14.2055C10.6766 14.4358 10.7165 14.669 10.7339 14.8821C10.75 15.0798 10.75 15.3163 10.75 15.5738V18.4262C10.75 18.6837 10.75 18.9202 10.7339 19.1179C10.7165 19.331 10.6766 19.5642 10.5593 19.7945C10.3915 20.1238 10.1238 20.3915 9.79449 20.5593C9.56418 20.6766 9.33101 20.7165 9.11787 20.7339C8.92019 20.75 8.68372 20.75 8.42623 20.75H5.57377C5.31629 20.75 5.07981 20.75 4.88213 20.7339C4.669 20.7165 4.43583 20.6766 4.20552 20.5593C3.87624 20.3915 3.60852 20.1238 3.44074 19.7945C3.32339 19.5642 3.28353 19.331 3.26612 19.1179C3.24997 18.9202 3.24998 18.6837 3.25 18.4262V15.5738C3.24998 15.3163 3.24997 15.0798 3.26612 14.8821C3.28353 14.669 3.32339 14.4358 3.44074 14.2055C3.60852 13.8762 3.87624 13.6085 4.20552 13.4407C4.43583 13.3234 4.669 13.2835 4.88213 13.2661C5.07981 13.25 5.31629 13.25 5.57377 13.25ZM4.88088 14.7797C4.88085 14.7797 4.88131 14.7795 4.88237 14.7792L4.88088 14.7797ZM4.88346 14.7788C4.89234 14.7761 4.92546 14.7676 5.00428 14.7611C5.13341 14.7506 5.3076 14.75 5.6 14.75H8.4C8.6924 14.75 8.8666 14.7506 8.99573 14.7611C9.07453 14.7676 9.10766 14.7761 9.11654 14.7788C9.16118 14.8023 9.19766 14.8388 9.22118 14.8835C9.22393 14.8923 9.23243 14.9255 9.23887 15.0043C9.24942 15.1334 9.25 15.3076 9.25 15.6V18.4C9.25 18.6924 9.24942 18.8666 9.23887 18.9957C9.23243 19.0745 9.22393 19.1077 9.22118 19.1165C9.19766 19.1612 9.16118 19.1977 9.11654 19.2212C9.10767 19.2239 9.07454 19.2324 8.99573 19.2389C8.8666 19.2494 8.6924 19.25 8.4 19.25H5.6C5.3076 19.25 5.13341 19.2494 5.00428 19.2389C4.92547 19.2324 4.89235 19.2239 4.88347 19.2212C4.83883 19.1977 4.80235 19.1612 4.77883 19.1165C4.77607 19.1077 4.76757 19.0745 4.76114 18.9957C4.75059 18.8666 4.75 18.6924 4.75 18.4V15.6C4.75 15.3076 4.75059 15.1334 4.76114 15.0043C4.76757 14.9255 4.77607 14.8923 4.77883 14.8835C4.80234 14.8388 4.83882 14.8023 4.88346 14.7788ZM4.77973 14.8809C4.77974 14.8809 4.77956 14.8814 4.77918 14.8824L4.77973 14.8809ZM4.77973 19.1191C4.77972 19.1192 4.77953 19.1187 4.77918 19.1176L4.77973 19.1191ZM4.88088 19.2203C4.8809 19.2203 4.88143 19.2204 4.88236 19.2208L4.88088 19.2203ZM9.11913 19.2203C9.11917 19.2203 9.1187 19.2205 9.11762 19.2208L9.11913 19.2203ZM9.22028 19.1191C9.22026 19.1191 9.22044 19.1185 9.22087 19.1175L9.22028 19.1191ZM9.22027 14.8809C9.22028 14.8808 9.22048 14.8813 9.22084 14.8824L9.22027 14.8809ZM9.11761 14.7792C9.11868 14.7795 9.11915 14.7797 9.11913 14.7797L9.11761 14.7792ZM17 13.25C17.4142 13.25 17.75 13.5858 17.75 14V16.25H20C20.4142 16.25 20.75 16.5858 20.75 17C20.75 17.4142 20.4142 17.75 20 17.75H17.75V20C17.75 20.4142 17.4142 20.75 17 20.75C16.5858 20.75 16.25 20.4142 16.25 20V17.75H14C13.5858 17.75 13.25 17.4142 13.25 17C13.25 16.5858 13.5858 16.25 14 16.25H16.25V14C16.25 13.5858 16.5858 13.25 17 13.25Z"
  />
</svg>`,LL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.25 7C2.25 5.48122 3.48122 4.25 5 4.25H19C20.5188 4.25 21.75 5.48122 21.75 7V17C21.75 18.5188 20.5188 19.75 19 19.75H5C3.48122 19.75 2.25 18.5188 2.25 17V7ZM5 5.75C4.30964 5.75 3.75 6.30964 3.75 7V17C3.75 17.6904 4.30964 18.25 5 18.25H19C19.6904 18.25 20.25 17.6904 20.25 17V7C20.25 6.30964 19.6904 5.75 19 5.75H5Z"
  />
</svg>`,ML=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M3.75 9.5C3.75 6.32436 6.32436 3.75 9.5 3.75C12.6756 3.75 15.25 6.32436 15.25 9.5C15.25 12.6756 12.6756 15.25 9.5 15.25C6.32436 15.25 3.75 12.6756 3.75 9.5ZM9.5 2.25C5.49594 2.25 2.25 5.49594 2.25 9.5C2.25 13.5041 5.49594 16.75 9.5 16.75C11.2319 16.75 12.8219 16.1427 14.0689 15.1295L19.4697 20.5303C19.7626 20.8232 20.2374 20.8232 20.5303 20.5303C20.8232 20.2374 20.8232 19.7626 20.5303 19.4697L15.1295 14.0689C16.1427 12.8219 16.75 11.2319 16.75 9.5C16.75 5.49594 13.5041 2.25 9.5 2.25Z"
    />
  </svg>
`,f3=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="20"
  height="20"
  viewBox="0 0 24 24"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.25 12C3.25 7.16751 7.16751 3.25 12 3.25C14.2406 3.25 16.286 4.09311 17.8335 5.4782L17.8359 5.48034L19.25 6.75695V4C19.25 3.58579 19.5858 3.25 20 3.25C20.4142 3.25 20.75 3.58579 20.75 4V8.44444C20.75 8.85866 20.4142 9.19444 20 9.19444H15.5556C15.1413 9.19444 14.8056 8.85866 14.8056 8.44444C14.8056 8.03023 15.1413 7.69444 15.5556 7.69444H18.05L16.8331 6.5959C16.8327 6.59554 16.8323 6.59518 16.8319 6.59483C15.5489 5.44701 13.8568 4.75 12 4.75C7.99594 4.75 4.75 7.99594 4.75 12C4.75 16.0041 7.99594 19.25 12 19.25C15.4494 19.25 18.3378 16.8403 19.0704 13.6118C19.162 13.2079 19.5638 12.9547 19.9677 13.0464C20.3717 13.138 20.6248 13.5398 20.5332 13.9437C19.6489 17.8405 16.1651 20.75 12 20.75C7.16751 20.75 3.25 16.8325 3.25 12Z"
    fill="currentColor"
  />
</svg>`,PL=Ht`<g id="Web">
  <path
    id="Shape (Stroke)"
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.78363 11.25H8.26C8.32021 8.99973 8.64952 6.95181 9.16717 5.39887C9.32825 4.91563 9.51187 4.46715 9.7189 4.06941C6.50351 4.99257 4.09288 7.81832 3.78363 11.25ZM12 2.25C6.61522 2.25 2.25 6.61522 2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25ZM12 3.75C11.9141 3.75 11.7129 3.80155 11.4213 4.17149C11.1364 4.53298 10.8471 5.10255 10.5902 5.87321C10.1323 7.24686 9.82057 9.12821 9.76056 11.25H14.2394C14.1794 9.12821 13.8677 7.24686 13.4098 5.87321C13.1529 5.10255 12.8636 4.53298 12.5787 4.17149C12.2871 3.80155 12.0859 3.75 12 3.75ZM15.74 11.25C15.6798 8.99973 15.3505 6.95181 14.8328 5.39887C14.6718 4.91563 14.4881 4.46715 14.2811 4.06941C17.4965 4.99257 19.9071 7.81832 20.2164 11.25H15.74ZM14.2394 12.75H9.76056C9.82057 14.8718 10.1323 16.7531 10.5902 18.1268C10.8471 18.8975 11.1364 19.467 11.4213 19.8285C11.7129 20.1985 11.9141 20.25 12 20.25C12.0859 20.25 12.2871 20.1985 12.5787 19.8285C12.8636 19.467 13.1529 18.8975 13.4098 18.1268C13.8677 16.7531 14.1794 14.8718 14.2394 12.75ZM14.2811 19.9306C14.4881 19.5329 14.6718 19.0844 14.8328 18.6011C15.3505 17.0482 15.6798 15.0003 15.74 12.75H20.2164C19.9071 16.1817 17.4965 19.0074 14.2811 19.9306ZM9.7189 19.9306C9.51187 19.5329 9.32825 19.0844 9.16717 18.6011C8.64952 17.0482 8.32021 15.0003 8.26 12.75H3.78363C4.09288 16.1817 6.50351 19.0074 9.7189 19.9306Z"
  />
</g>`,b8=rn(PL,16),cb=b` <svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M17.6726 6.0059L7.49998 16.1785L2.32739 11.0059L3.5059 9.82739L7.49998 13.8215L16.4941 4.82739L17.6726 6.0059Z"
  />
</svg>`,db=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M18.3032 4.49775C18.6342 4.16742 19.1714 4.16742 19.5024 4.49775C19.8326 4.82726 19.8326 5.3609 19.5024 5.69041L19.0739 6.1181L17.8768 4.92334L18.3032 4.49775ZM16.8151 5.98296L18.0122 7.17771L10.9259 14.25H9.75006V13.0341L16.8151 5.98296ZM20.562 3.43604C19.6455 2.52132 18.1601 2.52132 17.2436 3.43604L8.47025 12.1921C8.32928 12.3328 8.25006 12.5238 8.25006 12.723V15C8.25006 15.4142 8.58585 15.75 9.00006 15.75H11.2362C11.4348 15.75 11.6254 15.6712 11.766 15.5309L20.562 6.75212C21.4794 5.83658 21.4794 4.35158 20.562 3.43604ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H12C12.4142 4.75 12.75 4.41421 12.75 4C12.75 3.58579 12.4142 3.25 12 3.25H6C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V12C20.75 11.5858 20.4142 11.25 20 11.25C19.5858 11.25 19.25 11.5858 19.25 12V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6Z"
      fill="currentColor"
    />
  </svg>
`,oo=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    class="open-icon"
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M11.0416 3.33325C11.0416 2.98807 11.3214 2.70825 11.6666 2.70825H16.6666C17.0118 2.70825 17.2916 2.98807 17.2916 3.33325V8.33325C17.2916 8.67843 17.0118 8.95825 16.6666 8.95825C16.3214 8.95825 16.0416 8.67843 16.0416 8.33325V4.84214L8.77519 12.1085C8.53112 12.3526 8.13539 12.3526 7.89131 12.1085C7.64723 11.8644 7.64723 11.4687 7.89131 11.2246L15.1577 3.95825H11.6666C11.3214 3.95825 11.0416 3.67843 11.0416 3.33325ZM4.99992 5.62492C4.42462 5.62492 3.95825 6.09129 3.95825 6.66659V14.9999C3.95825 15.5752 4.42462 16.0416 4.99992 16.0416H13.3333C13.9085 16.0416 14.3749 15.5752 14.3749 14.9999V11.6666C14.3749 11.3214 14.6547 11.0416 14.9999 11.0416C15.3451 11.0416 15.6249 11.3214 15.6249 11.6666V14.9999C15.6249 16.2656 14.5989 17.2916 13.3333 17.2916H4.99992C3.73427 17.2916 2.70825 16.2656 2.70825 14.9999V6.66659C2.70825 5.40093 3.73427 4.37492 4.99992 4.37492H8.33325C8.67843 4.37492 8.95825 4.65474 8.95825 4.99992C8.95825 5.3451 8.67843 5.62492 8.33325 5.62492H4.99992Z"
    fill="#77757D"
  />
</svg>`,p0=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M18.3032 4.49775C18.6342 4.16742 19.1714 4.16742 19.5024 4.49775C19.8326 4.82726 19.8326 5.3609 19.5024 5.69041L19.0739 6.1181L17.8768 4.92334L18.3032 4.49775ZM16.8151 5.98296L18.0122 7.17771L10.9259 14.25H9.75006V13.0341L16.8151 5.98296ZM20.562 3.43604C19.6455 2.52132 18.1601 2.52132 17.2436 3.43604L8.47025 12.1921C8.32928 12.3328 8.25006 12.5238 8.25006 12.723V15C8.25006 15.4142 8.58585 15.75 9.00006 15.75H11.2362C11.4348 15.75 11.6254 15.6712 11.766 15.5309L20.562 6.75212C21.4794 5.83658 21.4794 4.35158 20.562 3.43604ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H12C12.4142 4.75 12.75 4.41421 12.75 4C12.75 3.58579 12.4142 3.25 12 3.25H6C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V12C20.75 11.5858 20.4142 11.25 20 11.25C19.5858 11.25 19.25 11.5858 19.25 12V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6Z"
  />
</svg>`,ub=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M14.522 5.34979C15.6618 4.2099 17.51 4.2099 18.6499 5.34979C19.7897 6.48968 19.7897 8.3378 18.6499 9.47769L14.981 13.1466C14.6881 13.4394 14.6881 13.9143 14.981 14.2072C15.2739 14.5001 15.7488 14.5001 16.0416 14.2072L19.7105 10.5383C21.4362 8.81267 21.4362 6.0148 19.7105 4.28913C17.9848 2.56345 15.187 2.56345 13.4613 4.28913L12.4527 5.29771C12.1598 5.5906 12.1598 6.06548 12.4527 6.35837C12.7456 6.65126 13.2205 6.65126 13.5134 6.35837L14.522 5.34979ZM9.01866 10.8531C9.31155 10.5602 9.31155 10.0853 9.01866 9.79243C8.72576 9.49954 8.25089 9.49954 7.958 9.79243L4.28913 13.4613C2.56345 15.187 2.56345 17.9848 4.28913 19.7105C6.0148 21.4362 8.81267 21.4362 10.5383 19.7105L11.5487 18.7001C11.8416 18.4073 11.8416 17.9324 11.5487 17.6395C11.2558 17.3466 10.781 17.3466 10.4881 17.6395L9.47769 18.6499C8.3378 19.7897 6.48968 19.7897 5.34979 18.6499C4.2099 17.51 4.2099 15.6618 5.34979 14.522L9.01866 10.8531ZM9.39547 4.49363C9.30233 4.09002 8.89964 3.83834 8.49603 3.93148C8.09242 4.02462 7.84074 4.42731 7.93388 4.83092L8.33412 6.56529C8.42726 6.9689 8.82995 7.22058 9.23356 7.12744C9.63717 7.0343 9.88885 6.63161 9.79571 6.228L9.39547 4.49363ZM4.83092 7.93388C4.42731 7.84074 4.02462 8.09242 3.93148 8.49603C3.83834 8.89964 4.09002 9.30233 4.49363 9.39547L6.228 9.79571C6.63161 9.88885 7.0343 9.63717 7.12744 9.23356C7.22058 8.82995 6.9689 8.42726 6.56529 8.33412L4.83092 7.93388ZM17.772 14.2043C17.3684 14.1112 16.9657 14.3629 16.8726 14.7665C16.7794 15.1701 17.0311 15.5728 17.4347 15.6659L19.1691 16.0661C19.5727 16.1593 19.9754 15.9076 20.0685 15.504C20.1617 15.1004 19.91 14.6977 19.5064 14.6045L17.772 14.2043ZM15.6659 17.4347C15.5728 17.0311 15.1701 16.7794 14.7665 16.8726C14.3629 16.9657 14.1112 17.3684 14.2043 17.772L14.6045 19.5064C14.6977 19.91 15.1004 20.1617 15.504 20.0685C15.9076 19.9754 16.1593 19.5727 16.0661 19.1691L15.6659 17.4347Z"
  />
</svg>`,Kd=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M4.25 7C4.25 5.48122 5.48122 4.25 7 4.25H12C13.5188 4.25 14.75 5.48122 14.75 7V10C14.75 11.5188 13.5188 12.75 12 12.75H7C5.48122 12.75 4.25 11.5188 4.25 10V7ZM7 5.75C6.30964 5.75 5.75 6.30964 5.75 7V10C5.75 10.6904 6.30964 11.25 7 11.25H12C12.6904 11.25 13.25 10.6904 13.25 10V7C13.25 6.30964 12.6904 5.75 12 5.75H7ZM4.25 15.5C4.25 15.0858 4.58579 14.75 5 14.75H19C19.4142 14.75 19.75 15.0858 19.75 15.5C19.75 15.9142 19.4142 16.25 19 16.25H5C4.58579 16.25 4.25 15.9142 4.25 15.5ZM5 18.25C4.58579 18.25 4.25 18.5858 4.25 19C4.25 19.4142 4.58579 19.75 5 19.75H14C14.4142 19.75 14.75 19.4142 14.75 19C14.75 18.5858 14.4142 18.25 14 18.25H5Z"
  />
</svg>`,g3=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M12.75 4.75C12.75 4.33579 12.4142 4 12 4C11.5858 4 11.25 4.33579 11.25 4.75L11.25 13.4393L9.03033 11.2197C8.73744 10.9268 8.26256 10.9268 7.96967 11.2197C7.67678 11.5126 7.67678 11.9874 7.96967 12.2803L11.4697 15.7803C11.6103 15.921 11.8011 16 12 16C12.1989 16 12.3897 15.921 12.5303 15.7803L16.0303 12.2803C16.3232 11.9874 16.3232 11.5126 16.0303 11.2197C15.7374 10.9268 15.2626 10.9268 14.9697 11.2197L12.75 13.4393L12.75 4.75ZM4.75 10.75C4.75 10.6119 4.86193 10.5 5 10.5H6C6.41421 10.5 6.75 10.1642 6.75 9.75C6.75 9.33579 6.41421 9 6 9H5C4.0335 9 3.25 9.7835 3.25 10.75V17.75C3.25 19.2688 4.48122 20.5 6 20.5H18C19.5188 20.5 20.75 19.2688 20.75 17.75V10.75C20.75 9.7835 19.9665 9 19 9H18C17.5858 9 17.25 9.33579 17.25 9.75C17.25 10.1642 17.5858 10.5 18 10.5H19C19.1381 10.5 19.25 10.6119 19.25 10.75V17.75C19.25 18.4404 18.6904 19 18 19H6C5.30964 19 4.75 18.4404 4.75 17.75V10.75Z"
  />
</svg>`,AL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M11.046 5C11.046 4.58579 11.3818 4.25 11.796 4.25H14.6776C18.0311 4.25 20.7497 6.96849 20.7498 10.322C20.7499 13.6757 18.0313 16.3944 14.6776 16.3944H5.78857L8.81522 19.4743C9.10555 19.7697 9.10141 20.2446 8.80598 20.5349C8.51054 20.8253 8.03569 20.8211 7.74536 20.5257L3.46507 16.1701C3.17831 15.8783 3.17831 15.4105 3.46507 15.1187L7.74536 10.7632C8.03569 10.4677 8.51054 10.4636 8.80598 10.7539C9.10141 11.0443 9.10555 11.5191 8.81522 11.8146L5.78857 14.8944H14.6776C17.2028 14.8944 19.2499 12.8473 19.2498 10.3221C19.2497 7.79695 17.2027 5.75 14.6776 5.75H11.796C11.3818 5.75 11.046 5.41421 11.046 5Z"
  />
</svg>`,$L=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M16.5303 2.46967C16.2374 2.17678 15.7626 2.17678 15.4697 2.46967C15.1768 2.76256 15.1768 3.23744 15.4697 3.53033L18.1893 6.25L8 6.25C7.58579 6.25 7.25 6.58579 7.25 7C7.25 7.41421 7.58579 7.75 8 7.75H18.1893L15.4697 10.4697C15.1768 10.7626 15.1768 11.2374 15.4697 11.5303C15.7626 11.8232 16.2374 11.8232 16.5303 11.5303L20.5303 7.53033C20.671 7.38968 20.75 7.19891 20.75 7C20.75 6.80109 20.671 6.61032 20.5303 6.46967L16.5303 2.46967ZM11.5303 11.4697C11.2374 11.1768 10.7626 11.1768 10.4697 11.4697C10.1768 11.7626 10.1768 12.2374 10.4697 12.5303L13.1893 15.25H4.5C4.08579 15.25 3.75 15.5858 3.75 16C3.75 16.4142 4.08579 16.75 4.5 16.75H13.1893L10.4697 19.4697C10.1768 19.7626 10.1768 20.2374 10.4697 20.5303C10.7626 20.8232 11.2374 20.8232 11.5303 20.5303L15.5303 16.5303C15.671 16.3897 15.75 16.1989 15.75 16C15.75 15.8011 15.671 15.6103 15.5303 15.4697L11.5303 11.4697Z"
  />
</svg>`,BL=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M12.0004 5.75C8.06451 5.75 4.70095 8.20857 3.36528 11.6764C3.28512 11.8845 3.28512 12.1155 3.36527 12.3236C4.70093 15.7914 8.06451 18.25 12.0005 18.25C15.9364 18.25 19.2999 15.7914 20.6356 12.3236C20.7158 12.1155 20.7158 11.8846 20.6356 11.6764C19.3 8.2086 15.9364 5.75 12.0004 5.75ZM1.96552 11.1372C3.51675 7.10978 7.42369 4.25 12.0004 4.25C16.5772 4.25 20.4842 7.10982 22.0354 11.1373C22.2492 11.6924 22.2492 12.3077 22.0354 12.8628C20.4841 16.8902 16.5772 19.75 12.0005 19.75C7.42369 19.75 3.51672 16.8902 1.96551 12.8627C1.75171 12.3076 1.75171 11.6923 1.96552 11.1372ZM12 9.75C10.7574 9.75 9.74999 10.7574 9.74999 12C9.74999 13.2426 10.7574 14.25 12 14.25C13.2426 14.25 14.25 13.2426 14.25 12C14.25 10.7574 13.2426 9.75 12 9.75ZM8.24999 12C8.24999 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.24999 14.0711 8.24999 12Z"
  />
</svg>`,Qd=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M5 3.25C3.48122 3.25 2.25 4.48122 2.25 6V9V18C2.25 19.5188 3.48122 20.75 5 20.75H19C20.5188 20.75 21.75 19.5188 21.75 18V9V6C21.75 4.48122 20.5188 3.25 19 3.25H5ZM20.25 8.25V6C20.25 5.30964 19.6904 4.75 19 4.75H5C4.30964 4.75 3.75 5.30964 3.75 6V8.25H20.25ZM3.75 9.75H20.25V18C20.25 18.6904 19.6904 19.25 19 19.25H5C4.30964 19.25 3.75 18.6904 3.75 18V9.75ZM10.5303 13.0304C10.8232 12.7375 10.8232 12.2627 10.5303 11.9698C10.2374 11.6769 9.76256 11.6769 9.46967 11.9698L7.34835 14.0911C7.05546 14.384 7.05546 14.8589 7.34835 15.1518L9.46967 17.2731C9.76256 17.566 10.2374 17.566 10.5303 17.2731C10.8232 16.9802 10.8232 16.5053 10.5303 16.2124L8.93934 14.6214L10.5303 13.0304ZM13.4697 11.9698C13.1768 12.2627 13.1768 12.7375 13.4697 13.0304L15.0607 14.6214L13.4697 16.2124C13.1768 16.5053 13.1768 16.9802 13.4697 17.2731C13.7626 17.566 14.2374 17.566 14.5303 17.2731L16.6517 15.1518C16.9445 14.8589 16.9445 14.384 16.6517 14.0911L14.5303 11.9698C14.2374 11.6769 13.7626 11.6769 13.4697 11.9698ZM6.5 6.55005C6.5 6.96426 6.16421 7.30005 5.75 7.30005C5.33579 7.30005 5 6.96426 5 6.55005C5 6.13584 5.33579 5.80005 5.75 5.80005C6.16421 5.80005 6.5 6.13584 6.5 6.55005ZM8.25 7.30005C8.66421 7.30005 9 6.96426 9 6.55005C9 6.13584 8.66421 5.80005 8.25 5.80005C7.83579 5.80005 7.5 6.13584 7.5 6.55005C7.5 6.96426 7.83579 7.30005 8.25 7.30005Z"
  />
</svg>`,m3=b` <svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M6.46967 9.46967C6.76256 9.17678 7.23744 9.17678 7.53033 9.46967L11.6464 13.5858C11.8417 13.781 12.1583 13.781 12.3536 13.5858L16.4697 9.46967C16.7626 9.17678 17.2374 9.17678 17.5303 9.46967C17.8232 9.76256 17.8232 10.2374 17.5303 10.5303L13.4142 14.6464C12.6332 15.4275 11.3668 15.4275 10.5858 14.6464L6.46967 10.5303C6.17678 10.2374 6.17678 9.76256 6.46967 9.46967Z"
  />
</svg>`,Ph=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M11.7202 5.98043C11.9154 6.17569 11.9154 6.49228 11.7202 6.68754L8.38684 10.0209C8.19158 10.2161 7.87499 10.2161 7.67973 10.0209L4.3464 6.68754C4.15114 6.49228 4.15114 6.17569 4.3464 5.98043C4.54166 5.78517 4.85824 5.78517 5.0535 5.98043L8.03328 8.96021L11.0131 5.98043C11.2083 5.78517 11.5249 5.78517 11.7202 5.98043Z"
  />
</svg>`,hb=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M7 3.25C5.48122 3.25 4.25 4.48122 4.25 6V18C4.25 19.5188 5.48122 20.75 7 20.75H17C18.5188 20.75 19.75 19.5188 19.75 18V6C19.75 4.48122 18.5188 3.25 17 3.25H7ZM5.75 6C5.75 5.30964 6.30964 4.75 7 4.75H17C17.6904 4.75 18.25 5.30964 18.25 6V18C18.25 18.6904 17.6904 19.25 17 19.25H7C6.30964 19.25 5.75 18.6904 5.75 18V6ZM9 7.25C8.58579 7.25 8.25 7.58579 8.25 8C8.25 8.41421 8.58579 8.75 9 8.75H12.5C12.9142 8.75 13.25 8.41421 13.25 8C13.25 7.58579 12.9142 7.25 12.5 7.25H9ZM8.25 11.5C8.25 11.0858 8.58579 10.75 9 10.75H15C15.4142 10.75 15.75 11.0858 15.75 11.5C15.75 11.9142 15.4142 12.25 15 12.25H9C8.58579 12.25 8.25 11.9142 8.25 11.5ZM9 14.25C8.58579 14.25 8.25 14.5858 8.25 15C8.25 15.4142 8.58579 15.75 9 15.75H14C14.4142 15.75 14.75 15.4142 14.75 15C14.75 14.5858 14.4142 14.25 14 14.25H9Z"/>`,DL=Ht`
<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4.25 6C4.25 4.48122 5.48122 3.25 7 3.25H17C18.5188 3.25 19.75 4.48122 19.75 6V12C19.75 12.4142 19.4142 12.75 19 12.75C18.5858 12.75 18.25 12.4142 18.25 12V6C18.25 5.30964 17.6904 4.75 17 4.75H7C6.30964 4.75 5.75 5.30964 5.75 6V18C5.75 18.6904 6.30964 19.25 7 19.25H12C12.4142 19.25 12.75 19.5858 12.75 20C12.75 20.4142 12.4142 20.75 12 20.75H7C5.48122 20.75 4.25 19.5188 4.25 18V6ZM8.25 8C8.25 7.58579 8.58579 7.25 9 7.25H12C12.4142 7.25 12.75 7.58579 12.75 8C12.75 8.41421 12.4142 8.75 12 8.75H9C8.58579 8.75 8.25 8.41421 8.25 8ZM9 10.75C8.58579 10.75 8.25 11.0858 8.25 11.5C8.25 11.9142 8.58579 12.25 9 12.25H15C15.4142 12.25 15.75 11.9142 15.75 11.5C15.75 11.0858 15.4142 10.75 15 10.75H9ZM8.25 15C8.25 14.5858 8.58579 14.25 9 14.25H11.5C11.9142 14.25 12.25 14.5858 12.25 15C12.25 15.4142 11.9142 15.75 11.5 15.75H9C8.58579 15.75 8.25 15.4142 8.25 15ZM15.5 14.25C15.0858 14.25 14.75 14.5858 14.75 15C14.75 15.4142 15.0858 15.75 15.5 15.75H18.1893L14.4697 19.4697C14.1768 19.7626 14.1768 20.2374 14.4697 20.5303C14.7626 20.8232 15.2374 20.8232 15.5303 20.5303L19.25 16.8107V19.5C19.25 19.9142 19.5858 20.25 20 20.25C20.4142 20.25 20.75 19.9142 20.75 19.5V15C20.75 14.8011 20.671 14.6103 20.5303 14.4697C20.3897 14.329 20.1989 14.25 20 14.25H15.5Z"/>
`,OL=p3(hb),pb=p3(DL),b3=rn(hb,20),v8=rn(hb,16),fb=rn(DL,20),gb=b`<svg
  width="20"
  height="20"
  viewBox="0 0 24 24"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M12 4.75C12.4142 4.75 12.75 5.08579 12.75 5.5V11.25H18.5C18.9142 11.25 19.25 11.5858 19.25 12C19.25 12.4142 18.9142 12.75 18.5 12.75H12.75V18.5C12.75 18.9142 12.4142 19.25 12 19.25C11.5858 19.25 11.25 18.9142 11.25 18.5V12.75L5.5 12.75C5.08579 12.75 4.75 12.4142 4.75 12C4.75 11.5858 5.08579 11.25 5.5 11.25L11.25 11.25V5.5C11.25 5.08579 11.5858 4.75 12 4.75Z"
  />
</svg>`,mb=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M10.6667 6.19995C10.2525 6.19995 9.91667 5.86416 9.91667 5.44995C9.91667 5.03574 10.2525 4.69995 10.6667 4.69995H19C19.4142 4.69995 19.75 5.03574 19.75 5.44995V13.7833C19.75 14.1975 19.4142 14.5333 19 14.5333C18.5858 14.5333 18.25 14.1975 18.25 13.7833V7.26061L6.53033 18.9803C6.23744 19.2732 5.76256 19.2732 5.46967 18.9803C5.17678 18.6874 5.17678 18.2125 5.46967 17.9196L17.1893 6.19995H10.6667Z"/>`,RL=rn(mb,20),v3=rn(mb,16),W1=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M17.5804 8.96967C17.8733 9.26256 17.8733 9.73744 17.5804 10.0303L12.5804 15.0303C12.2875 15.3232 11.8126 15.3232 11.5197 15.0303L6.51972 10.0303C6.22683 9.73744 6.22683 9.26256 6.51972 8.96967C6.81261 8.67678 7.28749 8.67678 7.58038 8.96967L12.05 13.4393L16.5197 8.96967C16.8126 8.67678 17.2875 8.67678 17.5804 8.96967Z"
      fill="currentColor"
    />
  </svg>
`,rl=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M6 12H18M12 6V18"
    stroke="currentColor"
    stroke-linecap="round"
    stroke-linejoin="round"
  />
</svg> `,NL=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M1 18.161C1 18.629 1.38658 18.9647 1.91558 18.9647C2.37337 18.9647 2.63787 18.751 2.81082 18.2627L4.10281 14.6208H9.91166L11.2138 18.2627C11.3868 18.751 11.6513 18.9647 12.1091 18.9647C12.6381 18.9647 13.0246 18.629 13.0246 18.161C13.0246 18.0288 12.9941 17.8762 12.9127 17.6523L8.18223 4.87489C7.95842 4.27467 7.59219 4 7.03267 4C6.43245 4 6.05605 4.28485 5.83224 4.88506L1.1119 17.6523C1.03052 17.8762 1 18.0288 1 18.161ZM9.39283 13.0643H4.63181L6.9818 6.37034H7.04284L9.39283 13.0643ZM13.6533 15.8314C13.6533 17.7337 15.0674 19.0054 17.1732 19.0054C18.5975 19.0054 19.9505 18.2119 20.5812 17.0013H20.6219V18.1101C20.6219 18.6391 20.9678 19.0054 21.4663 19.0054C21.9546 19.0054 22.3005 18.6391 22.3005 18.1101V11.5078C22.3005 9.40193 20.7338 8.05908 18.2516 8.05908C16.5323 8.05908 14.986 8.82206 14.3858 9.9818C14.2434 10.2361 14.1722 10.4905 14.1722 10.7143C14.1722 11.1924 14.4977 11.5078 14.9555 11.5078C15.2912 11.5078 15.5252 11.3755 15.688 11.0805C16.278 10.0327 17.0613 9.61557 18.2109 9.61557C19.6758 9.61557 20.5304 10.3887 20.5304 11.6807V12.5658L17.4886 12.7387C15.0471 12.8811 13.6533 14.0205 13.6533 15.8314ZM20.5304 14.8039C20.5304 16.3298 19.2384 17.4997 17.57 17.4997C16.2984 17.4997 15.454 16.8385 15.454 15.8314C15.454 14.8344 16.2678 14.2037 17.6921 14.1121L20.5304 13.9392V14.8039Z"
      fill="currentColor"
    />
  </svg>
`,HL=Ht`<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M12.2175 5.60799L6.17732 11.6483C4.27429 13.5017 4.27424 16.4984 6.17727 18.3518C8.09138 20.2161 11.2027 20.2161 13.1168 18.3518L19.0068 12.6288C19.3038 12.3401 19.7787 12.347 20.0673 12.644C20.356 12.9411 20.3491 13.4159 20.0521 13.7046L14.1634 19.4264C14.1633 19.4265 14.1635 19.4263 14.1634 19.4264C11.6669 21.8576 7.62711 21.8578 5.1307 19.4264C2.62432 16.9853 2.6231 13.0198 5.12704 10.5772L11.1676 4.53664C12.929 2.82109 15.7769 2.82114 17.5383 4.53669C19.3095 6.26181 19.3108 9.06644 17.542 10.7931L11.5014 16.8337C10.4751 17.8333 8.81906 17.8333 7.79275 16.8337C6.75536 15.8233 6.75536 14.1768 7.79275 13.1664L13.9911 7.12941C14.2879 6.84041 14.7627 6.84667 15.0517 7.1434C15.3407 7.44013 15.3344 7.91497 15.0377 8.20397L8.83932 14.2409C8.4065 14.6625 8.4065 15.3376 8.83932 15.7591C9.28219 16.1904 10.0075 16.1914 10.4517 15.7621L16.4917 9.72209C17.6596 8.58458 17.6596 6.74876 16.4917 5.61124C15.3138 4.46404 13.3968 4.46295 12.2175 5.60799Z"/>`,FL=rn(HL,20),y8=rn(HL,16),UL=b` <svg
  xmlns="http://www.w3.org/2000/svg"
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.62503 4.58336C2.62503 3.50181 3.50181 2.62503 4.58336 2.62503H15.4167C16.4983 2.62503 17.375 3.50181 17.375 4.58336V15.4167C17.375 16.4983 16.4983 17.375 15.4167 17.375H4.58336C3.50181 17.375 2.62503 16.4983 2.62503 15.4167V4.58336Z"
    fill="currentColor"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.625 4.58333C2.625 3.50178 3.50178 2.625 4.58333 2.625H15.4167C16.4982 2.625 17.375 3.50178 17.375 4.58333V15.4167C17.375 16.4982 16.4982 17.375 15.4167 17.375H4.58333C3.50178 17.375 2.625 16.4982 2.625 15.4167V4.58333ZM4.58333 3.20833C3.82394 3.20833 3.20833 3.82394 3.20833 4.58333V15.4167C3.20833 16.1761 3.82394 16.7917 4.58333 16.7917H15.4167C16.1761 16.7917 16.7917 16.1761 16.7917 15.4167V4.58333C16.7917 3.82394 16.1761 3.20833 15.4167 3.20833H4.58333Z"
    fill="black"
    fill-opacity="0.3"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.85183 6.254C9.03131 5.77539 9.48885 5.45831 10 5.45831C10.5112 5.45831 10.9687 5.77539 11.1482 6.254L13.9185 13.6416C14.0397 13.9648 13.876 14.3251 13.5528 14.4463C13.2296 14.5675 12.8693 14.4037 12.7481 14.0805L11.9654 11.9932H8.03465L7.25188 14.0805C7.13068 14.4037 6.77042 14.5675 6.44722 14.4463C6.12402 14.3251 5.96027 13.9648 6.08147 13.6416L8.85183 6.254ZM8.5034 10.7432H11.4966L10 6.7522L8.5034 10.7432Z"
    fill="var(--affine-text-primary-color)"
  />
</svg>`,VL=b` <svg
  xmlns="http://www.w3.org/2000/svg"
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.625 4.58333C2.625 3.50178 3.50178 2.625 4.58333 2.625H15.4167C16.4982 2.625 17.375 3.50178 17.375 4.58333V15.4167C17.375 16.4982 16.4982 17.375 15.4167 17.375H4.58333C3.50178 17.375 2.625 16.4982 2.625 15.4167V4.58333ZM4.58333 3.20833C3.82394 3.20833 3.20833 3.82394 3.20833 4.58333V15.4167C3.20833 16.1761 3.82394 16.7917 4.58333 16.7917H15.4167C16.1761 16.7917 16.7917 16.1761 16.7917 15.4167V4.58333C16.7917 3.82394 16.1761 3.20833 15.4167 3.20833H4.58333Z"
    fill="black"
    fill-opacity="0.3"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.85183 6.254C9.03131 5.77539 9.48885 5.45831 10 5.45831C10.5112 5.45831 10.9687 5.77539 11.1482 6.254L13.9185 13.6416C14.0397 13.9648 13.876 14.3251 13.5528 14.4463C13.2296 14.5675 12.8693 14.4037 12.7481 14.0805L11.9654 11.9932H8.03465L7.25188 14.0805C7.13068 14.4037 6.77042 14.5675 6.44722 14.4463C6.12402 14.3251 5.96027 13.9648 6.08147 13.6416L8.85183 6.254ZM8.5034 10.7432H11.4966L10 6.7522L8.5034 10.7432Z"
    fill="currentColor"
  />
</svg>`,CX=Ht`
  <path d="M5.82912 16.3197L7.91758 18.4082L6.57812 19.7476C6.53121 19.7945 6.46407 19.8151 6.39891 19.8026L3.37038 19.2199C3.21286 19.1896 3.15332 18.9955 3.26674 18.8821L5.82912 16.3197Z" fill="currentColor"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M19.0095 3.51624C17.9526 2.45932 16.26 2.39465 15.1255 3.36783L7.3214 10.0624C6.35443 10.8919 6.0528 12.261 6.58168 13.42L6.73506 13.7562L5.67702 14.8142C5.30174 15.1895 5.30174 15.7979 5.67702 16.1732L8.06384 18.56C8.43912 18.9353 9.04757 18.9353 9.42285 18.56L10.4809 17.502L10.8171 17.6555C11.9761 18.1843 13.3453 17.8827 14.1747 16.9157L20.8693 9.11159C21.8425 7.9771 21.7778 6.28452 20.7209 5.22761L19.0095 3.51624ZM16.1022 4.50634C16.6416 4.04362 17.4463 4.07437 17.9489 4.5769L19.6602 6.28827C20.1628 6.79079 20.1935 7.59555 19.7308 8.13496L14.6424 14.0667L10.1705 9.59469L16.1022 4.50634ZM9.02862 10.5742L8.29803 11.2009C7.83827 11.5953 7.69486 12.2462 7.94632 12.7973L8.2979 13.5678C8.43485 13.8679 8.37953 14.233 8.13377 14.4788L7.11884 15.4937L8.74335 17.1182L9.75818 16.1034C10.004 15.8576 10.3692 15.8023 10.6693 15.9392L11.4398 16.2908C11.9909 16.5423 12.6419 16.3989 13.0362 15.9391L13.663 15.2085L9.02862 10.5742Z" fill="#77757D"/>
`,bb=rn(CX,20),zL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M13.0032 6.4927C12.723 6.79778 12.7432 7.27223 13.0483 7.5524L17.0745 11.25L5 11.25C4.58579 11.25 4.25 11.5858 4.25 12C4.25 12.4142 4.58579 12.75 5 12.75L17.0745 12.75L13.0483 16.4476C12.7432 16.7278 12.723 17.2022 13.0032 17.5073C13.2833 17.8124 13.7578 17.8326 14.0629 17.5524L19.5073 12.5524C19.662 12.4104 19.75 12.21 19.75 12C19.75 11.79 19.662 11.5896 19.5073 11.4476L14.0629 6.44761C13.7578 6.16743 13.2833 6.18762 13.0032 6.4927Z"
    fill="currentColor"
  />
</svg>`,vb=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M10.9968 6.4927C11.277 6.79778 11.2568 7.27223 10.9517 7.5524L6.92547 11.25L19 11.25C19.4142 11.25 19.75 11.5858 19.75 12C19.75 12.4142 19.4142 12.75 19 12.75L6.92547 12.75L10.9517 16.4476C11.2568 16.7278 11.277 17.2022 10.9968 17.5073C10.7167 17.8124 10.2422 17.8326 9.93714 17.5524L4.4927 12.5524C4.33803 12.4104 4.25 12.21 4.25 12C4.25 11.79 4.33803 11.5896 4.4927 11.4476L9.93714 6.44761C10.2422 6.16743 10.7167 6.18762 10.9968 6.4927Z"
    fill="currentColor"
  />
</svg> `,jL=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.25 5C4.25 4.58579 4.58579 4.25 5 4.25H8.5C8.91421 4.25 9.25 4.58579 9.25 5C9.25 5.41421 8.91421 5.75 8.5 5.75H6.81066L9.90533 8.84467C10.1982 9.13756 10.1982 9.61244 9.90533 9.90533C9.61244 10.1982 9.13756 10.1982 8.84467 9.90533L5.75 6.81066V8.5C5.75 8.91421 5.41421 9.25 5 9.25C4.58579 9.25 4.25 8.91421 4.25 8.5V5ZM14.75 5C14.75 4.58579 15.0858 4.25 15.5 4.25H19C19.4142 4.25 19.75 4.58579 19.75 5V8.5C19.75 8.91421 19.4142 9.25 19 9.25C18.5858 9.25 18.25 8.91421 18.25 8.5V6.81066L15.1553 9.90533C14.8624 10.1982 14.3876 10.1982 14.0947 9.90533C13.8018 9.61244 13.8018 9.13756 14.0947 8.84467L17.1893 5.75H15.5C15.0858 5.75 14.75 5.41421 14.75 5ZM9.90533 14.0947C10.1982 14.3876 10.1982 14.8624 9.90533 15.1553L6.81066 18.25H8.5C8.91421 18.25 9.25 18.5858 9.25 19C9.25 19.4142 8.91421 19.75 8.5 19.75H5C4.58579 19.75 4.25 19.4142 4.25 19V15.5C4.25 15.0858 4.58579 14.75 5 14.75C5.41421 14.75 5.75 15.0858 5.75 15.5V17.1893L8.84467 14.0947C9.13756 13.8018 9.61244 13.8018 9.90533 14.0947ZM14.0947 14.0947C14.3876 13.8018 14.8624 13.8018 15.1553 14.0947L18.25 17.1893V15.5C18.25 15.0858 18.5858 14.75 19 14.75C19.4142 14.75 19.75 15.0858 19.75 15.5V19C19.75 19.4142 19.4142 19.75 19 19.75H15.5C15.0858 19.75 14.75 19.4142 14.75 19C14.75 18.5858 15.0858 18.25 15.5 18.25H17.1893L14.0947 15.1553C13.8018 14.8624 13.8018 14.3876 14.0947 14.0947Z"
    fill="currentColor"
  />
</svg> `,yb=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M15.25 4C15.25 3.58579 15.5858 3.25 16 3.25H20C20.4142 3.25 20.75 3.58579 20.75 4V8C20.75 8.41421 20.4142 8.75 20 8.75C19.5858 8.75 19.25 8.41421 19.25 8V5.81066L15.0303 10.0303C14.7374 10.3232 14.2626 10.3232 13.9697 10.0303C13.6768 9.73744 13.6768 9.26256 13.9697 8.96967L18.1893 4.75H16C15.5858 4.75 15.25 4.41421 15.25 4ZM10.0303 13.9697C10.3232 14.2626 10.3232 14.7374 10.0303 15.0303L5.81066 19.25H8C8.41421 19.25 8.75 19.5858 8.75 20C8.75 20.4142 8.41421 20.75 8 20.75H4C3.58579 20.75 3.25 20.4142 3.25 20V16C3.25 15.5858 3.58579 15.25 4 15.25C4.41421 15.25 4.75 15.5858 4.75 16V18.1893L8.96967 13.9697C9.26256 13.6768 9.73744 13.6768 10.0303 13.9697Z"
    fill="currentColor"
  />
</svg> `,y3=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.75 4C4.75 3.58579 4.41421 3.25 4 3.25C3.58579 3.25 3.25 3.58579 3.25 4V20C3.25 20.4142 3.58579 20.75 4 20.75C4.41421 20.75 4.75 20.4142 4.75 20V4ZM13.1548 8.56944C13.4693 8.29988 13.5057 7.8264 13.2361 7.51191C12.9665 7.19741 12.4931 7.16099 12.1786 7.43056L7.51191 11.4306C7.34567 11.573 7.25 11.7811 7.25 12C7.25 12.2189 7.34567 12.427 7.51191 12.5694L12.1786 16.5694C12.4931 16.839 12.9665 16.8026 13.2361 16.4881C13.5057 16.1736 13.4693 15.7001 13.1548 15.4306L10.0274 12.75H20C20.4142 12.75 20.75 12.4142 20.75 12C20.75 11.5858 20.4142 11.25 20 11.25H10.0274L13.1548 8.56944Z"
    fill="currentColor"
  />
</svg> `,w3=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M20.75 4C20.75 3.58579 20.4142 3.25 20 3.25C19.5858 3.25 19.25 3.58579 19.25 4V20C19.25 20.4142 19.5858 20.75 20 20.75C20.4142 20.75 20.75 20.4142 20.75 20V4ZM10.8452 8.56944C10.5307 8.29988 10.4943 7.8264 10.7639 7.51191C11.0335 7.19741 11.5069 7.16099 11.8214 7.43056L16.4881 11.4306C16.6543 11.573 16.75 11.7811 16.75 12C16.75 12.2189 16.6543 12.427 16.4881 12.5694L11.8214 16.5694C11.5069 16.839 11.0335 16.8026 10.7639 16.4881C10.4943 16.1736 10.5307 15.7001 10.8452 15.4306L13.9726 12.75H4C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25H13.9726L10.8452 8.56944Z"
    fill="currentColor"
  />
</svg> `,GL=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="20"
    height="20"
    viewBox="0 0 24 24"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M17.5073 10.9968C17.2022 11.277 16.7278 11.2568 16.4476 10.9517L12.75 6.92547L12.75 19C12.75 19.4142 12.4142 19.75 12 19.75C11.5858 19.75 11.25 19.4142 11.25 19L11.25 6.92547L7.55239 10.9517C7.27222 11.2568 6.79777 11.277 6.49269 10.9968C6.18761 10.7167 6.16742 10.2422 6.4476 9.93714L11.4476 4.4927C11.5896 4.33803 11.79 4.25 12 4.25C12.21 4.25 12.4104 4.33803 12.5524 4.4927L17.5524 9.93714C17.8326 10.2422 17.8124 10.7167 17.5073 10.9968Z"
    />
  </svg>
`,ZL=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="20"
    height="20"
    viewBox="0 0 24 24"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      fill="currentColor"
      d="M17.5073 13.0032C17.2022 12.723 16.7278 12.7432 16.4476 13.0483L12.75 17.0745L12.75 5C12.75 4.58579 12.4142 4.25 12 4.25C11.5858 4.25 11.25 4.58579 11.25 5L11.25 17.0745L7.55239 13.0483C7.27222 12.7432 6.79777 12.723 6.49269 13.0032C6.18761 13.2833 6.16742 13.7578 6.4476 14.0629L11.4476 19.5073C11.5896 19.662 11.79 19.75 12 19.75C12.21 19.75 12.4104 19.662 12.5524 19.5073L17.5524 14.0629C17.8326 13.7578 17.8124 13.2833 17.5073 13.0032Z"
    />
  </svg>
`,wb=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M10 1.875C5.51269 1.875 1.875 5.51269 1.875 10C1.875 14.4873 5.51269 18.125 10 18.125C11.7949 18.125 13.25 16.6699 13.25 14.875V14.3875C13.25 14.0545 13.2525 13.9826 13.26 13.9354C13.3151 13.5877 13.5877 13.3151 13.9354 13.26C13.9826 13.2525 14.0545 13.25 14.3875 13.25H14.875C16.6699 13.25 18.125 11.7949 18.125 10C18.125 5.51269 14.4873 1.875 10 1.875ZM7.5625 6.34375C7.5625 5.67065 8.10815 5.125 8.78125 5.125C9.45434 5.125 10 5.67065 10 6.34375C10 7.01685 9.45435 7.5625 8.78125 7.5625C8.10815 7.5625 7.5625 7.01684 7.5625 6.34375ZM11.625 7.15625C11.625 6.48315 12.1707 5.9375 12.8438 5.9375C13.5168 5.9375 14.0625 6.48315 14.0625 7.15625C14.0625 7.82935 13.5168 8.375 12.8438 8.375C12.1707 8.375 11.625 7.82935 11.625 7.15625ZM6.34375 8.375C5.67065 8.375 5.125 8.92065 5.125 9.59375C5.125 10.2668 5.67065 10.8125 6.34375 10.8125C7.01685 10.8125 7.5625 10.2668 7.5625 9.59375C7.5625 8.92065 7.01685 8.375 6.34375 8.375Z"
      fill="#77757D"
    />
  </svg>
`,n5=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <style xmlns="http://www.w3.org/2000/svg">
    .spinner {
      transform-origin: center;
      animation: spinner_animate 0.75s infinite linear;
    }
    @keyframes spinner_animate {
      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <path
    d="M14.6666 8.00004C14.6666 11.6819 11.6818 14.6667 7.99992 14.6667C4.31802 14.6667 1.33325 11.6819 1.33325 8.00004C1.33325 4.31814 4.31802 1.33337 7.99992 1.33337C11.6818 1.33337 14.6666 4.31814 14.6666 8.00004ZM3.30003 8.00004C3.30003 10.5957 5.40424 12.6999 7.99992 12.6999C10.5956 12.6999 12.6998 10.5957 12.6998 8.00004C12.6998 5.40436 10.5956 3.30015 7.99992 3.30015C5.40424 3.30015 3.30003 5.40436 3.30003 8.00004Z"
    fill="black"
    fill-opacity="0.1"
  />
  <path
    d="M13.6833 8.00004C14.2263 8.00004 14.674 7.55745 14.5942 7.02026C14.5142 6.48183 14.3684 5.954 14.1591 5.44882C13.8241 4.63998 13.333 3.90505 12.714 3.286C12.0949 2.66694 11.36 2.17588 10.5511 1.84084C10.046 1.63159 9.51812 1.48576 8.9797 1.40576C8.44251 1.32595 7.99992 1.77363 7.99992 2.31671C7.99992 2.85979 8.44486 3.28974 8.9761 3.40253C9.25681 3.46214 9.53214 3.54746 9.79853 3.65781C10.3688 3.894 10.8869 4.2402 11.3233 4.67664C11.7598 5.11307 12.106 5.6312 12.3422 6.20143C12.4525 6.46782 12.5378 6.74315 12.5974 7.02386C12.7102 7.5551 13.1402 8.00004 13.6833 8.00004Z"
    fill="#1C9EE4"
    class="spinner"
  />
</svg>`,i5=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <style xmlns="http://www.w3.org/2000/svg">
    .spinner {
      transform-origin: center;
      animation: spinner_animate 0.75s infinite linear;
    }
    @keyframes spinner_animate {
      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <path
    d="M14.6666 8.00004C14.6666 11.6819 11.6818 14.6667 7.99992 14.6667C4.31802 14.6667 1.33325 11.6819 1.33325 8.00004C1.33325 4.31814 4.31802 1.33337 7.99992 1.33337C11.6818 1.33337 14.6666 4.31814 14.6666 8.00004ZM3.30003 8.00004C3.30003 10.5957 5.40424 12.6999 7.99992 12.6999C10.5956 12.6999 12.6998 10.5957 12.6998 8.00004C12.6998 5.40436 10.5956 3.30015 7.99992 3.30015C5.40424 3.30015 3.30003 5.40436 3.30003 8.00004Z"
    fill="white"
    fill-opacity="0.1"
  />
  <path
    d="M13.6833 8.00004C14.2263 8.00004 14.674 7.55745 14.5942 7.02026C14.5142 6.48183 14.3684 5.954 14.1591 5.44882C13.8241 4.63998 13.333 3.90505 12.714 3.286C12.0949 2.66694 11.36 2.17588 10.5511 1.84084C10.046 1.63159 9.51812 1.48576 8.9797 1.40576C8.44251 1.32595 7.99992 1.77363 7.99992 2.31671C7.99992 2.85979 8.44486 3.28974 8.9761 3.40253C9.25681 3.46214 9.53214 3.54746 9.79853 3.65781C10.3688 3.894 10.8869 4.2402 11.3233 4.67664C11.7598 5.11307 12.106 5.6312 12.3422 6.20143C12.4525 6.46782 12.5378 6.74315 12.5974 7.02386C12.7102 7.5551 13.1402 8.00004 13.6833 8.00004Z"
    fill="#1C9EE4"
    class="spinner"
  />
</svg>`,WL=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M0.000108291 4C4.84837e-05 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4L340.005 170H0.00460238L0.000108291 4Z"
    fill="#F4F4F5"
  />
  <path
    d="M47.4226 181.578L133.723 53.5251C136.164 49.904 141.057 48.9089 144.718 51.2892L345.111 181.578H47.4226Z"
    fill="#C0BFC1"
  />
  <path
    d="M0.00305283 184.375L71.1716 78.1816C73.6115 74.5409 78.5267 73.5413 82.195 75.9397L248.044 184.375H0.00305283Z"
    fill="#E3E2E4"
  />
  <ellipse
    cx="19.6135"
    cy="19.8036"
    rx="19.6135"
    ry="19.8036"
    transform="matrix(1 0 2.70729e-05 1 38 17)"
    fill="#C0BFC1"
  />
</svg>`,qL=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M0.000108291 4C4.84837e-05 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4L340.005 170H0.00460238L0.000108291 4Z"
    fill="#252525"
  />
  <path
    d="M47.4226 181.578L133.723 53.5251C136.164 49.904 141.057 48.9089 144.718 51.2892L345.111 181.578H47.4226Z"
    fill="#3E3E3F"
  />
  <path
    d="M0.00305283 184.375L71.1716 78.1816C73.6115 74.5409 78.5267 73.5413 82.195 75.9397L248.044 184.375H0.00305283Z"
    fill="#727272"
  />
  <ellipse
    cx="19.6135"
    cy="19.8036"
    rx="19.6135"
    ry="19.8036"
    transform="matrix(1 0 2.70729e-05 1 38 17)"
    fill="#3E3E3F"
  />
</svg>`,YL=b`
  <svg
    width="70"
    height="32"
    viewBox="0 0 70 32"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect x="0.25" y="0.25" width="69.5" height="31.5" rx="3.75" fill="white" />
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="31.5"
      rx="3.75"
      stroke="#E3E2E4"
      stroke-width="0.5"
    />
    <rect x="4" y="4" width="21" height="3" rx="1.5" fill="#DBDBDB" />
    <rect x="4" y="11" width="34.1467" height="2" rx="1" fill="#E9E9E9" />
    <rect x="4" y="17" width="34.1467" height="2" rx="1" fill="#E9E9E9" />
    <rect x="4" y="23" width="30" height="2" rx="1" fill="#E9E9E9" />
    <g clip-path="url(#clip0_8629_12484)">
      <rect
        width="23.8527"
        height="24"
        rx="2"
        transform="matrix(1 0 2.70729e-05 1 42.1467 4)"
        fill="#EDEDED"
      />
      <path
        d="M47.0005 30.0001L57.6988 14.2824C58.6142 12.9375 60.4347 12.5674 61.8027 13.448L87.5143 30.0001H47.0005Z"
        fill="#CCCCCC"
      />
      <circle
        cx="2.10328"
        cy="2.10328"
        r="2.10328"
        transform="matrix(1 0 2.70729e-05 1 47.7163 9)"
        fill="#CCCCCC"
      />
    </g>
    <defs>
      <clipPath id="clip0_8629_12484">
        <rect
          width="23.8527"
          height="24"
          rx="2"
          transform="matrix(1 0 2.70729e-05 1 42.1467 4)"
          fill="white"
        />
      </clipPath>
    </defs>
  </svg>
`,XL=b`
  <svg
    width="70"
    height="32"
    viewBox="0 0 70 32"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="31.5"
      rx="3.75"
      fill="#141414"
    />
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="31.5"
      rx="3.75"
      stroke="#484848"
      stroke-width="0.5"
    />
    <rect x="4" y="4" width="21" height="3" rx="1.5" fill="#4A4A4A" />
    <rect x="4" y="11" width="34.1467" height="2" rx="1" fill="#323232" />
    <rect x="4" y="17" width="34.1467" height="2" rx="1" fill="#323232" />
    <rect x="4" y="23" width="30" height="2" rx="1" fill="#323232" />
    <g clip-path="url(#clip0_8635_14321)">
      <rect
        width="23.8527"
        height="24"
        rx="2"
        transform="matrix(1 0 2.70729e-05 1 42.1467 4)"
        fill="#2E2E2E"
      />
      <path
        d="M47.0005 30.0001L57.6988 14.2824C58.6142 12.9375 60.4347 12.5674 61.8027 13.448L87.5143 30.0001H47.0005Z"
        fill="#5D5D5D"
      />
      <circle
        cx="2.10328"
        cy="2.10328"
        r="2.10328"
        transform="matrix(1 0 2.70729e-05 1 47.7163 9)"
        fill="#5D5D5D"
      />
    </g>
    <defs>
      <clipPath id="clip0_8635_14321">
        <rect
          width="23.8527"
          height="24"
          rx="2"
          transform="matrix(1 0 2.70729e-05 1 42.1467 4)"
          fill="white"
        />
      </clipPath>
    </defs>
  </svg>
`,KL=b`
  <svg
    width="70"
    height="14"
    viewBox="0 0 70 14"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect x="0.25" y="0.25" width="69.5" height="13.5" rx="2.75" fill="white" />
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="13.5"
      rx="2.75"
      stroke="#E3E2E4"
      stroke-width="0.5"
    />
    <circle cx="6.5" cy="7" r="2.5" fill="#D9D9D9" />
    <rect x="13" y="5" width="53" height="4" rx="2" fill="#DBDBDB" />
  </svg>
`,QL=b`
  <svg
    width="70"
    height="14"
    viewBox="0 0 70 14"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="13.5"
      rx="2.75"
      fill="#141414"
    />
    <rect
      x="0.25"
      y="0.25"
      width="69.5"
      height="13.5"
      rx="2.75"
      stroke="#484848"
      stroke-width="0.5"
    />
    <circle cx="6.5" cy="7" r="2.5" fill="#4A4A4A" />
    <rect x="13" y="5" width="53" height="4" rx="2" fill="#4A4A4A" />
  </svg>
`,JL=b`
  <svg
    width="60"
    height="66"
    viewBox="0 0 60 66"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="0.25"
      y="1.10718"
      width="59.5"
      height="63.7857"
      rx="3.75"
      fill="white"
    />
    <rect
      x="0.25"
      y="1.10718"
      width="59.5"
      height="63.7857"
      rx="3.75"
      stroke="#E3E2E4"
      stroke-width="0.5"
    />
    <g clip-path="url(#clip0_8629_12498)">
      <path
        d="M3.00005 5.85718C3.00002 4.75261 3.89543 3.85718 5 3.85718H55C56.1046 3.85718 57 4.75261 57.0001 5.85718L57.0008 34.7143H3.00084L3.00005 5.85718Z"
        fill="#EDEDED"
      />
      <path
        d="M18.0007 37.3179L33.5882 14.4172C34.5036 13.0723 36.3241 12.7021 37.692 13.5828L74.5616 37.3179H18.0007Z"
        fill="#CCCCCC"
      />
      <circle
        cx="2.93637"
        cy="2.93637"
        r="2.93637"
        transform="matrix(1 0 2.70729e-05 1 19 8)"
        fill="#CCCCCC"
      />
    </g>
    <rect x="3" y="38.7144" width="30" height="3" rx="1.5" fill="#DBDBDB" />
    <rect x="3" y="45.7144" width="54" height="3" rx="1.5" fill="#E9E9E9" />
    <rect x="3" y="52.7144" width="54" height="3" rx="1.5" fill="#E9E9E9" />
    <defs>
      <clipPath id="clip0_8629_12498">
        <path
          d="M3.00005 5.85718C3.00002 4.75261 3.89543 3.85718 5 3.85718H55C56.1046 3.85718 57 4.75261 57.0001 5.85718L57.0008 34.7143H3.00084L3.00005 5.85718Z"
          fill="white"
        />
      </clipPath>
    </defs>
  </svg>
`,eM=b`
  <svg
    width="60"
    height="66"
    viewBox="0 0 60 66"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="0.25"
      y="1.10718"
      width="59.5"
      height="63.7857"
      rx="3.75"
      fill="#141414"
    />
    <rect
      x="0.25"
      y="1.10718"
      width="59.5"
      height="63.7857"
      rx="3.75"
      stroke="#484848"
      stroke-width="0.5"
    />
    <g clip-path="url(#clip0_8635_14335)">
      <path
        d="M3.00005 5.85718C3.00002 4.75261 3.89543 3.85718 5 3.85718H55C56.1046 3.85718 57 4.75261 57.0001 5.85718L57.0008 34.7143H3.00084L3.00005 5.85718Z"
        fill="#2E2E2E"
      />
      <path
        d="M18.0007 37.3179L33.5882 14.4172C34.5036 13.0723 36.3241 12.7021 37.692 13.5828L74.5616 37.3179H18.0007Z"
        fill="#5D5D5D"
      />
      <circle
        cx="2.93637"
        cy="2.93637"
        r="2.93637"
        transform="matrix(1 0 2.70729e-05 1 19 8)"
        fill="#5D5D5D"
      />
    </g>
    <rect x="3" y="38.7144" width="30" height="3" rx="1.5" fill="#4A4A4A" />
    <rect x="3" y="45.7144" width="54" height="3" rx="1.5" fill="#323232" />
    <rect x="3" y="52.7144" width="54" height="3" rx="1.5" fill="#323232" />
    <defs>
      <clipPath id="clip0_8635_14335">
        <path
          d="M3.00005 5.85718C3.00002 4.75261 3.89543 3.85718 5 3.85718H55C56.1046 3.85718 57 4.75261 57.0001 5.85718L57.0008 34.7143H3.00084L3.00005 5.85718Z"
          fill="white"
        />
      </clipPath>
    </defs>
  </svg>
`,tM=b`
  <svg
    width="38"
    height="30"
    viewBox="0 0 38 30"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect x="0.25" y="0.25" width="37.5" height="29.5" rx="3.75" fill="white" />
    <rect
      x="0.25"
      y="0.25"
      width="37.5"
      height="29.5"
      rx="3.75"
      stroke="#E3E2E4"
      stroke-width="0.5"
    />
    <circle cx="6.5" cy="6.5" r="2.5" fill="#D9D9D9" />
    <rect x="4" y="13" width="30" height="3" rx="1.5" fill="#E9E9E9" />
    <rect x="4" y="20" width="30" height="3" rx="1.5" fill="#E9E9E9" />
  </svg>
`,nM=b`
  <svg
    width="38"
    height="30"
    viewBox="0 0 38 30"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="0.25"
      y="0.25"
      width="37.5"
      height="29.5"
      rx="3.75"
      fill="#141414"
    />
    <rect
      x="0.25"
      y="0.25"
      width="37.5"
      height="29.5"
      rx="3.75"
      stroke="#484848"
      stroke-width="0.5"
    />
    <circle cx="6.5" cy="6.5" r="2.5" fill="#4A4A4A" />
    <rect x="4" y="13" width="30" height="3" rx="1.5" fill="#4A4A4A" />
    <rect x="4" y="20" width="30" height="3" rx="1.5" fill="#4A4A4A" />
  </svg>
`,kX=Object.freeze(Object.defineProperty({__proto__:null,AddCursorIcon:rl,AddFrameButtonIcon:dX,AlignBottomIcon:KI,AlignDistributeHorizontallyIcon:YI,AlignDistributeVerticallyIcon:JI,AlignHorizontallyIcon:qI,AlignLeftIcon:f8,AlignRightIcon:WI,AlignTopIcon:XI,AlignVerticallyIcon:QI,ArrowDownBigIcon:ZL,ArrowDownIcon:m3,ArrowDownSmallIcon:W1,ArrowIcon:fX,ArrowLeftBigIcon:vb,ArrowRightBigIcon:zL,ArrowRightSmallIcon:ya,ArrowUpBigIcon:GL,ArrowUpIcon:u0,AttachmentIcon:FL,AttachmentIcon16:y8,AutoCompleteArrowIcon:eI,AutoConnectLeftIcon:nL,AutoConnectRightIcon:iL,BanIcon:kI,BlockHubIcon:IL,BlockHubIcon20:_X,BlockHubRoundedRectangleIcon:LL,BoldIcon:vL,BookmarkIcon:Yo,BringForwardIcon:zI,BringToFrontIcon:VI,BulletedListIcon:J9,BulletedListIconLarge:yX,CancelWrapIcon:$L,CaptionIcon:Kd,CardIcon:hX,ChangeShapeIcon:ZI,CheckBoxIcon:ob,CloseIcon:Z9,CodeBlockIcon:sb,CodeIcon:_L,ConfirmIcon:cb,ConnectorCWithArrowIcon:xI,ConnectorEndpointNoneIcon:c2,ConnectorIcon:tL,ConnectorLWithArrowIcon:CI,ConnectorXWithArrowIcon:_I,ConvertIcon:P9,CopyAsPngIcon:j9,CopyIcon:Tr,CrossIcon:Xd,CurveLineIcon:p8,DarkLoadingIcon:i5,DashLineIcon:O9,DatabaseAddColumn:iX,DatabaseDragIcon:rX,DatabaseDuplicate:I9,DatabaseExpand:oX,DatabaseInsertLeft:HT,DatabaseInsertRight:FT,DatabaseKanbanViewIcon:mL,DatabaseKanbanViewIcon20:bL,DatabaseKanbanViewSVG:rb,DatabaseMoveLeft:L9,DatabaseMoveRight:M9,DatabaseMultiSelect:QY,DatabaseNumber:JY,DatabaseProgress:tX,DatabaseSearchClose:l3,DatabaseSearchIcon:NT,DatabaseSelect:eX,DatabaseTableViewClose:sX,DatabaseTableViewIcon:nb,DatabaseTableViewIcon20:ib,DatabaseTableViewSVG:tb,DateTime:aX,DeleteIcon:xn,DiamondIcon:cI,DividerIcon:lb,DocIcon:m8,DoneIcon:$9,DownloadIcon:g3,DualLinkIcon:RL,DualLinkIcon16:v3,DualLinkSVG:mb,DuplicateIcon:il,EdgelessEraserIcon:DI,EdgelessGeneralShapeIcon:gX,EdgelessIcon:g8,EdgelessImageIcon:UI,EdgelessModeIcon:F9,EdgelessPenIcon:BI,EdgelessTextIcon:U9,EditIcon:p0,ElbowedLineIcon:h8,EllipseIcon:lI,EmbedCardDarkBannerIcon:qL,EmbedCardDarkCubeIcon:nM,EmbedCardDarkHorizontalIcon:XL,EmbedCardDarkListIcon:QL,EmbedCardDarkVerticalIcon:eM,EmbedCardLightBannerIcon:WL,EmbedCardLightCubeIcon:tM,EmbedCardLightHorizontalIcon:YL,EmbedCardLightListIcon:KL,EmbedCardLightVerticalIcon:JL,EmbedWebIcon:Qd,ExpandFullIcon:yb,ExpandIcon:XT,ExpandWideIcon:jL,ExportToHTMLIcon:sL,ExportToMarkdownIcon:oL,FilterIcon:c3,FlipDirectionIcon:wI,FontFamilyIcon:NL,FontLinkIcon:wX,FontLinkedPageIcon:pb,FontPageIcon:OL,FrameIcon:Lc,FrameNavigatorIcon:GT,FrameNavigatorNextIcon:WT,FrameNavigatorPrevIcon:ZT,FrameOrderAdjustmentIcon:JT,FrontEndpointArrowIcon:r8,FrontEndpointCircleIcon:s8,FrontEndpointDiamondIcon:a8,FrontEndpointTriangleIcon:o8,GeneralStyleIcon:G1,GroupIcon:D9,GroupingIcon:A9,HandIcon:sI,Heading1Icon:W9,Heading2Icon:q9,Heading3Icon:Y9,Heading4Icon:X9,Heading5Icon:K9,Heading6Icon:Q9,HelpIcon:cL,HiddenCardIcon:pX,HiddenIcon:PI,HighLightDuotoneIcon:bb,ImageGrayIcon:cX,ImageIcon:iI,ImageIcon20:rI,ImageUploadIcon:lX,ImportIcon:dL,InfoIcon:UT,ItalicIcon:yL,LargeFrameIcon:MI,LightLoadingIcon:n5,LineStyleIcon:d3,LinkIcon:Yd,LinkedPageIcon:fb,MinusIcon:bI,MoreCopyIcon:z9,MoreDeleteIcon:h3,MoreDuplicateIcon:G9,MoreHorizontalIcon:Xo,MoreIcon:V9,MoreIndicatorIcon:rL,MoreVerticalIcon:d0,MoveLeftIcon:y3,MoveRightIcon:w3,NavigatorExitFullScreenIcon:YT,NavigatorFullScreenIcon:qT,NavigatorSettingsIcon:KT,NewEditIcon:db,NewIcon:lL,NewPageIcon:gb,NoteAutoCompleteIcon:tI,NoteCornerIcon:EI,NoteIcon:u3,NoteNoShadowIcon:TI,NoteShadowIcon:SI,NoteShadowSampleIcon:II,NoteSmallIcon:uX,NotionIcon:aL,NowIcon:TL,NumberedListIcon:eb,NumberedListIconLarge:gL,OpenIcon:oo,PageIcon:b3,PaletteIcon:wb,PenIcon:oI,PlusIcon:Sr,QuoteIcon:ab,RearEndpointArrowIcon:l8,RearEndpointCircleIcon:d8,RearEndpointDiamondIcon:u8,RearEndpointTriangleIcon:c8,RefreshIcon:f3,ReleaseFromGroupButtonIcon:zT,RemoteCursor:eL,RenameIcon:B9,RoundedRectangleIcon:uI,ScissorsIcon:$I,ScribbledDiamondIcon:fI,ScribbledEllipseIcon:pI,ScribbledRoundedRectangleIcon:mI,ScribbledSquareIcon:hI,ScribbledStyleIcon:Z1,ScribbledTriangleIcon:gI,SearchIcon:ML,SelectIcon:VT,SendBackwardIcon:jI,SendToBackIcon:GI,SettingsIcon:mX,ShapeArrowDownSmallIcon:Ph,ShrinkIcon:QT,SmallArrowDownIcon:Pi,SmallNoteIcon:LI,SmallPageIcon:v8,SmallScissorsIcon:AI,SquareIcon:aI,StraightLineIcon:Mh,StrikethroughIcon:xL,TagsIcon:t5,TextAlignCenterIcon:N9,TextAlignLeftIcon:R9,TextAlignRightIcon:H9,TextBackgroundDuotoneIcon:UL,TextForegroundDuotoneIcon:VL,TextIcon:h0,TextIconLarge:hL,TitleIcon:vX,TodayIcon:kL,TomorrowIcon:EL,TransparentIcon:yI,TriangleIcon:dI,UnderlineIcon:wL,UngroupButtonIcon:jT,UnlinkIcon:ub,ViewBarIcon:vI,ViewIcon:BL,WebIcon16:b8,WebIconSVG:PL,WrapIcon:AL,YesterdayIcon:SL,diamondSvg:HI,ellipseSvg:RI,fontIcon:p3,icon:rn,rectSvg:OI,roundedSvg:FI,triangleSvg:NI},Symbol.toStringTag,{value:"Module"}));var EX=Object.defineProperty,SX=Object.getOwnPropertyDescriptor,f0=(t,e,n,i)=>{for(var r=i>1?void 0:i?SX(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&EX(e,n,r),r};class TX extends Event{constructor(e,{detail:n,composed:i,bubbles:r}){super(e,{bubbles:r,composed:i}),this.detail=n}}const q1=["--affine-palette-line-yellow","--affine-palette-line-orange","--affine-palette-line-tangerine","--affine-palette-line-red","--affine-palette-line-magenta","--affine-palette-line-purple","--affine-palette-line-green","--affine-palette-line-blue","--affine-palette-line-navy","--affine-palette-line-black","--affine-palette-line-grey","--affine-palette-line-white"],zx=ge.union([ge.literal("--affine-palette-line-yellow"),ge.literal("--affine-palette-line-orange"),ge.literal("--affine-palette-line-tangerine"),ge.literal("--affine-palette-line-red"),ge.literal("--affine-palette-line-magenta"),ge.literal("--affine-palette-line-purple"),ge.literal("--affine-palette-line-green"),ge.literal("--affine-palette-line-blue"),ge.literal("--affine-palette-line-navy"),ge.literal("--affine-palette-line-black"),ge.literal("--affine-palette-line-grey"),ge.literal("--affine-palette-line-white")]),_a=()=>Wo()==="dark"?q1[11]:q1[9],xb=()=>q1[7],IX="--affine-palette-line-blue";function Y1(t){return t.toLowerCase()==="--affine-palette-transparent"}function iM(t){return["--affine-palette-line-white","--affine-palette-shape-white"].includes(t.toLowerCase())}function LX(t=!1){const e={position:"relative",width:"16px",height:"16px",stroke:"none"},i=t?b`<div style=${we({position:"absolute",width:"10px",height:"10px",left:"3px",top:"3.5px",borderRadius:"50%",background:"var(--affine-background-overlay-panel-color)"})}></div>`:ae;return b`<div style=${we(e)}>
    ${yI} ${i}
  </div>`}function MX(t){const e=iM(t)?1:0,n={fill:`var(${t})`,stroke:"var(--affine-border-color)"};return b`<svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M12.3125 8C12.3125 10.3817 10.3817 12.3125 8 12.3125C5.61827 12.3125 3.6875 10.3817 3.6875 8C3.6875 5.61827 5.61827 3.6875 8 3.6875C10.3817 3.6875 12.3125 5.61827 12.3125 8ZM8 15.5C12.1421 15.5 15.5 12.1421 15.5 8C15.5 3.85786 12.1421 0.5 8 0.5C3.85786 0.5 0.5 3.85786 0.5 8C0.5 12.1421 3.85786 15.5 8 15.5Z"
      stroke-width="${e}"
      style=${we(n)}
    />
  </svg> `}function PX(t,e){return Y1(t)?LX(e):e?MX(t):ae}function Ca(t,{hollowCircle:e,letter:n}={}){const i=PX(t,!!e),r=e?{}:{background:`var(${t})`},s={display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",boxSizing:"border-box",overflow:"hidden",...iM(t)&&!e?{border:"1px solid var(--affine-border-color)"}:{},...r};return b`<div
    class="color-unit"
    style=${we(s)}
    aria-label=${t.toLowerCase()}
    data-letter=${n?"A":""}
  >
    ${i}
  </div>`}const rM=X`
  .color-container {
    display: flex;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    box-sizing: border-box;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    cursor: pointer;
  }

  .color-container[active] {
    border: 1px solid var(--affine-primary-color);
  }

  .color-unit::before {
    content: attr(data-letter);
    display: block;
    font-size: 12px;
  }
`;let ka=class extends Ae{constructor(){super(...arguments),this.value=null,this.options=q1,this.showLetterMark=!1,this.hollowCircle=!1}onSelect(t){this.dispatchEvent(new TX("select",{detail:t,composed:!0,bubbles:!0})),this.value=t}render(){return Fe(this.options,t=>t,t=>{const e=Ca(t,{hollowCircle:this.hollowCircle,letter:this.showLetterMark});return b`
          <div
            class="color-container"
            ?active=${t===this.value}
            @click=${()=>this.onSelect(t)}
          >
            ${e}
          </div>
        `})}};ka.styles=X`
    :host {
      display: flex;
      padding: 10px;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 12px;
      box-sizing: border-box;
      width: 200px;
      background: var(--affine-background-overlay-panel-color);
    }

    ${rM}
  `;f0([L({attribute:!1})],ka.prototype,"value",2);f0([L({attribute:!1})],ka.prototype,"options",2);f0([L({attribute:!1})],ka.prototype,"showLetterMark",2);f0([L({attribute:!1})],ka.prototype,"hollowCircle",2);ka=f0([W("edgeless-color-panel")],ka);var AX=Object.defineProperty,$X=Object.getOwnPropertyDescriptor,BX=(t,e,n,i)=>{for(var r=i>1?void 0:i?$X(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&AX(e,n,r),r};let w8=class extends ka{};w8.styles=X`
    :host {
      display: flex;
      width: 442px;
      padding: 0 2px;
      gap: 18px;
      box-sizing: border-box;
      background: var(--affine-background-overlay-panel-color);
    }

    ${rM}
  `;w8=BX([W("edgeless-one-row-color-panel")],w8);const{Rect:DX,Ellipse:OX,Triangle:RX,Diamond:NX}=qd,x3=[{name:DX,generalIcon:aI,scribbledIcon:hI,tooltip:"Square",disabled:!1},{name:OX,generalIcon:lI,scribbledIcon:pI,tooltip:"Ellipse",disabled:!1},{name:NX,generalIcon:cI,scribbledIcon:fI,tooltip:"Diamond",disabled:!1},{name:RX,generalIcon:dI,scribbledIcon:gI,tooltip:"Triangle",disabled:!1},{name:"roundedRect",generalIcon:uI,scribbledIcon:mI,tooltip:"Rounded rectangle",disabled:!1}];x3.reduce((t,e)=>(t[e.name]=e,t),{});const HX=464,FX="--affine-palette-shape-",UX="--affine-palette-line-";var VX=Object.defineProperty,zX=Object.getOwnPropertyDescriptor,ol=(t,e,n,i)=>{for(var r=i>1?void 0:i?zX(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&VX(e,n,r),r};let So=class extends me(Ae){constructor(){super(...arguments),this._setStrokeColor=t=>{if(this.edgeless.edgelessTool.type!=="shape")return;const e={strokeColor:t},n=t.replace(UX,FX),i=!Y1(n);e.fillColor=n,e.filled=i,this.onChange(e)},this._setShapeStyle=t=>{this.edgeless.edgelessTool.type==="shape"&&this.onChange({shapeStyle:t})}}render(){if(this.edgeless.edgelessTool.type!=="shape")return ae;const{radius:t,strokeColor:e,shapeStyle:n}=this;let{shapeType:i}=this;return i==="rect"&&t>0&&(i="roundedRect"),b`
      <div class="shape-menu-container">
        <edgeless-slide-menu .menuWidth=${HX}>
          <div class="menu-content">
            <div class="shape-style-container">
              <edgeless-tool-icon-button
                .tooltip=${"General"}
                .iconContainerPadding=${2}
                .active=${n===dn.General}
                .activeMode=${"background"}
                @click=${()=>{this._setShapeStyle(dn.General)}}
              >
                ${G1}
              </edgeless-tool-icon-button>
              <edgeless-tool-icon-button
                .tooltip=${"Scribbled"}
                .iconContainerPadding=${2}
                .active=${n===dn.Scribbled}
                .activeMode=${"background"}
                @click=${()=>{this._setShapeStyle(dn.Scribbled)}}
              >
                ${Z1}
              </edgeless-tool-icon-button>
            </div>
            <menu-divider .vertical=${!0}></menu-divider>
            <div class="shape-type-container">
              ${x3.map(({name:r,generalIcon:o,scribbledIcon:s,tooltip:a})=>b`
                    <edgeless-tool-icon-button
                      .tooltip=${a}
                      .active=${i===r}
                      .activeMode=${"background"}
                      .iconContainerPadding=${2}
                      @click=${()=>{this.onChange({shapeType:r})}}
                    >
                      ${n===dn.General?o:s}
                    </edgeless-tool-icon-button>
                  `)}
            </div>
            <menu-divider .vertical=${!0}></menu-divider>
            <edgeless-one-row-color-panel
              .value=${e}
              @select=${r=>this._setStrokeColor(r.detail)}
            ></edgeless-one-row-color-panel>
          </div>
        </edgeless-slide-menu>
      </div>
    `}};So.styles=X`
    :host {
      display: flex;
      position: absolute;
      z-index: -1;
    }
    .menu-content {
      display: flex;
      align-items: center;
    }
    .shape-type-container,
    .shape-style-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
    }
    .shape-type-container svg,
    .shape-style-container svg {
      fill: var(--affine-icon-color);
      stroke: none;
    }
    menu-divider {
      height: 24px;
      margin: 0 9px;
    }
  `;ol([L({attribute:!1})],So.prototype,"edgeless",2);ol([L({attribute:!1})],So.prototype,"shapeType",2);ol([L({attribute:!1})],So.prototype,"fillColor",2);ol([L({attribute:!1})],So.prototype,"shapeStyle",2);ol([L({attribute:!1})],So.prototype,"strokeColor",2);ol([L({attribute:!1})],So.prototype,"radius",2);ol([L({attribute:!1})],So.prototype,"onChange",2);So=ol([W("edgeless-shape-menu")],So);const Wh=364,x8=78,jX=91,r5=448,g0=72,GX=30,ZX=40,WX=6,qX=6,El=100,Sl=50,is=6,YX="--affine-border-color",XX="--affine-icon-color",h1=100,d2=100,jx=6,Gx=6,KX={seed:666,roughness:Rm,strokeStyle:Yt.Solid,strokeLineDash:[],stroke:"black",strokeWidth:Rt.LINE_WIDTH_TWO,fill:"transparent"},QX="affine:paragraph",JX="text",eK="Text",Zx=100,oM=["affine-note-mask","edgeless-block-portal-note","affine-block-children-container"],sM="--affine-palette-line-white",aM="--affine-palette-line-black",lM="--affine-palette-shape-black",tK=12,nK=(t,e)=>{const[n,i,r,o]=e;t.rect(n,i,r,o)},iK=(t,e)=>{const[n,i,r,o]=e;t.moveTo(n+r/2,i),t.lineTo(n,i+o),t.lineTo(n+r,i+o)},rK=(t,e)=>{const[n,i,r,o]=e;t.lineTo(n+r/2,i),t.lineTo(n+r,i+o/2),t.lineTo(n+r/2,i+o),t.lineTo(n,i+o/2)},oK=(t,e)=>{const[n,i,r,o]=e;t.ellipse(n+r/2,i+o/2,r/2,o/2,0,0,2*Math.PI)},sK=(t,e)=>{const[n,i,r,o]=e,s=r,a=o,l=.1,c=Math.min(s*l,a*l);t.moveTo(n+c,i),t.arcTo(n+s,i,n+s,i+a,c),t.arcTo(n+s,i+a,n,i+a,c),t.arcTo(n,i+a,n,i,c),t.arcTo(n,i,n+s,i,c)},m0=(t,e,n,i)=>{switch(t.setLineDash(i.strokeLineDash??[]),t.strokeStyle=i.stroke??"transparent",t.lineWidth=i.strokeWidth??2,t.fillStyle=i.fill??"transparent",t.beginPath(),e){case"rect":nK(t,n);break;case"triangle":iK(t,n);break;case"diamond":rK(t,n);break;case"ellipse":oK(t,n);break;case"roundedRect":sK(t,n);break;default:throw new Error(`Unknown shape type: ${e}`)}t.closePath(),t.fill(),t.stroke()};class b0{constructor(e,n,i,r){this.xywh=e,this.type=n,this.options=i,this.shapeStyle=r}}class aK extends b0{draw(e,n){if(this.shapeStyle==="Scribbled"){const[i,r,o,s]=this.xywh;n.rectangle(i,r,o,s,this.options)}else m0(e,"rect",this.xywh,this.options)}}class lK extends b0{draw(e,n){if(this.shapeStyle==="Scribbled"){const[i,r,o,s]=this.xywh;n.polygon([[i+o/2,r],[i,r+s],[i+o,r+s]],this.options)}else m0(e,"triangle",this.xywh,this.options)}}class cK extends b0{draw(e,n){if(this.shapeStyle==="Scribbled"){const[i,r,o,s]=this.xywh;n.polygon([[i+o/2,r],[i+o,r+s/2],[i+o/2,r+s],[i,r+s/2]],this.options)}else m0(e,"diamond",this.xywh,this.options)}}class dK extends b0{draw(e,n){if(this.shapeStyle==="Scribbled"){const[i,r,o,s]=this.xywh;n.ellipse(i+o/2,r+s/2,o,s,this.options)}else m0(e,"ellipse",this.xywh,this.options)}}class uK extends b0{draw(e,n){if(this.shapeStyle==="Scribbled"){const[i,r,o,s]=this.xywh,a=.1,l=Math.min(o*a,s*a),c=i+l,d=i+o-l,u=r+l,h=r+s-l,p=`
          M${c},${r} L${d},${r} 
          A${l},${l} 0 0 1 ${d},${u} 
          L${d},${h} 
          A${l},${l} 0 0 1 ${d-l},${h} 
          L${c+l},${h} 
          A${l},${l} 0 0 1 ${c},${h-l} 
          L${c},${u} 
          A${l},${l} 0 0 1 ${c+l},${r}
        `;n.path(p,this.options)}else m0(e,"roundedRect",this.xywh,this.options)}}class _8{static createShape(e,n,i,r){switch(n){case"rect":return new aK(e,n,i,r);case"triangle":return new lK(e,n,i,r);case"diamond":return new cK(e,n,i,r);case"ellipse":return new dK(e,n,i,r);case"roundedRect":return new uK(e,n,i,r);default:throw new Error(`Unknown shape type: ${n}`)}}}class cM extends nl{get computedStyle(){return getComputedStyle(this.edgeless)}isTransparent(e){return e.includes("transparent")}constructor(e){super(),this.x=0,this.y=0,this.globalAlpha=0,this.edgeless=e,this.disposables=new dt,this.disposables.add(this.edgeless.service.viewport.viewportUpdated.on(()=>{const n=this.edgeless.tools.lastMousePos.x,i=this.edgeless.tools.lastMousePos.y,[r,o]=this.edgeless.service.viewport.toModelCoord(n,i);this.x=r,this.y=o}))}dispose(){this.disposables.dispose()}render(e,n){}}class hK extends cM{_getRealStrokeColor(e){const n=this.computedStyle.getPropertyValue(e);return this.isTransparent(e)?"transparent":n}_getRealFillColor(e){const n=this.computedStyle.getPropertyValue(e);return this.isTransparent(e)?"transparent":n}constructor(e,n,i,r){super(e);const o=[this.x,this.y,h1,d2],{shapeStyle:s,fillColor:a,strokeColor:l}=r;i.fill=this._getRealFillColor(a),i.stroke=this._getRealStrokeColor(l),this.shape=_8.createShape(o,n,i,s),this.disposables.add(this.edgeless.slots.edgelessToolUpdated.on(c=>{if(c.type!=="shape")return;const d=c.shapeType,u={...i,stroke:this._getRealStrokeColor(l),fill:this._getRealFillColor(a)};let{x:h,y:p}=this;(d==="roundedRect"||d==="rect")&&(h+=jx,p+=Gx);const g=d==="roundedRect"?h1+40:h1,f=[h,p,g,d2];this.shape=_8.createShape(f,d,u,s),this.edgeless.surface.refresh()}))}render(e,n){e.globalAlpha=this.globalAlpha;let{x:i,y:r}=this;const{type:o}=this.shape;(o==="roundedRect"||o==="rect")&&(i+=jx,r+=Gx);const s=o==="roundedRect"?h1+40:h1,a=[i,r,s,d2];this.shape.xywh=a,this.shape.draw(e,n)}}class dM extends cM{constructor(e,n){super(e),this.text="",this.backgroundColor="transparent",this.globalAlpha=0,this.backgroundColor=this._getRealBackgroundColor(n),this.disposables.add(this.edgeless.slots.edgelessToolUpdated.on(i=>{i.type==="affine:note"&&(this.text=this._getOverlayText(i.tip),this.edgeless.surface.refresh())}))}_getOverlayText(e){return e[0].toUpperCase()+e.slice(1)}_getRealBackgroundColor(e){const n=this.computedStyle.getPropertyValue(e);return this.isTransparent(e)?"transparent":n}render(e){e.globalAlpha=this.globalAlpha;const n=this.x+WX,i=this.y+qX,r=getComputedStyle(this.edgeless);e.strokeStyle=r.getPropertyValue(YX),e.fillStyle=this.backgroundColor,e.lineWidth=4,e.beginPath(),e.moveTo(n+is,i),e.lineTo(n+El-is,i),e.quadraticCurveTo(n+El,i,n+El,i+is),e.lineTo(n+El,i+Sl-is),e.quadraticCurveTo(n+El,i+Sl,n+El-is,i+Sl),e.lineTo(n+is,i+Sl),e.quadraticCurveTo(n,i+Sl,n,i+Sl-is),e.lineTo(n,i+is),e.quadraticCurveTo(n,i,n+is,i),e.closePath(),e.stroke(),e.fill(),e.fillStyle=r.getPropertyValue(XX);let o=16;for(e.font=`${o}px Arial`,e.textAlign="left",e.textBaseline="middle";e.measureText(this.text).width>El-20;)o-=1,e.font=`${o}px Arial`;e.fillText(this.text,n+10,i+Sl/2)}}class pK extends dM{constructor(e,n){super(e,n),this.slots={draggingNoteUpdated:new Ve},this.width=0,this.height=0,this.disposables.add(this.slots.draggingNoteUpdated.on(({xywh:i})=>{[this.x,this.y,this.width,this.height]=i,this.edgeless.surface.refresh()}))}render(e){e.globalAlpha=.8,e.fillStyle=this.backgroundColor,e.strokeStyle="rgba(0, 0, 0, 0.10)",e.lineWidth=2,e.beginPath(),e.roundRect(this.x,this.y,this.width,this.height,4),e.closePath(),e.fill(),e.stroke()}}class Ko{constructor(e,n){this._draggingArea=null,this.enableHover=!1,this._edgeless=e,this._service=n}get draggingArea(){return this._draggingArea}get _surface(){return this._edgeless.surface}get _page(){return this._edgeless.page}get _blocks(){return this._edgeless.service.blocks}}class _b extends Ko{constructor(){super(...arguments),this.tool={type:"shape",shapeType:"rect"},this._draggingElement=null,this._draggingElementId=null,this._shapeOverlay=null,this._draggingArea=null}_addNewShape(e,n,i){const{viewport:r}=this._service,o=this._edgeless.service.editSession.getLastProps("shape"),{shapeType:s}=this.tool;s==="rect"&&o.radius>0&&(n+=40);const[a,l]=r.toModelCoord(e.point.x,e.point.y),c=new ne(a,l,n,i);return this._service.addElement(kn.SHAPE,{shapeType:s,xywh:c.serialize(),radius:o.radius})}onContainerClick(e){this.clearOverlay(),this._page.captureSync();const n=this._addNewShape(e,h1,d2),i=this._service.getElementById(n);D(i),this._edgeless.tools.switchToDefaultMode({elements:[i.id],editing:!1})}onContainerContextMenu(){}onContainerPointerDown(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerDragStart(e){this.clearOverlay(),this._page.captureSync();const n=this._addNewShape(e,0,0);this._draggingElementId=n,this._draggingElement=this._service.getElementById(n),this._draggingElement.stash("xywh"),this._draggingArea={start:new DOMPoint(e.x,e.y),end:new DOMPoint(e.x,e.y)}}onContainerDragMove(e){D(this._draggingElementId),D(this._draggingArea),this._draggingArea.end=new DOMPoint(e.x,e.y),this._resize(e.keys.shift||this._edgeless.tools.shiftKey)}onContainerDragEnd(){if(this._draggingElement){const i=this._draggingElement;this._page.transact(()=>{i.pop("xywh")})}const e=this._draggingElementId;if(D(e),this._draggingArea){const i=Math.abs(this._draggingArea?.end.x-this._draggingArea?.start.x),r=Math.abs(this._draggingArea?.end.y-this._draggingArea?.start.y);if(i<20&&r<20){this._service.removeElement(e);return}}this._draggingElement=null,this._draggingElementId=null,this._draggingArea=null,this._page.captureSync();const n=this._service.getElementById(e);D(n),this._edgeless.tools.switchToDefaultMode({elements:[n.id],editing:!1})}onPressShiftKey(e){this._draggingElementId&&this._resize(e)}_resize(e=!1){const{_draggingElementId:n,_draggingArea:i}=this;D(n),D(i);const{viewport:r}=this._service,{zoom:o}=r,{start:{x:s,y:a},end:l}=i;let{x:c,y:d}=l;if(e){const v=Math.abs(c-s),m=Math.abs(d-a),y=Math.max(v,m);c=s+(c>s?y:-y),d=a+(d>a?y:-y)}const[u,h]=r.toModelCoord(Math.min(s,c),Math.min(a,d)),p=Math.abs(s-c)/o,g=Math.abs(a-d)/o,f=new ne(u,h,p,g);this._service.updateElement(n,{xywh:f.serialize()})}_updateOverlayPosition(e,n){this._shapeOverlay&&(this._shapeOverlay.x=e,this._shapeOverlay.y=n,this._edgeless.surface.refresh())}clearOverlay(){this._shapeOverlay&&(this._shapeOverlay.dispose(),this._edgeless.surface.renderer.removeOverlay(this._shapeOverlay),this._shapeOverlay=null,this._edgeless.surface.refresh())}_hideOverlay(){this._shapeOverlay&&(this._shapeOverlay.globalAlpha=0,this._edgeless.surface.refresh())}onContainerMouseMove(e){if(!this._shapeOverlay)return;this._shapeOverlay.globalAlpha===0&&(this._shapeOverlay.globalAlpha=1);const[n,i]=this._service.viewport.toModelCoord(e.x,e.y);this._updateOverlayPosition(n,i)}onContainerMouseOut(e){e.raw.relatedTarget&&Gk(e.raw.relatedTarget,oM)||this._hideOverlay()}beforeModeSwitch(){this.clearOverlay()}afterModeSwitch(e){e.type==="shape"&&this.createOverlay()}createOverlay(){this.clearOverlay();const e=KX,n=this._edgeless.service.editSession.getLastProps("shape");switch(e.stroke=n.strokeColor,e.fill=n.fillColor,n.strokeStyle){case"dash":e.strokeLineDash=[12,12];break;case"none":e.strokeLineDash=[],e.stroke="transparent";break;default:e.strokeLineDash=[]}let i=n.shapeType;n.radius>0&&i==="rect"&&(i="roundedRect"),this._shapeOverlay=new hK(this._edgeless,i,e,{shapeStyle:n.shapeStyle,fillColor:e.fill,strokeColor:e.stroke}),this._edgeless.surface.renderer.addOverlay(this._shapeOverlay)}}var fK=Object.defineProperty,gK=Object.getOwnPropertyDescriptor,di=(t,e,n,i)=>{for(var r=i>1?void 0:i?gK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&fK(e,n,r),r};let Rn=class extends me(Ae){constructor(){super(...arguments),this._transformMap={z1:{x:0,y:5,scale:1.1,origin:"50% 100%"},z2:{x:-15,y:0,scale:.75,origin:"20% 20%"},z3:{x:15,y:0,scale:.75,origin:"80% 20%"},hidden:{x:0,y:120,scale:0,origin:"50% 50%"}},this._startCoord={x:-1,y:-1},this._dragging=!1,this._isOutside=!1,this._onDragStart=t=>{this._startCoord={x:t.x,y:t.y},this.order===1&&(this._dragging=!0,this._shapeElement.classList.add("dragging"))},this._onDragMove=t=>{if(!this._dragging)return;const e=this.edgeless.tools.currentController;e instanceof _b&&e.clearOverlay();const{x:n,y:i}=t;this._shapeElement.style.setProperty("--offset-x",`${n-this._startCoord.x}px`),this._shapeElement.style.setProperty("--offset-y",`${i-this._startCoord.y}px`);const r=this.getContainerRect(),o=i<r.top||n<r.left||n>r.right;o!==this._isOutside&&(this._backupShapeElement.style.setProperty("--y",o?"5px":"100px"),this._backupShapeElement.style.setProperty("--scale",o?"1":"0.9")),this._isOutside=o},this._onDragEnd=async t=>{if(this._startCoord.x===t.x&&this._startCoord.y===t.y){this.handleClick(),this._dragging=!1;return}if(this._dragging)if(this._dragging=!1,this.edgeless.tools.setEdgelessTool({type:"default"}),this._isOutside){const e=this._shapeElement.getBoundingClientRect();this._backupShapeElement.style.setProperty("transition","none"),this._backupShapeElement.style.setProperty("--y","100px"),this._shapeElement.style.setProperty("--offset-x","0px"),this._shapeElement.style.setProperty("--offset-y","0px"),await Dg(0),this._shapeElement.classList.remove("dragging"),this._backupShapeElement.style.removeProperty("transition");const n={x:(t.x-e.left)/e.width,y:(t.y-e.top)/e.height};this._addShape(t,n)}else this._shapeElement.classList.remove("dragging"),this._shapeElement.style.setProperty("--offset-x","0px"),this._shapeElement.style.setProperty("--offset-y","0px"),this._backupShapeElement.style.setProperty("--y","100px")},this._onMouseMove=t=>{this._dragging&&this._onDragMove({x:t.clientX,y:t.clientY})},this._touchMove=t=>{this._dragging&&this._onDragMove({x:t.touches[0].clientX,y:t.touches[0].clientY})},this._onMouseUp=t=>{this._onDragEnd({x:t.clientX,y:t.clientY}).catch(console.error)},this._onTouchEnd=t=>{this._onDragEnd({x:t.touches[0].clientX,y:t.touches[0].clientY}).catch(console.error)},this._addShape=(t,e)=>{const{x:r,y:o}=this.edgeless.getBoundingClientRect(),s=this.edgeless.service.viewport.zoom,[a,l]=this.edgeless.service.viewport.toModelCoord(t.x-r-100*e.x*s,t.y-o-100*e.y*s),c=new ne(a,l,100,100).serialize();this.edgeless.service.addElement(kn.SHAPE,{shapeType:this.shape.name==="roundedRect"?"rect":this.shape.name,xywh:c,radius:this.radius})}}connectedCallback(){super.connectedCallback(),this._disposables.addFromEvent(this.edgeless.host,"mousemove",this._onMouseMove),this._disposables.addFromEvent(this.edgeless.host,"touchmove",this._touchMove),this._disposables.addFromEvent(this.edgeless.host,"mouseup",this._onMouseUp),this._disposables.addFromEvent(this.edgeless.host,"touchend",this._onTouchEnd)}updated(t){if(!t.has("shape")&&!t.has("order"))return;const e=this._transformMap[this.order<=3?`z${this.order}`:"hidden"];this._shapeElement.style.setProperty("--x",`${e.x}px`),this._shapeElement.style.setProperty("--y",`${e.y}px`),this._shapeElement.style.setProperty("--scale",String(e.scale||1)),this._shapeElement.style.zIndex=String(999-this.order),this._shapeElement.style.transformOrigin=e.origin,this._backupShapeElement&&(this._backupShapeElement.style.setProperty("--y","100px"),this._backupShapeElement.style.setProperty("--scale","0.9"),this._backupShapeElement.style.zIndex="999"),this.edgeless.slots.edgelessToolUpdated.on(n=>{n.type})}render(){return b`
      <div
        id="shape-tool-element"
        class="shape"
        @mousedown=${t=>this._onDragStart({x:t.clientX,y:t.clientY})}
        @touchstart=${t=>{t.preventDefault(),this._onDragStart({x:t.touches[0].clientX,y:t.touches[0].clientY})}}
      >
        ${this.shape.svg}
      </div>
      ${this.order===1?b`<div id="backup-shape-element" class="shape">
            ${this.shape.svg}
          </div>`:null}
    `}};Rn.styles=X`
    .shape {
      --x: 0px;
      --y: 0px;
      --offset-x: 0px;
      --offset-y: 0px;
      --scale: 1;
      transform: translateX(calc(var(--offset-x) + var(--x)))
        translateY(calc(var(--y) + var(--offset-y))) scale(var(--scale));
      height: 60px;
      width: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      position: absolute;
      top: 12px;
      left: 16px;
      transition: all 0.5s cubic-bezier(0, -0.01, 0.01, 1.01);
    }
    .shape.dragging {
      transition: none;
    }
    .shape svg {
      height: 100%;
      filter: drop-shadow(0px 2px 8px rgba(0, 0, 0, 0.15));
    }
  `;di([L({attribute:!1})],Rn.prototype,"shape",2);di([L({attribute:!1})],Rn.prototype,"order",2);di([L({attribute:!1})],Rn.prototype,"getContainerRect",2);di([L({attribute:!1})],Rn.prototype,"handleClick",2);di([L({attribute:!1})],Rn.prototype,"edgeless",2);di([he("#shape-tool-element")],Rn.prototype,"_shapeElement",2);di([he("#backup-shape-element")],Rn.prototype,"_backupShapeElement",2);di([L({attribute:!1})],Rn.prototype,"shapeType",2);di([L({attribute:!1})],Rn.prototype,"fillColor",2);di([L({attribute:!1})],Rn.prototype,"shapeStyle",2);di([L({attribute:!1})],Rn.prototype,"strokeColor",2);di([L({attribute:!1})],Rn.prototype,"radius",2);di([ie()],Rn.prototype,"_startCoord",2);di([ie()],Rn.prototype,"_dragging",2);di([ie()],Rn.prototype,"_isOutside",2);Rn=di([W("edgeless-shape-tool-element")],Rn);const mK="calc(100% + 10px)",Yu=new WeakMap;function Wx(t){t.style.transform="translateY(0)"}function qx(t){t.style.transform=`translateY(${mK})`}function Jd(t,e,n){const i=n?.duration??230;Yu.has(e)||Yu.set(e,new Map);const r=Yu.get(e);if(D(r),r.has(t)){const d=r.get(t);return D(d),d.cancel?.(),requestAnimationFrame(()=>Wx(d.element)),d}const o=document.createElement(t);D(e.shadowRoot),e.shadowRoot.appendChild(o),o.style.transition=`transform ${i}ms ease`,qx(o),requestAnimationFrame(()=>Wx(o));const s=n?.x??0,a=n?.y??0;Object.assign(o.style,{left:`${s}px`,top:`${a}px`});const l=()=>{o.remove(),Yu.get(e)?.delete(t)},c={element:o,dispose:function(){qx(o),o.addEventListener("transitionend",l,{once:!0}),c.cancel=()=>o.removeEventListener("transitionend",l)}};return Yu.get(e)?.set(t,c),c}const bK=["--affine-background-secondary-color","--affine-tag-yellow","--affine-tag-red","--affine-tag-green","--affine-tag-blue","--affine-tag-purple"],vK=ge.union([ge.literal("--affine-background-secondary-color"),ge.literal("--affine-tag-yellow"),ge.literal("--affine-tag-red"),ge.literal("--affine-tag-green"),ge.literal("--affine-tag-blue"),ge.literal("--affine-tag-purple")]),_3=bK[0],Cb=["","--affine-note-shadow-box","--affine-note-shadow-sticker","--affine-note-shadow-paper","--affine-note-shadow-float","--affine-note-shadow-film"],yK=ge.union([ge.literal(""),ge.literal("--affine-note-shadow-box"),ge.literal("--affine-note-shadow-sticker"),ge.literal("--affine-note-shadow-paper"),ge.literal("--affine-note-shadow-float"),ge.literal("--affine-note-shadow-film")]);var v0=(t=>(t.Left="left",t.Center="center",t.Right="right",t))(v0||{}),uM=(t=>(t.Top="top",t.Center="center",t.Bottom="bottom",t))(uM||{});const Yx=ge.nativeEnum(St),v6=ge.nativeEnum(Yt),Xx=ge.nativeEnum(Rt),wK=ge.nativeEnum(dn),xK=ge.nativeEnum(IT),Kx=ge.nativeEnum(wt),Qx=ge.nativeEnum(us),Jx=ge.nativeEnum(ti),y6=ge.nativeEnum(v0),_K=ge.nativeEnum(uM),CK=ge.nativeEnum(qd),kK=ge.nativeEnum(qe),C8=ge.object({connector:ge.object({frontEndpointStyle:Yx,rearEndpointStyle:Yx,strokeStyle:v6,stroke:zx,strokeWidth:Xx,rough:ge.boolean(),mode:ge.number().optional()}),brush:ge.object({color:zx,lineWidth:Xx}),shape:ge.object({shapeType:CK,fillColor:lY,strokeColor:cY,shapeStyle:wK,filled:ge.boolean(),radius:ge.number(),strokeWidth:ge.number().optional(),strokeStyle:v6.optional(),color:ge.string().optional(),fontSize:xK.optional(),fontFamily:Kx.optional(),fontWeight:Qx.optional(),fontStyle:Jx.optional(),textAlign:y6.optional(),textHorizontalAlign:y6.optional(),textVerticalAlign:_K.optional()}),text:ge.object({color:ge.string(),fontFamily:Kx,textAlign:y6,fontWeight:Qx,fontStyle:Jx,fontSize:ge.number(),hasMaxWidth:ge.boolean()}),"affine:note":ge.object({background:vK,displayMode:kK.optional(),edgeless:ge.object({style:ge.object({borderRadius:ge.number(),borderSize:ge.number(),borderStyle:v6,shadowType:yK})})})}),e_="blocksuite:prop:record",EK=ge.object({viewport:ge.union([ge.object({centerX:ge.number(),centerY:ge.number(),zoom:ge.number()}),ge.object({referenceId:ge.string(),xywh:ge.string(),padding:ge.tuple([ge.number(),ge.number(),ge.number(),ge.number()]).optional()})]),presentBlackBackground:ge.boolean(),presentFillScreen:ge.boolean(),presentHideToolbar:ge.boolean(),templateCache:ge.string(),remoteColor:ge.string()});class SK{constructor(e){this._service=e,this._lastProps={connector:{frontEndpointStyle:ST,rearEndpointStyle:TT,stroke:_a(),strokeStyle:Yt.Solid,strokeWidth:Rt.LINE_WIDTH_TWO,rough:!1},brush:{color:_a(),lineWidth:Rt.Thin},shape:{shapeType:qd.Rect,fillColor:MT,strokeColor:PT,strokeStyle:Yt.Solid,strokeWidth:Rt.LINE_WIDTH_TWO,shapeStyle:dn.General,filled:!0,radius:0},text:{color:xb(),fontFamily:wt.Inter,textAlign:v0.Left,fontWeight:us.Regular,fontStyle:ti.Normal,fontSize:24,hasMaxWidth:!1},"affine:note":{background:_3,displayMode:qe.DocAndEdgeless,edgeless:{style:{borderRadius:8,borderSize:4,borderStyle:Yt.Solid,shadowType:Cb[1]}}}},this._disposables=new dt,this.slots={lastPropsUpdated:new Ve};const n=sessionStorage.getItem(e_);if(n){const i=C8.safeParse(JSON.parse(n));i.success&&(this._lastProps=i.data)}}getLastProps(e){return this._lastProps[e]}record(e,n){if(!t_(e))return;const i=this._lastProps[e],r=hM(n,C8.shape[e]);Object.keys(r).length!==0&&(Em.recursive(i,r),this.slots.lastPropsUpdated.emit({type:e,props:r}),sessionStorage.setItem(e_,JSON.stringify(this._lastProps)))}apply(e,n){if(!t_(e))return;const i=this._lastProps[e];pM(n,i)}_getKey(e){switch(e){case"viewport":return"blocksuite:"+this._service.page.id+":edgelessViewport";case"presentBlackBackground":return"blocksuite:presentation:blackBackground";case"presentFillScreen":return"blocksuite:presentation:fillScreen";case"presentHideToolbar":return"blocksuite:presentation:hideToolbar";case"templateCache":return"blocksuite:"+this._service.page.id+":templateTool";case"remoteColor":return"blocksuite:remote-color";default:return""}}setItem(e,n){sessionStorage.setItem(this._getKey(e),JSON.stringify(n))}getItem(e){try{const n=sessionStorage.getItem(this._getKey(e));return n?EK.shape[e].parse(JSON.parse(n)):null}catch{return null}}dispose(){this._disposables.dispose(),this.slots.lastPropsUpdated.dispose()}}function hM(t,e){const n={};return Object.entries(t).forEach(([i,r])=>{i in e.shape&&(Em.isPlainObject(r)?n[i]=hM(t[i],e.shape[i]):n[i]=r)}),n}function t_(t){return Object.keys(C8.shape).includes(t)}function pM(t,e){return Object.keys(e).forEach(n=>{e[n]!==void 0&&(n in t||(t[n]=void 0),t[n]===void 0&&(Em.isPlainObject(e[n])?(t[n]=t[n]??{},pM(t[n],e[n])):t[n]=e[n]))}),t}var TK=Object.defineProperty,IK=Object.getOwnPropertyDescriptor,kb=(t,e,n,i)=>{for(var r=i>1?void 0:i?IK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&TK(e,n,r),r};let Ea=class extends me(Ae){constructor(){super(...arguments),this.active=!1,this._menu=null}_disposeMenu(){this._menu?.dispose(),this._menu=null}updateMenu(){this._states.forEach(t=>{this._menu&&(this._menu.element[t]=this[t])})}get surface(){return this.edgeless.surface}connectedCallback(){super.connectedCallback();const{_disposables:t,edgeless:e}=this,n=e.service.editSession.getLastProps(this._type);this._states.forEach(i=>{const r=n[i];r!==void 0&&Object.assign(this,{[i]:r})}),t.add(this.edgeless.slots.edgelessToolUpdated.on(i=>{i.type!==this._type&&this._disposeMenu()})),this.initLastPropsSlot(),e.bindHotKey({Escape:()=>{e.edgelessTool.type===this._type&&e.tools.setEdgelessTool({type:"default"})}},{global:!0})}initLastPropsSlot(){this._disposables.add(this.edgeless.service.editSession.slots.lastPropsUpdated.on(({type:t,props:e})=>{t===this._type&&this._states.forEach(n=>{const i=n;e[i]!=null&&Object.assign(this,{[i]:e[i]})})}))}disconnectedCallback(){this._disposeMenu(),super.disconnectedCallback()}};kb([L({attribute:!1})],Ea.prototype,"edgeless",2);kb([L({attribute:!1})],Ea.prototype,"active",2);Ea=kb([W("edgeless-tool-button")],Ea);var LK=Object.defineProperty,MK=Object.getOwnPropertyDescriptor,Mc=(t,e,n,i)=>{for(var r=i>1?void 0:i?MK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&LK(e,n,r),r};const{Rect:fM,Triangle:PK,Ellipse:AK,Diamond:$K}=qd,w6=[{name:fM,svg:OI},{name:PK,svg:NI},{name:AK,svg:RI},{name:$K,svg:HI},{name:"roundedRect",svg:FI}];let Ts=class extends Ea{constructor(){super(...arguments),this.shapeStyle=dn.Scribbled,this.shapeType=fM,this.fillColor=MT,this.strokeColor=PT,this.radius=0,this.order=w6.map((t,e)=>e+1),this._type="shape",this._states=["shapeStyle","shapeType","fillColor","strokeColor","radius"]}_toggleMenu(){this._menu?(this._disposeMenu(),this.requestUpdate()):(this.edgeless.tools.setEdgelessTool({type:this._type,shapeType:this.shapeType}),this._menu=Jd("edgeless-shape-menu",this,{x:-240,y:-40}),this._menu.element.edgeless=this.edgeless,this.updateMenu(),this._menu.element.onChange=t=>{t.shapeType&&this._activeShape(t.shapeType),t.shapeType==="rect"?t.radius=0:t.shapeType==="roundedRect"&&(t.shapeType="rect",t.radius=.1),this.edgeless.service.editSession.record(this._type,t)})}connectedCallback(){super.connectedCallback(),this.edgeless.service.editSession.slots.lastPropsUpdated.on(({type:t,props:e})=>{if(t==="shape"&&e.shapeType){let{shapeType:n}=e;n==="rect"&&e.radius>0&&(n="roundedRect"),this._activeShape(n)}})}initLastPropsSlot(){this._disposables.add(this.edgeless.service.editSession.slots.lastPropsUpdated.on(({type:t,props:e})=>{t===this._type&&this._states.forEach(n=>{const i=n;i==="rect"&&e.radius>0||e[i]!=null&&Object.assign(this,{[i]:e[i]})})}))}updated(t){if(this._states.some(e=>t.has(e))&&this._menu){this.updateMenu(),this.edgeless.slots.edgelessToolUpdated.emit({type:this._type,shapeType:this.shapeType});const e=this.edgeless.tools.currentController;e instanceof _b&&e.createOverlay()}}_activeShape(t){const{order:e}=this,n=w6.findIndex(({name:o})=>o===t),i=e[n],r=e.map(o=>o<i?o+1:o===i?1:o);this.order=r}render(){const{active:t}=this;return b`
      <edgeless-toolbar-button
        class="edgeless-shape-button"
        .tooltip=${this._menu?"":yr("Shape","S")}
        .tooltipOffset=${5}
        .active=${t}
      >
        <div class="container-clip">
          <div
            class="shapes"
            style=${we({color:`${Y1(this.fillColor)?"var(--affine-white-60)":`var(${this.fillColor})`}`,stroke:"var(--affine-black-10)"})}
          >
            ${Fe(w6,(e,n)=>b`<edgeless-shape-tool-element
                .shape=${e}
                .fillColor=${this.fillColor}
                .strokeColor=${this.strokeColor}
                .shapeStyle=${this.shapeStyle}
                .radius=${this.radius}
                .order=${this.order[n]}
                .getContainerRect=${()=>this.getBoundingClientRect()}
                .handleClick=${()=>this._toggleMenu()}
                .edgeless=${this.edgeless}
              ></edgeless-shape-tool-element>`)}
          </div>
        </div>
      </edgeless-toolbar-button>
    `}};Ts.styles=X`
    .shape-button-group {
      display: block;
      position: relative;
      width: 72px;
      height: 48px;
    }

    edgeless-toolbar-button svg {
      transition: 0.3s ease-in-out;
    }

    edgeless-toolbar-button:hover svg {
      scale: 1.15;
    }

    edgeless-toolbar-button svg + svg {
      position: absolute;
      top: 6px;
      right: 4px;
    }

    :host {
      --width: 102px;
      --height: 64px;
      position: relative;
      width: var(--width);
      height: var(--height);
    }

    .container-clip {
      padding: 10000px 10000px 0;
      margin: -10000px -10000px 0;
      overflow: hidden;
      pointer-events: none;
    }

    .shapes {
      height: var(--height);
      width: var(--width);
      color: #9747ff;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      pointer-events: auto;
    }
  `;Mc([ie()],Ts.prototype,"shapeStyle",2);Mc([ie()],Ts.prototype,"shapeType",2);Mc([ie()],Ts.prototype,"fillColor",2);Mc([ie()],Ts.prototype,"strokeColor",2);Mc([ie()],Ts.prototype,"radius",2);Mc([ie()],Ts.prototype,"order",2);Ts=Mc([W("edgeless-shape-tool-button")],Ts);var BK=Object.defineProperty,DK=Object.getOwnPropertyDescriptor,Pc=(t,e,n,i)=>{for(var r=i>1?void 0:i?DK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&BK(e,n,r),r};const gM=468,OK=40;let Is=class extends me(Ae){constructor(){super(...arguments),this.menuWidth=gM,this.showNext=!0}_toggleSlideButton(t){this._previousSlideButton.style.opacity="1",this._nextSlideButton.style.opacity="1";const e=0,n=this._slideMenuContent.clientWidth-this.menuWidth+2;t===e&&(this._previousSlideButton.style.opacity="0"),t===n&&(this._nextSlideButton.style.opacity="0")}firstUpdated(){this._toggleSlideButton(this._menuContainer.scrollLeft),this._disposables.addFromEvent(this._menuContainer,"scrollend",()=>{this._toggleSlideButton(this._menuContainer.scrollLeft)})}disconnectedCallback(){super.disconnectedCallback(),this._disposables.dispose()}_handleWheel(t){t.stopPropagation(),this._menuContainer.scrollBy({left:t.deltaY})}_handleSlideButtonClick(t){const e=t==="left"?0:this._slideMenuContent.clientWidth;this._menuContainer.scrollTo({left:e,behavior:"smooth"})}render(){const t=we({"--menu-width":`${this.menuWidth}px`});return b`
      <div>
        <div
          class="previous-slide-button"
          @click=${()=>this._handleSlideButtonClick("left")}
        >
          ${ya}
        </div>
        <div class="menu-container" style=${t}>
          <div class="slide-menu-content" @wheel="${this._handleWheel}">
            <slot></slot>
          </div>
        </div>
        <div
          style=${we({display:this.showNext?"normal":"none"})}
          class="next-slide-button"
          @click=${()=>this._handleSlideButtonClick("right")}
        >
          ${ya}
        </div>
      </div>
    `}};Is.styles=X`
    ::-webkit-scrollbar {
      display: none;
    }
    .menu-container {
      --menu-width: ${gM}px;
      --menu-height: ${OK}px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px 8px 0 0;
      border: 1px solid var(--affine-border-color);
      display: flex;
      align-items: center;
      width: var(--menu-width);
      overflow-x: auto;
      position: relative;
      height: calc(var(--menu-height) + 1px);
      box-sizing: border-box;
      padding: 0 18px;
    }
    .slide-menu-content {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      left: 0;
      top: 0;
      height: var(--menu-height);
      transition: left 0.5s ease-in-out;
      padding: 0 16px;
    }
    .next-slide-button,
    .previous-slide-button {
      align-items: center;
      justify-content: center;
      position: absolute;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid var(--affine-border-color);
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      color: var(--affine-icon-color);
      transition:
        transform 0.3s ease-in-out,
        opacity 0.5s ease-in-out;
      z-index: 12;
    }
    .next-slide-button {
      opacity: 0;
      display: flex;
      top: 50%;
      right: 0;
      transform: translate(50%, -50%) scale(0.5);
    }
    .next-slide-button:hover {
      cursor: pointer;
      transform: translate(50%, -50%) scale(1);
    }
    .previous-slide-button {
      opacity: 0;
      top: 50%;
      left: 0;
      transform: translate(-50%, -50%) scale(0.5);
    }
    .previous-slide-button:hover {
      cursor: pointer;
      transform: translate(-50%, -50%) scale(1);
    }
    .previous-slide-button svg {
      transform: rotate(180deg);
    }
  `;Pc([L({attribute:!1})],Is.prototype,"menuWidth",2);Pc([L({attribute:!1})],Is.prototype,"showNext",2);Pc([he(".menu-container")],Is.prototype,"_menuContainer",2);Pc([he(".next-slide-button")],Is.prototype,"_nextSlideButton",2);Pc([he(".previous-slide-button")],Is.prototype,"_previousSlideButton",2);Pc([he(".slide-menu-content")],Is.prototype,"_slideMenuContent",2);Is=Pc([W("edgeless-slide-menu")],Is);var RK=Object.defineProperty,NK=Object.getOwnPropertyDescriptor,y0=(t,e,n,i)=>{for(var r=i>1?void 0:i?NK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&RK(e,n,r),r};let Ql=class extends me(Ae){render(){if(this.edgeless.edgelessTool.type!=="brush")return ae;const{color:t,lineWidth:e}=this;return b`
      <edgeless-slide-menu>
        <div class="menu-content">
          <edgeless-line-width-panel
            .selectedSize=${e}
            @select=${n=>this.onChange({lineWidth:n.detail})}
          >
          </edgeless-line-width-panel>
          <menu-divider .vertical=${!0}></menu-divider>
          <edgeless-one-row-color-panel
            .value=${t}
            @select=${n=>this.onChange({color:n.detail})}
          ></edgeless-one-row-color-panel>
        </div>
      </edgeless-slide-menu>
    `}};Ql.styles=X`
    :host {
      display: flex;
      position: absolute;
      z-index: -1;
    }

    .menu-content {
      display: flex;
      align-items: center;
    }

    menu-divider {
      height: 24px;
      margin: 0 9px;
    }
  `;y0([L({attribute:!1})],Ql.prototype,"edgeless",2);y0([L({attribute:!1})],Ql.prototype,"color",2);y0([L({attribute:!1})],Ql.prototype,"lineWidth",2);y0([L({attribute:!1})],Ql.prototype,"onChange",2);Ql=y0([W("edgeless-brush-menu")],Ql);var HK=Object.defineProperty,FK=Object.getOwnPropertyDescriptor,Eb=(t,e,n,i)=>{for(var r=i>1?void 0:i?FK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&HK(e,n,r),r};let qh=class extends Ea{constructor(){super(...arguments),this.color=IX,this.lineWidth=Rt.LINE_WIDTH_FOUR,this._type="brush",this._states=["color","lineWidth"]}_toggleBrushMenu(){this._menu?this._disposeMenu():(this.edgeless.tools.setEdgelessTool({type:this._type}),this._menu=Jd("edgeless-brush-menu",this,{x:110,y:-40}),this._menu.element.edgeless=this.edgeless,this.updateMenu(),this._menu.element.onChange=t=>{this.edgeless.service.editSession.record(this._type,t)})}updated(t){this._states.some(e=>t.has(e))&&this._menu&&(this.updateMenu(),this.edgeless.slots.edgelessToolUpdated.emit({type:this._type}))}render(){const{active:t}=this;return b`
      <edgeless-toolbar-button
        class="edgeless-brush-button"
        .tooltip=${this._menu?"":yr("Pen","P")}
        .tooltipOffset=${4}
        .active=${t}
        @click=${()=>{this._toggleBrushMenu()}}
      >
        <div class="edgeless-brush-button">
          <div class=${t?"active-mode":""}></div>
          <div style=${we({color:`var(${this.color})`})}>
            ${BI}
          </div>
        </div>
      </edgeless-toolbar-button>
    `}};qh.styles=X`
    :host {
      display: flex;
    }
    .edgeless-brush-button {
      position: relative;
      height: 66px;
      width: 40px;
      overflow-y: hidden;
    }
    .active-mode {
      position: absolute;
      top: 4px;
      left: 5px;
      width: 30px;
      height: 66px;
      border-top-left-radius: 22px;
      border-top-right-radius: 22px;
      background: var(--affine-hover-color);
    }
    #edgeless-pen-icon {
      position: absolute;
      left: 3px;
      transform: translateY(10px);
      transition: transform 0.3s ease-in-out;
    }
    #edgeless-pen-icon:hover {
      transform: translateY(5px);
    }
  `;Eb([ie()],qh.prototype,"color",2);Eb([ie()],qh.prototype,"lineWidth",2);qh=Eb([W("edgeless-brush-tool-button")],qh);var UK=Object.defineProperty,VK=Object.getOwnPropertyDescriptor,eu=(t,e,n,i)=>{for(var r=i>1?void 0:i?VK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&UK(e,n,r),r};const zK=474;function jK(t,e){const n=yr("Straight","L"),i=yr("Elbowed","X"),r=yr("Curve","C");return b`
    <div class="connector-mode-button-group">
      <edgeless-tool-icon-button
        .active=${t===jt.Straight}
        .activeMode=${"background"}
        .iconContainerPadding=${2}
        .tooltip=${n}
        @click=${()=>e({mode:jt.Straight})}
      >
        ${CI}
      </edgeless-tool-icon-button>
      <edgeless-tool-icon-button
        .active=${t===jt.Curve}
        .activeMode=${"background"}
        .iconContainerPadding=${2}
        .tooltip=${r}
        @click=${()=>e({mode:jt.Curve})}
      >
        ${xI}
      </edgeless-tool-icon-button>
      <edgeless-tool-icon-button
        .active=${t===jt.Orthogonal}
        .activeMode=${"background"}
        .iconContainerPadding=${2}
        .tooltip=${i}
        @click=${()=>e({mode:jt.Orthogonal})}
      >
        ${_I}
      </edgeless-tool-icon-button>
    </div>
  `}let Sa=class extends Ae{get edgelessTool(){return this.edgeless.edgelessTool}render(){if(this.edgelessTool.type!=="connector")return ae;const{stroke:t,strokeWidth:e}=this,n=jK(this.mode,this.onChange);return b`
      <edgeless-slide-menu .menuWidth=${zK}>
        <div class="connector-submenu-content">
          ${n}
          <div class="submenu-divider"></div>
          <edgeless-line-width-panel
            .selectedSize=${e}
            @select=${i=>this.onChange({strokeWidth:i.detail})}
          >
          </edgeless-line-width-panel>
          <div class="submenu-divider"></div>
          <edgeless-one-row-color-panel
            .value=${t}
            @select=${i=>this.onChange({stroke:i.detail})}
          ></edgeless-one-row-color-panel>
        </div>
      </edgeless-slide-menu>
    `}};Sa.styles=X`
    :host {
      position: absolute;
      display: flex;
      z-index: -1;
    }

    .connector-submenu-content {
      display: flex;
      height: 24px;
      align-items: center;
      justify-content: center;
    }

    .connector-mode-button-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 14px;
    }

    .connector-mode-button-group > edgeless-tool-icon-button svg {
      fill: var(--affine-icon-color);
    }

    .submenu-divider {
      width: 1px;
      height: 24px;
      margin: 0 16px;
      background-color: var(--affine-border-color);
      display: inline-block;
    }
  `;eu([L({attribute:!1})],Sa.prototype,"edgeless",2);eu([L({attribute:!1})],Sa.prototype,"mode",2);eu([L({attribute:!1})],Sa.prototype,"stroke",2);eu([L({attribute:!1})],Sa.prototype,"strokeWidth",2);eu([L({attribute:!1})],Sa.prototype,"onChange",2);Sa=eu([W("edgeless-connector-menu")],Sa);var GK=Object.defineProperty,ZK=Object.getOwnPropertyDescriptor,C3=(t,e,n,i)=>{for(var r=i>1?void 0:i?ZK(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&GK(e,n,r),r};let X1=class extends Ea{constructor(){super(...arguments),this.mode=jt.Curve,this.stroke=_a(),this.strokeWidth=Rt.LINE_WIDTH_TWO,this._type="connector",this._states=["mode","stroke","strokeWidth"]}_toggleMenu(){this._menu?(this._disposeMenu(),this.requestUpdate()):(this._menu=Jd("edgeless-connector-menu",this,{x:50,y:-40}),this._menu.element.edgeless=this.edgeless,this.updateMenu(),this._menu.element.onChange=t=>{this.edgeless.service.editSession.record(this._type,t)})}updated(t){this._states.some(e=>t.has(e))&&this._menu&&(this.updateMenu(),this.edgeless.slots.edgelessToolUpdated.emit({type:this._type,mode:this.mode}))}render(){const{active:t}=this,e=t?"currentColor":"#77757D";return b`
      <edgeless-tool-icon-button
        .tooltip=${this._menu?"":"Connector"}
        .tooltipOffset=${17}
        .active=${t}
        .iconContainerPadding=${8}
        class="edgeless-connector-button"
        @click=${()=>{this.edgeless.tools.setEdgelessTool({type:"connector",mode:this.mode}),this._toggleMenu()}}
      >
        ${tL}
        <span class="arrow-up-icon" style=${we({color:e})}>
          ${u0}
        </span>
      </edgeless-tool-icon-button>
    `}};X1.styles=X`
    :host {
      display: flex;
    }
    .edgeless-connector-button {
      display: flex;
      position: relative;
    }
    .arrow-up-icon {
      position: absolute;
      top: 4px;
      right: 2px;
      font-size: 0;
    }
  `;C3([ie()],X1.prototype,"mode",2);C3([ie()],X1.prototype,"stroke",2);C3([ie()],X1.prototype,"strokeWidth",2);X1=C3([W("edgeless-connector-tool-button")],X1);const WK=["http","https","ftp","sftp","mailto","tel"],qK=/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,YK=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,6}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function k3(t){return WK.find(i=>t.startsWith(i+":"))?t:qK.test(t)?"mailto:"+t:"http://"+t}function To(t){if(!t)return!1;const e=k3(t);if(e===t){try{new URL(e)}catch{return!1}return!0}return YK.test(e)}const XK=["com","org","net","edu","gov","co","io","me","moe","mil","top","dev","xyz","info","cat","ru","de","jp","uk","pro"];function KK(t){const e=t.hostname.split(".").pop();return e?XK.includes(e):!1}function QK(t){if(!To(t))return!1;const e=new URL(k3(t));return!!KK(e)}function JK(t){const e=t.getData("text/plain");return To(e)}function w0(){return Wo()==="light"?{LoadingIcon:n5,EmbedCardBannerIcon:WL,EmbedCardHorizontalIcon:YL,EmbedCardListIcon:KL,EmbedCardVerticalIcon:JL,EmbedCardCubeIcon:tM}:{LoadingIcon:i5,EmbedCardBannerIcon:qL,EmbedCardHorizontalIcon:XL,EmbedCardListIcon:QL,EmbedCardVerticalIcon:eM,EmbedCardCubeIcon:nM}}function mM(t){const e=t.replace(/\n/g,"").replace(/[\s]{2,}/g," ");return`data:image/svg+xml,${encodeURIComponent(e)}`}const eQ=mM(`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M10.6944 8.33487C10.9653 7.67285 11.6283 7.21423 12.3869 7.21423C13.1346 7.21423 13.7895 7.65975 14.0675 8.30642C14.3487 8.13443 14.6802 8.03569 15.0322 8.03569C16.0254 8.03569 16.8548 8.82187 16.8548 9.8214V9.90652C17.103 9.78332 17.383 9.71426 17.6774 9.71426C18.6706 9.71426 19.5 10.5004 19.5 11.5V14.5714C19.5 18.4111 16.3018 21.5 12.3869 21.5C11.4279 21.5 10.5029 21.3687 9.61008 20.9533C8.71611 20.5373 7.89034 19.8532 7.10147 18.8019L5.08581 16.1683C4.51001 15.4567 4.57347 14.4352 5.23 13.797C5.93899 13.1078 7.08249 13.1078 7.79148 13.797L7.79968 13.805C7.84226 13.8483 7.88165 13.889 7.91846 13.9273C7.92006 13.726 7.91977 13.4872 7.91942 13.2045C7.91926 13.0733 7.91909 12.9325 7.91909 12.7817V9.85709C7.91909 8.85756 8.74847 8.07138 9.7417 8.07138C10.0887 8.07138 10.4158 8.16735 10.6944 8.33487ZM10.5643 9.85712C10.5643 9.43634 10.2095 9.07138 9.7417 9.07138C9.27389 9.07138 8.91909 9.43633 8.91909 9.85709V12.7817C8.91909 12.9257 8.91926 13.0621 8.91943 13.1909C8.92002 13.6625 8.92049 14.0329 8.91187 14.307C8.9064 14.481 8.89684 14.6361 8.87748 14.7637C8.8624 14.863 8.82868 15.055 8.70064 15.2061C8.62011 15.3012 8.49922 15.3839 8.34225 15.4068C8.19872 15.4279 8.07952 15.3907 8.00536 15.3581C7.87099 15.299 7.7587 15.1973 7.68787 15.1301C7.60764 15.0539 7.49797 14.9378 7.37723 14.8099C7.28546 14.7128 7.18728 14.6088 7.09077 14.5105C6.76957 14.2021 6.24669 14.2033 5.92703 14.514C5.63861 14.7944 5.614 15.2343 5.86566 15.5423L5.87549 15.5548L7.90002 18.2C8.61071 19.1475 9.31465 19.7129 10.032 20.0466C10.751 20.3812 11.5195 20.5 12.3869 20.5C15.7764 20.5 18.5 17.8323 18.5 14.5714V11.5C18.5 11.0792 18.1452 10.7143 17.6774 10.7143C17.2096 10.7143 16.8548 11.0792 16.8548 11.5V12C16.8548 12.2761 16.6309 12.5 16.3548 12.5C16.0786 12.5 15.8548 12.2761 15.8548 12V9.8214C15.8548 9.40064 15.5 9.03569 15.0322 9.03569C14.5643 9.03569 14.2095 9.40064 14.2095 9.8214V11.1428C14.2095 11.419 13.9857 11.6428 13.7095 11.6428C13.4334 11.6428 13.2095 11.419 13.2095 11.1428V8.99995C13.2095 8.57919 12.8547 8.21423 12.3869 8.21423C11.9191 8.21423 11.5643 8.57919 11.5643 8.99995V11.1428C11.5643 11.419 11.3405 11.6428 11.0643 11.6428C10.7882 11.6428 10.5643 11.419 10.5643 11.1428V9.85712Z"
      fill="black"
    />
    <path
      d="M9.7417 9.07138C10.2095 9.07138 10.5643 9.43634 10.5643 9.85712V11.1428C10.5643 11.419 10.7882 11.6428 11.0643 11.6428C11.3405 11.6428 11.5643 11.419 11.5643 11.1428V8.99995C11.5643 8.57919 11.9191 8.21423 12.3869 8.21423C12.8547 8.21423 13.2095 8.57919 13.2095 8.99995V11.1428C13.2095 11.419 13.4334 11.6428 13.7095 11.6428C13.9857 11.6428 14.2095 11.419 14.2095 11.1428V9.8214C14.2095 9.40064 14.5643 9.03569 15.0322 9.03569C15.5 9.03569 15.8548 9.40064 15.8548 9.8214V12C15.8548 12.2761 16.0786 12.5 16.3548 12.5C16.6309 12.5 16.8548 12.2761 16.8548 12V11.5C16.8548 11.0792 17.2096 10.7143 17.6774 10.7143C18.1452 10.7143 18.5 11.0792 18.5 11.5V14.5714C18.5 17.8323 15.7764 20.5 12.3869 20.5C11.5195 20.5 10.751 20.3812 10.032 20.0466C9.31465 19.7129 8.61071 19.1475 7.90002 18.2L5.87549 15.5548L5.86566 15.5423C5.614 15.2343 5.63861 14.7944 5.92703 14.514C6.24669 14.2033 6.76957 14.2021 7.09077 14.5105C7.18728 14.6088 7.28546 14.7128 7.37723 14.8099C7.49797 14.9378 7.60764 15.0539 7.68787 15.1301C7.7587 15.1973 7.87099 15.299 8.00536 15.3581C8.07952 15.3907 8.19872 15.4279 8.34225 15.4068C8.49922 15.3839 8.62011 15.3012 8.70064 15.2061C8.82868 15.055 8.8624 14.863 8.87748 14.7637C8.89684 14.6361 8.9064 14.481 8.91187 14.307C8.92049 14.0329 8.92002 13.6625 8.91943 13.1909C8.91926 13.0621 8.91909 12.9257 8.91909 12.7817V9.85709C8.91909 9.43633 9.27389 9.07138 9.7417 9.07138Z"
      fill="white"
    />
  </svg>
`),tQ=mM(`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M10.6944 3.62063C10.9653 2.95862 11.6283 2.5 12.3869 2.5C13.3802 2.5 14.2096 3.28619 14.2096 4.28571V4.40655C14.4578 4.28334 14.7378 4.21429 15.0322 4.21429C16.0254 4.21429 16.8548 5.00047 16.8548 6V6.97798C17.103 6.85477 17.383 6.78571 17.6774 6.78571C18.6706 6.78571 19.5 7.5719 19.5 8.57143V14.5714C19.5 18.4111 16.3018 21.5 12.3869 21.5C11.4279 21.5 10.5029 21.3687 9.61009 20.9533C8.71742 20.538 7.89275 19.8553 7.10492 18.8065L3.89715 14.8057C3.31723 14.0938 3.37951 13.0692 4.03749 12.4296C4.74649 11.7404 5.88998 11.7404 6.59897 12.4296C6.60945 12.4398 6.61948 12.4504 6.62902 12.4615L7.19243 13.1145C7.49969 13.4896 7.73216 13.7452 7.90552 13.9094C7.90575 13.9058 7.90599 13.9021 7.90621 13.8984C7.92066 13.6641 7.92009 13.374 7.91941 13.0239C7.91926 12.9461 7.9191 12.8654 7.9191 12.7817V5.14286C7.9191 4.14333 8.74848 3.35714 9.74172 3.35714C10.0887 3.35714 10.4158 3.45312 10.6944 3.62063ZM11.5643 11.1429C11.5643 11.419 11.3405 11.6429 11.0643 11.6429C10.7882 11.6429 10.5643 11.419 10.5643 11.1429V5.14286C10.5643 4.7221 10.2095 4.35714 9.74172 4.35714C9.2739 4.35714 8.9191 4.7221 8.9191 5.14286V12.7817C8.9191 12.858 8.91927 12.9337 8.91943 13.0085C8.92019 13.3597 8.92092 13.6907 8.90432 13.9599C8.89417 14.1245 8.87652 14.2886 8.84181 14.4348C8.80979 14.5696 8.74873 14.7552 8.60644 14.9018C8.43071 15.0827 8.19413 15.142 7.96546 15.0976C7.77497 15.0607 7.60654 14.9565 7.46937 14.8519C7.18917 14.6383 6.84626 14.2699 6.4228 13.7533L5.88792 13.1333C5.56593 12.8348 5.05078 12.8392 4.73453 13.1467C4.44611 13.427 4.4215 13.8669 4.67315 14.175L4.67604 14.1785L7.89011 18.1872L7.90002 18.2C8.6107 19.1476 9.31466 19.7129 10.032 20.0467C10.751 20.3813 11.5195 20.5 12.3869 20.5C15.7764 20.5 18.5 17.8323 18.5 14.5714V8.57143C18.5 8.15067 18.1452 7.78571 17.6774 7.78571C17.2096 7.78571 16.8548 8.15067 16.8548 8.57143V12C16.8548 12.2761 16.6309 12.5 16.3548 12.5C16.0786 12.5 15.8548 12.2761 15.8548 12V6C15.8548 5.57924 15.5 5.21429 15.0322 5.21429C14.5644 5.21429 14.2096 5.57924 14.2096 6V11.1429C14.2096 11.419 13.9857 11.6429 13.7096 11.6429C13.4334 11.6429 13.2096 11.419 13.2096 11.1429V4.28571C13.2096 3.86496 12.8548 3.5 12.3869 3.5C11.9191 3.5 11.5643 3.86496 11.5643 4.28571V11.1429Z"
      fill="black"
    />
    <path
      d="M11.0643 11.6429C11.3405 11.6429 11.5643 11.419 11.5643 11.1429V4.28571C11.5643 3.86496 11.9191 3.5 12.3869 3.5C12.8548 3.5 13.2096 3.86496 13.2096 4.28571V11.1429C13.2096 11.419 13.4334 11.6429 13.7096 11.6429C13.9857 11.6429 14.2096 11.419 14.2096 11.1429V6C14.2096 5.57924 14.5644 5.21429 15.0322 5.21429C15.5 5.21429 15.8548 5.57924 15.8548 6V12C15.8548 12.2761 16.0786 12.5 16.3548 12.5C16.6309 12.5 16.8548 12.2761 16.8548 12V8.57143C16.8548 8.15067 17.2096 7.78571 17.6774 7.78571C18.1452 7.78571 18.5 8.15067 18.5 8.57143V14.5714C18.5 17.8323 15.7764 20.5 12.3869 20.5C11.5195 20.5 10.751 20.3813 10.032 20.0467C9.31466 19.7129 8.6107 19.1476 7.90002 18.2L7.89011 18.1872L4.67604 14.1785L4.67315 14.175C4.4215 13.8669 4.44611 13.427 4.73453 13.1467C5.05078 12.8392 5.56593 12.8348 5.88792 13.1333L6.4228 13.7533C6.84626 14.2699 7.18917 14.6383 7.46937 14.8519C7.60654 14.9565 7.77497 15.0607 7.96546 15.0976C8.19413 15.142 8.43071 15.0827 8.60644 14.9018C8.74873 14.7552 8.80979 14.5696 8.84181 14.4348C8.87652 14.2886 8.89417 14.1245 8.90432 13.9599C8.92092 13.6907 8.92019 13.3597 8.91943 13.0085C8.91927 12.9337 8.9191 12.858 8.9191 12.7817V5.14286C8.9191 4.7221 9.2739 4.35714 9.74172 4.35714C10.2095 4.35714 10.5643 4.7221 10.5643 5.14286V11.1429C10.5643 11.419 10.7882 11.6429 11.0643 11.6429Z"
      fill="white"
    />
  </svg>
`),bM=t=>typeof t!="string"?"":t.replace(/-/g,"_").replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase().replace(/(\D+)(\d+)$/g,"$1-$2").replace(/\s|_/g,"-"),n_=(t,e)=>`url(${t}), ${e.join(", ")}`,n1="apple-system, BlinkMacSystemFont,'Helvetica Neue', Tahoma, 'PingFang SC', 'Microsoft Yahei', Arial,'Hiragino Sans GB', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji','Segoe UI Symbol', 'Noto Color Emoji'",vt={fontFamily:`'Inter', 'Source Sans 3', Poppins, ${n1}`,fontSerifFamily:`'Source Serif 4', 'Noto Serif' , serif, 'Cambria', ${n1}`,fontMonoFamily:`'Source Code Pro', 'IBM Plex Mono', 'Roboto Mono','Noto Sans Mono', 'Noto Sans CJK',  ${n1}`,fontSansFamily:`'Inter', 'Source Sans 3', Poppins, ${n1}`,fontNumberFamily:`'Roboto Mono', 'Noto Sans Mono', ${n1}`,fontCodeFamily:`'Space Mono', Consolas, Menlo, Monaco, Courier, monospace, ${n1}`,fontTitle:"36px",fontH1:"28px",fontH2:"26px",fontH3:"24px",fontH4:"22px",fontH5:"20px",fontH6:"18px",fontBase:"15px",fontSm:"14px",fontXs:"12px",lineHeight:"calc(1em + 8px)",zIndexModal:"1000",zIndexPopover:"1000",paragraphSpace:"8px",popoverRadius:"12px",editorWidth:"944px",editorSidePadding:"96px",zoom:"1",scale:"calc(1 / var(--affine-zoom))",paletteLineYellow:"rgb(255, 211, 56)",paletteLineOrange:"rgb(255, 175, 56)",paletteLineTangerine:"rgb(250, 124, 69)",paletteLineRed:"rgb(237, 63, 63)",paletteLineMagenta:"rgb(230, 96, 164)",paletteLinePurple:"rgb(110, 82, 223)",paletteLineNavy:"rgb(59, 37, 204)",paletteLineBlue:"rgb(79, 144, 255)",paletteLineTeal:"rgb(122, 226, 213)",paletteLineGreen:"rgb(124, 194, 112)",paletteLineWhite:"rgb(255, 255, 255)",paletteLineBlack:"rgb(35, 35, 35)",paletteLineGrey:"rgb(191, 192, 191)",paletteShapeYellow:"rgb(255, 223, 107)",paletteShapeOrange:"rgb(255, 196, 107)",paletteShapeTangerine:"rgb(251, 161, 121)",paletteShapeRed:"rgb(241, 111, 111)",paletteShapeMagenta:"rgb(237, 140, 189)",paletteShapePurple:"rgb(147, 126, 231)",paletteShapeNavy:"rgb(122, 149, 246)",paletteShapeBlue:"rgb(184, 227, 255)",paletteShapeGreen:"rgb(157, 209, 148)",paletteShapeWhite:"rgb(255, 255, 255)",paletteShapeBlack:"rgb(35, 35, 35)",paletteShapeGrey:"rgb(216, 217, 216)",multiPlayersPurple:"rgba(123,97,255,1)",multiPlayersMagenta:"rgba(245, 49, 179, 1)",multiPlayersRed:"rgba(243,87,52,1)",multiPlayersOrange:"rgba(255, 138, 0, 1)",multiPlayersGreen:"rgba(27, 196, 125, 1)",paletteShapeTeal:"rgb(184, 242, 231)",multiPlayersBlue:"rgba(24, 160, 251, 1)",multiPlayersBrown:"rgba(154, 101, 51, 1)",multiPlayersGrey:"rgba(170, 170, 170, 1)",blue:"rgba(30, 150, 235, 1)",pureBlack:"rgba(0, 0, 0, 1)",pureBlack10:"rgba(0, 0, 0, 0.1)",pureBlack20:"rgba(0, 0, 0, 0.2)",pureBlack80:"rgba(0, 0, 0, 0.8)",pureWhite:"rgba(255, 255, 255, 1)",pureWhite10:"rgba(255, 255, 255, 0.1)",toggleCircleBackgroundColor:"rgba(255, 255, 255, 1)",toggleDisableBackgroundColor:"rgba(119, 117, 125, 1)",toggleCircleShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.25), inset -2px -3px 2px 0px rgba(0, 0, 0, 0.05)",buttonInnerShadow:"0px 1px 2px 0px rgba(255, 255, 255, 0.25) inset",multiCursorsShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.28)",multiPlayersShadow:"0px 1px 6px 0px rgba(0, 0, 0, 0.16)",grabbingCursor:n_(eQ,["grabbing"]),grabCursor:n_(tQ,["grab"])},nQ={...vt,themeMode:"light",brandColor:"#1E96EB",tertiaryColor:"rgba(239, 250, 255, 1)",primaryColor:"#1E96EB",primaryColor04:"rgba(30, 150, 235, 0.04)",secondaryColor:"rgb(125, 145, 255)",blue50:"rgba(239, 250, 255, 1)",blue100:"rgba(219, 244, 254, 1)",blue200:"rgba(191, 236, 254, 1)",blue300:"rgba(147, 226, 253, 1)",blue400:"rgba(96, 207, 250, 1)",blue500:"rgba(58, 181, 247, 1)",blue600:"rgba(30, 150, 235, 1)",blue700:"rgba(28, 129, 217, 1)",blue800:"rgba(30, 103, 175, 1)",blue900:"rgba(30, 87, 138, 1)",blue950:"rgba(23, 54, 84, 1)",backgroundSuccessColor:"rgba(231, 250, 243, 1)",backgroundErrorColor:"rgba(253, 236, 235, 1)",backgroundProcessingColor:"rgba(233, 241, 255, 1)",backgroundWarningColor:"rgba(255, 237, 219, 1)",backgroundPrimaryColor:"rgb(255, 255, 255)",backgroundOverlayPanelColor:"rgb(251, 251, 252)",backgroundSecondaryColor:"rgba(244, 244, 245, 1)",backgroundTertiaryColor:"rgb(238, 238, 238)",backgroundCodeBlock:"rgba(247, 246, 250, 1)",backgroundModalColor:"rgba(0, 0, 0, 0.75)",textPrimaryColor:"rgb(66, 65, 73)",textSecondaryColor:"rgb(142, 141, 145)",textDisableColor:"rgb(169, 169, 173)",textEmphasisColor:"#1E96EB",hoverColor:"rgba(0, 0, 0, 0.04)",hoverColorFilled:"rgb(245, 245, 245)",linkColor:"#1E67AF",quoteColor:"rgba(194, 193, 197, 1)",listColor:"rgba(133, 131, 140, 1)",iconColor:"rgb(119, 117, 125)",iconSecondary:"rgba(119, 117, 125, 0.6)",borderColor:"rgb(227, 226, 228)",dividerColor:"rgb(227, 226, 228)",placeholderColor:"rgb(192, 191, 193)",edgelessGridColor:"rgb(230, 230, 230)",successColor:"rgb(16, 203, 134)",warningColor:"rgb(235, 67, 53)",errorColor:"rgb(235, 67, 53)",processingColor:"rgb(39, 118, 255)",black10:"rgba(0, 0, 0, 0.1)",black30:"rgba(0, 0, 0, 0.3)",black50:"rgba(0, 0, 0, 0.5)",black60:"rgba(0, 0, 0, 0.6)",black80:"rgba(0, 0, 0, 0.8)",black90:"rgba(0, 0, 0, 0.9)",black:"rgb(0, 0, 0)",white10:"rgba(255, 255, 255, 0.1)",white30:"rgba(255, 255, 255, 0.3)",white50:"rgba(255, 255, 255, 0.5)",white60:"rgba(255, 255, 255, 0.6)",white80:"rgba(255, 255, 255, 0.8)",white90:"rgba(255, 255, 255, 0.9)",white:"rgb(255, 255, 255)",tagWhite:"rgba(245, 245, 245, 1)",tagGray:"rgba(227, 226, 224, 1)",tagRed:"rgba(255, 225, 225, 1)",tagOrange:"rgba(255, 233, 201, 1)",tagYellow:"rgba(255, 243, 215, 1)",tagGreen:"rgba(222, 244, 231, 1)",tagTeal:"rgba(222, 244, 243, 1)",tagBlue:"rgba(225, 238, 255, 1)",tagPurple:"rgba(243, 240, 255, 1)",tagPink:"rgba(251, 231, 255, 1)",tagMagenta:"rgba(249, 232, 255, 1)",tooltip:"rgba(0, 0, 0, 1)",menuShadow:"0px 0px 12px rgba(66, 65, 73, 0.14), inset 0px 0px 0px 0.5px rgba(227, 227, 228, 1)",activeShadow:"0px 0px 0px 2px rgba(30, 150, 235, 0.30)",shadow1:"0px 0px 4px 0px rgba(66, 65, 73, 0.14)",shadow2:"0px 0px 12px 0px rgba(66, 65, 73, 0.18)",shadow3:"0px 0px 20px 0px rgba(66, 65, 73, 0.22)",popoverShadow:"0px 0px 30px rgba(75, 75, 75, 0.2), 0px 0px 4px rgba(75, 75, 75, 0.3), inset 0px 0px 0px rgba(227, 226, 228, 1)",floatButtonShadow:"0px 0px 10px rgba(0, 0, 0, 0.05), 0px 0px 0px 0.5px rgba(0, 0, 0, 0.1)",floatButtonShadow1:"0px 4px 6px -3px rgba(66, 65, 73, 0.10), 0px 10px 12px -2px rgba(66, 65, 73, 0.10)",floatButtonShadow2:"0px 4px 4px -2px rgba(66, 65, 73, 0.10), 0px 6px 8px 1px rgba(66, 65, 73, 0.05)",kanbanShadow:"0px 2px 3px 0px rgba(0, 0, 0, 0.05)",cmdShadow:"0px 10px 80px 0px rgba(0, 0, 0, 0.20)",largeButtonEffect:"0px 12px 21px 4px rgba(30, 150, 235, 0.15)",noteShadowBox:"0px 2px 12px 0px rgba(66, 65, 73, 0.20), 0px 0px 4px 0px rgba(66, 65, 73, 0.20)",noteShadowSticker:"0px 24px 26px -10px rgba(66, 65, 73, 0.07), 0px 26px 18px -20px rgba(66, 65, 73, 0.22)",noteShadowPaper:"0px 0px 0px 10px #FFF, 0px 3px 6px 12px rgba(66, 65, 73, 0.16)",noteShadowFloat:"0px 12px 60px 0px rgba(66, 65, 73, 0.16), 0px 0px 0px 2px rgba(0, 0, 0, 0.06)",noteShadowFilm:"10px 10px 0px 6px #000, 0px 0px 0px 6px #000",buttonGrayColor:"rgba(245, 245, 245, 1)",cardBackgroundBlue:"linear-gradient(180deg, #F0F3FD 0%, #FCFCFD 100%)",cardBackgroundGreen:"linear-gradient(180deg, #F3F9FD 0%, #FCFCFD 100%)",cardBackgroundGrey:"linear-gradient(180deg, #F1F1F1 0%, #FCFCFD 100%)",windowsCloseButton:"#C42B1C",textHighlightPink:"rgba(255, 206, 206, 1)",textHighlightRed:"rgba(254, 213, 213, 1)",textHighlightOrange:"rgba(254, 223, 187, 1)",textHighlightYellow:"rgba(254, 243, 161, 1)",textHighlightGreen:"rgba(225, 250, 177, 1)",textHighlightTeal:"rgba(173, 248, 233, 1)",textHighlightBlue:"rgba(204, 226, 254, 1)",textHighlightPurple:"rgba(237, 221, 255, 1)",textHighlightGrey:"rgba(234, 236, 239, 1)",textHighlightForegroundRed:"rgba(198, 34, 34, 1)",textHighlightForegroundOrange:"rgba(211, 79, 11, 1)",textHighlightForegroundYellow:"rgba(182, 124, 4, 1)",textHighlightForegroundGreen:"rgba(20, 147, 67, 1)",textHighlightForegroundTeal:"rgba(7, 130, 160, 1)",textHighlightForegroundBlue:"rgba(33, 89, 211, 1)",textHighlightForegroundPurple:"rgba(132, 46, 211, 1)",textHighlightForegroundGrey:"rgba(68, 77, 89, 1)"},iQ={...vt,themeMode:"dark",brandColor:"#1E96EB",primaryColor:"#1C9EE4",primaryColor04:"rgba(52, 116, 173, 0.1)",secondaryColor:"rgb(144, 150, 245)",tertiaryColor:"rgb(30, 30, 30)",blue950:"rgba(32, 45, 55, 1)",blue50:"rgba(181, 208, 242, 1)",blue100:"rgba(171, 204, 237, 1)",blue200:"rgba(149, 194, 234, 1)",blue300:"rgba(115, 182, 226, 1)",blue400:"rgba(79, 162, 216, 1)",blue500:"rgba(53, 140, 208, 1)",blue600:"rgba(52, 116, 173, 1)",blue700:"rgba(55, 106, 154, 1)",blue800:"rgba(51, 88, 122, 1)",blue900:"rgba(47, 75, 96, 1)",hoverColor:"rgba(255, 255, 255, 0.1)",hoverColorFilled:"rgb(42, 42, 42)",iconColor:"rgb(168, 168, 160)",iconSecondary:"rgba(168,168,160,0.6)",borderColor:"rgba(46, 46, 46, 1)",dividerColor:"rgb(114, 114, 114)",placeholderColor:"rgb(62, 62, 63)",quoteColor:"rgba(142, 141, 145, 1)",listColor:"rgba(156, 155, 160, 1)",linkColor:"#78BEFF",edgelessGridColor:"rgba(49, 49, 49, 0.35)",successColor:"rgb(13, 162, 107)",warningColor:"rgb(188, 54, 42)",errorColor:"rgb(188, 54, 42)",processingColor:"rgb(31, 94, 204)",textEmphasisColor:"#1E96EB",textPrimaryColor:"rgb(234, 234, 234)",textSecondaryColor:"rgb(156, 156, 160)",textDisableColor:"rgb(119, 117, 125)",black10:"rgba(255, 255, 255, 0.1)",black30:"rgba(255, 255, 255, 0.3)",black50:"rgba(255, 255, 255, 0.5)",black60:"rgba(255, 255, 255, 0.6)",black80:"rgba(255, 255, 255, 0.8)",black90:"rgba(255, 255, 255, 0.9)",black:"rgb(255, 255, 255)",white10:"rgba(0, 0, 0, 0.1)",white30:"rgba(0, 0, 0, 0.3)",white50:"rgba(0, 0, 0, 0.5)",white60:"rgba(0, 0, 0, 0.6)",white80:"rgba(0, 0, 0, 0.8)",white90:"rgba(0, 0, 0, 0.9)",white:"rgb(0, 0, 0)",backgroundCodeBlock:"rgba(46, 44, 52, 1)",backgroundTertiaryColor:"rgb(48, 48, 48)",backgroundProcessingColor:"rgba(22, 32, 48, 1)",backgroundErrorColor:"rgba(46, 26, 24, 1)",backgroundWarningColor:"rgba(48, 35, 19, 1)",backgroundSuccessColor:"rgba(20, 42, 34, 1)",backgroundPrimaryColor:"rgb(20, 20, 20)",backgroundSecondaryColor:"rgba(37, 37, 37, 1)",backgroundModalColor:"rgba(0, 0, 0, 0.5)",backgroundOverlayPanelColor:"rgb(30, 30, 30)",tagBlue:"rgba(8, 67, 136, 1)",tagGreen:"rgba(44, 108, 63, 1)",tagTeal:"rgba(26, 115, 110, 1)",tagWhite:"rgba(67, 67, 67, 1)",tagPurple:"rgba(47, 30, 113, 1)",tagRed:"rgba(111, 50, 50, 1)",tagPink:"rgba(155, 106, 106, 1)",tagMagenta:"rgba(105, 47, 111, 1)",tagYellow:"rgba(150, 132, 49, 1)",tagOrange:"rgba(185, 129, 46, 1)",tagGray:"rgba(41, 41, 41, 1)",tooltip:"rgba(234, 234, 234, 1)",menuShadow:"0px 0px 16px rgba(0, 0, 0, 0.32), 0px 0px 0px 0.5px #2E2E2E inset",activeShadow:"0px 0px 0px 2px rgba(28, 158, 228, 0.30)",shadow1:"0px 0px 4px 0px rgba(0, 0, 0, 0.24)",shadow2:"0px 0px 12px 0px rgba(0, 0, 0, 0.28)",shadow3:"0px 0px 20px 0px rgba(0, 0, 0, 0.32)",popoverShadow:"0px 0px 30px 0px rgba(0, 0, 0, 0.1), 0px 0px 8px 0px rgba(0, 0, 0, 0.18), 0px 0px 0px 0.5px rgba(48, 48, 48, 1) inset",floatButtonShadow:"0px 0px 10px rgba(0, 0, 0, 0.05), 0px 0px 0px 0.5px rgba(0, 0, 0, 0.1)",floatButtonShadow1:"0px 4px 6px -3px rgba(0, 0, 0, 0.1), 0px 10px 12px -2px rgba(0, 0, 0, 0.1)",floatButtonShadow2:"0px 4px 4px -2px rgba(15, 15, 15, 0.1), 0px 6px 8px 1px rgba(15, 15, 15, 0.05)",kanbanShadow:"0px 2px 3px 0px rgba(0, 0, 0, 0.60)",cmdShadow:"0px 16px 80px 0px rgba(0, 0, 0, 0.80)",largeButtonEffect:"0px 12px 20px 4px rgba(28, 158, 228, 0.18)",noteShadowBox:"0px 2px 12px 0px rgba(0, 0, 0, 0.26), 0px 0px 4px 0px rgba(0, 0, 0, 0.44)",noteShadowSticker:"0px 24px 26px -10px rgba(0, 0, 0, 0.11), 0px 26px 18px -20px rgba(0, 0, 0, 0.32)",noteShadowPaper:"0px 0px 0px 10px rgba(255, 255, 255, 0.20), 0px 3px 6px 12px rgba(0, 0, 0, 0.22)",noteShadowFloat:"0px 12px 70px 0px rgba(0, 0, 0, 0.20), 0px 0px 0px 2px rgba(0, 0, 0, 0.10)",noteShadowFilm:"10px 10px 0px 6px #B2B2B2, 0px 0px 0px 6px #B2B2B2",buttonGrayColor:"rgba(85, 85, 85, 1)",cardBackgroundBlue:"linear-gradient(180deg, #14171F 0%, #202020 100%)",cardBackgroundGreen:"linear-gradient(180deg, #192023 0%, #202020 100%)",cardBackgroundGrey:"linear-gradient(180deg, #313131 0%, #202020 100%)",windowsCloseButton:"#C42B1C",textHighlightPink:"rgba(127, 93, 93, 1)",textHighlightRed:"rgba(108, 39, 39, 1)",textHighlightOrange:"rgba(112, 58, 21, 1)",textHighlightYellow:"rgba(106, 84, 15, 1)",textHighlightGreen:"rgba(26, 91, 50, 1)",textHighlightTeal:"rgba(14, 85, 97, 1)",textHighlightBlue:"rgba(56, 75, 122, 1)",textHighlightPurple:"rgba(80, 46, 111, 1)",textHighlightGrey:"rgba(64, 67, 74, 1)",textHighlightForegroundRed:"rgba(249, 141, 141, 1)",textHighlightForegroundOrange:"rgba(252, 168, 99, 1)",textHighlightForegroundYellow:"rgba(251, 214, 68, 1)",textHighlightForegroundGreen:"rgba(110, 229, 153, 1)",textHighlightForegroundTeal:"rgba(87, 221, 204, 1)",textHighlightForegroundBlue:"rgba(128, 183, 251, 1)",textHighlightForegroundPurple:"rgba(205, 157, 253, 1)",textHighlightForegroundGrey:"rgba(176, 181, 191, 1)"};Object.entries(nQ).reduce((t,[e,n])=>(t[`--affine-${bM(e)}`]=n,t),{});Object.entries(iQ).reduce((t,[e,n])=>(t[`--affine-${bM(e)}`]=n,t),{});let x6=null;const vM=t=>{const e=document.createElement("template");if(typeof t=="string")t=t.trim(),e.innerHTML=t;else{const n=String.raw(t.strings,...t.values);e.innerHTML=n}return e.content.firstChild},rQ=t=>{const n=b`<div
    class="toast-container blocksuite-overlay"
    style="${`
    position: fixed;
    z-index: 9999;
    top: 16px;
    left: 16px;
    right: 16px;
    bottom: 78px;
    pointer-events: none;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
  `}"
  ></div>`,i=vM(n),r=V1(t);return D(r),r.viewportElement.appendChild(i),i},kt=(t,e,n=2500)=>{x6||(x6=rQ(t));const i=`
    max-width: 480px;
    text-align: center;
    font-family: ${vt.fontSansFamily};
    font-size: var(--affine-font-sm);
    padding: 6px 12px;
    margin: 10px 0 0 0;
    color: var(--affine-white);
    background: var(--affine-tooltip);
    box-shadow: var(--affine-float-button-shadow);
    border-radius: 10px;
    transition: all 230ms cubic-bezier(0.21, 1.02, 0.73, 1);
    opacity: 0;
  `,r=b`<div style="${i}"></div>`,o=vM(r);o.textContent=e,x6.appendChild(o);const s=[{opacity:0},{opacity:1}],a={duration:230,easing:"cubic-bezier(0.21, 1.02, 0.73, 1)",fill:"forwards"};return o.animate(s,a),setTimeout(()=>{const l=s.reverse();o.animate(l,a).finished.then(()=>{o.style.maxHeight="0",o.style.margin="0",o.style.padding="0",o.addEventListener("transitionend",()=>{o.remove()},{once:!0})}).catch(console.error)},n),o},yM=X`
  .embed-card-modal-mask {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    margin: auto;
    z-index: 1;
  }

  .embed-card-modal-wrapper {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    margin: auto;
    z-index: 2;
    width: 480px;
    height: max-content;
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-menu-shadow);
    border-radius: var(--affine-popover-radius);
  }

  .embed-card-modal-title {
    display: flex;
    align-items: flex-end;
    gap: var(--1, 0px);
    align-self: stretch;
    padding: 20px 20px var(--1, 0px) 24px;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
    font-family: var(--affine-font-family);
    font-size: 18px;
    font-style: normal;
    font-weight: 600;
    line-height: 26px;
    user-select: none;
  }

  .embed-card-modal-content {
    display: flex;
    min-height: 80px;
    padding: 12px 24px;
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
    align-self: stretch;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .embed-card-modal-content-text {
    color: var(--affine-text-primary-color);
    font-family: var(--affine-font-family);
    font-size: 15px;
    font-style: normal;
    font-weight: 500;
    line-height: 24px;
  }

  .embed-card-modal-input {
    display: flex;
    padding: 4px 10px;
    align-items: center;
    gap: 8px;
    align-self: stretch;
    border-radius: 8px;
    border: 1px solid var(--affine-border-color);
    background: var(--affine-white-10);
    opacity: var(--add, 1);
    outline: none;
    resize: none;
    color: var(--affine-text-primary-color);
    font-family: var(--affine-font-family);
    font-size: 15px;
    font-style: normal;
    font-weight: 500;
    line-height: 24px;
    caret-color: var(--affine-brand-color);
    transition: border-color 150ms;
  }

  .embed-card-modal-input:focus {
    border-color: var(--affine-brand-color);
    box-shadow: 0px 0px 0px 2px rgba(30, 150, 235, 0.3);
  }

  .embed-card-modal-input::placeholder {
    color: var(--affine-placeholder-color);
    font-family: var(--affine-font-family);
    font-size: 15px;
    font-style: normal;
    font-weight: 500;
    line-height: 24px;
  }

  .embed-card-modal-input.description {
    height: 112px;
  }

  .embed-card-modal-action {
    display: flex;
    padding: 20px 24px;
    justify-content: flex-end;
    align-items: center;
    gap: 20px;
    align-self: stretch;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
    user-select: none;
  }

  .embed-card-modal-button {
    display: flex;
    padding: 4px 18px;
    justify-content: center;
    align-items: center;
    gap: 4px;
    border-radius: 8px;
    font-family: var(--affine-font-family);
    font-size: 12px;
    font-style: normal;
    font-weight: 500;
    line-height: 20px;
    opacity: var(--add, 1);
    cursor: pointer;
  }

  .embed-card-modal-button.cancel {
    border: 1px solid var(--affine-border-color);
    background: var(--affine-white-10);
    color: var(--affine-text-primary-color);
  }

  .embed-card-modal-button.save,
  .embed-card-modal-button.confirm {
    border: 1px solid var(--affine-black-10);
    background: var(--affine-primary-color);
    color: var(--affine-pure-white);
  }

  .embed-card-modal-button.save.disabled,
  .embed-card-modal-button.confirm.disabled {
    background: rgba(30, 150, 235, 0.4);
  }
`;var oQ=Object.defineProperty,sQ=Object.getOwnPropertyDescriptor,sl=(t,e,n,i)=>{for(var r=i>1?void 0:i?sQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&oQ(e,n,r),r};let qr=class extends me(De){constructor(){super(...arguments),this._linkInputValue="",this._onDocumentKeydown=t=>{t.stopPropagation(),t.key==="Enter"&&!t.isComposing&&this._onConfirm(),t.key==="Escape"&&this.remove()},this._onConfirm=()=>{const t=this.input.value;if(!To(t)){kt(this.host,"Invalid link");return}const e=this.host.spec.getService("affine:page");D(e);const n=e.getEmbedBlockOptions(t),{mode:i}=this.createOptions;if(i==="page"){const{parentModel:r,index:o}=this.createOptions;let s="affine:bookmark";n&&(s=n.flavour),this.host.page.addBlock(s,{url:t},r,o)}else if(i==="edgeless"){let r="affine:bookmark",o="vertical";n&&(r=n.flavour,o=n.styles[0]);const s=V1(this.host);D(s);const a=s.surface,l=te.toVec(a.renderer.center);s.service.addBlock(r,{url:t,xywh:ne.fromCenter(l,At[o],bt[o]).serialize(),style:o},a.model),s.tools.setEdgelessTool({type:"default"})}this.onConfirm(),this.remove()},this._onCancel=()=>{this.remove()}}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>{requestAnimationFrame(()=>{this.input.focus()})}).catch(console.error),this.disposables.addFromEvent(this,"keydown",this._onDocumentKeydown)}_handleInput(t){const e=t.target;this._linkInputValue=e.value}render(){return b`<div class="embed-card-modal blocksuite-overlay">
      <div class="embed-card-modal-mask" @click=${this._onCancel}></div>
      <div class="embed-card-modal-wrapper">
        <div class="embed-card-modal-title">${this.titleText}</div>

        <div class="embed-card-modal-content">
          <div class="embed-card-modal-content-text">
            ${this.descriptionText}
          </div>

          <input
            class="embed-card-modal-input link"
            tabindex="0"
            type="text"
            placeholder="Input in https://..."
            value=${this._linkInputValue}
            @input=${this._handleInput}
          />
        </div>

        <div class="embed-card-modal-action">
          <div
            class="embed-card-modal-button cancel"
            tabindex="0"
            @click=${()=>this.remove()}
          >
            Cancel
          </div>

          <div
            class=${Qe({"embed-card-modal-button":!0,confirm:!0,disabled:!To(this._linkInputValue)})}
            tabindex="0"
            @click=${this._onConfirm}
          >
            Confirm
          </div>
        </div>
      </div>
    </div>`}};qr.styles=yM;sl([L({attribute:!1})],qr.prototype,"host",2);sl([L({attribute:!1})],qr.prototype,"titleText",2);sl([L({attribute:!1})],qr.prototype,"descriptionText",2);sl([L({attribute:!1})],qr.prototype,"createOptions",2);sl([L({attribute:!1})],qr.prototype,"onConfirm",2);sl([he("input")],qr.prototype,"input",2);sl([ie()],qr.prototype,"_linkInputValue",2);qr=sl([W("embed-card-create-modal")],qr);async function yo(t,e,n,i){t.selection.clear();const r=new qr;return r.host=t,r.titleText=e,r.descriptionText=n,r.createOptions=i,document.body.appendChild(r),new Promise(o=>{r.onConfirm=()=>o()})}var aQ=Object.defineProperty,lQ=Object.getOwnPropertyDescriptor,tu=(t,e,n,i)=>{for(var r=i>1?void 0:i?lQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&aQ(e,n,r),r};let Ls=class extends me(De){constructor(){super(...arguments),this._titleInputValue=""}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>{this.titleInput.focus(),this.titleInput.setSelectionRange(0,this.titleInput.value.length)}).catch(console.error),this.disposables.addFromEvent(this,"keydown",this._onDocumentKeydown),this._titleInputValue=this.model.title??""}_handleInput(t){const e=t.target;this._titleInputValue=e.value}_onDocumentKeydown(t){t.stopPropagation(),t.key==="Enter"&&!t.isComposing&&this._onSave(),t.key==="Escape"&&this.remove()}_onSave(){const t=this.titleInput.value;if(t.length===0){kt(this.host,"Link title can not be empty");return}this.model.page.updateBlock(this.model,{title:t,description:this.descInput.value}),this.remove()}render(){return b`
      <div class="embed-card-modal blocksuite-overlay">
        <div class="embed-card-modal-mask" @click=${()=>this.remove()}></div>
        <div class="embed-card-modal-wrapper">
          <div class="embed-card-modal-title">Edit Link</div>

          <div class="embed-card-modal-content">
            <input
              class="embed-card-modal-input title"
              type="text"
              placeholder="Title"
              value=${this._titleInputValue}
              @input=${this._handleInput}
              tabindex="0"
            />

            <textarea
              class="embed-card-modal-input description"
              placeholder="Description"
              .value=${this.model.description??""}
              tabindex="0"
            ></textarea>
          </div>

          <div class="embed-card-modal-action">
            <div
              class="embed-card-modal-button cancel"
              tabindex="0"
              @click=${()=>this.remove()}
            >
              Cancel
            </div>

            <div
              class=${Qe({"embed-card-modal-button":!0,save:!0,disabled:this._titleInputValue.length===0})}
              tabindex="0"
              @click=${()=>this._onSave()}
            >
              Save
            </div>
          </div>
        </div>
      </div>
    `}};Ls.styles=yM;tu([L({attribute:!1})],Ls.prototype,"model",2);tu([L({attribute:!1})],Ls.prototype,"host",2);tu([he(".title")],Ls.prototype,"titleInput",2);tu([he(".description")],Ls.prototype,"descInput",2);tu([ie()],Ls.prototype,"_titleInputValue",2);Ls=tu([W("embed-card-edit-modal")],Ls);function wM(t,e){t.selection.clear();const n=new Ls;n.model=e,n.host=t,document.body.appendChild(n)}const cQ=X`
  .affine-embed-figma-block {
    margin: 0 auto;
    box-sizing: border-box;
    width: 100%;
    max-width: ${At.figma}px;
    height: ${bt.figma}px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 12px;

    border-radius: 8px;
    border: 1px solid var(--affine-background-tertiary-color);

    opacity: var(--add, 1);
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-1);
    user-select: none;
  }

  .affine-embed-figma {
    width: 100%;
    height: 100%;
    opacity: var(--add, 1);
  }

  .affine-embed-figma img,
  .affine-embed-figma object,
  .affine-embed-figma svg {
    width: 100%;
    height: 100%;
    object-fit: fill;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-embed-figma-iframe-container {
    position: relative;
  }

  .affine-embed-figma-iframe-container > iframe {
    width: 100%;
    height: 410px;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
    border: none;
  }

  .affine-embed-figma-iframe-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .affine-embed-figma-iframe-overlay.hide {
    display: none;
  }

  .affine-embed-figma-content {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-figma-content-header {
    display: flex;
    flex-direction: row;
    gap: 8px;
    align-items: center;

    align-self: stretch;
    padding: var(--1, 0px);
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-figma-content-title-icon {
    display: flex;
    width: 20px;
    height: 20px;
    justify-content: center;
    align-items: center;
  }

  .affine-embed-figma-content-title-icon img,
  .affine-embed-figma-content-title-icon object,
  .affine-embed-figma-content-title-icon svg {
    width: 20px;
    height: 20px;
    fill: var(--affine-background-primary-color);
  }

  .affine-embed-figma-content-title-text {
    flex: 1 0 0;

    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    font-style: normal;
    font-weight: 600;
    line-height: 22px;
  }

  .affine-embed-figma-content-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;

    flex: 1 0 0;
    align-self: stretch;

    word-break: break-word;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-figma-content-url {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 4px;
    width: max-content;
    max-width: 100%;
    cursor: pointer;
  }
  .affine-embed-figma-content-url > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-all;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-secondary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }
  .affine-embed-figma-content-url:hover > span {
    color: var(--affine-link-color);
  }
  .affine-embed-figma-content-url:hover .open-icon {
    fill: var(--affine-link-color);
  }

  .affine-embed-figma-content-url-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 12px;
    height: 12px;
  }
  .affine-embed-figma-content-url-icon .open-icon {
    height: 12px;
    width: 12px;
    fill: var(--affine-text-secondary-color);
  }

  .affine-embed-figma-block.selected {
    .affine-embed-figma-content-url > span {
      color: var(--affine-link-color);
    }
    .affine-embed-figma-content-url .open-icon {
      fill: var(--affine-link-color);
    }
  }
`,Sb=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M7.66898 17.9165C9.00426 17.9165 10.088 16.7342 10.088 15.2776V12.6387H7.66898C6.3337 12.6387 5.25 13.8209 5.25 15.2776C5.25 16.7342 6.3337 17.9165 7.66898 17.9165Z"
    fill="#0ACF83"
  />
  <path
    d="M5.25 10.0002C5.25 8.54355 6.3337 7.36133 7.66898 7.36133H10.088V12.6391H7.66898C6.3337 12.6391 5.25 11.4569 5.25 10.0002Z"
    fill="#A259FF"
  />
  <path
    d="M5.25 4.72238C5.25 3.26572 6.3337 2.0835 7.66898 2.0835H10.088V7.36127H7.66898C6.3337 7.36127 5.25 6.17905 5.25 4.72238Z"
    fill="#F24E1E"
  />
  <path
    d="M10.0879 2.0835H12.5069C13.8421 2.0835 14.9259 3.26572 14.9259 4.72238C14.9259 6.17905 13.8421 7.36127 12.5069 7.36127H10.0879V2.0835Z"
    fill="#FF7262"
  />
  <path
    d="M14.9259 10.0002C14.9259 11.4569 13.8421 12.6391 12.5069 12.6391C11.1716 12.6391 10.0879 11.4569 10.0879 10.0002C10.0879 8.54355 11.1716 7.36133 12.5069 7.36133C13.8421 7.36133 14.9259 8.54355 14.9259 10.0002Z"
    fill="#1ABCFE"
  />
</svg>`,dQ=X`
  .affine-embed-github-block {
    margin: 0 auto;
    box-sizing: border-box;
    display: flex;
    width: 100%;
    max-width: ${At.horizontal}px;
    height: ${bt.horizontal}px;

    border-radius: 8px;
    border: 1px solid var(--affine-background-tertiary-color);

    opacity: var(--add, 1);
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-1);
    user-select: none;
  }

  .affine-embed-github-content {
    width: 536px;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-self: stretch;
    gap: 4px;
    padding: 12px;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-github-content-title {
    display: flex;
    flex-direction: row;
    gap: 8px;
    align-items: center;

    align-self: stretch;
    padding: var(--1, 0px);
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-github-content-title-icons {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
  }

  .affine-embed-github-content-title-icons img,
  .affine-embed-github-content-title-icons object,
  .affine-embed-github-content-title-icons svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-background-primary-color);
  }

  .affine-embed-github-content-title-site-icon {
    display: flex;
    width: 16px;
    height: 16px;
    justify-content: center;
    align-items: center;
  }

  .affine-embed-github-content-title-status-icon {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 3px 6px;
    border-radius: 20px;

    color: var(--affine-pure-white);
    leading-trim: both;

    text-edge: cap;
    font-feature-settings:
      'clig' off,
      'liga' off;
    text-transform: capitalize;
    font-family: var(--affine-font-family);
    font-size: 12px;
    font-style: normal;
    font-weight: 500;
    line-height: 16px;
  }
  .affine-embed-github-content-title-status-icon.issue.open {
    background: #238636;
  }
  .affine-embed-github-content-title-status-icon.issue.closed.success {
    background: #8957e5;
  }
  .affine-embed-github-content-title-status-icon.issue.closed.failure {
    background: #6e7681;
  }
  .affine-embed-github-content-title-status-icon.pr.open {
    background: #238636;
  }
  .affine-embed-github-content-title-status-icon.pr.draft {
    background: #6e7681;
  }
  .affine-embed-github-content-title-status-icon.pr.merged {
    background: #8957e5;
  }
  .affine-embed-github-content-title-status-icon.pr.closed {
    background: #c03737;
  }

  .affine-embed-github-content-title-status-icon > svg {
    height: 16px;
    width: 16px;
    padding: 2px;
  }

  .affine-embed-github-content-title-status-icon > span {
    padding: 0px 1.5px;
  }

  .affine-embed-github-content-title-text {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    font-style: normal;
    font-weight: 600;
    line-height: 22px;
  }

  .affine-embed-github-content-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;

    flex-grow: 1;

    word-break: break-word;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-github-content-assignees {
    display: none;
  }

  .affine-embed-github-content-url {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 4px;
    width: max-content;
    max-width: 100%;
    cursor: pointer;
  }
  .affine-embed-github-content-url > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-all;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-secondary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }
  .affine-embed-github-content-url:hover > span {
    color: var(--affine-link-color);
  }
  .affine-embed-github-content-url:hover .open-icon {
    fill: var(--affine-link-color);
  }

  .affine-embed-github-content-url-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 12px;
    height: 12px;
  }
  .affine-embed-github-content-url-icon .open-icon {
    height: 12px;
    width: 12px;
    fill: var(--affine-text-secondary-color);
  }

  .affine-embed-github-banner {
    margin: 12px 12px 0px 0px;
    width: 204px;
    height: 102px;
    max-width: 100%;
    opacity: var(--add, 1);
  }

  .affine-embed-github-banner img,
  .affine-embed-github-banner object,
  .affine-embed-github-banner svg {
    width: 204px;
    max-width: 100%;
    height: 102px;
    object-fit: fill;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-embed-github-block.loading {
    .affine-embed-github-content-title-text {
      color: var(--affine-placeholder-color);
    }
  }

  .affine-embed-github-block.selected {
    .affine-embed-github-content-url > span {
      color: var(--affine-link-color);
    }
    .affine-embed-github-content-url .open-icon {
      fill: var(--affine-link-color);
    }
  }

  .affine-embed-github-block.list {
    height: ${bt.list}px;

    .affine-embed-github-content {
      width: 100%;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }

    .affine-embed-github-content-title {
      width: 660px;
    }

    .affine-embed-github-content-repo {
      display: none;
    }

    .affine-embed-github-content-date {
      display: none;
    }

    .affine-embed-github-content-url {
      width: 90px;
      justify-content: flex-end;
    }

    .affine-embed-github-content-description {
      display: none;
    }

    .affine-embed-github-banner {
      display: none;
    }
  }

  .affine-embed-github-block.vertical {
    width: ${At.vertical}px;
    height: ${bt.vertical}px;
    flex-direction: column-reverse;

    .affine-embed-github-content {
      width: 100%;
    }

    .affine-embed-github-content-description {
      -webkit-line-clamp: 6;
    }

    .affine-embed-github-content-assignees {
      display: flex;
      padding: var(--1, 0px);
      align-items: center;
      justify-content: flex-start;
      gap: 2px;
      align-self: stretch;
    }

    .affine-embed-github-content-assignees-text {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;

      font-family: var(--affine-font-family);
      font-size: var(--affine-font-xs);
      font-style: normal;
      font-weight: 600;
      line-height: 20px;
    }

    .affine-embed-github-content-assignees-text.label {
      width: 72px;
      color: var(--affine-text-primary-color);
      font-weight: 600;
    }

    .affine-embed-github-content-assignees-text.users {
      width: calc(100% - 72px);
      word-break: break-all;
      white-space: normal;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 400;
    }

    .affine-embed-github-content-assignees-text-users.user {
      color: var(--affine-link-color);
      cursor: pointer;
    }

    .affine-embed-github-content-assignees-text-users.placeholder {
      color: var(--affine-placeholder-color);
    }

    .affine-embed-github-banner {
      width: 340px;
      height: 170px;
      margin-left: 12px;
    }

    .affine-embed-github-banner img,
    .affine-embed-github-banner object,
    .affine-embed-github-banner svg {
      width: 340px;
      height: 170px;
    }
  }

  .affine-embed-github-block.cube {
    width: ${At.cube}px;
    height: ${bt.cube}px;

    .affine-embed-github-content {
      width: 100%;
      flex-direction: column;
      align-items: flex-start;
      justify-content: space-between;
    }

    .affine-embed-github-content-title {
      flex-direction: column;
      gap: 4px;
      align-items: flex-start;
    }

    .affine-embed-github-content-title-text {
      -webkit-line-clamp: 2;
    }

    .affine-embed-github-content-description {
      display: none;
    }

    .affine-embed-github-banner {
      display: none;
    }

    .affine-embed-github-content-repo {
      display: none;
    }

    .affine-embed-github-content-date {
      display: none;
    }
  }
`,Tb=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.00016 1.33334C4.31683 1.33334 1.3335 4.39214 1.3335 8.16864C1.3335 11.1933 3.24183 13.7479 5.89183 14.6536C6.22516 14.7134 6.35016 14.5084 6.35016 14.3289C6.35016 14.1666 6.34183 13.6283 6.34183 13.0559C4.66683 13.372 4.2335 12.6372 4.10016 12.2527C4.02516 12.0562 3.70016 11.4496 3.41683 11.2872C3.1835 11.1591 2.85016 10.8429 3.4085 10.8344C3.9335 10.8259 4.3085 11.33 4.4335 11.535C5.0335 12.5689 5.99183 12.2784 6.37516 12.0989C6.4335 11.6546 6.6085 11.3556 6.80016 11.1847C5.31683 11.0138 3.76683 10.4243 3.76683 7.80978C3.76683 7.06644 4.02516 6.45127 4.45016 5.9728C4.3835 5.80192 4.15016 5.1013 4.51683 4.16145C4.51683 4.16145 5.07516 3.98202 6.35016 4.86206C6.8835 4.70827 7.45016 4.63137 8.01683 4.63137C8.5835 4.63137 9.15016 4.70827 9.6835 4.86206C10.9585 3.97348 11.5168 4.16145 11.5168 4.16145C11.8835 5.1013 11.6502 5.80192 11.5835 5.9728C12.0085 6.45127 12.2668 7.0579 12.2668 7.80978C12.2668 10.4328 10.7085 11.0138 9.22516 11.1847C9.46683 11.3983 9.67516 11.8084 9.67516 12.4492C9.67516 13.3635 9.66683 14.0983 9.66683 14.3289C9.66683 14.5084 9.79183 14.722 10.1252 14.6536C11.4486 14.1955 12.5986 13.3234 13.4133 12.1601C14.228 10.9968 14.6664 9.60079 14.6668 8.16864C14.6668 4.39214 11.6835 1.33334 8.00016 1.33334Z"
    fill="black"
  />
</svg> `,uQ=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
  <path
    d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"
  ></path>
</svg>`,hQ=b`<svg
  aria-hidden="true"
  height="16"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  data-view-component="true"
  class="octicon octicon-issue-closed flex-items-center mr-1"
>
  <path
    d="M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z"
  ></path>
  <path
    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z"
  ></path>
</svg>`,pQ=b`<svg
  aria-hidden="true"
  height="16"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  data-view-component="true"
  class="octicon octicon-skip flex-items-center mr-1"
>
  <path
    d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm9.78-2.22-5.5 5.5a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l5.5-5.5a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"
  ></path>
</svg>`,fQ=b`<svg
  height="16"
  class="octicon octicon-git-pull-request"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  aria-hidden="true"
>
  <path
    d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"
  ></path>
</svg>`,gQ=b`<svg
  height="16"
  class="octicon octicon-git-pull-request-draft"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  aria-hidden="true"
>
  <path
    d="M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 14a2.25 2.25 0 1 1 0-4.5 2.25 2.25 0 0 1 0 4.5ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM14 7.5a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Zm0-4.25a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Z"
  ></path>
</svg>`,mQ=b`<svg
  height="16"
  class="octicon octicon-git-merge"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  aria-hidden="true"
>
  <path
    d="M5.45 5.154A4.25 4.25 0 0 0 9.25 7.5h1.378a2.251 2.251 0 1 1 0 1.5H9.25A5.734 5.734 0 0 1 5 7.123v3.505a2.25 2.25 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.95-.218ZM4.25 13.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm8.5-4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM5 3.25a.75.75 0 1 0 0 .005V3.25Z"
  ></path>
</svg>`,bQ=b`<svg
  height="16"
  class="octicon octicon-git-pull-request-closed"
  viewBox="0 0 16 16"
  version="1.1"
  width="16"
  aria-hidden="true"
>
  <path
    d="M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 5.5a.75.75 0 0 1 .75.75v3.378a2.251 2.251 0 1 1-1.5 0V7.25a.75.75 0 0 1 .75-.75Zm-2.03-5.273a.75.75 0 0 1 1.06 0l.97.97.97-.97a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.97.97.97.97a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-.97-.97-.97.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l.97-.97-.97-.97a.75.75 0 0 1 0-1.06ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"
  ></path>
</svg>`,vQ=X`
  .affine-embed-youtube-block {
    margin: 0 auto;
    box-sizing: border-box;
    width: 100%;
    max-width: ${At.video}px;
    height: ${bt.video}px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 12px;

    border-radius: 8px;
    border: 1px solid var(--affine-background-tertiary-color);

    opacity: var(--add, 1);
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-1);
    user-select: none;
  }

  .affine-embed-youtube-video {
    width: 100%;
    height: 100%;
    opacity: var(--add, 1);
  }

  .affine-embed-youtube-video img,
  .affine-embed-youtube-video object,
  .affine-embed-youtube-video svg {
    width: 100%;
    height: 100%;
    object-fit: fill;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-embed-youtube-video-iframe-container {
    position: relative;
  }

  .affine-embed-youtube-video-iframe-container > iframe {
    width: 100%;
    height: 410px;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-embed-youtube-video-iframe-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .affine-embed-youtube-video-iframe-overlay.hide {
    display: none;
  }

  .affine-embed-youtube-content {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-youtube-content-header {
    display: flex;
    flex-direction: row;
    gap: 8px;
    align-items: center;

    align-self: stretch;
    padding: var(--1, 0px);
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-youtube-content-title-icon {
    display: flex;
    width: 20px;
    height: 20px;
    justify-content: center;
    align-items: center;
  }

  .affine-embed-youtube-content-title-icon img,
  .affine-embed-youtube-content-title-icon object,
  .affine-embed-youtube-content-title-icon svg {
    width: 20px;
    height: 20px;
    fill: var(--affine-background-primary-color);
  }

  .affine-embed-youtube-content-title-text {
    flex: 1 0 0;

    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    font-style: normal;
    font-weight: 600;
    line-height: 22px;
  }

  .affine-embed-youtube-content-creator-image {
    display: flex;
    width: 16px;
    height: 16px;
    flex-direction: column;
    align-items: flex-start;
  }

  .affine-embed-youtube-content-creator-image img,
  .affine-embed-youtube-content-creator-image object,
  .affine-embed-youtube-content-creator-image svg {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    fill: var(--affine-background-primary-color);
  }

  .affine-embed-youtube-content-creator-text {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    color: var(--affine-text-primary-color);
    text-align: justify;
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-youtube-content-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;

    flex: 1 0 0;
    align-self: stretch;

    word-break: break-word;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-youtube-content-url {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 4px;
    width: max-content;
    max-width: 100%;
    cursor: pointer;
  }
  .affine-embed-youtube-content-url > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-all;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-secondary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }
  .affine-embed-youtube-content-url:hover > span {
    color: var(--affine-link-color);
  }
  .affine-embed-youtube-content-url:hover .open-icon {
    fill: var(--affine-link-color);
  }

  .affine-embed-youtube-content-url-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 12px;
    height: 12px;
  }
  .affine-embed-youtube-content-url-icon .open-icon {
    height: 12px;
    width: 12px;
    fill: var(--affine-text-secondary-color);
  }

  .affine-embed-youtube-block.loading {
    .affine-embed-youtube-content-title-text {
      color: var(--affine-placeholder-color);
    }
  }

  .affine-embed-youtube-block.selected {
    .affine-embed-youtube-content-url > span {
      color: var(--affine-link-color);
    }
    .affine-embed-youtube-content-url .open-icon {
      fill: var(--affine-link-color);
    }
  }
`,Ib=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M17.5672 5.99344C17.4763 5.64032 17.2992 5.3184 17.0533 5.05972C16.8075 4.80104 16.5015 4.61464 16.1659 4.51907C14.9372 4.1665 9.99202 4.1665 9.99202 4.1665C9.99202 4.1665 5.04662 4.17718 3.81791 4.52974C3.48228 4.62532 3.1763 4.81173 2.93045 5.07042C2.6846 5.32911 2.50744 5.65105 2.41664 6.00417C2.04498 8.30113 1.90081 11.8012 2.42684 14.0062C2.51766 14.3594 2.69482 14.6813 2.94067 14.94C3.18652 15.1986 3.49249 15.385 3.82811 15.4806C5.05683 15.8332 10.0021 15.8332 10.0021 15.8332C10.0021 15.8332 14.9473 15.8332 16.176 15.4806C16.5116 15.385 16.8176 15.1986 17.0635 14.94C17.3093 14.6813 17.4865 14.3594 17.5773 14.0062C17.9693 11.706 18.0901 8.20821 17.5672 5.9935V5.99344Z"
    fill="#FF0000"
  />
  <path d="M8.33325 12.5L12.4999 10L8.33325 7.5V12.5Z" fill="white" />
</svg>`,i_=200,r_=70,yQ=24,wQ=24,xM=[{flavour:"affine:paragraph",type:"text",name:"Text",description:"Start typing with plain text.",icon:h0,tooltip:"Drag/Click to insert Text block"},{flavour:"affine:paragraph",type:"h1",name:"Heading 1",description:"Headings in the largest font.",icon:W9,tooltip:"Drag/Click to insert Heading 1"},{flavour:"affine:paragraph",type:"h2",name:"Heading 2",description:"Headings in the 2nd font size.",icon:q9,tooltip:"Drag/Click to insert Heading 2"},{flavour:"affine:paragraph",type:"h3",name:"Heading 3",description:"Headings in the 3rd font size.",icon:Y9,tooltip:"Drag/Click to insert Heading 3"},{flavour:"affine:paragraph",type:"h4",name:"Heading 4",description:"Heading in the 4th font size.",icon:X9,tooltip:"Drag/Click to insert Heading 4"},{flavour:"affine:paragraph",type:"h5",name:"Heading 5",description:"Heading in the 5th font size.",icon:K9,tooltip:"Drag/Click to insert Heading 5"},{flavour:"affine:paragraph",type:"h6",name:"Heading 6",description:"Heading in the 6th font size.",icon:Q9,tooltip:"Drag/Click to insert Heading 6"},{flavour:"affine:code",type:null,name:"Code Block",description:"Capture a code snippet.",icon:sb,tooltip:"Drag/Click to insert Code Block"},{flavour:"affine:paragraph",type:"quote",name:"Quote",description:"Capture a quote.",icon:ab,tooltip:"Drag/Click to insert Quote"},{flavour:"affine:divider",type:null,name:"Divider",description:"A visual divider.",icon:lb,tooltip:"A visual divider"}],_M=[{flavour:"affine:list",type:"bulleted",name:"Bulleted List",description:"A simple bulleted list.",icon:J9,tooltip:"Drag/Click to insert Bulleted List"},{flavour:"affine:list",type:"numbered",name:"Numbered List",description:"A list with numbering.",icon:eb,tooltip:"Drag/Click to insert Numbered List"},{flavour:"affine:list",type:"todo",name:"To-do List",description:"Track tasks with a to-do list.",icon:ob,tooltip:"Drag/Click to insert To-do List"}],xQ=[{flavour:"affine:image",type:"image",name:"Image",description:"Upload images.",icon:iI,tooltip:"Drag/Click to insert Image"},{flavour:"affine:bookmark",type:"bookmark",name:"Bookmark",description:"Insert a link in card view.",icon:Yo,tooltip:"Drag/Click to insert Bookmark"}],_Q=xM.concat(_M).filter(t=>t.name!=="Divider").map(t=>({icon:t.icon,tooltip:t.type!=="text"?t.tooltip.replace("Drag/Click to insert ",""):"Text",childFlavour:t.flavour,childType:t.type})),CQ=442;var kQ=Object.defineProperty,EQ=Object.getOwnPropertyDescriptor,nu=(t,e,n,i)=>{for(var r=i>1?void 0:i?EQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&kQ(e,n,r),r};let Ta=class extends me(Ae){render(){if(this.edgeless.edgelessTool.type!=="affine:note")return ae;const{childType:t}=this;return b`
      <edgeless-slide-menu .menuWidth=${CQ}>
        <div class="menu-content">
          <div class="button-group-label">Blocks</div>
          <div class="button-group-container">
            ${_Q.map(e=>b`
                <edgeless-tool-icon-button
                  .active=${t===e.childType}
                  .activeMode=${"background"}
                  .iconContainerPadding=${2}
                  .tooltip=${e.tooltip}
                  @click=${()=>this.onChange({childFlavour:e.childFlavour,childType:e.childType,tip:e.tooltip})}
                >
                  ${e.icon}
                </edgeless-tool-icon-button>
              `)}
            <edgeless-tool-icon-button
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              .tooltip=${"Links"}
              @click=${()=>yo(this.edgeless.host,"Links","The added link will be displayed as a card view.",{mode:"edgeless"})}
            >
              ${Yo}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              .tooltip=${"YouTube"}
              @click=${()=>yo(this.edgeless.host,"YouTube","The added YouTube video link will be displayed as an embed view.",{mode:"edgeless"})}
            >
              ${Ib}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              .tooltip=${"Figma"}
              @click=${()=>yo(this.edgeless.host,"Figma","The added Figma link will be displayed as an embed view.",{mode:"edgeless"})}
            >
              ${Sb}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              .tooltip=${"GitHub"}
              @click=${()=>yo(this.edgeless.host,"GitHub","The added GitHub issue or pull request link will be displayed as a card view.",{mode:"edgeless"})}
            >
              ${Tb}
            </edgeless-tool-icon-button>
          </div>
        </div>
      </edgeless-slide-menu>
    `}};Ta.styles=X`
    :host {
      position: absolute;
      display: flex;
      z-index: -1;
    }
    .menu-content {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .button-group-label {
      font-family: 'Inter';
      font-size: 12px;
      font-weight: 400;
      font-style: normal;
      display: flex;
      text-align: center;
      color: var(--light-text-color-text-secondary-color, #8e8d91);
      width: 38px;
      height: 20px;
      line-height: 20px;
      margin-right: 16px;
    }
    .button-group-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 14px;
      fill: var(--affine-icon-color);
    }
  `;nu([L({attribute:!1})],Ta.prototype,"edgeless",2);nu([L({attribute:!1})],Ta.prototype,"childFlavour",2);nu([L({attribute:!1})],Ta.prototype,"childType",2);nu([L({attribute:!1})],Ta.prototype,"tip",2);nu([L({attribute:!1})],Ta.prototype,"onChange",2);Ta=nu([W("edgeless-note-menu")],Ta);var SQ=Object.defineProperty,TQ=Object.getOwnPropertyDescriptor,iu=(t,e,n,i)=>{for(var r=i>1?void 0:i?TQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&SQ(e,n,r),r};let Ia=class extends me(Ae){constructor(){super(...arguments),this.active=!1,this.childFlavour="affine:paragraph",this.childType="text",this.tip="Text",this._noteMenu=null,this._states=["childFlavour","childType","tip"]}_toggleNoteMenu(){this._noteMenu?(this._disposeMenu(),this.requestUpdate()):(this.edgeless.tools.setEdgelessTool({type:"affine:note",childFlavour:this.childFlavour,childType:this.childType,tip:this.tip}),this._noteMenu=Jd("edgeless-note-menu",this,{x:110,y:-40}),this._noteMenu.element.edgeless=this.edgeless,this._noteMenu.element.childFlavour=this.childFlavour,this._noteMenu.element.childType=this.childType,this._noteMenu.element.tip=this.tip,this._noteMenu.element.onChange=t=>{this._states.forEach(e=>{t[e]!=null&&Object.assign(this,{[e]:t[e]})}),this.edgeless.slots.edgelessToolUpdated.emit({type:"affine:note",childFlavour:this.childFlavour,childType:this.childType,tip:this.tip})})}_disposeMenu(){this._noteMenu?.dispose(),this._noteMenu=null}connectedCallback(){super.connectedCallback(),this._disposables.add(this.edgeless.slots.edgelessToolUpdated.on(t=>{t.type!=="affine:note"&&this._disposeMenu()}))}disconnectedCallback(){this._disposeMenu(),super.disconnectedCallback()}render(){const{active:t}=this,e=t?"currentColor":"#77757D";return b`
      <edgeless-tool-icon-button
        class="edgeless-note-button"
        .tooltip=${this._noteMenu?"":yr("Note","N")}
        .tooltipOffset=${17}
        .active=${t}
        .iconContainerPadding=${8}
        @click=${()=>{this._toggleNoteMenu()}}
      >
        ${u3}
        <span class="arrow-up-icon" style=${we({color:e})}>
          ${u0}
        </span>
      </edgeless-tool-icon-button>
    `}};Ia.styles=X`
    :host {
      display: flex;
    }

    .arrow-up-icon {
      position: absolute;
      top: 4px;
      right: 2px;
      font-size: 0;
    }
  `;iu([L({attribute:!1})],Ia.prototype,"edgeless",2);iu([L({attribute:!1})],Ia.prototype,"active",2);iu([ie()],Ia.prototype,"childFlavour",2);iu([ie()],Ia.prototype,"childType",2);iu([ie()],Ia.prototype,"tip",2);Ia=iu([W("edgeless-note-tool-button")],Ia);var IQ=Object.defineProperty,LQ=Object.getOwnPropertyDescriptor,Ac=(t,e,n,i)=>{for(var r=i>1?void 0:i?LQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&IQ(e,n,r),r};let Ms=class extends me(Ae){constructor(){super(...arguments),this._curIndex=-1}firstUpdated(){this._bindEvent()}_bindEvent(){const{_disposables:t}=this;t.addFromEvent(this._container,"wheel",e=>{e.stopPropagation()}),t.addFromEvent(this._container,"pointerdown",e=>{const i=e.target.closest(".draggable");if(!i)return;const r=this._clone,o=this._indicatorLine;r.style.visibility="visible";const s=i.getBoundingClientRect(),a=Number(i.getAttribute("index"));this._curIndex=a;let l=-1;const c=this._container.getBoundingClientRect(),d=c.top+8,u=c.bottom,h=e.clientX-s.left,p=e.clientY-s.top;function g(v,m){r.style.left=v-c.left-h+"px",r.style.top=m-c.top-p+"px"}function f(v){return v.clientY>=d&&v.clientY<=u}g(e.clientX,e.clientY),this._disposables.addFromEvent(document,"pointermove",v=>{if(o.style.visibility="visible",g(v.clientX,v.clientY),f(v)){const m=v.pageY+this._container.scrollTop-d;let y=0;m<s.height/2?(l=0,y=4):(l=Math.ceil((m-s.height/2)/(s.height+10)),y=8+l*s.height+(l-.5)*10),o.style.top=y-this._container.scrollTop+"px";return}l=-1}),this._disposables.addFromEvent(document,"pointerup",()=>{if(r.style.visibility="hidden",o.style.visibility="hidden",l>=0&&l<=this.frames.length&&l!==a&&l!==a+1){const v=this.frames[l-1]?.index||null,m=this.frames[l]?.index||null,y=this.frames[a];this.edgeless.service.updateElement(y.id,{index:ds(v,m)}),this.edgeless.page.captureSync(),this.requestUpdate()}this._disposables.dispose(),this._disposables=new dt,this._bindEvent()})})}render(){const t=this.frames[this._curIndex];return b`
      <div
        class="edgeelss-frame-order-items-container"
        @click=${e=>e.stopPropagation()}
      >
        ${Fe(this.frames,e=>e.id,(e,n)=>b`
            <div class="item draggable" id=${e.id} index=${n}>
              <div class="drag-indicator"></div>
              <div class="index">${n+1}</div>
              <div class="title">${e.title.toString()}</div>
            </div>
          `)}
        <div class="indicator-line"></div>
        <div class="clone item">
          ${t?b`<div class="drag-indicator"></div>
                <div class="index">${this._curIndex+1}</div>
                <div class="title">${t.title.toString()}</div>`:ae}
        </div>
      </div>
    `}};Ms.styles=X`
    .edgeelss-frame-order-items-container {
      max-height: 281px;
      border-radius: 8px;
      padding: 8px 0px 8px 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-menu-shadow);
      overflow: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .item {
      width: 256px;
      border-radius: 4px;
      padding: 4px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }

    .draggable:hover {
      background-color: var(--affine-hover-color);
    }

    .item:hover .drag-indicator {
      opacity: 1;
    }

    .drag-indicator {
      cursor: pointer;
      width: 4px;
      height: 12px;
      border-radius: 1px;
      opacity: 0.2;
      background: var(--affine-placeholder-color);
      margin-right: 2px;
    }

    .index {
      width: 20px;
      min-width: 20px;
      height: 24px;
      text-align: center;
      font-weight: 400;
      font-size: 15px;
      line-height: 24px;
      color: var(--affine-text-secondary-color);
      margin-right: 4px;
    }

    .image {
      width: 70px;
      min-width: 70px;
      height: 45px;
      border-radius: 4px;
      box-shadow: 0px 1px 6px 0px rgba(0, 0, 0, 0.16);
      margin-right: 8px;
    }

    .title {
      font-size: 14px;
      font-weight: 400;
      height: 22px;
      line-height: 22px;
      color: var(--affine-text-primary-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .clone {
      visibility: hidden;
      position: absolute;
      z-index: 1;
      left: 8px;
      height: 30px;
      border: 1px solid var(--affine-border-color);
      box-shadow: var(--affine-menu-shadow);
      background-color: var(--affine-white);
      pointer-events: none;
    }

    .indicator-line {
      visibility: hidden;
      position: absolute;
      z-index: 1;
      left: 8px;
      background-color: var(--affine-primary-color);
      height: 1px;
      width: 90%;
    }
  `;Ac([ie()],Ms.prototype,"_curIndex",2);Ac([L({attribute:!1})],Ms.prototype,"edgeless",2);Ac([L({attribute:!1})],Ms.prototype,"frames",2);Ac([he(".edgeelss-frame-order-items-container")],Ms.prototype,"_container",2);Ac([he(".indicator-line")],Ms.prototype,"_indicatorLine",2);Ac([he(".clone")],Ms.prototype,"_clone",2);Ms=Ac([W("edgeless-frame-order-menu")],Ms);var MQ=Object.defineProperty,PQ=Object.getOwnPropertyDescriptor,ru=(t,e,n,i)=>{for(var r=i>1?void 0:i?PQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&MQ(e,n,r),r};let La=class extends me(Ae){constructor(){super(...arguments),this._edgelessFrameOrderPopper=null,this._popperShow=!1}firstUpdated(){this._edgelessFrameOrderPopper=Nt(this._edgelessFrameOrderButton,this._edgelessFrameOrderMenu,({display:t})=>this._popperShow=t==="show")}render(){const{readonly:t}=this.edgeless.page;return b`
      <style>
        .edgeless-frame-order-button svg {
          color: ${t?"var(--affine-text-disable-color)":"inherit"};
        }
      </style>
      <edgeless-tool-icon-button
        class="edgeless-frame-order-button"
        .tooltip=${this._popperShow?"":"Frame Order"}
        @click=${()=>{t||this._edgelessFrameOrderPopper?.toggle()}}
      >
        ${JT}
      </edgeless-tool-icon-button>
      <edgeless-frame-order-menu
        .edgeless=${this.edgeless}
        .frames=${this.frames}
      >
      </edgeless-frame-order-menu>
    `}};La.styles=X`
    edgeless-frame-order-menu {
      display: none;
    }

    edgeless-frame-order-menu[data-show] {
      display: initial;
    }
  `;ru([L({attribute:!1})],La.prototype,"edgeless",2);ru([L({attribute:!1})],La.prototype,"frames",2);ru([he(".edgeless-frame-order-button")],La.prototype,"_edgelessFrameOrderButton",2);ru([he("edgeless-frame-order-menu")],La.prototype,"_edgelessFrameOrderMenu",2);ru([ie()],La.prototype,"_popperShow",2);La=ru([W("edgeless-frame-order-button")],La);var AQ=Object.defineProperty,$Q=Object.getOwnPropertyDescriptor,Lb=(t,e,n,i)=>{for(var r=i>1?void 0:i?$Q(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&AQ(e,n,r),r};const BQ=[{name:"1:1",wh:[1200,1200]},{name:"4:3",wh:[1600,1200]},{name:"16:9",wh:[1600,900]},{name:"2:1",wh:[1600,800]}];let Yh=class extends me(Ae){render(){if(this.edgelessTool.type!=="frame")return ae;const{edgeless:t}=this,{surface:e}=t;return b`
      <div class="frame-menu-container">
        <edgeless-slide-menu .menuWidth=${304} .showNext=${!1}>
          <div class="menu-content">
            <div class="frame-add-button custom">Custom</div>
            <menu-divider .vertical=${!0}></menu-divider>
            ${Fe(BQ,n=>n.name,(n,i)=>b`
                <div
                  @click=${()=>{const r=t.service.frames,o=t.service.viewport.center,s=new ne(o.x-n.wh[0]/2,o.y-n.wh[1]/2,n.wh[0],n.wh[1]),a=t.service.addBlock("affine:frame",{title:new nt.Y.Text(`Frame ${r.length+1}`),xywh:s.serialize()},e.model);t.page.captureSync();const l=t.service.getElementById(a);D(l),t.tools.setEdgelessTool({type:"default"}),t.service.selection.set({elements:[l.id],editing:!1})}}
                  class="frame-add-button ${i}"
                >
                  ${n.name}
                </div>
              `)}
          </div>
        </edgeless-slide-menu>
      </div>
    `}};Yh.styles=X`
    :host {
      position: absolute;
      display: flex;
      z-index: -1;
    }
    .frame-menu-container {
      display: flex;
      align-items: center;
      position: relative;
      cursor: default;
    }
    .menu-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
    }

    .frame-add-button {
      border: 1px solid rgba(227, 226, 228, 1);
      border-radius: 2px;
      cursor: pointer;
      font-size: 10px;
      font-weight: 400;
      line-height: 12px;
      letter-spacing: 0px;
      text-align: center;
      max-height: 20.49px;
      height: 20.49px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .frame-add-button:nth-of-type(1) {
      padding: 0px 3px;
    }

    .frame-add-button:nth-of-type(2) {
      width: 20.49px;
    }

    .frame-add-button:nth-of-type(3) {
      width: 27.31px;
    }
    .frame-add-button:nth-of-type(4) {
      width: 36.42px;
    }
    .frame-add-button:nth-of-type(5) {
      width: 40.97px;
    }
    .custom {
      background: rgba(0, 0, 0, 0.04);
      border: 0.640185px solid #e3e2e4;
      border-radius: 2px;
      color: #424149;
    }

    menu-divider {
      height: 20px;
    }
  `;Lb([L({attribute:!1})],Yh.prototype,"edgelessTool",2);Lb([L({attribute:!1})],Yh.prototype,"edgeless",2);Yh=Lb([W("edgeless-frame-menu")],Yh);var DQ=Object.defineProperty,OQ=Object.getOwnPropertyDescriptor,E3=(t,e,n,i)=>{for(var r=i>1?void 0:i?OQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&DQ(e,n,r),r};let K1=class extends me(Ae){constructor(){super(...arguments),this._frameMenu=null}_toggleFrameMenu(){this._frameMenu?(this._frameMenu.dispose(),this._frameMenu=null):(this._frameMenu=Jd("edgeless-frame-menu",this,{x:90,y:-40}),this._frameMenu.element.edgelessTool=this.edgelessTool,this._frameMenu.element.edgeless=this.edgeless)}updated(t){t.has("edgelessTool")&&(this.edgelessTool.type!=="frame"&&(this._frameMenu?.dispose(),this._frameMenu=null),this._frameMenu&&(this._frameMenu.element.edgelessTool=this.edgelessTool,this._frameMenu.element.edgeless=this.edgeless))}connectedCallback(){super.connectedCallback(),this._disposables.add(this.edgeless.slots.edgelessToolUpdated.on(t=>{t.type!=="frame"&&(this._frameMenu?.dispose(),this._frameMenu=null)}))}disconnectedCallback(){this._frameMenu?.dispose(),this._frameMenu=null,super.disconnectedCallback()}render(){const t=this.edgelessTool?.type,e=t==="frame"?"currentColor":"#77757D";return b`
      <edgeless-tool-icon-button
        class="edgeless-frame-button"
        .tooltip=${this._frameMenu?"":yr("Frame","F")}
        .tooltipOffset=${17}
        .active=${t==="frame"}
        .iconContainerPadding=${8}
        @click=${()=>{this.setEdgelessTool({type:"frame"}),this._toggleFrameMenu()}}
      >
        ${MI}
        <span class="arrow-up-icon" style=${we({color:e})}>
          ${u0}
        </span>
      </edgeless-tool-icon-button>
    `}};K1.styles=X`
    :host {
      display: flex;
    }

    .arrow-up-icon {
      position: absolute;
      top: 4px;
      right: 2px;
      font-size: 0;
    }
  `;E3([L({attribute:!1})],K1.prototype,"edgelessTool",2);E3([L({attribute:!1})],K1.prototype,"edgeless",2);E3([L({attribute:!1})],K1.prototype,"setEdgelessTool",2);K1=E3([W("edgeless-frame-tool-button")],K1);var RQ=Object.defineProperty,NQ=Object.getOwnPropertyDescriptor,x0=(t,e,n,i)=>{for(var r=i>1?void 0:i?NQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&RQ(e,n,r),r};let Jl=class extends me(Ae){connectedCallback(){super.connectedCallback(),localStorage.defaultTool||(localStorage.defaultTool="default"),this.edgeless.slots.edgelessToolUpdated.on(({type:t})=>{(t==="default"||t==="pan")&&(localStorage.defaultTool=t)})}_fadeOut(){this.currentIcon.style.opacity="0",this.currentIcon.style.transform="translateY(-5px)"}_fadeIn(){this.currentIcon.style.opacity="1",this.currentIcon.style.transform="translateY(0px)"}_changeTool(){const t=this.edgelessTool?.type;if(t!=="default"&&t!=="pan"){localStorage.defaultTool==="default"?this.setEdgelessTool({type:"default"}):localStorage.defaultTool==="pan"&&this.setEdgelessTool({type:"pan",panning:!1});return}this._fadeOut(),setTimeout(()=>{t==="default"?(this.currentIcon,this.setEdgelessTool({type:"pan",panning:!1})):t==="pan"&&this.setEdgelessTool({type:"default"}),this._fadeIn()},100)}render(){const t=this.edgelessTool?.type,e=t==="default"||t==="pan"?"currentColor":"#77757D";return b`
      <edgeless-tool-icon-button
        class="edgeless-default-button ${t}"
        .tooltip=${t==="pan"?yr("Hand","H"):yr("Select","V")}
        .tooltipOffset=${17}
        .active=${t==="default"||t==="pan"}
        .iconContainerPadding=${8}
        @click=${this._changeTool}
      >
        <span class="current-icon">
          ${localStorage.defaultTool==="default"?VT:sI}
        </span>
        <span class="arrow-up-icon" style=${we({color:e})}>
          ${u0}
        </span>
      </edgeless-tool-icon-button>
    `}};Jl.styles=X`
    .current-icon {
      transition: 100ms;
    }
    .arrow-up-icon {
      position: absolute;
      top: 4px;
      right: 2px;
      font-size: 0;
    }
  `;x0([L({attribute:!1})],Jl.prototype,"edgelessTool",2);x0([L({attribute:!1})],Jl.prototype,"edgeless",2);x0([L({attribute:!1})],Jl.prototype,"setEdgelessTool",2);x0([he(".current-icon")],Jl.prototype,"currentIcon",2);Jl=x0([W("edgeless-default-tool-button")],Jl);var HQ=Object.defineProperty,FQ=Object.getOwnPropertyDescriptor,S3=(t,e,n,i)=>{for(var r=i>1?void 0:i?FQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&HQ(e,n,r),r};let Q1=class extends me(Ae){render(){return this.edgeless.edgelessTool.type!=="text"?ae:b`
      <edgeless-slide-menu .menuWidth=${476}>
        <div class="menu-content">
          <edgeless-one-row-color-panel
            .value=${this.color}
            @select=${t=>this.onChange({color:t.detail})}
          ></edgeless-one-row-color-panel>
        </div>
      </edgeless-slide-menu>
    `}};Q1.styles=X`
    :host {
      display: flex;
      position: absolute;
      z-index: -1;
    }
  `;S3([L({attribute:!1})],Q1.prototype,"edgeless",2);S3([L({attribute:!1})],Q1.prototype,"color",2);S3([L({attribute:!1})],Q1.prototype,"onChange",2);Q1=S3([W("edgeless-text-menu")],Q1);var UQ=Object.defineProperty,VQ=Object.getOwnPropertyDescriptor,CM=(t,e,n,i)=>{for(var r=i>1?void 0:i?VQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&UQ(e,n,r),r};let o5=class extends Ea{constructor(){super(...arguments),this.color=xb(),this._type="text",this._states=["color"]}_toggleTextMenu(){this._menu?(this._disposeMenu(),this.requestUpdate()):(this.edgeless.tools.setEdgelessTool({type:this._type}),this._menu=Jd("edgeless-text-menu",this,{x:130,y:-40}),this.updateMenu(),this._menu.element.edgeless=this.edgeless,this._menu.element.onChange=t=>{this.edgeless.service.editSession.record(this._type,t)})}updated(t){this._states.some(e=>t.has(e))&&this._menu&&this.updateMenu()}render(){const{active:t}=this;return b`
      <edgeless-toolbar-button
        class="edgeless-text-button"
        .tooltip=${this._menu?"":yr("Text","T")}
        .tooltipOffset=${15}
        .active=${t}
        .activeMode=${"background"}
        @click=${()=>{this._toggleTextMenu()}}
      >
        <div class="edgeless-text-button">
          <div class=${t?"active-mode":""}></div>
          <div style=${we({color:`var(${this.color})`})}>
            ${U9}
          </div>
        </div>
      </edgeless-toolbar-button>
    `}};o5.styles=X`
    :host {
      display: flex;
    }
    .edgeless-text-button {
      position: relative;
      width: 54px;
      height: 44px;
      overflow-y: hidden;
    }
  `;CM([ie()],o5.prototype,"color",2);o5=CM([W("edgeless-text-tool-button")],o5);var zQ=Object.defineProperty,jQ=Object.getOwnPropertyDescriptor,T3=(t,e,n,i)=>{for(var r=i>1?void 0:i?jQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&zQ(e,n,r),r};let J1=class extends me(Ae){firstUpdated(){this.edgeless.bindHotKey({Escape:()=>{this.edgelessTool.type==="eraser"&&this.setEdgelessTool({type:"default"})}},{global:!0})}render(){const t=this.edgelessTool?.type;return b`
      <edgeless-toolbar-button
        class="edgeless-eraser-button"
        .tooltip=${yr("Eraser","E")}
        .tooltipOffset=${4}
        .active=${t==="eraser"}
        @click=${()=>this.setEdgelessTool({type:"eraser"})}
      >
        <div class="eraser-button">
          <div class=${t==="eraser"?"active-mode":""}></div>
          ${DI}
        </div>
      </edgeless-toolbar-button>
    `}};J1.styles=X`
    .eraser-button {
      position: relative;
      height: 66px;
      width: 60px;
      overflow-y: hidden;
    }
    .eraser-button .active-mode {
      position: absolute;
      top: 8px;
      left: 6px;
      width: 48px;
      height: 66px;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
      background: var(--affine-hover-color);
    }
    #edgeless-eraser-icon {
      position: absolute;
      top: 4px;
      left: 50%;
      transform: translateX(-50%);
      transition: top 0.3s ease-in-out;
    }
    #edgeless-eraser-icon:hover {
      top: 0px;
    }
  `;T3([L({attribute:!1})],J1.prototype,"edgelessTool",2);T3([L({attribute:!1})],J1.prototype,"edgeless",2);T3([L({attribute:!1})],J1.prototype,"setEdgelessTool",2);J1=T3([W("edgeless-eraser-tool-button")],J1);var GQ=Object.defineProperty,ZQ=Object.getOwnPropertyDescriptor,Mb=(t,e,n,i)=>{for(var r=i>1?void 0:i?ZQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&GQ(e,n,r),r};const WQ=X`
  :host {
    display: flex;
  }

  .switch {
    height: 0;
    width: 0;
    visibility: hidden;
    margin: 0;
  }

  label {
    cursor: pointer;
    text-indent: -9999px;
    width: 38px;
    height: 20px;
    background: var(--affine-icon-color);
    border: 1px solid var(--affine-black-10);
    display: block;
    border-radius: 20px;
    position: relative;
  }

  label:after {
    content: '';
    position: absolute;
    top: 1px;
    left: 1px;
    width: 16px;
    height: 16px;
    background: var(--affine-white);
    border: 1px solid var(--affine-black-10);
    border-radius: 16px;
    transition: 0.1s;
  }

  label.on {
    background: var(--affine-primary-color);
  }

  label.on:after {
    left: calc(100% - 1px);
    transform: translateX(-100%);
  }

  label:active:after {
    width: 24px;
  }
`;let Xh=class extends Ae{constructor(){super(...arguments),this.on=!1}_toggleSwitch(){this.on=!this.on,this.onChange&&this.onChange(this.on)}render(){return b`
      <label class=${this.on?"on":""}>
        <input
          type="checkbox"
          class="switch"
          ?checked=${this.on}
          @change=${this._toggleSwitch}
        />
      </label>
    `}};Xh.styles=WQ;Mb([L({attribute:!1})],Xh.prototype,"on",2);Mb([L({attribute:!1})],Xh.prototype,"onChange",2);Xh=Mb([W("toggle-switch")],Xh);var qQ=Object.defineProperty,YQ=Object.getOwnPropertyDescriptor,qs=(t,e,n,i)=>{for(var r=i>1?void 0:i?YQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qQ(e,n,r),r};let Yr=class extends me(Ae){constructor(){super(...arguments),this.blackBackground=!0,this.popperShow=!1,this.setPopperShow=()=>{},this.hideToolbar=!1,this._navigatorSettingPopper=null,this._onBlackBackgroundChange=t=>{this.blackBackground=t,this.edgeless.slots.navigatorSettingUpdated.emit({blackBackground:this.blackBackground})}}_tryRestoreSettings(){const t=this.edgeless.service.editSession.getItem("presentBlackBackground");this.blackBackground=t||!0}connectedCallback(){super.connectedCallback(),this._tryRestoreSettings()}firstUpdated(){this._navigatorSettingPopper=Nt(this._navigatorSettingButton,this._navigatorSettingMenu,({display:t})=>this.setPopperShow(t==="show"))}render(){return b`
      <edgeless-tool-icon-button
        class="navigator-setting-button"
        .tooltip=${this.popperShow?"":"Settings"}
        @click=${()=>{this._navigatorSettingPopper?.toggle()}}
      >
        ${KT}
      </edgeless-tool-icon-button>
      <div
        class="navigator-setting-menu"
        @click=${t=>{t.stopPropagation()}}
      >
        <div class="item-container">
          <div class="text title">Playback Settings</div>
        </div>
        <div class="item-container">
          <div class="text">Dark background</div>
          <toggle-switch
            .on=${this.blackBackground}
            .onChange=${this._onBlackBackgroundChange}
          >
          </toggle-switch>
        </div>
        <div class="item-container">
          <div class="text">Hide toolbar</div>
          <toggle-switch
            .on=${this.hideToolbar}
            .onChange=${t=>{this.onHideToolbarChange&&this.onHideToolbarChange(t)}}
          >
          </toggle-switch>
        </div>
      </div>
    `}};Yr.styles=X`
    .navigator-setting-menu {
      display: none;
      padding: 8px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 500;
      background-color: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-menu-shadow);
      color: var(--affine-text-primary-color);
    }

    .navigator-setting-menu[data-show] {
      display: initial;
    }

    .item-container {
      padding: 0px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 28px;
      width: 204px;
    }

    .text {
      padding: 0px 4px;
    }

    .title {
      color: var(--affine-text-secondary-color);
    }
  `;qs([ie()],Yr.prototype,"blackBackground",2);qs([L({attribute:!1})],Yr.prototype,"popperShow",2);qs([L({attribute:!1})],Yr.prototype,"setPopperShow",2);qs([L({attribute:!1})],Yr.prototype,"hideToolbar",2);qs([L({attribute:!1})],Yr.prototype,"onHideToolbarChange",2);qs([L({attribute:!1})],Yr.prototype,"edgeless",2);qs([he(".navigator-setting-button")],Yr.prototype,"_navigatorSettingButton",2);qs([he(".navigator-setting-menu")],Yr.prototype,"_navigatorSettingMenu",2);Yr=qs([W("edgeless-navigator-setting-button")],Yr);var XQ=Object.defineProperty,KQ=Object.getOwnPropertyDescriptor,QQ=(t,e,n,i)=>{for(var r=i>1?void 0:i?KQ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&XQ(e,n,r),r};let k8=class extends Ae{render(){return b`<div class="affine-template-block-container">
      <div class="affine-template-block-loading"></div>
    </div>`}};k8.styles=X`
    @keyframes affine-template-block-rotate {
      from {
        rotate: 0deg;
      }
      to {
        rotate: 360deg;
      }
    }

    .affine-template-block-container {
      width: 20px;
      height: 20px;
      overflow: hidden;
    }

    .affine-template-block-loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      position: relative;
      background: conic-gradient(
        rgba(30, 150, 235, 1) 90deg,
        rgba(0, 0, 0, 0.1) 90deg 360deg
      );
      border-radius: 50%;
      animation: affine-template-block-rotate 1s infinite ease-in;
    }

    .affine-template-block-loading::before {
      content: '';
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background-color: white;
      position: absolute;
      top: 3px;
      left: 3px;
    }
  `;k8=QQ([W("affine-template-loading")],k8);function o_(t,e,n){const i=n.get(t.id),r=n.get(e.id);return i&&r?i.id===r.id?t.index===e.index?0:t.index>e.index?1:-1:i.index>r.index?1:-1:i?i.id===e.id?1:i.index===e.index?0:i.index>e.index?1:-1:r?t.id===r.id?-1:t.index===r.index?0:t.index>r.index?1:-1:t.index===e.index?0:t.index>e.index?1:-1}const JQ=t=>{const e=new Map;t.slots.beforeInsert.on(i=>{switch(i.type){case"block":n(i.data);break}});const n=i=>{const{blockJson:r}=i,o=e.has(r.id)?e.get(r.id):t.model.page.workspace.idGenerator();if(e.has(r.id)||e.set(r.id,o),r.id=o,i.parent=i.parent?e.get(i.parent)??i.parent:void 0,r.flavour==="affine:surface-ref"&&(r.props.reference=e.get(r.props.reference)??""),r.flavour==="affine:surface"){const s={},a=[];Object.entries(r.props.elements).forEach(([l,c])=>{const d=OT();e.set(l,d),c.id=d,s[d]=c,["group","connector"].includes(c.type)&&a.push(d)}),r.children.forEach(l=>{e.set(l.id,t.model.page.workspace.idGenerator())}),a.forEach(l=>{const c=s[l];switch(c.type){case"group":{const d=c.children,u={};Object.entries(d.json).forEach(([h,p])=>{u[e.get(h)??h]=p}),d.json=u}break;case"connector":{const d=c.target;d.id&&(c.target={...d,id:e.get(d.id)});const u=c.source;u.id&&(c.source={...u,id:e.get(u.id)})}break}}),r.props.elements=s}}},eJ=t=>e=>{if(e.type!=="template")return;let n=null,i;e.slots.beforeInsert.on(s=>{s.type==="template"?(n=s.bound,n&&(i={x:t.x-n.x,y:t.y-n.y},n.x=t.x,n.y=t.y)):n&&i&&o(s.data.blockJson)});const r=["group","connector"],o=s=>{if(D(n),s.props.xywh){const a=ne.deserialize(s.props.xywh);s.props.xywh=new ne(a.x+i.x,a.y+i.y,a.w,a.h).serialize()}s.flavour==="affine:surface"&&Object.entries(s.props.elements).forEach(([a,l])=>{const c=l.type;if(r.includes(c)&&l.xywh&&delete l.xywh,l.xywh){const d=ne.deserialize(l.xywh);l.xywh=new ne(d.x+i.x,d.y+i.y,d.w,d.h).serialize()}c==="connector"&&["target","source"].forEach(d=>{const u=l[d];if(u.id||!u.position)return;const h=u.position;u.position=[h[0]+i.x,h[1]+i.y]})})}},tJ=(t,e)=>n=>{n.slots.beforeInsert.on(r=>{r.type==="block"&&i(r.data.blockJson)});const i=r=>{if(r.flavour==="affine:image"&&r.props.xywh){const o=ne.deserialize(r.props.xywh);r.props.xywh=new ne(t.x-o.w/2,t.y-o.h/2,o.w,o.h).serialize(),r.props.index=e()}}},nJ=t=>e=>{e.slots.beforeInsert.on(o=>{o.type==="template"&&i(),o.type==="block"&&r(o.data.blockJson)});const n=new Map,i=()=>{const o=[],s=[],a=new Map;e.walk(l=>{l.props.index&&(l.flavour==="affine:frame"?s.push({id:l.id,index:l.props.index}):o.push({id:l.id,index:l.props.index,flavour:l.flavour})),l.flavour==="affine:surface"&&Object.entries(l.props.elements).forEach(([c,d])=>{if(o.push({index:d.index,flavour:d.type,id:d.id,element:!0}),d.type==="group"){const u=d.children,h={index:d.index,id:d.id};Object.keys(u.json).forEach(p=>{a.set(p,h)})}})}),o.sort((l,c)=>o_(l,c,a)),s.sort((l,c)=>o_(l,c,a)),s.forEach(l=>{n.set(l.id,t("affine:frame"))}),o.forEach(l=>{n.set(l.id,t(l.flavour))})},r=o=>{o.props.index&&(o.props.index=n.get(o.id)??o.props.index),o.flavour==="affine:surface"&&Object.entries(o.props.elements).forEach(([s,a])=>{a.index&&(a.index=n.get(a.id))})}},_6=[{name:"Marketing",templates:{Storyboard:()=>Jt(()=>import("./storyboard-WwN1pQ-B.js"),__vite__mapDeps([])).then(t=>t.default),"4P Marketing Matrix":()=>Jt(()=>import("./4p-marketing-matrix-eQT8Ht2d.js"),__vite__mapDeps([])).then(t=>t.default),"User Journey Map":()=>Jt(()=>import("./user-journey-smNJSXyR.js"),__vite__mapDeps([])).then(t=>t.default)}},{name:"Project management",templates:{Gantt:()=>Jt(()=>import("./gantt-chart-zH0vquq_.js"),__vite__mapDeps([])).then(t=>t.default),Kanban:()=>Jt(()=>import("./kanban-epfSB_Jc.js"),__vite__mapDeps([])).then(t=>t.default),"Montly Calendar":()=>Jt(()=>import("./monthly-calendar--O4uDhBj.js"),__vite__mapDeps([])).then(t=>t.default),Fishbone:()=>Jt(()=>import("./fishbone-bELSdwKs.js"),__vite__mapDeps([])).then(t=>t.default),"Project Planning":()=>Jt(()=>import("./project-planning-LizURoog.js"),__vite__mapDeps([])).then(t=>t.default)}},{name:"Brainstorming",templates:{SWOT:()=>Jt(()=>import("./swot-ELWKZcik.js"),__vite__mapDeps([])).then(t=>t.default),"5W2H":()=>Jt(()=>import("./2h5w-uUPjNZIP.js"),__vite__mapDeps([])).then(t=>t.default),"Flow Chart":()=>Jt(()=>import("./flow-chart-DciEXpOJ.js"),__vite__mapDeps([])).then(t=>t.default),"Concept Map":()=>Jt(()=>import("./concept-map-M0g5Xcus.js"),__vite__mapDeps([])).then(t=>t.default),"SMART Principles":()=>Jt(()=>import("./smart-principles-efq39orF.js"),__vite__mapDeps([])).then(t=>t.default)}},{name:"Presentation",templates:{"Data Analysis":()=>Jt(()=>import("./data-analysis-y069WmJw.js"),__vite__mapDeps([])).then(t=>t.default),"Simple Presentation":()=>Jt(()=>import("./simple-presentation-YQwrpYcA.js"),__vite__mapDeps([])).then(t=>t.default),"Business Proposal":()=>Jt(()=>import("./business-proposal-pZ2Mlj7H.js"),__vite__mapDeps([])).then(t=>t.default)}},{name:"Paws and pals",templates:()=>Jt(()=>import("./stickers-jUk7g3Jx.js"),__vite__mapDeps([])).then(t=>t.default)}];function iJ(t,e){const n=new Array(t.length+1).fill(null).map(()=>new Array(e.length+1).fill(0));for(let i=1;i<=t.length;i++)for(let r=1;r<=e.length;r++)t[i-1]===e[r-1]?n[i][r]=n[i-1][r-1]+1:n[i][r]=Math.max(n[i-1][r],n[i][r-1]);return n[t.length][e.length]}const rJ={list:async t=>{const e=_6.find(n=>n.name===t);return e?e.templates instanceof Function?await e.templates():Promise.all(A2(e.templates).map(n=>e.templates[n]())):[]},categories:async()=>_6.map(t=>t.name),search:async(t,e)=>{const n=[];return t=t.trim().toLocaleLowerCase(),await Promise.all(_6.map(async i=>{if(!(e&&e!==i.name)&&!(i.templates instanceof Function))return Promise.all(A2(i.templates).map(async r=>{if(iJ(t,r.toLocaleLowerCase())===t.length){const o=await i.templates[r]();n.push(o)}}))})),n}},oJ=b`
  <svg
    width="24"
    height="18"
    viewBox="0 0 24 18"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      id="Polygon 19"
      d="M12.6809 16.8585C12.2821 17.4176 11.4514 17.4176 11.0526 16.8585L0.754394 2.41961C0.282281 1.75767 0.755483 0.838941 1.56853 0.838941L22.165 0.838943C22.978 0.838943 23.4512 1.75767 22.9791 2.41961L12.6809 16.8585Z"
      fill="currentColor"
    />
  </svg>
`,Pb={position:"absolute",boxShadow:"1px -1px 4px 0px rgba(66, 65, 73, 0.18)",borderRadius:"2px",transition:"width .2s, height .2s, top .2s, left .2s, transform .2s"},sJ=t=>b`
  <svg
    width="85"
    height="50"
    viewBox="0 0 85 50"
    fill="none"
    style="${we({...t?{width:"30px",height:"18px",left:"63px",top:"7px",transform:"rotate(20.251deg)"}:{width:"86px",height:"56.6px",top:"36px",left:"8px",transform:"rotate(0deg)"},...Pb})}"
    xmlns="http://www.w3.org/2000/svg"
  >
    ${Ht`
    <g clip-path="url(#clip0_13696_17641)">
      <rect width="85" height="50" fill="currentColor" />
      <rect x="4" y="7" width="7" height="2" rx="1" fill="#FFEACA" />
      <rect x="4" y="11" width="24" height="40" rx="1" fill="#FFEACA" />
      <g filter="url(#filter0_d_13696_17641)">
        <rect x="5" y="14" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="5.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter1_d_13696_17641)">
        <rect x="5" y="22" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="5.05"
          y="22.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter2_d_13696_17641)">
        <rect x="5" y="29" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="5.05"
          y="29.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter3_d_13696_17641)">
        <rect x="13" y="14" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="13.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter4_d_13696_17641)">
        <rect x="13" y="22" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="13.05"
          y="22.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter5_d_13696_17641)">
        <rect x="13" y="29" width="6" height="5" fill="#9DD194" />
        <rect
          x="13.05"
          y="29.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter6_d_13696_17641)">
        <rect x="21" y="14" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="21.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter7_d_13696_17641)">
        <rect x="21" y="22" width="6" height="5" fill="#FFDE6B" />
        <rect
          x="21.05"
          y="22.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter8_d_13696_17641)">
        <rect x="21" y="29" width="6" height="5" fill="#F16F6F" />
        <rect
          x="21.05"
          y="29.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <rect x="31" y="7" width="7" height="2" rx="1" fill="#E1EFFF" />
      <rect x="31" y="11" width="24" height="40" rx="1" fill="#E1EFFF" />
      <g filter="url(#filter9_d_13696_17641)">
        <rect x="32" y="14" width="6" height="5" fill="#B8E3FF" />
        <rect
          x="32.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter10_d_13696_17641)">
        <rect x="32" y="21" width="6" height="5" fill="#B8E3FF" />
        <rect
          x="32.05"
          y="21.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter11_d_13696_17641)">
        <rect x="40" y="14" width="6" height="5" fill="#B8E3FF" />
        <rect
          x="40.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter12_d_13696_17641)">
        <rect x="40" y="21" width="6" height="5" fill="#FFC46B" />
        <rect
          x="40.05"
          y="21.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter13_d_13696_17641)">
        <rect x="48" y="14" width="6" height="5" fill="#B8E3FF" />
        <rect
          x="48.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <rect x="58" y="7" width="7" height="2" rx="1" fill="#DFF4E8" />
      <rect x="58" y="11" width="24" height="40" rx="1" fill="#DFF4E8" />
      <g filter="url(#filter14_d_13696_17641)">
        <rect x="59" y="14" width="6" height="5" fill="#9DD194" />
        <rect
          x="59.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter15_d_13696_17641)">
        <rect x="59" y="21" width="6" height="5" fill="#9DD194" />
        <rect
          x="59.05"
          y="21.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter16_d_13696_17641)">
        <rect x="67" y="14" width="6" height="5" fill="#9DD194" />
        <rect
          x="67.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter17_d_13696_17641)">
        <rect x="67" y="21" width="6" height="5" fill="#FFC46B" />
        <rect
          x="67.05"
          y="21.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter18_d_13696_17641)">
        <rect x="75" y="14" width="6" height="5" fill="#9DD194" />
        <rect
          x="75.05"
          y="14.05"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
    </g>
    <defs>
      <filter
        id="filter0_d_13696_17641"
        x="-14.1379"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter1_d_13696_17641"
        x="-14.1379"
        y="2.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter2_d_13696_17641"
        x="-14.1379"
        y="9.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter3_d_13696_17641"
        x="-6.13793"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter4_d_13696_17641"
        x="-6.13793"
        y="2.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter5_d_13696_17641"
        x="-6.13793"
        y="9.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter6_d_13696_17641"
        x="1.86207"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter7_d_13696_17641"
        x="1.86207"
        y="2.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter8_d_13696_17641"
        x="1.86207"
        y="9.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter9_d_13696_17641"
        x="12.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter10_d_13696_17641"
        x="12.8621"
        y="1.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter11_d_13696_17641"
        x="20.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter12_d_13696_17641"
        x="20.8621"
        y="1.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter13_d_13696_17641"
        x="28.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter14_d_13696_17641"
        x="39.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter15_d_13696_17641"
        x="39.8621"
        y="1.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter16_d_13696_17641"
        x="47.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter17_d_13696_17641"
        x="47.8621"
        y="1.86207"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <filter
        id="filter18_d_13696_17641"
        x="55.8621"
        y="-5.13793"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13696_17641"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13696_17641"
          result="shape"
        />
      </filter>
      <clipPath id="clip0_13696_17641">
        <rect width="85" height="50" fill="white" />
      </clipPath>
    </defs>
    `}
  </svg>
`,aJ=t=>b`
  <svg
    width="85"
    height="50"
    viewBox="0 0 85 50"
    fill="none"
    style=${we({...t?{width:"26px",height:"15px",left:"9px",top:"9px",transform:"rotate(-20.56deg)"}:{width:"41.5px",height:"24.4px",left:"11px",top:"19px",transform:"rotate(-7.2deg)"},...Pb})}
    xmlns="http://www.w3.org/2000/svg"
  >
    ${Ht`<rect width="85" height="50" fill="currentColor" />
    <line
      x1="16"
      y1="31.8907"
      x2="22"
      y2="31.8907"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <line
      x1="16"
      y1="31.8907"
      x2="22"
      y2="31.8907"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M33 31H36.1325V22.8918V19.0001L40 19"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M52 19H64.1883V13V10L68 10.0001"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M29 31H35.8083L35.8089 36.8873V39.9999L40 40"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M62 19H64.685V24.9999V27.9999L68 28"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <rect x="40" y="36" width="12" height="7" rx="0.728829" fill="#9DD194" />
    <rect
      x="40.0364"
      y="36.0364"
      width="11.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="3" y="28" width="13" height="6" rx="0.728829" fill="#FFDE6B" />
    <rect
      x="3.03644"
      y="28.0364"
      width="12.9271"
      height="5.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect
      x="54.7686"
      y="19.1265"
      width="6.22715"
      height="6.22715"
      transform="rotate(-45 54.7686 19.1265)"
      fill="#937EE7"
    />
    <rect
      x="54.8201"
      y="19.1265"
      width="6.15427"
      height="6.15427"
      transform="rotate(-45 54.8201 19.1265)"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect
      x="21.4038"
      y="30.8835"
      width="6.22715"
      height="6.22715"
      transform="rotate(-45 21.4038 30.8835)"
      fill="#937EE7"
    />
    <rect
      x="21.4553"
      y="30.8835"
      width="6.15427"
      height="6.15427"
      transform="rotate(-45 21.4553 30.8835)"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="40" y="16" width="12" height="7" rx="0.728829" fill="#FFDE6B" />
    <rect
      x="40.0364"
      y="16.0364"
      width="11.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="68" y="8" width="13" height="6" rx="0.728829" fill="#937EE7" />
    <rect
      x="68.0364"
      y="8.03644"
      width="12.9271"
      height="5.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="68" y="24" width="13" height="7" rx="0.728829" fill="#937EE7" />
    <rect
      x="68.0364"
      y="24.0364"
      width="12.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />`}
  </svg>
`,lJ=t=>b`
  <svg
    width="85"
    height="50"
    viewBox="0 0 85 50"
    fill="none"
    style=${we({...t?{width:"39px",height:"23px",left:"30.3px",top:"5.4px",transform:"rotate(0deg)"}:{width:"56.7px",height:"33.3px",left:"31px",top:"15.7px",transform:"rotate(9.259deg)"},...Pb})}
    xmlns="http://www.w3.org/2000/svg"
  >
    ${Ht`<g clip-path="url(#clip0_13703_17928)">
      <rect width="85" height="50" fill="currentColor" />
      <rect
        x="4.17871"
        y="4.62036"
        width="35.0562"
        height="18.4492"
        rx="1"
        fill="#DFF4E8"
      />
      <rect
        x="45.2656"
        y="4.52075"
        width="35.0562"
        height="18.4492"
        rx="1"
        fill="#DFF4F3"
      />
      <rect
        x="4.29248"
        y="27.6343"
        width="35.0562"
        height="18.4492"
        rx="1"
        fill="#FFEACA"
      />
      <rect
        x="45.2798"
        y="27.5554"
        width="35.0562"
        height="18.4492"
        rx="1"
        fill="#FFE1E1"
      />
      <g filter="url(#filter0_d_13703_17928)">
        <rect
          x="6.01074"
          y="6.79297"
          width="6.66992"
          height="5"
          fill="#9DD194"
        />
        <rect
          x="6.06074"
          y="6.84297"
          width="6.56992"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter1_d_13703_17928)">
        <rect x="6.01074" y="15" width="6.66992" height="5" fill="#9DD194" />
        <rect
          x="6.06074"
          y="15.05"
          width="6.56992"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter2_d_13703_17928)">
        <rect x="14.0107" y="6.79297" width="6" height="5" fill="#9DD194" />
        <rect
          x="14.0607"
          y="6.84297"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter3_d_13703_17928)">
        <rect x="53.0894" y="10.731" width="6" height="5" fill="#84CFFF" />
        <rect
          x="53.1394"
          y="10.781"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter4_d_13703_17928)">
        <rect x="62.0894" y="10.731" width="6" height="5" fill="#84CFFF" />
        <rect
          x="62.1394"
          y="10.781"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter5_d_13703_17928)">
        <rect x="71.0894" y="10.731" width="6" height="5" fill="#84CFFF" />
        <rect
          x="71.1394"
          y="10.781"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter6_d_13703_17928)">
        <rect x="47.5449" y="29.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="47.5949"
          y="29.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter7_d_13703_17928)">
        <rect x="55.5449" y="29.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="55.5949"
          y="29.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter8_d_13703_17928)">
        <rect x="63.5449" y="29.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="63.5949"
          y="29.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter9_d_13703_17928)">
        <rect x="71.5449" y="29.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="71.5949"
          y="29.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter10_d_13703_17928)">
        <rect x="71.5449" y="35.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="71.5949"
          y="35.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter11_d_13703_17928)">
        <rect x="63.5449" y="35.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="63.5949"
          y="35.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter12_d_13703_17928)">
        <rect x="55.5449" y="35.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="55.5949"
          y="35.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter13_d_13703_17928)">
        <rect x="47.5449" y="35.2566" width="6" height="5" fill="#F16F6F" />
        <rect
          x="47.5949"
          y="35.3066"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter14_d_13703_17928)">
        <rect x="22.0107" y="6.79297" width="6" height="5" fill="#9DD194" />
        <rect
          x="22.0607"
          y="6.84297"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <line
        x1="5.04297"
        y1="25.9557"
        x2="79.8418"
        y2="25.9557"
        stroke="#A7A7A7"
        stroke-width="0.3"
      />
      <line
        x1="42.2047"
        y1="6.34009"
        x2="42.2047"
        y2="44.5148"
        stroke="#A7A7A7"
        stroke-width="0.3"
      />
      <g filter="url(#filter15_d_13703_17928)">
        <rect x="6.21729" y="29.7986" width="6" height="5" fill="#FFC46B" />
        <rect
          x="6.26729"
          y="29.8486"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter16_d_13703_17928)">
        <rect x="14.4321" y="33.8223" width="6" height="5" fill="#FFC46B" />
        <rect
          x="14.4821"
          y="33.8723"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter17_d_13703_17928)">
        <rect x="22.4795" y="30.9722" width="6" height="5" fill="#FFC46B" />
        <rect
          x="22.5295"
          y="31.0222"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
      <g filter="url(#filter18_d_13703_17928)">
        <rect x="25.4971" y="39.0195" width="6" height="5" fill="#FFC46B" />
        <rect
          x="25.5471"
          y="39.0695"
          width="5.9"
          height="4.9"
          stroke="black"
          stroke-opacity="0.1"
          stroke-width="0.1"
        />
      </g>
    </g>
    <defs>
      <filter
        id="filter0_d_13703_17928"
        x="-13.1272"
        y="-12.345"
        width="44.9458"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter1_d_13703_17928"
        x="-13.1272"
        y="-4.13793"
        width="44.9458"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter2_d_13703_17928"
        x="-5.12719"
        y="-12.345"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter3_d_13703_17928"
        x="33.9514"
        y="-8.40697"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter4_d_13703_17928"
        x="42.9514"
        y="-8.40697"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter5_d_13703_17928"
        x="51.9514"
        y="-8.40697"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter6_d_13703_17928"
        x="28.407"
        y="10.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter7_d_13703_17928"
        x="36.407"
        y="10.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter8_d_13703_17928"
        x="44.407"
        y="10.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter9_d_13703_17928"
        x="52.407"
        y="10.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter10_d_13703_17928"
        x="52.407"
        y="16.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter11_d_13703_17928"
        x="44.407"
        y="16.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter12_d_13703_17928"
        x="36.407"
        y="16.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter13_d_13703_17928"
        x="28.407"
        y="16.1187"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter14_d_13703_17928"
        x="2.87281"
        y="-12.345"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter15_d_13703_17928"
        x="-12.9206"
        y="10.6607"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter16_d_13703_17928"
        x="-4.7058"
        y="14.6843"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter17_d_13703_17928"
        x="3.34156"
        y="11.8342"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <filter
        id="filter18_d_13703_17928"
        x="6.35914"
        y="19.8816"
        width="44.2759"
        height="43.2759"
        filterUnits="userSpaceOnUse"
        color-interpolation-filters="sRGB"
      >
        <feFlood flood-opacity="0" result="BackgroundImageFix" />
        <feColorMatrix
          in="SourceAlpha"
          type="matrix"
          values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
          result="hardAlpha"
        />
        <feOffset />
        <feGaussianBlur stdDeviation="9.56896" />
        <feComposite in2="hardAlpha" operator="out" />
        <feColorMatrix
          type="matrix"
          values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.18 0"
        />
        <feBlend
          mode="normal"
          in2="BackgroundImageFix"
          result="effect1_dropShadow_13703_17928"
        />
        <feBlend
          mode="normal"
          in="SourceGraphic"
          in2="effect1_dropShadow_13703_17928"
          result="shape"
        />
      </filter>
      <clipPath id="clip0_13703_17928">
        <rect width="85" height="50" fill="white" />
      </clipPath>
    </defs>`}
  </svg>
`,cJ=t=>b`
  <svg
    width="28"
    height="28"
    viewBox="0 0 28 28"
    fill="none"
    style=${t?"width: 26px; height: 26px; top: 0; left: 0; transform: translate(37px, 31px); transition: transform .2s;":"width: 26px; height: 26px; top: 0; left: 0; transform: translate(37px, 64px); transition: transform .2s;"}
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect width="28" height="28" rx="14" fill="black" fill-opacity="0.1" />
    <g clip-path="url(#clip0_5974_1841)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M19.5804 10.9697C19.8733 11.2626 19.8733 11.7374 19.5804 12.0303L14.5804 17.0303C14.2875 17.3232 13.8126 17.3232 13.5197 17.0303L8.51972 12.0303C8.22683 11.7374 8.22683 11.2626 8.51972 10.9697C8.81261 10.6768 9.28749 10.6768 9.58038 10.9697L14.05 15.4393L18.5197 10.9697C18.8126 10.6768 19.2875 10.6768 19.5804 10.9697Z"
        fill="#77757D"
      />
    </g>
    <defs>
      <clipPath id="clip0_5974_1841">
        <rect width="24" height="24" fill="white" transform="translate(2 2)" />
      </clipPath>
    </defs>
  </svg>
`;function dJ(t){return b`
    ${lJ(t)} ${aJ(t)}
    ${sJ(t)} ${cJ(t)}
  `}const uJ=b`
  <svg
    width="85"
    height="50"
    viewBox="0 0 85 50"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect width="85" height="50" fill="white" />
    <line
      x1="16"
      y1="31.8907"
      x2="22"
      y2="31.8907"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <line
      x1="16"
      y1="31.8907"
      x2="22"
      y2="31.8907"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M33 31H36.1325V22.8918V19.0001L40 19"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M52 19H64.1883V13V10L68 10.0001"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M29 31H35.8083L35.8089 36.8873V39.9999L40 40"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <path
      d="M62 19H64.685V24.9999V27.9999L68 28"
      stroke="#6B6B6B"
      stroke-width="0.218649"
    />
    <rect x="40" y="36" width="12" height="7" rx="0.728829" fill="#9DD194" />
    <rect
      x="40.0364"
      y="36.0364"
      width="11.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="3" y="28" width="13" height="6" rx="0.728829" fill="#FFDE6B" />
    <rect
      x="3.03644"
      y="28.0364"
      width="12.9271"
      height="5.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect
      x="54.7686"
      y="19.1265"
      width="6.22715"
      height="6.22715"
      transform="rotate(-45 54.7686 19.1265)"
      fill="#937EE7"
    />
    <rect
      x="54.8201"
      y="19.1265"
      width="6.15427"
      height="6.15427"
      transform="rotate(-45 54.8201 19.1265)"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect
      x="21.4038"
      y="30.8835"
      width="6.22715"
      height="6.22715"
      transform="rotate(-45 21.4038 30.8835)"
      fill="#937EE7"
    />
    <rect
      x="21.4553"
      y="30.8835"
      width="6.15427"
      height="6.15427"
      transform="rotate(-45 21.4553 30.8835)"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="40" y="16" width="12" height="7" rx="0.728829" fill="#FFDE6B" />
    <rect
      x="40.0364"
      y="16.0364"
      width="11.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="68" y="8" width="13" height="6" rx="0.728829" fill="#937EE7" />
    <rect
      x="68.0364"
      y="8.03644"
      width="12.9271"
      height="5.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
    <rect x="68" y="24" width="13" height="7" rx="0.728829" fill="#937EE7" />
    <rect
      x="68.0364"
      y="24.0364"
      width="12.9271"
      height="6.92712"
      rx="0.692388"
      stroke="black"
      stroke-opacity="0.1"
      stroke-width="0.0728829"
    />
  </svg>
`;function hJ(t){const e=new WeakMap,n=i=>{if(typeof i!="object"||i===null)return i;if(e.has(i))return e.get(i);const r=Array.isArray(i)?[]:{};return e.set(i,r),Object.keys(i).forEach(o=>{r[o]=n(i[o])}),r};return n(t)}var pJ=Object.defineProperty,fJ=Object.getOwnPropertyDescriptor,al=(t,e,n,i)=>{for(var r=i>1?void 0:i?fJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&pJ(e,n,r),r};let Di=class extends me(Ae){constructor(){super(...arguments),this._currentCategory="",this._loadingTemplate=null,this._searchKeyword="",this._loading=!1,this._categories=[],this._templates=[],this._fetchJob=null}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",at,!1),this._disposables.add(()=>{this._currentCategory&&this.edgeless.service.editSession.setItem("templateCache",this._currentCategory)})}firstUpdated(){Eo(()=>{this._disposables.addFromEvent(document,"click",t=>{this.contains(t.target)||this._closePanel()})},this),this._disposables.addFromEvent(this,"click",at),this._disposables.addFromEvent(this,"wheel",at),this._initCategory().catch(()=>{})}async _initCategory(){try{this._categories=await Di.templates.categories(),this._currentCategory=this._getLocalSelectedCategory()??this._categories[0],this._updateTemplates()}catch(t){console.error("Failed to load categories",t)}}_fetch(t){this._fetchJob&&this._fetchJob.cancel(),this._loading=!0;const e={canceled:!1},n={cancel:()=>{e.canceled=!0}};this._fetchJob=n,t(e).catch(()=>{}).finally(()=>{!e.canceled&&n===this._fetchJob&&(this._loading=!1,this._fetchJob=null)})}_updateTemplates(){this._fetch(async t=>{try{const e=this._searchKeyword?await Di.templates.search(this._searchKeyword):await Di.templates.list(this._currentCategory);if(t.canceled)return;this._templates=e}catch(e){if(t.canceled)return;console.error("Failed to load templates",e)}})}_getLocalSelectedCategory(){return this.edgeless.service.editSession.getItem("templateCache")}_createTemplateJob(t){const e=[],n=this.edgeless.service;if(t==="template"){const i=U1(n.blocks.map(o=>ne.deserialize(o.xywh)).concat(n.elements));i&&(i.x+=i.w+20/n.viewport.zoom,e.push(eJ(i)));const r=n.layer.createIndexGenerator(!0);e.push(nJ(o=>r(o)))}return t==="sticker"&&e.push(tJ(n.viewport.center,()=>n.layer.generateIndex("affine:image"))),e.push(JQ),this.edgeless.surface.service.TemplateJob.create({model:this.edgeless.surfaceBlockModel,type:t,middlewares:e})}async _insertTemplate(t){this._loadingTemplate=t,t=hJ(t);const e=this._createTemplateJob(t.type),n=this.edgeless.service;try{const{assets:i}=t;i&&await Promise.all(Object.entries(i).map(([o,s])=>fetch(s).then(a=>a.blob()).then(a=>e.job.assets.set(o,a))));const r=await e.insertTemplate(t.content);if(r&&t.type==="template"){const o=20/n.viewport.zoom;n.viewport.setViewportByBound(r,[o,o,o,o],!0)}}finally{this._loadingTemplate=null,this._closePanel()}}_closePanel(){this.dispatchEvent(new CustomEvent("closepanel"))}_updateSearchKeyword(t){this._searchKeyword=t.target.value,this._updateTemplates()}render(){const{_categories:t,_currentCategory:e,_templates:n}=this;return b`
      <div class="edgeless-templates-panel">
        <div class="search-bar">
          <input
            class="search-input"
            type="text"
            placeholder="Search file or anything..."
            @input=${this._updateSearchKeyword}
          />
        </div>
        <div class="template-categories">
          ${Fe(t,i=>i,i=>b`<div
                class="category-entry ${e===i?"selected":""}"
                @click=${()=>{this._currentCategory=i,this._updateTemplates()}}
              >
                ${i}
              </div>`)}
        </div>
        <div class="template-list">
          ${this._loading?b`<affine-template-loading
                style=${we({position:"absolute",left:"50%",top:"50%"})}
              ></affine-template-loading>`:Fe(n,i=>i.name,i=>b`
                    <div
                      class=${`template-item ${i===this._loadingTemplate?"loading":""}`}
                      data-hover-text="Add"
                      @click=${()=>this._insertTemplate(i)}
                    >
                      ${i.preview?b`<img
                            src="${i.preview}"
                            class="template-preview"
                          />`:uJ}
                      ${i===this._loadingTemplate?b`<affine-template-loading></affine-template-loading>`:ae}
                      ${i.name?b`<affine-tooltip .offset=${12} tip-position="top">
                            ${i.name}
                          </affine-tooltip>`:ae}
                    </div>
                  `)}
        </div>
        <div class="arrow">${oJ}</div>
      </div>
    `}};Di.templates=rJ;Di.styles=X`
    :host {
      position: absolute;
      font-family: var(--affine-font-family);
      z-index: 1;
    }

    .edgeless-templates-panel {
      width: 467px;
      height: 568px;
      border-radius: 12px;
      background-color: var(--affine-background-overlay-panel-color);
      box-shadow: 0px 10px 80px 0px rgba(0, 0, 0, 0.2);

      display: flex;
      flex-direction: column;
    }

    .search-bar {
      padding: 21px 24px;
      font-size: 18px;
      color: var(--affine-secondary);
      border-bottom: 1px solid var(--affine-divider-color);

      flex-shrink: 0;
    }

    .search-input {
      border: 0;
      color: var(--affine-text-primary-color);
      font-size: 20px;
      background-color: inherit;
      outline: none;
      width: 100%;
    }

    .search-input::placeholder {
      color: var(--affine-text-secondary-color);
    }

    .template-categories {
      display: flex;
      padding: 6px 8px;
      gap: 4px;
      overflow-x: scroll;

      flex-shrink: 0;
    }

    .category-entry {
      color: var(--affine-text-primary-color);
      font-size: 12px;
      font-weight: 600;
      line-height: 20px;
      border-radius: 8px;
      flex-shrink: 0;
      flex-grow: 0;
      width: fit-content;
      padding: 4px 9px;
      cursor: pointer;
    }

    .category-entry.selected,
    .category-entry:hover {
      color: var(--affine-text-primary-color);
      background-color: var(--affine-background-tertiary-color);
    }

    .template-list {
      padding: 10px;
      display: flex;
      align-items: flex-start;
      align-content: flex-start;
      gap: 10px 20px;
      flex-wrap: wrap;

      flex-grow: 1;
      overflow-y: scroll;
    }

    .template-item {
      position: relative;
      width: 135px;
      height: 80px;
      box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.02);
      background-color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }

    .template-item > svg {
      display: block;
      margin: 0 auto;
      transform: translateY(20%);
    }

    .template-item:hover::before {
      content: attr(data-hover-text);
      position: absolute;
      display: block;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 110px;
      border-radius: 8px;
      padding: 4px 22px;
      box-sizing: border-box;
      z-index: 1;
      text-align: center;
      font-size: 12px;

      background-color: var(--affine-primary-color);
      color: var(--affine-white);
    }

    .template-item:hover::after {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      border: 1px solid var(--affine-black-10);
      border-radius: 4px;
      background-color: var(--affine-hover-color);
    }

    .template-item.loading::before {
      display: none;
    }

    .template-item.loading > affine-template-loading {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .template-item img.template-preview {
      object-fit: contain;
      width: 100%;
      height: 100%;
      display: block;
    }

    .arrow {
      bottom: 0;
      position: absolute;
      transform: translateY(20px);
      color: var(--affine-background-overlay-panel-color);
    }
  `;al([ie()],Di.prototype,"_currentCategory",2);al([ie()],Di.prototype,"_loadingTemplate",2);al([ie()],Di.prototype,"_searchKeyword",2);al([ie()],Di.prototype,"_loading",2);al([ie()],Di.prototype,"_categories",2);al([ie()],Di.prototype,"_templates",2);al([L({attribute:!1})],Di.prototype,"edgeless",2);Di=al([W("edgeless-templates-panel")],Di);var gJ=Object.defineProperty,mJ=Object.getOwnPropertyDescriptor,Ab=(t,e,n,i)=>{for(var r=i>1?void 0:i?mJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&gJ(e,n,r),r};let Kh=class extends me(Ae){constructor(){super(...arguments),this._openedPanel=null,this._cleanup=null}_togglePanel(){if(this._openedPanel){this._closePanel();return}const t=document.createElement("edgeless-templates-panel");t.edgeless=this.edgeless,this._cleanup=Gd(t,"closepanel",()=>{this._closePanel()}),this._openedPanel=t,this.renderRoot.appendChild(t),requestAnimationFrame(()=>{const e=t.renderRoot.querySelector(".arrow");zl(this,t,()=>{ii(this,t,{placement:"top",middleware:[Dt(20),lk({element:e}),tr()]}).then(({x:n,y:i,middlewareData:r})=>{t.style.left=`${n}px`,t.style.top=`${i}px`,e.style.left=`${(r.arrow?.x??0)-(r.shift?.x??0)}px`}).catch(n=>{console.warn("Can't compute position",n)})})})}_closePanel(){this._openedPanel&&(this._openedPanel.remove(),this._openedPanel=null,this._cleanup?.(),this._cleanup=null,this.requestUpdate())}_renderIcon(t){return b`<div class="icon">${dJ(t)}</div>`}render(){const t=this._openedPanel!==null;return b`<edgeless-toolbar-button @click=${this._togglePanel}>
      ${this._renderIcon(t)}
    </edgeless-toolbar-button>`}};Kh.styles=X`
    :host {
      position: relative;
    }

    edgeless-template-button {
      cursor: pointer;
    }

    .icon {
      width: 102px;
      height: 64px;
      overflow: hidden;
      position: relative;
      color: var(--affine-background-primary-color);
    }
  `;Ab([L({attribute:!1})],Kh.prototype,"edgeless",2);Ab([L({attribute:!1})],Kh.prototype,"setEdgelessTool",2);Kh=Ab([W("edgeless-template-button")],Kh);function I3(t){const e=new Set;return t.forEach(n=>{n instanceof On?n.decendants().forEach(i=>e.add(i)):e.add(n)}),Array.from(e)}function Xr(t){return!!t&&"flavour"in t}function Gn(t){return!!t&&"flavour"in t&&t.flavour==="affine:note"}function nr(t){return!!t&&"flavour"in t&&t.flavour==="affine:frame"}function hs(t){return!!t&&"flavour"in t&&t.flavour==="affine:image"}function vi(t){return!!t&&"flavour"in t&&t.flavour==="affine:bookmark"}function u2(t){return!!t&&"flavour"in t&&/affine:embed-*/.test(t.flavour)}function ed(t){return!!t&&"flavour"in t&&t.flavour==="affine:embed-github"}function kM(t){return!!t&&"flavour"in t&&t.flavour==="affine:embed-youtube"}function EM(t){return!!t&&"flavour"in t&&t.flavour==="affine:embed-figma"}function Ki(t){return!!t&&"flavour"in t&&t.flavour==="affine:embed-linked-doc"}function _0(t){return!Xr(t)}function C6(t){return t instanceof vn||t instanceof Ct}function SM(t){return!!t&&t.connectable}function bJ(t){switch(t.type){case"default":return"default";case"pan":return t.panning?"grabbing":"grab";case"brush":case"eraser":case"shape":case"connector":case"frame":return"crosshair";case"text":return"text";default:return"default"}}function $b(t,e){const n=t<.5?2:1/(Math.floor(t)||1);return{gap:Zr(20*n*t,FD,UD),grid:e?"radial-gradient(var(--affine-edgeless-grid-color) 1px, var(--affine-background-primary-color) 1px)":"unset"}}function ec(t){if(t.length===0)return new DOMRect;if(t.length===1){const[e,n,i,r]=Wn(t[0].xywh);return new DOMRect(e,n,i,r)}return I3(t).reduce((e,n,i)=>{const r=Xr(n)?0:n.rotate,[o,s,a,l]=Wn(n.xywh);let{left:c,top:d,right:u,bottom:h}=Og({x:o,y:s,w:a,h:l,rotate:r});return i!==0&&(c=Math.min(c,e.left),d=Math.min(d,e.top),u=Math.max(u,e.right),h=Math.max(h,e.bottom)),e.x=c,e.y=d,e.width=u-c,e.height=h-d,e},new DOMRect)}function vJ(t){const e=new Map;return I3(t).forEach(n=>{const i=ne.deserialize(n.xywh);e.set(n.id,{bound:i,rotate:n.rotate})}),e}var yJ=Object.defineProperty,wJ=Object.getOwnPropertyDescriptor,ou=(t,e,n,i)=>{for(var r=i>1?void 0:i?wJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&yJ(e,n,r),r};let Ps=class extends me(Ae){constructor(t){super(),this._navigatorMode="fit",this._hideToolbar=!1,this._mouseOnToolbar=!0,this.settingMenuShow=!1,this._currentFrameIndex=0,this._timer=null,this._cachedIndex=-1,this.setEdgelessTool=e=>{this.edgeless.tools.setEdgelessTool(e)},this._imageLoading=!1,this.edgeless=t}get _frames(){return this.edgeless.service.frames}get host(){return this.edgeless.host}get edgelessTool(){return this.edgeless.edgelessTool}async _addImages(){this._imageLoading=!0;const t=await R2();await this.edgeless.addImages(t),this._imageLoading=!1}_nextFrame(){const t=this._frames,e=0,n=t.length-1;this._currentFrameIndex===t.length-1?kt(this.host,"You have reached the last frame"):this._currentFrameIndex=Zr(this._currentFrameIndex+1,e,n)}_previousFrame(){const t=this._frames,e=0,n=t.length-1;this._currentFrameIndex===0?kt(this.host,"You have reached the first frame"):this._currentFrameIndex=Zr(this._currentFrameIndex-1,e,n)}_canHideToolbar(){const{type:t}=this.edgelessTool;return t==="frameNavigator"&&this._hideToolbar&&!this._mouseOnToolbar&&!this.settingMenuShow}_tryLoadNavigatorStateLocalRecord(){this._navigatorMode=this.edgeless.service.editSession.getItem("presentFillScreen")===!0?"fill":"fit"}firstUpdated(){const{_disposables:t,edgeless:e}=this,{slots:n,page:i}=e;this._hideToolbar=!!this.edgeless.service.editSession.getItem("presentHideToolbar"),e.bindHotKey({ArrowLeft:()=>{const{type:r}=this.edgelessTool;r==="frameNavigator"&&this._previousFrame()},ArrowRight:()=>{const{type:r}=this.edgelessTool;r==="frameNavigator"&&this._nextFrame()}},{global:!0}),t.add(n.edgelessToolUpdated.on(r=>{r.type==="frameNavigator"&&(this._cachedIndex=this._currentFrameIndex,this._navigatorMode=r.mode??this._navigatorMode,nr(e.service.selection.elements[0])&&(this._cachedIndex=this._frames.findIndex(o=>o.id===e.service.selection.elements[0].id)),this._frames.length===0&&kt(this.host,"The presentation requires at least 1 frame. You can firstly create a frame.",5e3),this._toggleFullScreen()),this.requestUpdate()})),t.add(i.slots.blockUpdated),t.add(e.service.viewport.viewportUpdated.on(()=>this.requestUpdate())),t.add(e.slots.readonlyUpdated.on(()=>{this.requestUpdate()})),t.add(this.edgeless.slots.navigatorSettingUpdated.on(({hideToolbar:r,fillScreen:o})=>{r!==void 0&&r!==this._hideToolbar&&(this._hideToolbar=r),o!==void 0&&(this._navigatorMode=o?"fill":"fit")})),this._tryLoadNavigatorStateLocalRecord()}_moveToCurrentFrame(){const t=this._currentFrameIndex,e=this.edgeless.service.viewport,n=this._frames[t];if(n){let i=ne.deserialize(n.xywh);if(this._navigatorMode==="fill"){const r=e.viewportBounds,o=i.center;let s,a;r.w/r.h>i.w/i.h?(s=i.w,a=s*r.h/r.w):(a=i.h,s=a*r.w/r.h),i=ne.fromCenter(o,s,a)}e.setViewportByBound(i,[0,0,0,0],!1),this.edgeless.slots.navigatorFrameChanged.emit(this._frames[this._currentFrameIndex])}}updated(t){const{type:e}=this.edgelessTool;t.has("_currentFrameIndex")&&e==="frameNavigator"&&this._moveToCurrentFrame(),t.has("_hideToolbar")&&(this.edgeless.slots.navigatorSettingUpdated.emit({hideToolbar:this._hideToolbar}),this.edgeless.service.editSession.setItem("presentHideToolbar",this._hideToolbar))}_toggleFullScreen(){document.fullscreenElement?(this._timer&&clearTimeout(this._timer),document.exitFullscreen().catch(console.error)):(ZY(this.edgeless.viewportElement),this._timer=setTimeout(()=>{this._currentFrameIndex=this._cachedIndex},400)),setTimeout(()=>this._moveToCurrentFrame(),400),this.edgeless.slots.fullScrennToggled.emit()}get _FrameNavigator(){const t=this._currentFrameIndex,e=this._frames,n=e[t],{page:i}=this.edgeless;return b`
      <edgeless-tool-icon-button
        .tooltip=${"Previous"}
        @click=${()=>this._previousFrame()}
      >
        ${ZT}
      </edgeless-tool-icon-button>
      <div class="edgeless-frame-navigator">
        <span
          class="edgeless-frame-navigator-title"
          @click=${()=>this._currentFrameIndex=this._currentFrameIndex+0}
          >${n?.title??"no frame"}</span
        >
        <span class="edgeless-frame-navigator-count"
          >${e.length===0?0:t+1}/${e.length}</span
        >
      </div>
      <edgeless-tool-icon-button
        .tooltip=${"Next"}
        @click=${()=>this._nextFrame()}
      >
        ${WT}
      </edgeless-tool-icon-button>
      <div class="short-divider"></div>
      <edgeless-frame-order-button
        .frames=${this._frames}
        .edgeless=${this.edgeless}
      >
      </edgeless-frame-order-button>
      <edgeless-tool-icon-button
        .tooltip=${document.fullscreenElement?"Exit Full Screen":"Enter Full Screen"}
        @click=${()=>{this._toggleFullScreen()}}
      >
        ${document.fullscreenElement?YT:qT}
      </edgeless-tool-icon-button>
      <edgeless-navigator-setting-button
        .edgeless=${this.edgeless}
        .hideToolbar=${this._hideToolbar}
        .onHideToolbarChange=${r=>{this._hideToolbar=r}}
        .popperShow=${this.settingMenuShow}
        .setPopperShow=${r=>{this.settingMenuShow=r}}
      >
      </edgeless-navigator-setting-button>
      <div class="short-divider"></div>
      <div
        class="edgeless-frame-navigator-stop"
        @click=${()=>{this.setEdgelessTool(i.readonly?{type:"pan",panning:!1}:{type:"default"}),document.fullscreenElement&&this._toggleFullScreen(),setTimeout(()=>this._moveToCurrentFrame(),400)}}
      >
        Stop
      </div>
    `}_Tools(){const{edgelessTool:t}=this.edgeless,{type:e}=t;return b`
      <div class="full-divider"></div>
      <div class="brush-and-eraser">
        <edgeless-brush-tool-button
          .edgeless=${this.edgeless}
          .active=${e==="brush"}
        ></edgeless-brush-tool-button>
        <edgeless-eraser-tool-button
          .edgelessTool=${this.edgelessTool}
          .edgeless=${this.edgeless}
          .setEdgelessTool=${this.setEdgelessTool}
        ></edgeless-eraser-tool-button>
      </div>
      <div class="edgeless-toolbar-right-part">
        <edgeless-shape-tool-button
          .edgeless=${this.edgeless}
          .active=${e==="shape"}
        ></edgeless-shape-tool-button>
        <edgeless-text-tool-button
          .edgeless=${this.edgeless}
          .active=${e==="text"}
        >
          ${U9}
        </edgeless-text-tool-button>
        <edgeless-toolbar-button
          class="transform-button"
          .disabled=${this._imageLoading}
          .activeMode=${"background"}
          .tooltip=${"Image"}
          .tooltipOffset=${12}
          @click=${()=>this._addImages()}
        >
          ${UI}
        </edgeless-toolbar-button>
        <edgeless-template-button .edgeless=${this.edgeless}>
        </edgeless-template-button>
      </div>
    `}get _DefaultContent(){const{page:t,edgelessTool:e}=this.edgeless,{type:n}=e;return b`<div class="edgeless-toolbar-left-part">
        <edgeless-default-tool-button
          .edgelessTool=${this.edgelessTool}
          .edgeless=${this.edgeless}
          .setEdgelessTool=${this.setEdgelessTool}
        ></edgeless-default-tool-button>

        <edgeless-connector-tool-button
          .edgeless=${this.edgeless}
          .active=${n==="connector"}
        ></edgeless-connector-tool-button>

        ${t.readonly?ae:b` <edgeless-frame-tool-button
              .edgelessTool=${this.edgelessTool}
              .setEdgelessTool=${this.setEdgelessTool}
              .edgeless=${this.edgeless}
            ></edgeless-frame-tool-button>`}

        <edgeless-tool-icon-button
          .tooltip=${"Present"}
          .tooltipOffset=${17}
          .iconContainerPadding=${8}
          @click=${()=>{this.setEdgelessTool({type:"frameNavigator",mode:this._navigatorMode})}}
        >
          ${GT}
        </edgeless-tool-icon-button>
      </div>

      ${t.readonly?ae:b`
            <div class="short-divider"></div>
            <edgeless-note-tool-button
              .edgeless=${this.edgeless}
              .active=${n==="affine:note"}
            ></edgeless-note-tool-button>
          `}
      ${this._Tools()} `}render(){const{type:t}=this.edgelessTool;if(this.edgeless.page.readonly&&t!=="frameNavigator")return ae;const e=t==="frameNavigator"?this._FrameNavigator:this._DefaultContent;return b`
      <style>
        .edgeless-toolbar-container {
          top: ${this._canHideToolbar()?"100px":"0px"};
        }
      </style>
      ${this.edgeless.edgelessTool.type==="frameNavigator"&&this._hideToolbar&&!this._mouseOnToolbar?b`<div
            class="edgeless-toolbar-container-placeholder"
            @mouseenter=${()=>this._mouseOnToolbar=!0}
          ></div>`:ae}
      <div
        class="edgeless-toolbar-container"
        @dblclick=${at}
        @mousedown=${at}
        @pointerdown=${at}
        @mouseenter=${()=>this._mouseOnToolbar=!0}
        @mouseleave=${()=>this._mouseOnToolbar=!1}
      >
        ${e}
      </div>
    `}};Ps.styles=X`
    :host {
      user-select: none;
      font-family: ${Je(vt.fontSansFamily)};
      position: absolute;
      z-index: 1;
      left: calc(50%);
      transform: translateX(-50%);
      bottom: 28px;
    }

    .edgeless-toolbar-container-placeholder {
      position: absolute;
      width: 463px;
      height: 66px;
      border-radius: 40px;
      background-color: transparent;
    }

    .edgeless-toolbar-container {
      position: relative;
      display: flex;
      align-items: center;
      flex-direction: row;
      padding: 0 20px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border: 1px solid var(--affine-border-color);
      border-radius: 40px;
      height: 64px;
      transition: 0.5s ease-in-out;
    }
    .edgeless-toolbar-container[level='second'] {
      position: absolute;
      bottom: 8px;
      transform: translateY(-100%);
    }
    .edgeless-toolbar-container[hidden] {
      display: none;
    }
    .edgeless-toolbar-left-part {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .short-divider {
      width: 1px;
      height: 24px;
      margin: 0 10px;
      background-color: var(--affine-border-color);
    }
    .full-divider {
      width: 1px;
      height: 100%;
      margin: 0 12px;
      background-color: var(--affine-border-color);
    }
    .brush-and-eraser {
      display: flex;
      margin-left: 8px;
    }
    .edgeless-toolbar-right-part {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-left: 12px;
    }
    .transform-button svg {
      transition: 0.3s ease-in-out;
    }
    .transform-button:hover svg {
      transform: scale(1.15);
    }

    .edgeless-frame-navigator {
      width: 145px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .edgeless-frame-navigator-title {
      display: inline-block;
      cursor: pointer;
      color: #424149;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      margin-right: 8px;
    }

    .edgeless-frame-navigator-count {
      color: #8e8d91;
    }
    .edgeless-frame-navigator-stop {
      background: #eb4335;
      color: #ffffff;
      box-shadow: 0px 1px 2px 0px #ffffff40 inset;
      padding: 4px 10px;
      border-radius: 8px;
      cursor: pointer;
    }
  `;ou([ie()],Ps.prototype,"_navigatorMode",2);ou([ie()],Ps.prototype,"_hideToolbar",2);ou([ie()],Ps.prototype,"_mouseOnToolbar",2);ou([ie()],Ps.prototype,"settingMenuShow",2);ou([ie({hasChanged(){return!0}})],Ps.prototype,"_currentFrameIndex",2);Ps=ou([W("edgeless-toolbar")],Ps);var xJ=Object.defineProperty,_J=Object.getOwnPropertyDescriptor,L3=(t,e,n,i)=>{for(var r=i>1?void 0:i?_J(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&xJ(e,n,r),r};const s_=4,CJ=40,kJ=.75,EJ=X`
  :host {
    display: flex;
  }

  .note-slicer-container {
    display: flex;
  }

  .note-slicer-button {
    position: absolute;
    top: 0;
    right: 0;
    display: flex;
    box-sizing: border-box;
    border-radius: 4px;
    justify-content: center;
    align-items: center;
    color: var(--affine-icon-color);
    border: 1px solid var(--affine-border-color);
    background-color: var(--affine-white);
    box-shadow:
      0px 0px 12px 0px rgba(66, 65, 73, 0.14),
      0px 0px 0px 0.5px #e3e3e4 inset;
    cursor: pointer;
    width: 24px;
    height: 24px;
    transform-origin: left top;
    z-index: var(--affine-z-index-popover);
    opacity: 0;
    transition: opacity 150ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  .note-slicer-dividing-line {
    display: block;
    position: absolute;
    left: 0;
    top: 0;
    height: 1px;
    z-index: var(--affine-z-index-popover);
    background-image: linear-gradient(
      to right,
      var(--affine-black-10) 50%,
      transparent 50%
    );
    background-size: 4px 100%;
  }
  .note-slicer-dividing-line.active {
    background-image: linear-gradient(
      to right,
      var(--affine-black-60) 50%,
      transparent 50%
    );
    animation: slide 0.3s linear infinite;
  }
  @keyframes slide {
    0% {
      background-position: 0 0;
    }
    100% {
      background-position: -4px 0;
    }
  }
`;let td=class extends me(Ae){constructor(){super(...arguments),this.anchorNote=null,this._activeSlicerIndex=0,this._hidden=!1,this._divingLinePositions=[],this._noteBlockIds=[],this._noteDisposables=null}get _editorHost(){return this.edgeless.host}get _noteBlockElement(){if(!this._editorHost)return null;const t=this._editorHost.view.viewFromPath("block",qn(this.anchorNote));return t||null}get _notePortalElement(){return this._noteBlockElement?.closest(".edgeless-block-portal-note")}get _viewportOffset(){const{viewport:t}=this.edgeless;return{left:t.left??0,top:t.top??0}}get _selection(){return this.edgeless.service.selection}get _zoom(){return this.edgeless.service.viewport.zoom}_updateDivingLineAndBlockIds(){if(!this.anchorNote||!this._notePortalElement){this._divingLinePositions=[],this._noteBlockIds=[];return}const t=[],e=[],n=this._notePortalElement.getBoundingClientRect(),i=n.top,r=n.bottom;for(let o=0;o<this.anchorNote.children.length-1;o++){const s=this.anchorNote.children[o],a=this.edgeless.host.view.viewFromPath("block",qn(s))?.getBoundingClientRect();if(a&&a.bottom>i&&a.bottom<r){const l=a.x-this._viewportOffset.left,c=a.bottom+s_*this._zoom-this._viewportOffset.top;t.push(new je(l,c)),e.push(s.id)}}this._divingLinePositions=t,this._noteBlockIds=e}_updateActiveSlicerIndex(t){const{_divingLinePositions:e}=this,n=t.y+s_*this._zoom;let i=-1;for(let r=0;r<e.length;r++){const o=e[r].y,s=r>0?e[r-1].y:0,a=(o+s)/2;if(n<a)break;i++}i<0&&(i=0),this._activeSlicerIndex=i}connectedCallback(){if(super.connectedCallback(),!this.edgeless.service)return;this._updateDivingLineAndBlockIds();const{disposables:t}=this;t.add(this.edgeless.service.uiEventDispatcher.add("pointerMove",n=>{if(this._zoom<kJ)return;this._hidden&&(this._hidden=!1);const i=n.get("pointerState"),r=new je(i.x,i.y);this._updateActiveSlicerIndex(r)})),t.add(this.edgeless.service.viewport.viewportUpdated.on(()=>{this._hidden=!0,this.requestUpdate()}));const{surface:e}=this.edgeless;requestAnimationFrame(()=>{e.isConnected&&e.edgeless.dispatcher&&t.add(e.edgeless.dispatcher.add("click",n=>{const i=n.get("pointerState"),{raw:r}=i,o=r.target;return o&&o.closest("note-slicer")?(this._sliceNote(),!0):!1}))})}updated(t){super.updated(t),t.has("anchorNote")&&(this._noteDisposables?.dispose(),this._noteDisposables=null,this.anchorNote&&(this._noteDisposables=new dt,this._noteDisposables.add(this.anchorNote.propsUpdated.on(({key:e})=>{(e==="children"||e==="xywh")&&this.requestUpdate()}))))}firstUpdated(){this.edgeless.service&&this.disposables.add(this.edgeless.service.uiEventDispatcher.add("wheel",()=>{this._hidden=!0,this.requestUpdate()}))}disconnectedCallback(){super.disconnectedCallback(),this.disposables.dispose(),this._noteDisposables?.dispose(),this._noteDisposables=null}_sliceNote(){if(!this.anchorNote||!this._noteBlockIds.length)return;const t=this.edgeless.page,{index:e,xywh:n,background:i,children:r,displayMode:o}=this.anchorNote,s=this._noteBlockIds[this._activeSlicerIndex];if(!s)return;const a=r.findIndex(g=>g.id===s),l=r.slice(a+1),[c,,d]=Wn(n),u=this._divingLinePositions[this._activeSlicerIndex].y,h=this.edgeless.service.viewport.toModelCoord(c,u)[1],p=this.edgeless.service.addBlock("affine:note",{background:i,displayMode:o,xywh:wo(c,h+CJ,d,g0),index:e+1},t.root?.id);t.moveBlocks(l,t.getBlockById(p)),this._activeSlicerIndex=0,this._selection.set({elements:[p],editing:!1})}render(){if(!this.anchorNote||this._hidden)return ae;this._updateDivingLineAndBlockIds();const t=this._noteBlockElement;if(!t||!this._divingLinePositions.length)return ae;const n=xa(t).width,i=this._divingLinePositions[this._activeSlicerIndex];return b`<div class="note-slicer-container">
      <div
        class="note-slicer-button"
        style=${we({left:`${i.x-66*this._zoom}px`,top:`${i.y}px`,opacity:1,scale:`${this._zoom}`,transform:"translateY(-50%)"})}
      >
        ${AI}
      </div>
      ${this._divingLinePositions.map((r,o)=>{const s=Qe({"note-slicer-dividing-line":!0,active:o===this._activeSlicerIndex});return b`<div
          class=${s}
          style=${we({left:`${r.x}px`,top:`${r.y}px`,width:`${n}px`})}
        ></div>`})}
    </div> `}};td.styles=EJ;L3([L({attribute:!1})],td.prototype,"edgeless",2);L3([L({attribute:!1})],td.prototype,"anchorNote",2);L3([ie()],td.prototype,"_activeSlicerIndex",2);td=L3([W("note-slicer")],td);class Nl extends Bn{constructor(){super(...arguments),this.connectable=!0,this.rotate=0,this._externalXYWH=void 0}get externalXYWH(){return this._externalXYWH}set externalXYWH(e){this._externalXYWH=e}get externalBound(){return this._externalXYWH?ne.deserialize(this._externalXYWH):null}get elementBound(){const e=ne.deserialize(this.xywh);return ne.from(ks({...e,rotate:this.rotate}))}hitTest(e,n,i){return ne.deserialize(this.xywh).isPointInBound([e,n],0)}containedByBounds(e){const n=ne.deserialize(this.xywh);return Bt({x:n.x,y:n.y,w:n.w,h:n.h,rotate:this.rotate}).some(r=>e.containsPoint(r))}getNearestPoint(e){const n=ne.deserialize(this.xywh);return zd(bi(n.points,n.center,this.rotate??0),e)}intersectWithLine(e,n){const i=ne.deserialize(this.xywh);return Co(e,n,bi(i.points,i.center,this.rotate??0))}getRelativePointLocation(e){const n=ne.deserialize(this.xywh),i=n.getRelativePoint(e),r=bi([i],n.center,this.rotate??0)[0],o=bi(n.points,n.center,this.rotate??0),s=Jp(o,r);return new En(r,s)}boxSelect(e){return this.containedByBounds(e)||e.points.some((n,i,r)=>this.intersectWithLine(n,r[(i+1)%r.length]))}get group(){return this.page.getBlockByFlavour("affine:surface")[0]?.getGroup(this.id)??null}get groups(){return this.page.getBlockByFlavour("affine:surface")[0]?.getGroups(this.id)??[]}}function C0(t){if(t===Bn)return Nl;{let e=t;for(;Object.getPrototypeOf(e.prototype)!==Bn.prototype&&Object.getPrototypeOf(e.prototype)!==null;)e=Object.getPrototypeOf(e.prototype).constructor;if(Object.getPrototypeOf(e.prototype)===null)throw new Error("The SuperClass is not a subclass of BlockModel");Object.setPrototypeOf(e.prototype,Nl.prototype)}return t}const S1=_i({flavour:"affine:note",props:()=>({xywh:`[0,0,${oO},95]`,background:_3,index:"a0",hidden:!1,displayMode:qe.DocAndEdgeless,edgeless:{style:{borderRadius:8,borderSize:4,borderStyle:Yt.Solid,shadowType:Cb[1]}}}),metadata:{version:1,role:"hub",parent:["affine:page"],children:["affine:paragraph","affine:list","affine:code","affine:divider","affine:database","affine:data-view","affine:image","affine:note-block-*","affine:bookmark","affine:attachment","affine:surface-ref","affine:embed-*"]},toModel:()=>new s5});class s5 extends C0(Bn){_isSelectable(){return this.displayMode!==qe.DocOnly}hitTest(e,n){return this._isSelectable()?ne.deserialize(this.xywh).isPointInBound([e,n],0):!1}containedByBounds(e){return this._isSelectable()?super.containedByBounds(e):!1}boxSelect(e){return this._isSelectable()?super.boxSelect(e):!1}}var SJ=Object.defineProperty,TJ=Object.getOwnPropertyDescriptor,M3=(t,e,n,i)=>{for(var r=i>1?void 0:i?TJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&SJ(e,n,r),r};class Ys extends me(De){renderModel(e){return this.surface.host.renderModel(e)}connectedCallback(){super.connectedCallback(),this._disposables.add(this.model.propsUpdated.on(()=>{this.requestUpdate()}))}}M3([L({attribute:!1})],Ys.prototype,"index",2);M3([L({attribute:!1})],Ys.prototype,"model",2);M3([L({attribute:!1})],Ys.prototype,"surface",2);M3([L({attribute:!1})],Ys.prototype,"edgeless",2);var IJ=Object.defineProperty,LJ=Object.getOwnPropertyDescriptor,Qo=(t,e,n,i)=>{for(var r=i>1?void 0:i?LJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&IJ(e,n,r),r};const MJ=20;let Qh=class extends me(De){get edgeless(){return this.surface.edgeless}firstUpdated(){this._disposables.add(this.edgeless.service.selection.slots.updated.on(()=>{this.requestUpdate()}));const t=this.renderRoot.querySelector(".affine-note-mask"),e=new ResizeObserver(n=>{for(const i of n)if(!this.model.edgeless.collapse){const r=ne.deserialize(this.model.xywh),o=this.model.edgeless.scale??1,s=i.contentRect.height*o;if(lO(r.h,s))return;r.h=s,this.model.stash("xywh"),this.model.xywh=r.serialize()}});e.observe(t),this._disposables.add(()=>{this.model.page.getBlockById(this.model.id)&&this.model.pop("xywh"),e.disconnect()})}render(){const e={position:"absolute",top:"0",left:"0",bottom:"0",right:"0",zIndex:"1",pointerEvents:this.edgeless.service.selection.has(this.model.id)&&this.edgeless.service.selection.selections.some(n=>n.elements.includes(this.model.id)&&n.editing)?"none":"auto",borderRadius:`${this.model.edgeless.style.borderRadius*this.edgeless.service.viewport.zoom}px`};return b`
      <div class="affine-note-mask" style=${we(e)}></div>
    `}};Qh.styles=X`
    .affine-note-mask:hover {
      background-color: var(--affine-hover-color);
    }
  `;Qo([L({attribute:!1})],Qh.prototype,"surface",2);Qo([L({attribute:!1})],Qh.prototype,"model",2);Qh=Qo([W("edgeless-note-mask")],Qh);let As=class extends Ys{constructor(){super(...arguments),this._isSelected=!1,this._editing=!1,this._isResizing=!1,this._isHover=!1,this._noteFullHeight=0}_handleEditingTransition(){const t=this.edgeless.service.selection;this._disposables.add(t.slots.updated.on(e=>{t.has(this.model.id)&&e?.[0].editing?this._editing=!0:this._editing=!1}))}get _isShowCollapsedContent(){return this.model.edgeless.collapse&&(this._isResizing||this._isHover)}_hovered(){!this._isHover&&this.edgeless.service.selection.has(this.model.id)&&(this._isHover=!0)}_leaved(){this._isHover&&(this._isHover=!1)}_setCollapse(t){t.stopImmediatePropagation();const{collapse:e,collapsedHeight:n}=this.model.edgeless;if(e)this.model.page.updateBlock(this.model,()=>{this.model.edgeless.collapse=!1});else if(n){const{xywh:i,edgeless:r}=this.model,o=ne.deserialize(i);o.h=n*(r.scale??1),this.model.page.updateBlock(this.model,()=>{this.model.edgeless.collapse=!0,this.model.xywh=o.serialize()})}this.edgeless.service.selection.clear()}_collapsedContent(){if(!this._isShowCollapsedContent||!this._affineNote)return ae;const{xywh:t,edgeless:e}=this.model,n=ne.deserialize(t),i=e.scale??1,r=n.w/i,o=n.h/i,s=this._affineNote.getBoundingClientRect(),a=this.edgeless.service.viewport.zoom;return this._noteFullHeight=s.height/i/a+2*n2,o>=this._noteFullHeight?ae:b`
      <div
        style=${we({width:`${r}px`,height:`${this._noteFullHeight-o}px`,position:"absolute",left:"0px",top:`${o}px`,background:"var(--affine-white)",opacity:.5,pointerEvents:"none",borderLeft:"2px var(--affine-blue) solid",borderBottom:"2px var(--affine-blue) solid",borderRight:"2px var(--affine-blue) solid",borderRadius:"0 0 8px 8px"})}
      ></div>
    `}firstUpdated(){const{_disposables:t,edgeless:e}=this,n=this.edgeless.service.selection;this._handleEditingTransition(),t.add(e.slots.elementResizeStart.on(()=>{n.elements.includes(this.model)&&(this._isResizing=!0)})),t.add(e.slots.elementResizeEnd.on(()=>{this._isResizing=!1})),t.add(e.service.selection.slots.updated.on(()=>{this._isSelected=e.service.selection.has(this.model.id),this._isHover=this._isSelected&&e.tools.getHoverState()?.content===this.model}));const i=new MutationObserver(()=>{const r=this._affineNote;if(!this._affineNote)return;const o=r.getBoundingClientRect(),s=this.edgeless.service.viewport.zoom,a=this.model.edgeless.scale??1;this._noteFullHeight=o.height/a/s+2*n2});i.observe(this,{childList:!0,subtree:!0}),t.add(()=>i.disconnect())}render(){const{model:t,surface:e,index:n}=this,{displayMode:i}=t;if(i&&i===qe.DocOnly)return ae;const{xywh:r,background:o,edgeless:s}=t,{borderRadius:a,borderSize:l,borderStyle:c,shadowType:d}=s.style,{collapse:u,collapsedHeight:h,scale:p=1}=s,g=ne.deserialize(r),f=g.w/p,v=g.h/p,m={position:"absolute",zIndex:`${n}`,width:`${f}px`,height:u?`${v}px`:"inherit",left:`${g.x}px`,top:`${g.y}px`,padding:`${n2}px`,boxSizing:"border-box",borderRadius:a+"px",pointerEvents:"all",transformOrigin:"0 0",transform:`scale(${p})`},y=this._editing?MJ:0,x={position:"absolute",left:`${-y}px`,top:`${-y}px`,width:`${f+y*2}px`,height:`calc(100% + ${y*2}px)`,borderRadius:a+"px",transition:this._editing?"left 0.3s, top 0.3s, width 0.3s, height 0.3s":"none",background:`var(${o??_3})`,border:`${l}px ${c===Yt.Dashed?"dashed":c} var(--affine-black-10)`,boxShadow:this._editing?"var(--affine-active-shadow)":d?`var(${d})`:"none"},T=u!=null&&h!=null&&h!==this._noteFullHeight,M=u?this._noteFullHeight<v:!!h&&h<v;return b`
      <div
        class="edgeless-block-portal-note blocksuite-overlay"
        style=${we(m)}
        data-model-height="${g.h}"
        @mouseleave=${this._leaved}
        @mousemove=${this._hovered}
      >
        <div class="note-background" style=${we(x)}></div>

        <div
          style=${we({width:"100%",height:"100%",padding:"0 4px",overflow:this._isShowCollapsedContent?"initial":"hidden"})}
        >
          ${e.renderModel(t)}
        </div>

        ${T?b`<div
              class="${Qe({"edgeless-note-collapse-button":!0,flip:M,hide:this._isSelected})}"
              @mousedown=${k=>k.stopPropagation()}
              @mouseup=${k=>k.stopPropagation()}
              @click=${this._setCollapse}
            >
              ${rL}
            </div>`:ae}
        ${this._collapsedContent()}

        <edgeless-note-mask
          .surface=${e}
          .model=${this.model}
        ></edgeless-note-mask>
      </div>
    `}};As.styles=X`
    .edgeless-note-collapse-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      z-index: 2;
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0.2;
      transition: opacity 0.3s;
    }
    .edgeless-note-collapse-button:hover {
      opacity: 1;
    }
    .edgeless-note-collapse-button.flip {
      transform: translateX(-50%) rotate(180deg);
    }
    .edgeless-note-collapse-button.hide {
      display: none;
    }

    .edgeless-block-portal-note:has(.edgeless-note-collapse-button:hover) {
      .affine-note-mask {
        background-color: var(--affine-hover-color);
      }
    }
  `;Qo([ie()],As.prototype,"_isSelected",2);Qo([ie()],As.prototype,"_editing",2);Qo([ie()],As.prototype,"_isResizing",2);Qo([ie()],As.prototype,"_isHover",2);Qo([ie()],As.prototype,"_noteFullHeight",2);Qo([he("affine-note")],As.prototype,"_affineNote",2);As=Qo([W("edgeless-block-portal-note")],As);var PJ=Object.defineProperty,AJ=Object.getOwnPropertyDescriptor,$J=(t,e,n,i)=>{for(var r=i>1?void 0:i?AJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&PJ(e,n,r),r};let a_=class extends Ys{render(){const{model:t,index:e}=this,n=ne.deserialize(t.xywh),i={position:"absolute",zIndex:`${e}`,width:`${n.w}px`,height:`${n.h}px`,left:`${n.x}px`,top:`${n.y}px`,transformOrigin:"0 0"};return Be`
      <div class="edgeless-block-portal-image" style=${we(i)}>
        ${this.renderModel(t)}
      </div>
    `}};a_=$J([W("edgeless-block-portal-image")],a_);var BJ=Object.defineProperty,DJ=Object.getOwnPropertyDescriptor,OJ=(t,e,n,i)=>{for(var r=i>1?void 0:i?DJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&BJ(e,n,r),r};let l_=class extends Ys{render(){const{model:t,index:e}=this,n=ne.deserialize(t.xywh),i={position:"absolute",zIndex:`${e}`,width:`${n.w}px`,height:`${n.h}px`,left:`${n.x}px`,top:`${n.y}px`,transformOrigin:"0 0"};return Be`
      <div class="edgeless-block-portal-bookmark" style=${we(i)}>
        ${this.renderModel(t)}
      </div>
    `}};l_=OJ([W("edgeless-block-portal-bookmark")],l_);var RJ=Object.defineProperty,NJ=Object.getOwnPropertyDescriptor,so=(t,e,n,i)=>{for(var r=i>1?void 0:i?NJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&RJ(e,n,r),r};const Sf=8;let nd=class extends me(De){constructor(){super(...arguments),this.isInner=!1,this._editing=!1,this._isNavigator=!1,this._updateElement=()=>{this.requestUpdate()}}firstUpdated(){const{_disposables:t,edgeless:e}=this,{service:n,surface:i}=e;t.add(n.viewport.viewportUpdated.on(()=>{this.requestUpdate()})),t.add(this.frame.propsUpdated.on(()=>{this.requestUpdate()})),t.add(this.frame.page.slots.blockUpdated.on(({type:r,id:o})=>{r==="update"&&o===this.frame.id&&this.requestUpdate(),r==="delete"&&o===this.frame.id&&this.remove()})),t.add(e.service.selection.slots.updated.on(()=>{e.service.selection.selectedIds[0]===this.frame.id&&e.service.selection.editing?this._editing=!0:this._editing=!1})),i.edgeless.slots.edgelessToolUpdated.on(r=>{this._isNavigator=r.type==="frameNavigator"}),this.setAttribute("data-frame-title-id",this.frame.id),this.frame.title.yText.observe(this._updateElement),t.add(()=>{this.frame.title.yText.unobserve(this._updateElement)})}render(){const{edgeless:t,frame:e,_isNavigator:n}=this,{service:i}=t,{zoom:r}=i.viewport,o=ne.deserialize(e.xywh);this.isInner=i.frames.some(g=>g.id===e.id?!1:!!ne.deserialize(g.xywh).contains(o));const[s,a]=i.viewport.toViewCoord(o.x,o.y),{isInner:l}=this,c=e.title.toString(),d=(l?Sf:-(29+Sf))+a,u=(l?Sf:0)+s,h=l?o.w*r-Sf/r:o.w*r,p=32/r>o.h&&l;return b`
      ${c&&!n&&!this._editing?b` <div
            style=${we({display:p?"none":"initial",position:"absolute",zIndex:1,left:"0px",top:"0px",transform:`translate(${u}px, ${d}px)`,borderRadius:"4px",width:"fit-content",maxWidth:h+"px",padding:"8px 10px",fontSize:"14px",background:l?"var(--affine-white)":"var(--affine-text-primary-color)",color:l?"var(--affine-text-secondary-color)":"var(--affine-white)",cursor:"default",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",border:l?"1px solid var(--affine-border-color)":"none"})}
            class="affine-frame-title"
          >
            ${c}
          </div>`:ae}
    `}};so([ie()],nd.prototype,"_editing",2);so([ie()],nd.prototype,"_isNavigator",2);so([L({attribute:!1})],nd.prototype,"frame",2);so([L({attribute:!1})],nd.prototype,"edgeless",2);nd=so([W("edgeless-frame-title")],nd);let c_=class extends Ys{render(){const{model:t,index:e}=this,n=ne.deserialize(t.xywh),i=we({position:"absolute",zIndex:`${e}`,left:`${n.x}px`,top:`${n.y}px`,transformOrigin:"0px 0px"});return b`
      <div class="edgeless-block-portal-frame" style=${i}>
        ${this.renderModel(t)}
      </div>
    `}};c_=so([W("edgeless-block-portal-frame")],c_);let id=class extends me(De){constructor(){super(...arguments),this.onlyTitle=!1}firstUpdated(){const{_disposables:t}=this;t.add(this.edgeless.surface.page.slots.blockUpdated.on(({flavour:e})=>{e==="affine:frame"&&this.requestUpdate()}))}render(){return b`
      ${Fe(this.frames,t=>t.id,(t,e)=>this.onlyTitle?b`<edgeless-frame-title
                .frame=${t}
                .edgeless=${this.edgeless}
              >
              </edgeless-frame-title>`:b`
                <edgeless-block-portal-frame
                  .index=${e}
                  .model=${t}
                  .surface=${this.surface}
                  .edgeless=${this.edgeless}
                >
                </edgeless-block-portal-frame>
              `)}
    `}};so([L({attribute:!1})],id.prototype,"surface",2);so([L({attribute:!1})],id.prototype,"edgeless",2);so([L({attribute:!1})],id.prototype,"frames",2);so([L({attribute:!1})],id.prototype,"onlyTitle",2);id=so([W("edgeless-frames-container")],id);var HJ=Object.defineProperty,FJ=Object.getOwnPropertyDescriptor,UJ=(t,e,n,i)=>{for(var r=i>1?void 0:i?FJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&HJ(e,n,r),r};let d_=class extends Ys{render(){const{model:t,index:e}=this,n=ne.deserialize(t.xywh),i={position:"absolute",zIndex:`${e}`,width:`${n.w}px`,height:`${n.h}px`,left:`${n.x}px`,top:`${n.y}px`,transformOrigin:"0px 0px"};return Be`
      <div class="edgeless-block-portal-embed" style=${we(i)}>
        ${this.renderModel(t)}
      </div>
    `}};d_=UJ([W("edgeless-block-portal-embed")],d_);var VJ=Object.defineProperty,zJ=Object.getOwnPropertyDescriptor,k0=(t,e,n,i)=>{for(var r=i>1?void 0:i?zJ(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&VJ(e,n,r),r};let tc=class extends me(Ae){constructor(){super(...arguments),this._lastZoom=1}firstUpdated(){const{edgeless:t}=this,{viewport:e}=t.service;this._lastZoom=e.zoom,this.edgeless.service.viewport.viewportUpdated.on(()=>{e.zoom!==this._lastZoom&&(this._lastZoom=e.zoom,this.requestUpdate())}),this._bindEvent()}_capPointerDown(t,e){const{edgeless:n,connector:i,_disposables:r}=this,{service:o,surface:s}=n;t.stopPropagation(),r.addFromEvent(document,"pointermove",a=>{const{clientX:l,clientY:c}=a,d=o.viewport.boundingClientRect,u=o.viewport.toModelCoord(l-d.left,c-d.top),h=i[e==="source"?"target":"source"].id;i[e]=s.overlays.connector.renderConnector(u,h?[h]:[]),this.requestUpdate()}),r.addFromEvent(document,"pointerup",()=>{s.overlays.connector.clear(),n.page.captureSync(),r.dispose(),this._disposables=new dt,this._bindEvent()})}_bindEvent(){this._disposables.addFromEvent(this._startHandler,"pointerdown",t=>{this._capPointerDown(t,"source")}),this._disposables.addFromEvent(this._endHandler,"pointerdown",t=>{this._capPointerDown(t,"target")})}render(){const{service:t}=this.edgeless,{path:e}=this.connector,n=t.viewport.zoom,i={position:"absolute",left:`${e[0][0]*n}px`,top:`${e[0][1]*n}px`},r={position:"absolute",left:`${e[e.length-1][0]*n}px`,top:`${e[e.length-1][1]*n}px`};return b`
      <div class="line-controller line-start" style=${we(i)}></div>
      <div class="line-controller line-end" style=${we(r)}></div>
    `}};tc.styles=X`
    .line-controller {
      position: absolute;
      width: 9px;
      height: 9px;
      box-sizing: border-box;
      border-radius: 50%;
      border: 2px solid var(--affine-text-emphasis-color);
      background-color: var(--affine-background-primary-color);
      transform: translate(-50%, -50%);
      cursor: pointer;
      z-index: 10;
      pointer-events: all;
      /**
             * Fix: pointerEvent stops firing after a short time.
             * When a gesture is started, the browser intersects the touch-action values of the touched element and its ancestors,
             * up to the one that implements the gesture (in other words, the first containing scrolling element)
             * https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action
             */
      touch-action: none;
    }
    .line-controller-hidden {
      display: none;
    }
  `;k0([L({attribute:!1})],tc.prototype,"connector",2);k0([L({attribute:!1})],tc.prototype,"edgeless",2);k0([he(".line-start")],tc.prototype,"_startHandler",2);k0([he(".line-end")],tc.prototype,"_endHandler",2);tc=k0([W("edgeless-connector-handle")],tc);const jJ=24,h2=16,k6=8,GJ=2,ZJ=18,u_=5,WJ=8,h_=12,qJ=4,p_=2,E6=4,YJ=6,XJ=24,S6=4,T6=26;class KJ{constructor(){this.optionMap=new Map}get options(){return Array.from(this.optionMap.keys())}getOption(e){return this.options.find(n=>typeof n.flavour=="string"?n.flavour===e:n.flavour.test(e))}register(e){const n=this._getExistingOptionWithSameFlavour(e)||e,i=this.optionMap.get(n)||0;return this.optionMap.set(n,i+1),{dispose:()=>{this._decreaseOptionCount(n)}}}_getExistingOptionWithSameFlavour(e){return Array.from(this.optionMap.keys()).find(n=>n.flavour===e.flavour)}_decreaseOptionCount(e){const n=this.optionMap.get(e)||0;n>1?this.optionMap.set(e,n-1):this.optionMap.delete(e)}}const QJ={text:23,h1:40,h2:36,h3:32,h4:32,h5:28,h6:26,quote:46,list:32,database:28,image:28,divider:36},JJ=t=>{const e=t.flavour,n=e.indexOf(":");let i=e.slice(n+1);return i==="paragraph"&&t.type&&(i=t.type),QJ[i]??jJ},eee=(t,e)=>t.some(n=>{const i=n.path;return gt.includes(e,i)}),Tf=(t,e)=>t.some(n=>n===e),tee=t=>!!t.closest(".affine-database-block-table"),jn=t=>t instanceof Element||t instanceof Node?t instanceof Element?t:t.parentElement:null,f_=t=>{let e=t;for(;e&&e.flavour!=="affine:note";)e=e.parentBlockElement;return e.model.id},I6=t=>t.some(e=>e.type==="text"),L6=(t,e)=>!t||!e?!1:gt.equals(t,e),g_=(t,e,n,i)=>{const r=e.getBoundingClientRect(),o=XJ*i;return r?en(t)?n.y<r.top||n.y>r.bottom||n.x>r.right+o:n.y<r.top||n.y>r.bottom||n.x<r.left-o||n.x>r.right+o:!0},a5=(t,e,n)=>en(t)?Uk(e,n,"affine-note"):Vk(n)?.querySelector("affine-note"),m_=(t,e,n)=>{const i=a5(t,e,n);if(!i||i.closest(".affine-surface-ref"))return null;const r=Bi.fromDOM(i),o=Fg(n,{container:i,rect:r}),a=o||Uk(i,n.clone(),".affine-note-block-container > .affine-block-children-container > [data-block-id]");return!a||a.closest(".surface-ref-note-portal")?null:a};function TM(t,e,n,i,r){let o="none";const s=3*r,{rect:a}=jk(t,e,n),l=Math.abs(a.top-t.y),c=Math.abs(a.bottom-t.y);o=l<c?"before":"after";let u=4;if(o==="before"){let p,g;p=n.previousElementSibling,p?i.length&&p===i[i.length-1]?o="none":g=xa(p):(p=n.parentElement?.previousElementSibling,p&&(g=p.getBoundingClientRect())),g&&(u=(a.top-g.bottom)/2)}else{const p=n.childBlockElements.length;Ie(e,["affine:list"])&&!p&&t.x>a.x+T6&&(o="in");let g,f;g=n.nextElementSibling,g?o==="after"&&i.length&&g===i[0]&&(o="none",g=null):g=Ug(n.parentElement)?.nextElementSibling,g&&(f=xa(g),u=(f.top-a.bottom)/2)}if(o==="none")return null;let h=a.top;return o==="before"?h-=u:h+=a.height+u,o==="in"&&(a.x+=T6,a.width-=T6),{rect:Bi.fromLWTH(a.left,a.width,h-s/2,s),dropBlockId:e.id,dropType:o}}const nee=(t,e=1)=>{let n=null;const r=jn(t.target)?.closest("editor-host"),o={x:r?.getBoundingClientRect().left??0,y:r?.getBoundingClientRect().top??0},s=new je(t.x+o.x,t.y+o.y),a=Fg(s);if(!a)return n;const l=a.model;if(Ie(l,["affine:database"]))return n;const d=TM(s,l,a,[],e);return d&&(n=d),n};function b_(t){return t.some(i=>Ie(i.model,["affine:list"])&&i.model.children.length>0)?ZJ:GJ}let v_=[];function y_(t=[]){const e="with-drag-handle";v_.forEach(n=>n.classList.remove(e)),v_=t,t.forEach(n=>n.classList.add(e))}function IM(t){const e=t.keys,n=e.map(r=>t[r]);return Object.fromEntries(e.map((r,o)=>[r,n[o]]))}function Bb({blockComponent:t,dragPreview:e,cssSelector:n,width:i,height:r,noteScale:o}){const s=t.closest("affine-edgeless-page");if(!s)return!1;const a=e.querySelector(n);D(a);const l=a.getBoundingClientRect(),{left:c,top:d}=s.viewport,u=s.service.viewport.toModelCoord(l.x-c,l.y-d),h=new ne(u[0],u[1],(i??a.clientWidth)*o,(r??a.clientHeight)*o),p=t.model,g=IM(p);return s.service.addBlock(t.flavour,{...g,xywh:h.serialize()},s.surfaceBlockModel),t.page.deleteBlock(p),!0}function Db({blockComponent:t,dropBlockId:e,dropType:n}){const i=t.page,r=i.getBlockById(e);if(!r)return!1;const o=n==="in",s=o?r:i.getParent(r);D(s);const a=o?0:s.children.indexOf(r),l=t.model,{width:c,height:d,xywh:u,rotate:h,zIndex:p,...g}=IM(l);return i.addBlock(l.flavour,g,s,a),i.deleteBlock(l),!0}var iee=Object.defineProperty,ree=Object.getOwnPropertyDescriptor,P3=(t,e,n,i)=>{for(var r=i>1?void 0:i?ree(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&iee(e,n,r),r};let rd=class extends me(De){get editorHost(){return this.edgeless.host}get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}get frameBlock(){D(this.frameModel.page.root);const t=this.editorHost.view.viewFromPath("block",[this.frameModel.page.root.id,this.frameModel.id]);return D(t),t}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.richText?.updateComplete,t}firstUpdated(){const t=this.edgeless.dispatcher;D(t),this.updateComplete.then(()=>{this.inlineEditor.selectAll(),this.inlineEditor.slots.renderComplete.on(()=>{this.requestUpdate()}),this.disposables.add(t.add("keyDown",e=>{const n=e.get("keyboardState");return n.raw.key==="Enter"&&!n.raw.isComposing?(this._unmount(),!0):(requestAnimationFrame(()=>{this.requestUpdate()}),!1)})),this.disposables.add(this.edgeless.service.viewport.viewportUpdated.on(()=>{this.requestUpdate()})),this.disposables.add(t.add("click",()=>!0)),this.disposables.add(t.add("doubleClick",()=>!0)),this.disposables.addFromEvent(this.inlineEditorContainer,"blur",()=>{this._unmount()})}).catch(console.error)}_unmount(){this.disposables.dispose(),this.edgeless.service.selection.set({elements:[],editing:!1}),this.remove()}render(){const t=this.edgeless.service.viewport,e=this.frameBlock,n=ne.deserialize(this.frameModel.xywh),[i,r]=t.toViewCoord(n.x,n.y),{isInner:o}=e,s=we({transformOrigin:"top left",borderRadius:"4px",width:"fit-content",maxHeight:"30px",lineHeight:"20px",padding:"4px 10px",fontSize:"14px",position:"absolute",left:(o?i+8:i)+"px",top:(o?r+8:r-38)+"px",minWidth:"8px",fontFamily:"var(--affine-font-family)",background:o?"var(--affine-white)":"var(--affine-text-primary-color)",color:o?"var(--affine-text-secondary-color)":"var(--affine-white)",outline:"none",zIndex:"1",border:`1px solid
        var(--affine-primary-color)`,boxShadow:"0px 0px 0px 2px rgba(30, 150, 235, 0.3)"});return b`<rich-text
      .yText=${this.frameModel.title.yText}
      .enableFormat=${!1}
      .enableAutoScrollHorizontally=${!1}
      .enableAutoScrollVertically=${!1}
      style=${s}
    ></rich-text>`}};P3([he("rich-text")],rd.prototype,"richText",2);P3([L({attribute:!1})],rd.prototype,"frameModel",2);P3([L({attribute:!1})],rd.prototype,"edgeless",2);rd=P3([W("edgeless-frame-title-editor")],rd);var oee=Object.defineProperty,see=Object.getOwnPropertyDescriptor,A3=(t,e,n,i)=>{for(var r=i>1?void 0:i?see(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&oee(e,n,r),r};let od=class extends me(De){get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.richText?.updateComplete,t}firstUpdated(){const t=this.edgeless.dispatcher;D(t),this.updateComplete.then(()=>{this.inlineEditor.selectAll(),this.group.showTitle=!1,this.inlineEditor.slots.renderComplete.on(()=>{this.requestUpdate()}),this.disposables.add(t.add("keyDown",e=>{const n=e.get("keyboardState");return n.raw.key==="Enter"&&!n.raw.isComposing?(this._unmount(),!0):(requestAnimationFrame(()=>{this.requestUpdate()}),!1)})),this.disposables.add(this.edgeless.service.viewport.viewportUpdated.on(()=>{this.requestUpdate()})),this.disposables.add(t.add("click",()=>!0)),this.disposables.add(t.add("doubleClick",()=>!0)),this.disposables.addFromEvent(this.inlineEditorContainer,"blur",()=>{this._unmount()})}).catch(console.error)}_unmount(){this.disposables.dispose(),this.group.showTitle=!0,this.edgeless.service.selection.set({elements:[this.group.id],editing:!1}),this.remove()}render(){const t=this.edgeless.service.viewport,e=ne.deserialize(this.group.xywh),[n,i]=t.toViewCoord(e.x,e.y),r=we({transformOrigin:"top left",borderRadius:"35px",width:"fit-content",maxHeight:"30px",lineHeight:"20px",padding:"4px 10px",fontSize:"14px",position:"absolute",left:n+"px",top:i-36+"px",minWidth:"8px",fontFamily:"var(--affine-font-family)",color:"var(--affine-text-primary-color)",background:"var(--affine-white-10)",outline:"none",zIndex:"1",border:`1px solid
        var(--affine-primary-color)`,boxShadow:"var(--affine-active-shadow)"});return b`<rich-text
      .yText=${this.group.title}
      .enableFormat=${!1}
      .enableAutoScrollHorizontally=${!1}
      .enableAutoScrollVertically=${!1}
      style=${r}
    ></rich-text>`}};A3([he("rich-text")],od.prototype,"richText",2);A3([L({attribute:!1})],od.prototype,"group",2);A3([L({attribute:!1})],od.prototype,"edgeless",2);od=A3([W("edgeless-group-title-editor")],od);const LM=["--affine-brand-color","--affine-primary-color","--affine-secondary-color","--affine-tertiary-color","--affine-hover-color","--affine-icon-color","--affine-icon-secondary","--affine-border-color","--affine-divider-color","--affine-placeholder-color","--affine-quote-color","--affine-link-color","--affine-edgeless-grid-color","--affine-success-color","--affine-warning-color","--affine-error-color","--affine-processing-color","--affine-text-emphasis-color","--affine-text-primary-color","--affine-text-secondary-color","--affine-text-disable-color","--affine-black-10","--affine-black-30","--affine-black-50","--affine-black-60","--affine-black-80","--affine-black-90","--affine-black","--affine-white-10","--affine-white-30","--affine-white-50","--affine-white-60","--affine-white-80","--affine-white-90","--affine-white","--affine-background-code-block","--affine-background-tertiary-color","--affine-background-processing-color","--affine-background-error-color","--affine-background-warning-color","--affine-background-success-color","--affine-background-primary-color","--affine-background-secondary-color","--affine-background-modal-color","--affine-background-overlay-panel-color","--affine-tag-blue","--affine-tag-green","--affine-tag-teal","--affine-tag-white","--affine-tag-purple","--affine-tag-red","--affine-tag-pink","--affine-tag-yellow","--affine-tag-orange","--affine-tag-gray","--affine-palette-line-yellow","--affine-palette-line-orange","--affine-palette-line-tangerine","--affine-palette-line-red","--affine-palette-line-magenta","--affine-palette-line-purple","--affine-palette-line-navy","--affine-palette-line-blue","--affine-palette-line-green","--affine-palette-line-white","--affine-palette-line-black","--affine-palette-line-grey","--affine-palette-shape-yellow","--affine-palette-shape-orange","--affine-palette-shape-tangerine","--affine-palette-shape-red","--affine-palette-shape-magenta","--affine-palette-shape-purple","--affine-palette-shape-navy","--affine-palette-shape-blue","--affine-palette-shape-green","--affine-palette-shape-white","--affine-palette-shape-black","--affine-palette-shape-grey","--affine-tooltip","--affine-blue"],MM=["--affine-font-h-1","--affine-font-h-2","--affine-font-h-3","--affine-font-h-4","--affine-font-h-5","--affine-font-h-6","--affine-font-base","--affine-font-sm","--affine-font-xs","--affine-line-height","--affine-z-index-modal","--affine-z-index-popover"],PM=["--affine-font-family","--affine-font-number-family","--affine-font-code-family"],Ob=["--affine-editor-width","--affine-theme-mode","--affine-editor-mode","--affine-palette-transparent","--affine-popover-shadow","--affine-menu-shadow","--affine-float-button-shadow","--affine-shadow-1","--affine-shadow-2","--affine-shadow-3","--affine-paragraph-space","--affine-popover-radius","--affine-scale",...MM,...LM,...PM];function $3(t){return Ob.includes(t)}var aee=Object.defineProperty,lee=Object.getOwnPropertyDescriptor,B3=(t,e,n,i)=>{for(var r=i>1?void 0:i?lee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&aee(e,n,r),r};let sd=class extends me(De){constructor(){super(...arguments),this._keeping=!1,this._resizeObserver=null}get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}setKeeping(t){this._keeping=t}_updateHeight(){const t=this.richText.getBoundingClientRect(),e=this.richText.offsetHeight;if(e>this.element.h){const[n,i]=te.rotWith([this.richText.offsetLeft,this.richText.offsetTop],[t.left+t.width/2,t.top+t.height/2],vr(-this.element.rotate)),[r,o]=this.edgeless.service.viewport.toModelCoord(n,i);this.edgeless.service.updateElement(this.element.id,{xywh:new ne(r,o,this.element.w,e).serialize()}),this.richText.style.minHeight=`${e}px`}this.edgeless.service.selection.set({elements:[this.element.id],editing:!0})}firstUpdated(){const t=this.edgeless.dispatcher;D(t),this.element.textDisplay=!1,this.disposables.add(this.edgeless.service.viewport.viewportUpdated.on(()=>{this.requestUpdate(),this.updateComplete.then(()=>{this._updateHeight()}).catch(console.error)})),this.disposables.add(t.add("click",()=>!0)),this.disposables.add(t.add("doubleClick",()=>!0)),this.updateComplete.then(()=>{this.inlineEditor.focusEnd(),this.disposables.add(this.inlineEditor.slots.renderComplete.on(()=>{this._updateHeight()})),this.disposables.addFromEvent(this.inlineEditorContainer,"blur",()=>{this._keeping||this._unmount()})}).catch(console.error)}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.richText?.updateComplete,t}_unmount(){this._resizeObserver?.disconnect(),this._resizeObserver=null,this.element.textDisplay=!0,this.remove(),this.edgeless.service.selection.set({elements:[],editing:!1})}render(){if(!this.element.text)throw new Error("Failed to mount shape editor because of no text.");const e=this.edgeless.service.viewport.zoom,n=ec([this.element]),i=this.element.rotate,[r,o]=te.rotWith([n.left,n.top],[n.left+n.width/2,n.top+n.height/2],vr(i)),[s,a]=this.edgeless.service.viewport.toViewCoord(r,o),l=we({position:"absolute",left:s+"px",top:a+"px",width:n.width+"px",minHeight:n.height+"px",height:"initial",fontSize:this.element.fontSize+"px",fontFamily:Lh(this.element.fontFamily),lineHeight:"initial",outline:"none",transform:`scale(${e}, ${e}) rotate(${i}deg)`,transformOrigin:"top left",color:$3(this.element.color)?`var(${this.element.color})`:this.element.color,padding:LT+"px",textAlign:this.element.textAlign,display:"grid",gridTemplateColumns:"100%",alignItems:this.element.textVerticalAlign==="center"?"center":this.element.textVerticalAlign==="bottom"?"end":"start",alignContent:"center",gap:"0",zIndex:"1"});return b`<rich-text
      .yText=${this.element.text}
      .enableFormat=${!1}
      .enableAutoScrollHorizontally=${!1}
      .enableAutoScrollVertically=${!1}
      style=${l}
    ></rich-text>`}};B3([he("rich-text")],sd.prototype,"richText",2);B3([L({attribute:!1})],sd.prototype,"element",2);B3([L({attribute:!1})],sd.prototype,"edgeless",2);sd=B3([W("edgeless-shape-text-editor")],sd);const AM=["code"],$M=[],BM=t=>{if(t.data!==" ")return;if(t.attributes?.link){t.inlineRange.index===t.inlineEditor.yText.length&&delete t.attributes.link;return}const[e]=t.inlineEditor.getLine(t.inlineRange.index),n=e.textContent.slice(0,t.inlineRange.index).split(" "),i=n[n.length-1];if(!QK(i))return;const o=t.inlineRange.index-i.length;t.inlineEditor.formatText({index:o,length:i.length},{link:i})};let M6=!1;const cee=t=>{const{inlineEditor:e,inlineRange:n,data:i,raw:r}=t,o=e.getDeltasByInlineRange(n);if(r.inputType==="insertText"&&i===" "?M6=!0:i!==". "&&i!==" "&&(M6=!1),M6&&(i===". "||i===" ")&&(t.data=" "),i&&i.length>0&&i!==`
`&&(o.length>1||o.length===1&&n.index!==0)&&!e.isEmbed(o[0][0])){const{attributes:s}=o[0][0];(o.length!==1||n.index===e.yText.length)&&AM.forEach(a=>{delete s?.[a]}),$M.forEach(a=>{delete s?.[a]}),t.attributes=s??{}}return BM(t),t},dee=t=>{const{inlineEditor:e,inlineRange:n,data:i}=t,r=e.getDeltasByInlineRange(n);if(i&&i.length>0&&i!==`
`&&(r.length>1||r.length===1&&n.index!==0)){const o=r[0][0].attributes;(r.length!==1||n.index===e.yText.length)&&AM.forEach(s=>{delete o?.[s]}),$M.forEach(s=>{delete o?.[s]}),t.attributes=o??{}}return BM(t),t};var uee=Object.defineProperty,hee=Object.getOwnPropertyDescriptor,Kn=(t,e,n,i)=>{for(var r=i>1?void 0:i?hee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&uee(e,n,r),r};let yn=class extends me(De){constructor(){super(...arguments),this.embedChecker=()=>!1,this.readonly=!1,this.enableClipboard=!0,this.enableUndoRedo=!0,this.enableAutoScrollVertically=!0,this.enableAutoScrollHorizontally=!0,this.wrapText=!0,this.enableFormat=!0,this._inlineEditor=null,this._onStackItemAdded=t=>{const e=this.inlineEditor?.getInlineRange();e&&t.stackItem.meta.set("richtext-v-range",e)},this._onStackItemPopped=t=>{const e=t.stackItem.meta.get("richtext-v-range");e&&this.inlineEditor?.isValidInlineRange(e)&&this.inlineEditor?.setInlineRange(e)},this._onCopy=t=>{const e=this.inlineEditor;D(e);const n=e.getInlineRange();if(!n)return;const i=e.yTextString.slice(n.index,n.index+n.length);t.clipboardData?.setData("text/plain",i),t.preventDefault(),t.stopPropagation()},this._onCut=t=>{const e=this.inlineEditor;D(e);const n=e.getInlineRange();if(!n)return;const i=e.yTextString.slice(n.index,n.index+n.length);e.deleteText(n),e.setInlineRange({index:n.index,length:0}),t.clipboardData?.setData("text/plain",i),t.preventDefault(),t.stopPropagation()},this._onPaste=t=>{const e=this.inlineEditor;D(e);const n=e.getInlineRange();if(!n)return;const i=t.clipboardData?.getData("text/plain");i&&(e.insertText(n,i),e.setInlineRange({index:n.index+i.length,length:0}),t.preventDefault(),t.stopPropagation())}}get inlineEditorContainer(){return D(this._inlineEditorContainer),this._inlineEditorContainer}get inlineEditor(){return this._inlineEditor}_init(){if(this._inlineEditor)throw new Error("Inline editor already exists.");this.enableFormat||(this.attributesSchema=ge.object({})),this._inlineEditor=new WB(this._yText,{isEmbed:n=>this.embedChecker(n),hooks:{beforeinput:cee,compositionEnd:dee},inlineRangeProvider:this.inlineRangeProvider}),this.attributesSchema&&this._inlineEditor.setAttributeSchema(this.attributesSchema),this.attributeRenderer&&this._inlineEditor.setAttributeRenderer(this.attributeRenderer);const t=this._inlineEditor,e=this.markdownShortcutHandler;if(e){const n=qB(t,{inputRule:{key:[" ","Enter"],handler:i=>e(i,this.undoManager)}});t.disposables.addFromEvent(this.inlineEventSource??this.inlineEditorContainer,"keydown",n)}t.disposables.add(t.slots.inlineRangeUpdate.on(([n,i])=>{!n||!i||t.waitForUpdate().then(()=>{if(!t.mounted)return;const r=t.toDomRange(n);if(r){if(this.enableAutoScrollVertically){const o=r.getBoundingClientRect();o.top<0?this.scrollIntoView({block:"start"}):o.bottom>window.innerHeight&&this.scrollIntoView({block:"end"})}if(this.enableAutoScrollHorizontally){const o=this.inlineEditorContainer.getBoundingClientRect(),s=r.getBoundingClientRect();let a=this.inlineEditorContainer.scrollLeft;s.left+s.width>o.left+o.width&&(a+=s.left+s.width-(o.left+o.width)+2),this.inlineEditorContainer.scrollLeft=a}}}).catch(console.error)})),t.mount(this.inlineEditorContainer,this.inlineEventSource),t.setReadonly(this.readonly)}get _yText(){return this.yText instanceof Oi?this.yText.yText:this.yText}_unmount(){this.inlineEditor?.mounted&&this.inlineEditor.unmount(),this._inlineEditor=null}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.inlineEditor?.waitForUpdate(),t}connectedCallback(){super.connectedCallback(),D(this._yText,"rich-text need yText to init."),D(this._yText.doc,"yText should be bind to yDoc."),this.undoManager||(this.undoManager=new nt.Y.UndoManager(this._yText,{trackedOrigins:new Set([this._yText.doc.clientID])})),this.enableUndoRedo&&(this.disposables.addFromEvent(this,"keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="z"&&(t.shiftKey?this.undoManager.redo():this.undoManager.undo(),t.stopPropagation())}),this.undoManager.on("stack-item-added",this._onStackItemAdded),this.undoManager.on("stack-item-popped",this._onStackItemPopped),this.disposables.add({dispose:()=>{this.undoManager.off("stack-item-added",this._onStackItemAdded),this.undoManager.off("stack-item-popped",this._onStackItemPopped)}})),this.enableClipboard&&(this.disposables.addFromEvent(this,"copy",this._onCopy),this.disposables.addFromEvent(this,"cut",this._onCut),this.disposables.addFromEvent(this,"paste",this._onPaste)),this.updateComplete.then(()=>{this._unmount(),this._init(),this.disposables.add({dispose:()=>{this._unmount()}})}).catch(console.error)}updated(){this._inlineEditor&&this._inlineEditor.setReadonly(this.readonly)}render(){const t=Qe({"inline-editor":!0,"nowrap-lines":!this.wrapText});return b`<div class=${t}></div>`}};yn.styles=X`
    rich-text {
      display: block;
      height: 100%;
      width: 100%;
    }

    .inline-editor {
      height: 100%;
      width: 100%;
      outline: none;
      cursor: text;
    }

    rich-text .nowrap-lines {
      overflow-x: auto;
    }

    rich-text v-line {
      scroll-margin-top: 50px;
      scroll-margin-bottom: 30px;
    }

    rich-text .nowrap-lines v-text span,
    rich-text .nowrap-lines v-element span {
      white-space: pre !important;
    }
  `;Kn([he(".inline-editor")],yn.prototype,"_inlineEditorContainer",2);Kn([L({attribute:!1})],yn.prototype,"yText",2);Kn([L({attribute:!1})],yn.prototype,"attributesSchema",2);Kn([L({attribute:!1})],yn.prototype,"attributeRenderer",2);Kn([L({attribute:!1})],yn.prototype,"inlineEventSource",2);Kn([L({attribute:!1})],yn.prototype,"markdownShortcutHandler",2);Kn([L({attribute:!1})],yn.prototype,"embedChecker",2);Kn([L({attribute:!1})],yn.prototype,"readonly",2);Kn([L({attribute:!1})],yn.prototype,"inlineRangeProvider",2);Kn([L({attribute:!1})],yn.prototype,"undoManager",2);Kn([L({attribute:!1})],yn.prototype,"enableClipboard",2);Kn([L({attribute:!1})],yn.prototype,"enableUndoRedo",2);Kn([L({attribute:!1})],yn.prototype,"enableAutoScrollVertically",2);Kn([L({attribute:!1})],yn.prototype,"enableAutoScrollHorizontally",2);Kn([L({attribute:!1})],yn.prototype,"wrapText",2);Kn([L({attribute:!1})],yn.prototype,"enableFormat",2);yn=Kn([W("rich-text")],yn);function E0(t,e){const n=new Set(e),i=t.edgeless.service;e.forEach(r=>{SM(r)&&i.getConnectors(r).forEach(s=>n.add(s)),r instanceof On&&r.decendants().forEach(o=>{n.add(o)})}),n.forEach(r=>{Gn(r)?(t.page.root?.children??[]).length>1&&t.page.deleteBlock(r):i.removeElement(r.id)})}var pee=Object.defineProperty,fee=Object.getOwnPropertyDescriptor,D3=(t,e,n,i)=>{for(var r=i>1?void 0:i?fee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&pee(e,n,r),r};let Zn=class extends me(De){constructor(){super(...arguments),this._keeping=!1,this._isComposition=!1,this._updateRect=()=>{const t=this.edgeless,e=this.element;if(!t||!e)return;const n=this.inlineEditorContainer.scrollWidth,i=this.inlineEditorContainer.scrollHeight,r=new ne(e.x,e.y,n,i),{x:o,y:s,w:a,h:l,rotate:c}=e;switch(e.textAlign){case"left":{const d=this.getCoordsOnLeftAlign({x:o,y:s,w:a,h:l,r:vr(c)},n,i);r.x=d.x,r.y=d.y}break;case"center":{const d=this.getCoordsOnCenterAlign({x:o,y:s,w:a,h:l,r:vr(c)},n,i);r.x=d.x,r.y=d.y}break;case"right":{const d=this.getCoordsOnRightAlign({x:o,y:s,w:a,h:l,r:vr(c)},n,i);r.x=d.x,r.y=d.y}break}t.service.updateElement(e.id,{xywh:r.serialize()})}}get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}setKeeping(t){this._keeping=t}getCoordsOnRightAlign(t,e,n){const i=t.x+t.w/2,r=t.y+t.h/2;let o=t.w/2*Math.cos(t.r)- -t.h/2*Math.sin(t.r),s=t.w/2*Math.sin(t.r)+-t.h/2*Math.cos(t.r);const a=i+o,l=r+s;o=e/2*Math.cos(t.r)- -n/2*Math.sin(t.r),s=e/2*Math.sin(t.r)+-n/2*Math.cos(t.r);const c=a-o,d=l-s;return{x:c-e/2,y:d-n/2}}getCoordsOnCenterAlign(t,e,n){const i=t.x+t.w/2,r=t.y+t.h/2;let o=0,s=-t.h/2*Math.cos(t.r);const a=i+o,l=r+s;o=0,s=-n/2*Math.cos(t.r);const c=a-o,d=l-s;return{x:c-e/2,y:d-n/2}}getCoordsOnLeftAlign(t,e,n){const i=t.x+t.w/2,r=t.y+t.h/2;let o=-t.w/2*Math.cos(t.r)+t.h/2*Math.sin(t.r),s=-t.w/2*Math.sin(t.r)-t.h/2*Math.cos(t.r);const a=i+o,l=r+s;o=-e/2*Math.cos(t.r)+n/2*Math.sin(t.r),s=-e/2*Math.sin(t.r)-n/2*Math.cos(t.r);const c=a-o,d=l-s;return{x:c-e/2,y:d-n/2}}getVisualPosition(t){const{x:e,y:n,w:i,h:r,rotate:o}=t;return te.rotWith([e,n],[e+i/2,n+r/2],vr(o))}getContainerOffset(){const{VERTICAL_PADDING:t,HORIZONTAL_PADDING:e,BORDER_WIDTH:n}=Zn;return`-${e+n}px, -${t+n}px`}connectedCallback(){if(super.connectedCallback(),!this.edgeless)throw new Error("edgeless is not set.");if(!this.element)throw new Error("text element is not set.")}firstUpdated(){const t=this.edgeless,e=this.element,{dispatcher:n}=this.edgeless;D(n),this.updateComplete.then(()=>{this.inlineEditor.slots.renderComplete.on(()=>{this._updateRect(),this.requestUpdate()}),this.disposables.add(t.service.surface.elementUpdated.on(({id:i})=>{i===e.id&&this.requestUpdate()})),this.disposables.add(t.service.viewport.viewportUpdated.on(()=>{this.requestUpdate()})),this.disposables.add(n.add("click",()=>!0)),this.disposables.add(n.add("doubleClick",()=>!0)),this.disposables.add(()=>{e.display=!0,e.text.length===0&&E0(t.surface,[e]),t.service.selection.set({elements:[],editing:!1})}),this.disposables.addFromEvent(this.inlineEditorContainer,"blur",()=>!this._keeping&&this.remove()),this.disposables.addFromEvent(this.inlineEditorContainer,"compositionstart",()=>{this._isComposition=!0,this.requestUpdate()}),this.disposables.addFromEvent(this.inlineEditorContainer,"compositionend",()=>{this._isComposition=!1,this.requestUpdate()}),e.display=!1}).catch(console.error)}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.richText?.updateComplete,t}render(){const{text:t,fontFamily:e,fontSize:n,fontWeight:i,color:r,textAlign:o,rotate:s,hasMaxWidth:a,w:l}=this.element,c=tl(e,n),d=ec([this.element]),{translateX:u,translateY:h,zoom:p}=this.edgeless.service.viewport,[g,f]=this.getVisualPosition(this.element),v=this.getContainerOffset(),m=[`translate(${u}px, ${h}px)`,`translate(${g*p}px, ${f*p}px)`,`scale(${p})`,`rotate(${s}deg)`,`translate(${v})`],y=!t.length&&!this._isComposition;return b`<div
      style=${we({transform:m.join(" "),minWidth:a?`${d.width}px`:"none",maxWidth:a?`${l}px`:"none",fontFamily:`"${e}"`,fontSize:`${n}px`,fontWeight:i,color:$3(r)?`var(${r})`:r,textAlign:o,lineHeight:`${c}px`})}
      class="edgeless-text-editor"
    >
      <rich-text
        .yText=${t}
        .enableFormat=${!1}
        .enableAutoScrollHorizontally=${!1}
        .enableAutoScrollVertically=${!1}
        style=${y?we({position:"absolute",left:0,top:0,padding:`${Zn.VERTICAL_PADDING}px
        ${Zn.HORIZONTAL_PADDING}px`}):ae}
      ></rich-text>
      ${y?b`<span class="edgeless-text-editor-placeholder">
            Type from here
          </span>`:ae}
    </div>`}};Zn.PLACEHOLDER_TEXT="Type from here";Zn.HORIZONTAL_PADDING=10;Zn.VERTICAL_PADDING=6;Zn.BORDER_WIDTH=1;Zn.styles=X`
    .edgeless-text-editor {
      box-sizing: content-box;
      position: absolute;
      left: 0;
      top: 0;
      z-index: 10;
      transform-origin: left top;
      border: ${Zn.BORDER_WIDTH}px solid
        var(--affine-primary-color, #1e96eb);
      border-radius: 4px;
      box-shadow: 0px 0px 0px 2px rgba(30, 150, 235, 0.3);
      padding: ${Zn.VERTICAL_PADDING}px
        ${Zn.HORIZONTAL_PADDING}px;
      overflow: visible;
    }

    .edgeless-text-editor .inline-editor {
      white-space: pre-wrap !important;
      outline: none;
    }

    .edgeless-text-editor .inline-editor span {
      word-break: normal !important;
      overflow-wrap: anywhere !important;
    }

    .edgeless-text-editor-placeholder {
      pointer-events: none;
      color: var(--affine-text-disable-color);
      white-space: nowrap;
    }
  `;D3([he("rich-text")],Zn.prototype,"richText",2);D3([L({attribute:!1})],Zn.prototype,"element",2);D3([L({attribute:!1})],Zn.prototype,"edgeless",2);Zn=D3([W("edgeless-text-editor")],Zn);function Rb(t,e,n){let i=t.text.length;n&&(i=Math.min(cq(t,n),i));const r=new Zn;r.edgeless=e,r.element=t,e.pageBlockContainer.appendChild(r),r.updateComplete.then(()=>{r.inlineEditor?.focusIndex(i)}).catch(console.error),e.tools.switchToDefaultMode({elements:[t.id],editing:!0})}function Nb(t,e){if(!t.text){const o=new nt.Y.Text,{fillColor:s}=t,a=Y1(s)?_a():s===lM?sM:aM;e.service.updateElement(t.id,{text:o,color:a,fontFamily:t.shapeStyle==="General"?wt.Inter:wt.Kalam})}const n=e.service.getElementById(t.id);Cs(n,Ct);const i=new sd;i.element=n,i.edgeless=e,e.pageBlockContainer.appendChild(i),e.tools.switchToDefaultMode({elements:[t.id],editing:!0})}function DM(t,e){const n=new rd;n.frameModel=t,n.edgeless=e,e.pageBlockContainer.appendChild(n),e.tools.switchToDefaultMode({elements:[t.id],editing:!0})}function OM(t,e){const n=new od;n.group=t,n.edgeless=e,e.pageBlockContainer.appendChild(n),e.tools.switchToDefaultMode({elements:[t.id],editing:!0})}function RM(t,e){const[n,i]=t.service.viewport.toModelCoord(e.x,e.y);if(!t.service.pickElement(n,i)){const[o,s]=t.service.viewport.toModelCoord(e.x,e.y),a=t.service.addElement(kn.TEXT,{xywh:new ne(o,s,32,32).serialize(),text:new nt.Y.Text});t.page.captureSync();const l=t.service.getElementById(a);D(l),l instanceof vn&&Rb(l,t)}}var zt=(t=>(t[t.Right=0]="Right",t[t.Bottom=1]="Bottom",t[t.Left=2]="Left",t[t.Top=3]="Top",t))(zt||{});const NM=136,HM=108,w_={x:-NM/2,y:-HM*(3/4)},ga=100,If=20,x_=110,__=116,C_=24,k_="--affine-background-secondary-color",E_=new Map(Object.entries({"--affine-palette-shape-yellow":"--affine-tag-yellow","--affine-palette-shape-red":"--affine-tag-red","--affine-palette-shape-green":"--affine-tag-green","--affine-palette-shape-blue":"--affine-tag-blue","--affine-palette-shape-purple":"--affine-tag-purple"}));class Hb extends nl{constructor(e){super(),this.xywh=e}render(e,n){}}class gee extends Hb{constructor(e){super(e)}render(e,n){e.globalAlpha=.4;const[i,r,o,s]=this.xywh;e.strokeStyle="#1e96eb",e.lineWidth=1,e.strokeRect(i,r,o,s),e.font="15px sans-serif",e.fillStyle="#C0BFC1",e.textAlign="center",e.textBaseline="middle",e.fillText("Type '/' to insert",i+o/2,r+s/2)}}class mee extends Hb{constructor(e,n){super(e),this._background=n}render(e,n){e.globalAlpha=.4;const[i,r,o,s]=this.xywh;e.fillStyle=this._background,e.strokeStyle="rgba(0, 0, 0, 0.10)",e.lineWidth=2,e.beginPath(),e.roundRect(i,r,o,s,8),e.closePath(),e.fill(),e.stroke(),e.font="15px sans-serif",e.fillStyle="black",e.textAlign="left",e.textBaseline="middle",e.fillText("Type '/' for command",i+24,r+s/2)}}class bee extends Hb{constructor(e,n){super(e),this._strokeColor=n}render(e,n){e.globalAlpha=.4;const[i,r,o,s]=this.xywh,a=72,l=30,c=r-l-10;e.fillStyle="rgba(0, 0, 0, 0.8)",e.beginPath(),e.roundRect(i,c,a,l,4),e.closePath(),e.fill(),e.globalAlpha=1,e.font="14px sans-serif",e.fillStyle="white",e.textAlign="center",e.textBaseline="middle",e.fillText("Frame",i+a/2,c+l/2),e.globalAlpha=.4,e.strokeStyle=this._strokeColor,e.lineWidth=2,e.beginPath(),e.roundRect(i,r,o,s,8),e.closePath(),e.stroke()}}class vee extends nl{constructor(e,n,i,r){super(),this._shape=_8.createShape(e,n,i,r)}render(e,n){e.globalAlpha=.4,this._shape.draw(e,n)}}function yee(t,e,n){const i=ne.deserialize(e.xywh),{x:r,y:o,w:s,h:a}=i;let l,c=0;switch(t){case 0:c=0;break;case 1:c=90;break;case 2:c=180;break;case 3:c=270;break}c=e0(c+e.rotate),c>=45&&c<=135?l=new ne(r,o+a+ga,s,a):c>=135&&c<=225?l=new ne(r-s-ga,o,s,a):c>=225&&c<=315?l=new ne(r,o-a-ga,s,a):l=new ne(r+s+ga,o,s,a);function d(p){return!n.some(g=>p.isOverlapWithBound(g.elementBound))}let u=0;function h(){u++;const p=Math.ceil(u/2),g=l.clone();switch(t){case 0:case 2:g.y=u%2===1?l.y-(a+If)*p:l.y+(a+If)*p;break;case 1:case 3:g.x=u%2===1?l.x-(s+If)*p:l.x+(s+If)*p;break}return d(g)?g:h()}return d(l)?l:h()}function P6(t){let e,n;switch(t){case 0:e=[1,.5],n=[0,.5];break;case 1:e=[.5,1],n=[.5,0];break;case 2:e=[0,.5],n=[1,.5];break;case 3:e=[.5,0],n=[.5,1];break}return{startPosition:e,endPosition:n}}function lh(t){return t instanceof Ct}function wee(t){return t.charAt(0).toUpperCase()+t.slice(1)}function xee(t,e,n){let i;const{service:r}=t;if(lh(e))i=r.addElement(e.type,{...e.serialize(),text:new nt.Y.Text,xywh:n.serialize()});else{const{page:s}=t;i=s.addBlock("affine:note",{background:e.background,displayMode:e.displayMode,edgeless:e.edgeless,xywh:n.serialize()},t.model.id);const a=s.getBlockById(i);D(a),s.updateBlock(a,()=>{a.edgeless.collapse=!0}),s.addBlock("affine:paragraph",{},a.id)}const o=e.group;return o instanceof On&&o.addChild(i),i}async function _ee(t,e,n){const r=t.service.addElement(e.type,{...e.serialize(),shapeType:n==="roundedRect"?"rect":n,radius:n==="roundedRect"?.1:0,text:new nt.Y.Text}),o=e.group;return o instanceof On&&o.addChild(r),r}async function Cee(t,e){const n=t.service.addElement(kn.TEXT,{text:new nt.Y.Text,textAlign:"left",fontSize:24,fontFamily:wt.Inter,color:xb(),fontWeight:us.Regular,fontStyle:ti.Normal}),i=e.group;return i instanceof On&&i.addChild(n),n}var kee=Object.defineProperty,Eee=Object.getOwnPropertyDescriptor,S0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Eee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&kee(e,n,r),r};let Ma=class extends me(Ae){constructor(t,e,n,i){super(),this._overlay=null,this.position=t,this.edgeless=e,this.currentShape=n,this.connector=i}_generateTarget(t){const e=this.currentShape,n=ne.deserialize(e.xywh),{w:i,h:r}=n,o=t.target.position;D(o);const s=t.path.length,a=e0(ED(te.angle(t.path[s-2],t.path[s-1])));let l,c,d;return a>=45&&a<=135?(l=new ne(o[0]-i/2,o[1],i,r),c=[.5,0],d=zt.Bottom):a>=135&&a<=225?(l=new ne(o[0]-i,o[1]-r/2,i,r),c=[1,.5],d=zt.Left):a>=225&&a<=315?(l=new ne(o[0]-i/2,o[1]-r,i,r),c=[.5,1],d=zt.Top):(l=new ne(o[0],o[1]-r/2,i,r),c=[0,.5],d=zt.Right),{nextBound:l,position:c,direction:d}}_getTargetXYWH(t,e){const n=this._generateTarget(this.connector);if(!n)return null;const{nextBound:i,direction:r,position:o}=n;if(!i)return null;const{w:s,h:a}=i;let l=i.x,c=i.y;switch(r){case zt.Right:c+=a/2-e/2;break;case zt.Bottom:l-=t/2-s/2;break;case zt.Left:c+=a/2-e/2,l-=t-s;break;case zt.Top:l-=t/2-s/2,c+=a-e;break}return{xywh:[l,c,t,e],position:o}}_connectorExist(){return!!this.edgeless.service.getElementById(this.connector.id)}_showTextOverlay(){const t=this._getTargetXYWH(__,C_)?.xywh;t&&(this._overlay=new gee(t),this.edgeless.surface.renderer.addOverlay(this._overlay))}_showNoteOverlay(){const t=this._getTargetXYWH(r5,x_)?.xywh;if(!t)return;const e=this.currentShape.fillColor,i=getComputedStyle(this.edgeless).getPropertyValue(E_.get(e)??k_);this._overlay=new mee(t,i),this.edgeless.surface.renderer.addOverlay(this._overlay)}_showFrameOverlay(){const t=this._generateTarget(this.connector)?.nextBound;if(!t)return;const{h:e}=t,n=e/.75,i=this._getTargetXYWH(n,e)?.xywh;if(!i)return;const o=getComputedStyle(this.edgeless).getPropertyValue("--affine-black-30");this._overlay=new bee(i,o),this.edgeless.surface.renderer.addOverlay(this._overlay)}_showShapeOverlay(t){const e=this._generateTarget(this.connector)?.nextBound;if(!e)return;const{x:n,y:i,w:r,h:o}=e,s=[n,i,r,o],{shapeStyle:a,roughness:l,strokeColor:c,fillColor:d,strokeWidth:u}=this.currentShape,h=getComputedStyle(this.edgeless),p=h.getPropertyValue(c),g=h.getPropertyValue(d),f={seed:666,roughness:l,strokeLineDash:[0,0],stroke:p,strokeWidth:u,fill:g};this._overlay=new vee(s,t,f,a),this.edgeless.surface.renderer.addOverlay(this._overlay)}_showOverlay(t){if(this._removeOverlay(),!!this._connectorExist()){switch(t){case"text":this._showTextOverlay();break;case"note":this._showNoteOverlay();break;case"frame":this._showFrameOverlay();break;default:this._showShapeOverlay(t)}this.edgeless.surface.refresh()}}_removeOverlay(){this._overlay&&this.edgeless.surface.renderer.removeOverlay(this._overlay)}async _addShape(t){const e=this.edgeless,n=this.currentShape,i=this._generateTarget(this.connector);if(!i)return;const{nextBound:r,position:o}=i,{service:s}=e,a=await _ee(e,n,t);s.updateElement(a,{xywh:r.serialize()}),s.updateElement(this.connector.id,{target:{id:a,position:o}}),Nb(s.getElementById(a),this.edgeless),e.service.selection.set({elements:[a],editing:!0}),e.page.captureSync()}_addNote(){const{page:t}=this.edgeless,e=this.edgeless.service,n=this._getTargetXYWH(r5,x_);if(!n)return;const{xywh:i,position:r}=n,o=this.currentShape.fillColor,s=E_.get(o)??k_,a=e.addBlock("affine:note",{xywh:wo(...i),background:s},t.root?.id);t.addBlock("affine:paragraph",{type:"text"},a);const l=this.currentShape.group;l instanceof On&&l.addChild(a),this.connector.target={id:a,position:r},e.updateElement(this.connector.id,{target:{id:a,position:r}}),this.edgeless.service.selection.set({elements:[a],editing:!0})}_addFrame(){const t=this._generateTarget(this.connector)?.nextBound;if(!t)return;const{h:e}=t,n=e/.75,i=this._getTargetXYWH(n,e);if(!i)return;const{xywh:r,position:o}=i,s=this.edgeless,{service:a,surfaceBlockModel:l}=s,c=a.layer.frames.length+1,d=a.addBlock("affine:frame",{title:new nt.Y.Text(`Frame ${c}`),xywh:wo(...r)},l);s.page.captureSync();const u=a.getElementById(d);D(u),this.connector.target={id:d,position:o},s.service.selection.set({elements:[u.id],editing:!1})}async _addText(){const t=this._getTargetXYWH(__,C_);if(!t)return;const{xywh:e,position:n}=t,i=await Cee(this.edgeless,this.currentShape),{service:r}=this.edgeless;r.updateElement(i,{xywh:wo(...e)}),r.updateElement(this.connector.id,{target:{id:i,position:n}}),this.edgeless.service.selection.set({elements:[i],editing:!1}),this.edgeless.page.captureSync();const o=this.edgeless.service.getElementById(i);D(o),o instanceof vn&&Rb(o,this.edgeless)}async _autoComplete(t){if(this._removeOverlay(),!!this._connectorExist()){switch(t){case"text":await this._addText();break;case"note":this._addNote();break;case"frame":this._addFrame();break;default:await this._addShape(t)}this.remove()}}_getPanelPosition(){const{viewport:t}=this.edgeless.service,e=t.boundingClientRect;let[n,i]=t.toViewCoord(...this.position);const{width:r,height:o}=e;return n<=0||n>=r||i<=0||i>=o?null:(n+=w_.x,i+=w_.y,n=Zr(n,20,r-20-NM),i=Zr(i,20,o-20-HM),[n,i])}connectedCallback(){super.connectedCallback(),this.edgeless.handleEvent("click",t=>{const{target:e}=t.get("pointerState").raw;!jn(e)?.closest("edgeless-auto-complete-panel")&&this.remove()})}disconnectedCallback(){super.disconnectedCallback(),this._removeOverlay()}firstUpdated(){this.disposables.add(this.edgeless.service.viewport.viewportUpdated.on(()=>this.requestUpdate()))}render(){const t=this._getPanelPosition();if(!t)return ae;const e=we({left:`${t[0]}px`,top:`${t[1]}px`}),n=this.currentShape.shapeStyle,i=this.currentShape.shapeType!=="rect"?this.currentShape.shapeType:this.currentShape.radius?"roundedRect":"rect",r=b`${x3.map(({name:o,generalIcon:s,scribbledIcon:a,tooltip:l})=>b`
          <edgeless-tool-icon-button
            .tooltip=${l}
            .iconContainerPadding=${2}
            @pointerenter=${()=>this._showOverlay(o)}
            @pointerleave=${()=>this._removeOverlay()}
            @click=${()=>this._autoComplete(o)}
          >
            ${n==="General"?s:a}
          </edgeless-tool-icon-button>
        `)}`;return b`<div class="auto-complete-panel-container" style=${e}>
      ${r}

      <edgeless-tool-icon-button
        .tooltip=${"Text"}
        .iconContainerPadding=${2}
        @pointerenter=${()=>this._showOverlay("text")}
        @pointerleave=${()=>this._removeOverlay()}
        @click=${()=>this._autoComplete("text")}
      >
        ${NL}
      </edgeless-tool-icon-button>
      <edgeless-tool-icon-button
        .tooltip=${"Note"}
        .iconContainerPadding=${2}
        @pointerenter=${()=>this._showOverlay("note")}
        @pointerleave=${()=>this._removeOverlay()}
        @click=${()=>this._autoComplete("note")}
      >
        ${LI}
      </edgeless-tool-icon-button>
      <edgeless-tool-icon-button
        .tooltip=${"Frame"}
        .iconContainerPadding=${2}
        @pointerenter=${()=>this._showOverlay("frame")}
        @pointerleave=${()=>this._removeOverlay()}
        @click=${()=>this._autoComplete("frame")}
      >
        ${Lc}
      </edgeless-tool-icon-button>

      <edgeless-tool-icon-button
        .tooltip=${wee(i)}
        .iconContainerPadding=${0}
        @pointerenter=${()=>this._showOverlay(i)}
        @pointerleave=${()=>this._removeOverlay()}
        @click=${()=>this._autoComplete(i)}
      >
        <div class="row-button">Add a same object</div>
      </edgeless-tool-icon-button>
    </div>`}};Ma.styles=X`
    .auto-complete-panel-container {
      position: absolute;
      display: flex;
      width: 136px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      padding: 8px 0;
      gap: 8px;
      border-radius: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      z-index: 1;
    }

    .row-button {
      width: 120px;
      height: 20px;
      padding: 4px 0;
      text-align: center;
      border-radius: 4px;
      font-family: ${Je(vt.fontSansFamily)};
      font-size: 13px;
      font-style: normal;
      font-weight: 400;
      line-height: 20px;
      border: 1px solid var(--affine-border-color, #e3e2e4);
    }
  `;S0([L({attribute:!1})],Ma.prototype,"edgeless",2);S0([L({attribute:!1})],Ma.prototype,"position",2);S0([L({attribute:!1})],Ma.prototype,"currentShape",2);S0([L({attribute:!1})],Ma.prototype,"connector",2);Ma=S0([W("edgeless-auto-complete-panel")],Ma);var See=Object.defineProperty,Tee=Object.getOwnPropertyDescriptor,su=(t,e,n,i)=>{for(var r=i>1?void 0:i?Tee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&See(e,n,r),r};class Iee extends nl{constructor(){super(...arguments),this.linePoints=[],this.shapePoints=[],this.stroke=""}render(e,n){this.linePoints.length&&this.shapePoints.length&&(e.setLineDash([2,2]),e.strokeStyle=this.stroke,e.beginPath(),this.linePoints.forEach((i,r)=>{r===0?e.moveTo(i[0],i[1]):e.lineTo(i[0],i[1])}),this.shapePoints.forEach((i,r)=>{r===0?e.moveTo(i[0],i[1]):e.lineTo(i[0],i[1])}),e.closePath(),e.stroke())}}let Pa=class extends me(Ae){constructor(){super(...arguments),this._isHover=!0,this._isMoving=!1,this._timer=null,this._autoCompleteOverlay=new Iee,this._onPointerDown=(t,e)=>{const{service:n}=this.edgeless,i=n.viewport.boundingClientRect,r=n.viewport.toModelCoord(t.clientX-i.left,t.clientY-i.top);if(!this.edgeless.dispatcher)return;let o;this._disposables.addFromEvent(document,"pointermove",s=>{const a=n.viewport.toModelCoord(s.clientX-i.left,s.clientY-i.top);if(te.dist(r,a)>8&&!this._isMoving){if(this._isMoving=!0,!lh(this.current))return;const{startPosition:l}=P6(e);o=this._addConnector({id:this.current.id,position:l},{position:a})}if(this._isMoving){D(o);const l=o.source.id;o.target=this._surface.overlays.connector.renderConnector(a,l?[l]:[])}}),this._disposables.addFromEvent(document,"pointerup",s=>{this._isMoving?o&&!o.target.id&&(this.edgeless.service.selection.clear(),this._createAutoCompletePanel(s,o)):this._generateElementOnClick(e),this._isMoving=!1,this._surface.overlays.connector.clear(),this._disposables.dispose(),this._disposables=new dt})}}get _surface(){return this.edgeless.surface}connectedCallback(){super.connectedCallback(),this._pathGenerator=new $T({getElementById:t=>this.edgeless.service.getElementById(t)})}firstUpdated(){const{_disposables:t,edgeless:e}=this;t.add(this.edgeless.service.selection.slots.updated.on(()=>{this._autoCompleteOverlay.linePoints=[],this._autoCompleteOverlay.shapePoints=[]})),t.add(()=>this.removeOverlay()),t.add(e.host.event.add("pointerMove",()=>{const n=e.tools.getHoverState();if(!n){this._isHover=!1;return}this._isHover=n.content===this.current}))}_createAutoCompletePanel(t,e){if(!lh(this.current))return;const n=this.edgeless.service.viewport.toModelCoord(t.clientX,t.clientY),i=new Ma(n,this.edgeless,this.current,e);this.edgeless.pageBlockContainer.appendChild(i)}_addConnector(t,e){const{service:n}=this.edgeless,i=n.addElement(kn.CONNECTOR,{mode:Hl.Orthogonal,strokeWidth:2,stroke:this.current.strokeColor,source:t,target:e});return n.getElementById(i)}_generateElementOnClick(t){const{page:e,service:n}=this.edgeless,i=this._computeNextBound(t),r=xee(this.edgeless,this.current,i);if(lh(this.current)){const{startPosition:o,endPosition:s}=P6(t);this._addConnector({id:this.current.id,position:o},{id:r,position:s}),Nb(n.getElementById(r),this.edgeless)}else{const o=e.getBlockById(r);D(o);const[s,a]=n.viewport.toViewCoord(i.center[0],i.y+jX/2);requestAnimationFrame(()=>{jg(s,a)})}this.edgeless.service.selection.set({elements:[r],editing:!0}),this.removeOverlay()}_showNextShape(t,e,n,i){const{surface:r}=this.edgeless;r.renderer.addOverlay(this._autoCompleteOverlay),this._autoCompleteOverlay.stroke=this._surface.themeObserver.getVariableValue(t.strokeColor),this._autoCompleteOverlay.linePoints=n,this._autoCompleteOverlay.shapePoints=bi(l1[i].points(e),e.center,t.rotate),r.refresh()}_getConnectedElements(t){const e=this.edgeless.service;return e.getConnectors(t.id).reduce((n,i)=>(i.target.id===t.id&&i.source.id&&n.push(e.getElementById(i.source.id)),i.source.id===t.id&&i.target.id&&n.push(e.getElementById(i.target.id)),n),[])}_computeNextBound(t){if(lh(this.current)){const e=this._getConnectedElements(this.current).filter(n=>n instanceof Ct);return yee(t,this.current,e)}else{const e=this.current.elementBound;switch(t){case zt.Right:{e.x+=e.w+ga;break}case zt.Bottom:{e.y+=e.h+ga;break}case zt.Left:{e.x-=e.w+ga;break}case zt.Top:{e.y-=e.h+ga;break}}return e}}_computeLine(t,e,n){const i=this.current.elementBound,{startPosition:r,endPosition:o}=P6(t),s={xywh:n.serialize(),rotate:e.rotate,shapeType:e.shapeType},a=e.getRelativePointLocation(r),l=e.getRelativePointLocation.call(s,o);return this._pathGenerator.generateOrthogonalConnectorPath({startBound:i,endBound:n,startPoint:a,endPoint:l})}removeOverlay(){this._timer&&clearTimeout(this._timer),this.edgeless.surface.renderer.removeOverlay(this._autoCompleteOverlay)}render(){const t=this.current instanceof Ct;if(this._isMoving||this._isHover&&!t)return this.removeOverlay(),ae;const{selectedRect:e}=this,{zoom:n}=this.edgeless.service.viewport,i=72,r=44,o=t?[zt.Right,zt.Bottom,zt.Left,zt.Top]:[zt.Right,zt.Left],s=t?r/2:r*(2/3),a=o.map(l=>{let c="";switch(l){case zt.Top:c+=`translate(${e.width/2}px, ${-s}px)`;break;case zt.Right:c+=`translate(${e.width+s}px, ${e.height/2}px)`,t&&(c+="rotate(90deg)");break;case zt.Bottom:c+=`translate(${e.width/2}px, ${e.height+s}px)`,t&&(c+="rotate(180deg)");break;case zt.Left:c+=`translate(${-s}px, ${e.height/2}px)`,t&&(c+="rotate(-90deg)");break}c+=`translate(${-i/2}px, ${-r/2}px)`;const d=Qe({"edgeless-auto-complete-arrow-wrapper":!0,hidden:!t&&l===zt.Left&&n>=1.5});return b`<div
        class=${d}
        style=${we({transform:c,transformOrigin:"left top"})}
      >
        <div
          class="edgeless-auto-complete-arrow"
          @mouseenter=${()=>{this._timer=setTimeout(()=>{if(this.current instanceof Ct){const u=this._computeNextBound(l),h=this._computeLine(l,this.current,u);this._showNextShape(this.current,u,h,this.current.shapeType)}},300)}}
          @mouseleave=${()=>{this.removeOverlay()}}
          @pointerdown=${u=>{this._onPointerDown(u,l)}}
        >
          ${t?eI:tI}
        </div>
      </div>`});return b`<div
      class="edgeless-auto-complete-container"
      style=${we({top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px",transform:`rotate(${e.rotate}deg)`})}
    >
      ${a}
    </div>`}};Pa.styles=X`
    .edgeless-auto-complete-container {
      position: absolute;
      z-index: 1;
      pointer-events: none;
    }
    .edgeless-auto-complete-arrow-wrapper {
      width: 72px;
      height: 44px;
      position: absolute;
      z-index: 1;
      pointer-events: auto;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .edgeless-auto-complete-arrow-wrapper.hidden {
      display: none;
    }
    .edgeless-auto-complete-arrow {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      border-radius: 19px;
      cursor: pointer;
      pointer-events: auto;
      transition:
        background 0.3s linear,
        box-shadow 0.2s linear;
    }
    .edgeless-auto-complete-arrow-wrapper:hover
      > .edgeless-auto-complete-arrow {
      border: 1px solid var(--affine-border-color);
      box-shadow: var(--affine-shadow-1);
      background: var(--affine-white);
    }

    .edgeless-auto-complete-arrow-wrapper
      > .edgeless-auto-complete-arrow:hover {
      border: 1px solid var(--affine-white-10);
      box-shadow: var(--affine-shadow-1);
      background: var(--affine-primary-color);
    }

    .edgeless-auto-complete-arrow svg {
      fill: #77757d;
    }
    .edgeless-auto-complete-arrow:hover svg {
      fill: #ffffff;
    }
  `;su([ie()],Pa.prototype,"_isHover",2);su([L({attribute:!1})],Pa.prototype,"edgeless",2);su([L({attribute:!1})],Pa.prototype,"selectedRect",2);su([L({attribute:!1})],Pa.prototype,"current",2);su([ie()],Pa.prototype,"_isMoving",2);Pa=su([W("edgeless-auto-complete")],Pa);var pt=(t=>(t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom",t.TopLeft="top-left",t.BottomLeft="bottom-left",t.TopRight="top-right",t.BottomRight="bottom-right",t))(pt||{});function oa(t,e,n,i){const r=l=>{l.stopPropagation(),e&&e(l,t)},o=l=>c=>{if(c.stopPropagation(),c.buttons===1||!n)return;const{clientX:d,clientY:u}=c,h=c.target;n(!0,{type:l,point:[d,u],target:h})},s=l=>{l.stopPropagation(),!(l.buttons===1||!n)&&n(!1)},a=t==="top"||t==="bottom"||t==="left"||t==="right"?ae:b`<div
          class="rotate"
          @pointerover=${o("rotate")}
          @pointerout=${s}
        ></div>`;return b`<div
    class="handle"
    aria-label=${t}
    @pointerdown=${r}
  >
    ${a}
    <div
      class="resize${i&&" transparent-handle"}"
      @pointerover=${o("resize")}
      @pointerout=${s}
    ></div>
  </div>`}function Lee(t,e,n){const i=()=>{const s=oa("top-left",e,n),a=oa("top-right",e,n),l=oa("bottom-left",e,n),c=oa("bottom-right",e,n);return{handleTopLeft:s,handleTopRight:a,handleBottomLeft:l,handleBottomRight:c}},r=s=>{const a=oa("left",e,n,s),l=oa("right",e,n,s);return{handleLeft:a,handleRight:l}},o=s=>{const a=oa("top",e,n,s),l=oa("bottom",e,n,s);return{handleTop:a,handleBottom:l}};switch(t){case"corner":{const{handleTopLeft:s,handleTopRight:a,handleBottomLeft:l,handleBottomRight:c}=i();return b`
        ${s}
        ${a}
        ${l}
        ${c}
      `}case"edge":{const{handleLeft:s,handleRight:a}=r();return b`${s} ${a}`}case"all":{const{handleTopLeft:s,handleTopRight:a,handleBottomLeft:l,handleBottomRight:c}=i(),{handleLeft:d,handleRight:u}=r(!0),{handleTop:h,handleBottom:p}=o(!0);return b`
        ${s}
        ${h}
        ${a}
        ${u}
        ${c}
        ${p}
        ${l}
        ${d}
      `}case"edgeAndCorner":{const{handleTopLeft:s,handleTopRight:a,handleBottomLeft:l,handleBottomRight:c}=i(),{handleLeft:d,handleRight:u}=r(!0);return b`
        ${s} ${a} ${u} ${c}
        ${l} ${d}
      `}case"none":return ae}}const S_=Math.PI/12;class Mee{constructor(e,n,i,r){this._dragDirection=pt.Left,this._dragPos={start:{x:0,y:0},end:{x:0,y:0}},this._rotate=0,this._originalRect=new DOMRect,this._currentRect=new DOMRect,this._origin={x:0,y:0},this._resizeMode="none",this._zoom=1,this._bounds=new Map,this._aspectRatio=1,this._locked=!1,this._proportion=!1,this._shiftKey=!1,this._proportional=!1,this._rotation=!1,this._target=null,this._dragging=!1,this.onPointerDown=(o,s,a=!1)=>{if(o.stopPropagation(),this._locked=!1,this._target=o.target,this._dragDirection=s,this._dragPos.start={x:o.x,y:o.y},this._dragPos.end={x:o.x,y:o.y},this._rotation=this._target.classList.contains("rotate"),this._proportional=a,this._rotation){const d=this._target.closest(".affine-edgeless-selected-rect")?.getBoundingClientRect();D(d);const{left:u,top:h,right:p,bottom:g}=d,f=(u+p)/2,v=(h+g)/2;this._origin={x:f,y:v}}this._dragging=!0,this._onDragStart();const l=({x:d,y:u,shiftKey:h})=>{if(this._resizeMode==="none")return;this._shiftKey=h,this._dragPos.end={x:d,y:u};const p=this._proportional||this._shiftKey;if(this._rotation){this._onRotate(p);return}this._onResize(p)},c=d=>{this._dragging=!1,this._onDragEnd();const{x:u,y:h,width:p,height:g}=this._currentRect;this._originalRect=new DOMRect(u,h,p,g),this._locked=!0,this._shiftKey=!1,this._rotation=!1,this._dragPos={start:{x:0,y:0},end:{x:0,y:0}},document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c)};document.addEventListener("pointermove",l),document.addEventListener("pointerup",c)},this._onDragStart=e,this._onResizeMove=n,this._onRotateMove=i,this._onDragEnd=r}get dragging(){return this._dragging}get rotation(){return this._rotation}get currentRect(){return this._currentRect}get originalRect(){return this._originalRect}get bounds(){return this._bounds}updateState(e,n,i,r,o,s=!1){this._resizeMode=e,this._rotate=n,this._zoom=i,this._proportion=s,r&&(this._currentRect.x=r.x,this._currentRect.y=r.y,this._originalRect.x=this._currentRect.x,this._originalRect.y=this._currentRect.y),o&&(this._originalRect=o,this._aspectRatio=o.width/o.height,this._currentRect=DOMRect.fromRect(o))}updateRectPosition(e){return this._currentRect.x+=e.x,this._currentRect.y+=e.y,this._originalRect.x=this._currentRect.x,this._originalRect.y=this._currentRect.y,this._originalRect}updateBounds(e){this._bounds=e}_onResize(e){const{_aspectRatio:n,_dragDirection:i,_dragPos:r,_rotate:o,_resizeMode:s,_zoom:a,_target:l,_originalRect:c,_currentRect:d}=this;e||=this._proportion,D(l);const u=s==="all",h=s==="corner",p=s==="edgeAndCorner",{start:{x:g,y:f},end:{x:v,y:m}}=r,{left:y,top:x,right:T,bottom:M}=c,k={w:T-y,h:M-x,cx:(y+T)/2,cy:(x+M)/2},_={...k},A={x:1,y:1},$={x:1,y:1},E={x:1,y:1},R=new DOMPoint(0,0),I=new DOMPoint(0,0),N=(v-g)/a,P=(m-f)/a,Z=new DOMMatrix().translateSelf(k.cx,k.cy).rotateSelf(o).translateSelf(-k.cx,-k.cy);if(h||u||p){switch(i){case pt.TopLeft:{E.x=-1,E.y=-1,R.x=T,R.y=M,I.x=y,I.y=x;break}case pt.TopRight:{E.x=1,E.y=-1,R.x=y,R.y=M,I.x=T,I.y=x;break}case pt.BottomRight:{E.x=1,E.y=1,R.x=y,R.y=x,I.x=T,I.y=M;break}case pt.BottomLeft:{E.x=-1,E.y=1,R.x=T,R.y=x,I.x=y,I.y=M;break}case pt.Left:{E.x=-1,E.y=1,R.x=T,R.y=k.cy,I.x=y,I.y=k.cy;break}case pt.Right:{E.x=1,E.y=1,R.x=y,R.y=k.cy,I.x=T,I.y=k.cy;break}case pt.Top:{const Ne=(y+T)/2;E.x=1,E.y=-1,R.x=Ne,R.y=M,I.x=Ne,I.y=x;break}case pt.Bottom:{const Ne=(y+T)/2;E.x=1,E.y=1,R.x=Ne,R.y=x,I.x=Ne,I.y=M;break}}e||=this._bounds.size>1;const K=R.matrixTransform(Z);let U=I.matrixTransform(Z);if(U.x+=N,U.y+=P,i===pt.Left||i===pt.Right||i===pt.Top||i===pt.Bottom){const Ne=I.matrixTransform(Z),Ue=[0,0],[[lt,et]]=bi([[Ne.x,Ne.y]],Ue,-o),[[B,_e]]=bi([[U.x,U.y]],Ue,-o),fe={x:0,y:0};i===pt.Left||i===pt.Right?(fe.x=B,fe.y=et):(fe.x=lt,fe.y=_e);const[[G,j]]=bi([[fe.x,fe.y]],Ue,o);U.x=G,U.y=j}const Ee=(K.x+U.x)/2,xe=(K.y+U.y)/2,Pe=new DOMMatrix().translateSelf(Ee,xe).rotateSelf(-o).translateSelf(-Ee,-xe),ze=K.matrixTransform(Pe),le=U.matrixTransform(Pe);switch(i){case pt.TopLeft:{_.w=ze.x-le.x,_.h=ze.y-le.y;break}case pt.TopRight:{_.w=le.x-ze.x,_.h=ze.y-le.y;break}case pt.BottomRight:{_.w=le.x-ze.x,_.h=le.y-ze.y;break}case pt.BottomLeft:{_.w=ze.x-le.x,_.h=le.y-ze.y;break}case pt.Left:{_.w=ze.x-le.x;break}case pt.Right:{_.w=le.x-ze.x;break}case pt.Top:{_.h=ze.y-le.y;break}case pt.Bottom:{_.h=le.y-ze.y;break}}_.cx=(le.x+ze.x)/2,_.cy=(le.y+ze.y)/2,A.x=_.w/k.w,A.y=_.h/k.h,$.x=A.x<0?-1:1,$.y=A.y<0?-1:1;const He=i===pt.TopLeft||i===pt.TopRight||i===pt.BottomRight||i===pt.BottomLeft;if(e&&He){const Ne=Math.abs(_.w/_.h);n<Ne?(A.y=Math.abs(A.x)*$.y,_.h=A.y*k.h):(A.x=Math.abs(A.y)*$.x,_.w=A.x*k.w),I.x=R.x+_.w*E.x,I.y=R.y+_.h*E.y,U=I.matrixTransform(Z),_.cx=(K.x+U.x)/2,_.cy=(K.y+U.y)/2}}else{switch(i){case pt.Left:{E.x=-1,R.x=T,I.x=y+N,_.w=R.x-I.x;break}case pt.Right:{E.x=1,R.x=y,I.x=T+N,_.w=I.x-R.x;break}}A.x=_.w/k.w,$.x=A.x<0?-1:1,Math.abs(_.w)<Wh&&(_.w=Wh*$.x,A.x=_.w/k.w,I.x=R.x+_.w*E.x),_.cx=(I.x+R.x)/2}const pe=Math.abs(_.w),Q=Math.abs(_.h),Le=_.cx-pe/2,ue=_.cy-Q/2;d.x=Le,d.y=ue,d.width=pe,d.height=Q;const H=new Map;let ee;if(h||u||p)if(this._bounds.size===1)ee=(K,U)=>{H.set(U,{bound:new ne(Le,ue,pe,Q)})};else{const K=R.matrixTransform(Z),U=new DOMMatrix().translateSelf(K.x,K.y).rotateSelf(o).translateSelf(-K.x,-K.y).scaleSelf(A.x,A.y,1,K.x,K.y,0).translateSelf(K.x,K.y).rotateSelf(-o).translateSelf(-K.x,-K.y);ee=({bound:{x:Ee,y:xe,w:Pe,h:ze}},le)=>{const He=Ee+Pe/2,Ne=xe+ze/2,Ue=new DOMPoint(He,Ne).matrixTransform(U),lt=Math.abs(Pe*A.x),et=Math.abs(ze*A.y);H.set(le,{bound:new ne(Ue.x-lt/2,Ue.y-et/2,lt,et)})}}else{const K=new DOMMatrix().scaleSelf(A.x,A.y,1,R.x,R.y,0);ee=({bound:{x:U,y:Ee,w:xe,h:Pe},rotate:ze=0},le)=>{const He=U+xe/2,Ne=Ee+Pe/2,Ue=new DOMPoint(He,Ne).matrixTransform(K);let lt,et;if(ze){const{width:B}=Og({x:U,y:Ee,w:xe,h:Pe,rotate:ze}),_e=B/2;if(Ue.y=Ne,d.width<=B)lt=xe*(d.width/B),et=lt/(xe/Pe),Ue.x=d.left+d.width/2;else{const fe=(He-_e-c.left)/c.width,G=d.left+fe*d.width+_e;Ue.x=Math.max(d.left+_e,Math.min(G,d.left+d.width-_e)),lt=xe,et=Pe}}else lt=Math.abs(xe*A.x),et=Math.abs(Pe*A.y);H.set(le,{bound:new ne(Ue.x-lt/2,Ue.y-et/2,lt,et)})}}this._bounds.forEach(ee),this._onResizeMove(H,this._dragDirection)}_onRotate(e=!1){const{_originalRect:{left:n,top:i,right:r,bottom:o},_dragPos:{start:{x:s,y:a},end:{x:l,y:c}},_origin:{x:d,y:u},_rotate:h}=this,p=Math.atan2(a-u,s-d);let f=Math.atan2(c-u,l-d)-p;if(e){const x=h*Math.PI/180;let T=x+f;T+=S_/2,T-=T%S_,f=T-x}const v=f*180/Math.PI;let m=l,y=c;if(e){const x=new DOMPoint(s,a).matrixTransform(new DOMMatrix().translateSelf(d,u).rotateSelf(v).translateSelf(-d,-u));m=x.x,y=x.y}this._onRotateMove({x:(n+r)/2,y:(i+o)/2},v),this._dragPos.start={x:m,y},this._rotate+=v}onPressShiftKey(e){if(!this._target||this._locked||this._shiftKey===e)return;this._shiftKey=e;const n=this._proportional||this._shiftKey;if(this._rotation){this._onRotate(n);return}this._onResize(n)}}var Pee=Object.defineProperty,Aee=Object.getOwnPropertyDescriptor,Ir=(t,e,n,i)=>{for(var r=i>1?void 0:i?Aee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Pee(e,n,r),r};let wi=class extends me(Ae){constructor(){super(),this._selectedRect={width:0,height:0,borderWidth:0,borderStyle:"solid",left:0,top:0,rotate:0},this._isResizing=!1,this._dragDirection=null,this._scalePercent=null,this._isNoteWidthLimit=!1,this._isNoteHeightLimit=!1,this._shiftKey=!1,this.autoCompleteOff=!1,this.toolbarVisible=!1,this._cursorRotate=0,this._propDiposables=[],this._dragEndCallback=[],this._onDragStart=()=>{const t=this._resizeManager.rotation;this._dragEndCallback=[],this.edgeless.slots.elementResizeStart.emit(),this.selection.elements.forEach(e=>{e.stash("xywh"),e instanceof s5&&e.stash("edgeless"),t&&e.stash("rotate"),e instanceof vn&&!t&&(e.stash("fontSize"),e.stash("hasMaxWidth")),this._dragEndCallback.push(()=>{e.pop("xywh"),e instanceof s5&&e.pop("edgeless"),t&&e.pop("rotate"),e instanceof vn&&!t&&(e.pop("fontSize"),e.pop("hasMaxWidth"))})}),this.setToolbarVisible(!1),this._updateResizeManagerState(!0)},this._onDragMove=(t,e)=>{const{edgeless:n}=this;t.forEach(({bound:i},r)=>{const o=n.service.getElementById(r);if(o)if(Gn(o)){const s=ne.deserialize(o.xywh),a={};let l=o.edgeless.scale??1,c=s.w/l,d=s.h/l;this._shiftKey?(l=i.w/c,this._dragDirection=e,this._scalePercent=`${Math.round(l*100)}%`):s.h!==i.h&&n.page.updateBlock(o,()=>{o.edgeless.collapse=!0,o.edgeless.collapsedHeight=i.h/l}),c=i.w/l,c=Es(c,Wh,1/0),i.w=c*l,d=i.h/l,d=Es(d,x8,1/0),i.h=d*l,this._isNoteWidthLimit=c===Wh,this._isNoteHeightLimit=d===x8,a.edgeless={...o.edgeless,scale:l},a.xywh=i.serialize(),n.service.updateElement(o.id,a)}else if(hs(o)||vi(o)||u2(o)){const s=ne.deserialize(o.xywh);if(hs(o)){const{height:a}=o;a&&(this._dragDirection=e,this._scalePercent=`${Math.round(i.h/a*100)}%`)}else{this._dragDirection=e;const a=o.style,l=bt[a];this._scalePercent=`${Math.round(i.h/l*100)}%`}e===pt.Left||e===pt.Right?i.h=s.h/s.w*i.w:(e===pt.Top||e===pt.Bottom)&&(i.w=s.w/s.h*i.h),n.service.updateElement(o.id,{xywh:i.serialize()})}else if(o instanceof vn){let s=1;e===pt.Left||e===pt.Right?(i=gT(o,i,!0),n.service.updateElement(r,{xywh:i.serialize(),fontSize:o.fontSize*s,hasMaxWidth:!0})):(s=i.h/o.h,n.service.updateElement(r,{xywh:i.serialize(),fontSize:o.fontSize*s}))}else o instanceof Ct&&(i=k9(o,i)),n.service.updateElement(r,{xywh:i.serialize()})})},this._onDragRotate=(t,e)=>{const{selection:n}=this,i=new DOMMatrix().translateSelf(t.x,t.y).rotateSelf(e).translateSelf(-t.x,-t.y),r=n.elements.filter(o=>hs(o)||_0(o)&&o.type!==kn.CONNECTOR);I3(r).forEach(o=>{const{id:s,rotate:a}=o,{x:l,y:c,w:d,h:u}=ne.deserialize(o.xywh),h=new DOMPoint(l+d/2,c+u/2).matrixTransform(i);this.edgeless.service.updateElement(s,{xywh:wo(h.x-d/2,h.y-u/2,d,u),rotate:e0(a+e)})}),this._updateCursor(!0,{type:"rotate",angle:e})},this._onDragEnd=()=>{this._dragDirection=null,this._scalePercent=null,this.page.transact(()=>{this._dragEndCallback.forEach(t=>t())}),this._dragEndCallback=[],this._isNoteWidthLimit=!1,this._isNoteHeightLimit=!1,this._updateCursor(!1),this.setToolbarVisible(!0),this.edgeless.slots.elementResizeEnd.emit()},this._updateCursor=(t,e)=>{let n="default";if(t&&e){const{type:i,target:r,point:o}=e;let{angle:s}=e;if(i==="rotate")r&&o&&(s=VY(r,o,45)),this._cursorRotate+=s||0,n=NY(this._cursorRotate).toString();else{if(this.resizeMode==="edge")n="ew";else if(r&&o){const a=GY(r),{width:l,height:c,left:d,top:u}=this._selectedRect;a==="top"||a==="bottom"||a==="left"||a==="right"?s=jY(r,this._selectedRect.rotate):s=zY(r,o,new DOMRect(d,u,l,c),this._selectedRect.rotate),n=UY(s*Math.PI/180)}n+="-resize"}}else this._cursorRotate=0;this.slots.cursorUpdated.emit(n)},this._updateSelectedRect=zm(()=>{const{zoom:t,selection:e,edgeless:n}=this,i=e.elements,r=ec(i),[o,s]=n.service.viewport.toViewCoord(r.left,r.top),[a,l]=[r.width*t,r.height*t];let c=0;i.length===1&&(c=i[0].rotate);const d=i.length>1?tK:0;this._selectedRect={width:a+d*2,height:l+d*2,borderWidth:e.editing?2:1,borderStyle:"solid",left:o-d,top:s-d,rotate:c}},this),this._updateResizeManagerState=t=>{const{_resizeManager:e,_selectedRect:n,resizeMode:i,zoom:r,selection:{elements:o}}=this,s=ec(o),a=o.some(l=>hs(l)||vi(l)||u2(l));o.length>1&&(t=!0),e.updateState(i,n.rotate,r,t?void 0:s,t?s:void 0,a),e.updateBounds(vJ(o))},this._updateOnViewportChange=()=>{this._updateSelectedRect()},this._initSelectedSlot=()=>{this._propDiposables.forEach(t=>t.dispose()),this._propDiposables=[],this.selection.elements.forEach(t=>{"flavour"in t&&this._propDiposables.push(t.propsUpdated.on(()=>{this._updateOnElementChange(t.id)}))})},this._updateOnSelectionChange=()=>{this._initSelectedSlot(),this._updateSelectedRect(),this._updateResizeManagerState(!0),this._updateCursor(!1)},this._updateOnElementChange=(t,e=!1)=>{if(e&&this._resizeManager.dragging||!this.isConnected)return;const n=typeof t=="string"?t:t.id;(this._resizeManager.bounds.has(n)||this.selection.has(n))&&this._updateSelectedRect()},this._resizeManager=new Mee(this._onDragStart,this._onDragMove,this._onDragRotate,this._onDragEnd),this.addEventListener("pointerdown",at)}get dragging(){return this._resizeManager.dragging||this.edgeless.tools.dragging}get selection(){return this.edgeless.service.selection}get page(){return this.edgeless.page}get slots(){return this.edgeless.slots}get surface(){return this.edgeless.surface}get zoom(){return this.edgeless.service.viewport.zoom}get resizeMode(){const t=this.selection.elements;let e=!0,n=!0,i=!0;for(const r of t)Gn(r)?(e=!1,this._shiftKey&&(n=!1,i=!1)):nr(r)?e=!1:hs(r)||vi(r)||u2(r)?(e=!1,n=!1,i=!1):(r.type!==kn.CONNECTOR&&(e=!1),r.type!==kn.SHAPE&&r.type!==kn.GROUP&&(n=!1),r.type!==kn.TEXT&&(i=!1));return e?"none":n?"all":i?"edgeAndCorner":"corner"}_shouldRenderSelection(t){return t=t??this.selection.elements,t.length>0&&!this.selection.editing}firstUpdated(){const{_disposables:t,slots:e,selection:n,edgeless:i}=this;t.add(i.service.viewport.viewportUpdated.on(this._updateOnViewportChange)),Im(i.service.surface,["elementAdded","elementRemoved","elementUpdated"]).forEach(r=>{t.add(r.on(this._updateOnElementChange))}),t.add(this.page.slots.blockUpdated.on(this._updateOnElementChange)),t.add(e.pressShiftKeyUpdated.on(r=>{this._shiftKey=r,this._resizeManager.onPressShiftKey(r),this._updateSelectedRect()})),t.add(n.slots.updated.on(this._updateOnSelectionChange)),t.add(i.slots.readonlyUpdated.on(()=>this.requestUpdate())),t.add(i.slots.elementResizeStart.on(()=>this._isResizing=!0)),t.add(i.slots.elementResizeEnd.on(()=>this._isResizing=!1)),t.add(()=>{this._propDiposables.forEach(r=>r.dispose())})}_canAutoComplete(){return!this.autoCompleteOff&&!this._isResizing&&this.selection.elements.length===1&&(this.selection.elements[0]instanceof Ct||Gn(this.selection.elements[0]))}_canRotate(){return!this.selection.elements.every(t=>Gn(t)||nr(t)||vi(t))}render(){if(!this.isConnected)return ae;const{selection:t}=this,e=t.elements;if(!this._shouldRenderSelection(e))return ae;const{edgeless:n,page:i,resizeMode:r,_resizeManager:o,_selectedRect:s,_updateCursor:a}=this,c=!t.editing&&!i.readonly?Lee(r,(p,g)=>{if(p.target.classList.contains("rotate")&&!this._canRotate())return;const v=e.some(m=>m instanceof vn);o.onPointerDown(p,g,v)},(p,g)=>{!this._canRotate()&&g?.type==="rotate"||a(p,g)}):ae,d=e.length===1&&e[0]instanceof Ft?b`<edgeless-connector-handle
            .connector=${e[0]}
            .edgeless=${n}
          ></edgeless-connector-handle>`:ae,u=e.length>1?e.map(p=>{const[g,f,v,m]=Wn(p.xywh),[y,x]=n.service.viewport.toViewCoord(g,f),{left:T,top:M,borderWidth:k}=this._selectedRect,_={position:"absolute",boxSizing:"border-box",left:`${y-T-k}px`,top:`${x-M-k}px`,width:`${v*this.zoom}px`,height:`${m*this.zoom}px`,border:"1px solid var(--affine-primary-color)"};return b`<div
              class="element-handle"
              style=${we(_)}
            ></div>`}):ae,h=e.length===1&&e[0]instanceof On;return s.borderStyle=h?"dashed":"solid",b`
      <style>
        .affine-edgeless-selected-rect .handle[aria-label='right']::after {
          content: '';
          display: ${this._isNoteWidthLimit?"initial":"none"};
          position: absolute;
          top: 0;
          left: 1.5px;
          width: 2px;
          height: 100%;
          background: var(--affine-error-color);
          filter: drop-shadow(-6px 0px 12px rgba(235, 67, 53, 0.35));
        }

        .affine-edgeless-selected-rect .handle[aria-label='bottom']::after {
          content: '';
          display: ${this._isNoteHeightLimit?"initial":"none"};
          position: absolute;
          top: 1.5px;
          left: 0px;
          width: 100%;
          height: 2px;
          background: var(--affine-error-color);
          filter: drop-shadow(-6px 0px 12px rgba(235, 67, 53, 0.35));
        }
      </style>
      ${!i.readonly&&this._canAutoComplete()?b`<edgeless-auto-complete
            .current=${this.selection.elements[0]}
            .edgeless=${n}
            .selectedRect=${s}
          >
          </edgeless-auto-complete>`:ae}
      <div
        class="affine-edgeless-selected-rect"
        style=${we({width:`${s.width}px`,height:`${s.height}px`,borderWidth:`${s.borderWidth}px`,borderStyle:s.borderStyle,transform:`translate(${s.left}px, ${s.top}px) rotate(${s.rotate}deg)`})}
        disabled="true"
        data-scale-percent=${this._scalePercent??""}
        data-direction=${this._dragDirection??""}
      >
        ${c} ${d} ${u}
      </div>
    `}};wi.enabledWarnings=[];wi.styles=X`
    :host {
      display: block;
      user-select: none;
      contain: size layout;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
    }

    .affine-edgeless-selected-rect {
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: center center;
      border-radius: 0;
      pointer-events: none;
      box-sizing: border-box;
      z-index: 1;
      border-color: var(--affine-blue);
      border-width: var(--affine-border-width);
      border-style: solid;
      transform: translate(0, 0) rotate(0);
    }

    .affine-edgeless-selected-rect .handle {
      position: absolute;
      user-select: none;
      outline: none;
      pointer-events: auto;

      /**
       * Fix: pointerEvent stops firing after a short time.
       * When a gesture is started, the browser intersects the touch-action values of the touched element and its ancestors,
       * up to the one that implements the gesture (in other words, the first containing scrolling element)
       * https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action
       */
      touch-action: none;
    }

    .affine-edgeless-selected-rect .handle[aria-label^='top-'],
    .affine-edgeless-selected-rect .handle[aria-label^='bottom-'] {
      width: 18px;
      height: 18px;
      box-sizing: border-box;
      z-index: 10;
    }

    .affine-edgeless-selected-rect .handle[aria-label^='top-'] .resize,
    .affine-edgeless-selected-rect .handle[aria-label^='bottom-'] .resize {
      position: absolute;
      width: 12px;
      height: 12px;
      box-sizing: border-box;
      border-radius: 50%;
      border: 2px var(--affine-blue) solid;
      background: white;
    }

    .affine-edgeless-selected-rect .handle[aria-label^='top-'] .rotate,
    .affine-edgeless-selected-rect .handle[aria-label^='bottom-'] .rotate {
      position: absolute;
      width: 12px;
      height: 12px;
      box-sizing: border-box;
      background: transparent;
    }

    /* -18 + 6.5 */
    .affine-edgeless-selected-rect .handle[aria-label='top-left'] {
      left: -12px;
      top: -12px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top-left'] .resize {
      right: 0;
      bottom: 0;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top-left'] .rotate {
      right: 6px;
      bottom: 6px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='top-right'] {
      top: -12px;
      right: -12px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top-right'] .resize {
      left: 0;
      bottom: 0;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top-right'] .rotate {
      left: 6px;
      bottom: 6px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='bottom-right'] {
      right: -12px;
      bottom: -12px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom-right'] .resize {
      left: 0;
      top: 0;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom-right'] .rotate {
      left: 6px;
      top: 6px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='bottom-left'] {
      bottom: -12px;
      left: -12px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom-left'] .resize {
      right: 0;
      top: 0;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom-left'] .rotate {
      right: 6px;
      top: 6px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='top'],
    .affine-edgeless-selected-rect .handle[aria-label='bottom'],
    .affine-edgeless-selected-rect .handle[aria-label='left'],
    .affine-edgeless-selected-rect .handle[aria-label='right'] {
      border: 0;
      background: transparent;
      border-color: var('--affine-blue');
    }

    .affine-edgeless-selected-rect .handle[aria-label='left'],
    .affine-edgeless-selected-rect .handle[aria-label='right'] {
      top: 0;
      bottom: 0;
      height: 100%;
      width: 6px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='top'],
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] {
      left: 0;
      right: 0;
      width: 100%;
      height: 6px;
    }

    /* calc(-1px - (6px - 1px) / 2) = -3.5px */
    .affine-edgeless-selected-rect .handle[aria-label='left'] {
      left: -3.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='right'] {
      right: -3.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top'] {
      top: -3.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] {
      bottom: -3.5px;
    }

    .affine-edgeless-selected-rect .handle[aria-label='top'] .resize,
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] .resize,
    .affine-edgeless-selected-rect .handle[aria-label='left'] .resize,
    .affine-edgeless-selected-rect .handle[aria-label='right'] .resize {
      width: 100%;
      height: 100%;
    }

    .affine-edgeless-selected-rect .handle[aria-label='top'] .resize:after,
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] .resize:after,
    .affine-edgeless-selected-rect .handle[aria-label='left'] .resize:after,
    .affine-edgeless-selected-rect .handle[aria-label='right'] .resize:after {
      position: absolute;
      width: 7px;
      height: 7px;
      box-sizing: border-box;
      border-radius: 6px;
      z-index: 10;
      content: '';
      background: white;
    }

    .affine-edgeless-selected-rect
      .handle[aria-label='top']
      .transparent-handle:after,
    .affine-edgeless-selected-rect
      .handle[aria-label='bottom']
      .transparent-handle:after,
    .affine-edgeless-selected-rect
      .handle[aria-label='left']
      .transparent-handle:after,
    .affine-edgeless-selected-rect
      .handle[aria-label='right']
      .transparent-handle:after {
      opacity: 0;
    }

    .affine-edgeless-selected-rect .handle[aria-label='left'] .resize:after,
    .affine-edgeless-selected-rect .handle[aria-label='right'] .resize:after {
      top: calc(50% - 6px);
    }

    .affine-edgeless-selected-rect .handle[aria-label='top'] .resize:after,
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] .resize:after {
      left: calc(50% - 6px);
    }

    .affine-edgeless-selected-rect .handle[aria-label='left'] .resize:after {
      left: -0.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='right'] .resize:after {
      right: -0.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='top'] .resize:after {
      top: -0.5px;
    }
    .affine-edgeless-selected-rect .handle[aria-label='bottom'] .resize:after {
      bottom: -0.5px;
    }

    .affine-edgeless-selected-rect::before {
      content: '';
      display: none;
      position: absolute;
      width: 20px;
      height: 20px;
      background-image: url("data:image/svg+xml,%3Csvg width='26' height='26' viewBox='0 0 26 26' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M23 3H19C10.1634 3 3 10.1634 3 19V23' stroke='black' stroke-opacity='0.3' stroke-width='5' stroke-linecap='round'/%3E%3C/svg%3E");
      background-size: contain;
      background-repeat: no-repeat;
    }
    .affine-edgeless-selected-rect[data-direction='top-left']::before {
      display: block;
      top: 0px;
      left: 0px;
      transform-origin: bottom right;
      transform: translate(-100%, -100%);
    }
    .affine-edgeless-selected-rect[data-direction='top-right']::before {
      display: block;
      top: 0px;
      right: 0px;
      transform: translate(100%, -100%) rotate(90deg);
    }
    .affine-edgeless-selected-rect[data-direction='bottom-right']::before {
      display: block;
      bottom: 0px;
      right: 0px;
      transform: translate(100%, 100%) rotate(180deg);
    }
    .affine-edgeless-selected-rect[data-direction='bottom-left']::before {
      display: block;
      bottom: 0px;
      left: 0px;
      transform: translate(-100%, 100%) rotate(-90deg);
    }

    .affine-edgeless-selected-rect::after {
      content: attr(data-scale-percent);
      display: none;
      position: absolute;
      color: var(--affine-icon-color);
      font-feature-settings:
        'clig' off,
        'liga' off;
      font-family: var(--affine-font-family);
      font-size: 12px;
      font-style: normal;
      font-weight: 400;
      line-height: 24px;
    }
    .affine-edgeless-selected-rect[data-direction='top-left']::after {
      display: block;
      top: -20px;
      left: -20px;
      transform: translate(-100%, -100%);
    }
    .affine-edgeless-selected-rect[data-direction='top-right']::after {
      display: block;
      top: -20px;
      right: -20px;
      transform: translate(100%, -100%);
    }
    .affine-edgeless-selected-rect[data-direction='bottom-right']::after {
      display: block;
      bottom: -20px;
      right: -20px;
      transform: translate(100%, 100%);
    }
    .affine-edgeless-selected-rect[data-direction='bottom-left']::after {
      display: block;
      bottom: -20px;
      left: -20px;
      transform: translate(-100%, 100%);
    }
  `;Ir([L({attribute:!1})],wi.prototype,"edgeless",2);Ir([ie()],wi.prototype,"_selectedRect",2);Ir([ie()],wi.prototype,"_isResizing",2);Ir([ie()],wi.prototype,"_dragDirection",2);Ir([ie()],wi.prototype,"_scalePercent",2);Ir([ie()],wi.prototype,"_isNoteWidthLimit",2);Ir([ie()],wi.prototype,"_isNoteHeightLimit",2);Ir([ie()],wi.prototype,"_shiftKey",2);Ir([L({attribute:!1})],wi.prototype,"autoCompleteOff",2);Ir([L({attribute:!1})],wi.prototype,"toolbarVisible",2);Ir([L({attribute:!1})],wi.prototype,"setToolbarVisible",2);wi=Ir([W("edgeless-selected-rect")],wi);var $ee=Object.defineProperty,Bee=Object.getOwnPropertyDescriptor,FM=(t,e,n,i)=>{for(var r=i>1?void 0:i?Bee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&$ee(e,n,r),r};let l5=class extends me(Ae){firstUpdated(){this._disposables.add(this.edgeless.slots.draggingAreaUpdated.on(()=>this.requestUpdate()))}render(){const t=this.edgeless.tools.draggingArea;if(t===null)return ae;const e={left:t.left+"px",top:t.top+"px",width:t.width+"px",height:t.height+"px"};return b`
      <div class="affine-edgeless-dragging-area" style=${we(e)}></div>
    `}};l5.styles=X`
    .affine-edgeless-dragging-area {
      position: absolute;
      background: var(--affine-hover-color);
      z-index: 1;
      pointer-events: none;
    }
  `;FM([L({attribute:!1})],l5.prototype,"edgeless",2);l5=FM([W("edgeless-dragging-area-rect")],l5);var Dee=Object.defineProperty,Oee=Object.getOwnPropertyDescriptor,$c=(t,e,n,i)=>{for(var r=i>1?void 0:i?Oee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Dee(e,n,r),r};const A6=44,Lf=24,T_=24,Ree=24,I_=16;function $6(t,e,n){const i=[];if(e===1)return i.push([0,10]),i;const r=(e-1)/2,o=e%2===0,s=(t+n)/2;function a(l){return l-r>0?1:-1}for(let l=0;l<e;l++){let c=10;if(o)Math.abs(l-r)<1&&o?c=10+s*a(l):c=10+((Math.ceil(Math.abs(l-r))-1)*(t+24)+s)*a(l);else{const d=t+n;c=10+Math.ceil(Math.abs(l-r))*d*a(l)}i.push([0,c])}return i}function L_(t,e){const n=X`
    .index-label-tooltip {
      display: flex;
      align-items: center;
      flex-wrap: nowrap;
      gap: 10px;
    }

    .index-label-tooltip-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .index-label-tooltip-content {
      font-size: var(--affine-font-sm);

      display: flex;
      height: 16px;
      line-height: 16px;
    }
  `;return b`<style>
      ${n}
    </style>
    <div class="index-label-tooltip">
      <span class="index-label-tooltip-icon">${t}</span>
      <span class="index-label-tooltip-content">${e}</span>
    </div>`}let $s=class extends me(De){constructor(){super(...arguments),this.show=!1,this._index=-1}firstUpdated(){const{_disposables:t,edgeless:e}=this;t.add(e.service.viewport.viewportUpdated.on(()=>{this.requestUpdate()}));const n=i=>{if(!this.isConnected)return;const r=e.service.getElementById(i.id);r&&this.pageVisibleElementsMap.has(r)&&this.requestUpdate(),Gn(r)&&this.edgelessOnlyNotesSet.has(r)&&this.requestUpdate()};t.add(e.surfaceBlockModel.elementUpdated.on(n)),t.add(e.page.slots.blockUpdated.on(i=>{i.type==="update"&&n(i)})),t.add(e.service.selection.slots.updated.on(()=>{const{elements:i}=e.service.selection;i.length===1&&Gn(i[0])||(this._index=-1)})),Eo(()=>{this._disposables.add(e.dispatcher.add("click",i=>{const r=i.get("pointerState"),{raw:o}=r,s=o.target;if(!s)return!1;if(s.closest(".edgeless-index-label")){const a=s.closest(".edgeless-index-label"),l=Number(a.getAttribute("index"));return this._index=l===this._index?-1:l,!0}else{if(s.closest(".edgeless-auto-connect-next-button"))return this._navigateToNext(),!0;if(s.closest(".edgeless-auto-connect-previous-button"))return this._navigateToPrev(),!0}return!1}))},e)}connectedCallback(){super.connectedCallback(),this.style.position="absolute",this.style.top="0",this.style.left="0",this.style.zIndex="1"}_getElementsAndCounts(){const t=[],e=[];for(const[n,i]of this.pageVisibleElementsMap.entries())t.push(n),e.push(i);return{elements:t,counts:e}}_navigateToNext(){const{elements:t}=this._getElementsAndCounts();if(this._index>=t.length-1)return;this._index=this._index+1;const e=t[this._index],n=ne.deserialize(e.xywh);this.edgeless.service.selection.set({elements:[e.id],editing:!1}),this.edgeless.service.viewport.setViewportByBound(n,[80,80,80,80],!0)}_navigateToPrev(){const{elements:t}=this._getElementsAndCounts();if(this._index<=0)return;this._index=this._index-1;const e=t[this._index],n=ne.deserialize(e.xywh);this.edgeless.service.selection.set({elements:[e.id],editing:!1}),this.edgeless.service.viewport.setViewportByBound(n,[80,80,80,80],!0)}_NavigatorComponent(t){const{viewport:e}=this.surface.edgeless.service,{zoom:n}=e,i=`navigator ${this._index>=0?"show":"hidden"}`,r=t[this._index],o=ne.deserialize(r.xywh),[s,a]=e.toViewCoord(o.x,o.y),[l,c]=[o.w*n,o.h*n],d=we({position:"absolute",transform:`translate(${s+l/2-26}px, ${a+c+16}px)`});return b`<div class=${i} style=${d}>
      <div class="edgeless-auto-connect-previous-button">
        ${nL}
      </div>
      <span></span>
      <div class="edgeless-auto-connect-next-button">
        ${iL}
      </div>
    </div> `}_PageVisibleIndexLabels(t,e){const{viewport:n}=this.edgeless.service,{zoom:i}=n;let r=0;return b`${Fe(t,o=>o.id,(o,s)=>{const a=ne.deserialize(o.xywh),[l,c]=n.toViewCoord(a.x,a.y),[d,u]=[a.w*i,a.h*i],h=we({width:`${A6}px`,maxWidth:`${A6}px`,height:`${Lf}px`,position:"absolute",transform:`translate(${l+d/2-A6/2}px,
          ${c+u+I_}px)`,display:"flex",justifyContent:"center",alignItems:"center"}),p=[],g=e[s],f=24/g-24,v=$6(f,g,Lf);for(let y=0;y<g;y++)r++,p.push(b`
            <div
              style=${we({position:"absolute",top:v[y][0]+"px",left:v[y][1]+"px",transition:"all 0.1s linear"})}
              index=${s}
              class="edgeless-index-label"
            >
              ${r}
              <affine-tooltip tip-position="bottom">
                ${L_(v8,"Page mode index")}
              </affine-tooltip>
            </div>
          `);function m(y,x){if(!y.target)return;const T=y.target.children;Array.from(T).forEach((M,k)=>{M.style.top=x[k][0]+"px",M.style.left=x[k][1]+"px"})}return b`<div
          style=${h}
          @mouseenter=${y=>{const x=$6(5,g,Lf);m(y,x)}}
          @mouseleave=${y=>{const x=$6(f,g,Lf);m(y,x)}}
        >
          ${p}
        </div>`})}`}_EdgelessOnlyLabels(){const{edgelessOnlyNotesSet:t}=this;return t.size?b`${Fe(t,e=>e.id,e=>{const{viewport:n}=this.edgeless.service,{zoom:i}=n,r=ne.deserialize(e.xywh),[o,s]=n.toViewCoord(r.x,r.y),[a,l]=[r.w*i,r.h*i],c=we({width:`${T_}px`,height:`${Ree}px`,borderRadius:"50%",backgroundColor:"var(--affine-text-secondary-color)",border:"1px solid var(--affine-border-color)",color:"var(--affine-white)",position:"absolute",transform:`translate(${o+a/2-T_/2}px,
          ${s+l+I_}px)`,display:"flex",justifyContent:"center",alignItems:"center"});return b`<div style=${c}>
          ${PI}
          <affine-tooltip tip-position="bottom">
            ${L_(v8,"Hidden on page")}
          </affine-tooltip>
        </div>`})}`:ae}render(){if(!this.show)return ae;const{elements:t,counts:e}=this._getElementsAndCounts();return b`${this._PageVisibleIndexLabels(t,e)}
    ${this._EdgelessOnlyLabels()}
    ${this._index>=0&&this._index<t.length?this._NavigatorComponent(t):ae} `}};$s.styles=X`
    .edgeless-index-label {
      font-size: 15px;
      text-align: center;
      height: 24px;
      min-width: 24px;
      padding: 0px 6px;
      width: fit-content;
      border-radius: 25px;
      border: 1px solid #0000001a;
      background: var(--affine-primary-color);
      color: var(--affine-white);
      cursor: pointer;
      user-select: none;
    }

    .navigator {
      width: 48px;
      padding: 4px;
      border-radius: 58px;
      border: 1px solid rgba(227, 226, 228, 1);
      transition: opacity 0.5s ease-in-out;
      background: rgba(251, 251, 252, 1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      opacity: 0;
    }

    .navigator div {
      display: flex;
      align-items: center;
      cursor: pointer;
    }

    .navigator span {
      display: inline-block;
      height: 8px;
      border: 1px solid rgba(227, 226, 228, 1);
    }

    .navigator div:hover {
      background: var(--affine-hover-color);
    }

    .navigator.show {
      opacity: 1;
    }
  `;$c([L({attribute:!1})],$s.prototype,"surface",2);$c([L({attribute:!1})],$s.prototype,"edgeless",2);$c([L({attribute:!1})],$s.prototype,"show",2);$c([L({attribute:!1})],$s.prototype,"pageVisibleElementsMap",2);$c([L({attribute:!1})],$s.prototype,"edgelessOnlyNotesSet",2);$c([ie()],$s.prototype,"_index",2);$s=$c([W("edgeless-index-label")],$s);var Nee=Object.defineProperty,Hee=Object.getOwnPropertyDescriptor,Fb=(t,e,n,i)=>{for(var r=i>1?void 0:i?Hee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Nee(e,n,r),r};let Jh=class extends Ae{_onSelect(t){this.value=t,this.onSelect&&this.onSelect(t)}render(){return b`
      <div class="shape-style-container">
        <edgeless-tool-icon-button
          class="general-shape-button"
          .tooltip=${"General"}
          .tipPosition=${"top"}
          .active=${this.value===dn.General}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(dn.General)}}
        >
          ${G1}
        </edgeless-tool-icon-button>
        <edgeless-tool-icon-button
          class="scribbled-shape-button"
          .tooltip=${"Scribbled"}
          .tipPosition=${"top"}
          .active=${this.value===dn.Scribbled}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(dn.Scribbled)}}
        >
          ${Z1}
        </edgeless-tool-icon-button>
      </div>
    `}};Jh.styles=X`
    .shape-style-container {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--affine-background-overlay-panel-color);
      z-index: 2;
      gap: 8px;
      padding: 0;
    }

    edgeless-tool-icon-button svg {
      fill: var(--affine-icon-color);
    }
  `;Fb([L({attribute:!1})],Jh.prototype,"value",2);Fb([L({attribute:!1})],Jh.prototype,"onSelect",2);Jh=Fb([W("edgeless-shape-style-panel")],Jh);var Fee=Object.defineProperty,Uee=Object.getOwnPropertyDescriptor,Ub=(t,e,n,i)=>{for(var r=i>1?void 0:i?Uee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Fee(e,n,r),r};let ep=class extends Ae{constructor(){super(...arguments),this.shapeStyle=dn.Scribbled,this.slots={select:new Ve}}_onSelect(t){this.selectedShape=t,this.slots.select.emit(t)}disconnectedCallback(){this.slots.select.dispose(),super.disconnectedCallback()}render(){return b`
      <div class="shape-panel-container">
        ${x3.map(({name:t,generalIcon:e,scribbledIcon:n,tooltip:i,disabled:r})=>b`
              <edgeless-tool-icon-button
                .disabled=${r}
                .tooltip=${i}
                .active=${this.selectedShape===t}
                .activeMode=${"background"}
                .iconContainerPadding=${2}
                @click=${()=>{r||this._onSelect(t)}}
              >
                ${this.shapeStyle===dn.General?e:n}
              </edgeless-tool-icon-button>
            `)}
      </div>
    `}};ep.styles=X`
    .shape-panel-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 40px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
      padding: 0 8px;
      gap: 8px;
      z-index: 2;
    }

    .shape-panel-container svg {
      fill: var(--affine-icon-color);
      stroke: none;
    }
  `;Ub([L({attribute:!1})],ep.prototype,"selectedShape",2);Ub([L({attribute:!1})],ep.prototype,"shapeStyle",2);ep=Ub([W("edgeless-shape-panel")],ep);var Vee=Object.defineProperty,zee=Object.getOwnPropertyDescriptor,Vb=(t,e,n,i)=>{for(var r=i>1?void 0:i?zee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Vee(e,n,r),r};let tp=class extends Ae{constructor(){super(...arguments),this.value=wt.Inter}_onSelect(t){this.value=t,this.onSelect&&this.onSelect(t)}render(){return b`
      <div class="font-family-container">
        <edgeless-tool-icon-button
          class="inter"
          .active=${this.value===wt.Inter}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.Inter)}}
        >
          <div class="font-family-button">Inter</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="kalam"
          .active=${this.value===wt.Kalam}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.Kalam)}}
        >
          <div class="font-family-button">Kalam</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="satoshi"
          .active=${this.value===wt.Satoshi}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.Satoshi)}}
        >
          <div class="font-family-button">Satoshi</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="poppins"
          .active=${this.value===wt.Poppins}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.Poppins)}}
        >
          <div class="font-family-button">Poppins</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="lora"
          .active=${this.value===wt.Lora}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.Lora)}}
        >
          <div class="font-family-button">Lora</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="bebas-neue"
          .active=${this.value===wt.BebasNeue}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.BebasNeue)}}
        >
          <div class="font-family-button">Bebas Neue</div>
        </edgeless-tool-icon-button>

        <edgeless-tool-icon-button
          class="orelega-one"
          .active=${this.value===wt.OrelegaOne}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(wt.OrelegaOne)}}
        >
          <div class="font-family-button">Orelega One</div>
        </edgeless-tool-icon-button>
      </div>
    `}};tp.styles=X`
    :host {
      display: flex;
    }

    .font-family-container {
      display: flex;
      flex-direction: column;
      align-items: start;
      justify-content: center;
      background: var(--affine-background-overlay-panel-color);
      gap: 8px;
      padding: 8px;
      border-radius: 8px;
    }

    .font-family-container edgeless-tool-icon-button {
      width: 100%;
    }

    .inter {
      font-family: ${Je(kl(wt.Inter))},
        sans-serif;
    }

    .kalam {
      font-family: ${Je(kl(wt.Kalam))},
        sans-serif;
    }

    .satoshi {
      font-family: ${Je(kl(wt.Satoshi))},
        sans-serif;
    }

    .poppins {
      font-family: ${Je(kl(wt.Poppins))},
        sans-serif;
    }

    .lora {
      font-family: ${Je(kl(wt.Lora))},
        sans-serif;
    }

    .bebas-neue {
      font-family: ${Je(kl(wt.BebasNeue))},
        sans-serif;
    }

    .orelega-one {
      font-family: ${Je(kl(wt.OrelegaOne))},
        sans-serif;
    }
  `;Vb([L({attribute:!1})],tp.prototype,"value",2);Vb([L({attribute:!1})],tp.prototype,"onSelect",2);tp=Vb([W("edgeless-font-family-panel")],tp);var jee=Object.defineProperty,Gee=Object.getOwnPropertyDescriptor,ll=(t,e,n,i)=>{for(var r=i>1?void 0:i?Gee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&jee(e,n,r),r};const Zee=1,Wee=200;let Io=class extends Ae{constructor(){super(...arguments),this.labels=["Small","Medium","Large","Huge"],this.minSize=Zee,this.maxSize=Wee,this._onKeydown=t=>{if(t.stopPropagation(),t.key==="Enter"&&!t.isComposing){t.preventDefault();const e=t.target;if(isNaN(parseInt(e.value))){e.value="";return}let n=parseInt(e.value);n<this.minSize?n=this.minSize:n>this.maxSize&&(n=this.maxSize),this._onSelect(n),e.value="",this._onPopperClose()}}}_onSelect(t){this.onSelect&&this.onSelect(t)}_onPopperClose(){this.onPopperCose&&this.onPopperCose()}render(){return b`
      <div class="size-container">
        <div class="size-content">
          ${Fe(this.sizes,t=>t,(t,e)=>b` <div
                class="size-button"
                role="button"
                ?active=${this.size===t}
                @click=${()=>{this._onSelect(t)}}
              >
                <div class="size-button-label">${this.labels[e]}</div>
              </div>`)}

          <div
            class="size-input-container"
            @click=${t=>{t.preventDefault(),t.stopPropagation()}}
          >
            <input
              class="size-input"
              type="text"
              inputmode="numeric"
              pattern="[0-9]*"
              placeholder=${Math.trunc(this.size)}
              @keydown=${this._onKeydown}
              @input=${at}
              @pointerdown=${at}
            />
          </div>
        </div>
      </div>
    `}};Io.styles=X`
    :host {
      box-shadow: var(--affine-menu-shadow);
    }

    .size-container {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4px 8px;
      background: var(--affine-background-overlay-panel-color);
      border-radius: 8px;
    }

    .size-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 64px;
    }

    .size-button {
      display: flex;
      align-items: center;
      justify-content: start;
      width: 64px;
      height: 32px;
      padding: 0 8px;
    }

    .size-button[active] .size-button-label {
      background: var(--affine-hover-color);
    }

    .size-button-label {
      text-align: justify;
      font-size: 15px;
      font-style: normal;
      width: 48px;
      height: 24px;
      font-weight: 400;
      line-height: 24px;
      color: var(--affine-icon-color);
      padding: 0 8px;
      border-radius: 4px;
    }

    .size-button-label:hover {
      cursor: pointer;
      background: var(--affine-hover-color);
    }

    .size-input-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .size-input {
      width: 48px;
      height: 18px;
      border: 1px solid var(--affine-border-color);
      border-radius: 8px;
      padding: 4px 8px;
    }

    .size-input::placeholder {
      color: var(--affine-placeholder-color);
    }

    .size-input:focus {
      outline-color: var(--affine-primary-color);
    }

    menu-divider {
      width: 100%;
    }
  `;ll([L({attribute:!1})],Io.prototype,"size",2);ll([L({attribute:!1})],Io.prototype,"sizes",2);ll([L({attribute:!1})],Io.prototype,"labels",2);ll([L({attribute:!1})],Io.prototype,"onSelect",2);ll([L({attribute:!1})],Io.prototype,"onPopperCose",2);ll([L({attribute:!1})],Io.prototype,"minSize",2);ll([L({attribute:!1})],Io.prototype,"maxSize",2);Io=ll([W("edgeless-size-panel")],Io);var qee=Object.defineProperty,Yee=Object.getOwnPropertyDescriptor,T0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Yee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qee(e,n,r),r};let nc=class extends Ae{constructor(){super(...arguments),this.fontFamily=wt.Inter,this.fontWeight=us.Regular,this.fontStyle=ti.Normal}_onSelect(t,e=ti.Normal){this.fontWeight=t,this.fontStyle=e,this.onSelect&&this.onSelect(t,e)}_isDisabled(t,e=ti.Normal){return zD.includes(this.fontFamily)?![...document.fonts.keys()].find(r=>r.family===this.fontFamily&&r.weight===t&&r.style===e):!1}_isActive(t,e=ti.Normal){return this.fontWeight===t&&this.fontStyle===e}render(){let t=Mx(this.fontFamily);t.length===0&&(t=Mx(wt.Inter));const e=t.filter(i=>i.style===ti.Normal),n=t.filter(i=>i.style===ti.Italic);return b`
      <div class="container">
        ${e.length>0?b`${e.map(i=>b`
                <edgeless-tool-icon-button
                  class=${i.weight}
                  .disabled=${this._isDisabled(i.weight)}
                  .active=${this._isActive(i.weight)}
                  .activeMode=${"background"}
                  .iconContainerPadding=${2}
                  @click=${()=>{this._onSelect(i.weight)}}
                >
                  <div>
                    ${i.weight===us.Light?"Light":i.weight===us.Regular?"Regular":"Semibold"}
                  </div>
                </edgeless-tool-icon-button>
              `)}`:ae}
        ${n.length>0?b`<component-toolbar-menu-divider
                .vertical=${!1}
              ></component-toolbar-menu-divider>

              ${n.map(i=>b`
                  <edgeless-tool-icon-button
                    class="${i.weight} italic"
                    .disabled=${this._isDisabled(i.weight,ti.Italic)}
                    .active=${this._isActive(i.weight,ti.Italic)}
                    .activeMode=${"background"}
                    .iconContainerPadding=${2}
                    @click=${()=>{this._onSelect(i.weight,ti.Italic)}}
                  >
                    <div>
                      ${i.weight===us.Light?"Light Italic":i.weight===us.Regular?"Regular Italic":"Semibold Italic"}
                    </div>
                  </edgeless-tool-icon-button>
                `)} `:ae}
      </div>
    `}};nc.styles=X`
    :host {
      display: flex;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: start;
      justify-content: center;
      background: var(--affine-background-overlay-panel-color);
      gap: 8px;
      padding: 8px;
      border-radius: 8px;
    }

    .container edgeless-tool-icon-button {
      width: 100%;
    }

    component-toolbar-menu-divider {
      width: 100%;
    }
  `;T0([L({attribute:!1})],nc.prototype,"fontFamily",2);T0([L({attribute:!1})],nc.prototype,"fontWeight",2);T0([L({attribute:!1})],nc.prototype,"fontStyle",2);T0([L({attribute:!1})],nc.prototype,"onSelect",2);nc=T0([W("edgeless-font-weight-and-style-panel")],nc);var Xee=Object.defineProperty,Kee=Object.getOwnPropertyDescriptor,Ln=(t,e,n,i)=>{for(var r=i>1?void 0:i?Kee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Xee(e,n,r),r};let un=class extends me(Ae){constructor(){super(...arguments),this._textColorPopperShow=!1,this._fontSizePopperShow=!1,this._fontWeightPopperShow=!1,this._fontFamilyPopperShow=!1,this._textAlignPopperShow=!1,this._colorSelectorPopper=null,this._textAlignPopper=null,this._textFontFamilyPopper=null,this._textFontSizePopper=null,this._textFontWeightAndStylePopper=null,this._getMostCommonFontFamily=t=>{const e=_n(t,i=>i.fontFamily),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:r0.Inter},this._getMostCommonFontSize=t=>{const e=_n(t,i=>i.fontSize),n=Cn(Object.entries(e),([i,r])=>r);return n?Number(n[0]):16},this._getMostCommonFontWeight=t=>{const e=_n(t,i=>i.fontWeight),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:ha.Regular},this._getMostCommonFontStyle=t=>{const e=_n(t,i=>i.fontStyle),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:ti.Normal},this._getMostCommonColor=t=>{const e=_n(t,i=>i.color),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:_a()},this._getMostCommonAlign=t=>{const e=_n(t,i=>i.textAlign),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:v0.Left},this._updateElementBound=t=>{if(this.elementType===kn.TEXT){const n=gT(t,new ne(t.x,t.y,t.w,t.h));this.service.updateElement(t.id,{xywh:n.serialize()})}else{const n=k9(t,new ne(t.x,t.y,t.w,t.h));this.service.updateElement(t.id,{xywh:n.serialize()})}},this._setTextColor=t=>{this.elements.forEach(e=>{this.service.updateElement(e.id,{color:t})})},this._setTextAlign=t=>{this.elements.forEach(e=>{this.service.updateElement(e.id,{textAlign:t})})},this._setFontFamily=t=>{const e=this._getMostCommonFontWeight(this.elements),n=dq(t,e)?e:ha.Regular,i=this._getMostCommonFontStyle(this.elements),r=uq(t,i)?i:ti.Normal;this.elements.forEach(o=>{this.service.updateElement(o.id,{fontFamily:t,fontWeight:n,fontStyle:r}),this._updateElementBound(o)})},this._setFontSize=t=>{this.elements.forEach(e=>{this.service.updateElement(e.id,{fontSize:t}),this._updateElementBound(e)})},this._setFontWeightAndStyle=(t,e)=>{this.elements.forEach(n=>{this.service.updateElement(n.id,{fontWeight:t,fontStyle:e}),this._updateElementBound(n)})}}get service(){return this.surface.edgeless.service}firstUpdated(t){const e=this._disposables;this._colorSelectorPopper=Nt(this._textColorButton,this._textColorMenu,({display:n})=>{this._textColorPopperShow=n==="show"}),e.add(this._colorSelectorPopper),this._textFontFamilyPopper=Nt(this._textFontFamilyButton,this._textFontFamilyMenu,({display:n})=>{this._fontFamilyPopperShow=n==="show"}),e.add(this._textFontFamilyPopper),this._textAlignPopper=Nt(this._textAlignButton,this._textAlignMenu,({display:n})=>{this._textAlignPopperShow=n==="show"}),e.add(this._textAlignPopper),this._textFontSizePopper=Nt(this._textFontSizeButton,this._textFontSizeMenu,({display:n})=>{this._fontSizePopperShow=n==="show"}),e.add(this._textFontSizePopper),this._textFontWeightAndStylePopper=Nt(this._textFontWeightAndStyleButton,this._textFontWeightAndStyleMenu,({display:n})=>{this._fontWeightPopperShow=n==="show"}),e.add(this._textFontWeightAndStylePopper),super.firstUpdated(t)}render(){const t=this._getMostCommonColor(this.elements),e=this._getMostCommonAlign(this.elements),n=this._getMostCommonFontFamily(this.elements),i=Math.trunc(this._getMostCommonFontSize(this.elements)),r=this._getMostCommonFontWeight(this.elements),o=this._getMostCommonFontStyle(this.elements),s=C9(n);return b`
      ${this.elementType==="shape"?ae:b`<edgeless-tool-icon-button
              class="text-color-button"
              .tooltip=${this._textColorPopperShow?"":"Text Color"}
              .tipPosition=${"bottom"}
              .active=${!1}
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              @click=${()=>this._colorSelectorPopper?.toggle()}
            >
              <div class="text-color-unit-container">
                ${Ca(t)}
              </div>
            </edgeless-tool-icon-button>
            <div class="color-panel-container text-color">
              <edgeless-color-panel
                .value=${t}
                .options=${q1}
                @select=${a=>{this._setTextColor(a.detail)}}
              ></edgeless-color-panel>
            </div>
            <component-toolbar-menu-divider></component-toolbar-menu-divider>`}

      <edgeless-tool-icon-button
        class="text-font-family-button"
        .tooltip=${this._fontSizePopperShow?"":"Font"}
        .tipPosition=${"bottom"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._textFontFamilyPopper?.toggle()}
      >
        <div class="button-with-arrow-group">
          <span style=${`font-family:"${n}";`}>Aa</span
          >${Pi}
        </div>
      </edgeless-tool-icon-button>
      <div class="font-family-panel-container text-font-family">
        <edgeless-font-family-panel
          .value=${n}
          .onSelect=${a=>this._setFontFamily(a)}
        ></edgeless-font-family-panel>
      </div>

      ${this.elementType==="shape"?b`<edgeless-tool-icon-button
              class="text-color-button shape"
              .tooltip=${this._textColorPopperShow?"":"Text Color"}
              .tipPosition=${"bottom"}
              .active=${!1}
              .activeMode=${"background"}
              .iconContainerPadding=${2}
              @click=${()=>this._colorSelectorPopper?.toggle()}
            >
              <div class="text-color-unit-container">
                ${Ca(t)}
              </div>
            </edgeless-tool-icon-button>
            <div class="color-panel-container text-color">
              <edgeless-color-panel
                .value=${t}
                .options=${q1}
                @select=${a=>{this._setTextColor(a.detail)}}
              ></edgeless-color-panel>
            </div>`:ae}

      <component-toolbar-menu-divider></component-toolbar-menu-divider>

      <edgeless-tool-icon-button
        class="text-font-size-button"
        .tooltip=${this._fontFamilyPopperShow?"":"Font Size"}
        .tipPosition=${"bottom"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._textFontSizePopper?.toggle()}
      >
        <div class="font-size-button-group">
          <div class="selected-font-size-label">${i}</div>
          <div class="arrow-down-icon">${Ph}</div>
        </div>
      </edgeless-tool-icon-button>
      <div class="font-size-panel-container text-font-size">
        <edgeless-size-panel
          .size=${i}
          .labels=${["16","24","32","36","40","64","128"]}
          .sizes=${[16,24,32,36,40,64,128]}
          .onSelect=${a=>{this._setFontSize(a)}}
          .onPopperCose=${()=>this._textFontSizePopper?.hide()}
        ></edgeless-size-panel>
      </div>

      <component-toolbar-menu-divider></component-toolbar-menu-divider>

      <edgeless-tool-icon-button
        class="text-font-weight-and-style-button"
        .disabled=${s.length===1&&s[0].style===o&&s[0].weight===r}
        .tooltip=${this._fontWeightPopperShow?"":"Font Style"}
        .tipPosition=${"bottom"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._textFontWeightAndStylePopper?.toggle()}
      >
        <div class="button-with-arrow-group">
          <span
            >${`${r===ha.Light?"Light":r===ha.Regular?"Regular":"Semibold"}${o===ti.Italic?" Italic":""}`}</span
          >${Pi}
        </div>
      </edgeless-tool-icon-button>
      <div class="font-weight-and-style-panel-container">
        <edgeless-font-weight-and-style-panel
          .fontFamily=${n}
          .fontWeight=${r}
          .fontStyle=${o}
          .onSelect=${(a,l)=>this._setFontWeightAndStyle(a,l)}
        ></edgeless-font-weight-and-style-panel>
      </div>

      <component-toolbar-menu-divider></component-toolbar-menu-divider>

      <edgeless-tool-icon-button
        class="text-align-button"
        .tooltip=${this._textAlignPopperShow?"":"Alignment"}
        .tipPosition=${"bottom"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._textAlignPopper?.toggle()}
      >
        <div class="button-with-arrow-group">
          ${e==="left"?R9:e==="center"?N9:H9}
          ${Pi}
        </div>
      </edgeless-tool-icon-button>
      <div class="align-panel-container text-align">
        <edgeless-align-panel
          .value=${e}
          .onSelect=${a=>{this._setTextAlign(a)}}
        ></edgeless-align-panel>
      </div>
    `}};un.styles=X`
    :host {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      color: var(--affine-text-primary-color);
      stroke: none;
      fill: currentColor;
    }

    .text-color-unit-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 20px;
      height: 20px;
    }

    .color-panel-container,
    .align-panel-container.text-align,
    .font-size-panel-container,
    .font-family-panel-container,
    .font-weight-and-style-panel-container {
      display: none;
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
    }

    .color-panel-container[data-show],
    .align-panel-container[data-show],
    .font-size-panel-container[data-show],
    .font-family-panel-container[data-show],
    .font-weight-and-style-panel-container[data-show] {
      display: block;
    }

    .button-with-arrow-group {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .font-size-button-group {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 60px;
      height: 24px;
    }

    .font-size-button-group .selected-font-size-label {
      width: 40px;
      height: 20px;
      line-height: 20px;
      font-family: ${Je(vt.fontSansFamily)};
      font-size: 16px;
      font-style: normal;
      font-weight: 400;
    }

    .font-size-button-group .arrow-down-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .selected-font-size {
      align-self: end;
    }

    .text-align-button svg {
      fill: var(--affine-icon-color);
      stroke: none;
    }

    component-toolbar-menu-divider {
      margin: 0 12px;
      height: 24px;
    }

    .text-color-button.shape {
      margin-left: 12px;
    }
  `;Ln([L({attribute:!1})],un.prototype,"elements",2);Ln([L({attribute:!1})],un.prototype,"elementType",2);Ln([L({attribute:!1})],un.prototype,"surface",2);Ln([ie()],un.prototype,"_textColorPopperShow",2);Ln([ie()],un.prototype,"_fontSizePopperShow",2);Ln([ie()],un.prototype,"_fontWeightPopperShow",2);Ln([ie()],un.prototype,"_fontFamilyPopperShow",2);Ln([ie()],un.prototype,"_textAlignPopperShow",2);Ln([he(".text-color-button")],un.prototype,"_textColorButton",2);Ln([he(".color-panel-container.text-color")],un.prototype,"_textColorMenu",2);Ln([he(".text-align-button")],un.prototype,"_textAlignButton",2);Ln([he(".align-panel-container.text-align")],un.prototype,"_textAlignMenu",2);Ln([he(".text-font-family-button")],un.prototype,"_textFontFamilyButton",2);Ln([he(".font-family-panel-container")],un.prototype,"_textFontFamilyMenu",2);Ln([he(".text-font-size-button")],un.prototype,"_textFontSizeButton",2);Ln([he(".font-size-panel-container")],un.prototype,"_textFontSizeMenu",2);Ln([he(".text-font-weight-and-style-button")],un.prototype,"_textFontWeightAndStyleButton",2);Ln([he(".font-weight-and-style-panel-container")],un.prototype,"_textFontWeightAndStyleMenu",2);un=Ln([W("edgeless-change-text-menu")],un);var Qee=Object.defineProperty,Jee=Object.getOwnPropertyDescriptor,UM=(t,e,n,i)=>{for(var r=i>1?void 0:i?Jee(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Qee(e,n,r),r};let c5=class extends Ae{constructor(){super(...arguments),this.vertical=!0}render(){return b`<div
      class="divider-container ${this.vertical?"vertical":"horizontal"}"
    >
      <div class="divider"></div>
    </div>`}};c5.styles=X`
    .divider-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .divider {
      background-color: var(--affine-border-color);
    }

    .vertical {
      width: 4px;
      height: 100%;
    }

    .vertical .divider {
      width: 1px;
      height: 100%;
    }

    .horizontal {
      width: 100%;
      height: 4px;
    }

    .horizontal .divider {
      width: 100%;
      height: 1px;
    }
  `;UM([L({type:Boolean})],c5.prototype,"vertical",2);c5=UM([W("component-toolbar-menu-divider")],c5);const ete=[X`
    .edgeless-component-line-size-button {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 16px;
      height: 16px;
    }

    .edgeless-component-line-size-button div {
      border-radius: 50%;
      background-color: var(--affine-icon-color);
    }

    .edgeless-component-line-size-button.size-s div {
      width: 4px;
      height: 4px;
    }
    .edgeless-component-line-size-button.size-l div {
      width: 10px;
      height: 10px;
    }
  `],tte=[X`
    .edgeless-component-line-style-button {
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--affine-icon-color);
    }

    .line-style-button:nth-of-type(2),
    .line-style-button:nth-of-type(3) {
      margin-left: 8px;
    }
  `];function nte(t){switch(t){case"solid":return Mh;case"dash":return O9;case"none":return kI}}function ite(t){return{solid:"Solid",dash:"Dash",none:"None"}[t]}function rte({className:t,mode:e,active:n,tooltip:i,onClick:r}){const o=`edgeless-component-line-style-button mode-${e} ${n?"active":""}`,s=nte(e),a=i!==void 0?i:ite(e);return b`<edgeless-tool-icon-button
    class=${t??""}
    .active=${n??!1}
    .activeMode=${"background"}
    .tooltip=${a}
    .iconContainerPadding=${2}
    @click=${r}
  >
    <div class=${o}>${s}</div>
  </edgeless-tool-icon-button>`}const ote=[X`
    .edgeless-component-panel-wrapper {
      display: flex;
      padding: 4px;
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
    }
  `];function ste({children:t,className:e}){const n=`edgeless-component-panel-wrapper ${e||""}`;return b`<div class=${n}>${t}</div>`}const VM=[ote,tte];function zM({onClick:t,selectedLineSize:e,selectedLineStyle:n,lineStyle:i=["solid","dash","none"]}={}){const r=b`
    <edgeless-line-width-panel
      .selectedSize=${e}
      .disable=${n==="none"}
      @select=${s=>{t?.({type:"size",value:s.detail})}}
    ></edgeless-line-width-panel>
  `,o=Fe(i,s=>s,s=>rte({className:"line-style-button",mode:s,active:s===n,onClick:()=>{t?.({type:"lineStyle",value:s})}}));return ste({className:"line-style-panel",children:b`
      ${r}
      <component-toolbar-menu-divider></component-toolbar-menu-divider>
      ${o}
    `})}var ate=Object.defineProperty,lte=Object.getOwnPropertyDescriptor,ki=(t,e,n,i)=>{for(var r=i>1?void 0:i?lte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ate(e,n,r),r};const Xu=2;function cte(t){const e=_n(t,i=>i.shapeType==="rect"&&i.radius?"roundedRect":i.shapeType),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:null}function dte(t){const e=_n(t,i=>i.filled?i.fillColor:"--affine-palette-transparent"),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:null}function ute(t){const e=_n(t,i=>i.strokeColor),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:null}function hte(t){const e=_n(t,i=>i.strokeWidth),n=Cn(Object.entries(e),([i,r])=>r);return n?Number(n[0]):Rt.LINE_WIDTH_FOUR}function pte(t){const e=_n(t,i=>{switch(i.strokeStyle){case"solid":return"solid";case"dash":return"dash";case"none":return"none"}}),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:null}function fte(t){return t.every(e=>e.text)}function gte(t){const e=_n(t,i=>i.shapeStyle),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:dn.Scribbled}let Yn=class extends me(Ae){constructor(){super(...arguments),this.elements=[],this._showPopper=!1,this._shapePanelPopper=null,this._shapeStyleMenuPopper=null,this._fillColorMenuPopper=null,this._strokeColorMenuPopper=null,this._lineStylesPanelPopper=null}get service(){return this.surface.edgeless.service}_getTextColor(t){return Y1(t)?_a():t===lM?sM:aM}_setShapeFillColor(t){const e=this._getTextColor(t),n=!Y1(t);this.elements.forEach(i=>{this.service.updateElement(i.id,{filled:n,fillColor:t,color:e})})}_setShapeStrokeColor(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{strokeColor:t})})}_setShapeStrokeWidth(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{strokeWidth:t})})}_setShapeStrokeStyle(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{strokeStyle:t})})}_setShapeStyles({type:t,value:e}){if(t==="size"){const n=e;this._setShapeStrokeWidth(n)}else if(t==="lineStyle")switch(e){case"solid":{this._setShapeStrokeStyle(Yt.Solid);break}case"dash":{this._setShapeStrokeStyle(Yt.Dashed);break}case"none":{this._setShapeStrokeStyle(Yt.None);break}}}_setShapeStyle(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{shapeStyle:t,fontFamily:t===dn.General?wt.Inter:wt.Kalam})})}firstUpdated(t){const e=this._disposables;this._shapePanelPopper=Nt(this._changeShapeButton,this._shapePanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._shapePanelPopper),e.add(this._shapePanel.slots.select.on(n=>{const i=n==="roundedRect"?{shapeType:qd.Rect,radius:.1}:{shapeType:n,radius:0};this.page.captureSync(),this.elements.forEach(r=>{this.service.updateElement(r.id,i)})})),this._fillColorMenuPopper=Nt(this._fillColorButton,this._fillColorMenu,({display:n})=>{this._showPopper=n==="show"}),e.add(this._fillColorMenuPopper),this._strokeColorMenuPopper=Nt(this._strokeColorButton,this._strokeColorMenu,({display:n})=>{this._showPopper=n==="show"}),e.add(this._strokeColorMenuPopper),this._lineStylesPanelPopper=Nt(this._lineStylesButton,this._lineStylesPanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._lineStylesPanelPopper),this._shapeStyleMenuPopper=Nt(this._shapeStyleButton,this._shapeStyleMenu,({display:n})=>{this._showPopper=n==="show"}),e.add(this._shapeStyleMenuPopper),super.firstUpdated(t)}render(){const t=cte(this.elements),e=dte(this.elements)??t8[0],n=ute(this.elements)??n8[0],i=hte(this.elements)??Rt.LINE_WIDTH_FOUR,r=pte(this.elements)??"solid",o=gte(this.elements)??dn.Scribbled;return b`
      <div class="change-shape-toolbar-container">
        <edgeless-tool-icon-button
          .tooltip=${this._showPopper?"":"Switch Type"}
          .tipPosition=${"bottom"}
          .active=${!1}
          .iconContainerPadding=${Xu}
          @click=${()=>this._shapePanelPopper?.toggle()}
        >
          <div class="change-shape-button">
            ${ZI} ${Ph}
          </div>
        </edgeless-tool-icon-button>
        <edgeless-shape-panel
          .selectedShape=${t}
          .shapeStyle=${o}
        >
        </edgeless-shape-panel>

        <component-toolbar-menu-divider></component-toolbar-menu-divider>

        <edgeless-tool-icon-button
          .tooltip=${this._showPopper?"":"Style"}
          .tipPosition=${"bottom"}
          .active=${!1}
          .iconContainerPadding=${Xu}
          @click=${()=>this._shapeStyleMenuPopper?.toggle()}
        >
          <div class="shape-style-button">
            ${o===dn.General?G1:Z1}
            ${Ph}
          </div>
        </edgeless-tool-icon-button>
        <div class="shape-style-panel-container">
          <edgeless-shape-style-panel
            .value=${o}
            .onSelect=${s=>{this._setShapeStyle(s)}}
          >
          </edgeless-shape-style-panel>
        </div>

        <component-toolbar-menu-divider></component-toolbar-menu-divider>

        <edgeless-tool-icon-button
          class="fill-color-button"
          .tooltip=${this._showPopper?"":"Fill color"}
          .tipPosition=${"bottom"}
          .active=${!1}
          .iconContainerPadding=${Xu}
          @click=${()=>this._fillColorMenuPopper?.toggle()}
        >
          <div class="fill-color-container">
            ${Ca(e)}
          </div>
        </edgeless-tool-icon-button>
        <div class="color-panel-container fill-color">
          <edgeless-color-panel
            .value=${e}
            .options=${t8}
            @select=${s=>this._setShapeFillColor(s.detail)}
          >
          </edgeless-color-panel>
        </div>

        <component-toolbar-menu-divider></component-toolbar-menu-divider>

        <edgeless-tool-icon-button
          class="stroke-color-button"
          .tooltip=${this._showPopper?"":"Border color"}
          .tipPosition=${"bottom"}
          .active=${!1}
          .iconContainerPadding=${Xu}
          @click=${()=>this._strokeColorMenuPopper?.toggle()}
        >
          <div class="stroke-color-container">
            ${Ca(n,{hollowCircle:!0})}
          </div>
        </edgeless-tool-icon-button>
        <div class="color-panel-container stroke-color">
          <edgeless-color-panel
            .value=${n}
            .options=${n8}
            .hollowCircle=${!0}
            @select=${s=>this._setShapeStrokeColor(s.detail)}
          >
          </edgeless-color-panel>
        </div>

        <edgeless-tool-icon-button
          class="border-styles-button"
          .tooltip=${this._showPopper?"":"Border style"}
          .tipPosition=${"bottom"}
          .active=${!1}
          .iconContainerPadding=${Xu}
          @click=${()=>this._lineStylesPanelPopper?.toggle()}
        >
          <div class="line-styles-button">
            ${d3} ${Ph}
          </div>
        </edgeless-tool-icon-button>
        ${zM({selectedLineSize:i,selectedLineStyle:r,onClick:s=>{this._setShapeStyles(s)}})}
        ${fte(this.elements)?b`<component-toolbar-menu-divider></component-toolbar-menu-divider>
              <edgeless-change-text-menu
                .elements=${this.elements}
                .elementType=${"shape"}
                .surface=${this.surface}
              ></edgeless-change-text-menu>`:ae}
      </div>
    `}};Yn.styles=[ete,VM,X`
      .change-shape-toolbar-container {
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--affine-text-primary-color);
        stroke: none;
        fill: currentColor;
      }

      edgeless-shape-panel {
        display: none;
      }

      edgeless-shape-panel[data-show] {
        display: flex;
      }

      .change-shape-button,
      .shape-style-button,
      .line-styles-button {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .change-shape-button svg,
      .shape-style-button svg,
      .line-styles-button svg {
        fill: var(--affine-icon-color);
      }

      .border-styles-button {
        margin-left: 12px;
      }

      .fill-color-container,
      .stroke-color-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 20px;
        height: 20px;
      }

      .color-panel-container,
      .shape-style-panel-container {
        display: none;
        justify-content: center;
        align-items: center;
        background: var(--affine-background-overlay-panel-color);
        box-shadow: var(--affine-shadow-2);
        border-radius: 8px;
      }

      .shape-style-panel-container {
        padding: 8px;
      }

      .color-panel-container[data-show],
      .shape-style-panel-container[data-show] {
        display: flex;
      }

      .shape-color-button-indicator {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 24px;
        height: 24px;
        box-sizing: border-box;
        border-radius: 4px;
        cursor: pointer;
      }

      .shape-color-button-indicator div {
        border-radius: 50%;
        width: 16px;
        height: 16px;
      }

      .line-style-panel {
        display: none;
        padding: 6px;
      }

      .line-style-panel component-toolbar-menu-divider {
        margin: 0 8px;
      }

      .line-style-panel[data-show] {
        display: flex;
      }

      component-toolbar-menu-divider {
        margin: 0 12px;
        height: 24px;
      }
    `];ki([L({attribute:!1})],Yn.prototype,"elements",2);ki([L({attribute:!1})],Yn.prototype,"page",2);ki([L({attribute:!1})],Yn.prototype,"surface",2);ki([ie()],Yn.prototype,"_showPopper",2);ki([he(".change-shape-button")],Yn.prototype,"_changeShapeButton",2);ki([he("edgeless-shape-panel")],Yn.prototype,"_shapePanel",2);ki([he(".shape-style-button")],Yn.prototype,"_shapeStyleButton",2);ki([he(".shape-style-panel-container")],Yn.prototype,"_shapeStyleMenu",2);ki([he(".fill-color-button")],Yn.prototype,"_fillColorButton",2);ki([he(".color-panel-container.fill-color")],Yn.prototype,"_fillColorMenu",2);ki([he(".stroke-color-button")],Yn.prototype,"_strokeColorButton",2);ki([he(".color-panel-container.stroke-color")],Yn.prototype,"_strokeColorMenu",2);ki([he(".line-styles-button")],Yn.prototype,"_lineStylesButton",2);ki([he(".line-style-panel")],Yn.prototype,"_lineStylesPanel",2);Yn=ki([W("edgeless-change-shape-button")],Yn);var mte=Object.defineProperty,bte=Object.getOwnPropertyDescriptor,Xs=(t,e,n,i)=>{for(var r=i>1?void 0:i?bte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&mte(e,n,r),r};class vte extends Event{constructor(e,{detail:n,composed:i,bubbles:r}){super(e,{bubbles:r,composed:i}),this.detail=n}}let Kr=class extends me(Ae){constructor(){super(...arguments),this.selectedSize=Rt.LINE_WIDTH_TWO,this.hasTooltip=!0,this.disable=!1,this._dragConfig=null,this._updateIconsColor=()=>{if(!this._dragHandle.offsetParent){requestAnimationFrame(()=>this._updateIconsColor());return}const t=this._dragHandle.getBoundingClientRect(),e=t.left+t.width/2,n=Array.from(this._lineWidthIcons),i=n.filter(o=>{const s=o.getBoundingClientRect();return s.left+s.width/2<e}),r=n.filter(o=>{const s=o.getBoundingClientRect();return s.left+s.width/2>e});i.forEach(o=>o.style.backgroundColor="var(--affine-icon-color)"),r.forEach(o=>o.style.backgroundColor="var(--affine-border-color)")},this._getDragHandlePosition=(t,e)=>{const n=t.clientX,{boundLeft:i,bottomLineWidth:r,stepWidth:o,containerWidth:s}=e;let a;n<=i?a=0:n-i>=s?a=100:a=Math.floor((n-i)/o);const c=(r-4)/100;return a*c},this._onPointerDown=t=>{if(t.preventDefault(),this.disable)return;const{left:e,width:n}=this._lineWidthPanel.getBoundingClientRect(),i=this._bottomLine.getBoundingClientRect().width;this._dragConfig={stepWidth:n/100,boundLeft:e,containerWidth:n,bottomLineWidth:i},this._onPointerMove(t)},this._onPointerMove=t=>{if(t.preventDefault(),!this._dragConfig)return;const e=this._getDragHandlePosition(t,this._dragConfig);this._dragHandle.style.left=`${e}%`,this._lineWidthOverlay.style.width=`${e}%`,this._updateIconsColor()},this._onPointerUp=t=>{if(t.preventDefault(),!this._dragConfig)return;const e=this._getDragHandlePosition(t,this._dragConfig);this._updateLineWidthPanelByDragHandlePosition(e),this._dragConfig=null},this._onPointerOut=t=>{if(t.preventDefault(),!this._dragConfig)return;const e=this._getDragHandlePosition(t,this._dragConfig);this._updateLineWidthPanelByDragHandlePosition(e),this._dragConfig=null}}_updateLineWidthPanel(t){if(!this._lineWidthOverlay)return;let e=0,n=0;switch(t){case Rt.LINE_WIDTH_TWO:e=0;break;case Rt.LINE_WIDTH_FOUR:e=16,n=1;break;case Rt.LINE_WIDTH_SIX:e=32,n=2;break;case Rt.LINE_WIDTH_EIGHT:e=48,n=3;break;case Rt.LINE_WIDTH_TEN:e=64,n=4;break;default:e=80,n=4}n+=4,this._lineWidthOverlay.style.width=`${e}%`,this._dragHandle.style.left=`${e}%`,this._dragHandle.style.transform=`translateY(-50%) translateX(${n}px)`,this._updateIconsColor()}_updateLineWidthPanelByDragHandlePosition(t){let e=this.selectedSize;t<=12?e=Rt.LINE_WIDTH_TWO:t>12&&t<=26?e=Rt.LINE_WIDTH_FOUR:t>26&&t<=40?e=Rt.LINE_WIDTH_SIX:t>40&&t<=54?e=Rt.LINE_WIDTH_EIGHT:t>54&&t<=68?e=Rt.LINE_WIDTH_TEN:e=Rt.LINE_WIDTH_TWELVE,this._updateLineWidthPanel(e),this._onSelect(e)}_onSelect(t){t!==this.selectedSize&&(this.dispatchEvent(new vte("select",{detail:t,composed:!0,bubbles:!0})),this.selectedSize=t)}firstUpdated(){this._updateLineWidthPanel(this.selectedSize),this._disposables.addFromEvent(this,"pointerdown",this._onPointerDown),this._disposables.addFromEvent(this,"pointermove",this._onPointerMove),this._disposables.addFromEvent(this,"pointerup",this._onPointerUp),this._disposables.addFromEvent(this,"pointerout",this._onPointerOut)}disconnectedCallback(){this._disposables.dispose()}render(){return b` <style>
        .line-width-panel {
          opacity: ${this.disable?"0.5":"1"};
        }
      </style>
      <div
        class="line-width-panel"
        @mousedown="${t=>t.preventDefault()}"
      >
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="line-width-button">
          <div class="line-width-icon"></div>
        </div>
        <div class="drag-handle"></div>
        <div class="bottom-line"></div>
        <div class="line-width-overlay"></div>
        ${this.hasTooltip?b`<affine-tooltip>Thickness</affine-tooltip>`:ae}
      </div>`}};Kr.styles=X`
    :host {
      display: flex;
      box-sizing: border-box;
      background: var(--affine-background-overlay-panel-color);
    }

    .line-width-panel {
      display: flex;
      flex-direction: row-reverse;
      align-items: center;
      justify-content: space-between;
      position: relative;
      width: 108px;
      margin: 4px 0;
      cursor: default;
    }

    .line-width-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      z-index: 2;
    }

    .line-width-icon {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background-color: var(--affine-border-color);
    }

    .line-width-button:nth-child(1) {
      margin-right: 0;
    }

    .line-width-button:nth-child(6) {
      margin-left: 0;
    }

    .drag-handle {
      position: absolute;
      left: 0;
      top: 50%;
      width: 8px;
      height: 8px;
      transform: translateY(-50%) translateX(4px);
      border-radius: 50%;
      background-color: var(--affine-icon-color);
      z-index: 3;
    }

    .bottom-line,
    .line-width-overlay {
      left: 8px;
      top: 50%;
      transform: translateY(-50%);
      height: 1px;
      background-color: var(--affine-border-color);
      position: absolute;
    }

    .bottom-line {
      width: calc(100% - 16px);
      background-color: var(--affine-border-color);
    }

    .line-width-overlay {
      width: 0;
      background-color: var(--affine-icon-color);
      z-index: 1;
    }
  `;Xs([L({attribute:!1})],Kr.prototype,"selectedSize",2);Xs([L({attribute:!1})],Kr.prototype,"hasTooltip",2);Xs([L({attribute:!1})],Kr.prototype,"disable",2);Xs([he(".line-width-panel")],Kr.prototype,"_lineWidthPanel",2);Xs([he(".line-width-overlay")],Kr.prototype,"_lineWidthOverlay",2);Xs([Gm(".line-width-icon")],Kr.prototype,"_lineWidthIcons",2);Xs([he(".bottom-line")],Kr.prototype,"_bottomLine",2);Xs([he(".drag-handle")],Kr.prototype,"_dragHandle",2);Kr=Xs([W("edgeless-line-width-panel")],Kr);var yte=Object.defineProperty,wte=Object.getOwnPropertyDescriptor,cl=(t,e,n,i)=>{for(var r=i>1?void 0:i?wte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&yte(e,n,r),r};function xte(t){const e=_n(t,i=>i.color),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:_a()}function _te(t){const e=_n(t,i=>i.lineWidth),n=Cn(Object.entries(e),([i,r])=>r);return n?Number(n[0]):Rt.LINE_WIDTH_FOUR}let Lo=class extends me(Ae){constructor(){super(...arguments),this.elements=[],this._showPopper=!1,this._selectedColor=null,this._selectedSize=Rt.LINE_WIDTH_FOUR,this._colorPanelPopper=null}get service(){return this.surface.edgeless.service}_setLineWidth(t){this.page.captureSync(),this.elements.forEach(e=>{e.lineWidth!==t&&this.service.updateElement(e.id,{lineWidth:t})})}_setBrushColor(t){this.page.captureSync(),this.elements.forEach(e=>{e.color!==t&&this.service.updateElement(e.id,{color:t})}),t&&this._selectedColor!==t&&(this._selectedColor=t)}firstUpdated(t){const e=this._disposables;this._colorPanelPopper=Nt(this,this._colorPanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._colorPanelPopper),super.firstUpdated(t)}render(){this._selectedColor=xte(this.elements);const t={backgroundColor:`var(${this._selectedColor})`};return this._selectedSize=_te(this.elements),b`
      <edgeless-line-width-panel
        .selectedSize=${this._selectedSize}
        @select=${e=>this._setLineWidth(e.detail)}
      >
      </edgeless-line-width-panel>
      <menu-divider .vertical=${!0}></menu-divider>
      <edgeless-tool-icon-button
        .tooltip=${this._showPopper?"":"Color"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._colorPanelPopper?.toggle()}
      >
        <div class="brush-color-button">
          <div style=${we(t)}></div>
        </div>
      </edgeless-tool-icon-button>
      <div class="color-panel-container">
        <edgeless-color-panel
          .value=${this._selectedColor}
          @select=${e=>this._setBrushColor(e.detail)}
        >
        </edgeless-color-panel>
      </div>
    `}};Lo.styles=X`
    :host {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      color: var(--affine-text-primary-color);
      fill: currentColor;
    }

    menu-divider {
      height: 24px;
      margin: 0 5px;
    }

    .color-panel-container {
      display: none;
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
    }

    .color-panel-container[data-show] {
      display: flex;
    }

    .brush-size-button,
    .brush-color-button {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 24px;
      height: 24px;
      box-sizing: border-box;
      border-radius: 4px;
      cursor: pointer;
    }

    .brush-size-button div,
    .brush-color-button div {
      border-radius: 50%;
      background-color: var(--affine-icon-color);
    }

    .brush-color-button div {
      width: 16px;
      height: 16px;
    }
  `;cl([L({attribute:!1})],Lo.prototype,"elements",2);cl([L({attribute:!1})],Lo.prototype,"page",2);cl([L({attribute:!1})],Lo.prototype,"surface",2);cl([ie()],Lo.prototype,"_showPopper",2);cl([ie()],Lo.prototype,"_selectedColor",2);cl([ie()],Lo.prototype,"_selectedSize",2);cl([he(".color-panel-container")],Lo.prototype,"_colorPanel",2);Lo=cl([W("edgeless-change-brush-button")],Lo);var Cte=Object.defineProperty,kte=Object.getOwnPropertyDescriptor,au=(t,e,n,i)=>{for(var r=i>1?void 0:i?kte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Cte(e,n,r),r};let Aa=class extends me(Ae){constructor(){super(...arguments),this.padding=4,this.gap=0}firstUpdated(){this._menuPopper=Nt(this,this._panelWrapper),this._disposables.add(this._menuPopper)}render(){const{iconInfo:t}=this,e=we({"--edgeless-component-panel-padding":`${this.padding}px`,"--edgeless-component-panel-gap":`${this.gap}px`});return b`<edgeless-tool-icon-button
        .tooltip=${t.tooltip}
        .tipPosition=${"bottom"}
        .iconContainerPadding=${2}
        @click=${()=>this._menuPopper.toggle()}
      >
        ${t.icon}
      </edgeless-tool-icon-button>
      <div
        class="edgeless-component-panel-wrapper"
        style=${e}
      >
        ${this.menuChildren}
      </div> `}};Aa.styles=X`
    .edgeless-component-panel-wrapper {
      display: none;
      padding: var(--edgeless-component-panel-padding);
      gap: var(--edgeless-component-panel-gap);
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
    }

    .edgeless-component-panel-wrapper[data-show] {
      display: flex;
    }
  `;au([L({attribute:!1})],Aa.prototype,"iconInfo",2);au([L({attribute:!1})],Aa.prototype,"menuChildren",2);au([L({attribute:!1})],Aa.prototype,"padding",2);au([L({attribute:!1})],Aa.prototype,"gap",2);au([he(".edgeless-component-panel-wrapper")],Aa.prototype,"_panelWrapper",2);Aa=au([W("edgeless-menu-button")],Aa);var Ete=Object.defineProperty,Ste=Object.getOwnPropertyDescriptor,I0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ste(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ete(e,n,r),r};function Tte(t){const e=_n(t,i=>i.stroke),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:_a()}function Ite(t){const e=_n(t,i=>i.mode),n=Cn(Object.entries(e),([i,r])=>r);return n?Number(n[0]):null}function Lte(t){const e=_n(t,i=>i.strokeWidth),n=Cn(Object.entries(e),([i,r])=>r);return n?Number(n[0]):Rt.LINE_WIDTH_FOUR}function Mte(t){const e=_n(t,i=>{switch(i.strokeStyle){case"solid":return"solid";case"dash":return"dash";case"none":return"none"}}),n=Cn(Object.entries(e),([i,r])=>r);return n?n[0]:null}function Pte(t){const{trueCount:e,falseCount:n}=t.reduce((i,r)=>(r.rough?i.trueCount++:i.falseCount++,i),{trueCount:0,falseCount:0});return e>n}function M_(t,e){const n=_n(t,r=>e===sn.Front?r.frontEndpointStyle:r.rearEndpointStyle),i=Cn(Object.entries(n),([r,o])=>o);return i?i[0]:null}let ic=class extends me(Ae){constructor(){super(...arguments),this.elements=[]}get service(){return this.surface.edgeless.service}_setConnectorMode(t){this.page.captureSync(),this.elements.forEach(e=>{e.mode!==t&&this.service.updateElement(e.id,{mode:t})})}_setConnectorRough(t){this.page.captureSync(),this.elements.forEach(e=>{e.rough!==t&&this.service.updateElement(e.id,{rough:t})})}_setConnectorColor(t){this.page.captureSync();let e=!1;this.elements.forEach(n=>{n.stroke!==t&&(e=!0,this.service.updateElement(n.id,{stroke:t}))}),e&&this.requestUpdate()}_setConnectorStrokeWidth(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{strokeWidth:t})})}_setConnectorStrokeStyle(t){this.elements.forEach(e=>{this.service.updateElement(e.id,{strokeStyle:t})})}_setConnectorEndpointStyle(t,e){this.elements.forEach(n=>{t===sn.Front?this.service.updateElement(n.id,{frontEndpointStyle:e}):this.service.updateElement(n.id,{rearEndpointStyle:e})})}_flipEndpointStyle(t,e){t!==e&&this.elements.forEach(n=>{this.service.updateElement(n.id,{frontEndpointStyle:e,rearEndpointStyle:t})})}_getEndpointIcon(t,e){switch(e){case St.None:return c2;case St.Arrow:return t===sn.Front?r8:l8;case St.Triangle:return t===sn.Front?o8:c8;case St.Circle:return t===sn.Front?s8:d8;case St.Diamond:return t===sn.Front?a8:u8}}render(){const t=Tte(this.elements),e=Ite(this.elements),n=Lte(this.elements)??Rt.LINE_WIDTH_FOUR,i=Pte(this.elements),r=Mte(this.elements),o=M_(this.elements,sn.Front)??ST,s=M_(this.elements,sn.Rear)??TT;return b`
      <edgeless-menu-button
        .padding=${4}
        class="connector-color-button"
        .iconInfo=${{icon:b`${Ca(t)}`,tooltip:"Color"}}
        .menuChildren=${b` <edgeless-color-panel
          .value=${t}
          @select=${a=>this._setConnectorColor(a.detail)}
        >
        </edgeless-color-panel>`}
      ></edgeless-menu-button>

      <menu-divider .vertical=${!0} .dividerMargin=${12}></menu-divider>

      <edgeless-menu-button
        class="line-styles-button"
        .padding=${8}
        .gap=${8}
        .iconInfo=${{icon:b`${d3}${Pi}`,tooltip:"Border style"}}
        .menuChildren=${b`
          <edgeless-line-width-panel
            .selectedSize=${n}
            @select=${a=>{this._setConnectorStrokeWidth(a.detail)}}
          ></edgeless-line-width-panel>
          <menu-divider
            .vertical=${!0}
            .dividerMargin=${2}
            style=${we({height:"24px"})}
          ></menu-divider>
          <edgeless-tool-icon-button
            class=${`edgeless-component-line-style-button-${Yt.Solid}`}
            .tooltip=${"Solid"}
            .active=${r===Yt.Solid}
            .activeMode=${"background"}
            .iconContainerPadding=${2}
            @click=${()=>this._setConnectorStrokeStyle(Yt.Solid)}
          >
            ${Mh}
          </edgeless-tool-icon-button>
          <edgeless-tool-icon-button
            class=${`edgeless-component-line-style-button-${Yt.Dashed}`}
            .tooltip=${"Dash"}
            .active=${r===Yt.Dashed}
            .activeMode=${"background"}
            .iconContainerPadding=${2}
            @click=${()=>this._setConnectorStrokeStyle(Yt.Dashed)}
          >
            ${O9}
          </edgeless-tool-icon-button>
        `}
      >
      </edgeless-menu-button>

      <menu-divider .vertical=${!0} .dividerMargin=${12}></menu-divider>

      <edgeless-menu-button
        .padding=${8}
        .gap=${8}
        .iconInfo=${{icon:b`${i?Z1:G1}${Pi}`,tooltip:"Style"}}
        .menuChildren=${b`
          <edgeless-tool-icon-button
            .tooltip=${"General"}
            .iconContainerPadding=${2}
            .active=${!i}
            .activeMode=${"background"}
            @click=${()=>this._setConnectorRough(!1)}
          >
            ${G1}
          </edgeless-tool-icon-button>
          <edgeless-tool-icon-button
            .tooltip=${"Scribbled"}
            .active=${i}
            .activeMode=${"background"}
            .iconContainerPadding=${2}
            @click=${()=>this._setConnectorRough(!0)}
          >
            ${Z1}
          </edgeless-tool-icon-button>
        `}
      >
      </edgeless-menu-button>

      <menu-divider .vertical=${!0} .dividerMargin=${12}></menu-divider>

      <div class="connector-style-sub-menu">
        <edgeless-menu-button
          .padding=${8}
          .gap=${8}
          .iconInfo=${{icon:b`${this._getEndpointIcon(sn.Front,o)}${Pi}`,tooltip:"Start Point Style"}}
          .menuChildren=${b`
            <edgeless-tool-icon-button
              .tooltip=${"None"}
              .iconContainerPadding=${2}
              .active=${o===St.None}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Front,St.None)}
            >
              ${c2}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Arrow"}
              .iconContainerPadding=${2}
              .active=${o===St.Arrow}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Front,St.Arrow)}
            >
              ${r8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Triangle"}
              .iconContainerPadding=${2}
              .active=${o===St.Triangle}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Front,St.Triangle)}
            >
              ${o8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Circle"}
              .iconContainerPadding=${2}
              .active=${o===St.Circle}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Front,St.Circle)}
            >
              ${s8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Diamond"}
              .iconContainerPadding=${2}
              .active=${o===St.Diamond}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Front,St.Diamond)}
            >
              ${a8}
            </edgeless-tool-icon-button>
          `}
        >
        </edgeless-menu-button>

        <edgeless-tool-icon-button
          .tooltip=${"Flip Direction"}
          .iconContainerPadding=${2}
          .disabled=${!1}
          @click=${()=>this._flipEndpointStyle(o,s)}
        >
          ${wI}
        </edgeless-tool-icon-button>

        <edgeless-menu-button
          .padding=${8}
          .gap=${8}
          .iconInfo=${{icon:b`${this._getEndpointIcon(sn.Rear,s)}${Pi}`,tooltip:"End Point Style"}}
          .menuChildren=${b`
            <edgeless-tool-icon-button
              .tooltip=${"Diamond"}
              .iconContainerPadding=${2}
              .active=${s===St.Diamond}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Rear,St.Diamond)}
            >
              ${u8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Circle"}
              .iconContainerPadding=${2}
              .active=${s===St.Circle}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Rear,St.Circle)}
            >
              ${d8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Triangle"}
              .iconContainerPadding=${2}
              .active=${s===St.Triangle}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Rear,St.Triangle)}
            >
              ${c8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Arrow"}
              .iconContainerPadding=${2}
              .active=${s===St.Arrow}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Rear,St.Arrow)}
            >
              ${l8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"None"}
              .iconContainerPadding=${2}
              .active=${s===St.None}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorEndpointStyle(sn.Rear,St.None)}
            >
              ${c2}
            </edgeless-tool-icon-button>
          `}
        >
        </edgeless-menu-button>

        <edgeless-menu-button
          .padding=${8}
          .gap=${8}
          .iconInfo=${{icon:b`${e===jt.Straight?Mh:e===jt.Orthogonal?h8:p8}${Pi}`,tooltip:"Connector Shape"}}
          .menuChildren=${b`
            <edgeless-tool-icon-button
              .tooltip=${"Straight"}
              .iconContainerPadding=${2}
              .active=${e===jt.Straight}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorMode(jt.Straight)}
            >
              ${Mh}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Elbowed"}
              .iconContainerPadding=${2}
              .active=${e===jt.Orthogonal}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorMode(jt.Orthogonal)}
            >
              ${h8}
            </edgeless-tool-icon-button>
            <edgeless-tool-icon-button
              .tooltip=${"Curve"}
              .iconContainerPadding=${2}
              .active=${e===jt.Curve}
              .activeMode=${"background"}
              @click=${()=>this._setConnectorMode(jt.Curve)}
            >
              ${p8}
            </edgeless-tool-icon-button>
          `}
        >
        </edgeless-menu-button>
      </div>
    `}};ic.styles=[X`
      :host {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        color: var(--affine-text-primary-color);
        fill: currentColor;
      }

      menu-divider {
        height: 24px;
      }

      .connector-style-sub-menu {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }
    `];I0([L({attribute:!1})],ic.prototype,"edgeless",2);I0([L({attribute:!1})],ic.prototype,"elements",2);I0([L({attribute:!1})],ic.prototype,"page",2);I0([L({attribute:!1})],ic.prototype,"surface",2);ic=I0([W("edgeless-change-connector-button")],ic);var Ate=Object.defineProperty,$te=Object.getOwnPropertyDescriptor,O3=(t,e,n,i)=>{for(var r=i>1?void 0:i?$te(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ate(e,n,r),r};const Bte=["","0px 0.2px 4.8px 0px rgba(66, 65, 73, 0.2), 0px 0px 1.6px 0px rgba(66, 65, 73, 0.2)","0px 9.6px 10.4px -4px rgba(66, 65, 73, 0.07), 0px 10.4px 7.2px -8px rgba(66, 65, 73, 0.22)","0px 0px 0px 4px rgba(255, 255, 255, 1), 0px 1.2px 2.4px 4.8px rgba(66, 65, 73, 0.16)","0px 5.2px 12px 0px rgba(66, 65, 73, 0.13), 0px 0px 0.4px 1px rgba(0, 0, 0, 0.06)","0px 0px 0px 1.4px rgba(0, 0, 0, 1), 2.4px 2.4px 0px 1px rgba(0, 0, 0, 1)"],Dte=["","0px 0.2px 6px 0px rgba(0, 0, 0, 0.44), 0px 0px 2px 0px rgba(0, 0, 0, 0.66)","0px 9.6px 10.4px -4px rgba(0, 0, 0, 0.66), 0px 10.4px 7.2px -8px rgba(0, 0, 0, 0.44)","0px 1.2px 2.4px 4.8px rgba(0, 0, 0, 0.36), 0px 0px 0px 3.4px rgba(75, 75, 75, 1)","0px 5.2px 12px 0px rgba(0, 0, 0, 0.66), 0px 0px 0.4px 1px rgba(0, 0, 0, 0.44)","0px 0px 0px 1.4px rgba(178, 178, 178, 1), 2.4px 2.4px 0px 1px rgba(178, 178, 178, 1)"],Ote=["No Shadow","Box Shadow","Sticker Shadow","Paper Shadow","Floation Shadow","Film Shadow"];let ad=class extends me(Ae){render(){const e=Wo()==="dark"?Dte:Bte;return b`${Fe(Cb,n=>n,(n,i)=>b`
          <style>
            .item-icon svg rect:first-of-type {
              fill: var(${this.background});
            }
          </style>
          <div
            class="item"
            @click=${()=>this.onSelect(n)}
            style=${we({border:this.value===n?"1px solid var(--affine-brand-color)":"none"})}
          >
            <edgeless-tool-icon-button
              class="item-icon"
              .tooltip=${Ote[i]}
              .tipPosition=${"bottom"}
              .iconContainerPadding=${0}
              style=${we({boxShadow:`${e[i]}`})}
            >
              ${i===0?TI:II}
            </edgeless-tool-icon-button>
          </div>
        `)} `}};ad.styles=X`
    :host {
      border-radius: 8px;
      padding: 8px;
      gap: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    .item {
      padding: 8px;
      border-radius: 4px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }

    .item-icon {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .item:hover {
      background-color: var(--affine-hover-color);
    }
  `;O3([L({attribute:!1})],ad.prototype,"value",2);O3([L({attribute:!1})],ad.prototype,"background",2);O3([L({attribute:!1})],ad.prototype,"onSelect",2);ad=O3([W("edgeless-note-shadow-panel")],ad);var Rte=Object.defineProperty,Nte=Object.getOwnPropertyDescriptor,R3=(t,e,n,i)=>{for(var r=i>1?void 0:i?Nte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Rte(e,n,r),r};let ld=class extends me(Ae){constructor(){super(...arguments),this.panelWidth=296}_DisplayModeIcon(t){switch(t){case qe.DocAndEdgeless:return b`${m8} ${g8}`;case qe.DocOnly:return b`${m8}`;case qe.EdgelessOnly:return b`${g8}`}}_DisplayModeLabel(t){switch(t){case qe.DocAndEdgeless:return"In Both";case qe.DocOnly:return"In Page Only";case qe.EdgelessOnly:return"In Edgeless Only"}}render(){const t=Object.keys(qe);return this.style.setProperty("--panel-width",`${this.panelWidth}px`),b`${Fe(t,e=>e,e=>{const n=qe[e],i=n===this.displayMode;return b`<div
          class="item ${i?"selected":""} ${n}"
          @click=${r=>{r.stopPropagation(),this.onSelect(n)}}
          @dblclick=${at}
          @pointerdown=${at}
        >
          <div class="item-label">${this._DisplayModeLabel(n)}</div>
          <div class="item-icon">${this._DisplayModeIcon(n)}</div>
        </div>`})}`}};ld.styles=X`
    :host {
      display: flex;
      width: var(--panel-width);
      min-width: 180px;
      padding: 8px;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      border-radius: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      box-sizing: border-box;
    }
    .item {
      display: flex;
      align-items: center;
      width: 100%;
      height: 30px;
      padding: 4px 12px;
      border-radius: 4px;
      gap: 4px;
      box-sizing: border-box;
      cursor: pointer;
    }
    .item-label {
      flex: 1 1 0;
      font-size: var(--affine-font-sm);
      color: var(--affine-text-primary-color);
      line-height: 22px;
      font-weight: 400;
    }
    .item-icon {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 4px;
      fill: var(--affine-icon-color);
      color: var(--affine-icon-color);
    }
    .item:hover,
    .item.selected {
      background-color: var(--affine-hover-color);
    }
  `;R3([L({attribute:!1})],ld.prototype,"displayMode",2);R3([L({attribute:!1})],ld.prototype,"onSelect",2);R3([L({attribute:!1})],ld.prototype,"panelWidth",2);ld=R3([W("note-display-mode-panel")],ld);var Hte=Object.defineProperty,Fte=Object.getOwnPropertyDescriptor,ui=(t,e,n,i)=>{for(var r=i>1?void 0:i?Fte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Hte(e,n,r),r};const Ute=["--affine-tag-red","--affine-tag-orange","--affine-tag-yellow","--affine-tag-green","--affine-tag-teal","--affine-tag-blue","--affine-tag-purple","--affine-tag-pink","--affine-tag-gray","--affine-palette-transparent"];let Nn=class extends me(Ae){constructor(){super(...arguments),this.notes=[],this._queryCache=!1,this._showPopper=!1,this._enableNoteSlicer=!1,this._fillColorPopper=null,this._borderStylePopper=null,this._borderRadiusPopper=null,this._shadowTypePopper=null,this._displayModePopper=null,this._setBorderRadius=t=>{this.notes.forEach(e=>{this.page.updateBlock(e,()=>{e.edgeless.style.borderRadius=t})})}}get page(){return this.surface.page}_setBackground(t){this.notes.forEach(e=>{this.page.updateBlock(e,{background:t})})}_setShadowType(t){this.notes.forEach(e=>{this.page.updateBlock(e,()=>{e.edgeless.style.shadowType=t})})}_setDisplayMode(t,e){const{displayMode:n}=t;if(e===n)return;this.page.updateBlock(t,{displayMode:e});const i=this.page.getParent(t);D(i);const r=i.children.filter(s=>Ie(s,["affine:note"])),o=r[r.length-1];n===qe.EdgelessOnly&&e!==qe.EdgelessOnly&&t!==o&&this.page.moveBlocks([t],i,o,!1),e===qe.DocOnly&&this.surface.edgeless.service.selection.clear(),this._queryCache=!this._queryCache}_setStrokeWidth(t){this.notes.forEach(e=>{this.page.updateBlock(e,()=>{e.edgeless.style.borderSize=t})})}_setStrokeStyle(t){this.notes.forEach(e=>{this.page.updateBlock(e,()=>{e.edgeless.style.borderStyle=t})})}_setStyles({type:t,value:e}){if(t==="size")this._setStrokeWidth(e);else if(t==="lineStyle")switch(e){case"solid":{this._setStrokeStyle(Yt.Solid);break}case"dash":{this._setStrokeStyle(Yt.Dashed);break}case"none":{this._setStrokeStyle(Yt.None);break}}}_setCollapse(){this.notes.forEach(t=>{const{collapse:e,collapsedHeight:n}=t.edgeless;if(e)this.page.updateBlock(t,()=>{t.edgeless.collapse=!1});else if(n){const{xywh:i,edgeless:r}=t,o=ne.deserialize(i);o.h=n*(r.scale??1),this.page.updateBlock(t,()=>{t.edgeless.collapse=!0,t.xywh=o.serialize()})}}),this.requestUpdate()}_handleNoteSlicerButtonClick(){this.surface.service&&this.surface.edgeless.slots.toggleNoteSlicer.emit()}_getCurrentModeLabel(t){switch(t){case qe.DocAndEdgeless:return"Both";case qe.EdgelessOnly:return"Edgeless";case qe.DocOnly:return"Page";default:return"Both"}}updated(t){const{_disposables:e}=this;t.has("_queryCache")&&(this._displayModePopper=Nt(this._displayModeButtonGroup,this._displayModePanel,({display:n})=>{this._showPopper=n==="show"},-154,90),e.add(this._displayModePopper),this._fillColorPopper=Nt(this._fillColorButton,this._fillColorMenu,({display:n})=>this._showPopper=n==="show"),this._disposables.add(this._fillColorPopper),this._shadowTypePopper=Nt(this._shadowTypeButton,this._shadowTypesPanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._shadowTypePopper),this._borderStylePopper=Nt(this._borderStyleButton,this._borderStylesPanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._borderStylePopper),this._borderRadiusPopper=Nt(this._borderRadiusButton,this._boderRadiusPanel,({display:n})=>{this._showPopper=n==="show"}),e.add(this._borderRadiusPopper))}firstUpdated(){const{edgeless:t}=this.surface;this.disposables.add(t.slots.toggleNoteSlicer.on(()=>{this._enableNoteSlicer=!this._enableNoteSlicer})),this.disposables.add(t.service.selection.slots.updated.on(()=>{this._enableNoteSlicer=!1}))}render(){const t=this.notes.length,e=this.notes[0],{background:n,edgeless:i,displayMode:r}=e,{shadowType:o,borderRadius:s,borderSize:a,borderStyle:l}=i.style,{collapse:c}=i,d=this._getCurrentModeLabel(r);return b`
      ${t===1?b`<div class="display-mode-button-group">
              <span>Show in</span>
              <edgeless-tool-icon-button
                .tooltip=${this._showPopper?"":"Display Mode"}
                .iconContainerPadding=${0}
                @click=${()=>this._displayModePopper?.toggle()}
              >
                <div class="display-mode-button">
                  <span class="current-mode-label">${d}</span>
                  ${Pi}
                </div>
              </edgeless-tool-icon-button>
            </div>
            <note-display-mode-panel
              .displayMode=${r}
              .onSelect=${u=>{this._setDisplayMode(e,u),this._displayModePopper?.hide()}}
            >
            </note-display-mode-panel>

            <component-toolbar-menu-divider
              .vertical=${!0}
            ></component-toolbar-menu-divider>`:ae}
      ${r===qe.DocOnly?ae:b`
            <edgeless-tool-icon-button
              class="fill-color-button"
              .tooltip=${this._showPopper?"":"Background"}
              .iconContainerPadding=${2}
              @click=${()=>this._fillColorPopper?.toggle()}
            >
              <div class="fill-color-container">${Ca(n)}</div>
            </edgeless-tool-icon-button>

            <edgeless-color-panel
              .value=${n}
              .options=${Ute}
              @select=${u=>this._setBackground(u.detail)}
            >
            </edgeless-color-panel>

            <component-toolbar-menu-divider
              .vertical=${!0}
            ></component-toolbar-menu-divider>

            <div class="item shadow-style-button">
              <edgeless-tool-icon-button
                .tooltip=${"Shadow Style"}
                .iconContainerPadding=${0}
                .hover=${!1}
                @click=${()=>this._shadowTypePopper?.toggle()}
              >
                ${SI}${Pi}
              </edgeless-tool-icon-button>
            </div>

            <edgeless-note-shadow-panel
              .value=${o}
              .background=${n}
              .onSelect=${u=>this._setShadowType(u)}
            >
            </edgeless-note-shadow-panel>

            <div class="item border-style-button">
              <edgeless-tool-icon-button
                .tooltip=${this._showPopper?"":"Border Style"}
                .iconContainerPadding=${0}
                .hover=${!1}
                @click=${()=>this._borderStylePopper?.toggle()}
              >
                ${d3}${Pi}
              </edgeless-tool-icon-button>
            </div>
            ${zM({selectedLineSize:a,selectedLineStyle:l,onClick:u=>{this._setStyles(u)}})}

            <div class="item border-radius-button">
              <edgeless-tool-icon-button
                .tooltip=${"Corners"}
                .iconContainerPadding=${0}
                .hover=${!1}
                @click=${()=>this._borderRadiusPopper?.toggle()}
              >
                ${EI}${Pi}
              </edgeless-tool-icon-button>
            </div>
            <edgeless-size-panel
              .size=${s}
              .labels=${["None","Small","Medium","Large","Huge"]}
              .sizes=${[0,8,16,24,32]}
              .minSize=${0}
              .onSelect=${u=>{this._setBorderRadius(u)}}
              .onPopperCose=${()=>this._borderRadiusPopper?.hide()}
            ></edgeless-size-panel>
            <component-toolbar-menu-divider
              .vertical=${!0}
            ></component-toolbar-menu-divider>
          `}

      <edgeless-tool-icon-button
        class="edgeless-auto-height-button"
        .tooltip=${c?"Auto Size":"Customized Size"}
        .iconContainerPadding=${2}
        @click=${()=>{this._setCollapse()}}
      >
        ${c?XT:QT}
      </edgeless-tool-icon-button>

      ${t===1?b`<component-toolbar-menu-divider
              .vertical=${!0}
            ></component-toolbar-menu-divider>
            <edgeless-tool-icon-button
              class="edgeless-note-slicer-button"
              .tooltip=${yr("Cutting Mode","-")}
              .iconContainerPadding=${2}
              .active=${this._enableNoteSlicer}
              @click=${this._handleNoteSlicerButtonClick}
            >
              ${$I}
            </edgeless-tool-icon-button>`:ae}
    `}};Nn.styles=[VM,X`
      :host {
        display: flex;
        color: var(--affine-text-primary-color);
        fill: currentColor;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }

      .fill-color-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 20px;
        height: 20px;
      }

      .item {
        width: 40px;
        height: 24px;
        border-radius: 4px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .item:hover {
        background-color: var(--affine-hover-color);
      }

      .display-mode-button-group {
        display: flex;
        align-items: center;
        gap: 4px;
        padding: 2px;
        font-size: 12px;
        font-weight: 500;
        line-height: 20px;
      }

      .display-mode-button {
        display: flex;
        border-radius: 4px;
        background-color: var(--affine-hover-color);
        align-items: center;
        gap: 2px;
        padding: 2px;
      }

      .current-mode-label {
        display: flex;
        padding: 2px 0px 2px 4px;
        align-items: center;
      }

      edgeless-size-panel {
        border-radius: 8px;
      }

      edgeless-color-panel {
        width: 168px;
        display: none;
        justify-content: center;
        align-items: center;
        background: var(--affine-background-overlay-panel-color);
        box-shadow: var(--affine-shadow-2);
        border-radius: 8px;
      }

      note-display-mode-panel,
      edgeless-note-shadow-panel,
      edgeless-size-panel {
        display: none;
      }

      note-display-mode-panel[data-show],
      edgeless-note-shadow-panel[data-show],
      edgeless-color-panel[data-show],
      edgeless-size-panel[data-show] {
        display: flex;
      }

      component-toolbar-menu-divider {
        width: 4px;
        height: 24px;
      }

      .line-style-panel {
        display: none;
        padding: 6px;
      }

      .line-style-panel component-toolbar-menu-divider {
        margin: 0 8px;
      }

      .line-style-panel[data-show] {
        display: flex;
      }
    `];ui([L({attribute:!1})],Nn.prototype,"notes",2);ui([L({attribute:!1})],Nn.prototype,"surface",2);ui([ie()],Nn.prototype,"_queryCache",2);ui([ie()],Nn.prototype,"_showPopper",2);ui([ie()],Nn.prototype,"_enableNoteSlicer",2);ui([he(".fill-color-button")],Nn.prototype,"_fillColorButton",2);ui([he("edgeless-color-panel")],Nn.prototype,"_fillColorMenu",2);ui([he(".border-style-button")],Nn.prototype,"_borderStyleButton",2);ui([he(".line-style-panel")],Nn.prototype,"_borderStylesPanel",2);ui([he(".border-radius-button")],Nn.prototype,"_borderRadiusButton",2);ui([he("edgeless-size-panel")],Nn.prototype,"_boderRadiusPanel",2);ui([he(".shadow-style-button")],Nn.prototype,"_shadowTypeButton",2);ui([he("edgeless-note-shadow-panel")],Nn.prototype,"_shadowTypesPanel",2);ui([he(".display-mode-button-group")],Nn.prototype,"_displayModeButtonGroup",2);ui([he("note-display-mode-panel")],Nn.prototype,"_displayModePanel",2);Nn=ui([W("edgeless-change-note-button")],Nn);var Vte=Object.defineProperty,zte=Object.getOwnPropertyDescriptor,zb=(t,e,n,i)=>{for(var r=i>1?void 0:i?zte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Vte(e,n,r),r};let np=class extends me(Ae){render(){const{EmbedCardHorizontalIcon:t,EmbedCardListIcon:e,EmbedCardVerticalIcon:n,EmbedCardCubeIcon:i}=w0();return b`
      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.value==="horizontal"})}
        @click=${()=>this.onSelect("horizontal")}
      >
        ${t}
        <affine-tooltip .offset=${4}
          >${"Large horizontal style"}</affine-tooltip
        >
      </icon-button>

      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.value==="list"})}
        @click=${()=>this.onSelect("list")}
      >
        ${e}
        <affine-tooltip .offset=${4}
          >${"Small horizontal style"}</affine-tooltip
        >
      </icon-button>

      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.value==="vertical"})}
        @click=${()=>this.onSelect("vertical")}
      >
        ${n}
        <affine-tooltip .offset=${4}>${"Large vertical style"}</affine-tooltip>
      </icon-button>

      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.value==="cube"})}
        @click=${()=>this.onSelect("cube")}
      >
        ${i}
        <affine-tooltip .offset=${4}>${"Small vertical style"}</affine-tooltip>
      </icon-button>
    `}};np.styles=X`
    :host {
      border-radius: 8px;
      padding: 8px;
      gap: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    icon-button {
      padding: var(--1, 0px);
    }

    icon-button.selected {
      border: 1px solid var(--affine-brand-color);
    }
  `;zb([L({attribute:!1})],np.prototype,"value",2);zb([L({attribute:!1})],np.prototype,"onSelect",2);np=zb([W("embed-card-style-panel")],np);const rc=["vertical","horizontal","list","cube"],jte={style:rc[1],url:"",caption:null,description:null,icon:null,image:null,title:null,index:"a0",xywh:"[0,0,0,0]",rotate:0},T1=_i({flavour:"affine:bookmark",props:()=>jte,metadata:{version:1,role:"content",parent:["affine:note","affine:surface"]},toModel:()=>new jM});class jM extends C0(Bn){}var Gte=Object.defineProperty,Zte=Object.getOwnPropertyDescriptor,Bc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Zte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Gte(e,n,r),r};let Bs=class extends me(Ae){constructor(){super(...arguments),this._showPopper=!1,this._embedOptions=null,this._embedCardStylePopper=null}get _page(){return this.model.page}get edgeless(){return this.surface.edgeless}get _pageService(){const t=this.surface.std.spec.getService("affine:page");return D(t),t}get _blockElement(){const t=this.surface.edgeless.service.selection.selections.filter(n=>n.elements.includes(this.model.id));if(t.length!==1)return;const e=this.std.view.viewFromPath("block",t[0].path);return D(e),e}get _canShowUrlOptions(){return"url"in this.model&&(vi(this.model)||ed(this.model)||Ki(this.model))}get _canShowOpenButton(){return Ki(this.model)}get _isCardView(){return vi(this.model)||Ki(this.model)?!0:this._embedOptions?.viewType==="card"}get _isEmbedView(){return vi(this.model)||Ki(this.model)?!1:this._embedOptions?.viewType==="embed"}get _canConvertToEmbedView(){return this._embedOptions?.viewType==="embed"}get _canShowCardStylePanel(){return vi(this.model)||ed(this.model)||Ki(this.model)}_open(){this._blockElement?.open()}_showCaption(){const t=this._blockElement;t&&(t.showCaption=!0,t.updateComplete.then(()=>t.captionElement.input.focus()).catch(console.error))}_refreshData(){this._blockElement?.refreshData()}_copyUrl(){"url"in this.model&&(navigator.clipboard.writeText(this.model.url).catch(console.error),kt(this.std.host,"Copied link to clipboard"),this.surface.selection.clear())}_setEmbedCardStyle(t){const e=ne.deserialize(this.model.xywh);e.w=At[t],e.h=bt[t];const n=e.serialize();this.model.page.updateBlock(this.model,{style:t,xywh:n}),this._embedCardStylePopper?.hide()}_convertToCardView(){if(this._isCardView||!("url"in this.model))return;const{url:t,xywh:e,style:n}=this.model;let i="affine:bookmark",r=n;if(this._embedOptions&&this._embedOptions.viewType==="card"){const{flavour:a,styles:l}=this._embedOptions;i=a,r=l.includes(n)?n:l[0]}else r=rc.includes(n)?n:rc[0];const o=ne.deserialize(e);o.w=At[r],o.h=bt[r];const s=this.edgeless.service.addBlock(i,{url:t,xywh:o.serialize(),style:r},this.surface.model);this.edgeless.service.selection.set({editing:!1,elements:[s]}),this._page.deleteBlock(this.model)}_convertToEmbedView(){if(this._isEmbedView||!("url"in this.model)||!this._embedOptions)return;const{flavour:t,styles:e}=this._embedOptions,{url:n,xywh:i,style:r}=this.model,o=e.includes(r)?r:e[0],s=ne.deserialize(i);s.w=At[o],s.h=bt[o];const a=this.edgeless.service.addBlock(t,{url:n,xywh:s.serialize(),style:o},this.surface.model);this.edgeless.service.selection.set({editing:!1,elements:[a]}),this._page.deleteBlock(this.model)}updated(t){this._embedCardStylePopper?.dispose(),this._canShowCardStylePanel&&(this._embedCardStylePopper=Nt(this._embedCardStyleButton,this._embedCardStylePanel,({display:e})=>{this._showPopper=e==="show"}),this._disposables.add(this._embedCardStylePopper)),super.firstUpdated(t)}render(){const t=this.model;return"url"in this.model&&(this._embedOptions=this._pageService.getEmbedBlockOptions(this.model.url)),b`
      <div class="change-embed-card-container">
        ${this._canShowUrlOptions&&"url"in t?b`<div
                class="change-embed-card-button url"
                @click=${this._copyUrl}
              >
                <span>${t.url}</span>
              </div>

              <edgeless-tool-icon-button
                .tooltip=${"Click to copy link"}
                class="change-embed-card-button copy"
                ?disabled=${this._page.readonly}
                @click=${()=>this._copyUrl()}
              >
                ${Tr}
              </edgeless-tool-icon-button>

              <edgeless-tool-icon-button
                .tooltip=${"Edit"}
                class="change-embed-card-button edit"
                ?disabled=${this._page.readonly}
                @click=${()=>wM(this.std.host,t)}
              >
                ${p0}
              </edgeless-tool-icon-button>

              <component-toolbar-menu-divider
                .vertical=${!0}
              ></component-toolbar-menu-divider>`:ae}
        ${this._canShowOpenButton?b`<edgeless-tool-icon-button
                .tooltip=${"Open"}
                class="change-embed-card-button open"
                @click=${this._open}
              >
                ${oo}
              </edgeless-tool-icon-button>

              <component-toolbar-menu-divider
                .vertical=${!0}
              ></component-toolbar-menu-divider>`:ae}

        <div class="change-embed-card-view-style">
          ${this._canConvertToEmbedView?b`
                <div class="change-embed-card-button-view-selector">
                  <edgeless-tool-icon-button
                    class=${Qe({"change-embed-card-button":!0,card:!0,"current-view":this._isCardView})}
                    .tooltip=${"Card view"}
                    ?disabled=${this._page.readonly}
                    .iconContainerPadding=${2}
                    .hover=${!1}
                    @click=${()=>this._convertToCardView()}
                  >
                    ${Yo}
                  </edgeless-tool-icon-button>

                  <edgeless-tool-icon-button
                    class=${Qe({"change-embed-card-button":!0,embed:!0,"current-view":this._isEmbedView})}
                    .tooltip=${"Embed view"}
                    ?disabled=${this._page.readonly}
                    .iconContainerPadding=${2}
                    .hover=${!1}
                    @click=${()=>this._convertToEmbedView()}
                  >
                    ${Qd}
                  </edgeless-tool-icon-button>
                </div>
              `:ae}
          ${this._canShowCardStylePanel?b`
                <div class="change-embed-card-button card-style">
                  <edgeless-tool-icon-button
                    .tooltip=${this._showPopper?"":"Card style"}
                    ?disabled=${this._page.readonly}
                    @click=${()=>this._embedCardStylePopper?.toggle()}
                  >
                    ${wb}
                  </edgeless-tool-icon-button>
                </div>

                <embed-card-style-panel
                  .value=${t.style}
                  .onSelect=${e=>this._setEmbedCardStyle(e)}
                >
                </embed-card-style-panel>
              `:ae}
        </div>

        <component-toolbar-menu-divider
          .vertical=${!0}
        ></component-toolbar-menu-divider>

        <edgeless-tool-icon-button
          .tooltip=${"Add Caption"}
          class="change-embed-card-button caption"
          ?disabled=${this._page.readonly}
          @click=${()=>this._showCaption()}
        >
          ${Kd}
        </edgeless-tool-icon-button>

        <component-toolbar-menu-divider
          .vertical=${!0}
        ></component-toolbar-menu-divider>

        <edgeless-tool-icon-button
          .tooltip=${"Reload"}
          class="change-embed-card-button reload"
          ?disabled=${this._page.readonly}
          @click=${()=>this._refreshData()}
        >
          ${f3}
        </edgeless-tool-icon-button>
      </div>
    `}};Bs.styles=X`
    .change-embed-card-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .change-embed-card-button {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .change-embed-card-button.url {
      display: flex;
      width: 180px;
      padding: var(--1, 0px);
      align-items: flex-start;
      gap: 10px;
      border-radius: var(--1, 0px);
      opacity: var(--add, 1);
      margin-right: 6px;
      user-select: none;
      cursor: pointer;
    }

    .change-embed-card-button.url > span {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;

      color: var(--affine-link-color);
      font-feature-settings:
        'clig' off,
        'liga' off;
      font-family: var(--affine-font-family);
      font-size: 15px;
      font-style: normal;
      font-weight: 400;
      line-height: 24px;
      text-overflow: ellipsis;
      overflow: hidden;
      opacity: var(--add, 1);
    }

    .change-embed-card-view-style {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .change-embed-card-button-view-selector {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 2px;
      border-radius: 6px;
      background: var(--affine-hover-color);
    }
    .change-embed-card-button-view-selector .change-embed-card-button {
      width: 24px;
      height: 24px;
    }
    .change-embed-card-button-view-selector > icon-button {
      padding: 0px;
    }
    .change-embed-card-button-view-selector .current-view {
      background: var(--affine-background-overlay-panel-color);
      border-radius: 6px;
    }

    component-toolbar-menu-divider {
      height: 24px;
    }

    embed-card-style-panel {
      display: none;
    }
    embed-card-style-panel[data-show] {
      display: flex;
    }
  `;Bc([L({attribute:!1})],Bs.prototype,"model",2);Bc([L({attribute:!1})],Bs.prototype,"std",2);Bc([L({attribute:!1})],Bs.prototype,"surface",2);Bc([ie()],Bs.prototype,"_showPopper",2);Bc([he(".change-embed-card-button.card-style")],Bs.prototype,"_embedCardStyleButton",2);Bc([he("embed-card-style-panel")],Bs.prototype,"_embedCardStylePanel",2);Bs=Bc([W("edgeless-change-embed-card-button")],Bs);var Wte=Object.defineProperty,qte=Object.getOwnPropertyDescriptor,jb=(t,e,n,i)=>{for(var r=i>1?void 0:i?qte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Wte(e,n,r),r};const{Left:P_,Center:Yte,Right:Xte}=v0;let ip=class extends Ae{constructor(){super(...arguments),this.value=P_}_onSelect(t){this.value=t,this.onSelect&&this.onSelect(t)}render(){return b`
      <div class="align-panel-container">
        <edgeless-tool-icon-button
          .tooltip=${"Left"}
          .active=${this.value==="left"}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(P_)}}
        >
          ${R9}
        </edgeless-tool-icon-button>
        <edgeless-tool-icon-button
          .tooltip=${"Center"}
          .active=${this.value==="center"}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(Yte)}}
        >
          ${N9}
        </edgeless-tool-icon-button>
        <edgeless-tool-icon-button
          .tooltip=${"Right"}
          .active=${this.value==="right"}
          .activeMode=${"background"}
          .iconContainerPadding=${2}
          @click=${()=>{this._onSelect(Xte)}}
        >
          ${H9}
        </edgeless-tool-icon-button>
      </div>
    `}};ip.styles=X`
    :host {
      display: block;
      z-index: 2;
    }
    .align-panel-container {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--affine-background-overlay-panel-color);
      border-radius: 8px;
      padding: 8px;
      gap: 8px;
    }
    .align-panel-container svg {
      fill: var(--affine-icon-color);
      stroke: none;
    }
  `;jb([L({attribute:!1})],ip.prototype,"value",2);jb([L({attribute:!1})],ip.prototype,"onSelect",2);ip=jb([W("edgeless-align-panel")],ip);var Kte=Object.defineProperty,Qte=Object.getOwnPropertyDescriptor,N3=(t,e,n,i)=>{for(var r=i>1?void 0:i?Qte(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Kte(e,n,r),r};let cd=class extends me(Ae){constructor(){super(...arguments),this.texts=[]}render(){return b`<div class="change-text-container">
      <edgeless-change-text-menu
        .elements=${this.texts}
        .elementType=${"text"}
        .surface=${this.surface}
      ></edgeless-change-text-menu>
    </div>`}};cd.styles=X`
    :host {
      display: flex;
    }

    .change-text-container {
      display: flex;
    }
  `;N3([L({attribute:!1})],cd.prototype,"texts",2);N3([L({attribute:!1})],cd.prototype,"page",2);N3([L({attribute:!1})],cd.prototype,"surface",2);cd=N3([W("edgeless-change-text-button")],cd);var Jte=Object.defineProperty,ene=Object.getOwnPropertyDescriptor,lu=(t,e,n,i)=>{for(var r=i>1?void 0:i?ene(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Jte(e,n,r),r};const tne=["--affine-tag-gray","--affine-tag-red","--affine-tag-orange","--affine-tag-yellow","--affine-tag-green","--affine-tag-teal","--affine-tag-blue","--affine-tag-purple","--affine-tag-pink","--affine-palette-transparent"];let $a=class extends me(Ae){constructor(){super(...arguments),this.frames=[],this._showPopper=!1,this._frameBackground=null}get service(){return this.surface.edgeless.service}_setFrameBackground(t){this.frames.forEach(e=>{this.service.updateElement(e.id,{background:t})})}_insertIntoPage(){if(!this.surface.page.root)return;const t=this.surface.page.root,e=t.children,n=e[e.length-1],i=this.frames[0];let r=n?.id;if(n?.flavour!=="affine:note"){const o=Wn(i.xywh);o[1]=o[1]+o[3],o[3]=g0,r=this.surface.page.addBlock("affine:note",{xywh:wo(...o)},t.id)}this.surface.page.addBlock("affine:surface-ref",{reference:this.frames[0].id,refFlavour:"affine:frame"},r),kt(this.surface.host,"Frame has been inserted into page")}firstUpdated(){this._frameBackground=Nt(this._fillColorButton,this._fillColorMenu,({display:t})=>{this._showPopper=t==="show"}),this._disposables.add(this._frameBackground)}render(){const{frames:t}=this,e=t[0].background;return Be`${t.length===1?Be`
            <edgeless-tool-icon-button
              .tooltip=${"Insert into Page"}
              .tipPosition=${"bottom"}
              @click=${this._insertIntoPage}
            >
              ${u3}
              <span style="margin-left: 2px;">Insert into Page</span>
            </edgeless-tool-icon-button>
            <component-toolbar-menu-divider></component-toolbar-menu-divider>
            <edgeless-tool-icon-button
              .tooltip=${"Rename"}
              .tipPosition=${"bottom"}
              .iconContainerPadding=${0}
              @click=${()=>DM(this.frames[0],this.surface.edgeless)}
            >
              ${B9}
            </edgeless-tool-icon-button>
            <component-toolbar-menu-divider></component-toolbar-menu-divider>
          `:ae}

      <edgeless-tool-icon-button
        class="fill-color-button"
        .tooltip=${this._showPopper?"":"Background"}
        .tipPosition=${"bottom"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._frameBackground?.toggle()}
      >
        <div class="fill-color-container">${Ca(e)}</div>
      </edgeless-tool-icon-button>
      <div class="color-panel-container fill-color">
        <edgeless-color-panel
          .value=${e}
          .options=${tne}
          @select=${n=>this._setFrameBackground(n.detail)}
        >
        </edgeless-color-panel>
      </div> `}};$a.styles=X`
    :host {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--affine-text-primary-color);
      stroke: none;
      fill: currentColor;
    }

    edgeless-color-panel {
      width: 168px;
    }

    .fill-color-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 20px;
      height: 20px;
    }

    .color-panel-container,
    .image-background-container {
      display: none;
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
    }

    .color-panel-container[data-show],
    .image-background-container[data-show] {
      display: flex;
    }
    component-toolbar-menu-divider {
      margin: 0 12px;
      height: 24px;
    }
  `;lu([L({attribute:!1})],$a.prototype,"surface",2);lu([L({attribute:!1})],$a.prototype,"frames",2);lu([ie()],$a.prototype,"_showPopper",2);lu([he(".fill-color-button")],$a.prototype,"_fillColorButton",2);lu([he(".color-panel-container.fill-color")],$a.prototype,"_fillColorMenu",2);$a=lu([W("edgeless-change-frame-button")],$a);var nne=Object.defineProperty,ine=Object.getOwnPropertyDescriptor,Gb=(t,e,n,i)=>{for(var r=i>1?void 0:i?ine(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&nne(e,n,r),r};let rp=class extends me(Ae){_insertIntoPage(){if(!this.surface.page.root)return;const t=this.surface.page.root,e=t.children,n=e[e.length-1],i=this.groups[0];let r=n?.id;if(n?.flavour!=="affine:note"){const o=Wn(i.xywh);o[1]=o[1]+o[3],o[3]=g0,r=this.surface.page.addBlock("affine:note",{xywh:wo(...o)},t.id)}this.surface.page.addBlock("affine:surface-ref",{reference:this.groups[0].id,refFlavour:"group"},r),kt(this.surface.host,"Group has been inserted into page")}render(){const{groups:t}=this;return b`
      ${t.length===1?b` <edgeless-tool-icon-button
              .tooltip=${"Insert into Page"}
              .tipPosition=${"bottom"}
              @click=${this._insertIntoPage}
            >
              ${u3}
              <span style="margin-left: 2px;">Insert into Page</span>
            </edgeless-tool-icon-button>
            <component-toolbar-menu-divider></component-toolbar-menu-divider>
            <edgeless-tool-icon-button
              class=${"edgeless-component-toolbar-group-rename-button"}
              @click=${()=>OM(t[0],this.surface.edgeless)}
              .tooltip=${"Rename"}
              .tipPosition=${"bottom"}
            >
              ${B9}
            </edgeless-tool-icon-button>

            <component-toolbar-menu-divider
              style=${"margin: 0 8px"}
            ></component-toolbar-menu-divider>`:ae}
      <edgeless-tool-icon-button
        class=${"edgeless-component-toolbar-ungroup-button"}
        @click=${()=>{t.forEach(e=>this.surface.edgeless.service.ungroup(e))}}
        .tooltip=${"Ungroup"}
        .tipPosition=${"bottom"}
      >
        ${jT}
      </edgeless-tool-icon-button>
    `}connectedCallback(){super.connectedCallback(),this.style.display="flex",this.style.alignItems="center",this.style.justifyContent="center"}createRenderRoot(){return this}};rp.styles=X`
    component-toolbar-menu-divider {
      height: 24px;
    }
  `;Gb([L({attribute:!1})],rp.prototype,"surface",2);Gb([L({attribute:!1})],rp.prototype,"groups",2);rp=Gb([W("edgeless-change-group-button")],rp);var rne=Object.defineProperty,one=Object.getOwnPropertyDescriptor,GM=(t,e,n,i)=>{for(var r=i>1?void 0:i?one(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&rne(e,n,r),r};let E8=class extends me(Ae){render(){return b`<edgeless-tool-icon-button
      .iconContainerPadding=${2}
      @click=${()=>{this.edgeless.surface.frame.createFrameOnSelected()}}
    >
      ${Lc}<span
        style=${we({fontSize:"12px",fontWeight:400,color:"var(--affine-icon-color)",marginLeft:"4px"})}
        >Frame</span
      >
    </edgeless-tool-icon-button>`}};GM([L({attribute:!1})],E8.prototype,"edgeless",2);E8=GM([W("edgeless-add-frame-button")],E8);var sne=Object.defineProperty,ane=Object.getOwnPropertyDescriptor,ZM=(t,e,n,i)=>{for(var r=i>1?void 0:i?ane(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&sne(e,n,r),r};let S8=class extends me(Ae){render(){return b` <edgeless-tool-icon-button
      .iconContainerPadding=${2}
      @click=${()=>{this.edgeless.service.createGroupFromSelected()}}
      .tooltip=${"Group"}
      .tipPosition=${"bottom"}
    >
      ${D9}<span
        style=${we({fontSize:"12px",fontWeight:400,color:"var(--affine-icon-color)",marginLeft:"4px"})}
        >Group</span
      >
    </edgeless-tool-icon-button>`}};ZM([L({attribute:!1})],S8.prototype,"edgeless",2);S8=ZM([W("edgeless-add-group-button")],S8);var lne=Object.defineProperty,cne=Object.getOwnPropertyDescriptor,WM=(t,e,n,i)=>{for(var r=i>1?void 0:i?cne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&lne(e,n,r),r};let T8=class extends me(Ae){_releaseFromGroup(){const t=this.surface.edgeless.service,e=t.selection.firstElement;if(e.group===null)return;const n=e.group;n.removeChild(e.id),e.index=t.layer.generateIndex("flavour"in e?e.flavour:e.type);const i=n.group;i?.addChild(e.id)}render(){return b`<edgeless-tool-icon-button
      .iconContainerPadding=${2}
      @click=${()=>{this._releaseFromGroup()}}
      .tooltip=${"Release From Group"}
      .tipPosition=${"bottom"}
    >
      ${zT}
    </edgeless-tool-icon-button> `}};WM([L({attribute:!1})],T8.prototype,"surface",2);T8=WM([W("edgeless-release-from-group-button")],T8);function Mo(t){return t.length===0?new ne:t.reduce((e,n)=>e.unite(n.elementBound),t[0].elementBound)}const A_=800,$_=640,dne=40;function une(t){return t.filter(e=>{const n=ne.deserialize(e.xywh);return t.some(i=>i.id===e.id||!ne.deserialize(i.xywh).contains(n))})}class hne extends nl{constructor(){super(...arguments),this.bound=null}render(e,n){if(!this.bound)return;const{x:i,y:r,w:o,h:s}=this.bound;e.beginPath(),e.strokeStyle="#1E96EB",e.lineWidth=2,e.roundRect(i,r,o,s,8),e.stroke()}highlight(e){const n=ne.deserialize(e.xywh);this.bound=n,this._renderer.refresh()}clear(){this.bound=null,this._renderer.refresh()}}class pne{constructor(e){this._edgeless=e}selectFrame(e){const n=this._edgeless.service.frames;if(n.length===0)return null;const i=e.filter(o=>nr(o)),r=Mo(e);for(let o=n.length-1;o>=0;o--){const s=n[o];if(!i.includes(s)&&ne.deserialize(s.xywh).contains(r))return s}return null}getElementsInFrame(e,n=!0){const i=ne.deserialize(e.xywh);return this._edgeless.service.layer.canvasGrid.search(i,!0).concat(qM(this._edgeless.page,e,n))}createFrameOnSelected(){const{_edgeless:e}=this,{surface:n,service:i}=e,r=i.frames;let o=Mo(e.service.selection.elements);if(o=o.expand(dne),o.w<A_){const l=(A_-o.w)/2;o=o.expand(l,0)}if(o.h<$_){const l=($_-o.h)/2;o=o.expand(0,l)}const s=i.addBlock("affine:frame",{title:new nt.Y.Text(`Frame ${r.length+1}`),xywh:o.serialize()},n.model),a=i.getElementById(s);e.page.captureSync(),D(a),n.fitToViewport(o),e.service.selection.set({elements:[a.id],editing:!1})}}function fne(t,e,n=!0){const i=ne.deserialize(e.xywh);return t.getBlockByFlavour("affine:note").filter(r=>{const o=ne.deserialize(r.xywh);return n?i.contains(o):i.isPointInBound([o.x,o.y])})}function qM(t,e,n=!0){const i=ne.deserialize(e.xywh),r=t.getBlockByFlavour(["affine:surface"]);return fne(t,e,n).concat(r[0].children.filter(o=>{if(o.id!==e.id){if(Ie(o,["affine:image","affine:frame"])){const s=ne.deserialize(o.xywh);return n?i.contains(s):i.containsPoint([s.x,s.y])}return!1}}))}function gne(t,e){const n=t[e];return n?n.type==="block"?n.zIndexes[1]:n.zIndexes:1}function rs(t,e){const n=t[e];let i=n.type==="block"?n.zIndexes[1]:n.zIndexes;for(let r=e;r<t.length;++r){const o=t[r];o.type==="block"?(o.zIndexes=[i,i+o.elements.length],i+=o.elements.length):(o.zIndexes=i,i+=1)}}function os(t){const e=t.groups;return e.length>1?e.map(n=>n.index).reverse().slice(1).join("-")+`-${t.index}`:t.index}function B6(t){return t.split("-")[0]}function Mf(t,e){let n=0;for(;n<t.length&&ei(t[n],e)<0;)++n;t.splice(n,0,e)}function Pf(t,e){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}function mne(t,e){return ei(e,t[0])>=0&&ei(e,t[1])<0}function D6(t,e,n){const i=t.getParent(n);return i===t.root||i===e}function ei(t,e){if(t instanceof On&&t.hasDescendant(e))return-1;if(e instanceof On&&e.hasDescendant(t))return 1;{const n=t.groups,i=e.groups,r=Math.min(n.length,i.length);for(let o=0;o<r;++o)if(n[o]!==i[o]){const s=n[o]??t,a=i[o]??e;return s.index===a.index?0:s.index<a.index?-1:1}return t.index<e.index?-1:t.index>e.index?1:0}}const B_="blocksuite/surface",O6="image/png",{GROUP:bne}=kn;class vne extends sT{constructor(e){super(e),this.host=e,this._initEdgelessClipboard=()=>{this.host.handleEvent("copy",n=>{const{selections:i,selectedIds:r}=this.selectionManager;if(r.length===0)return!1;this._onCopy(n,i).catch(console.error)},{global:!0}),this.host.handleEvent("paste",n=>{this._onPaste(n).catch(console.error)},{global:!0}),this.host.handleEvent("cut",n=>{this._onCut(n)},{global:!0})},this._onCopy=async(n,i)=>{n.get("clipboardState").raw.preventDefault();const o=Zb(this.surface,this.selectionManager.elements);if(i[0]&&i[0].editing){if(C6(o[0]))return;this.onPageCopy(n);return}this.std.clipboard.writeToClipboard(async s=>{const a=await Wb(o,this.std);return{...s,[B_]:JSON.stringify(a)}}).catch(console.error)},this._onPaste=async n=>{if(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement)return;const i=n.get("clipboardState").raw;i.preventDefault();const{selections:r,elements:o}=this.selectionManager;if(r[0]?.editing){if(C6(o[0]))return;this.onPagePaste(n);return}const s=i.clipboardData;if(!s)return;if(wne(s)){const c=s.files;if(c.length===0)return;const d=[...c].filter(u=>u.type.startsWith("image/"));await this.host.addImages(d);return}if(JK(s)){const c=s.getData("text/plain"),{lastMousePos:d}=this.toolManager,[u,h]=this.host.service.viewport.toModelCoord(d.x,d.y),p=this._pageService.getEmbedBlockOptions(c),g=p?p.flavour:"affine:bookmark",f=p?p.styles[0]:rc[0],v=At[f],m=bt[f],y=this.host.service.addBlock(g,{xywh:ne.fromCenter(te.toVec({x:u,y:h}),v,m).serialize(),url:c,style:f},this.surface.model.id);this.selectionManager.set({editing:!1,elements:[y]});return}const a=this.std.clipboard.readFromClipboard(s),l=JSON.parse(a[B_]);this._pasteShapesAndBlocks(l).catch(console.error)},this._onCut=n=>{const{selections:i,elements:r}=this.selectionManager;if(r.length===0)return;if(n.get("clipboardState").event.preventDefault(),this._onCopy(n,i).catch(console.error),i[0]?.editing){if(C6(r[0]))return;this.onPageCut(n);return}this.page.transact(()=>{E0(this.surface,r)}),this.selectionManager.set({editing:!1,elements:[]})}}get std(){return this.host.std}get page(){return this.host.page}get surface(){return this.host.surface}get toolManager(){return this.host.tools}get selectionManager(){return this.host.service.selection}get _pageService(){const e=this.std.spec.getService("affine:page");return D(e),e}hostConnected(){this._disposables.disposed&&(this._disposables=new dt),this._init(),this._initEdgelessClipboard()}_createCanvasElement(e,n){if(e.type===bne){const o=new nt.Y.Map,s=e.children??{};for(const[a,l]of Object.entries(s)){const c=n.get(a);D(c),o.set(c,l)}e.children=o}const i=this.host.service.addElement(e.type,e),r=this.host.service.getElementById(i);return D(r),r}_createCanvasElements(e,n){const i=F1(e,r=>{switch(r.type){case"connector":return"connectors";case"group":return"groups";default:return"others"}});return[...i.others?.map(r=>{const o=r.id;D(o);const s=this._createCanvasElement(r,n);return n.set(o,s.id),s}).filter(r=>!!r)??[],...i.connectors?.map(r=>{const o=r.source.id;o&&(r.source.id=n.get(o)??o);const s=r.target.id;s&&(r.target.id=n.get(s)??s);const a=this._createCanvasElement(r,n);return n.set(r.id,a.id),a})??[],...i.groups?.map(r=>{const o=r.id;D(o);const s=this._createCanvasElement(r,n);return n.set(o,s.id),s})??[]]}_createNoteBlocks(e,n){const{host:i}=this;return e.map(({id:o,props:s,children:a})=>{delete s.index,D(s.xywh);const l=i.service.addBlock("affine:note",s,this.page.root.id),c=i.service.getElementById(l);return o&&n.set(o,l),D(c),a.forEach((d,u)=>{this.onBlockSnapshotPaste(d,this.page,c.id,u)}),l})}_createFrameBlocks(e){return e.map(({props:i})=>{const{xywh:r,title:o,background:s}=i;return this.host.service.addBlock("affine:frame",{xywh:r,background:s,title:sk(o)},this.surface.model.id)})}_createImageBlocks(e){return e.map(({props:i})=>{const{xywh:r,sourceId:o,rotate:s}=i;return this.host.service.addBlock("affine:image",{xywh:r,sourceId:o,rotate:s},this.surface.model.id)})}_createBookmarkBlocks(e){return e.map(({props:i})=>{const{xywh:r,style:o,url:s,caption:a,description:l,icon:c,image:d,title:u}=i;return this.host.service.addBlock("affine:bookmark",{xywh:r,style:o,url:s,caption:a,description:l,icon:c,image:d,title:u},this.surface.model.id)})}_createGithubEmbedBlocks(e){return e.map(({props:i})=>{const{xywh:r,style:o,owner:s,repo:a,githubType:l,githubId:c,url:d,caption:u,image:h,status:p,statusReason:g,title:f,description:v,createdAt:m,assignees:y}=i;return this.host.service.addBlock("affine:embed-github",{xywh:r,style:o,owner:s,repo:a,githubType:l,githubId:c,url:d,caption:u,image:h,status:p,statusReason:g,title:f,description:v,createdAt:m,assignees:y},this.surface.model.id)})}_createYoutubeEmbedBlocks(e){return e.map(({props:i})=>{const{xywh:r,style:o,url:s,caption:a,videoId:l,image:c,title:d,description:u,creator:h,creatorUrl:p,creatorImage:g}=i;return this.host.service.addBlock("affine:embed-youtube",{xywh:r,style:o,url:s,caption:a,videoId:l,image:c,title:d,description:u,creator:h,creatorUrl:p,creatorImage:g},this.surface.model.id)})}_createFigmaEmbedBlocks(e){return e.map(({props:i})=>{const{xywh:r,style:o,url:s,caption:a,title:l,description:c}=i;return this.host.service.addBlock("affine:embed-figma",{xywh:r,style:o,url:s,caption:a,title:l,description:c},this.surface.model.id)})}_createLinkedDocEmbedBlocks(e){return e.map(({props:i})=>{const{xywh:r,style:o,caption:s,pageId:a}=i;return this.host.service.addBlock("affine:embed-linked-doc",{xywh:r,style:o,caption:s,pageId:a},this.surface.model.id)})}_emitSelectionChangeAfterPaste(e,n){const i=[...e,...n.filter(r=>Xr(this.page.getBlockById(r)))];this.selectionManager.set({editing:!1,elements:i})}async createElementsFromClipboardData(e,n){const i=F1(e,I=>Gn(I)?"notes":nr(I)?"frames":hs(I)?"images":vi(I)?"bookmarks":ed(I)?"githubEmbeds":kM(I)?"youtubeEmbeds":EM(I)?"figmaEmbeds":Ki(I)?"linkedDocEmbeds":"elements");n=n??this.host.service.viewport.toModelCoord(this.toolManager.lastMousePos.x,this.toolManager.lastMousePos.y);const r=new Map,o=this._createNoteBlocks(i.notes||[],r),s=this._createFrameBlocks(i.frames??[]),a=this._createImageBlocks(i.images??[]),l=this._createBookmarkBlocks(i.bookmarks??[]),c=this._createGithubEmbedBlocks(i.githubEmbeds??[]),d=this._createYoutubeEmbedBlocks(i.youtubeEmbeds??[]),u=this._createFigmaEmbedBlocks(i.figmaEmbeds??[]),h=this._createLinkedDocEmbedBlocks(i.linkedDocEmbeds??[]),p=o.map(I=>this.page.getBlockById(I)),g=s.map(I=>this.page.getBlockById(I)),f=a.map(I=>this.host.service.getElementById(I)),v=l.map(I=>this.host.service.getElementById(I)),m=c.map(I=>this.host.service.getElementById(I)),y=d.map(I=>this.host.service.getElementById(I)),x=u.map(I=>this.host.service.getElementById(I)),T=h.map(I=>this.host.service.getElementById(I)),M=this._createCanvasElements(i.elements||[],r),[k,_]=n,A=Mo([...M,...p,...g,...f,...v,...m,...y,...x,...T]),$=k-A.w/2,E=_-A.h/2;M.forEach(I=>{const N=new ne($+I.x-A.x,E+I.y-A.y,I.w,I.h);I instanceof Ft?I.moveTo(N):this.host.service.updateElement(I.id,{xywh:N.serialize()})});const R=[...p,...g,...f,...v];return R.forEach(I=>{const N=ne.deserialize(I.xywh);N.x+=$-A.x,N.y+=E-A.y,this.surface.edgeless.service.updateElement(I.id,{xywh:N.serialize()})}),[M,R]}async _pasteShapesAndBlocks(e){const[n,i]=await this.createElementsFromClipboardData(e);this._emitSelectionChangeAfterPaste(n.map(r=>r.id),i.map(r=>r.id))}async toCanvas(e,n){e.sort(ei),n.sort(ei);const i=[];e.forEach(s=>{i.push(ne.deserialize(s.xywh))}),n.forEach(s=>{i.push(ne.deserialize(s.xywh))});const r=U1(i);return D(r,"bound not exist"),await this._edgelessToCanvas(this.host,r,e,n)}async copyAsPng(e,n){const i=e.length,r=n.length;if(i+r===0)return;const o=await this.toCanvas(e,n);if(D(o),window.apis?.clipboard?.copyAsImageFromString)await window.apis.clipboard?.copyAsImageFromString(o.toDataURL(O6));else{const s=await new Promise((a,l)=>o.toBlob(c=>c?a(c):l("Canvas can not export blob"),O6));D(s),this.std.clipboard.writeToClipboard(async a=>({...a,[O6]:s})).catch(console.error)}}async _replaceRichTextWithSvgElement(e){const n=Array.from(e.querySelectorAll(".inline-editor"));await Promise.all(n.map(async i=>{const r=await this._elementToSvgElement(i.cloneNode(!0),i.clientWidth,i.clientHeight+1);i.parentElement?.appendChild(r),i.parentElement?.removeChild(i)}))}async _elementToSvgElement(e,n,i){const r="http://www.w3.org/2000/svg",o=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return o.setAttribute("width",`${n}`),o.setAttribute("height",`${i}`),o.setAttribute("viewBox",`0 0 ${n} ${i}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),o.appendChild(s),s.appendChild(e),o}async _edgelessToCanvas(e,n,i,r=[]){const o=e.host;if(!this.page.root)return;const a=(await Jt(()=>import("./html2canvas.esm-Yv5NavHP.js"),__vite__mapDeps([]))).default;if(!(a instanceof Function))return;const l=location.pathname,c=en(o),d=V1(o);D(d);const u=d.viewportElement,h=d.querySelector(".affine-block-children-container");if(!h)return;const p=window.devicePixelRatio||1,g=document.createElement("canvas");g.width=(n.w+100)*p,g.height=(n.h+100)*p;const f=g.getContext("2d");if(!f)return;f.scale(p,p),f.fillStyle=window.getComputedStyle(h).backgroundColor,f.fillRect(0,0,g.width,g.height);const v=this._replaceRichTextWithSvgElement.bind(this);let m;!m&&location.protocol==="https:"&&location.hostname.split(".").includes("affine")&&(m=Hm);const y={ignoreElements:function(k){return!!(k.tagName==="AFFINE-BLOCK-HUB"||k.tagName==="EDGELESS-TOOLBAR"||k.classList.contains("dg"))},onclone:async function(k,_){_.style.setProperty("transform","none");const A=k.querySelector(".affine-edgeless-layer");A&&A instanceof HTMLElement&&A.style.setProperty("transform","none"),k.querySelectorAll("[style*='box-shadow']").forEach(function(E){E instanceof HTMLElement&&E.style.setProperty("box-shadow","none")}),await v(_)},backgroundColor:window.getComputedStyle(u).backgroundColor,useCORS:!m,proxy:m},x=async(k,_=!1)=>{let A=Mk(k,this.std.view)?.parentElement;const $=k.flavour.replace("affine:",".edgeless-block-portal-");if(A=A?.closest($),!A)throw new Error("Could not find edgeless block portal.");const E=ne.deserialize(k.xywh),R=await a(A,y);f.drawImage(R,E.x-n.x+50,E.y-n.y+50,E.w,_?E.w/R.width*R.height:E.h)},T=i??e.service.pickElementsByBound(n,"blocks");for(const k of T){if(await x(k),Ie(k,["affine:frame"])){const _=[];this.surface.frame.getElementsInFrame(k,!1).forEach(A=>{Xr(A)?_.push(A):r.push(A)});for(let A=0;A<_.length;A++){const $=_[A];await x($,!0)}}this._checkCanContinueToCanvas(o,l,c)}const M=e.surface.renderer.getCanvasByBound(n,r);return f.drawImage(M,50,50,n.w,n.h),g}_checkCanContinueToCanvas(e,n,i){if(location.pathname!==n||en(e)!==i)throw new Error("Unable to export content to canvas")}}function Zb(t,e){const n=new Set;return e.forEach(i=>{nr(i)?(n.add(i),t.frame.getElementsInFrame(i).forEach(r=>n.add(r))):(i instanceof On&&Zb(t,i.childElements).forEach(r=>n.add(r)),n.add(i))}),Array.from(n)}function yne(t,e){const n=t.source?.id,i=t.target?.id,r=t.serialize();return n&&!e.find(o=>o.id===n)&&(r.source={position:t.absolutePath[0]}),i&&!e.find(o=>o.id===i)&&(r.target={position:t.absolutePath[t.absolutePath.length-1]}),r}async function Wb(t,e){return(await Promise.all(t.map(async i=>{const r=new ar({workspace:e.workspace});return Gn(i)?{...await r.blockToSnapshot(i)}:nr(i)?{...await r.blockToSnapshot(i)}:hs(i)?{...await r.blockToSnapshot(i)}:vi(i)?{...await r.blockToSnapshot(i)}:ed(i)?{...await r.blockToSnapshot(i)}:kM(i)?{...await r.blockToSnapshot(i)}:EM(i)?{...await r.blockToSnapshot(i)}:Ki(i)?{...await r.blockToSnapshot(i)}:i instanceof Ft?yne(i,t):i.serialize()}))).filter(i=>!!i)}function wne(t){const e=t.types;return e.length===1&&e[0]==="Files"||e.length===2&&(e.includes("text/plain")||e.includes("text/html"))&&e.includes("Files")}const xne=10;async function _ne(t,e,n=!0){const{clipboardController:i}=t,r=Zb(t.surface,e),o=Mo(r);o.x+=o.w+xne;const s=JSON.parse(JSON.stringify(await Wb(r,t.std))),[a,l]=await i.createElementsFromClipboardData(s,o.center),c=[...a,...l];t.surface.fitToViewport(o),n&&t.service.selection.set({elements:c.map(d=>d.id),editing:!1})}const YM=t=>{const{notes:e,frames:n,shapes:i,images:r}=F1(I3(t),o=>Gn(o)?"notes":nr(o)?"frames":hs(o)?"images":"shapes");return{notes:e??[],shapes:i??[],frames:n??[],images:r??[]}};var Cne=Object.defineProperty,kne=Object.getOwnPropertyDescriptor,Dc=(t,e,n,i)=>{for(var r=i>1?void 0:i?kne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Cne(e,n,r),r};const Ene=[{icon:Lc,name:"Frame Section",type:"create-frame"},{icon:D9,name:"Group Section",type:"create-group"},{type:"divider"},{icon:VI,name:"Bring to Front",type:"front"},{icon:zI,name:"Bring Forward",type:"forward"},{icon:jI,name:"Send Backward",type:"backward"},{icon:GI,name:"Send to Back",type:"back"},{type:"divider"},{icon:z9,name:"Copy",type:"copy"},{icon:j9,name:"Copy as PNG",type:"copy-as-png"},{icon:G9,name:"Duplicate",type:"duplicate"},{type:"divider"},{icon:h3,name:"Delete",type:"delete"}],Sne=[{icon:Lc,name:"Frame Section",type:"create-frame"},{type:"divider"},{icon:z9,name:"Copy",type:"copy"},{icon:j9,name:"Copy as PNG",type:"copy-as-png"},{icon:G9,name:"Duplicate",type:"duplicate"},{type:"divider"},{icon:h3,name:"Delete",type:"delete"}];function Tne(t,e){return Fe(t,n=>n.type,n=>n.type==="divider"?b`<menu-divider></menu-divider>`:b`<div
            class="action-item ${n.type}"
            @click=${()=>e(n)}
            ?data-disabled=${n.disabled}
          >
            ${n.icon}${n.name}
          </div>`)}let Ds=class extends me(Ae){constructor(){super(...arguments),this.elements=[],this.vertical=!1,this._showPopper=!1,this._actionsMenuPopper=null,this._runAction=async({type:t})=>{const e=this.edgeless.service.selection;switch(t){case"copy":break;case"duplicate":{await _ne(this.edgeless,e.elements);break}case"delete":{this._delete();break}case"copy-as-png":{const{notes:n,frames:i,shapes:r,images:o}=YM(this.selection.elements);this.slots.copyAsPng.emit({blocks:[...n,...une(i),...o],shapes:r});break}case"create-frame":{this.edgeless.surface.frame.createFrameOnSelected();break}case"create-group":{this.edgeless.service.createGroupFromSelected();break}case"front":case"forward":case"backward":case"back":{this.selection.elements.forEach(n=>{this.edgeless.service.reorderElement(n,t)});break}}this._actionsMenuPopper?.hide()}}get page(){return this.edgeless.page}get selection(){return this.edgeless.service.selection}get slots(){return this.edgeless.slots}get surface(){return this.edgeless.surface}_delete(){this.page.captureSync(),E0(this.surface,this.selection.elements),this.selection.set({elements:[],editing:!1})}firstUpdated(t){const e=this._disposables;this._actionsMenuPopper=Nt(this,this._actionsMenu,({display:n})=>{this._showPopper=n==="show",this.setPopperShow(this._showPopper)}),e.add(this._actionsMenuPopper),super.firstUpdated(t)}render(){const t=this.edgeless.service.selection,e=Tne(t.elements.some(n=>nr(n))?Sne:Ene,this._runAction);return b`
      <edgeless-tool-icon-button
        .tooltip=${this._showPopper?"":"More"}
        .active=${!1}
        .iconContainerPadding=${2}
        @click=${()=>this._actionsMenuPopper?.toggle()}
      >
        ${this.vertical?d0:Xo}
      </edgeless-tool-icon-button>
      <div class="more-actions-container">${e}</div>
    `}};Ds.styles=X`
    :host {
      display: block;
      color: var(--affine-text-primary-color);
      fill: currentColor;
      font-family: ${Je(vt.fontSansFamily)};
    }

    .more-actions-container {
      display: none;
      position: absolute;
      width: 164px;
      padding: 8px;
      justify-content: center;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
      font-size: 16px;
      line-height: 22px;
    }

    .more-actions-container[data-show] {
      display: block;
    }

    .action-item {
      display: flex;
      white-space: nowrap;
      height: 32px;
      box-sizing: border-box;
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      cursor: pointer;
      align-items: center;
      gap: 8px;
    }

    menu-divider {
      width: 88%;
      position: relative;
      left: 8px;
    }

    .action-item:hover {
      background-color: var(--affine-hover-color);
    }
    .action-item:hover.delete {
      background-color: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }

    .action-item[data-disabled] {
      cursor: not-allowed;
    }
  `;Dc([L({attribute:!1})],Ds.prototype,"elements",2);Dc([L({attribute:!1})],Ds.prototype,"edgeless",2);Dc([L({attribute:!1})],Ds.prototype,"vertical",2);Dc([ie()],Ds.prototype,"_showPopper",2);Dc([L({attribute:!1})],Ds.prototype,"setPopperShow",2);Dc([he(".more-actions-container")],Ds.prototype,"_actionsMenu",2);Ds=Dc([W("edgeless-more-button")],Ds);var Ine=Object.defineProperty,Lne=Object.getOwnPropertyDescriptor,qb=(t,e,n,i)=>{for(var r=i>1?void 0:i?Lne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ine(e,n,r),r};let op=class extends Ae{constructor(){super(...arguments),this.vertical=!1,this.dividerMargin=7}render(){const t=we({"--divider-margin":`${this.dividerMargin}px`});return b`<div
      class="divider ${this.vertical?"vertical":"horizontal"}"
      style=${t}
    ></div>`}};op.styles=X`
    :host {
      display: inline-block;
    }

    .divider {
      background-color: var(--affine-border-color);
    }

    .divider.vertical {
      width: 1px;
      height: 100%;
      margin: 0 var(--divider-margin);
    }

    .divider.horizontal {
      width: 100%;
      height: 1px;
      margin: var(--divider-margin) 0;
    }
  `;qb([L({attribute:!1})],op.prototype,"vertical",2);qb([L({attribute:!1})],op.prototype,"dividerMargin",2);op=qb([W("menu-divider")],op);var Mne=Object.defineProperty,Pne=Object.getOwnPropertyDescriptor,XM=(t,e,n,i)=>{for(var r=i>1?void 0:i?Pne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Mne(e,n,r),r};let I8=class extends me(Ae){get elements(){return this.edgeless.service.selection.elements}firstUpdated(){this._disposables.add(this.edgeless.service.selection.slots.updated.on(()=>this.requestUpdate()))}_updateXYWH(t,e){if(t instanceof Ft)t.moveTo(e);else if(t instanceof On){const n=ne.deserialize(t.xywh);t.childElements.forEach(i=>{const r=ne.deserialize(i.xywh);r.x+=e.x-n.x,r.y+=e.y-n.y,this._updateXYWH(i,r)})}else this.edgeless.service.updateElement(t.id,{xywh:e.serialize()})}_alignLeft(){const{elements:t}=this,e=t.map(i=>i.elementBound),n=Math.min(...e.map(i=>i.minX));t.forEach((i,r)=>{const o=e[r],s=ne.deserialize(i.xywh),a=s.minX-o.minX;s.x=n+a,this._updateXYWH(i,s)})}_alignRight(){const{elements:t}=this,e=t.map(i=>i.elementBound),n=Math.max(...e.map(i=>i.maxX));t.forEach((i,r)=>{const o=e[r],s=ne.deserialize(i.xywh),a=s.maxX-o.maxX;s.x=n-s.w+a,this._updateXYWH(i,s)})}_alignHorizontally(){const{elements:t}=this,e=t.map(o=>o.elementBound),n=Math.min(...e.map(o=>o.minX)),i=Math.max(...e.map(o=>o.maxX)),r=(n+i)/2;t.forEach(o=>{const s=ne.deserialize(o.xywh);s.x=r-s.w/2,this._updateXYWH(o,s)})}_alignDistributeHorizontally(){const{elements:t}=this;t.sort((l,c)=>l.elementBound.minX-c.elementBound.minX);const e=t.map(l=>l.elementBound),n=e[0].minX,s=(e[e.length-1].maxX-n-t.reduce((l,c)=>l+c.elementBound.w,0))/(t.length-1);let a=e[0].maxX+s;for(let l=1;l<t.length-1;l++){const c=ne.deserialize(t[l].xywh);c.x=a+e[l].w/2-c.w/2,a+=s+e[l].w,this._updateXYWH(t[l],c)}}_alignTop(){const{elements:t}=this,e=t.map(i=>i.elementBound),n=Math.min(...e.map(i=>i.minY));t.forEach((i,r)=>{const o=e[r],s=ne.deserialize(i.xywh),a=s.minY-o.minY;s.y=n+a,this._updateXYWH(i,s)})}_alignBottom(){const{elements:t}=this,e=t.map(i=>i.elementBound),n=Math.max(...e.map(i=>i.maxY));t.forEach((i,r)=>{const o=e[r],s=ne.deserialize(i.xywh),a=s.maxY-o.maxY;s.y=n-s.h+a,this._updateXYWH(i,s)})}_alignVertically(){const{elements:t}=this,e=t.map(o=>o.elementBound),n=Math.min(...e.map(o=>o.minY)),i=Math.max(...e.map(o=>o.maxY)),r=(n+i)/2;t.forEach(o=>{const s=ne.deserialize(o.xywh);s.y=r-s.h/2,this._updateXYWH(o,s)})}_alignDistributeVertically(){const{elements:t}=this;t.sort((l,c)=>l.elementBound.minY-c.elementBound.minY);const e=t.map(l=>l.elementBound),n=e[0].minY,s=(e[e.length-1].maxY-n-t.reduce((l,c)=>l+c.elementBound.h,0))/(t.length-1);let a=e[0].maxY+s;for(let l=1;l<t.length-1;l++){const c=ne.deserialize(t[l].xywh);c.y=a+e[l].h/2-c.h/2,a+=s+e[l].h,this._updateXYWH(t[l],c)}}render(){return b`
      <edgeless-menu-button
        .iconInfo=${{icon:b`${f8}${Pi}`,tooltip:"Align Objects"}}
        .menuChildren=${b`<edgeless-tool-icon-button
            @click=${()=>this._alignLeft()}
            .tooltip=${"Align left"}
            >${f8}</edgeless-tool-icon-button
          >
          <edgeless-tool-icon-button
            @click=${()=>this._alignHorizontally()}
            .tooltip=${"Align horizontally"}
          >
            ${qI}
          </edgeless-tool-icon-button>

          <edgeless-tool-icon-button
            @click=${()=>this._alignRight()}
            .tooltip=${"Align right"}
          >
            ${WI}
          </edgeless-tool-icon-button>
          <edgeless-tool-icon-button
            .disabled=${this.elements.length<3}
            @click=${()=>this._alignDistributeHorizontally()}
            .tooltip=${"Distribute horizontally"}
            }
          >
            ${YI}
          </edgeless-tool-icon-button>
          <menu-divider
            style=${we({height:"24px"})}
            .vertical=${!0}
          ></menu-divider>

          <edgeless-tool-icon-button
            @click=${()=>this._alignTop()}
            .tooltip=${"Align top"}
            >${XI}</edgeless-tool-icon-button
          >
          <edgeless-tool-icon-button
            @click=${()=>this._alignVertically()}
            .tooltip=${"Align vertically"}
          >
            ${QI}
          </edgeless-tool-icon-button>

          <edgeless-tool-icon-button
            @click=${()=>this._alignBottom()}
            .tooltip=${"Align bottom"}
          >
            ${KI}
          </edgeless-tool-icon-button>
          <edgeless-tool-icon-button
            .tooltip=${"Distribute vertically"}
            .disabled=${this.elements.length<3}
            @click=${()=>this._alignDistributeVertically()}
          >
            ${JI}
          </edgeless-tool-icon-button> `}
      >
      </edgeless-menu-button>
    `}};XM([L({attribute:!1})],I8.prototype,"edgeless",2);I8=XM([W("edgeless-align-button")],I8);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*Ane(t,e){const n=typeof e=="function";if(t!==void 0){let i=-1;for(const r of t)i>-1&&(yield n?e(i):e),i++,yield r}}var $ne=Object.defineProperty,Bne=Object.getOwnPropertyDescriptor,L0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Bne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&$ne(e,n,r),r};let oc=class extends me(Ae){constructor(){super(...arguments),this.left=0,this.top=0,this._showPopper=!1,this.togglePopper=t=>{this._showPopper=t},this._updateOnSelectedChange=t=>{const e=typeof t=="string"?t:t.id;this.isConnected&&this.selection.has(e)&&this.requestUpdate()}}get page(){return this.edgeless.page}get selection(){return this.edgeless.service.selection}get slots(){return this.edgeless.slots}get surface(){return this.edgeless.surface}_groupSelected(){return F1(this.selection.elements,e=>Gn(e)?"note":nr(e)?"frame":hs(e)?"image":vi(e)||u2(e)?"embedCard":e.type)}_ShapeButton(t){return t?.length?b`<edgeless-change-shape-button
          .elements=${t}
          .page=${this.page}
          .surface=${this.surface}
        >
        </edgeless-change-shape-button>`:ae}_BrushButton(t){return t?.length?b`<edgeless-change-brush-button
          .elements=${t}
          .page=${this.page}
          .surface=${this.surface}
        >
        </edgeless-change-brush-button>`:ae}_ConnectorButton(t){return t?.length?b` <edgeless-change-connector-button
          .elements=${t}
          .page=${this.page}
          .surface=${this.surface}
          .edgeless=${this.edgeless}
        >
        </edgeless-change-connector-button>`:ae}_NoteButton(t){return t&&t.length>=0?b`<edgeless-change-note-button
          .notes=${t}
          .surface=${this.surface}
        >
        </edgeless-change-note-button>`:ae}_EmbedCardButton(t){if(t?.length!==1)return ae;const e=t[0];return b`
      <edgeless-change-embed-card-button
        .model=${e}
        .std=${this.edgeless.std}
        .surface=${this.surface}
      ></edgeless-change-embed-card-button>
    `}_TextButton(t){return t?.length?b`<edgeless-change-text-button
          .texts=${t}
          .page=${this.page}
          .surface=${this.surface}
        >
        </edgeless-change-text-button>`:ae}_FrameButton(t){return t?.length?b`
          <edgeless-change-frame-button
            .surface=${this.surface}
            .frames=${t}
          >
          </edgeless-change-frame-button>
        `:ae}_GroupButton(t){return t?.length?b`<edgeless-change-group-button
          .surface=${this.surface}
          .groups=${t}
        >
        </edgeless-change-group-button>`:ae}firstUpdated(){const{_disposables:t,edgeless:e}=this;t.add(e.service.viewport.viewportUpdated.on(()=>{const[n,i]=this._computePosition();this.left=n,this.top=i})),t.add(this.selection.slots.updated.on(()=>{this.requestUpdate()})),Im(this.edgeless.service.surface,["elementAdded","elementRemoved","elementUpdated"]).forEach(n=>t.add(n.on(this._updateOnSelectedChange))),t.add(this.page.slots.blockUpdated.on(this._updateOnSelectedChange))}_CreateGroupButton(){return b`<edgeless-add-group-button
      .edgeless=${this.edgeless}
    ></edgeless-add-group-button> `}_CreateFrameButton(){return b`<edgeless-add-frame-button
      .edgeless=${this.edgeless}
    ></edgeless-add-frame-button>`}_ReleaseFromGroupButton(){return b`<edgeless-release-from-group-button
      .surface=${this.surface}
    ></edgeless-release-from-group-button>`}_AlignButton(){return b`<edgeless-align-button
      .edgeless=${this.edgeless}
    ></edgeless-align-button>`}_Divider(){return b`<component-toolbar-menu-divider></component-toolbar-menu-divider>`}async updated(t){const[e,n]=this._computePosition();await this.updateComplete,this.left=e,this.top=n}_computePosition(){const{selection:t,viewport:e}=this.edgeless.service,n=Mo(t.elements),{width:i,height:r}=e,[o,s]=e.toViewCoord(n.x,n.y),[a,l]=e.toViewCoord(n.maxX,n.maxY),c=this.getBoundingClientRect();let d,u;if(o>=i||a<=0||s>=r||l<=0)return d=a<=0?o-c.width:o,u=l<=0?s-c.height:s,[d,u];let h=34;return this.selection.elements.find(p=>nr(p))&&(h+=10),u=s-c.height-h,u<0&&(u=s+n.h*e.zoom+h),d=Zr(o,10,i-c.width-10),this._showPopper&&(d=Zr(o,10,i-c.width-80)),u=Zr(u,10,r-c.height-100),[d,u]}render(){const t=this._groupSelected(),{edgeless:e,selection:n}=this,{shape:i,brush:r,connector:o,note:s,text:a,frame:l,group:c,embedCard:d}=t,{elements:u}=this.selection,p=fD(Object.values(t),f=>!!f.length,2)?[]:[this._ShapeButton(i),this._BrushButton(r),this._ConnectorButton(o),this._NoteButton(s),this._EmbedCardButton(d),this._TextButton(a),this._FrameButton(l),this._GroupButton(c)].filter(f=>!!f&&f!==ae);u.length>1&&(p.unshift(this._Divider()),p.unshift(this._AlignButton()),p.unshift(this._Divider()),p.unshift(this._CreateGroupButton()),p.unshift(this._Divider()),p.unshift(this._CreateFrameButton())),u.length===1&&n.firstElement.group!==null&&(p.unshift(this._Divider()),p.unshift(this._ReleaseFromGroupButton()));const g=p.at(-1);return p.length>0&&(typeof g=="symbol"||!g?.strings[0].includes("component-toolbar-menu-divider"))&&p.push(this._Divider()),b` <style>
        :host {
          position: absolute;
          z-index: 3;
          left: ${this.left}px;
          top: ${this.top}px;
        }
      </style>
      <div
        class="edgeless-component-toolbar-container"
        @pointerdown=${at}
      >
        ${Ane(p,()=>"")}
        <edgeless-more-button
          .edgeless=${e}
          .vertical=${!0}
          .setPopperShow=${this.togglePopper}
        ></edgeless-more-button>
      </div>`}};oc.styles=X`
    .edgeless-component-toolbar-container {
      display: flex;
      align-items: center;
      height: 40px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-menu-shadow);
      border-radius: 8px;
      padding: 0 8px;
      font-family: ${Je(vt.fontSansFamily)};
    }

    component-toolbar-menu-divider {
      width: 4px;
      margin: 0 12px;
      height: 24px;
    }
  `;L0([L({attribute:!1})],oc.prototype,"edgeless",2);L0([ie()],oc.prototype,"left",2);L0([ie()],oc.prototype,"top",2);L0([ie()],oc.prototype,"_showPopper",2);oc=L0([W("edgeless-component-toolbar")],oc);var Dne=Object.defineProperty,One=Object.getOwnPropertyDescriptor,H3=(t,e,n,i)=>{for(var r=i>1?void 0:i?One(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Dne(e,n,r),r};let dd=class extends me(Ae){constructor(){super(...arguments),this.show=!1,this._blackBackground=!1}_tryLoadBlackBackground(){const t=this.edgeless.service.editSession.getItem("presentBlackBackground");this._blackBackground=t||!0}firstUpdated(){const{_disposables:t,edgeless:e}=this;t.add(e.slots.navigatorFrameChanged.on(n=>{this.frame=n})),t.add(e.slots.navigatorSettingUpdated.on(({blackBackground:n})=>{n!==void 0&&(this.edgeless.service.editSession.setItem("presentBlackBackground",n),this._blackBackground=n,this.show=n&&e.edgelessTool.type==="frameNavigator")})),t.add(e.slots.edgelessToolUpdated.on(n=>{n.type!=="frameNavigator"?this.show=!1:this.show=this._blackBackground})),t.add(e.slots.fullScrennToggled.on(()=>setTimeout(()=>{this.requestUpdate()},500))),this._tryLoadBlackBackground()}render(){const{edgeless:t,frame:e,show:n}=this;if(!n||!e)return ae;const i=ne.deserialize(e.xywh),r=t.service.viewport.zoom,o=i.w*r,s=i.h*r,[a,l]=t.service.viewport.toViewCoord(i.x,i.y);return b` <style>
        .edgeless-navigator-black-background {
          width: ${o}px;
          height: ${s}px;
          top: ${l}px;
          left: ${a}px;
        }
      </style>
      <div class="edgeless-navigator-black-background"></div>`}};dd.styles=X`
    .edgeless-navigator-black-background {
      background-color: black;
      position: absolute;
      z-index: 1;
      background-color: transparent;
      box-shadow: 0 0 0 5000px black;
    }
  `;H3([ie()],dd.prototype,"frame",2);H3([ie()],dd.prototype,"show",2);H3([L({attribute:!1})],dd.prototype,"edgeless",2);dd=H3([W("edgeless-navigator-black-background")],dd);var Rne=Object.defineProperty,Nne=Object.getOwnPropertyDescriptor,ao=(t,e,n,i)=>{for(var r=i>1?void 0:i?Nne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Rne(e,n,r),r};const D_=new Map([["affine:frame","edgeless-block-portal-frame"],["affine:note","edgeless-block-portal-note"],["affine:image","edgeless-block-portal-image"],["affine:bookmark","edgeless-block-portal-bookmark"],[/affine:embed-*/,"edgeless-block-portal-embed"]]);let ir=class extends me(De){constructor(){super(...arguments),this._showIndexLabel=!1,this._toolbarVisible=!1,this._isResizing=!1,this._enableNoteSlicer=!1,this._slicerAnchorNote=null,this._surfaceRefReferenceSet=new Set,this._clearWillChangeId=null,this.refreshLayerViewport=zm(()=>{if(!this.edgeless||!this.edgeless.surface)return;const{service:t}=this.edgeless,{zoom:e,translateX:n,translateY:i}=t.viewport,{gap:r}=$b(e,!0);this.container.style.setProperty("background-position",`${n}px ${i}px`),this.container.style.setProperty("background-size",`${r}px ${r}px`),this.layer.style.setProperty("transform",this._getLayerViewport()),this.canvasSlot.style.setProperty("--canvas-transform-offset",this._getLayerViewport(!0))},this),this._applyWillChangeProp=()=>{this._clearWillChangeId&&clearTimeout(this._clearWillChangeId),this._clearWillChangeId=setTimeout(()=>{this.layer?.style.removeProperty("will-change"),this._clearWillChangeId=null},100),this.layer.style.getPropertyValue("will-change")!=="content"&&Eo(()=>{this.layer.style.setProperty("will-change","content")},this)}}static renderPortal(t,e,n,i){const r=Array.from(D_.entries()).find(([l])=>typeof l=="string"?l===t.flavour:l.test(t.flavour));D(r,`Unknown block flavour for edgeless portal: ${t.flavour}`);const[o,s]=r,a=st`${zn(s)}`;return Be`<${a}
          slot="blocks"
          data-index=${t.index}
          .index=${e}
          .model=${t}
          .surface=${n}
          .edgeless=${i}
          style=${we({zIndex:e,position:"relative"})}
        ></${a}>`}get isDragging(){return this.selectedRect.dragging}setSlotContent(t){this.canvasSlot.children.length!==t.length&&(t.forEach(e=>{e.style.setProperty("transform","var(--canvas-transform-offset)")}),this.canvasSlot.replaceChildren(...t))}_updateReference(){const{_surfaceRefReferenceSet:t,edgeless:e}=this;e.service.blocks.filter(n=>n.flavour==="affine:note").forEach(n=>{n.children.forEach(i=>{Ie(i,["affine:surface-ref"])&&t.add(i.reference)})})}_updateIndexLabel(){const{edgeless:t}=this,{elements:e}=t.service.selection;!t.service.selection.editing&&e.length===1&&(Gn(e[0])||this._surfaceRefReferenceSet.has(e[0].id))?this._showIndexLabel=!0:this._showIndexLabel=!1}_updateNoteSlicer(){const{edgeless:t}=this,{elements:e}=t.service.selection;!t.service.selection.editing&&e.length===1&&Gn(e[0])?this._slicerAnchorNote=e[0]:this._slicerAnchorNote=null}_getLayerViewport(t=!1){const{service:e}=this.edgeless,{translateX:n,translateY:i,zoom:r}=e.viewport;return t?`scale(${1/r}) translate(${-n}px, ${-i}px)`:`translate(${n}px, ${i}px) scale(${r})`}firstUpdated(){this._updateReference();const{_disposables:t,edgeless:e}=this,{page:n}=e;t.add(e.service.viewport.viewportUpdated.on(()=>{this._applyWillChangeProp(),this.refreshLayerViewport()})),t.add(e.service.layer.slots.layerUpdated.on(()=>{this.requestUpdate()})),t.add(e.slots.readonlyUpdated.on(()=>{this.requestUpdate()})),t.add(n.slots.blockUpdated.on(i=>{const{type:r,flavour:o}=i;(r==="add"||r==="delete")&&(o==="affine:surface-ref"||o==="affine:note")&&Eo(()=>{this._updateReference(),this._updateIndexLabel()},this),r==="update"&&o==="affine:note"&&i.props.key==="displayMode"&&this.requestUpdate(),r==="update"&&o==="affine:page"&&i.props.key==="sys:children"&&this.requestUpdate()})),t.add(e.service.selection.slots.updated.on(()=>{const i=e.service.selection;i.selectedIds.length===0||i.editing?this._toolbarVisible=!1:this._toolbarVisible=!0,this._enableNoteSlicer=!1,this._updateIndexLabel(),this._updateNoteSlicer()})),t.add(e.slots.elementResizeStart.on(()=>{this._isResizing=!0})),t.add(e.slots.elementResizeEnd.on(()=>{this._isResizing=!1})),t.add(e.surfaceBlockModel.elementUpdated.on(({id:i,props:r})=>{const o=e.service.getElementById(i);Gn(o)&&r&&r.displayMode&&this.requestUpdate()})),t.add(e.slots.toggleNoteSlicer.on(()=>{this._enableNoteSlicer=!this._enableNoteSlicer}))}render(){const{edgeless:t}=this,{surface:e,page:n,service:i}=t,{readonly:r}=n;if(!e)return ae;const o=n.root?.children.filter(c=>Ie(c,["affine:note"])),s=i.layer.layers,a=new Map,l=new Set;return o.forEach(c=>{Gn(c)&&(c.displayMode===qe.EdgelessOnly||!c.displayMode&&c.hidden?l.add(c):(c.displayMode===qe.DocAndEdgeless||!c.displayMode&&!c.hidden)&&a.set(c,1)),c.children.forEach(d=>{if(Ie(d,["affine:surface-ref"])){const u=i.getElementById(d.reference);a.has(u)?a.set(u,a.get(u)+1):a.set(u,1)}})}),Be`
      <div class="affine-block-children-container edgeless">
        <div class="affine-edgeless-layer">
          <edgeless-frames-container
            .surface=${e}
            .edgeless=${t}
            .frames=${i.layer.frames}
          >
          </edgeless-frames-container>
          <div class="canvas-slot"></div>
          ${s.filter(c=>c.type==="block").map(c=>Fe(c.elements,d=>d.id,(d,u)=>{const h=Array.from(D_.entries()).find(([m])=>typeof m=="string"?m===d.flavour:m.test(d.flavour));D(h,`Unknown block flavour for edgeless portal: ${d.flavour}`);const[p,g]=h,f=zn(g),v=c.zIndexes[0]+u;return Be`<${f}
                      data-index=${d.index}
                      data-portal-block-id=${d.id}
                      .index=${v}
                      .model=${d}
                      .surface=${e}
                      .edgeless=${t}
                      style=${we({zIndex:v,position:"relative"})}
                    ></${f}>`}))}
        </div>
      </div>
      <edgeless-dragging-area-rect
        .edgeless=${t}
      ></edgeless-dragging-area-rect>
      ${r||this._isResizing||!this._enableNoteSlicer?ae:Be`<note-slicer
            .edgeless=${t}
            .anchorNote=${this._slicerAnchorNote}
          ></note-slicer>`}

      <edgeless-selected-rect
        .edgeless=${t}
        .toolbarVisible=${this._toolbarVisible}
        .setToolbarVisible=${c=>{this._toolbarVisible=c}}
        .autoCompleteOff=${this._enableNoteSlicer}
      ></edgeless-selected-rect>
      <edgeless-index-label
        .pageVisibleElementsMap=${a}
        .edgelessOnlyNotesSet=${l}
        .surface=${e}
        .edgeless=${t}
        .show=${this._showIndexLabel}
      ></edgeless-index-label>
      ${this._toolbarVisible&&!n.readonly?Be`<edgeless-component-toolbar .edgeless=${t}>
          </edgeless-component-toolbar>`:ae}
      <edgeless-navigator-black-background
        .edgeless=${t}
      ></edgeless-navigator-black-background>
    `}};ir.styles=X`
    .surface-layer {
      position: absolute;
    }

    .affine-edgeless-layer edgeless-frames-container {
      position: relative;
      z-index: 1;
    }
  `;ao([L({attribute:!1})],ir.prototype,"edgeless",2);ao([he(".affine-block-children-container.edgeless")],ir.prototype,"container",2);ao([he("edgeless-selected-rect")],ir.prototype,"selectedRect",2);ao([he(".affine-edgeless-layer")],ir.prototype,"layer",2);ao([he(".canvas-slot")],ir.prototype,"canvasSlot",2);ao([ie()],ir.prototype,"_showIndexLabel",2);ao([ie()],ir.prototype,"_toolbarVisible",2);ao([ie()],ir.prototype,"_isResizing",2);ao([ie()],ir.prototype,"_enableNoteSlicer",2);ao([ie()],ir.prototype,"_slicerAnchorNote",2);ir=ao([W("edgeless-block-portal-container")],ir);function L8(t){const e=window.getComputedStyle(t);return Ob.reduce((i,r)=>{const o=e.getPropertyValue(r).trim();return i[r]=o,r==="--affine-palette-transparent"&&!o&&(i[r]="#00000000"),i},{})}class cu extends Ve{constructor(){super(...arguments),this._mode="",this._cssVariables=null}get cssVariables(){return this._cssVariables}observe(e){this._observer?.disconnect(),this._cssVariables=L8(e),this._observer=new MutationObserver(()=>{const n=e.getAttribute("data-theme");this._mode!==n&&(this._cssVariables=L8(e),this.emit(this._cssVariables))}),this._observer.observe(e,{attributes:!0,attributeFilter:["data-theme"]})}getVariableValue(e){if($3(e)){const n=this._cssVariables?.[e];if(n===void 0)console.error(new Error(`Cannot find css variable: ${e}`));else return n}return e}dispose(){super.dispose(),this._observer?.disconnect()}}const Hne=5;class Fne extends nl{constructor(e){super(),this.container=e,this._alignableBounds=[],this._intraGraphicAlignLines=[],this._distributedAlignLines=[]}_getBoundsWithRotationByAlignable(e){const n=Xr(e)?0:e.rotate,[i,r,o,s]=Wn(e.xywh);return ne.from(ks({x:i,y:r,w:o,h:s,rotate:n}))}setupAlignables(e){if(e.length===0)return new ne;const{surface:n,service:i}=this.container,r=e.filter(SM).reduce((c,d)=>{const u=i.getConnectors(d);return u.length>0&&(c=c.concat(u)),c},[]),{viewport:o}=i,s=ne.from(o.viewportBounds);n.renderer.addOverlay(this);const a=i.elements,l=[...e,...r];return this._alignableBounds=[],[...i.blocks,...a].forEach(c=>{const d=this._getBoundsWithRotationByAlignable(c);s.isOverlapWithBound(d)&&!l.includes(c)&&this._alignableBounds.push(d)}),e.reduce((c,d)=>{const u=this._getBoundsWithRotationByAlignable(d);return c.unite(u)},ne.deserialize(e[0].xywh))}cleanupAlignables(){const{renderer:e}=this.container.surface;this._alignableBounds=[],this._intraGraphicAlignLines=[],this._distributedAlignLines=[],e.removeOverlay(this)}align(e){const n={dx:0,dy:0},i=Hne,{service:r}=this.container,{viewport:o}=r;this._intraGraphicAlignLines=[],this._distributedAlignLines=[];for(const s of this._alignableBounds){const a=this._calculateClosestDistances(e,s);a.absXDistance<i&&this._updateXAlignPoint(n,e,s,a),a.absYDistance<i&&this._updateYAlignPoint(n,e,s,a)}return n.dx===0&&this._alignDistributeHorizontally(n,e,i,o),n.dy===0&&this._alignDistributeVertically(n,e,i,o),this._draw(),n}_calculateClosestDistances(e,n){const i=n.center[0]-e.center[0],r=n.center[1]-e.center[1],o=n.minX-e.center[0],s=n.maxX-e.center[0],a=n.minY-e.center[1],l=n.maxY-e.center[1],c=n.minX-e.minX,d=n.maxX-e.minX,u=n.minX-e.maxX,h=n.maxX-e.maxX,p=n.minY-e.minY,g=n.maxY-e.minY,f=n.minY-e.maxY,v=n.maxY-e.maxY,m=[i,o,s,c,d,u,h],y=[r,a,l,p,g,f,v],x=m.map(Math.abs),T=y.map(Math.abs),M=Math.min(...x),k=Math.min(...T),_=x.indexOf(M),A=T.indexOf(k);return{absXDistance:M,absYDistance:k,xDistance:m[_],yDistance:y[A],indexX:_,indexY:A}}_updateXAlignPoint(e,n,i,r){const o=r.indexX;e.dx=r.xDistance;const s=[i.center[0],i.minX,i.maxX,n.minX+e.dx,n.minX+e.dx,n.maxX+e.dx,n.maxX+e.dx][o];this._intraGraphicAlignLines[0]=[new je(s,n.center[1]),new je(s,i.center[1])]}_updateYAlignPoint(e,n,i,r){const o=r.indexY;e.dy=r.yDistance;const s=[i.center[1],i.minY,i.maxY,n.minY+e.dy,n.minY+e.dy,n.maxY+e.dy,n.maxY+e.dy][o];this._intraGraphicAlignLines[1]=[new je(n.center[0],s),new je(i.center[0],s)]}_alignDistributeHorizontally(e,n,i,r){const o=[];this._alignableBounds.forEach(l=>{l.isHorizontalCross(n)&&o.push(l)});let s=1/0,a=1/0;for(let l=0;l<o.length;l++)for(let c=l+1;c<o.length;c++){let d=o[l],u=o[c];if(!d.isHorizontalCross(u)||d.isIntersectWithBound(u))continue;if(u.maxX<d.minX){const g=u;u=d,d=g}let h=0;const p=()=>{if(s=Math.abs(n.center[0]-h),s<=i&&s<a){a=s,e.dx=h-n.center[0];const g=[d.minY,d.maxY,u.minY,u.maxY].sort((y,x)=>y-x),f=(g[1]+g[2])/2,v=2/r.zoom,m=[h-n.w/2-v,h+n.w/2+v,u.minX,u.maxX,d.minX,d.maxX].sort((y,x)=>y-x);this._distributedAlignLines[0]=[new je(m[1],f),new je(m[2],f)],this._distributedAlignLines[1]=[new je(m[3],f),new je(m[4],f)]}};d.horizontalDistance(u)>n.w&&(h=(d.maxX+u.minX)/2,p()),h=d.minX-(u.minX-d.maxX)-n.w/2,p(),h=u.minX-d.maxX+u.maxX+n.w/2,p()}}_alignDistributeVertically(e,n,i,r){const o=[];this._alignableBounds.forEach(l=>{l.isVerticalCross(n)&&o.push(l)});let s=1/0,a=1/0;for(let l=0;l<o.length;l++)for(let c=l+1;c<o.length;c++){let d=o[l],u=o[c];if(!d.isVerticalCross(u)||d.isIntersectWithBound(u))continue;if(u.maxY<d.minX){const g=d;d=u,u=g}let h=0;const p=()=>{if(s=Math.abs(n.center[1]-h),s<=i&&s<a){a=s,e.dy=h-n.center[1];const g=[d.minX,d.maxX,u.minX,u.maxX].sort((y,x)=>y-x),f=(g[1]+g[2])/2,v=2/r.zoom,m=[h-n.h/2-v,h+n.h/2+v,u.minY,u.maxY,d.minY,d.maxY].sort((y,x)=>y-x);this._distributedAlignLines[3]=[new je(f,m[1]),new je(f,m[2])],this._distributedAlignLines[4]=[new je(f,m[3]),new je(f,m[4])]}};d.verticalDistance(u)>n.h&&(h=(d.maxY+u.minY)/2,p()),h=d.minY-(u.minY-d.maxY)-n.h/2,p(),h=u.minY-d.maxY+u.maxY+n.h/2,p()}}_draw(){const{surface:e}=this.container;e.refresh()}render(e){if(this._intraGraphicAlignLines.length===0&&this._distributedAlignLines.length===0)return;const{viewport:n}=this.container.service,i=1/n.zoom,r=5/n.zoom;e.strokeStyle="#1672F3",e.lineWidth=i,e.beginPath(),this._intraGraphicAlignLines.forEach(o=>{let s="";if(o[0].x===o[1].x){const a=o[0].x,l=Math.min(o[0].y,o[1].y),c=Math.max(o[0].y,o[1].y);s=`M${a},${l-r}L${a},${c}`}else{const a=o[0].y,l=Math.min(o[0].x,o[1].x),c=Math.max(o[0].x,o[1].x);s=`M${l-r},${a}L${c+r},${a}`}e.stroke(new Path2D(s))}),this._distributedAlignLines.forEach(o=>{const s=10/n.zoom;let a="";if(o[0].x===o[1].x){const l=o[0].x,c=Math.min(o[0].y,o[1].y)+r,d=Math.max(o[0].y,o[1].y)-r;a=`M${l},${c}L${l},${d}
        M${l-s},${c}L${l+s},${c}
        M${l-s},${d}L${l+s},${d} `}else{const l=o[0].y,c=Math.min(o[0].x,o[1].x)+r,d=Math.max(o[0].x,o[1].x)-r;a=`M${c},${l}L${d},${l}
        M${c},${l-s}L${c},${l+s}
        M${d},${l-s}L${d},${l+s}`}e.stroke(new Path2D(a))})}}var Une=Object.defineProperty,Vne=Object.getOwnPropertyDescriptor,Yb=(t,e,n,i)=>{for(var r=i>1?void 0:i?Vne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Une(e,n,r),r};let ud=class extends wn{constructor(){super(...arguments),this._lastTime=0,this._cachedViewport=new ne,this.themeObserver=new cu,this._initThemeObserver=()=>{this.themeObserver.observe(document.documentElement),this.themeObserver.on(()=>this.requestUpdate()),this.disposables.add(()=>this.themeObserver.dispose())}}get renderer(){return this._renderer}get edgeless(){return this.parentBlockElement}get _isEdgeless(){return ms(this.host)}get service(){return super.service}connectedCallback(){if(super.connectedCallback(),this.setAttribute(Qp.rangeSyncExcludeAttr,"true"),!this._isEdgeless)return;const{edgeless:t}=this;this._initThemeObserver(),this._initRenderer(),this._initOverlay(),this.frame=new pne(t),this.snap=new Fne(t)}_initOverlay(){this.overlays={connector:new PY(this.edgeless.service),frame:new hne},fk(this.overlays).forEach(t=>{this._renderer.addOverlay(t)})}_initRenderer(){const t=this.edgeless.service;this._renderer=new ET({layerManager:t.layer,enableStackingCanvas:!0,provider:{selectedElements:()=>t.selection.selectedIds,getVariableColor:e=>this.themeObserver.getVariableValue(e)},onStackingCanvasCreated(e){e.className="indexable-canvas",e.style.setProperty("transform-origin","0 0"),e.style.setProperty("position","absolute"),e.style.setProperty("pointer-events","none")}}),this._disposables.add(this.model.elementUpdated.on(()=>{this._renderer.refresh()})),this._disposables.add(this.edgeless.service.selection.slots.updated.on(()=>{this._renderer.refresh()})),this._disposables.add(this._renderer.sync(this.edgeless.service.viewport)),this._disposables.add(()=>{this._renderer.dispose()}),this._disposables.add(this._renderer.stackingCanvasUpdated.on(()=>{this._emitStackingCanvasUpdate()}))}firstUpdated(){this._isEdgeless&&(this._renderer.attach(this._surfaceContainer),this._initResizeEffect())}_emitStackingCanvasUpdate(){const t=new CustomEvent("indexedcanvasupdate",{detail:{content:this._renderer.stackingCanvas}});this.dispatchEvent(t)}_initResizeEffect(){const t=new ResizeObserver(()=>{this._renderer.onResize()});t.observe(this._surfaceContainer),this._disposables.add(()=>{t.disconnect()})}refresh(){this._renderer.refresh()}fitToViewport(t){const{viewport:e}=this.edgeless.service;t=t.expand(30),Date.now()-this._lastTime>200&&(this._cachedViewport=e.viewportBounds),this._lastTime=Date.now(),!this._cachedViewport.contains(t)&&(this._cachedViewport=this._cachedViewport.unite(t),e.setViewportByBound(this._cachedViewport,[0,0,0,0],!0))}initDefaultGestureHandler(){const{_renderer:t}=this;t.canvas.addEventListener("wheel",e=>{if(e.preventDefault(),e.ctrlKey){const n=RT(e.deltaY);t.setZoom(n)}else{const n=e.deltaX/t.zoom,i=e.deltaY/t.zoom;t.setCenter(t.centerX+n,t.centerY+i)}})}render(){return this._isEdgeless?b`
      <div class="affine-edgeless-surface-block-container">
        <!-- attach canvas later in renderer -->
      </div>
    `:ae}};ud.styles=X`
    .affine-edgeless-surface-block-container {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .affine-edgeless-surface-block-container canvas {
      width: 100%;
      height: 100%;
      position: relative;
      z-index: 1;
      pointer-events: none;
    }

    edgeless-block-portal-container {
      position: relative;
      box-sizing: border-box;
      overflow: hidden;
      display: block;
      height: 100%;
      font-family: var(--affine-font-family);
      font-size: var(--affine-font-base);
      line-height: var(--affine-line-height);
      color: var(--affine-text-primary-color);
      font-weight: 400;
    }

    .affine-block-children-container.edgeless {
      padding-left: 0;
      position: relative;
      overflow: hidden;
      height: 100%;
      /**
       * Fix: pointerEvent stops firing after a short time.
       * When a gesture is started, the browser intersects the touch-action values of the touched element and its ancestors,
       * up to the one that implements the gesture (in other words, the first containing scrolling element)
       * https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action
       */
      touch-action: none;
      background-color: var(--affine-background-primary-color);
      background-image: radial-gradient(
        var(--affine-edgeless-grid-color) 1px,
        var(--affine-background-primary-color) 1px
      );
      z-index: 0;
    }

    .affine-edgeless-block-child {
      position: absolute;
      transform-origin: center;
      box-sizing: border-box;
      border: 2px solid var(--affine-white-10);
      border-radius: 8px;
      box-shadow: var(--affine-shadow-3);
      pointer-events: all;
    }
  `;Yb([he("edgeless-block-portal-container")],ud.prototype,"portal",2);Yb([he(".affine-edgeless-surface-block-container")],ud.prototype,"_surfaceContainer",2);ud=Yb([W("affine-surface")],ud);function zne(t){return t.closest("affine-editor-container")}function KM(t,e){const n=zne(t);if(n)return n.themeObserver.on(e)}const jne=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <style xmlns="http://www.w3.org/2000/svg">
    .spinner {
      transform-origin: center;
      animation: spinner_animate 0.75s infinite linear;
    }
    @keyframes spinner_animate {
      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <path
    d="M14.6666 7.99992C14.6666 11.6818 11.6818 14.6666 7.99992 14.6666C4.31802 14.6666 1.33325 11.6818 1.33325 7.99992C1.33325 4.31802 4.31802 1.33325 7.99992 1.33325C11.6818 1.33325 14.6666 4.31802 14.6666 7.99992ZM3.30003 7.99992C3.30003 10.5956 5.40424 12.6998 7.99992 12.6998C10.5956 12.6998 12.6998 10.5956 12.6998 7.99992C12.6998 5.40424 10.5956 3.30003 7.99992 3.30003C5.40424 3.30003 3.30003 5.40424 3.30003 7.99992Z"
    fill-opacity="0.1"
  />
  <path
    d="M13.6833 7.99992C14.2263 7.99992 14.674 7.55732 14.5942 7.02014C14.5142 6.48171 14.3684 5.95388 14.1591 5.4487C13.8241 4.63986 13.333 3.90493 12.714 3.28587C12.0949 2.66682 11.36 2.17575 10.5511 1.84072C10.046 1.63147 9.51812 1.48564 8.9797 1.40564C8.44251 1.32583 7.99992 1.77351 7.99992 2.31659C7.99992 2.85967 8.44486 3.28962 8.9761 3.40241C9.25681 3.46201 9.53214 3.54734 9.79853 3.65768C10.3688 3.89388 10.8869 4.24008 11.3233 4.67652C11.7598 5.11295 12.106 5.63108 12.3422 6.20131C12.4525 6.4677 12.5378 6.74303 12.5974 7.02374C12.7102 7.55498 13.1402 7.99992 13.6833 7.99992Z"
    fill="#1E96EB"
    class="spinner"
  />
</svg>`,Gne=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4 2.16667C2.98748 2.16667 2.16667 2.98748 2.16667 4V10.6667V12C2.16667 13.0125 2.98748 13.8333 4 13.8333H12C13.0125 13.8333 13.8333 13.0125 13.8333 12V9.33333V4C13.8333 2.98748 13.0125 2.16667 12 2.16667H4ZM3.16667 12V10.8738L6.07741 7.96303C6.40285 7.63759 6.93048 7.63759 7.25592 7.96303L8.97978 9.68689L10.3131 11.0202C10.5084 11.2155 10.825 11.2155 11.0202 11.0202C11.2155 10.825 11.2155 10.5084 11.0202 10.3131L10.0404 9.33333L10.7441 8.6297C11.0695 8.30426 11.5972 8.30426 11.9226 8.6297L12.8333 9.54044V12C12.8333 12.4602 12.4602 12.8333 12 12.8333H4C3.53976 12.8333 3.16667 12.4602 3.16667 12ZM7.96303 7.25592L9.33333 8.62623L10.037 7.92259C10.7529 7.20663 11.9137 7.20663 12.6297 7.92259L12.8333 8.12623V4C12.8333 3.53976 12.4602 3.16667 12 3.16667H4C3.53976 3.16667 3.16667 3.53976 3.16667 4V9.45956L5.3703 7.25592C6.08626 6.53996 7.24707 6.53996 7.96303 7.25592ZM9.33333 6C9.70152 6 10 5.70152 10 5.33333C10 4.96514 9.70152 4.66667 9.33333 4.66667C8.96514 4.66667 8.66667 4.96514 8.66667 5.33333C8.66667 5.70152 8.96514 6 9.33333 6Z"
    fill="#77757D"
  />
</svg> `,Zne=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.1665 4.00008C2.1665 2.98756 2.98732 2.16675 3.99984 2.16675H11.9998C13.0124 2.16675 13.8332 2.98756 13.8332 4.00008V7.33341C13.8332 7.60956 13.6093 7.83341 13.3332 7.83341C13.057 7.83341 12.8332 7.60956 12.8332 7.33341V4.00008C12.8332 3.53984 12.4601 3.16675 11.9998 3.16675H3.99984C3.5396 3.16675 3.1665 3.53984 3.1665 4.00008V9.45964L5.37014 7.256C6.0861 6.54004 7.2469 6.54004 7.96287 7.256L8.35339 7.64653C8.54865 7.84179 8.54865 8.15837 8.35339 8.35363C8.15813 8.5489 7.84155 8.5489 7.64628 8.35363L7.25576 7.96311C6.93032 7.63767 6.40268 7.63767 6.07725 7.96311L3.1665 10.8739V12.0001C3.1665 12.4603 3.5396 12.8334 3.99984 12.8334H7.33317C7.60931 12.8334 7.83317 13.0573 7.83317 13.3334C7.83317 13.6096 7.60931 13.8334 7.33317 13.8334H3.99984C2.98732 13.8334 2.1665 13.0126 2.1665 12.0001V4.00008Z"
    fill="#77757D"
    fill-opacity="0.6"
  />
  <path
    d="M9.99984 5.33341C9.99984 5.7016 9.70136 6.00008 9.33317 6.00008C8.96498 6.00008 8.6665 5.7016 8.6665 5.33341C8.6665 4.96522 8.96498 4.66675 9.33317 4.66675C9.70136 4.66675 9.99984 4.96522 9.99984 5.33341Z"
    fill="#77757D"
    fill-opacity="0.6"
  />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M8.97962 8.97986C9.17488 8.7846 9.49146 8.7846 9.68672 8.97986L11.3332 10.6263L12.9796 8.97986C13.1749 8.7846 13.4915 8.7846 13.6867 8.97986C13.882 9.17512 13.882 9.49171 13.6867 9.68697L12.0403 11.3334L13.6867 12.9799C13.882 13.1751 13.882 13.4917 13.6867 13.687C13.4915 13.8822 13.1749 13.8822 12.9796 13.687L11.3332 12.0405L9.68672 13.687C9.49146 13.8822 9.17488 13.8822 8.97962 13.687C8.78435 13.4917 8.78435 13.1751 8.97962 12.9799L10.6261 11.3334L8.97962 9.68697C8.78435 9.49171 8.78435 9.17512 8.97962 8.97986Z"
    fill="#77757D"
    fill-opacity="0.6"
  />
</svg> `;var Wne=Object.defineProperty,qne=Object.getOwnPropertyDescriptor,M0=(t,e,n,i)=>{for(var r=i>1?void 0:i?qne(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Wne(e,n,r),r};const Yne="affine-image-block-card",QM=220,JM=122,Xne=78;var ls=(t=>(t[t.Ready=0]="Ready",t[t.Loading=1]="Loading",t[t.Failed=2]="Failed",t))(ls||{});let sc=class extends De{constructor(){super(...arguments),this.isInSurface=!1,this.imageState=0,this.imageName=null,this.imageSize=-1}render(){const t=this.isInSurface?`${QM}px`:"100%",e=this.isInSurface?`${JM}px`:`${Xne}px`,n=this.imageState===1?jne:this.imageState===2?Zne:Gne,i=this.imageState===1?"Loading image...":this.imageState===2?"Image loading failed.":this.imageName??"Image",r=!isNaN(this.imageSize)&&this.imageSize>0?Gl(this.imageSize,!0,0):null;return b`
      <div
        class="affine-image-block-card"
        style="width:${t};height:${e};"
      >
        <div class="affine-image-block-card-content">
          ${n}
          <span class="affine-image-block-card-title">${i}</span>
        </div>
        <div class="affine-image-card-size">${r}</div>
      </div>
    `}};sc.styles=X`
    .affine-image-block-card {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background-color: var(--affine-background-secondary-color, #f4f4f5);
      border-radius: 8px;
      border: 1px solid var(--affine-background-tertiary-color, #eee);
      padding: 12px;
      margin-top: 12px;
    }

    .affine-image-block-card-content {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--affine-placeholder-color);
      text-align: justify;
      font-family: var(--affine-font-family);
      font-size: var(--affine-font-sm);
      font-style: normal;
      font-weight: 600;
      line-height: var(--affine-line-height);
      user-select: none;
    }

    .affine-image-card-size {
      overflow: hidden;
      padding-top: 12px;
      color: var(--affine-text-secondary-color);
      text-overflow: ellipsis;
      font-size: 10px;
      font-style: normal;
      font-weight: 400;
      line-height: 20px;
      user-select: none;
    }
  `;M0([L({type:Boolean})],sc.prototype,"isInSurface",2);M0([L({type:Number})],sc.prototype,"imageState",2);M0([L()],sc.prototype,"imageName",2);M0([L({type:Number})],sc.prototype,"imageSize",2);sc=M0([W(Yne)],sc);class ps{constructor(e,n){this._onDragOver=i=>{if(i.preventDefault(),(i.dataTransfer?.effectAllowed??"none")!=="all")return;const{clientX:o,clientY:s}=i,a=new je(o,s),l=Fg(a.clone());let c=null;if(l){const d=Zl(l);c=Zk(a,d,l)}c?(ps._dropResult=c,this._indicator.rect=c.rect):(ps._dropResult=null,this._indicator.rect=null)},this.onDragOver=Vd(this._onDragOver,1e3/60),this._onDrop=i=>{const{onDrop:r}=this._fileDropOptions;if(!r||(i.preventDefault(),(i.dataTransfer?.effectAllowed??"none")!=="all"))return;const s=i.dataTransfer?.files;if(!s||!s.length)return;const a=this.targetModel,l=this.type,{clientX:c,clientY:d}=i,u=new je(c,d);r({files:[...s],targetModel:a,place:l,point:u})?.catch(console.error),this._indicator.rect=null},this._blockService=e,this._fileDropOptions=n,this._indicator=document.querySelector("affine-drag-indicator"),this._indicator||(this._indicator=document.createElement("affine-drag-indicator"),document.body.appendChild(this._indicator)),n.onDrop&&this._blockService.disposables.addFromEvent(this._blockService.std.host,"drop",this._onDrop)}static{this._dropResult=null}get editorHost(){return this._blockService.std.host}get type(){return!ps._dropResult||ps._dropResult.type!=="before"?"after":"before"}get targetModel(){const e=this._blockService.page.root;D(e);let n=ps._dropResult?.modelState.model||null;if(!n&&en(this.editorHost)){const i=e.children[e.children.length-1];if(!Ie(i,["affine:note"]))throw new Error("The last block is not a note block.");n=i.lastItem()}return n}}const Kne=ge.object({path:ge.array(ge.string())});class d5 extends ck{static{this.type="image"}static{this.group="note"}equals(e){return e instanceof d5?gt.equals(this.path,e.path):!1}toJSON(){return{type:this.type,path:this.path}}static fromJSON(e){return Kne.parse(e),new d5({path:e.path})}}var eP={},F3={};F3.byteLength=eie;F3.toByteArray=nie;F3.fromByteArray=oie;var bo=[],pr=[],Qne=typeof Uint8Array<"u"?Uint8Array:Array,R6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i1=0,Jne=R6.length;i1<Jne;++i1)bo[i1]=R6[i1],pr[R6.charCodeAt(i1)]=i1;pr[45]=62;pr[95]=63;function tP(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var i=n===e?0:4-n%4;return[n,i]}function eie(t){var e=tP(t),n=e[0],i=e[1];return(n+i)*3/4-i}function tie(t,e,n){return(e+n)*3/4-n}function nie(t){var e,n=tP(t),i=n[0],r=n[1],o=new Qne(tie(t,i,r)),s=0,a=r>0?i-4:i,l;for(l=0;l<a;l+=4)e=pr[t.charCodeAt(l)]<<18|pr[t.charCodeAt(l+1)]<<12|pr[t.charCodeAt(l+2)]<<6|pr[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return r===2&&(e=pr[t.charCodeAt(l)]<<2|pr[t.charCodeAt(l+1)]>>4,o[s++]=e&255),r===1&&(e=pr[t.charCodeAt(l)]<<10|pr[t.charCodeAt(l+1)]<<4|pr[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function iie(t){return bo[t>>18&63]+bo[t>>12&63]+bo[t>>6&63]+bo[t&63]}function rie(t,e,n){for(var i,r=[],o=e;o<n;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),r.push(iie(i));return r.join("")}function oie(t){for(var e,n=t.length,i=n%3,r=[],o=16383,s=0,a=n-i;s<a;s+=o)r.push(rie(t,s,s+o>a?a:s+o));return i===1?(e=t[n-1],r.push(bo[e>>2]+bo[e<<4&63]+"==")):i===2&&(e=(t[n-2]<<8)+t[n-1],r.push(bo[e>>10]+bo[e>>4&63]+bo[e<<2&63]+"=")),r.join("")}var Xb={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Xb.read=function(t,e,n,i,r){var o,s,a=r*8-i-1,l=(1<<a)-1,c=l>>1,d=-7,u=n?r-1:0,h=n?-1:1,p=t[e+u];for(u+=h,o=p&(1<<-d)-1,p>>=-d,d+=a;d>0;o=o*256+t[e+u],u+=h,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=i;d>0;s=s*256+t[e+u],u+=h,d-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-c}return(p?-1:1)*s*Math.pow(2,o-i)};Xb.write=function(t,e,n,i,r,o){var s,a,l,c=o*8-r-1,d=(1<<c)-1,u=d>>1,h=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,g=i?1:-1,f=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=d):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+u>=1?e+=h/l:e+=h*Math.pow(2,1-u),e*l>=2&&(s++,l/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(e*l-1)*Math.pow(2,r),s=s+u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=a&255,p+=g,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;t[n+p]=s&255,p+=g,s/=256,c-=8);t[n+p-g]|=f*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=F3,n=Xb,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const O=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(O,C),O.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(O){if(O>r)throw new RangeError('The value "'+O+'" is invalid for option "size"');const C=new Uint8Array(O);return Object.setPrototypeOf(C,a.prototype),C}function a(O,C,S){if(typeof O=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return u(O)}return l(O,C,S)}a.poolSize=8192;function l(O,C,S){if(typeof O=="string")return h(O,C);if(ArrayBuffer.isView(O))return g(O);if(O==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O);if(oe(O,ArrayBuffer)||O&&oe(O.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(oe(O,SharedArrayBuffer)||O&&oe(O.buffer,SharedArrayBuffer)))return f(O,C,S);if(typeof O=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const V=O.valueOf&&O.valueOf();if(V!=null&&V!==O)return a.from(V,C,S);const J=v(O);if(J)return J;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof O[Symbol.toPrimitive]=="function")return a.from(O[Symbol.toPrimitive]("string"),C,S);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O)}a.from=function(O,C,S){return l(O,C,S)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(O){if(typeof O!="number")throw new TypeError('"size" argument must be of type number');if(O<0)throw new RangeError('The value "'+O+'" is invalid for option "size"')}function d(O,C,S){return c(O),O<=0?s(O):C!==void 0?typeof S=="string"?s(O).fill(C,S):s(O).fill(C):s(O)}a.alloc=function(O,C,S){return d(O,C,S)};function u(O){return c(O),s(O<0?0:m(O)|0)}a.allocUnsafe=function(O){return u(O)},a.allocUnsafeSlow=function(O){return u(O)};function h(O,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);const S=x(O,C)|0;let V=s(S);const J=V.write(O,C);return J!==S&&(V=V.slice(0,J)),V}function p(O){const C=O.length<0?0:m(O.length)|0,S=s(C);for(let V=0;V<C;V+=1)S[V]=O[V]&255;return S}function g(O){if(oe(O,Uint8Array)){const C=new Uint8Array(O);return f(C.buffer,C.byteOffset,C.byteLength)}return p(O)}function f(O,C,S){if(C<0||O.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(O.byteLength<C+(S||0))throw new RangeError('"length" is outside of buffer bounds');let V;return C===void 0&&S===void 0?V=new Uint8Array(O):S===void 0?V=new Uint8Array(O,C):V=new Uint8Array(O,C,S),Object.setPrototypeOf(V,a.prototype),V}function v(O){if(a.isBuffer(O)){const C=m(O.length)|0,S=s(C);return S.length===0||O.copy(S,0,0,C),S}if(O.length!==void 0)return typeof O.length!="number"||se(O.length)?s(0):p(O);if(O.type==="Buffer"&&Array.isArray(O.data))return p(O.data)}function m(O){if(O>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return O|0}function y(O){return+O!=O&&(O=0),a.alloc(+O)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,S){if(oe(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),oe(S,Uint8Array)&&(S=a.from(S,S.offset,S.byteLength)),!a.isBuffer(C)||!a.isBuffer(S))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===S)return 0;let V=C.length,J=S.length;for(let de=0,ve=Math.min(V,J);de<ve;++de)if(C[de]!==S[de]){V=C[de],J=S[de];break}return V<J?-1:J<V?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,S){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);let V;if(S===void 0)for(S=0,V=0;V<C.length;++V)S+=C[V].length;const J=a.allocUnsafe(S);let de=0;for(V=0;V<C.length;++V){let ve=C[V];if(oe(ve,Uint8Array))de+ve.length>J.length?(a.isBuffer(ve)||(ve=a.from(ve)),ve.copy(J,de)):Uint8Array.prototype.set.call(J,ve,de);else if(a.isBuffer(ve))ve.copy(J,de);else throw new TypeError('"list" argument must be an Array of Buffers');de+=ve.length}return J};function x(O,C){if(a.isBuffer(O))return O.length;if(ArrayBuffer.isView(O)||oe(O,ArrayBuffer))return O.byteLength;if(typeof O!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof O);const S=O.length,V=arguments.length>2&&arguments[2]===!0;if(!V&&S===0)return 0;let J=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":return G(O).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S*2;case"hex":return S>>>1;case"base64":return Ce(O).length;default:if(J)return V?-1:G(O).length;C=(""+C).toLowerCase(),J=!0}}a.byteLength=x;function T(O,C,S){let V=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((S===void 0||S>this.length)&&(S=this.length),S<=0)||(S>>>=0,C>>>=0,S<=C))return"";for(O||(O="utf8");;)switch(O){case"hex":return ue(this,C,S);case"utf8":case"utf-8":return P(this,C,S);case"ascii":return Q(this,C,S);case"latin1":case"binary":return Le(this,C,S);case"base64":return N(this,C,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,C,S);default:if(V)throw new TypeError("Unknown encoding: "+O);O=(O+"").toLowerCase(),V=!0}}a.prototype._isBuffer=!0;function M(O,C,S){const V=O[C];O[C]=O[S],O[S]=V}a.prototype.swap16=function(){const C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let S=0;S<C;S+=2)M(this,S,S+1);return this},a.prototype.swap32=function(){const C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let S=0;S<C;S+=4)M(this,S,S+3),M(this,S+1,S+2);return this},a.prototype.swap64=function(){const C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let S=0;S<C;S+=8)M(this,S,S+7),M(this,S+1,S+6),M(this,S+2,S+5),M(this,S+3,S+4);return this},a.prototype.toString=function(){const C=this.length;return C===0?"":arguments.length===0?P(this,0,C):T.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){let C="";const S=t.INSPECT_MAX_BYTES;return C=this.toString("hex",0,S).replace(/(.{2})/g,"$1 ").trim(),this.length>S&&(C+=" ... "),"<Buffer "+C+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(C,S,V,J,de){if(oe(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(S===void 0&&(S=0),V===void 0&&(V=C?C.length:0),J===void 0&&(J=0),de===void 0&&(de=this.length),S<0||V>C.length||J<0||de>this.length)throw new RangeError("out of range index");if(J>=de&&S>=V)return 0;if(J>=de)return-1;if(S>=V)return 1;if(S>>>=0,V>>>=0,J>>>=0,de>>>=0,this===C)return 0;let ve=de-J,Ye=V-S;const ot=Math.min(ve,Ye),rt=this.slice(J,de),ft=C.slice(S,V);for(let Lt=0;Lt<ot;++Lt)if(rt[Lt]!==ft[Lt]){ve=rt[Lt],Ye=ft[Lt];break}return ve<Ye?-1:Ye<ve?1:0};function k(O,C,S,V,J){if(O.length===0)return-1;if(typeof S=="string"?(V=S,S=0):S>2147483647?S=2147483647:S<-2147483648&&(S=-2147483648),S=+S,se(S)&&(S=J?0:O.length-1),S<0&&(S=O.length+S),S>=O.length){if(J)return-1;S=O.length-1}else if(S<0)if(J)S=0;else return-1;if(typeof C=="string"&&(C=a.from(C,V)),a.isBuffer(C))return C.length===0?-1:_(O,C,S,V,J);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?J?Uint8Array.prototype.indexOf.call(O,C,S):Uint8Array.prototype.lastIndexOf.call(O,C,S):_(O,[C],S,V,J);throw new TypeError("val must be string, number or Buffer")}function _(O,C,S,V,J){let de=1,ve=O.length,Ye=C.length;if(V!==void 0&&(V=String(V).toLowerCase(),V==="ucs2"||V==="ucs-2"||V==="utf16le"||V==="utf-16le")){if(O.length<2||C.length<2)return-1;de=2,ve/=2,Ye/=2,S/=2}function ot(ft,Lt){return de===1?ft[Lt]:ft.readUInt16BE(Lt*de)}let rt;if(J){let ft=-1;for(rt=S;rt<ve;rt++)if(ot(O,rt)===ot(C,ft===-1?0:rt-ft)){if(ft===-1&&(ft=rt),rt-ft+1===Ye)return ft*de}else ft!==-1&&(rt-=rt-ft),ft=-1}else for(S+Ye>ve&&(S=ve-Ye),rt=S;rt>=0;rt--){let ft=!0;for(let Lt=0;Lt<Ye;Lt++)if(ot(O,rt+Lt)!==ot(C,Lt)){ft=!1;break}if(ft)return rt}return-1}a.prototype.includes=function(C,S,V){return this.indexOf(C,S,V)!==-1},a.prototype.indexOf=function(C,S,V){return k(this,C,S,V,!0)},a.prototype.lastIndexOf=function(C,S,V){return k(this,C,S,V,!1)};function A(O,C,S,V){S=Number(S)||0;const J=O.length-S;V?(V=Number(V),V>J&&(V=J)):V=J;const de=C.length;V>de/2&&(V=de/2);let ve;for(ve=0;ve<V;++ve){const Ye=parseInt(C.substr(ve*2,2),16);if(se(Ye))return ve;O[S+ve]=Ye}return ve}function $(O,C,S,V){return Se(G(C,O.length-S),O,S,V)}function E(O,C,S,V){return Se(j(C),O,S,V)}function R(O,C,S,V){return Se(Ce(C),O,S,V)}function I(O,C,S,V){return Se(re(C,O.length-S),O,S,V)}a.prototype.write=function(C,S,V,J){if(S===void 0)J="utf8",V=this.length,S=0;else if(V===void 0&&typeof S=="string")J=S,V=this.length,S=0;else if(isFinite(S))S=S>>>0,isFinite(V)?(V=V>>>0,J===void 0&&(J="utf8")):(J=V,V=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const de=this.length-S;if((V===void 0||V>de)&&(V=de),C.length>0&&(V<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");let ve=!1;for(;;)switch(J){case"hex":return A(this,C,S,V);case"utf8":case"utf-8":return $(this,C,S,V);case"ascii":case"latin1":case"binary":return E(this,C,S,V);case"base64":return R(this,C,S,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,C,S,V);default:if(ve)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase(),ve=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(O,C,S){return C===0&&S===O.length?e.fromByteArray(O):e.fromByteArray(O.slice(C,S))}function P(O,C,S){S=Math.min(O.length,S);const V=[];let J=C;for(;J<S;){const de=O[J];let ve=null,Ye=de>239?4:de>223?3:de>191?2:1;if(J+Ye<=S){let ot,rt,ft,Lt;switch(Ye){case 1:de<128&&(ve=de);break;case 2:ot=O[J+1],(ot&192)===128&&(Lt=(de&31)<<6|ot&63,Lt>127&&(ve=Lt));break;case 3:ot=O[J+1],rt=O[J+2],(ot&192)===128&&(rt&192)===128&&(Lt=(de&15)<<12|(ot&63)<<6|rt&63,Lt>2047&&(Lt<55296||Lt>57343)&&(ve=Lt));break;case 4:ot=O[J+1],rt=O[J+2],ft=O[J+3],(ot&192)===128&&(rt&192)===128&&(ft&192)===128&&(Lt=(de&15)<<18|(ot&63)<<12|(rt&63)<<6|ft&63,Lt>65535&&Lt<1114112&&(ve=Lt))}}ve===null?(ve=65533,Ye=1):ve>65535&&(ve-=65536,V.push(ve>>>10&1023|55296),ve=56320|ve&1023),V.push(ve),J+=Ye}return pe(V)}const Z=4096;function pe(O){const C=O.length;if(C<=Z)return String.fromCharCode.apply(String,O);let S="",V=0;for(;V<C;)S+=String.fromCharCode.apply(String,O.slice(V,V+=Z));return S}function Q(O,C,S){let V="";S=Math.min(O.length,S);for(let J=C;J<S;++J)V+=String.fromCharCode(O[J]&127);return V}function Le(O,C,S){let V="";S=Math.min(O.length,S);for(let J=C;J<S;++J)V+=String.fromCharCode(O[J]);return V}function ue(O,C,S){const V=O.length;(!C||C<0)&&(C=0),(!S||S<0||S>V)&&(S=V);let J="";for(let de=C;de<S;++de)J+=Te[O[de]];return J}function H(O,C,S){const V=O.slice(C,S);let J="";for(let de=0;de<V.length-1;de+=2)J+=String.fromCharCode(V[de]+V[de+1]*256);return J}a.prototype.slice=function(C,S){const V=this.length;C=~~C,S=S===void 0?V:~~S,C<0?(C+=V,C<0&&(C=0)):C>V&&(C=V),S<0?(S+=V,S<0&&(S=0)):S>V&&(S=V),S<C&&(S=C);const J=this.subarray(C,S);return Object.setPrototypeOf(J,a.prototype),J};function ee(O,C,S){if(O%1!==0||O<0)throw new RangeError("offset is not uint");if(O+C>S)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,S,V){C=C>>>0,S=S>>>0,V||ee(C,S,this.length);let J=this[C],de=1,ve=0;for(;++ve<S&&(de*=256);)J+=this[C+ve]*de;return J},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,S,V){C=C>>>0,S=S>>>0,V||ee(C,S,this.length);let J=this[C+--S],de=1;for(;S>0&&(de*=256);)J+=this[C+--S]*de;return J},a.prototype.readUint8=a.prototype.readUInt8=function(C,S){return C=C>>>0,S||ee(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,S){return C=C>>>0,S||ee(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,S){return C=C>>>0,S||ee(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readBigUInt64LE=Y(function(C){C=C>>>0,et(C,"offset");const S=this[C],V=this[C+7];(S===void 0||V===void 0)&&B(C,this.length-8);const J=S+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24,de=this[++C]+this[++C]*2**8+this[++C]*2**16+V*2**24;return BigInt(J)+(BigInt(de)<<BigInt(32))}),a.prototype.readBigUInt64BE=Y(function(C){C=C>>>0,et(C,"offset");const S=this[C],V=this[C+7];(S===void 0||V===void 0)&&B(C,this.length-8);const J=S*2**24+this[++C]*2**16+this[++C]*2**8+this[++C],de=this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+V;return(BigInt(J)<<BigInt(32))+BigInt(de)}),a.prototype.readIntLE=function(C,S,V){C=C>>>0,S=S>>>0,V||ee(C,S,this.length);let J=this[C],de=1,ve=0;for(;++ve<S&&(de*=256);)J+=this[C+ve]*de;return de*=128,J>=de&&(J-=Math.pow(2,8*S)),J},a.prototype.readIntBE=function(C,S,V){C=C>>>0,S=S>>>0,V||ee(C,S,this.length);let J=S,de=1,ve=this[C+--J];for(;J>0&&(de*=256);)ve+=this[C+--J]*de;return de*=128,ve>=de&&(ve-=Math.pow(2,8*S)),ve},a.prototype.readInt8=function(C,S){return C=C>>>0,S||ee(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,S){C=C>>>0,S||ee(C,2,this.length);const V=this[C]|this[C+1]<<8;return V&32768?V|4294901760:V},a.prototype.readInt16BE=function(C,S){C=C>>>0,S||ee(C,2,this.length);const V=this[C+1]|this[C]<<8;return V&32768?V|4294901760:V},a.prototype.readInt32LE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readBigInt64LE=Y(function(C){C=C>>>0,et(C,"offset");const S=this[C],V=this[C+7];(S===void 0||V===void 0)&&B(C,this.length-8);const J=this[C+4]+this[C+5]*2**8+this[C+6]*2**16+(V<<24);return(BigInt(J)<<BigInt(32))+BigInt(S+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24)}),a.prototype.readBigInt64BE=Y(function(C){C=C>>>0,et(C,"offset");const S=this[C],V=this[C+7];(S===void 0||V===void 0)&&B(C,this.length-8);const J=(S<<24)+this[++C]*2**16+this[++C]*2**8+this[++C];return(BigInt(J)<<BigInt(32))+BigInt(this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+V)}),a.prototype.readFloatLE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),n.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,S){return C=C>>>0,S||ee(C,4,this.length),n.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,S){return C=C>>>0,S||ee(C,8,this.length),n.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,S){return C=C>>>0,S||ee(C,8,this.length),n.read(this,C,!1,52,8)};function K(O,C,S,V,J,de){if(!a.isBuffer(O))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>J||C<de)throw new RangeError('"value" argument is out of bounds');if(S+V>O.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,S,V,J){if(C=+C,S=S>>>0,V=V>>>0,!J){const Ye=Math.pow(2,8*V)-1;K(this,C,S,V,Ye,0)}let de=1,ve=0;for(this[S]=C&255;++ve<V&&(de*=256);)this[S+ve]=C/de&255;return S+V},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,S,V,J){if(C=+C,S=S>>>0,V=V>>>0,!J){const Ye=Math.pow(2,8*V)-1;K(this,C,S,V,Ye,0)}let de=V-1,ve=1;for(this[S+de]=C&255;--de>=0&&(ve*=256);)this[S+de]=C/ve&255;return S+V},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,1,255,0),this[S]=C&255,S+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,2,65535,0),this[S]=C&255,this[S+1]=C>>>8,S+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,2,65535,0),this[S]=C>>>8,this[S+1]=C&255,S+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,4,4294967295,0),this[S+3]=C>>>24,this[S+2]=C>>>16,this[S+1]=C>>>8,this[S]=C&255,S+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,4,4294967295,0),this[S]=C>>>24,this[S+1]=C>>>16,this[S+2]=C>>>8,this[S+3]=C&255,S+4};function U(O,C,S,V,J){lt(C,V,J,O,S,7);let de=Number(C&BigInt(4294967295));O[S++]=de,de=de>>8,O[S++]=de,de=de>>8,O[S++]=de,de=de>>8,O[S++]=de;let ve=Number(C>>BigInt(32)&BigInt(4294967295));return O[S++]=ve,ve=ve>>8,O[S++]=ve,ve=ve>>8,O[S++]=ve,ve=ve>>8,O[S++]=ve,S}function Ee(O,C,S,V,J){lt(C,V,J,O,S,7);let de=Number(C&BigInt(4294967295));O[S+7]=de,de=de>>8,O[S+6]=de,de=de>>8,O[S+5]=de,de=de>>8,O[S+4]=de;let ve=Number(C>>BigInt(32)&BigInt(4294967295));return O[S+3]=ve,ve=ve>>8,O[S+2]=ve,ve=ve>>8,O[S+1]=ve,ve=ve>>8,O[S]=ve,S+8}a.prototype.writeBigUInt64LE=Y(function(C,S=0){return U(this,C,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Y(function(C,S=0){return Ee(this,C,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(C,S,V,J){if(C=+C,S=S>>>0,!J){const ot=Math.pow(2,8*V-1);K(this,C,S,V,ot-1,-ot)}let de=0,ve=1,Ye=0;for(this[S]=C&255;++de<V&&(ve*=256);)C<0&&Ye===0&&this[S+de-1]!==0&&(Ye=1),this[S+de]=(C/ve>>0)-Ye&255;return S+V},a.prototype.writeIntBE=function(C,S,V,J){if(C=+C,S=S>>>0,!J){const ot=Math.pow(2,8*V-1);K(this,C,S,V,ot-1,-ot)}let de=V-1,ve=1,Ye=0;for(this[S+de]=C&255;--de>=0&&(ve*=256);)C<0&&Ye===0&&this[S+de+1]!==0&&(Ye=1),this[S+de]=(C/ve>>0)-Ye&255;return S+V},a.prototype.writeInt8=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,1,127,-128),C<0&&(C=255+C+1),this[S]=C&255,S+1},a.prototype.writeInt16LE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,2,32767,-32768),this[S]=C&255,this[S+1]=C>>>8,S+2},a.prototype.writeInt16BE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,2,32767,-32768),this[S]=C>>>8,this[S+1]=C&255,S+2},a.prototype.writeInt32LE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,4,2147483647,-2147483648),this[S]=C&255,this[S+1]=C>>>8,this[S+2]=C>>>16,this[S+3]=C>>>24,S+4},a.prototype.writeInt32BE=function(C,S,V){return C=+C,S=S>>>0,V||K(this,C,S,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[S]=C>>>24,this[S+1]=C>>>16,this[S+2]=C>>>8,this[S+3]=C&255,S+4},a.prototype.writeBigInt64LE=Y(function(C,S=0){return U(this,C,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Y(function(C,S=0){return Ee(this,C,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function xe(O,C,S,V,J,de){if(S+V>O.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("Index out of range")}function Pe(O,C,S,V,J){return C=+C,S=S>>>0,J||xe(O,C,S,4),n.write(O,C,S,V,23,4),S+4}a.prototype.writeFloatLE=function(C,S,V){return Pe(this,C,S,!0,V)},a.prototype.writeFloatBE=function(C,S,V){return Pe(this,C,S,!1,V)};function ze(O,C,S,V,J){return C=+C,S=S>>>0,J||xe(O,C,S,8),n.write(O,C,S,V,52,8),S+8}a.prototype.writeDoubleLE=function(C,S,V){return ze(this,C,S,!0,V)},a.prototype.writeDoubleBE=function(C,S,V){return ze(this,C,S,!1,V)},a.prototype.copy=function(C,S,V,J){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(V||(V=0),!J&&J!==0&&(J=this.length),S>=C.length&&(S=C.length),S||(S=0),J>0&&J<V&&(J=V),J===V||C.length===0||this.length===0)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(V<0||V>=this.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length),C.length-S<J-V&&(J=C.length-S+V);const de=J-V;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(S,V,J):Uint8Array.prototype.set.call(C,this.subarray(V,J),S),de},a.prototype.fill=function(C,S,V,J){if(typeof C=="string"){if(typeof S=="string"?(J=S,S=0,V=this.length):typeof V=="string"&&(J=V,V=this.length),J!==void 0&&typeof J!="string")throw new TypeError("encoding must be a string");if(typeof J=="string"&&!a.isEncoding(J))throw new TypeError("Unknown encoding: "+J);if(C.length===1){const ve=C.charCodeAt(0);(J==="utf8"&&ve<128||J==="latin1")&&(C=ve)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(S<0||this.length<S||this.length<V)throw new RangeError("Out of range index");if(V<=S)return this;S=S>>>0,V=V===void 0?this.length:V>>>0,C||(C=0);let de;if(typeof C=="number")for(de=S;de<V;++de)this[de]=C;else{const ve=a.isBuffer(C)?C:a.from(C,J),Ye=ve.length;if(Ye===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(de=0;de<V-S;++de)this[de+S]=ve[de%Ye]}return this};const le={};function He(O,C,S){le[O]=class extends S{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${O}]`,this.stack,delete this.name}get code(){return O}set code(J){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:J,writable:!0})}toString(){return`${this.name} [${O}]: ${this.message}`}}}He("ERR_BUFFER_OUT_OF_BOUNDS",function(O){return O?`${O} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),He("ERR_INVALID_ARG_TYPE",function(O,C){return`The "${O}" argument must be of type number. Received type ${typeof C}`},TypeError),He("ERR_OUT_OF_RANGE",function(O,C,S){let V=`The value of "${O}" is out of range.`,J=S;return Number.isInteger(S)&&Math.abs(S)>2**32?J=Ne(String(S)):typeof S=="bigint"&&(J=String(S),(S>BigInt(2)**BigInt(32)||S<-(BigInt(2)**BigInt(32)))&&(J=Ne(J)),J+="n"),V+=` It must be ${C}. Received ${J}`,V},RangeError);function Ne(O){let C="",S=O.length;const V=O[0]==="-"?1:0;for(;S>=V+4;S-=3)C=`_${O.slice(S-3,S)}${C}`;return`${O.slice(0,S)}${C}`}function Ue(O,C,S){et(C,"offset"),(O[C]===void 0||O[C+S]===void 0)&&B(C,O.length-(S+1))}function lt(O,C,S,V,J,de){if(O>S||O<C){const ve=typeof C=="bigint"?"n":"";let Ye;throw de>3?C===0||C===BigInt(0)?Ye=`>= 0${ve} and < 2${ve} ** ${(de+1)*8}${ve}`:Ye=`>= -(2${ve} ** ${(de+1)*8-1}${ve}) and < 2 ** ${(de+1)*8-1}${ve}`:Ye=`>= ${C}${ve} and <= ${S}${ve}`,new le.ERR_OUT_OF_RANGE("value",Ye,O)}Ue(V,J,de)}function et(O,C){if(typeof O!="number")throw new le.ERR_INVALID_ARG_TYPE(C,"number",O)}function B(O,C,S){throw Math.floor(O)!==O?(et(O,S),new le.ERR_OUT_OF_RANGE(S||"offset","an integer",O)):C<0?new le.ERR_BUFFER_OUT_OF_BOUNDS:new le.ERR_OUT_OF_RANGE(S||"offset",`>= ${S?1:0} and <= ${C}`,O)}const _e=/[^+/0-9A-Za-z-_]/g;function fe(O){if(O=O.split("=")[0],O=O.trim().replace(_e,""),O.length<2)return"";for(;O.length%4!==0;)O=O+"=";return O}function G(O,C){C=C||1/0;let S;const V=O.length;let J=null;const de=[];for(let ve=0;ve<V;++ve){if(S=O.charCodeAt(ve),S>55295&&S<57344){if(!J){if(S>56319){(C-=3)>-1&&de.push(239,191,189);continue}else if(ve+1===V){(C-=3)>-1&&de.push(239,191,189);continue}J=S;continue}if(S<56320){(C-=3)>-1&&de.push(239,191,189),J=S;continue}S=(J-55296<<10|S-56320)+65536}else J&&(C-=3)>-1&&de.push(239,191,189);if(J=null,S<128){if((C-=1)<0)break;de.push(S)}else if(S<2048){if((C-=2)<0)break;de.push(S>>6|192,S&63|128)}else if(S<65536){if((C-=3)<0)break;de.push(S>>12|224,S>>6&63|128,S&63|128)}else if(S<1114112){if((C-=4)<0)break;de.push(S>>18|240,S>>12&63|128,S>>6&63|128,S&63|128)}else throw new Error("Invalid code point")}return de}function j(O){const C=[];for(let S=0;S<O.length;++S)C.push(O.charCodeAt(S)&255);return C}function re(O,C){let S,V,J;const de=[];for(let ve=0;ve<O.length&&!((C-=2)<0);++ve)S=O.charCodeAt(ve),V=S>>8,J=S%256,de.push(J),de.push(V);return de}function Ce(O){return e.toByteArray(fe(O))}function Se(O,C,S,V){let J;for(J=0;J<V&&!(J+S>=C.length||J>=O.length);++J)C[J+S]=O[J];return J}function oe(O,C){return O instanceof C||O!=null&&O.constructor!=null&&O.constructor.name!=null&&O.constructor.name===C.name}function se(O){return O!==O}const Te=function(){const O="0123456789abcdef",C=new Array(256);for(let S=0;S<16;++S){const V=S*16;for(let J=0;J<16;++J)C[V+J]=O[S]+O[J]}return C}();function Y(O){return typeof BigInt>"u"?be:O}function be(){throw new Error("BigInt not supported")}})(eP);class sie extends ak{async toSnapshot(e){const n=await super.toSnapshot(e),i=e.model.sourceId;return i&&await e.assets.readFromBlob(i),n}async fromSnapshot(e){const n=await super.fromSnapshot(e),i=n.props.sourceId;return i&&await e.assets.writeToBlob(i),n}}const aie={caption:"",sourceId:"",width:0,height:0,index:"a0",xywh:"[0,0,0,0]",rotate:0,size:-1},I1=_i({flavour:"affine:image",props:()=>aie,metadata:{version:1,role:"content"},transformer:()=>new sie,toModel:()=>new Kb});class Kb extends C0(Bn){}async function nP(t){const e=await pie(t);if(!e)return null;if(!e.type){const n=await Jt(()=>import("./browser-lRWe77PM.js").then(o=>o.b),__vite__mapDeps([0,1]));window.Buffer===void 0&&(window.Buffer=eP.Buffer);const i=await e.arrayBuffer(),r=await n.fromBuffer(i);return r?.mime.match(/^image\/(gif|png|jpe?g)$/)?new Blob([i],{type:r.mime}):null}return e}function lie(t){return new Promise(e=>{const n=new FileReader;n.addEventListener("load",i=>e(n.result)),n.addEventListener("error",()=>e(null)),n.readAsDataURL(t)})}function cie(t){return new Promise(e=>{const n=new FileReader;n.addEventListener("load",i=>{const r=new Image;r.onload=()=>{const o=document.createElement("canvas");o.width=r.width,o.height=r.height;const s=o.getContext("2d");D(s),s.drawImage(r,0,0),o.toBlob(e,"image/png")},r.onerror=()=>e(null),r.src=n.result}),n.addEventListener("error",()=>e(null)),n.readAsDataURL(t)})}async function die(t,e){let n=await nP(e);if(n)try{if(window.apis?.clipboard?.copyAsImageFromString){const i=await lie(n);if(!i)throw new Error("Cant convert a blob to data URL.");await window.apis.clipboard?.copyAsImageFromString(i)}else{if(n.type!=="image/png"&&(n=await cie(n)),!n)return;await navigator.clipboard.write([new ClipboardItem({[n.type]:n})])}kt(t,"Copied image to clipboard")}catch(i){console.error(i)}}async function uie(t){const e=await nP(t);e&&jm(e,"image")}function hie(t,e){const n=t.view.viewFromPath("block",qn(e));D(n);const i=n.querySelector(".affine-embed-wrapper-caption");i.classList.add("caption-show"),i.focus()}async function pie(t){return D(t.sourceId),await t.page.blob.get(t.sourceId)}function fie(t,e){return!!(e&&e instanceof HTMLElement&&t.contains(e)&&e.classList.contains("resize"))}async function iP(t,e,n,i){if(P8(n))throw new Error("the image is already uploading!");N6(n,!0);const o=e.blob;let s="",a=null;try{if(a=e.getBlockById(n),!a)throw new Error("the attachment model is not found!");if(!(a instanceof Kb))throw console.error(a),new Error("the model is not an image model!");s=await o.set(i)}catch(l){console.error(l),N6(n,!1),l instanceof Error&&kt(t,`Failed to upload attachment! ${l.message||l.toString()}`)}return N6(n,!1),e.withoutTransact(()=>{a&&e.updateBlock(a,{sourceId:s})}),n}const M8=new Set;function N6(t,e){e?M8.add(t):M8.delete(t)}function P8(t){return M8.has(t)}function Qb(t,e,n,i,r="after"){const o=e.filter(d=>d.type.startsWith("image/"));if(o.some(d=>d.size>n))return kt(t,`You can only upload files less than ${Gl(n,!0,0)}`),[];const a=o.map(d=>({flavour:"affine:image",size:d.size})),l=i.page,c=l.addSiblingBlocks(i,a,r);return c.map((d,u)=>void iP(t,l,d,o[u])),c}function gie(t,e,n,i,r,o){const s=e.filter(c=>c.type.startsWith("image/"));if(s.some(c=>c.size>n))return kt(t,`You can only upload files less than ${Gl(n,!0,0)}`),[];const l=s.map(c=>i.addBlock("affine:image",{flavour:"affine:image",size:c.size},r,o));return l.map((c,d)=>void iP(t,i,c,s[d])),l}class hd extends li{constructor(){super(...arguments),this.maxFileSize=10*1e3*1e3,this._fileDropOptions={flavour:this.flavour,onDrop:async({files:e,targetModel:n,place:i,point:r})=>{const o=e.filter(s=>s.type.startsWith("image/"));return n&&!Ie(n,["affine:surface"])?Qb(this.std.host,o,this.maxFileSize,n,i):ms(this.std.host)&&await this.pageBlockComponent.addImages(o,r),!0}}}get pageBlockComponent(){const e=this.page.root;D(e);const n=this.std.view.viewFromPath("block",[e.id]);return D(n),n}mounted(){super.mounted(),this.selectionManager.register(d5),this.fileDropManager=new ps(this,this._fileDropOptions)}static{this.setImageProxyURL=rT}}var mie=Object.defineProperty,bie=Object.getOwnPropertyDescriptor,U3=(t,e,n,i)=>{for(var r=i>1?void 0:i?bie(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&mie(e,n,r),r};let Ba=class extends me(Ae){constructor(t){super(),this._hide=!1,this.layout="horizontal",this.setEdgelessTool=e=>{this.edgeless.tools.setEdgelessTool(e)},this.edgeless=t}_isVerticalBar(){return this.layout==="vertical"}get edgelessTool(){return this.edgeless.edgelessTool}get zoom(){return this.viewport.zoom}get viewport(){return this.edgeless.service.viewport}_setZoomByStep(t){this.viewport.smoothZoom(Es(this.zoom+t,_k,ND))}_zoomToFit(){const{centerX:t,centerY:e,zoom:n}=this.edgeless.getFitToScreenData();this.viewport.setViewport(n,[t,e],!0)}setZoomByAction(t){switch(t){case"fit":this._zoomToFit();break;case"reset":this.viewport.smoothZoom(1);break;case"in":case"out":this._setZoomByStep(t2*(t==="in"?1:-1))}}firstUpdated(){const{_disposables:t,edgeless:{slots:e}}=this;t.add(e.edgelessToolUpdated.on(n=>{n.type!=="frameNavigator"&&(this._hide=!1),this.requestUpdate()})),t.add(this.edgeless.service.viewport.viewportUpdated.on(()=>this.requestUpdate())),t.add(e.navigatorSettingUpdated.on(({hideToolbar:n})=>{n!==void 0&&(this._hide=n)}))}render(){const t=`${Math.round(this.zoom*100)}%`,e=`edgeless-zoom-toolbar-container ${this.layout}`;return this._hide?ae:b`
      <div
        class=${e}
        @dblclick=${at}
        @mousedown=${at}
        @mouseup=${at}
        @pointerdown=${at}
      >
        <edgeless-tool-icon-button
          .tooltip=${"Fit to screen"}
          .tipPosition=${this._isVerticalBar()?"right":"top-end"}
          .arrow=${!this._isVerticalBar()}
          @click=${()=>this._zoomToFit()}
        >
          ${vI}
        </edgeless-tool-icon-button>
        <edgeless-tool-icon-button
          .tooltip=${"Zoom out"}
          .tipPosition=${this._isVerticalBar()?"right":"top"}
          .arrow=${!this._isVerticalBar()}
          @click=${()=>this._setZoomByStep(-t2)}
        >
          ${bI}
        </edgeless-tool-icon-button>
        <span class="zoom-percent" @click=${()=>this.viewport.smoothZoom(1)}>
          ${t}
        </span>
        <edgeless-tool-icon-button
          .tooltip=${"Zoom in"}
          .tipPosition=${this._isVerticalBar()?"right":"top"}
          .arrow=${!this._isVerticalBar()}
          @click=${()=>this._setZoomByStep(t2)}
        >
          ${Sr}
        </edgeless-tool-icon-button>
      </div>
    `}};Ba.styles=X`
    :host {
      position: absolute;
      bottom: 20px;
      left: 12px;
      z-index: var(--affine-z-index-popover);
      display: flex;
      justify-content: center;
      user-select: none;
    }

    .edgeless-zoom-toolbar-container {
      display: flex;
      align-items: center;
      background: transparent;
      border-radius: 8px;
      fill: currentcolor;
    }

    .edgeless-zoom-toolbar-container.horizantal {
      flex-direction: row;
    }

    .edgeless-zoom-toolbar-container.vertical {
      flex-direction: column;
      width: 40px;
      background-color: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      border: 1px solid var(--affine-border-color);
      border-radius: 8px;
    }

    .edgeless-zoom-toolbar-container[level='second'] {
      position: absolute;
      bottom: 8px;
      transform: translateY(-100%);
    }

    .edgeless-zoom-toolbar-container[hidden] {
      display: none;
    }

    .zoom-percent {
      display: block;
      box-sizing: border-box;
      width: 48px;
      height: 32px;
      line-height: 22px;
      padding: 5px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      text-align: center;
      cursor: pointer;
      color: var(--affine-icon-color);
      font-family: ${Je(vt.fontSansFamily)};
    }

    .zoom-percent:hover {
      color: var(--affine-primary-color);
      background-color: var(--affine-hover-color);
    }
  `;U3([ie()],Ba.prototype,"_hide",2);U3([L({attribute:!1})],Ba.prototype,"layout",2);U3([L({attribute:!1})],Ba.prototype,"edgeless",2);Ba=U3([W("edgeless-zoom-toolbar")],Ba);var vie=Object.defineProperty,yie=Object.getOwnPropertyDescriptor,Jb=(t,e,n,i)=>{for(var r=i>1?void 0:i?yie(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&vie(e,n,r),r};function wie(t,e){const n=new Ba(e);return D(t.shadowRoot),n.layout="vertical",t.shadowRoot.appendChild(n),ii(t,n,{placement:"top"}).then(({x:i,y:r})=>{Object.assign(n.style,{left:`${i}px`,top:`${r-10}px`})}).catch(console.error),{element:n,dispose:()=>{n.remove()}}}let pd=class extends Ae{constructor(t){super(),this._showPopper=!1,this._zoomBar=null,this.edgeless=t}_closeZoomMenu(){this._zoomBar?.dispose(),this._zoomBar=null,this._showPopper=!1}_toggleNoteMenu(){this._zoomBar?this._closeZoomMenu():(this._zoomBar=wie(this,this.edgeless),this._zoomBar.element.edgeless=this.edgeless,this._zoomBar.element.edgeless=this.edgeless,this._showPopper=!0)}connectedCallback(){super.connectedCallback(),this.edgeless.handleEvent("click",()=>{this._zoomBar&&this._showPopper&&this._closeZoomMenu()})}disconnectedCallback(){this._zoomBar?.dispose(),this._zoomBar=null,this._showPopper=!1,super.disconnectedCallback()}render(){return b`
      <div class="toggle-button" @pointerdown=${at}>
        <edgeless-tool-icon-button
          class=${this._showPopper?"actived":"non-actived"}
          .tooltip=${"Toggle Zoom Tool Bar"}
          .tipPosition=${"right"}
          .active=${this._showPopper}
          .arrow=${!1}
          .activeMode=${"background"}
          @click=${()=>this._toggleNoteMenu()}
        >
          ${V9}
        </edgeless-tool-icon-button>
      </div>
    `}};pd.styles=X`
    :host {
      display: flex;
      position: absolute;
      bottom: 20px;
      left: 12px;
    }
    .toggle-button {
      display: flex;
      position: relative;
    }
    edgeless-zoom-toolbar {
      position: absolute;
      bottom: initial;
    }
  `;Jb([L({attribute:!1})],pd.prototype,"edgeless",2);Jb([ie()],pd.prototype,"_showPopper",2);pd=Jb([W("zoom-bar-toggle-button")],pd);class xie extends aT{constructor(e){super(e),this.pageElement=e,this.pageElement.bindHotKey({v:()=>{this._setEdgelessTool(e,{type:"default"})},t:()=>{this._setEdgelessTool(e,{type:"text"})},l:()=>{e.service.editSession.record("connector",{mode:jt.Straight}),this._setEdgelessTool(e,{type:"connector",mode:jt.Straight})},x:()=>{e.service.editSession.record("connector",{mode:jt.Orthogonal}),this._setEdgelessTool(e,{type:"connector",mode:jt.Orthogonal})},c:()=>{e.service.editSession.record("connector",{mode:jt.Curve}),this._setEdgelessTool(e,{type:"connector",mode:jt.Curve})},h:()=>{this._setEdgelessTool(e,{type:"pan",panning:!1})},n:()=>{this._setEdgelessTool(e,{type:"affine:note",childFlavour:QX,childType:JX,tip:eK})},p:()=>{this._setEdgelessTool(e,{type:"brush"})},e:()=>{this._setEdgelessTool(e,{type:"eraser"})},s:()=>{const n=e.service.editSession.getLastProps("shape");this._setEdgelessTool(e,{type:"shape",shapeType:n.shapeType})},f:()=>{this.pageElement.service.selection.elements.length!==0&&!this.pageElement.service.selection.editing?e.surface.frame.createFrameOnSelected():this.pageElement.service.selection.editing||this._setEdgelessTool(e,{type:"frame"})},"-":()=>{const{elements:n}=e.service.selection;!e.service.selection.editing&&n.length===1&&Gn(n[0])&&e.slots.toggleNoteSlicer.emit()},"Mod-g":n=>{this.pageElement.service.selection.elements.length>1&&!this.pageElement.service.selection.editing&&(n.get("keyboardState").event.preventDefault(),e.service.createGroupFromSelected())},"Shift-Mod-g":n=>{const{selection:i}=this.pageElement.service;i.elements.length===1&&i.firstElement instanceof On&&(n.get("keyboardState").event.preventDefault(),e.service.ungroup(i.firstElement))},"Mod-a":n=>{if(this.pageElement.service.selection.editing)return;n.get("defaultState").event.preventDefault();const{service:i}=this.pageElement;this.pageElement.service.selection.set({elements:[...i.blocks.filter(r=>r.group===null).map(r=>r.id),...i.elements.filter(r=>r.group===null).map(r=>r.id)],editing:!1})},"Mod-1":n=>{n.get("defaultState").event.preventDefault(),this.pageElement.slots.zoomUpdated.emit("fit")},"Mod--":n=>{n.get("defaultState").event.preventDefault(),this.pageElement.slots.zoomUpdated.emit("out")},"Mod-0":n=>{n.get("defaultState").event.preventDefault(),this.pageElement.slots.zoomUpdated.emit("reset")},"Mod-=":n=>{n.get("defaultState").event.preventDefault(),this.pageElement.slots.zoomUpdated.emit("in")},Backspace:()=>{this._delete()},Delete:()=>{this._delete()},"Control-d":()=>{Ag&&this._delete()},ArrowUp:()=>{this._move("ArrowUp")},ArrowDown:()=>{this._move("ArrowDown")},ArrowLeft:()=>{this._move("ArrowLeft")},ArrowRight:()=>{this._move("ArrowRight")},Escape:()=>{this.pageElement.service.selection.empty||e.selection.clear()}},{global:!0}),this.pageElement.handleEvent("keyDown",n=>{const i=n.get("defaultState").event;i instanceof KeyboardEvent&&this._shift(i)},{global:!0}),this.pageElement.handleEvent("keyUp",n=>{const i=n.get("defaultState").event;i instanceof KeyboardEvent&&this._shift(i)},{global:!0}),this._bindToggleHand()}_bindToggleHand(){this.pageElement.handleEvent("keyDown",e=>{const n=e.get("keyboardState").raw;n.code==="Space"&&this._space(n)},{global:!0}),this.pageElement.handleEvent("keyUp",e=>{const n=e.get("keyboardState").raw;n.code==="Space"&&this._space(n)},{global:!0})}_space(e){const n=this.pageElement,i=n.edgelessTool.type,r=n.service.selection;if(!(i!=="default"&&i!=="pan"))if(e.type==="keydown"){if(i==="pan"||i==="default"&&r.editing)return;this._setEdgelessTool(n,{type:"pan",panning:!1})}else e.type==="keyup"&&this._setEdgelessTool(n,{type:"default"})}_shift(e){const n=this.pageElement;e.key.toLowerCase()==="shift"&&e.shiftKey?n.slots.pressShiftKeyUpdated.emit(!0):n.slots.pressShiftKeyUpdated.emit(!1)}_delete(){const e=this.pageElement;e.service.selection.editing||(E0(e.surface,e.service.selection.elements),e.service.selection.clear(),e.service.selection.set(e.service.selection.selections))}_setEdgelessTool(e,n,i=!1){!i&&e.service.selection.editing||e.tools.setEdgelessTool(n)}_move(e){const n=this.pageElement;if(n.service.selection.editing)return;const{elements:i}=n.service.selection;i.forEach(r=>{const o=ne.deserialize(r.xywh).clone();switch(e){case"ArrowUp":o.y--;break;case"ArrowLeft":o.x--;break;case"ArrowRight":o.x++;break;case"ArrowDown":o.y++;break}_0(r)&&r instanceof Ft&&r.moveTo(o),r.xywh=o.serialize()})}}class _ie extends Ko{constructor(){super(...arguments),this.tool={type:"brush"},this._draggingElement=null,this._draggingElementId=null,this._draggingPathPoints=null,this._lastPoint=null,this._straightLineType=null}onContainerPointerDown(){}onContainerClick(){}onContainerContextMenu(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerDragStart(e){this._page.captureSync();const{viewport:n}=this._edgeless.service,[i,r]=n.toModelCoord(e.point.x,e.point.y),o=[[i,r]],s=this._service.addElement(kn.BRUSH,{points:o}),a=this._service.getElementById(s);a.stash("points"),a.stash("xywh"),this._lastPoint=[e.point.x,e.point.y],this._draggingElementId=s,this._draggingElement=a,this._draggingPathPoints=o}onContainerDragMove(e){if(!this._draggingElementId)return;D(this._draggingElementId),D(this._draggingPathPoints);let n=e.point.x,i=e.point.y;e.keys.shift||this._edgeless.tools.shiftKey?(this._straightLineType||(this._straightLineType=this._getStraightLineType([n,i])),this._straightLineType==="horizontal"?i=this._lastPoint?.[1]??i:this._straightLineType==="vertical"&&(n=this._lastPoint?.[0]??n)):this._straightLineType&&(this._straightLineType=null);const[o,s]=this._service.viewport.toModelCoord(n,i),a=[...this._draggingPathPoints,[o,s]];this._lastPoint=[n,i],this._draggingPathPoints=a,this._edgeless.service.updateElement(this._draggingElementId,{points:a})}onContainerDragEnd(){if(this._draggingElement){const{_draggingElement:e}=this;this._page.transact(()=>{e.pop("points"),e.pop("xywh")})}this._draggingElement=null,this._draggingElementId=null,this._draggingPathPoints=null,this._lastPoint=null,this._straightLineType=null,this._page.captureSync()}onContainerMouseMove(){}onContainerMouseOut(){}onPressShiftKey(e){}beforeModeSwitch(){}afterModeSwitch(){}_getStraightLineType(e){const n=this._lastPoint;if(!n)return null;const i=e[0]-n[0],r=e[1]-n[1],o=Math.abs(Math.atan2(r,i));return o<Math.PI/4||o>3*(Math.PI/4)?"horizontal":"vertical"}}class Cie extends Ko{constructor(){super(...arguments),this.tool={type:"connector"},this._connector=null,this._source=null,this._startPoint=null}onContainerClick(){}onContainerContextMenu(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerPointerDown(e){this._startPoint=this._service.viewport.toModelCoord(e.x,e.y),this._source=this._surface.overlays.connector.renderConnector(this._startPoint)}onContainerDragStart(){D(this._source),D(this._startPoint),this._page.captureSync();const{mode:e}=this.tool,{_edgeless:n}=this,i=n.service.addElement(kn.CONNECTOR,{mode:e,controllers:[],source:this._source,target:{position:this._startPoint}});this._connector=n.service.getElementById(i)}onContainerDragMove(e){D(this._connector);const{overlays:n}=this._surface,{viewport:i}=this._service,r=i.toModelCoord(e.x,e.y),o=n.connector.renderConnector(r,this._connector.source.id?[this._connector.source.id]:[]);this._edgeless.service.updateElement(this._connector.id,{target:o})}onContainerDragEnd(){D(this._connector),this._surface.overlays.connector.clear(),this._page.captureSync(),this._edgeless.tools.switchToDefaultMode({elements:[this._connector.id],editing:!1}),this._connector=null}onContainerMouseMove(e){const{overlays:n}=this._surface,{viewport:i}=this._service,r=i.toModelCoord(e.x,e.y);n.connector.renderConnector(r)}onContainerMouseOut(){}onPressShiftKey(e){}beforeModeSwitch(){}afterModeSwitch(){this._surface.overlays.connector.clear()}}const Af=30;function kie(t,e,n=20){const{left:i,top:r,width:o,height:s}=t;let{x:a,y:l}=e;const{containerOffset:c}=e;a+=c.x,l+=c.y;const d=a<i+n,u=a>i+o-n,h=l<r+n,p=l>r+s-n;if(!(d||u||h||p))return null;let g=0,f=0;return d?g=Math.max(-Af,a-(i+n)):u&&(g=Math.min(Af,a-(i+o-n))),h?f=Math.max(-Af,l-(r+n)):p&&(f=Math.min(Af,l-(r+s-n))),[g,f]}class Eie extends Ko{constructor(){super(...arguments),this.tool={type:"default"},this.enableHover=!0,this.dragType="none",this._dragStartPos=[0,0],this._dragLastPos=[0,0],this._dragStartModelCoord=[0,0],this._dragLastModelCoord=[0,0],this._lock=!1,this._isDoubleClickedOnMask=!1,this._alignBound=new ne,this._selectedBounds=[],this._toBeMoved=[],this._autoPanTimer=null,this._dragging=!1,this._draggingAreaDisposables=null,this._updateSelectingState=()=>{const{tools:e,service:n}=this._edgeless,{selection:i}=n,r=this._dragStartModelCoord[0],o=this._dragStartModelCoord[1],[s,a]=n.viewport.toModelCoord(this._dragLastPos[0],this._dragLastPos[1]),l=Math.min(r,s),c=Math.min(o,a),d=Math.abs(r-s),u=Math.abs(o-a),h=new ne(l,c,d,u),p=n.pickElementsByBound(h),g=new Set(e.shiftKey?[...p,...i.elements]:p);this._setSelectionState(Array.from(g).map(f=>f.id),!1),this._dragLastModelCoord=[s,a],this._edgeless.slots.draggingAreaUpdated.emit()},this._panViewport=e=>{const{viewport:n}=this._service;n.applyDeltaCenter(e[0],e[1])},this._stopAutoPanning=()=>{this._autoPanTimer&&(clearTimeout(this._autoPanTimer),this._autoPanTimer=null)},this._clearDraggingAreaDisposable=()=>{this._draggingAreaDisposables&&(this._draggingAreaDisposables.dispose(),this._draggingAreaDisposables=null)},this._startAutoPanning=e=>{this._panViewport(e),this._stopAutoPanning(),this._autoPanTimer=window.setInterval(()=>{this._panViewport(e),this._updateSelectingState()},30)},this._clearSelectingState=()=>{this._stopAutoPanning(),this._clearDraggingAreaDisposable(),this._dragging=!1,this._dragLastPos=[0,0],this._dragStartModelCoord=[0,0],this._dragLastModelCoord=[0,0],this._edgeless.slots.draggingAreaUpdated.emit()}}get draggingArea(){if(this.dragType==="selecting"){const[e,n]=this._service.viewport.toViewCoord(this._dragStartModelCoord[0],this._dragStartModelCoord[1]),[i,r]=this._service.viewport.toViewCoord(this._dragLastModelCoord[0],this._dragLastModelCoord[1]);return{start:new DOMPoint(e,n),end:new DOMPoint(i,r)}}return null}get selection(){return this._edgeless.service.selection}get state(){return this.selection.selections}_pick(e,n,i){const r=this._service,o=r.viewport.toModelCoord(e,n);return r.pickElementInGroup(o[0],o[1],i)}_setNoneSelectionState(){this.selection.empty||(this.selection.clear(),Zm(null))}_setSelectionState(e,n){this.selection.set({elements:e,editing:n})}_handleClickOnSelected(e,n){const{selectedIds:i,selections:r}=this.selection,o=r[0]?.editing??!1;if(!(i.length===1&&i[0]===e.id&&o)){if(!n.keys.shift&&i.length===1&&Gn(e)&&(i[0]===e.id&&!o||o&&i[0]!==e.id)){this._setSelectionState([e.id],!0),requestAnimationFrame(()=>{jg(n.raw.clientX,n.raw.clientY)});return}this.selection.set({elements:n.keys.shift?this.selection.has(e.id)?i.filter(s=>s!==e.id):[...i,e.id]:[e.id],editing:!1})}}_handleSurfaceDragMove(e,n,i){this._lock||(this._lock=!0,this._page.captureSync());const r=n.clone();r.x+=i[0],r.y+=i[1],e instanceof Ft&&e.moveTo(r),this._service.updateElement(e.id,{xywh:r.serialize()})}_handleBlockDragMove(e,n,i){const r=n.clone();r.x+=i[0],r.y+=i[1],this._service.updateElement(e.id,{xywh:r.serialize()})}_isInSelectedRect(e,n){const i=this.selection.elements;if(!i.length)return!1;const r=Mo(i),[o,s]=this._service.viewport.toModelCoord(e,n);return!!(r&&r.isPointInBound([o,s]))}_isDraggable(e){return!(e instanceof Ft&&!wY(e,this._toBeMoved))}onContainerPointerDown(){}onContainerClick(e){const n=this._pick(e.x,e.y);n?this._handleClickOnSelected(n,e):e.keys.shift||this._setNoneSelectionState(),this._isDoubleClickedOnMask=!1}onContainerContextMenu(){}onContainerDblClick(e){if(this._page.readonly){const i=this._service.viewport;if(i.zoom===1){const{centerX:r,centerY:o,zoom:s}=this._edgeless.getFitToScreenData();i.setViewport(s,[r,o],!0)}else{const[r,o]=i.toModelCoord(e.x,e.y);i.setViewport(1,[r,o],!0)}return}const n=this._pick(e.x,e.y,{pierce:!0,expand:10});if(n){const[i,r]=this._service.viewport.toModelCoord(e.x,e.y);if(n instanceof vn){Rb(n,this._edgeless,{x:i,y:r});return}if(n instanceof Ct){Nb(n,this._edgeless);return}if(nr(n)){DM(n,this._edgeless);return}if(n instanceof On){OM(n,this._edgeless);return}}else{RM(this._edgeless,e);return}if(e.raw.target&&e.raw.target instanceof HTMLElement&&e.raw.target.classList.contains("affine-note-mask")){this.onContainerClick(e),this._isDoubleClickedOnMask=!0;return}}onContainerTripleClick(){this._isDoubleClickedOnMask}_determineDragType(e){if(this._isInSelectedRect(e.x,e.y))return this.selection.editing?"native-editing":"content-moving";{const n=this._pick(e.x,e.y);return n?(this._setSelectionState([n.id],!1),"content-moving"):"selecting"}}async _cloneContent(){this._lock=!0;const{_edgeless:e}=this,{clipboardController:n}=e,i=JSON.parse(JSON.stringify(await Wb(this._toBeMoved,e.std))),r=Mo(this._toBeMoved),[o,s]=await n.createElementsFromClipboardData(i,r.center);this._toBeMoved=[...o,...s],this._setSelectionState(this._toBeMoved.map(a=>a.id),!1)}async onContainerDragStart(e){let n=this._determineDragType(e);this.prepareMovedElements(),e.keys.alt&&n==="content-moving"&&(n="alt-cloning",await this._cloneContent()),this._filterConnectedConnector(),this._toBeMoved.forEach(i=>{i.stash("xywh")}),this._toBeMoved.sort((i,r)=>i instanceof Ft?-1:1),this.initializeDragState(e,n)}_filterConnectedConnector(){this._toBeMoved=this._toBeMoved.filter(e=>!(e instanceof Ft&&e.source.id&&e.target.id&&this._toBeMoved.find(n=>n.id===e.source.id)&&this._toBeMoved.find(n=>n.id===e.target.id)))}prepareMovedElements(){const e=this.selection.elements,n=new Set(e);e.forEach(i=>{nr(i)?this._surface.frame.getElementsInFrame(i).forEach(r=>n.add(r)):i instanceof On&&i.decendants().forEach(r=>n.add(r))}),this._toBeMoved=Array.from(n)}initializeDragState(e,n){const{x:i,y:r}=e;this.dragType=n,this._dragging=!0,this._dragStartPos=[i,r],this._dragLastPos=[i,r];const[o,s]=this._service.viewport.toModelCoord(i,r);this._dragStartModelCoord=[o,s],this._dragLastModelCoord=[o,s],this._selectedBounds=this._toBeMoved.map(a=>ne.deserialize(a.xywh)),this._alignBound=this._surface.snap.setupAlignables(this._toBeMoved),this.dragType==="selecting"&&(this._clearDraggingAreaDisposable(),this._draggingAreaDisposables=new dt,this._draggingAreaDisposables.add(this._edgeless.service.viewport.viewportUpdated.on(()=>{this.dragType==="selecting"&&this._dragging&&!this._autoPanTimer&&this._updateSelectingState()})))}onContainerDragMove(e){const{surface:n}=this._edgeless,{viewport:i}=this._service,r=i.zoom;switch(this.dragType){case"selecting":{this._dragLastPos=[e.x,e.y],this._updateSelectingState();const o=kie(i,e);o?this._startAutoPanning(o):this._stopAutoPanning();break}case"alt-cloning":case"content-moving":{if(this._toBeMoved.every(u=>!this._isDraggable(u)))return;const o=(e.x-this._dragStartPos[0])/r,s=(e.y-this._dragStartPos[1])/r,a=this._alignBound.clone();a.x+=o,a.y+=s;const l=n.snap.align(a),c=[o+l.dx,s+l.dy];this._toBeMoved.forEach((u,h)=>{if(_0(u)){if(!this._isDraggable(u))return;this._handleSurfaceDragMove(u,this._selectedBounds[h],c)}else this._handleBlockDragMove(u,this._selectedBounds[h],c)});const d=n.frame.selectFrame(this._toBeMoved);d?n.overlays.frame.highlight(d):n.overlays.frame.clear();break}}}onContainerDragEnd(){if(this._page.transact(()=>{this._toBeMoved.forEach(n=>{n.pop("xywh")})}),this._lock&&(this._page.captureSync(),this._lock=!1),this.selection.editing)return;const{surface:e}=this._edgeless;this._dragStartPos=[0,0],this._dragLastPos=[0,0],this._selectedBounds=[],e.snap.cleanupAlignables(),e.overlays.frame.clear(),this._toBeMoved=[],this._clearSelectingState(),this.dragType="none"}onContainerMouseMove(){}onContainerMouseOut(e){}onPressShiftKey(e){}beforeModeSwitch(){this._stopAutoPanning(),this._clearDraggingAreaDisposable()}afterModeSwitch(){}}class Sie extends nl{constructor(){super(...arguments),this.d=""}render(e){e.globalAlpha=.33;const n=new Path2D(this.d);e.fillStyle="#aaa",e.fill(n)}}class Tie extends Ko{constructor(){super(...arguments),this.tool={type:"eraser"},this._overlay=new Sie,this._timestamp=0,this._timer=0,this._eraserPoints=[],this._prevPoint=[],this._prevEraserPoint=[],this._erasables=new Set,this._eraseTargets=new Set,this._loop=()=>{const e=Date.now(),n=e-this._timestamp;let i=!1;if(this._prevEraserPoint!==this._prevPoint&&(i=!0,this._eraserPoints.push(this._prevPoint),this._prevEraserPoint=this._prevPoint),n>32&&this._eraserPoints.length>1&&(i=!0,this._eraserPoints.splice(0,Math.ceil(this._eraserPoints.length*.1)),this._timestamp=e),i){const r=this._service.viewport.zoom,o=bk(dT(this._eraserPoints,{size:16/r,start:{taper:!0}}));this._overlay.d=o,this._edgeless.surface.refresh()}this._timer=requestAnimationFrame(this._loop)}}onContainerPointerDown(){}toModelCoord(e){return this._service.viewport.toModelCoord(e.x,e.y)}onContainerDragStart(e){this._page.captureSync();const{point:n}=e,[i,r]=this.toModelCoord(n);this._eraserPoints=[[i,r]],this._prevPoint=[i,r],this._erasables=new Set([...this._service.elements,...this._service.blocks]),this._loop(),this._edgeless.surface.renderer.addOverlay(this._overlay)}onContainerDragMove(e){const n=this.toModelCoord(e.point);this._erasables.forEach(i=>{if(!this._eraseTargets.has(i))if(Xr(i)){const r=ne.deserialize(i.xywh);if(Co(this._prevPoint,n,r.points)){this._eraseTargets.add(i);const o=this._edgeless.host.view.viewFromPath("block",qn(i));o&&(o.style.opacity="0.3")}}else i.intersectWithLine(this._prevPoint,n)&&(this._eraseTargets.add(i),i.opacity=.3)}),this._prevPoint=n}beforeModeSwitch(){this._eraseTargets.forEach(e=>{if(Xr(e)){const n=this._edgeless.host.view.viewFromPath("block",qn(e));n&&(n.style.opacity="1")}else e.opacity=1}),this._reset()}_reset(){cancelAnimationFrame(this._timer),this._edgeless.surface.renderer.removeOverlay(this._overlay),this._erasables.clear(),this._eraseTargets.clear()}onContainerDragEnd(){E0(this._surface,Array.from(this._eraseTargets)),this._reset(),this._page.captureSync()}onContainerClick(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerMouseMove(){}onContainerMouseOut(){}onContainerContextMenu(){}onPressShiftKey(e){}afterModeSwitch(e){}}class Iie extends Ko{constructor(){super(...arguments),this.tool={type:"frameNavigator"}}onContainerPointerDown(){}onContainerDragStart(){}onContainerDragMove(){}onContainerDragEnd(){}onContainerClick(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerMouseMove(){}onContainerMouseOut(){}onContainerContextMenu(){}onPressShiftKey(){}beforeModeSwitch(){}afterModeSwitch(){}}class Lie extends Ko{constructor(){super(...arguments),this.tool={type:"frame"},this._startPoint=null,this._frame=null}_toModelCoord(e){return this._service.viewport.toModelCoord(e.x,e.y)}onContainerPointerDown(){}onContainerDragStart(e){this._page.captureSync();const{point:n}=e;this._startPoint=this._toModelCoord(n)}onContainerDragMove(e){const n=this._toModelCoord(e.point);if(D(this._startPoint),!(te.dist(this._startPoint,n)<8&&!this._frame)){if(!this._frame){const i=this._service.frames,r=this._service.addBlock("affine:frame",{title:new nt.Y.Text(`Frame ${i.length+1}`),xywh:ne.fromPoints([this._startPoint,n]).serialize()},this._service.surface);this._frame=this._service.getElementById(r),this._frame.stash("xywh");return}D(this._frame),this._service.updateElement(this._frame.id,{xywh:ne.fromPoints([this._startPoint,n]).serialize()})}}onContainerDragEnd(){if(this._frame){const e=this._frame;this._page.transact(()=>{e.pop("xywh")}),this._edgeless.tools.setEdgelessTool({type:"default"}),this._edgeless.service.selection.set({elements:[this._frame.id],editing:!1}),this._page.captureSync()}this._frame=null,this._startPoint=null}onContainerClick(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerMouseMove(){}onContainerMouseOut(){}onContainerContextMenu(){}onPressShiftKey(){}beforeModeSwitch(){}afterModeSwitch(){}}function O_(t,e,n,i,r=r5,o=g0){const s=t.addNoteWithPoint(n,{width:r,height:o}),a=e.addBlock(i.childFlavour,{type:i.childType},s);if(i.collapse){const l=e.getBlockById(s);e.updateBlock(l,()=>l.edgeless.collapse=!0)}t.slots.edgelessToolUpdated.emit({type:"default"}),requestAnimationFrame(()=>{const c=(e.root?.children.filter(d=>d.flavour==="affine:note")??[]).find(d=>d.id===s);c&&(t.service.selection.set({elements:[c.id],editing:!0}),t.updateComplete.then(()=>{a?$n(t.host,e,a)?.catch(console.error):jg(n.x,n.y)}).catch(console.error))})}class Mie extends Ko{constructor(){super(...arguments),this.tool={type:"affine:note",childFlavour:"affine:paragraph",childType:"text",tip:"Text"},this._noteOverlay=null,this._draggingNoteOverlay=null,this._draggingArea=null}onPressShiftKey(e){this._draggingNoteOverlay&&this._resize(e)}_resize(e=!1){const{_draggingArea:n,_draggingNoteOverlay:i,_edgeless:r}=this;D(n),D(i);const{viewport:o}=r.service,{zoom:s}=o,{start:{x:a,y:l},end:c}=n;let{x:d,y:u}=c;if(e){const v=Math.abs(d-a),m=Math.abs(u-l),y=Math.max(v,m);d=a+(d>a?y:-y),u=l+(u>l?y:-y)}const[h,p]=o.toModelCoord(Math.min(a,d),Math.min(l,u)),g=Math.abs(a-d)/s,f=Math.abs(l-u)/s;i.slots.draggingNoteUpdated.emit({xywh:[h,p,g,f]})}onContainerPointerDown(){}onContainerClick(e){this._clearOverlay();const{childFlavour:n,childType:i}=this.tool,r={childFlavour:n,childType:i,collapse:!1},o=new je(e.point.x,e.point.y);O_(this._edgeless,this._page,o,r)}onContainerContextMenu(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerDragStart(e){this._clearOverlay();const i=this._edgeless.service.editSession.getLastProps("affine:note").background;this._draggingNoteOverlay=new pK(this._edgeless,i),this._edgeless.surface.renderer.addOverlay(this._draggingNoteOverlay),this._draggingArea={start:new DOMPoint(e.x,e.y),end:new DOMPoint(e.x,e.y)}}onContainerDragMove(e){D(this._draggingNoteOverlay),D(this._draggingArea),this._draggingArea.end=new DOMPoint(e.x,e.y),this._resize(e.keys.shift||this._edgeless.tools.shiftKey)}onContainerDragEnd(){if(!this._draggingNoteOverlay)return;this._draggingArea=null;const{x:e,y:n,width:i,height:r}=this._draggingNoteOverlay;if(this._disposeOverlay(this._draggingNoteOverlay),i<Wh||r<x8){this._edgeless.slots.edgelessToolUpdated.emit({type:"default"});return}const{childFlavour:o,childType:s}=this.tool,a={childFlavour:o,childType:s,collapse:!0},[l,c]=this._edgeless.service.viewport.toViewCoord(e,n),d=new je(l,c);this._page.captureSync(),O_(this._edgeless,this._page,d,a,i,r)}_updateOverlayPosition(e,n){this._noteOverlay&&(this._noteOverlay.x=e,this._noteOverlay.y=n,this._edgeless.surface.refresh())}_disposeOverlay(e){return e&&(e.dispose(),this._edgeless.surface.renderer.removeOverlay(e)),null}_clearOverlay(){this._noteOverlay=this._disposeOverlay(this._noteOverlay),this._draggingNoteOverlay=this._disposeOverlay(this._draggingNoteOverlay),this._edgeless.surface.refresh()}_hideOverlay(){this._noteOverlay&&(this._noteOverlay.globalAlpha=0,this._edgeless.surface.refresh())}onContainerMouseMove(e){if(!this._noteOverlay)return;this._noteOverlay.globalAlpha===0&&(this._noteOverlay.globalAlpha=1);const[n,i]=this._service.viewport.toModelCoord(e.x,e.y);this._updateOverlayPosition(n,i)}onContainerMouseOut(e){e.raw.relatedTarget&&Gk(e.raw.relatedTarget,oM)||this._hideOverlay()}beforeModeSwitch(){this._clearOverlay()}afterModeSwitch(e){if(e.type!=="affine:note")return;const i=this._edgeless.service.editSession.getLastProps("affine:note").background;this._noteOverlay=new dM(this._edgeless,i),this._noteOverlay.text=e.tip,this._edgeless.surface.renderer.addOverlay(this._noteOverlay)}}class Pie extends Ko{constructor(){super(...arguments),this.tool={type:"pan"},this._lastPoint=null}onContainerClick(){}onContainerContextMenu(){}onContainerPointerDown(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerDragStart(e){this._lastPoint=[e.x,e.y],this._edgeless.slots.edgelessToolUpdated.emit({type:"pan",panning:!0})}onContainerDragMove(e){if(!this._lastPoint)return;const{viewport:n}=this._service,{zoom:i}=n,[r,o]=this._lastPoint,s=r-e.x,a=o-e.y;this._lastPoint=[e.x,e.y],n.applyDeltaCenter(s/i,a/i)}onContainerDragEnd(){this._lastPoint=null,this._edgeless.slots.edgelessToolUpdated.emit({type:"pan",panning:!1})}onContainerMouseMove(){}onContainerMouseOut(){}onPressShiftKey(e){}beforeModeSwitch(){}afterModeSwitch(){}}class Aie extends Ko{constructor(){super(...arguments),this.tool={type:"text"}}onContainerClick(e){RM(this._edgeless,e)}onContainerContextMenu(){}onContainerPointerDown(){}onContainerDblClick(){}onContainerTripleClick(){}onContainerDragStart(){}onContainerDragMove(){}onContainerDragEnd(){}onContainerMouseMove(){}onContainerMouseOut(){}onPressShiftKey(e){}beforeModeSwitch(){}afterModeSwitch(){}}class $ie{constructor(e,n){this.container=e,this.dispatcher=n,this._edgelessTool={type:"default"},this._lastMousePos={x:0,y:0},this._rightClickTimer=null,this._shiftKey=!1,this._dragging=!1,this.edgelessToolUpdated=new Ve,this._disposables=new dt,this._add=(i,r)=>{this._disposables.add(this.dispatcher.add(i,r))},this._onContainerDragStart=i=>{if(!(this.page.readonly&&this.edgelessTool.type!=="pan")&&!(i.button===2&&this.edgelessTool.type!=="pan"))return this.currentController.onContainerDragStart(i)},this._onContainerDragMove=i=>{if(!(this.page.readonly&&this.edgelessTool.type!=="pan")&&!(i.button===2&&this.edgelessTool.type!=="pan"))return this.currentController.onContainerDragMove(i)},this._onContainerDragEnd=i=>{if(!(this.page.readonly&&this.edgelessTool.type!=="pan")&&!(i.button===2&&this.edgelessTool.type!=="pan"))return this.currentController.onContainerDragEnd(i)},this._onContainerClick=i=>this.currentController.onContainerClick(i),this._onContainerDblClick=i=>this.currentController.onContainerDblClick(i),this._onContainerTripleClick=i=>this.currentController.onContainerTripleClick(i),this._onContainerPointerMove=i=>(this._updateLastMousePos(i),this._controllers[this.edgelessTool.type].onContainerMouseMove(i)),this._onContainerPointerOut=i=>this._controllers[this.edgelessTool.type].onContainerMouseOut(i),this._onContainerContextMenu=i=>{i.event.preventDefault();const r=new YB({event:i.event,rect:this.dispatcher.host.getBoundingClientRect(),startX:0,startY:0,last:null}),o=this.edgelessTool;o.type!=="pan"&&!this._rightClickTimer&&(this._rightClickTimer={edgelessTool:o,timeStamp:i.event.timeStamp,timer:window.setTimeout(()=>{this._controllers.pan.onContainerDragStart(r)},233)})},this._onContainerPointerDown=i=>{if(!Ky(i.raw))return this.page.readonly?void 0:this.currentController.onContainerPointerDown(i);const r=this._edgelessTool,o=s=>{Ky(s)||(this.setEdgelessTool(r),document.removeEventListener("pointerup",o,!1),document.removeEventListener("pointerover",o,!1))};this.dispatcher.disposables.addFromEvent(document,"pointerover",o),this.dispatcher.disposables.addFromEvent(document,"pointerup",o),this.setEdgelessTool({type:"pan",panning:!0})},this._onContainerPointerUp=i=>{if(i.button===2&&this._rightClickTimer){const{timer:r,timeStamp:o,edgelessTool:s}=this._rightClickTimer;i.raw.timeStamp-o>233?this.container.slots.edgelessToolUpdated.emit(s):clearTimeout(r),this._rightClickTimer=null}},this.setEdgelessTool=(i,r={elements:[],editing:!1})=>{const{type:o}=i;if(this.page.readonly&&o!=="pan"&&o!=="frameNavigator"||this.edgelessTool===i)return;const s=this.edgelessTool.type;this._controllers[s].beforeModeSwitch(i),this._controllers[i.type].beforeModeSwitch(i),o==="default"&&(Array.isArray(r)?this.selection.isEmpty(r):r.elements.length===0)&&this.selection.lastState&&(r=this.selection.lastState),this.selection.set(r),this.container.slots.edgelessToolUpdated.emit(i),this._controllers[s].afterModeSwitch(i),this._controllers[i.type].afterModeSwitch(i)},this._controllers={default:new Eie(e,e.service),text:new Aie(e,e.service),shape:new _b(e,e.service),brush:new _ie(e,e.service),pan:new Pie(e,e.service),"affine:note":new Mie(e,e.service),connector:new Cie(e,e.service),eraser:new Tie(e,e.service),frame:new Lie(e,e.service),frameNavigator:new Iie(e,e.service)},this._initMouseAndWheelEvents().catch(console.error)}get dragging(){return this._dragging}get selection(){return this.service.selection}get lastMousePos(){return this._lastMousePos}get edgelessTool(){return this._edgelessTool}set edgelessTool(e){this._edgelessTool=e,this._controllers[this._edgelessTool.type].tool=this._edgelessTool}get currentController(){return this._controllers[this.edgelessTool.type]}get draggingArea(){if(!this.currentController.draggingArea)return null;const{start:e,end:n}=this.currentController.draggingArea,i=Math.min(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.x,n.x),s=Math.max(e.y,n.y);return new DOMRect(i,r,o-i,s-r)}get shiftKey(){return this._shiftKey}set shiftKey(e){this._shiftKey=e,this.currentController.onPressShiftKey(e)}get page(){return this.service.page}get service(){return this.container.service}_updateLastMousePos(e){this._lastMousePos={x:e.x,y:e.y}}async _initMouseAndWheelEvents(){this._add("dragStart",e=>{this._dragging=!0;const n=e.get("pointerState");this._onContainerDragStart(n)}),this._add("dragMove",e=>{const n=e.get("pointerState");this._onContainerDragMove(n)}),this._add("dragEnd",e=>{this._dragging=!1;const n=e.get("pointerState");this._onContainerDragEnd(n)}),this._add("click",e=>{const n=e.get("pointerState");this._onContainerClick(n)}),this._add("doubleClick",e=>{const n=e.get("pointerState");this._onContainerDblClick(n)}),this._add("tripleClick",e=>{const n=e.get("pointerState");this._onContainerTripleClick(n)}),this._add("pointerMove",e=>{const n=e.get("pointerState");this._onContainerPointerMove(n)}),this._add("pointerDown",e=>{const n=e.get("pointerState");this._onContainerPointerDown(n)}),this._add("pointerUp",e=>{const n=e.get("pointerState");this._onContainerPointerUp(n)}),this._add("pointerOut",e=>{const n=e.get("pointerState");this._onContainerPointerOut(n)}),this._add("contextMenu",e=>{const n=e.get("defaultState");this._onContainerContextMenu(n)}),this._add("wheel",e=>{const i=e.get("defaultState").event;if(!(i instanceof WheelEvent))return;i.preventDefault();const r=this.container,{viewport:o}=this.service;if(CO(i)){const s=r.getBoundingClientRect(),[a,l]=r.service.viewport.toModelCoord(i.clientX-s.x,i.clientY-s.y),c=RT(i.deltaY,o.zoom);o.setZoom(c,new je(a,l))}else{const s=i.deltaX/o.zoom,a=i.deltaY/o.zoom;o.applyDeltaCenter(s,a)}})}getHoverState(){if(!this.currentController.enableHover)return null;const{x:e,y:n}=this._lastMousePos,[i,r]=this.service.viewport.toModelCoord(e,n),o=this.service.pickElement(i,r);return!o||this.selection?.editing?null:{rect:this.service.viewport.toViewBound(Mo([o])),content:o}}switchToDefaultMode(e){this.setEdgelessTool({type:"default"},e)}clear(){}dispose(){this._disposables.dispose()}}var Bie=Object.defineProperty,Die=Object.getOwnPropertyDescriptor,P0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Die(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Bie(e,n,r),r};let Fi=class extends wn{constructor(){super(...arguments),this.components={toolbar:null,zoomToolbar:null,zoomBarToggleButton:null},this.keyboardManager=null,this.edgelessTool={type:localStorage.defaultTool??"default"},this.clipboardController=new vne(this),this.slots={edgelessToolUpdated:new Ve,zoomUpdated:new Ve,pressShiftKeyUpdated:new Ve,cursorUpdated:new Ve,copyAsPng:new Ve,pageLinkClicked:new Ve,tagClicked:new Ve,readonlyUpdated:new Ve,draggingAreaUpdated:new Ve,navigatorSettingUpdated:new Ve,navigatorFrameChanged:new Ve,fullScrennToggled:new Ve,elementResizeStart:new Ve,elementResizeEnd:new Ve,toggleNoteSlicer:new Ve},this._viewportElement=null,this._resizeObserver=null}get dispatcher(){return this.service?.uiEventDispatcher}get service(){return super.service}get viewportElement(){return this._viewportElement?this._viewportElement:(this._viewportElement=this.host.closest("edgeless-editor"),D(this._viewportElement),this._viewportElement)}get viewport(){const{scrollLeft:t,scrollTop:e,scrollWidth:n,scrollHeight:i,clientWidth:r,clientHeight:o}=this.viewportElement,{top:s,left:a}=this.viewportElement.getBoundingClientRect();return{top:s,left:a,scrollLeft:t,scrollTop:e,scrollWidth:n,scrollHeight:i,clientWidth:r,clientHeight:o}}get surfaceBlockModel(){return this.model.children.find(t=>t.flavour==="affine:surface")}_handleToolbarFlag(){const t=()=>{const e=new Ps(this),n=new Ba(this),i=new pd(this);this.appendChild(e),this.appendChild(n),this.appendChild(i),this.components.toolbar=e,this.components.zoomToolbar=n,this.components.zoomBarToggleButton=i};!this.components.toolbar&&!this.components.zoomToolbar&&!this.components.zoomBarToggleButton&&t()}_initSlotEffects(){const{_disposables:t,slots:e}=this;this._disposables.add(()=>KM(this,()=>this.surface.refresh())),t.add(e.edgelessToolUpdated.on(i=>{this.edgelessTool=i,e.cursorUpdated.emit(bJ(i))})),t.add(this.tools),t.add(this.service.selection),t.add(e.zoomUpdated.on(i=>this.components.zoomToolbar?.setZoomByAction(i))),t.add(e.pressShiftKeyUpdated.on(i=>{this.tools.shiftKey=i})),t.add(e.cursorUpdated.on(Vd(i=>{this.style.cursor=i},144)));let n=!0;t.add(e.copyAsPng.on(({blocks:i,shapes:r})=>{n&&(n=!1,this.clipboardController.copyAsPng(i,r).then(()=>kt(this.host,"Copied to clipboard")).catch(()=>kt(this.host,"Failed to copy as PNG")).finally(()=>{n=!0}))}))}addNoteWithPoint(t,e={}){const{width:n=r5,height:i=g0,offsetX:r=GX,offsetY:o=ZX,parentId:s=this.page.root?.id,noteIndex:a,scale:l=1}=e,[c,d]=this.service.viewport.toModelCoord(t.x,t.y);return this.service.addBlock("affine:note",{xywh:wo(c-r*l,d-o*l,n,i),displayMode:qe.EdgelessOnly},s,a)}addNewNote(t,e,n){this.page.captureSync();const{left:i,top:r}=this.service.viewport;e.x-=i,e.y-=r;const o=this.addNoteWithPoint(e,n),s=this.page.addBlocks(t.map(({flavour:a,...l})=>(D(a),{flavour:a,blockProps:l})),o);return{noteId:o,ids:s}}addImage(t,e){const n={width:t.width??0,height:t.height??0};delete t.width,delete t.height,e=this.service.viewport.toModelCoord(e[0],e[1]);const i=new ne(e[0],e[1],n.width,n.height);return this.service.addBlock("affine:image",{...t,xywh:i.serialize()},this.surface.model)}async addImages(t,e){const n=[...t].filter(h=>h.type.startsWith("image/"));if(!n.length)return[];const i=this.host.spec.getService("affine:image");D(i),Cs(i,hd);const r=i.maxFileSize;if(n.some(h=>h.size>r))return kt(this.host,`You can only upload files less than ${Gl(r,!0,0)}`),[];let{x:s,y:a}=this.service.viewport.center;e&&([s,a]=this.service.viewport.toModelCoord(e.x,e.y));const l=[],c=32;n.map((h,p)=>{const g=new je(s+p*c,a+p*c),f=te.toVec(g),v=ne.fromCenter(f,QM,JM),m=this.service.addBlock("affine:image",{size:h.size,xywh:v.serialize()},this.surface.model);l.push({point:g,blockId:m})});const d=n.map(async(h,p)=>{const{point:g,blockId:f}=l[p],v=await this.page.blob.set(h),m=await FY(h),y=te.toVec(g),x=ne.fromCenter(y,m.width,m.height);this.page.withoutTransact(()=>{this.service.updateElement(f,{sourceId:v,...m,xywh:x.serialize()})})});await Promise.all(d);const u=l.map(h=>h.blockId);return this.service.selection.set({elements:u,editing:!1}),u}setSelection(t,e=!0,n,i){const r=this.service.blocks.filter(o=>o.flavour==="affine:note").find(o=>o.id===t);D(r),requestAnimationFrame(()=>{this.service.selection.set({elements:[r.id],editing:!1}),this.updateComplete.then(()=>{n?$n(this.host,this.page,n)?.catch(console.error):i&&jg(i.x,i.y)}).catch(console.error)})}getElementsBound(){const{service:t}=this;return Mo([...t.elements,...t.blocks])}update(t){t.has("edgelessTool")&&(this.tools.edgelessTool=this.edgelessTool),super.update(t)}_initResizeEffect(){const t=new ResizeObserver(e=>{this.service.selection.set(this.service.selection.selections)});t.observe(this.viewportElement),this._resizeObserver=t}_initPixelRatioChangeEffect(){let t;const e=()=>{t&&(this.service.viewport.onResize(),t.removeEventListener("change",e)),t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),t.addEventListener("change",e)};e()}_initFontloader(){const t=this.service?.fontLoader;D(t),t.ready.then(()=>{this.surface.refresh()}).catch(console.error)}_initReadonlyListener(){const t=this.page;let e=t.readonly;this._disposables.add(t.awarenessStore.slots.update.on(()=>{e!==t.readonly&&(e=t.readonly,this.slots.readonlyUpdated.emit(e))}))}_initRemoteCursor(){let t=null;const e=n=>{t&&cancelAnimationFrame(t),t=Eo(()=>{const i=this.service.viewport.toModelCoord(n.x,n.y);this.service.selection.setCursor({x:i[0],y:i[1]}),t=null},this)};this.handleEvent("pointerMove",n=>{const i=n.get("pointerState");e(i)})}_initSurface(){const t=(e=this.surface.renderer.stackingCanvas)=>{this.pageBlockContainer.setSlotContent(e)};this._disposables.add(jd(this.surface,"indexedcanvasupdate",e=>{t(e.detail.content)})),this.pageBlockContainer.isUpdatePending?this.pageBlockContainer.updateComplete.then(()=>t()).catch(console.error):t()}firstUpdated(){this._initSlotEffects(),this._initResizeEffect(),this._initPixelRatioChangeEffect(),this._initFontloader(),this._initReadonlyListener(),this._initRemoteCursor(),this._initSurface(),this._initViewport(),this.page.readonly&&this.tools.setEdgelessTool({type:"pan",panning:!0}),Eo(()=>{this._handleToolbarFlag(),this.requestUpdate()},this)}_getSavedViewport(){let t=null;const e=this.service.editSession.getItem("viewport");if(!e)return null;if("referenceId"in e){const n=this.service.getElementById(e.referenceId);n?(this.service.viewport.setViewportByBound(ne.deserialize(n.xywh),e.padding),t=e):t=null}else t=e;return t}getFitToScreenData(t=[0,0,0,0]){const e=[];this.service.blocks.forEach(u=>{e.push(ne.deserialize(u.xywh))});const n=U1(this.service.elements);n&&e.push(n);const[i,r,o,s]=t,{viewport:a}=this.service;let{centerX:l,centerY:c,zoom:d}=a;if(e.length){const{width:u,height:h}=a,p=U1(e);D(p),d=Math.min((u-Zx-(r+s))/p.w,(h-Zx-(i+o))/p.h),d=Zr(d,_k,qy),l=p.x+(p.w+r/d)/2-s/d/2,c=p.y+(p.h+o/d)/2-i/d/2}else d=qy;return{zoom:d,centerX:l,centerY:c}}_initViewport(){this.service.viewport.setContainer(this);const t=()=>{const e=this._getSavedViewport()??this.getFitToScreenData();if("xywh"in e){const{xywh:n,padding:i}=e,r=ne.deserialize(n);this.service.viewport.setViewportByBound(r,i)}else{const{zoom:n,centerX:i,centerY:r}=e;this.service.viewport.setViewport(n,[i,r])}};this.surface.isUpdatePending?this.surface.updateComplete.then(t).catch(console.error):t()}connectedCallback(){super.connectedCallback(),this.clipboardController.hostConnected(),this.keyboardManager=new xie(this),this.handleEvent("selectionChange",()=>{const t=this.host.selection.value.find(n=>n.is("surface"));if(!t)return;const e=this.service.getElementById(t.elements[0]);if(_0(e))return this.host.event.activate(),!0}),this.mouseRoot=this.parentElement,this.tools=new $ie(this,this.host.event)}disconnectedCallback(){super.disconnectedCallback(),this.clipboardController.hostDisconnected(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),this.keyboardManager=null,this.tools.clear(),this.tools.dispose()}renderBlock(){this.setAttribute(lr,this.model.id);const t=b`${Fe(Object.entries(this.widgets),([e])=>e,([e,n])=>n)}`;return b`${this.renderModel(this.surfaceBlockModel)}
      <edgeless-block-portal-container .edgeless=${this}>
      </edgeless-block-portal-container>
      <edgeless-frames-container
        .surface=${this.surface}
        .edgeless=${this}
        .frames=${this.service.frames}
        .onlyTitle=${!0}
      >
      </edgeless-frames-container>
      <div class="widgets-container">${t}</div> `}};Fi.styles=X`
    .widgets-container {
      position: absolute;
      left: 0;
      top: 0;
      contain: size layout;
      z-index: 1;
    }

    .affine-edgeless-layer {
      position: absolute;
      top: 0;
      left: 0;
      contain: size layout style;
    }

    @container viewport (width <= 1200px) {
      edgeless-zoom-toolbar {
        display: none;
      }
    }

    @container viewport (width >= 1200px) {
      zoom-bar-toggle-button {
        display: none;
      }
    }

    @media print {
      .selected {
        background-color: transparent !important;
      }
    }
  `;P0([ie()],Fi.prototype,"edgelessTool",2);P0([he("edgeless-block-portal-container")],Fi.prototype,"pageBlockContainer",2);P0([he(".affine-edgeless-layer")],Fi.prototype,"edgelessLayer",2);P0([he("affine-surface")],Fi.prototype,"surface",2);Fi=P0([W("affine-edgeless-page")],Fi);class ev extends Bn{constructor(){super(),this.created.on(()=>{this.page.slots.rootAdded.on(e=>{if(e instanceof ev){const n=this.page.workspace.meta.getPageMeta(e.page.id);(!n||n.title!==e.title.toString())&&this.page.workspace.setPageMeta(e.page.id,{title:e.title.toString()})}})})}}const V3=_i({flavour:"affine:page",props:t=>({title:t.Text()}),metadata:{version:2,role:"root"},toModel:()=>new ev});function H6(t){const[e,n,i,r]=Wn(t.xywh);return{x:e,y:n,w:i,h:r}}const Oie="Untitled",A8={exportFile(t,e){const n=document.createElement("a");n.setAttribute("href",e);const i=Rie(t);n.setAttribute("download",i),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},exportPng(t,e){const n=t?.trim()||Oie;A8.exportFile(n+".png",e)}};function Rie(t){const e=" ",n=/[<>:"/\\|?*\u0000-\u001F]/g,i=/^(con|prn|aux|nul|com\d|lpt\d)$/i,r=/[\u0000-\u001F\u0080-\u009F]/g,o=/\.+$/;function a(u,h){const p=h.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),g=new RegExp(`(?:${p}){2,}`,"g");return u.replace(g,h)}t=t.normalize("NFD").replace(n,e).replace(r,e).replace(o,""),t=a(t,e),t=i.test(t)?t+e:t;const l=t.lastIndexOf("."),c=t.slice(0,l).trim(),d=t.slice(l);return t=c.slice(0,Math.max(1,50-d.length))+d,t}const Nie=["AFFINE-BLOCK-HUB","EDGELESS-TOOLBAR","AFFINE-DRAG-HANDLE-WIDGET"];class Hie{constructor(e,n){this._replaceRichTextWithSvgElement=async i=>{const r=Array.from(i.querySelectorAll(".inline-editor"));await Promise.all(r.map(async o=>{const s=await this._elementToSvgElement(o.cloneNode(!0),o.clientWidth,o.clientHeight+1);o.parentElement?.appendChild(s),o.parentElement?.removeChild(o)}))},this._exportOptions=n,this._blockService=e}get page(){return this._blockService.std.page}get editorHost(){return this._blockService.std.host}async _checkReady(){const e=location.pathname,n=en(this.editorHost);return await new Promise((r,o)=>{let s=0;const a=setInterval(()=>{try{this._checkCanContinueToCanvas(e,n)}catch(h){clearInterval(a),o(h)}const l=this.page.root,c=l?T7(this.editorHost,l):null,d=c?.querySelector("affine-image-block-card"),u=!d||d.getAttribute("imageState")==="0";c&&u&&(clearInterval(a),r(!0)),s++,s>10*60&&(clearInterval(a),r(!1))},100)})}_drawEdgelessBackground(e,{size:n,backgroundColor:i,gridColor:r}){const o=`<svg width='${e.canvas.width}px' height='${e.canvas.height}px' xmlns='http://www.w3.org/2000/svg' style='background-size:${n}px ${n}px;background-color:${i}; background-image: radial-gradient(${r} 1px, ${i} 1px)'></svg>`,s=new Image,a=()=>{s.onload=null,s.onerror=null};return new Promise((l,c)=>{s.onload=()=>{a(),e.drawImage(s,0,0),l()},s.onerror=d=>{a(),c(d)},s.src=`data:image/svg+xml,${encodeURIComponent(o)}`})}async _html2canvas(e,n={}){const i=(await Jt(()=>import("./html2canvas.esm-Yv5NavHP.js"),__vite__mapDeps([]))).default,r={ignoreElements:function(o){return!!(o.tagName==="AFFINE-BLOCK-HUB"||o.tagName==="EDGELESS-TOOLBAR"||o.classList.contains("dg"))},onclone:async(o,s)=>{s.style.setProperty("transform","none");const a=s.classList.contains(".affine-edgeless-layer")?s:null;a instanceof HTMLElement&&a.style.setProperty("transform","none"),o.querySelectorAll("[style*='box-shadow']").forEach(function(c){c instanceof HTMLElement&&c.style.setProperty("box-shadow","none")}),await this._replaceRichTextWithSvgElement(s)},useCORS:!this._exportOptions.imageProxyEndpoint,proxy:this._exportOptions.imageProxyEndpoint};return i(e,Object.assign(r,n))}_createCanvas(e,n){const i=document.createElement("canvas"),r=window.devicePixelRatio||1,o=i.getContext("2d");return i.width=(e.w+100)*r,i.height=(e.h+100)*r,o.scale(r,r),o.fillStyle=n,o.fillRect(0,0,i.width,i.height),{canvas:i,ctx:o}}async edgelessToCanvas(e,n,i=()=>null,r,o,s,a){if(!this.page.root)return;const c=location.pathname,d=en(this.editorHost),u=V1(this.editorHost);D(u);const h=u.viewportElement,p=window.getComputedStyle(h),g=T=>this._html2canvas(T,{backgroundColor:p.backgroundColor}),f=u.querySelector(".affine-block-children-container");if(!f)return;const{ctx:v,canvas:m}=this._createCanvas(n,window.getComputedStyle(f).backgroundColor);a&&await this._drawEdgelessBackground(v,{backgroundColor:p.getPropertyValue("--affine-background-primary-color"),size:$b(a.zoom,!0).gap,gridColor:p.getPropertyValue("--affine-edgeless-grid-color")});const y=o??r?.service.pickElementsByBound(n,"blocks")??[];for(const T of y){if(Ie(T,["affine:image"])){if(!T.sourceId)return;const k=await T.page.blob.get(T.sourceId);if(!k)return;const _=$=>new Promise((E,R)=>{const I=new Image;I.onload=()=>E(I),I.onerror=R,I.src=URL.createObjectURL($)}),A=H6(T);v.drawImage(await _(k),A.x-n.x,A.y-n.y,A.w,A.h)}let M=i(T)?.parentElement;if(Ie(T,["affine:note"])&&(M=M?.closest(".edgeless-block-portal-note")),M){const k=H6(T),_=await this._html2canvas(M);v.drawImage(_,k.x-n.x+50,k.y-n.y+50,k.w,k.h)}if(Ie(T,["affine:frame"])){const k=qM(this.page,T,!1),_=ne.deserialize(T.xywh);for(let $=0;$<k.length;$++){const E=k[$],R=i(E),I=H6(E),N=await g(R);v.drawImage(N,I.x-n.x+50,I.y-n.y+50,I.w,I.w/N.width*N.height)}const A=e.getCanvasByBound(_);v.drawImage(A,50,50,_.w,_.h)}this._checkCanContinueToCanvas(c,d)}const x=e.getCanvasByBound(n,s);return v.drawImage(x,50,50,n.w,n.h),m}async _docToCanvas(){const e=(await Jt(()=>import("./html2canvas.esm-Yv5NavHP.js"),__vite__mapDeps([]))).default;if(!(e instanceof Function))return;const n=location.pathname,i=en(this.editorHost),r=V1(this.editorHost);D(r);const o=r.viewportElement,a=o.querySelector(".affine-doc-page-block-container")?.getBoundingClientRect(),{viewport:l}=r,c=a?.width,d=a?.left??0,u=o?.scrollHeight,h=this._replaceRichTextWithSvgElement.bind(this),p={ignoreElements:function(f){return Nie.includes(f.tagName)||f.classList.contains("dg")?!0:!!(f.classList.contains("close")&&f.parentElement?.classList.contains("meta-data-expanded-title")||f.classList.contains("expand")&&f.parentElement?.classList.contains("meta-data"))},onclone:async function(f,v){v.style.height=`${u}px`,await h(v)},backgroundColor:window.getComputedStyle(o).backgroundColor,x:d-l.left,width:c,height:u,useCORS:!this._exportOptions.imageProxyEndpoint,proxy:this._exportOptions.imageProxyEndpoint},g=await e(o,p);return this._checkCanContinueToCanvas(n,i),g}async _elementToSvgElement(e,n,i){const r="http://www.w3.org/2000/svg",o=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return o.setAttribute("width",`${n}`),o.setAttribute("height",`${i}`),o.setAttribute("viewBox",`0 0 ${n} ${i}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),o.appendChild(s),s.appendChild(e),o}_checkCanContinueToCanvas(e,n){if(location.pathname!==e||en(this.editorHost)!==n)throw new Error("Unable to export content to canvas")}async _toCanvas(){if(await this._checkReady(),en(this.editorHost))return await this._docToCanvas();{const e=this.page.root;if(!e)return;const n=T7(this.editorHost,e),i=n.getElementsBound();return D(i),await this.edgelessToCanvas(n.surface.renderer,i,r=>Mk(r,this.editorHost.view),n)}}async exportPng(){if(!this.page.root)return;const n=await this._toCanvas();n&&A8.exportPng(this.page.root.title.toString(),n.toDataURL("image/png"))}async exportPdf(){const e=this.page.root;if(!e)return;const n=await this._toCanvas();if(!n)return;const r=await(await Jt(()=>import("./index-HSX1BOCG.js"),__vite__mapDeps([2,1,3]))).PDFDocument.create(),o=r.addPage([n.width,n.height]),s=await r.embedPng(n.toDataURL("PNG")),{width:a,height:l}=s.scale(1);o.drawImage(s,{x:0,y:0,width:a,height:l});const c=await r.saveAsBase64({dataUri:!0});A8.exportFile(e.title.toString()+".pdf",c)}}class Fie{constructor(){this.fontFaces=[]}get ready(){return Promise.all(this.fontFaces.map(e=>e.loaded))}load(e){this.fontFaces.push(...e.map(({font:n,weight:i,url:r,style:o})=>{const s=new FontFace(n,`url(${r})`,{weight:i,style:o});return document.fonts.add(s),s.load().catch(console.error),s}))}clear(){this.fontFaces.forEach(e=>document.fonts.delete(e)),this.fontFaces.splice(0,this.fontFaces.length)}}class tv extends li{constructor(){super(...arguments),this.fontLoader=new Fie,this.editSession=new SK(this),this._fileDropOptions={flavour:this.flavour},this._exportOptions={imageProxyEndpoint:Hm},this._embedBlockRegistry=new Set,this.registerEmbedBlockOptions=e=>{this._embedBlockRegistry.add(e)},this.getEmbedBlockOptions=e=>{const n=this._embedBlockRegistry.entries();for(const[i]of n)if(i.urlRegex.test(e))return i;return null}}get viewportElement(){const e=this.std.view.viewFromPath("block",[this.std.page.root?.id??""]);D(e);const n=e.viewportElement;return D(n),n}unmounted(){this.editSession.dispose()}mounted(){super.mounted(),this.handleEvent("selectionChange",()=>{const e=this.viewportElement;if(!e)return;const n=document.getSelection();if(!n||!n.rangeCount)return;const i=n.getRangeAt(0),r=i.startContainer instanceof Element?i.startContainer:i.startContainer.parentElement;if(!r||r===document.documentElement||r===document.body||r.closest(".blocksuite-overlay"))return;if(!e.contains(r)){this.std.event.deactivate();return}const o=i.endContainer instanceof Element?i.endContainer:i.endContainer.parentElement;if(o){if(!e.contains(o)){this.std.event.deactivate();return}this.std.event.activate()}},{global:!0}),this.std.command.add("getBlockIndex",oD).add("getNextBlock",lD).add("getPrevBlock",hD).add("getSelectedBlocks",pD).add("copySelectedModels",MO).add("deleteSelectedModels",PO).add("getSelectedModels",AO).add("getBlockSelections",$O).add("getImageSelections",BO).add("getTextSelection",DO).add("deleteText",OO).add("formatBlock",RO).add("formatNative",NO).add("formatText",HO).add("withHost",FO),this.loadFonts(),this.fileDropManager=new ps(this,this._fileDropOptions),this.exportManager=new Hie(this,this._exportOptions),this.disposables.addFromEvent(this.std.host,"dragover",this.fileDropManager.onDragOver)}get selectedBlocks(){let e=[];return this.std.command.pipe().withHost().tryAll(n=>[n.getTextSelection(),n.getImageSelections(),n.getBlockSelections()]).getSelectedBlocks().inline(({selectedBlocks:n})=>{n&&(e=n)}).run(),e}get selectedModels(){return this.selectedBlocks.map(e=>e.model)}loadFonts(){this.fontLoader.load(jD)}}async function nv(t,e,n){const i=await Bk(t,e);D(i,"RichText is not ready yet."),await i.updateComplete;const r=i.inlineEditor;D(r,"Inline editor is not ready yet."),r.slots.renderComplete.once(()=>{n&&n(i)})}async function rP(t,e,n){const i=e.page;D(i.root);const r=t.view.viewFromPath("block",[i.root.id]);if(!r)return;await r.updateComplete;const o=t.view.viewFromPath("block",qn(e));o&&n(o)}function iv(t,e,n=50){const{scrollHeight:i,clientHeight:r,scrollTop:o}=t;let s=o;const a=i-r;let l=0,c=!1;return Math.ceil(o)<a&&r-e<n?(l=n-(r-e),c=Math.ceil(s)<a):o>0&&e<n&&(l=e-n,c=s>0),s+=l*.25,c&&o!==s?(t.scrollTop=s,!0):!1}function F6(t,e,n,i,r,o,s){const a=i<800,l=we({maxHeight:`${i}px`,overflowY:a?"scroll":"unset"});return b`
    <div
      class="block-hub-cards-container ${r?"visible":""}"
      style="${l}"
      type=${e}
    >
      <div class="block-hub-cards-title-container">${n}</div>
      ${t.map(({flavour:c,type:d,name:u,description:h,icon:p,tooltip:g},f)=>b`
            <div class="card-container-wrapper">
              <div class="card-container-inner">
                <div
                  class="card-container ${o?"grabbing":""}"
                  draggable="true"
                  affine-flavour=${c}
                  affine-type=${d??""}
                >
                  <div class="card-description-container">
                    <div>${u}</div>
                    <div class="description">${h}</div>
                  </div>
                  <div class="card-icon-container">${p}</div>
                  ${s?b`<affine-tooltip
                        tip-position=${a&&f===t.length-1?"top":"bottom"}
                        >${g}</affine-tooltip
                      >`:null}
                </div>
              </div>
            </div>
          `)}
    </div>
  `}const U6=(t,e,n,i)=>e&&n&&i===t;function Uie(t,e,n,i,r,o){const l=F6(xM,"text","Text block",o,U6("text",t,i,n),e,r),c=F6(_M,"list","List",o,U6("list",t,i,n),e,r),d=F6(xQ,"file","Content & Media",o,U6("file",t,i,n),e,r);return b`
    <div
      class="block-hub-icons-container"
      ?transition=${t}
      style="height: ${t?"230px":"0"};"
    >
      <div
        class="block-hub-icon-container ${e?"grabbing":"grab"}"
        selected=${n==="blank"?"true":"false"}
        type="blank"
        draggable="true"
        affine-flavour="affine:paragraph"
        affine-type="text"
      >
        ${LL}
        ${r?b`<affine-tooltip tip-position="left" .offset=${8}
              >Drag to insert blank line
            </affine-tooltip>`:null}
      </div>
      <div
        class="block-hub-icon-container"
        type="text"
        selected=${n==="text"?"true":"false"}
      >
        ${l} ${hL}
      </div>
      <div
        class="block-hub-icon-container"
        type="list"
        selected=${n==="list"?"true":"false"}
      >
        ${c} ${gL}
      </div>
      <div
        class="block-hub-icon-container"
        type="file"
        selected=${n==="file"?"true":"false"}
      >
        ${d} ${Qd}
      </div>
      <div
        class="block-hub-icon-container"
        type="database"
        draggable="true"
        affine-flavour="affine:database"
        selected=${n==="database"?"true":"false"}
      >
        ${nb}
        ${r?b`<affine-tooltip tip-position="left" .offset=${8}>
              Drag to create a database
            </affine-tooltip>`:null}
      </div>
      <div class="divider"></div>
    </div>
  `}const oP=X`
  affine-block-hub {
    position: absolute;
    z-index: 3;
    user-select: none;
  }

  @media print {
    affine-block-hub {
      display: none;
    }
  }

  .block-hub-cards-container {
    width: 274px;
    position: absolute;
    right: calc(100% + 4px);
    overflow-y: unset;
    display: none;
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
    font-size: var(--affine-font-sm);
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-menu-shadow);
    border-radius: 8px;
  }

  .block-hub-cards-container[type='text'] {
    top: unset;
    bottom: 0;
  }

  .visible {
    display: block;
  }

  .invisible {
    display: none;
  }

  .card-container-wrapper {
    width: 100%;
    display: flex;
    justify-content: center;
    position: relative;
  }

  .card-container {
    display: flex;
    position: relative;
    align-items: center;
    width: 250px;
    height: 54px;
    background: var(--affine-white-80);
    box-shadow: var(--affine-shadow-1);
    border-radius: 8px;
    margin-bottom: 12px;
    cursor: grab;
    top: 0;
    left: 0;
    transition: all 0.1s ease-in-out;
  }

  .card-icon-container {
    display: flex;
    align-items: center;
    position: absolute;
    right: 12px;
  }

  .card-icon-container > svg {
    width: 20px;
    height: 20px;
  }

  .card-container-inner:hover .card-container {
    background: var(--affine-hover-color);
    top: -2px;
    left: -2px;
  }

  .card-container-inner:hover .card-container.grabbing {
    top: unset;
    left: unset;
    box-shadow: var(--affine-shadow-2);
  }

  .card-description-container {
    display: block;
    width: 190px;
    color: var(--affine-text-primary-color);
    font-size: var(--affine-font-base);
    line-height: var(--affine-line-height);
    margin: 8px 0 8px 12px;
    text-align: justify;
  }

  .block-hub-cards-container .description {
    font-size: var(--affine-font-sm);
    line-height: var(--affine-line-height);
    color: var(--affine-text-secondary-color);
    white-space: pre;
  }

  .grabbing {
    cursor: grabbing;
  }

  .grab {
    cursor: grab;
  }

  .block-hub-cards-title-container {
    margin: 16px 0 20px 12px;
    color: var(--affine-text-secondary-color);
    font-size: var(--affine-font-base);
  }

  .prominent {
    z-index: 1;
  }

  .block-hub-menu-container {
    display: flex;
    font-family: ${Je(vt.fontSansFamily)};
    flex-flow: column;
    justify-content: center;
    align-items: center;
    position: fixed;
    width: 44px;
    background: var(--affine-background-primary-color);
    border-radius: 8px;
  }

  .block-hub-menu-container[expanded] {
    box-shadow: var(--affine-menu-shadow);
    background: var(--affine-background-overlay-panel-color);
  }

  .block-hub-icon-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 8px;
    border-radius: 4px;
    color: var(--affine-icon-color);
    height: 36px;
  }

  .block-hub-icon-container svg {
    width: 24px;
    height: 24px;
  }

  .block-hub-icon-container[selected='true'] {
    background: var(--affine-hover-color);
  }

  .block-hub-icon-container:hover {
    background: var(--affine-hover-color);
    border-radius: 4px;
  }

  .new-icon {
    width: 44px;
    height: 44px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    color: var(--affine-icon-color);
  }

  .new-icon-in-edgeless {
    box-shadow: var(--affine-menu-shadow);
  }

  .block-hub-menu-container[expanded] .new-icon {
    border-radius: 4px;
    box-shadow: unset;
  }

  .new-icon:hover {
    box-shadow: var(--affine-menu-shadow);
    background: var(--affine-white);
  }

  .icon-expanded {
    width: 36px;
    height: 36px;
  }

  .icon-expanded:hover {
    background: var(--affine-hover-color);
  }

  .block-hub-icons-container {
    width: 100%;
    overflow: hidden;
    transition: all 0.2s cubic-bezier(0, 0, 0.55, 1.6);
  }

  .block-hub-icons-container > .divider {
    height: 1px;
    width: 36px;
    background: var(--affine-border-color);
    margin: 4px 0;
  }
`;var Vie=Object.defineProperty,zie=Object.getOwnPropertyDescriptor,Lr=(t,e,n,i)=>{for(var r=i>1?void 0:i?zie(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Vie(e,n,r),r};let xi=class extends me(De){constructor(t){super(),this._expanded=!1,this._isGrabbing=!1,this._visibleCardType=null,this._showTooltip=!0,this._maxHeight=2e3,this._currentClientX=0,this._currentClientY=0,this._isCardListVisible=!1,this._lastDroppingTarget=null,this._lastDroppingType="none",this._lastDraggingFlavour=null,this._timer=null,this._rafID=0,this._getHoveringNoteState=e=>{const n={scale:1};if(en(this._editorHost)){const i=a5(this._editorHost,this._pageBlockElement,e);i&&(n.rect=Bi.fromDOMRect(i.getBoundingClientRect()))}else{n.scale=this._pageBlockElement.service.viewport.zoom;const i=Vk(e);i&&(n.rect=Bi.fromDOM(i),n.container=i)}return n},this._onTransitionStart=e=>{this._timer&&clearTimeout(this._timer),this._expanded?(this._blockHubMenuContainer.style.padding="4px",this._timer=window.setTimeout(()=>{this._blockHubIconsContainer.style.overflow="unset"},i_)):(this._blockHubMenuContainer.style.padding="0 4px",this._timer=window.setTimeout(()=>{this._blockHubIconsContainer.style.overflow="hidden"},i_))},this._onBlockHubButtonClick=e=>{this._expanded=!this._expanded,this._expanded||this._hideCardList()},this._onMouseDown=e=>{nh&&(this._currentClientX=e.clientX,this._currentClientY=e.clientY)},this._onDragStart=e=>{this._showTooltip=!1,D(e.dataTransfer),e.dataTransfer.effectAllowed="move";const n=e.target,i={flavour:n.getAttribute("affine-flavour"),type:n.getAttribute("affine-type")??void 0};e.dataTransfer.setData("affine/block-hub",JSON.stringify(i)),this._lastDraggingFlavour=i.flavour,this._pageBlockElement.selection.clear()},this._onDrag=e=>{this._hideCardList();let n=e.clientX,i=e.clientY;if(nh&&(n=this._currentClientX,i=this._currentClientY),!this._indicator||this._indicator.rect&&this._indicator.rect.left===n&&this._indicator.rect.top===i)return;const r=new je(n,i),{container:o,rect:s,scale:a}=this._getHoveringNoteState(r.clone());if(!s){this._resetDropState();return}let l=null;if(l=Fg(r,{container:o,rect:s,snapToEdge:{x:!1,y:!0}},a),!l){const{min:f,max:v}=s;if(n>=f.x&&n<=v.x&&i>=f.y){const m=this._pageBlockElement.model.lastChild();m&&(l=this._editorHost.view.viewFromPath("block",[m.id]))}}if(!l){this._resetDropState();return}let c="none",d=null,u=null;const h=Zl(l),p=Zk(r,h,l,[],a,this._lastDraggingFlavour);p&&(c=p.type,d=p.rect,u=p.modelState);const g=()=>{if(this._pageBlockElement instanceof Kl){if(!iv(this._pageBlockElement.viewportElement,r.y)){this._clearRaf();return}this._rafID=requestAnimationFrame(g)}else this._clearRaf()};this._rafID=requestAnimationFrame(g),this._lastDroppingType=c,this._indicator.rect=d,this._lastDroppingTarget=u},this._onDragOver=e=>(e.preventDefault(),!1),this._onDragOverDocument=e=>{if(!nh)throw new Error("FireFox only");this._currentClientX=e.clientX,this._currentClientY=e.clientY},this._onDragEnd=e=>{this._showTooltip=!0,this._isGrabbing=!1,this._lastDraggingFlavour=null,this._resetDropState()},this._resetDropState=()=>{this._lastDroppingType="none",this._indicator.rect=null,this._lastDroppingTarget=null},this._onDrop=async e=>{if(D(e.dataTransfer),!e.dataTransfer.getData("affine/block-hub"))return;const n=this._editorHost.page,i=this._indicator?.rect?.min??new je(e.clientX,e.clientY),r=this._lastDroppingTarget,o=this._lastDroppingType,s=e.dataTransfer;D(s);const a=s.getData("affine/block-hub"),l=[],c=JSON.parse(a),d=c.flavour==="affine:database";if(c.flavour==="affine:image"&&c.type==="image"&&r&&o!=="none"&&o!=="database"){const f=await R2(),v=this._editorHost.spec.getService("affine:image");D(v),Cs(v,hd);const m=v.maxFileSize;Qb(this._editorHost,f,m,r.model)}else if(c.flavour==="affine:bookmark"){if(r&&o!=="none"&&o!=="database"){const f=r.model,v=n.getParent(f);D(v);const m=v.children.indexOf(f)+(o==="after"?1:0);await yo(this._editorHost,"Links","The added link will be displayed as a card view.",{mode:"page",parentModel:v,index:m})}}else l.push(c);if(!l.length)return;let u,h;if(r&&o!=="none"){const{model:f}=r;if(n.captureSync(),o==="database")h=n.addBlocks(l,f)[0],u=f;else{const v=n.getParent(f);D(v),h=n.addSiblingBlocks(f,l,o)[0],u=v}d&&(this._pageBlockElement.std.spec?.getService("affine:database")).initDatabaseBlock(n,f,f.id,"table")}if(en(this._editorHost)){h&&$n(this._editorHost,n,h)?.catch(console.error);return}const p=this._pageBlockElement;let g;if(h&&u){const f=this._editorHost.view.viewFromPath("block",qn(u));D(f),g=f.model.id}else{const f=p.addNewNote(l,i,d?{width:752}:void 0);g=f.noteId,h=f.ids[0];const v=n.getBlockById(h);D(v),d&&(p.std.spec?.getService("affine:database")).initDatabaseBlock(n,v,v.id,"table")}p.setSelection(g,!0,h,i)},this._onClickCard=async(e,n)=>{const i=n.getAttribute("affine-type");D(i);const r={flavour:n.getAttribute("affine-flavour")??"",type:i??void 0},o=this._editorHost.page,s=[],a=o.root?.children.findLast(c=>c.flavour==="affine:note")??o.addBlock("affine:note",{},o.root?.id);let l;if(r.flavour==="affine:image"&&r.type==="image"){const c=await R2(),d=this._editorHost.spec.getService("affine:image");D(d),Cs(d,hd);const u=d.maxFileSize,h=gie(this._editorHost,c,u,o,a);l=h[h.length-1]}else r.flavour==="affine:bookmark"?await yo(this._editorHost,"Links","The added link will be displayed as a card view.",{mode:"page",parentModel:a}):s.push(r);s.forEach(c=>{l=o.addBlock(c.flavour??"affine:paragraph",c,a)}),l&&await $n(this._editorHost,o,l)},this._onClickOutside=e=>{const n=e.target;n instanceof HTMLElement&&!n.closest("affine-block-hub")&&this._hideCardList()},this._onCardMouseDown=e=>{this._isGrabbing=!0},this._onCardMouseUp=e=>{this._isGrabbing=!1},this._onBlankMenuMouseDown=()=>{this._isGrabbing=!0},this._onBlankMenuMouseUp=()=>{this._isGrabbing=!1},this._onBlockHubMenuMouseOver=e=>{const i=e.currentTarget.getAttribute("type");D(i),this._isCardListVisible=!0,this._visibleCardType=i},this._onBlockHubEntryMouseOver=()=>{this._isCardListVisible=!1},this._onResize=()=>{const e=document.body.getBoundingClientRect();this._maxHeight=e.height-wQ-r_},this._editorHost=t}connectedCallback(){super.connectedCallback();const t=this._disposables;t.addFromEvent(this,"dragstart",this._onDragStart),t.addFromEvent(this,"drag",this._onDrag),t.addFromEvent(this,"dragend",this._onDragEnd),t.addFromEvent(this._editorHost,"dragover",this._onDragOver),t.addFromEvent(this._editorHost,"drop",e=>{this._onDrop(e).catch(console.error)}),t.addFromEvent(this,"mousedown",this._onMouseDown),nh&&t.addFromEvent(this._editorHost,"dragover",this._onDragOverDocument),this._onResize()}firstUpdated(){const t=this._disposables;this._blockHubCards.forEach(e=>{t.addFromEvent(e,"mousedown",this._onCardMouseDown),t.addFromEvent(e,"mouseup",this._onCardMouseUp),t.addFromEvent(e,"click",n=>{this._onClickCard(n,e).catch(console.error)})});for(const e of this._blockHubMenus)t.addFromEvent(e,"mouseover",this._onBlockHubMenuMouseOver),e.getAttribute("type")==="blank"&&(t.addFromEvent(e,"mousedown",this._onBlankMenuMouseDown),t.addFromEvent(e,"mouseup",this._onBlankMenuMouseUp));t.addFromEvent(this._blockHubMenuEntry,"mouseover",this._onBlockHubEntryMouseOver),t.addFromEvent(document,"click",this._onClickOutside),t.addFromEvent(this._blockHubButton,"click",this._onBlockHubButtonClick),t.addFromEvent(this._blockHubButton,"mousedown",e=>{e.preventDefault()}),t.addFromEvent(this._blockHubIconsContainer,"transitionstart",this._onTransitionStart),t.addFromEvent(window,"resize",this._onResize),this._indicator=document.querySelector("affine-drag-indicator"),this._indicator||(this._indicator=document.createElement("affine-drag-indicator"),document.body.appendChild(this._indicator))}disconnectedCallback(){super.disconnectedCallback(),this._disposables.dispose()}toggleMenu(){this._expanded=!this._expanded,this._expanded||this._hideCardList()}get _pageBlockElement(){return en(this._editorHost)?Ak(this._editorHost):$k(this._editorHost)}_hideCardList(){this._visibleCardType&&(this._visibleCardType=null,this._isCardListVisible=!1)}_clearRaf(){this._rafID&&(cancelAnimationFrame(this._rafID),this._rafID=0)}render(){const t=Uie(this._expanded,this._isGrabbing,this._visibleCardType,this._isCardListVisible,this._showTooltip,this._maxHeight),e=Qe({"icon-expanded":this._expanded,"new-icon-in-edgeless":!en(this._editorHost)&&!this._expanded,"new-icon":!0});return b`
      <div
        class="block-hub-menu-container blocksuite-overlay"
        @pointerdown=${at}
        ?expanded=${this._expanded}
        style="bottom: ${r_}px; right: ${yQ}px;"
      >
        ${t}
        <div class=${e} role="menuitem" style="cursor:pointer;">
          ${this._expanded?Xd:[IL,b`<affine-tooltip tip-position="left"
                  >Insert blocks</affine-tooltip
                >`]}
        </div>
      </div>
    `}};xi.styles=oP;Lr([ie()],xi.prototype,"_expanded",2);Lr([ie()],xi.prototype,"_isGrabbing",2);Lr([ie()],xi.prototype,"_visibleCardType",2);Lr([ie()],xi.prototype,"_showTooltip",2);Lr([ie()],xi.prototype,"_maxHeight",2);Lr([Gm(".card-container")],xi.prototype,"_blockHubCards",2);Lr([Gm(".block-hub-icon-container[type]")],xi.prototype,"_blockHubMenus",2);Lr([he(".new-icon")],xi.prototype,"_blockHubButton",2);Lr([he(".block-hub-icons-container")],xi.prototype,"_blockHubIconsContainer",2);Lr([he(".block-hub-menu-container")],xi.prototype,"_blockHubMenuContainer",2);Lr([he('[role="menuitem"]')],xi.prototype,"_blockHubMenuEntry",2);xi=Lr([W("affine-block-hub")],xi);var jie=Object.defineProperty,Gie=Object.getOwnPropertyDescriptor,Zie=(t,e,n,i)=>{for(var r=i>1?void 0:i?Gie(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&jie(e,n,r),r};const Wie="affine-block-hub-widget";let u5=class extends to{connectedCallback(){super.connectedCallback();const t=new xi(this.host);document.body.appendChild(t),this.disposables.add(()=>t.remove())}};u5.styles=oP;u5=Zie([W(Wie)],u5);var qie=Object.defineProperty,Yie=Object.getOwnPropertyDescriptor,sP=(t,e,n,i)=>{for(var r=i>1?void 0:i?Yie(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qie(e,n,r),r};const $8="affine-doc-dragging-area-widget";let fd=class extends to{constructor(){super(...arguments),this.rect=null,this._rafID=0,this._lastPointerState=null,this._dragging=!1,this._initialScrollOffset={top:0,left:0},this._initialContainerOffset={x:0,y:0},this._updateDraggingArea=(t,e)=>{const{x:n,y:i}=t,{x:r,y:o}=t.start,{left:s,top:a}=this._initialScrollOffset,{scrollLeft:l,scrollTop:c,scrollWidth:d,scrollHeight:u}=this._viewport,{x:h,y:p}=this._initialContainerOffset,{x:g,y:f}=t.containerOffset,{left:v,top:m}=this._viewport;let y=Math.min(r+s+h-v,n+l+g-v),x=Math.max(r+s+h-v,n+l+g-v),T=Math.min(o+a+p-m,i+c+f-m),M=Math.max(o+a+p-m,i+c+f-m);y=Math.max(y,g-v),x=Math.min(x,d),T=Math.max(T,f-m),M=Math.min(M,u);const k={left:y,top:T,width:x-y,height:M-T};if(this.rect=k,this._selectBlocksByRect({left:k.left+v,top:k.top+m,width:k.width,height:k.height}),this._lastPointerState=t,e&&!iv(this._viewportElement,t.raw.y)){this._clearRaf();return}}}get _viewportElement(){const t=this.blockElement;return D(t),t.viewportElement}get _viewport(){const t=this.blockElement;return D(t),t.viewport}get _allBlocksWithRect(){const{scrollLeft:t,scrollTop:e}=this._viewport;return(()=>{const r=[];return this.host.view.walkThrough(o=>{const s=o.view;if(!(s instanceof wn))return!0;s.model.role!=="root"&&!fd.excludeFlavours.includes(s.model.flavour)&&r.push(s)}),r})().map(r=>{const o=r.getBoundingClientRect();return{element:r,rect:{left:o.left+t,top:o.top+e,width:o.width,height:o.height}}})}_selectBlocksByRect(t){const e=Jie(this._allBlocksWithRect,t).map(n=>this.host.selection.create("block",{path:n}));this.host.selection.setGroup("note",e)}_clearRaf(){this._rafID&&(cancelAnimationFrame(this._rafID),this._rafID=0)}connectedCallback(){super.connectedCallback(),this.handleEvent("dragStart",t=>{const e=t.get("pointerState"),{button:n}=e.raw;if(n===0&&ere(e)){this._dragging=!0;const{scrollLeft:i,scrollTop:r}=this._viewport;return this._initialScrollOffset={left:i,top:r},this._initialContainerOffset={x:e.containerOffset.x,y:e.containerOffset.y},!0}},{global:!0}),this.handleEvent("dragMove",t=>{if(this._clearRaf(),!this._dragging)return;t.get("defaultState").event.preventDefault();const e=t.get("pointerState");return this._rafID=requestAnimationFrame(()=>{this._updateDraggingArea(e,!0)}),!0},{global:!0}),this.handleEvent("dragEnd",()=>{this._clearRaf(),this._dragging=!1,this.rect=null,this._initialScrollOffset={top:0,left:0},this._initialContainerOffset={x:0,y:0},this._lastPointerState=null},{global:!0}),this.handleEvent("pointerMove",t=>{this._dragging&&t.get("pointerState").raw.preventDefault()},{global:!0})}firstUpdated(){this._disposables.addFromEvent(this._viewportElement,"scroll",()=>{if(!this._dragging||!this._lastPointerState)return;const t=this._lastPointerState;this._rafID=requestAnimationFrame(()=>{this._updateDraggingArea(t,!1)})})}disconnectedCallback(){this._clearRaf(),this._disposables.dispose(),super.disconnectedCallback()}render(){const t=this.rect;if(!t)return ae;const e={left:t.left+"px",top:t.top+"px",width:t.width+"px",height:t.height+"px"};return b`
      <style>
        .affine-page-dragging-area {
          position: absolute;
          background: var(--affine-hover-color);
          z-index: 1;
          pointer-events: none;
        }
      </style>
      <div class="affine-page-dragging-area" style=${we(e)}></div>
    `}};fd.excludeFlavours=["affine:note","affine:surface"];sP([ie()],fd.prototype,"rect",2);fd=sP([W($8)],fd);function h5(t,e){return t.left<e.left+e.width&&t.left+t.width>e.left&&t.top<e.top+e.height&&t.top+t.height>e.top}function Xie(t,e){return t.top<=e.top&&t.top+t.height>=e.top+e.height}function Kie(t,e){const n=[];for(const i of t){const r=i.rect;if(e.top+e.height<r.top)break;n.push(i)}return n}function Qie(t,e,n){const i=t.element;let r=[t];if(i.childElementCount>0){const o=i.childBlockElements.map(l=>n.find(c=>c.element.model.id===l.model.id)).filter(l=>l),s=o.findIndex(l=>h5(l.rect,e)&&l.rect.top<e.top),a=o.findIndex(l=>h5(l.rect,e)&&l.rect.top+l.rect.height>e.top+e.height);s!==-1&&a!==-1&&(r=o.slice(s,a+1))}return r}function Jie(t,e){const n=Kie(t,e),i=n.length,r=[];let o=null,s=[];if(i===0)return r;for(const a of n){const l=a.rect;h5(e,l)&&Xie(l,e)&&(o=a)}if(o)s=Qie(o,e,n);else for(const a of n)h5(e,a.rect)&&s.push(a);for(let a=0;a<s.length;a++){const l=s[a].element.parentPath.join("|");s.some(d=>d.element.path.join("|")===l)||r.push(s[a].element.path)}return r}function ere(t){const e=t.raw.target;Cs(e,Element);const n=e.closest(`[${lr}]`);return n&&Ie(n.model,["affine:page","affine:note"])}class tre{constructor(e){this._originalArray=[...e],this._copyArray=[...e]}randomIndex(e){return Math.floor(Math.random()*e)}pick(){this._copyArray.length===0&&(this._copyArray=[...this._originalArray]);const e=this.randomIndex(this._copyArray.length),n=this._copyArray[e];return this._copyArray.splice(e,1),n}}const R_=new tre(["var(--affine-multi-players-purple)","var(--affine-multi-players-magenta)","var(--affine-multi-players-red)","var(--affine-multi-players-orange)","var(--affine-multi-players-green)","var(--affine-multi-players-blue)","var(--affine-multi-players-brown)","var(--affine-multi-players-grey)"]);class aP{constructor(e){this.host=e;const n=this.pageService.editSession.getItem("remoteColor");if(n){this.awareness.awareness.setLocalStateField("color",n);return}const i=R_.pick();this.awareness.awareness.setLocalStateField("color",i),this.pageService.editSession.setItem("remoteColor",i)}get awareness(){return this.host.page.workspace.awarenessStore}get pageService(){return this.host.spec.getService("affine:page")}get(e){const n=this.awareness.getStates().get(e)?.color;if(n)return n;if(e!==this.awareness.awareness.clientID)return null;const i=this.pageService.editSession.getItem("remoteColor");if(i)return this.awareness.awareness.setLocalStateField("color",i),i;const r=R_.pick();return this.awareness.awareness.setLocalStateField("color",r),this.pageService.editSession.setItem("remoteColor",r),r}}function sp(t){return t.tagName==="AFFINE-DOC-PAGE"||t.tagName==="AFFINE-EDGELESS-PAGE"}function nre(t,e){return we({position:"absolute",width:`${t.width}px`,height:`${t.height}px`,top:`${t.top}px`,left:`${t.left}px`,backgroundColor:e,pointerEvent:"none",opacity:"20%",borderRadius:"3px"})}function ire(t,e){return we({position:"absolute",width:`${t.width}px`,height:`${t.height}px`,top:`${t.top}px`,left:`${t.left}px`,backgroundColor:e,pointerEvent:"none"})}function rre(t,e){return t.left<=e.left&&t.top<=e.top&&t.left+t.width>=e.left+e.width&&t.top+t.height>=e.top+e.height}function N_(t,e){return t.left<=e.left+e.width&&t.left+t.width>=e.left&&t.top<=e.top+e.height&&t.top+t.height>=e.top}function H_(t,e){const n=Math.min(t.left,e.left),i=Math.min(t.top,e.top),r=Math.max(t.left+t.width,e.left+e.width),o=Math.max(t.top+t.height,e.top+e.height);return{left:n,top:i,width:r-n,height:o-i}}function ore(t){let e=[],n;do{n=!1;const i=[...e];for(const r of t){let o=!1;for(let s=0;s<i.length;s++)if(rre(i[s],r)){o=!0;break}else if(N_(i[s],r)){i[s]=H_(i[s],r),o=!0,n=!0;break}o||i.push(r)}if(!n){for(let r=0;r<i.length;r++)for(let o=r+1;o<i.length;o++)if(N_(i[r],i[o])){i[r]=H_(i[r],i[o]),i.splice(o,1),n=!0;break}}e=i}while(n);return e}var sre=Object.defineProperty,are=Object.getOwnPropertyDescriptor,lre=(t,e,n,i)=>{for(var r=i>1?void 0:i?are(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&sre(e,n,r),r};const ap="affine-doc-remote-selection-widget";let ac=class extends to{constructor(){super(...arguments),this._remoteColorManager=null,this._remoteSelections=[],this._resizeObserver=new ResizeObserver(()=>{this.requestUpdate()}),this._abortController=new AbortController}get _selectionManager(){return this.host.selection}get _container(){return this.offsetParent}get _containerRect(){return this.offsetParent?.getBoundingClientRect()}connectedCallback(){super.connectedCallback(),ac.enable&&(this.disposables.add(this._selectionManager.slots.remoteChanged.on(Vd(t=>{const e=this.page.awarenessStore.getStates();this._remoteSelections=[...t.entries()].map(([n,i])=>({id:n,selections:i,user:e.get(n)?.user})),this.requestUpdate()},100))),this.handleEvent("wheel",()=>{this.requestUpdate()}),this.disposables.addFromEvent(window,"resize",()=>{this.requestUpdate()}),this._remoteColorManager=new aP(this.host))}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver.disconnect(),this._abortController.abort()}_getSelectionRect(t){if(!sp(this.blockElement))throw new Error("remote selection widget must be used in page component");const e=t.find(o=>o instanceof jy),n=t.filter(o=>o instanceof Gy),i=this._container,r=this._containerRect;if(e){const o=this.host.rangeManager;D(o);const s=o.textSelectionToRange(e);if(s){const l=Array.from(s.getClientRects()).map(c=>({width:c.right-c.left,height:c.bottom-c.top,top:c.top-(r?.top??0)+(i?.scrollTop??0),left:c.left-(r?.left??0)+(i?.scrollLeft??0)})).filter(c=>c.width>0&&c.height>0);return ore(l)}}else if(n.length>0)return n.flatMap(o=>{const s=this.host.view.viewFromPath("block",o.path);if(s){const a=s.getBoundingClientRect();return{width:a.width,height:a.height,top:a.top-(r?.top??0)+(i?.scrollTop??0),left:a.left-(r?.left??0)+(i?.scrollLeft??0)}}return[]});return[]}_getCursorRect(t){if(!sp(this.blockElement))throw new Error("remote selection widget must be used in page component");const e=t.find(o=>o instanceof jy),n=t.filter(o=>o instanceof Gy),i=this._container,r=this._containerRect;if(e){const o=this.host.rangeManager;D(o);const s=o.textSelectionToRange(this._selectionManager.create("text",{from:{path:e.to?e.to.path:e.from.path,index:e.to?e.to.index+e.to.length:e.from.index+e.from.length,length:0},to:null}));if(!s)return null;const a=this._container,l=this._containerRect,c=Array.from(s.getClientRects());if(c.length===1){const d=c[0];return{width:2,height:d.height,top:d.top-(l?.top??0)+(a?.scrollTop??0),left:d.left-(l?.left??0)+(a?.scrollLeft??0)}}}else if(n.length>0){const o=n[n.length-1],s=this.host.view.viewFromPath("block",o.path);if(s){const a=s.getBoundingClientRect();return{width:2,height:a.height,top:a.top-(r?.top??0)+(i?.scrollTop??0),left:a.left+a.width-(r?.left??0)+(i?.scrollLeft??0)}}}return null}render(){if(this._remoteSelections.length===0||!ac.enable)return ae;const t=new Set,e=this._remoteSelections.flatMap(({selections:i,id:r,user:o})=>t.has(r)?[]:(t.add(r),{id:r,selections:i,rects:this._getSelectionRect(i),user:o})),n=this._remoteColorManager;return D(n),b`<div>
      ${e.flatMap(i=>{const r=n.get(i.id);if(!r)return;const o=this._getCursorRect(i.selections);return i.rects.map(s=>b`<div style="${nre(s,r)}"></div>`).concat([b`
              <div
                style="${o?ire(o,r):we({display:"none"})}"
              >
                <div
                  style="${we({position:"relative",height:"100%"})}"
                >
                  <div
                    style="${we({position:"absolute",left:"-4px",bottom:`${o?.height?o.height-4:0}px`,backgroundColor:r,color:"white",maxWidth:"160px",padding:"0 3px",border:"1px solid var(--affine-pure-black-20)",boxShadow:"0px 1px 6px 0px rgba(0, 0, 0, 0.16)",borderRadius:"4px",fontSize:"12px",lineHeight:"18px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})}"
                  >
                    ${i.user?.name??"Unknown"}
                  </div>
                </div>
              </div>
            `])})}
    </div>`}};ac.styles=X`
    :host {
      pointer-events: none;
    }
  `;ac.enable=!0;ac=lre([W(ap)],ac);var cre=Object.defineProperty,dre=Object.getOwnPropertyDescriptor,ure=(t,e,n,i)=>{for(var r=i>1?void 0:i?dre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&cre(e,n,r),r};let p5=class extends De{constructor(t){super(),this.offset=t??new je(0,0)}render(){return b`<style>
      affine-drag-preview {
        box-sizing: border-box;
        position: absolute;
        display: block;
        height: auto;
        font-family: ${vt.fontSansFamily};
        font-size: var(--affine-font-base);
        line-height: var(--affine-line-height);
        color: var(--affine-text-primary-color);
        font-weight: 400;
        top: 0;
        left: 0;
        transform-origin: 0 0;
        opacity: 0.5;
        user-select: none;
        pointer-events: none;
        caret-color: transparent;
        z-index: 3;
      }

      .affine-drag-preview-grabbing * {
        cursor: grabbing !important;
      }
    </style>`}};p5=ure([W("affine-drag-preview")],p5);var hre=Object.defineProperty,pre=Object.getOwnPropertyDescriptor,lP=(t,e,n,i)=>{for(var r=i>1?void 0:i?pre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&hre(e,n,r),r};let lp=class extends Ae{constructor(){super(...arguments),this.rect=null}render(){if(!this.rect)return null;const{left:t,top:e,width:n,height:i}=this.rect,r=we({width:`${n}px`,height:`${i}px`,top:`${e}px`,left:`${t}px`});return b`<div class="affine-drop-indicator" style=${r}></div>`}};lp.styles=X`
    .affine-drop-indicator {
      position: absolute;
      top: 0;
      left: 0;
      background: var(--affine-primary-color);
      transition-property: height, transform;
      transition-duration: 100ms;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0s;
      transform-origin: 0 0;
      pointer-events: none;
      z-index: 2;
    }
  `;lP([L({attribute:!1})],lp.prototype,"rect",2);lp=lP([W("affine-drop-indicator")],lp);const fre=X`
  .affine-drag-handle-widget {
    display: flex;
    position: absolute;
    left: 0;
    top: 0;
    contain: size layout;
  }

  .affine-drag-handle-container {
    top: 0;
    left: 0;
    position: absolute;
    display: flex;
    justify-content: center;
    width: ${h2}px;
    min-height: 12px;
    pointer-events: auto;
    user-select: none;
    box-sizing: border-box;
  }
  .affine-drag-handle-grabber {
    width: 4px;
    height: 100%;
    border-radius: 1px;
    background: var(--affine-placeholder-color);
    transition: width 0.25s ease;
  }
  .affine-drag-handle-container:hover {
    cursor: grab;
  }
  @media print {
    .affine-drag-handle-widget {
      display: none;
    }
  }
  .affine-drag-hover-rect {
    position: absolute;
    top: 0;
    left: 0;
    border-radius: 6px;
    background: var(--affine-hover-color);
    pointer-events: none;
    z-index: 2;
    animation: expand 0.25s forwards;
  }
  @keyframes expand {
    0% {
      width: 0;
      height: 0;
    }
  }
`;var gre=Object.defineProperty,mre=Object.getOwnPropertyDescriptor,z3=(t,e,n,i)=>{for(var r=i>1?void 0:i?mre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&gre(e,n,r),r};const wr="affine-drag-handle-widget";let ri=class extends to{constructor(){super(...arguments),this.draggingElements=[],this.dropBlockId="",this.dropType=null,this.dragging=!1,this.dragPreview=null,this.dropIndicator=null,this.lastDragPointerState=null,this.scale=1,this.noteScale=1,this.center=[0,0],this.rafID=0,this._dragHoverRect=null,this._lastHoveredBlockPath=null,this._lastShowedBlock=null,this._isHoverDragHandleVisible=!1,this._isDragHandleHovered=!1,this._isTopLevelDragHandleVisible=!1,this._anchorBlockId="",this._anchorBlockPath=null,this._anchorModelDisposables=null,this._getDropResult=t=>{const e=new je(t.raw.x,t.raw.y),n=m_(this.host,this.pageBlockElement,e);if(!n)return null;const i=n.model.id,r=n.path,o=n.model;if(Ie(o,["affine:database"]))return null;const a=this.draggingElements.length===1&&Ie(this.draggingElements[0].model,["affine:note"]);if(a){const h=this._getBlockElementFromViewStore(gt.parent(n.path));if(!h||!Ie(h.model,["affine:note"]))return null}if(Tf(this.draggingElements.map(h=>h.model.id),i)||eee(this.draggingElements,r))return null;let l=null,c="before";const d=TM(e,o,n,this.draggingElements,this.scale);return d&&(l=d.rect,c=d.dropType),a&&c==="in"?null:{rect:l,dropBlockId:i,dropType:c}},this._updateDropResult=t=>{if(D(this.dropIndicator),this.dropBlockId=t?.dropBlockId??"",this.dropType=t?.dropType??null,t?.rect){const{left:e,top:n,scrollLeft:i,scrollTop:r}=this.pageBlockElement.viewport;let{left:o,top:s}=t.rect;o+=i-e,s+=r-n;const{width:a,height:l}=t.rect,c=Bi.fromLWTH(o,a,s,l);this.dropIndicator.rect=c}else this.dropIndicator.rect=t?.rect??null},this._resetDropResult=()=>{this.dropBlockId="",this.dropType=null,this.dropIndicator&&(this.dropIndicator.rect=null)},this._createDropIndicator=()=>{this.dropIndicator||(this.dropIndicator=new lp,this.pageBlockElement.append(this.dropIndicator))},this._updateDropIndicator=(t,e=!1)=>{const n=new je(t.raw.x,t.raw.y),i=a5(this.host,this.pageBlockElement,n);if(!i||g_(this.host,i,n,this.scale))this._resetDropResult();else{const r=this._getDropResult(t);this._updateDropResult(r)}if(this.lastDragPointerState=t,this.pageBlockElement instanceof Kl){if(!e)return;if(!iv(this.pageBlockElement.viewportElement,t.raw.y)){this._clearRaf();return}this.rafID=requestAnimationFrame(()=>this._updateDropIndicator(t,!0))}else this._clearRaf()},this._updateDropIndicatorOnScroll=()=>{if(!this.dragging||this.draggingElements.length===0||!this.lastDragPointerState)return;const t=this.lastDragPointerState;this.rafID=requestAnimationFrame(()=>this._updateDropIndicator(t,!1))},this._removeDropIndicator=()=>{this.dropIndicator&&(this.dropIndicator.remove(),this.dropIndicator=null)},this._calculatePreviewOffset=(t,e)=>{const{top:n,left:i}=t[0].getBoundingClientRect();return new je(e.raw.x-i,e.raw.y-n)},this._createDragPreview=(t,e,n,i)=>{let r;if(n)r=new p5(i),r.appendChild(n);else{const o=document.createDocumentFragment();let s=0;t.forEach(d=>{s=Math.max(s,d.getBoundingClientRect().width);const u=document.createElement("div");Qa(this.host.renderModel(d.model),u),o.appendChild(u)});const a=this._calculatePreviewOffset(t,e),l=e.raw.x-a.x,c=e.raw.y-a.y;r=new p5(a),r.style.width=`${s/this.scale}px`,r.style.transform=`translate(${l}px, ${c}px) scale(${this.scale*this.noteScale})`,r.appendChild(o)}return this.pageBlockElement.appendChild(r),r},this._updateDragPreviewPosition=t=>{if(!this.dragPreview)return;const e=this.pageBlockElement,{left:n,top:i,scrollLeft:r,scrollTop:o,scrollWidth:s,scrollHeight:a}=e.viewport,l=this.dragPreview.offset,{width:c,height:d}=this.dragPreview.getBoundingClientRect();let u=t.raw.x-l.x-n+r;u<0?u=0:u+c>s&&(u=s-c);let h=t.raw.y-l.y-i+o;h<0?h=0:h+d>a&&(h=a-d),this.dragPreview.style.transform=`translate(${u}px, ${h}px) scale(${this.scale*this.noteScale})`},this._updateDragPreviewOnViewportUpdate=()=>{this.dragPreview&&this.lastDragPointerState&&this._updateDragPreviewPosition(this.lastDragPointerState)},this._removeDragPreview=()=>{this.dragPreview&&(this.dragPreview.remove(),this.dragPreview=null)},this._changeCursorToGrabbing=()=>{document.documentElement.classList.add("affine-drag-preview-grabbing")},this._resetCursor=()=>{document.documentElement.classList.remove("affine-drag-preview-grabbing")},this._startDragging=(t,e,n,i)=>{t.length&&(this.draggingElements=t,this.dragPreview&&this._removeDragPreview(),this.dragPreview=this._createDragPreview(t,e,n,i),this.dragging=!0,this._changeCursorToGrabbing(),this._createDropIndicator(),this._hide())},this._hide=(t=!1)=>{y_(),this._isHoverDragHandleVisible=!1,this._isTopLevelDragHandleVisible=!1,this._isDragHandleHovered=!1,this._anchorBlockId="",this._anchorBlockPath=null,this._dragHandleContainer&&(this._dragHandleContainer.style.display="none"),t&&this._reset()},this._reset=()=>{this.draggingElements=[],this.dropBlockId="",this.dropType=null,this.lastDragPointerState=null,this.rafID=0,this.dragging=!1,this._dragHoverRect=null,this._lastHoveredBlockPath=null,this._lastShowedBlock=null,this._anchorBlockId="",this._anchorBlockPath=null,this._isHoverDragHandleVisible=!1,this._isDragHandleHovered=!1,this._isTopLevelDragHandleVisible=!1,this._removeDragPreview(),this._removeDropIndicator(),this._resetCursor()},this._handleAnchorModelDisposables=t=>{this._anchorModelDisposables&&(this._anchorModelDisposables.dispose(),this._anchorModelDisposables=null),this._anchorModelDisposables=new dt,this._anchorModelDisposables.add(t.propsUpdated.on(()=>this._hide())),this._anchorModelDisposables.add(t.deleted.on(()=>this._hide()))},this._getBlockElementFromViewStore=t=>this.host.view.viewFromPath("block",t),this._getTopWithBlockElement=t=>{const e=getComputedStyle(t),{top:n}=t.getBoundingClientRect(),i=parseInt(e.paddingTop)*this.scale;return n+i+this._viewportOffset.top},this._isBlockSelected=t=>t?this.selectedBlocks.some(e=>e.blockId===t.model.id):!1,this._showDragHandleOnHoverBlock=t=>{const e=this._getBlockElementFromViewStore(t);D(e);const n=this._dragHandleContainer,i=this._dragHandleGrabber;if(!n||!i)return;let{left:r}=e.getBoundingClientRect();const o=this._getDraggingAreaRect(e),s=getComputedStyle(e),a=parseInt(s.paddingLeft)*this.scale;r+=a;const l=JJ(e.model);y_([e]);const c=b_([e]),d=r-(h2+c)*this.scale*this.noteScale+this._viewportOffset.left,u=this._getTopWithBlockElement(e),p=(l-h_)/2*this.scale*this.noteScale+u-o.top,g=o.height-p-h_*this.scale*this.noteScale,f=v=>{n.style.transition=v?"padding 0.25s ease":"none",n.style.paddingTop=`${p}px`,n.style.paddingBottom=`${g}px`,n.style.width=`${h2*this.scale*this.noteScale}px`,n.style.left=`${d}px`,n.style.top=`${o.top}px`,n.style.display="flex",n.style.height=`${o.height}px`};L6(e.path,this._lastShowedBlock?.path)?f(!0):this.selectedBlocks.length&&this._isBlockSelected(e)?f(this._isDragHandleHovered&&this._isBlockSelected(this._lastShowedBlock?.el)):f(!1),i.style.width=`${qJ*this.scale*this.noteScale}px`,i.style.borderRadius=`${E6*this.scale*this.noteScale}px`,this._handleAnchorModelDisposables(e.model),L6(e.path,this._lastShowedBlock?.path)||(this._lastShowedBlock={path:e.path,el:e}),this._isHoverDragHandleVisible=!0},this._showDragHandleOnTopLevelBlocks=async()=>{if(en(this.host))return;const t=this.pageBlockElement;if(await t.surface.updateComplete,!this._anchorBlockPath)return;const e=this.anchorBlockElement;D(e);const n=t.service.getElementById(e.model.id);D(n);const i=this._dragHandleContainer,r=this._dragHandleGrabber;if(!i||!r)return;const o=ec([n]),[s,a]=t.service.viewport.toViewCoord(o.left,o.top),l=o.height*this.scale,c=s-(k6+u_)*this.scale,d=a;i.style.transition="none",i.style.paddingTop="0px",i.style.paddingBottom="0px",i.style.width=`${k6*this.scale}px`,i.style.left=`${c}px`,i.style.top=`${d}px`,i.style.display="flex",i.style.height=`${l}px`,r.style.width=`${p_*this.scale}px`,r.style.borderRadius=`${E6*this.scale}px`,this._handleAnchorModelDisposables(e.model),this._isTopLevelDragHandleVisible=!0},this._getHoveredBlocks=()=>{if(!this._isHoverDragHandleVisible||!this._anchorBlockPath)return[];const t=this.anchorBlockElement;D(t);const e=this.selectedBlocks;let n=[];if(e.length>0&&I6(e)){const i=zg();n=this._rangeManager.getSelectedBlockElementsByRange(i,{match:r=>r.model.role==="content",mode:"highest"})}else n=this.selectedBlocks.map(i=>this._getBlockElementFromViewStore(i.path)).filter(i=>!!i);return Tf(n.map(i=>gt.id(i.path)),gt.id(this._anchorBlockPath))?n:[t]},this._getDraggingAreaRect=t=>{let{left:e,top:n,right:i,bottom:r}=t.getBoundingClientRect();const o=this._getHoveredBlocks();o.forEach(a=>{e=Math.min(e,a.getBoundingClientRect().left),n=Math.min(n,a.getBoundingClientRect().top),i=Math.max(i,a.getBoundingClientRect().right),r=Math.max(r,a.getBoundingClientRect().bottom)});const s=b_(o);return e-=(h2+s)*this.scale*this.noteScale,n-=S6*this.scale,i+=S6*this.scale,r+=S6*this.scale,e+=this._viewportOffset.left,i+=this._viewportOffset.left,n+=this._viewportOffset.top,r+=this._viewportOffset.top,new Bi(e,n,i,r)},this._updateDragHoverRectTopLevelBlock=()=>{if(!this._dragHoverRect)return;const t=this.anchorEdgelessElement;t&&(this._dragHoverRect=this._getHoverAreaRectTopLevelBlock(t))},this._setSelectedBlocks=(t,e)=>{const{selection:n}=this.host,i=t.map(r=>n.create("block",{path:r.path}));if(ms(this.host)){const r=e||f_(t[0]),o=n.create("surface",t[0].path,[r],!0);i.push(o)}n.set(i)},this._canEditing=t=>{if(t.page.id!==this.page.id)return!1;if(en(this.host))return!0;const e=this.pageBlockElement,n=t.path[t.path.length-1];return e.service.selection.editing&&e.service.selection.selectedIds[0]===n},this._checkTopLevelBlockSelection=()=>{if(!this.isConnected)return;if(this.page.readonly||en(this.host)){this._hide();return}const t=this.pageBlockElement,e=t.service.selection.editing,n=t.service.selection.elements;if(e||n.length!==1){this._hide();return}const i=n[0];if(!Xr(i)){this._hide();return}const r=i.flavour,o=this.optionRunner.getOption(r);if(!o||!o.edgeless){this._hide();return}const s=t.service.selection.selections;this._anchorBlockId=i.id,this._anchorBlockPath=s[0].path,this._showDragHandleOnTopLevelBlocks().catch(console.error)},this._pointerMoveOnBlock=t=>{if(this._isTopLevelDragHandleVisible)return;const e=new je(t.raw.x,t.raw.y),n=m_(this.host,this.pageBlockElement,e);if(!n){this._anchorBlockId="",this._anchorBlockPath=null;return}const i=n.getAttribute(this.host.blockIdAttr);if(D(i),this._anchorBlockId=i,this._anchorBlockPath=n.path,tee(n)||this.page.readonly){this._hide();return}(!this._lastHoveredBlockPath||!L6(this._anchorBlockPath,this._lastHoveredBlockPath)||!this._isHoverDragHandleVisible)&&!this._isDragHandleHovered&&(this._showDragHandleOnHoverBlock(this._anchorBlockPath),this._lastHoveredBlockPath=this._anchorBlockPath)},this._pointerMoveHandler=t=>{if(this.page.readonly||this.dragging||!this.isConnected){this._hide();return}if(this._isTopLevelDragHandleVisible)return;const e=t.get("pointerState"),{target:n}=e.raw,i=jn(n);if(!i||i.closest(".affine-drag-handle-container"))return;const r=new je(e.raw.x,e.raw.y),o=a5(this.host,this.pageBlockElement,r);return this.noteScale=o?.model.edgeless.scale??1,o&&this._canEditing(o)&&!g_(this.host,o,r,this.scale*this.noteScale)?(this._pointerMoveOnBlock(e),!0):(this._hide(),!1)},this._throttledPointerMoveHandler=Vd(this._pointerMoveHandler,1e3/60),this._clickHandler=t=>{if(!this._isHoverDragHandleVisible)return;const e=t.get("pointerState"),{target:n}=e.raw;if(!!!jn(n)?.closest(wr)||!this._anchorBlockId||!this._anchorBlockPath)return;const{selection:o}=this.host,s=this.selectedBlocks;if(s.length>0&&!I6(s)&&s[0].blockId===this._anchorBlockId){o.clear(["block"]),this._dragHoverRect=null,this._showDragHandleOnHoverBlock(this._anchorBlockPath);return}const a=this.anchorBlockElement;return D(a),s.length>1&&this._showDragHandleOnHoverBlock(this._anchorBlockPath),this._setSelectedBlocks([a]),!0},this._onDragStart=t=>{const e=t.raw,{target:n}=e;if(!!!jn(n)?.closest(wr))return this._hide(),!1;if(!this._isHoverDragHandleVisible)return;if(D(this._anchorBlockId),D(this._anchorBlockPath),!this.anchorBlockElement)return!1;let s=this.selectedBlocks;if(s.length>0&&I6(s)){const c=document.getSelection();if(c&&c.rangeCount>0){const d=c.getRangeAt(0),u=this._rangeManager.getSelectedBlockElementsByRange(d,{match:h=>h.model.role==="content",mode:"highest"});this._setSelectedBlocks(u),s=this.selectedBlocks}}if(s.length===0||!Tf(s.map(c=>c.blockId),this._anchorBlockId)){const c=this.anchorBlockElement;D(c),this._setSelectedBlocks([c])}const a=this.selectedBlocks.map(c=>this._getBlockElementFromViewStore(c.path)).filter(c=>!!c),l=U4(a);return l.length===0?!1:(this._startDragging(l,t),this._hide(),!0)},this._onDragMove=t=>(this._clearRaf(),this.rafID=requestAnimationFrame(()=>{this._updateDragPreviewPosition(t),this._updateDropIndicator(t,!0)}),!0),this._onDragEnd=t=>{const e=this.dropBlockId,n=this.dropType,i=this.draggingElements;if(this._hide(!0),!e){const l=jn(t.raw.target);if(!(l?.classList.contains("edgeless")&&l?.classList.contains("affine-block-children-container")))return!1;const d=U4(i).map(y=>Zl(y)).filter(y=>!!y);if(d.length===0)return!1;if(d.some(y=>{const x=this.page.getParent(y.id);return Ie(x,["affine:surface"])}))return!0;const h=this.pageBlockElement;Cs(h,Fi);const{left:p,top:g}=h.viewport,f=h.addNoteWithPoint(new je(t.raw.x-p,t.raw.y-g),{scale:this.noteScale}),v=this.page.getBlockById(f);D(v);const m=ne.deserialize(v.xywh);return m.h*=this.noteScale,m.w*=this.noteScale,this.page.updateBlock(v,{xywh:m.serialize(),edgeless:{...v.edgeless,scale:this.noteScale}}),this.page.moveBlocks(d,v),!0}if(Tf(this.selectedBlocks.map(l=>l.blockId),e))return!1;const r=U4(i).map(l=>Zl(l)).filter(l=>!!l);if(!r.length)return!1;const o=this.page.getBlockById(e);D(o);const s=n==="in",a=s?o:this.page.getParent(e);return D(a),s?this.page.moveBlocks(r,o):this.page.moveBlocks(r,a,o,n==="before"),setTimeout(()=>{D(a);const l=this._getBlockElementFromViewStore(qn(a));if(l){const c=r.map(u=>l.path.concat(u.id)).map(u=>this._getBlockElementFromViewStore(u));if(!c)return;const d=f_(l);this._setSelectedBlocks(c,d)}},0),!0},this._dragStartHandler=t=>{const e=t.get("pointerState"),{button:n}=e.raw;if(n!==0)return!1;for(const i of this.optionRunner.options)if(i.onDragStart?.({state:e,startDragging:this._startDragging,anchorBlockId:this._anchorBlockId,anchorBlockPath:this._anchorBlockPath}))return!0;return this._onDragStart(e)},this._dragMoveHandler=t=>{if((this._isHoverDragHandleVisible||this._isTopLevelDragHandleVisible)&&this._hide(),!this.dragging||this.draggingElements.length===0)return!1;t.get("defaultState").event.preventDefault();const e=t.get("pointerState");for(const n of this.optionRunner.options)if(n.onDragMove?.(e,this.draggingElements))return!0;return this._onDragMove(e)},this._dragEndHandler=t=>{if(this._clearRaf(),!this.dragging||!this.dragPreview)return!1;if(this.draggingElements.length===0||this.page.readonly)return this._hide(!0),!1;const e=t.get("pointerState");for(const n of this.optionRunner.options)if(n.onDragEnd?.({state:e,draggingElements:this.draggingElements,dropBlockId:this.dropBlockId,dropType:this.dropType,dragPreview:this.dragPreview,noteScale:this.noteScale}))return this._hide(!0),ms(this.host)&&this._checkTopLevelBlockSelection(),!0;return this._onDragEnd(e),ms(this.host)&&this._checkTopLevelBlockSelection(),!0},this._pointerOutHandler=t=>{const e=t.get("pointerState");e.raw.preventDefault();const{target:n}=e.raw,i=jn(n);if(!i)return;const{relatedTarget:r}=e.raw,o=jn(r),s=i.classList.contains("affine-doc-viewport"),a=!!o?.closest(".affine-doc-viewport"),l=!!o?.closest(wr);s&&!l&&!a&&this._hide()},this._onDragHandlePointerEnter=()=>{const t=this._dragHandleContainer,e=this._dragHandleGrabber;if(!(!t||!e)){if(this._isHoverDragHandleVisible){if(D(this._anchorBlockPath),!this.anchorBlockElement)return;const i=WJ*this.scale;t.style.paddingTop=`${i}px`,t.style.paddingBottom=`${i}px`,t.style.transition="padding 0.25s ease",e.style.width=`${p_*this.scale*this.noteScale}px`,e.style.borderRadius=`${E6*this.scale*this.noteScale}px`,this._isDragHandleHovered=!0}else if(this._isTopLevelDragHandleVisible){const n=this.anchorEdgelessElement;if(!n)return;this._dragHoverRect=this._getHoverAreaRectTopLevelBlock(n),this._isDragHandleHovered=!0}}},this._onDragHandlePointerDown=()=>{if(!this._isHoverDragHandleVisible||!this._anchorBlockPath)return;const t=this.anchorBlockElement;t&&(this._dragHoverRect=this._getDraggingAreaRect(t)??null)},this._onDragHandlePointerUp=()=>{this._isHoverDragHandleVisible&&(this._dragHoverRect=null)},this._onDragHandlePointerLeave=()=>{this._isDragHandleHovered=!1,this._dragHoverRect=null,!this._isTopLevelDragHandleVisible&&(this.dragging||this._anchorBlockPath&&this._showDragHandleOnHoverBlock(this._anchorBlockPath))},this._handleEdgelessToolUpdated=t=>{t.type==="default"?this._checkTopLevelBlockSelection():this._hide()},this._handleEdgelessViewPortUpdated=({zoom:t,center:e})=>{this.scale!==t&&(this.scale=t,this._updateDragPreviewOnViewportUpdate()),this.center[0]!==e[0]&&this.center[1]!==e[1]&&(this.center=[...e],this._updateDropIndicatorOnScroll()),this._isTopLevelDragHandleVisible?(this._showDragHandleOnTopLevelBlocks().catch(console.error),this._updateDragHoverRectTopLevelBlock()):this._hide()}}static registerOption(t){return ri.staticOptionRunner.register(t)}get optionRunner(){return ri.staticOptionRunner}get pageBlockElement(){return this.blockElement}get selectedBlocks(){return this.host.selection.find("text")?this.host.selection.filter("text"):this.host.selection.filter("block")}get anchorBlockElement(){return this._anchorBlockPath?this._getBlockElementFromViewStore(this._anchorBlockPath):null}get anchorEdgelessElement(){if(en(this.host)||!this._anchorBlockId)return null;const{service:t}=this.pageBlockElement,e=t.getElementById(this._anchorBlockId);return Xr(e)?e:null}_clearRaf(){this.rafID&&(cancelAnimationFrame(this.rafID),this.rafID=0)}get _viewportOffset(){if(this.blockElement instanceof Fi){const e=this.blockElement.getBoundingClientRect();return{left:-e.left,top:-e.top}}else{const t=this.blockElement;return{left:t.viewport.scrollLeft-t.viewport.left,top:t.viewport.scrollTop-t.viewport.top}}}_getHoverAreaRectTopLevelBlock(t){if(en(this.host))return null;const e=this.pageBlockElement,n=ec([t]);let[i,r]=e.service.viewport.toViewCoord(n.left,n.top);const o=n.width*this.scale,s=n.height*this.scale;let[a,l]=[i+o,r+s];const c=u_*this.scale,d=YJ*this.scale;return i-=k6*this.scale+c,r-=d,a+=d,l+=d,new Bi(i,r,a,l)}get _rangeManager(){return D(this.host.rangeManager),this.host.rangeManager}firstUpdated(){if(this._hide(!0),this._disposables.addFromEvent(this._dragHandleContainer,"pointerenter",this._onDragHandlePointerEnter),this._disposables.addFromEvent(this._dragHandleContainer,"pointerdown",this._onDragHandlePointerDown),this._disposables.addFromEvent(this._dragHandleContainer,"pointerup",this._onDragHandlePointerUp),this._disposables.addFromEvent(this._dragHandleContainer,"pointerleave",this._onDragHandlePointerLeave),this._disposables.addFromEvent(this.host,"pointerleave",()=>this._hide()),en(this.host)){this._disposables.add(this.page.slots.blockUpdated.on(()=>this._hide()));const t=this.pageBlockElement;this._disposables.add(t.slots.viewportUpdated.on(()=>{this._hide(),this.dropIndicator&&(this.dropIndicator.rect=null)}));const e=t.viewportElement;D(e),this._disposables.addFromEvent(e,"scrollend",this._updateDropIndicatorOnScroll)}else if(ms(this.host)){const t=this.pageBlockElement;this._disposables.add(t.slots.edgelessToolUpdated.on(this._handleEdgelessToolUpdated)),this._disposables.add(t.service.viewport.viewportUpdated.on(this._handleEdgelessViewPortUpdated)),this._disposables.add(t.service.selection.slots.updated.on(()=>{this._checkTopLevelBlockSelection()})),this._disposables.add(t.slots.readonlyUpdated.on(()=>{this._checkTopLevelBlockSelection()})),this._disposables.add(t.slots.draggingAreaUpdated.on(()=>{this._checkTopLevelBlockSelection()})),this._disposables.add(t.slots.elementResizeStart.on(()=>{this._hide()})),this._disposables.add(t.slots.elementResizeEnd.on(()=>{this._checkTopLevelBlockSelection()}))}}connectedCallback(){super.connectedCallback(),this.disposables.addFromEvent(this,"pointerdown",t=>{t.preventDefault()}),this.handleEvent("pointerMove",this._throttledPointerMoveHandler),this.handleEvent("click",this._clickHandler),this.handleEvent("dragStart",this._dragStartHandler),this.handleEvent("dragMove",this._dragMoveHandler),this.handleEvent("dragEnd",this._dragEndHandler),this.handleEvent("pointerOut",this._pointerOutHandler),this.handleEvent("beforeInput",()=>this._hide())}disconnectedCallback(){this._hide(!0),this._disposables.dispose(),this._anchorModelDisposables?.dispose(),super.disconnectedCallback()}render(){const t=we(this._dragHoverRect?{width:`${this._dragHoverRect.width}px`,height:`${this._dragHoverRect.height}px`,top:`${this._dragHoverRect.top}px`,left:`${this._dragHoverRect.left}px`}:{display:"none"});return b`
      <div class="affine-drag-handle-widget">
        <div class="affine-drag-handle-container">
          <div class="affine-drag-handle-grabber"></div>
        </div>
        <div class="affine-drag-hover-rect" style=${t}></div>
      </div>
    `}};ri.styles=fre;ri.staticOptionRunner=new KJ;z3([he(".affine-drag-handle-container")],ri.prototype,"_dragHandleContainer",2);z3([he(".affine-drag-handle-grabber")],ri.prototype,"_dragHandleGrabber",2);z3([ie()],ri.prototype,"_dragHoverRect",2);ri=z3([W(wr)],ri);var bre=Object.defineProperty,vre=Object.getOwnPropertyDescriptor,rv=(t,e,n,i)=>{for(var r=i>1?void 0:i?vre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&bre(e,n,r),r};const B8="affine-edgeless-remote-selection-widget";let Os=class extends to{constructor(){super(...arguments),this._remoteRects=new Map,this._remoteCursors=new Map,this._remoteColorManager=null,this._updateRemoteRects=()=>{const{selection:t,blockElement:e}=this,n=t.remoteSelection,i=new Map;n.forEach((r,o)=>{if(r.elements.length===0)return;const s=r.elements.map(p=>e.service.getElementById(p)).filter(p=>p),a=ec(s);if(a.width===0||a.height===0)return;const{left:l,top:c}=a,[d,u]=[a.width,a.height];let h=0;if(s.length===1){const p=s[0];Xr(p)||(h=p.rotate??0)}i.set(o,{width:d,height:u,borderStyle:"solid",left:l,top:c,rotate:h})}),this._remoteRects=i},this._updateRemoteCursor=()=>{const t=new Map,e=this.page.awarenessStore.getStates();this.selection.remoteCursor.forEach((n,i)=>{t.set(i,{x:n.x,y:n.y,user:e.get(i)?.user})}),this._remoteCursors=t},this._updateOnElementChange=t=>{const e=typeof t=="string"?t:t.id;this.isConnected&&this.selection.hasRemote(e)&&this._updateRemoteRects()},this._updateTransform=zm(()=>{const{translateX:t,translateY:e}=this.edgeless.service.viewport;this.style.setProperty("transform",`translate(${t}px, ${e}px)`)},this)}get edgeless(){return this.blockElement}get selection(){return this.edgeless.service.selection}get surface(){return this.edgeless.surface}connectedCallback(){if(super.connectedCallback(),!Os.enable)return;const{_disposables:t,page:e,edgeless:n}=this;Im(n.service.surface,["elementAdded","elementRemoved","elementUpdated"]).forEach(i=>{t.add(i.on(this._updateOnElementChange))}),t.add(e.slots.blockUpdated.on(this._updateOnElementChange)),t.add(this.selection.slots.remoteUpdated.on(this._updateRemoteRects)),t.add(this.selection.slots.remoteCursorUpdated.on(this._updateRemoteCursor)),t.add(n.service.viewport.viewportUpdated.on(()=>{this._updateTransform()})),this._updateTransform(),this._updateRemoteRects(),this._remoteColorManager=new aP(this.host)}render(){if(!Os.enable)return ae;const{_remoteRects:t,_remoteCursors:e,_remoteColorManager:n}=this;D(n);const{zoom:i}=this.edgeless.service.viewport,r=Fe(t.entries(),s=>s[0],([s,a])=>b`<div
          data-client-id=${s}
          class="remote-rect"
          style=${we({pointerEvents:"none",width:`${i*a.width}px`,height:`${i*a.height}px`,borderStyle:a.borderStyle,borderColor:n.get(s),transform:`translate(${i*a.left}px, ${i*a.top}px) rotate(${a.rotate}deg)`})}
        ></div>`),o=Fe(e.entries(),s=>s[0],([s,a])=>b`<div
          data-client-id=${s}
          class="remote-cursor"
          style=${we({pointerEvents:"none",transform:`translate(${i*a.x}px, ${i*a.y}px)`,color:n.get(s)})}
        >
          ${eL}
          <div
            class="remote-username"
            style=${we({backgroundColor:n.get(s)})}
          >
            ${a.user?.name??"Unknown"}
          </div>
        </div>`);return b`
      <div class="affine-edgeless-remote-selection">${r}${o}</div>
    `}};Os.enable=!0;Os.styles=X`
    :host {
      pointer-events: none;
      position: absolute;
      left: 0;
      top: 0;
      transform-origin: left top;
      contain: size layout;
      z-index: 1;
    }

    .remote-rect {
      position: absolute;
      top: 0;
      left: 0;
      border-radius: 4px;
      box-sizing: border-box;
      border-width: 3px;
      z-index: 1;
      transform-origin: center center;
    }

    .remote-cursor {
      position: absolute;
      top: 0;
      left: 0;
      border-radius: 50%;
      z-index: 1;
    }

    .remote-cursor > svg {
      display: block;
    }

    .remote-username {
      margin-left: 22px;
      margin-top: -2px;

      color: white;

      max-width: 160px;
      padding: 0px 3px;
      border: 1px solid var(--affine-pure-black-20);

      box-shadow: 0px 1px 6px 0px rgba(0, 0, 0, 0.16);
      border-radius: 4px;

      font-size: 12px;
      line-height: 18px;

      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  `;rv([ie()],Os.prototype,"_remoteRects",2);rv([ie()],Os.prototype,"_remoteCursors",2);Os=rv([W(B8)],Os);var yre=Object.defineProperty,wre=Object.getOwnPropertyDescriptor,ov=(t,e,n,i)=>{for(var r=i>1?void 0:i?wre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&yre(e,n,r),r};let cp=class extends Ae{constructor(){super(...arguments),this.borderRadius=5,this.borderWidth=0}connectedCallback(){super.connectedCallback(),this.style.borderRadius=`${this.borderRadius}px`,this.borderWidth!==0&&(this.style.boxSizing="content-box",this.style.transform=`translate(-${this.borderWidth}px, -${this.borderWidth}px)`),this.style.borderWidth=`${this.borderWidth}px`}};cp.styles=X`
    :host {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      background-color: var(--affine-hover-color);
      border-color: transparent;
      border-style: solid;
    }
  `;ov([L({attribute:!1})],cp.prototype,"borderRadius",2);ov([L({attribute:!1})],cp.prototype,"borderWidth",2);cp=ov([W("affine-block-selection")],cp);var xre=Object.defineProperty,_re=Object.getOwnPropertyDescriptor,cP=(t,e,n,i)=>{for(var r=i>1?void 0:i?_re(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&xre(e,n,r),r};let dp=class extends Ae{constructor(){super(...arguments),this.rect=null}render(){if(!this.rect)return null;const{left:t,top:e,width:n,height:i}=this.rect,r=we({width:`${n}px`,height:`${i}px`,transform:`translate(${t}px, ${e}px)`});return b`<div
      class="affine-drag-indicator blocksuite-overlay"
      style=${r}
    ></div>`}};dp.styles=X`
    .affine-drag-indicator {
      position: absolute;
      top: 0;
      left: 0;
      background: var(--affine-primary-color);
      transition-property: width, height, transform;
      transition-duration: 100ms;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-delay: 0s;
      transform-origin: 0 0;
      pointer-events: none;
      z-index: 2;
    }
  `;cP([L({attribute:!1})],dp.prototype,"rect",2);dp=cP([W("affine-drag-indicator")],dp);var Cre=Object.defineProperty,kre=Object.getOwnPropertyDescriptor,j3=(t,e,n,i)=>{for(var r=i>1?void 0:i?kre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Cre(e,n,r),r};let up=class extends Ae{constructor(){super(...arguments),this.container=document.body,this.template=b``,this.shadowDom=!0,this._portalRoot=null}disconnectedCallback(){super.disconnectedCallback(),this._portalRoot?.remove()}createRenderRoot(){const t=document.createElement("div"),e=this.shadowDom?t.attachShadow({mode:"open",...typeof this.shadowDom!="boolean"?this.shadowDom:{}}):t;return t.classList.add("blocksuite-portal","blocksuite-overlay"),this.container.append(t),this._portalRoot=t,e}render(){return this.template}};j3([L({attribute:!1})],up.prototype,"container",2);j3([L({attribute:!1})],up.prototype,"template",2);j3([L({attribute:!1})],up.prototype,"shadowDom",2);up=j3([W("blocksuite-portal")],up);function dP({template:t,container:e=document.body,signal:n=new AbortController().signal,renderOptions:i,shadowDom:r=!0,identifyWrapper:o=!0}){const s=document.createElement("div");o&&s.classList.add("blocksuite-portal","blocksuite-overlay"),r&&s.attachShadow({mode:"open",...typeof r!="boolean"?r:{}}),n.addEventListener("abort",()=>{s.remove()});const a=r?s.shadowRoot:s;D(a);let l=0;const c=d=>{if(d!==l){console.warn("Potentially infinite recursion! Please clean up the old event listeners before `updatePortal`");return}l++;const u=l,h=t instanceof Function?t({updatePortal:()=>c(u)}):t;D(h),Qa(h,a,i)};return c(l),e.append(s),s}function Ere(t){return t.checkVisibility?t.checkVisibility():t.isConnected?t instanceof HTMLElement?t.offsetParent!==null:!0:!1}function Rs({computePosition:t,abortController:e,closeOnClickAway:n=!1,...i}){let r=new Ve;const o=i.template,s=o instanceof Function?({updatePortal:p})=>(r=new Ve,o({updatePortal:p,positionSlot:r})):o,a=dP({...i,signal:e.signal,template:s});if(n&&setTimeout(()=>document.addEventListener("click",p=>{a.contains(p.target)||e.abort()},{signal:e.signal})),!t)return a;const l=a.style.visibility;a.style.visibility="hidden",a.style.position="fixed",a.style.left="0",a.style.top="0";const c=t instanceof Function?t(a):t,{referenceElement:d,...u}=c;D(d,"referenceElement is required");const h=()=>{c.abortWhenRefRemoved!==!1&&d instanceof Element&&!Ere(d)&&e.abort(),ii(d,a,u).then(p=>{const{x:g,y:f}=p;a.style.left=`${g}px`,a.style.top=`${f}px`,a.style.visibility==="hidden"&&(a.style.visibility=l),r.emit(p)}).catch(console.error)};if(!c.autoUpdate)h();else{const p=c.autoUpdate===!0?{}:c.autoUpdate,g=zl(d,a,h,p);e.signal.addEventListener("abort",()=>{g()})}return a}const Sre=(t=!0)=>{let i=!1;return({event:r,floatingElement:o})=>{const s=i;return r.type==="mouseover"?(i=!0,!!(s!==i||t&&(!o||!o.isConnected))):r.type==="mouseleave"?(i=!1,!!(s!==i||t&&o?.isConnected)):(console.warn("Unknown event type in hover middleware",r),!0)}},Tre=t=>{let e=new AbortController;return async({event:n})=>{e.abort();const i=new AbortController;return e=i,n.type!=="mouseover"||t<=0?!0:(await Dg(t,i.signal),!i.signal.aborted)}},Ire=t=>{let e=new AbortController;return async({event:n})=>{e.abort();const i=new AbortController;return e=i,n.type!=="mouseleave"||t<=0?!0:(await Dg(t,i.signal),!i.signal.aborted)}};function $f({x:t,y:e},{x:n,y:i},{x:r,y:o},{x:s,y:a}){const l=(n-t)*(a-o)-(s-r)*(i-e);if(l===0)return!1;{const c=((a-o)*(s-t)+(r-s)*(a-e))/l,d=((e-i)*(s-t)+(n-t)*(a-e))/l;return 0<c&&c<1&&0<d&&d<1}}function uP({x:t,y:e},n,i=0){return t>=n.left-i&&t<=n.right+i&&e>=n.top-i&&e<=n.bottom-i}const hP=(t,e)=>{const n={x:e.x+e.width/2,y:e.y+e.height/2},i={x:e.x,y:e.y},r={x:e.right,y:e.y},o={x:e.x,y:e.bottom},s={x:e.right,y:e.bottom};return $f(t,n,o,s)?["top",o,s]:$f(t,n,i,r)?["bottom",i,r]:$f(t,n,i,o)?["right",i,o]:$f(t,n,r,s)?["left",r,s]:null},Lre=({zIndex:t=1e4,buffer:e=2,idleTimeout:n=40,debug:i=!1}={})=>{let r=new AbortController;return async({event:o,referenceElement:s,floatingElement:a})=>{r.abort();const l=new AbortController;if(r=l,!(o.type==="mouseleave")||o.target!==s)return!0;if(!(o instanceof MouseEvent))return console.warn("Unknown event type in hover middleware",o),!0;if(!a)return!0;const d=o.x,u=o.y,h=s.getBoundingClientRect(),p=a.getBoundingClientRect();if(uP({x:d,y:u},h))return!0;const f=hP({x:d,y:u},p);if(!f)return!0;const v=f[0];if(v==="top"&&u>=h.bottom-1||v==="bottom"&&u<=h.top+1||v==="left"&&d>=h.right-1||v==="right"&&d<=h.left+1)return!0;const m=document.createElementNS("http://www.w3.org/2000/svg","svg"),y=document.createElementNS("http://www.w3.org/2000/svg","path"),x=(k,_)=>{if(l.signal.aborted)return;k>=p.left&&k<=p.right&&_>=p.top&&_<=p.bottom&&l.abort();const A={x:k,y:_},$=f[1],E=f[2],R={x:Math.min(A.x,$.x,E.x)-e,y:Math.min(A.y,$.y,E.y)-e},I=Math.max(Math.abs(A.y-$.y),Math.abs(A.y-E.y),Math.abs($.y-E.y)),N=Math.max(Math.abs(A.x-$.x),Math.abs(A.x-E.x),Math.abs($.x-E.x));Object.assign(m.style,{position:"fixed",pointerEvents:"none",width:N+e*2,height:I+e*2,zIndex:t,top:0,left:0,transform:`translate(${R.x}px, ${R.y}px)`}),y.setAttributeNS(null,"d",`M${A.x-R.x} ${A.y-R.y} ${$.x-R.x} ${$.y-R.y} ${E.x-R.x} ${E.y-R.y} z`)};y.setAttributeNS(null,"pointer-events","auto"),y.setAttributeNS(null,"fill","transparent"),y.setAttributeNS(null,"stroke-width",e.toString()),y.setAttributeNS(null,"stroke","transparent"),i&&y.setAttributeNS(null,"stroke","red"),x(d,u),m.append(y),document.body.append(m),r.signal.addEventListener("abort",()=>m.remove());let T=0,M=window.setTimeout(()=>l.abort(),n);return m.addEventListener("mousemove",k=>{clearTimeout(M),M=window.setTimeout(()=>l.abort(),n),cancelAnimationFrame(T),T=requestAnimationFrame(()=>x(k.clientX,k.clientY))},{signal:l.signal}),await new Promise(k=>{l.signal.aborted&&k(),l.signal.addEventListener("abort",()=>k()),m.addEventListener("mouseleave",()=>l.abort(),{signal:l.signal})}),!0}},Mre=({debug:t=!1,idleTimeout:e=500}={})=>{let n=new AbortController;return async({event:i,referenceElement:r,floatingElement:o})=>{n.abort();const s=new AbortController;if(n=s,!(i.type==="mouseleave")||i.target!==r)return!0;if(!(i instanceof MouseEvent))return console.warn("Unknown event type in hover middleware",i),!0;if(!o)return!0;const l=(c,d)=>{if(s.signal.aborted)return!1;const u={x:c,y:d},h=r.getBoundingClientRect(),p=o.getBoundingClientRect(),g=hP(u,p);if(!g)return!1;const f=g[0];if(f==="top"&&d>h.top+1||f==="bottom"&&d<h.bottom-1||f==="left"&&c>h.left+1||f==="right"&&c<h.right-1)return!1;let v;switch(f){case"top":{v=new DOMRect(Math.max(p.left,h.left),p.bottom,Math.min(p.right,h.right)-Math.max(p.left,h.left),h.top-p.bottom);break}case"bottom":{v=new DOMRect(Math.max(p.left,h.left),h.bottom,Math.min(p.right,h.right)-Math.max(p.left,h.left),p.top-h.bottom);break}case"left":{v=new DOMRect(p.right,Math.max(p.top,h.top),h.left-p.right,Math.min(p.bottom,h.bottom)-Math.max(p.top,h.top));break}case"right":{v=new DOMRect(h.right,Math.max(p.top,h.top),p.left-h.right,Math.min(p.bottom,h.bottom)-Math.max(p.top,h.top));break}default:throw new Error("Unreachable")}const m=uP(u,v,1);if(m&&t){const y="debug-rectangle-bridge-rect",x=document.querySelector(`#${y}`)??document.createElement("div");x.id=y,Object.assign(x.style,{position:"fixed",pointerEvents:"none",background:"aqua",opacity:"0.3",top:v.top+"px",left:v.left+"px",width:v.width+"px",height:v.height+"px"}),document.body.append(x),s.signal.addEventListener("abort",()=>x.remove())}return m};return l(i.x,i.y)&&await new Promise(c=>{s.signal.aborted&&c(),s.signal.addEventListener("abort",()=>c());let d=window.setTimeout(()=>s.abort(),e);document.addEventListener("mousemove",u=>{clearTimeout(d),d=window.setTimeout(()=>s.abort(),e),l(u.clientX,u.clientY)||s.abort()},{signal:s.signal})}),!0}},sv=(t,{enterDelay:e=0,leaveDelay:n=300,alwayRunWhenNoFloating:i=!0,safeTriangle:r=!1,safeBridge:o=!0}={})=>{const s=new AbortController;let a,l;const c=[Sre(i),r&&Lre(typeof r=="boolean"?void 0:r),o&&Mre(typeof o=="boolean"?void 0:o),Tre(e),Ire(n)].filter(m=>typeof m!="boolean");let d=0,u=0;const h=async m=>{const y=d++;for(const x of c)if(!await x({event:m,floatingElement:l,referenceElement:a}))return;if(!(y<u)){if(u=y,m.type==="mouseover"){t(!0,m);return}if(m.type==="mouseleave"){t(!1,m);return}console.error("Unknown event type in whenHover",m)}},p=m=>{if(!m)return;m.matches(":hover")&&!s.signal.aborted&&h(new MouseEvent("mouseover")),m.addEventListener("mouseover",h,{signal:s.signal}),m.addEventListener("mouseleave",h,{signal:s.signal})},g=m=>{m&&(m.removeEventListener("mouseover",h),m.removeEventListener("mouseleave",h))};return{setReference:m=>{g(a),p(m),a=m},setFloating:m=>{g(l),p(m),l=m},dispose:()=>{s.abort()}}},Pre={transition:{in:{opacity:"1",transition:"opacity 0.1s ease-in-out"},out:{opacity:"0",transition:"opacity 0.1s ease-in-out"}},setPortalAsFloating:!0,allowMultiple:!1};class Xn{constructor(e,n,i){this._disposables=new dt,(this.host=e).addController(this),this._onHover=n,this._hoverOptions={...Pre,...i}}get setReference(){if(!this._setReference)throw new Error("setReference is not ready");return this._setReference}get portal(){return this._portal}hostConnected(){this._disposables.disposed&&(this._disposables=new dt);const{setReference:e,setFloating:n,dispose:i}=sv(r=>{if(!r){const a=this._abortController;if(!a)return;if(!this._portal||!this._hoverOptions.transition){a.abort();return}Object.assign(this._portal.style,this._hoverOptions.transition.out),this._portal.addEventListener("transitionend",()=>{a.abort()},{signal:a.signal});return}if(this._abortController)return;this._abortController=new AbortController,this._abortController.signal.addEventListener("abort",()=>{this._abortController=void 0}),this._hoverOptions.allowMultiple||(Xn.globalAbortController?.abort(),Xn.globalAbortController=this._abortController);const o=this._onHover({setReference:e,abortController:this._abortController});if(!o){this._abortController.abort();return}this._portal=Rs({...o,abortController:this._abortController});const s=this._hoverOptions.transition;s&&(Object.assign(this._portal.style,s.out),setTimeout(()=>{D(this._portal),Object.assign(this._portal.style,s.in)})),this._hoverOptions.setPortalAsFloating&&n(this._portal)},this._hoverOptions);this._setReference=e,this._disposables.add(i)}hostDisconnected(){this._abortController?.abort(),this._disposables.dispose()}}var Are=Object.defineProperty,$re=Object.getOwnPropertyDescriptor,dl=(t,e,n,i)=>{for(var r=i>1?void 0:i?$re(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Are(e,n,r),r};const Bre=X`
  .affine-tooltip {
    box-sizing: border-box;
    max-width: 280px;
    min-height: 32px;
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    border-radius: 4px;
    padding: 6px 12px;
    color: var(--affine-white);
    background: var(--affine-tooltip);

    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arrow {
    position: absolute;

    width: 0;
    height: 0;
  }
`,Dre=6,Ore={top:{bottom:"-6px",borderStyle:"solid",borderWidth:"6px 5px 0 5px",borderColor:"var(--affine-tooltip) transparent transparent transparent"},right:{left:"-6px",borderStyle:"solid",borderWidth:"5px 6px 5px 0",borderColor:"transparent var(--affine-tooltip) transparent transparent"},bottom:{top:"-6px",borderStyle:"solid",borderWidth:"0 5px 6px 5px",borderColor:"transparent transparent var(--affine-tooltip) transparent"},left:{right:"-6px",borderStyle:"solid",borderWidth:"5px 0 5px 6px",borderColor:"transparent transparent transparent var(--affine-tooltip)"}},Rre=({placement:t,middlewareData:e})=>{const n=e.arrow?.x,i=e.arrow?.y,r=Ore[t.split("-")[0]];return{left:n!=null?`${n}px`:"",top:i!=null?`${i}px`:"",...r}};let Po=class extends Ae{constructor(){super(...arguments),this.placement="top",this.zIndex="var(--affine-z-index-popover)",this.tooltipStyle=X``,this.autoFlip=!0,this.arrow=!0,this.offset=4,this.allowInteractive=!1,this._hoverController=new Xn(this,()=>{if(this.hidden)return null;let t={};return{template:({positionSlot:e,updatePortal:n})=>{e.on(o=>{this.arrow?t=Rre(o):t={},n()});const i=this.shadowRoot?.querySelector("slot");if(!i)throw new Error("slot not found in tooltip!");const r=i.assignedNodes().map(o=>o.cloneNode(!0));return b`
            <style>
              ${this._getStyles()}
            </style>
            <div class="affine-tooltip" role="tooltip">${r}</div>
            <div class="arrow" style=${we(t)}></div>
          `},computePosition:e=>({referenceElement:this.parentElement,placement:this.placement,middleware:[this.autoFlip&&Dn({padding:12}),Dt((this.arrow?Dre:0)+this.offset),lk({element:e.shadowRoot.querySelector(".arrow")})],autoUpdate:!0})}},{leaveDelay:0,safeBridge:!1,allowMultiple:!0})}connectedCallback(){super.connectedCallback();const t=this.parentElement;D(t,"Tooltip must have a parent element"),setTimeout(()=>{this._hoverController.setReference(t)},0)}getPortal(){return this._hoverController.portal}_getStyles(){return X`
      ${Bre}
      :host {
        z-index: ${Je(this.zIndex)};
        ${Je(this.style.cssText)}
      }

      ${this.allowInteractive?X``:X`
            :host {
              pointer-events: none;
            }
          `}

      ${this.tooltipStyle}
    `}render(){return b`<slot></slot>`}};Po.styles=X`
    :host {
      display: none;
    }
  `;dl([L({attribute:"tip-position"})],Po.prototype,"placement",2);dl([L({attribute:!1})],Po.prototype,"zIndex",2);dl([L({attribute:!1})],Po.prototype,"tooltipStyle",2);dl([L({attribute:!1})],Po.prototype,"autoFlip",2);dl([L({attribute:!1})],Po.prototype,"arrow",2);dl([L({attribute:!1})],Po.prototype,"offset",2);dl([L({attribute:!1})],Po.prototype,"allowInteractive",2);Po=dl([W("affine-tooltip")],Po);const Nre=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <circle cx="6" cy="12" r="2" fill="currentColor" />
    </svg>
  `,Hre=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M6 13.5C6.82843 13.5 7.5 12.8284 7.5 12C7.5 11.1716 6.82843 10.5 6 10.5C5.17157 10.5 4.5 11.1716 4.5 12C4.5 12.8284 5.17157 13.5 6 13.5ZM6 14C7.10457 14 8 13.1046 8 12C8 10.8954 7.10457 10 6 10C4.89543 10 4 10.8954 4 12C4 13.1046 4.89543 14 6 14Z"
        fill="currentColor"
      />
    </svg>
  `,Fre=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M5.60561 10.1634C5.82342 9.94555 6.17658 9.94555 6.39439 10.1634L7.83664 11.6056C8.05445 11.8234 8.05445 12.1766 7.83664 12.3944L6.39439 13.8366C6.17658 14.0545 5.82342 14.0545 5.60561 13.8366L4.16336 12.3944C3.94555 12.1766 3.94555 11.8234 4.16336 11.6056L5.60561 10.1634Z"
        fill="currentColor"
      />
    </svg>
  `,Ure=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.44224 12L6 10.5578L4.55776 12L6 13.4422L7.44224 12ZM6.39439 10.1634C6.17658 9.94555 5.82342 9.94555 5.60561 10.1634L4.16336 11.6056C3.94555 11.8234 3.94555 12.1766 4.16336 12.3944L5.60561 13.8366C5.82342 14.0545 6.17658 14.0545 6.39439 13.8366L7.83664 12.3944C8.05445 12.1766 8.05445 11.8234 7.83664 11.6056L6.39439 10.1634Z"
        fill="currentColor"
      />
    </svg>
  `,pP=Ht`<path
d="M16.5 11.134C17.1667 11.5189 17.1667 12.4811 16.5 12.866L9 17.1962C8.33333 17.5811 7.5 17.0999 7.5 16.3301L7.5 7.66989C7.5 6.90009 8.33333 6.41896 9 6.80386L16.5 11.134Z"
fill="#77757D"
/>`,fP=b`
  <svg
    width="16"
    height="16"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    ${pP}
  </svg>
`,gP=b`
  <svg
    width="16"
    height="16"
    viewBox="0 0 24 24"
    style="transform: rotate(90deg)"
    xmlns="http://www.w3.org/2000/svg"
  >
    ${pP}
  </svg>
`,av=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M3.25 6C3.25 4.48122 4.48122 3.25 6 3.25H18C19.5188 3.25 20.75 4.48122 20.75 6V18C20.75 19.5188 19.5188 20.75 18 20.75H6C4.48122 20.75 3.25 19.5188 3.25 18V6ZM16.5303 9.53033C16.8232 9.23744 16.8232 8.76256 16.5303 8.46967C16.2374 8.17678 15.7626 8.17678 15.4697 8.46967L10.5 13.4393L9.03033 11.9697C8.73744 11.6768 8.26256 11.6768 7.96967 11.9697C7.67678 12.2626 7.67678 12.7374 7.96967 13.0303L9.96967 15.0303C10.2626 15.3232 10.7374 15.3232 11.0303 15.0303L16.5303 9.53033Z"
        fill="#1E96EB"
      />
    </svg>
  `,lv=()=>b`
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H18C18.6904 4.75 19.25 5.30964 19.25 6V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6Z"
        fill="currentColor"
      />
    </svg>
  `,mP=async(t,{left:e=0,size:n=20}={})=>{const i=document.createElement("div");i.classList.add("affine-check-animation"),n<20&&console.warn("If the size is less than 20, the animation may be abnormal."),i.style.cssText=`
    position: absolute;
    width: ${n}px;
    height: ${n}px;
    border-radius: 50%;
  `,i.style.left=`${e}px`,t.appendChild(i),await i.animate([{boxShadow:"0 -18px 0 -8px #1e96eb, 16px -8px 0 -8px #1e96eb, 16px 8px 0 -8px #1e96eb, 0 18px 0 -8px #1e96eb, -16px 8px 0 -8px #1e96eb, -16px -8px 0 -8px #1e96eb"}],{duration:240,easing:"ease",fill:"forwards"}).finished,await i.animate([{boxShadow:"0 -36px 0 -10px transparent, 32px -16px 0 -10px transparent, 32px 16px 0 -10px transparent, 0 36px 0 -10px transparent, -32px 16px 0 -10px transparent, -32px -16px 0 -10px transparent"}],{duration:360,easing:"ease",fill:"forwards"}).finished,i.remove()},F_=[Nre(),Hre(),Fre(),Ure()];var Vre=Object.defineProperty,zre=Object.getOwnPropertyDescriptor,G3=(t,e,n,i)=>{for(var r=i>1?void 0:i?zre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Vre(e,n,r),r};const jre=t=>t.type==="select";let Da=class extends me(De){constructor(){super(...arguments),this.inputRef=Ri(),this.allItems=[],this._checked={},this._inputText=t=>{const e=t.target;this.text=e.value},this.processMap={action:t=>{const e=t.icon?b` <div class="icon">${t.icon}</div>`:ae,n=t.postfix??(t.isSelected?$9:void 0),i=n?b` <div class="icon">${n}</div>`:ae;return[{type:"select",label:b`
            ${e}
            <div class="affine-menu-action-text">
              ${t.label??t.name}
            </div>
            ${i}
          `,onHover:t.onHover,select:()=>{t.select(),this._complete()},class:t.class??(t.isSelected?"selected-item":"")}]},checkbox:t=>{const e=t.postfix?b` <div class="icon">${t.postfix}</div>`:ae,n=this.getChecked(t.name)??t.checked;return[{type:"select",label:b`
            <div class="icon">
              ${n?av():lv()}
            </div>
            <div class="affine-menu-action-text">
              ${t.label??t.name}
            </div>
            ${e}
          `,select:()=>{this.setChecked(t.name,t.select(n))},class:t.class??""}]},group:t=>{const e=t.children().flatMap(n=>this.process(n));return e[0]&&(e[0].upDivider=!0),e[e.length-1]&&(e[e.length-1].downDivider=!0),e},"sub-menu":t=>{const e=()=>{this.subMenu?.remove(),setTimeout(()=>{const i=new Da,r=t.options;i.options={...r,onClose:()=>{r.onClose?.(),this.clearSubMenu()},onComplete:()=>{this._complete()}},this.append(i),ii(this,i,{placement:"right-start",middleware:[Dn({fallbackPlacements:["left-start","right-end","left-end"]}),Dt(4)]}).then(({x:o,y:s})=>{Object.assign(i.style,{left:`${o}px`,top:`${s}px`})}).catch(console.error),this.subMenu=i})},n=b` <div class="icon">
        ${t.postfix??ya}
      </div>`;return[{type:"select",label:b`${t.icon?b` <div class="icon">${t.icon}</div>`:ae}
            <div class="affine-menu-action-text">
              ${t.label??t.name}
            </div>
            ${n}`,mouseEnter:e,select:e,class:""}]},custom:t=>[{type:"ui",render:t.render}]},this._complete=()=>{this.options.onComplete?.(),this.close()},this._clickContainer=t=>{t.stopPropagation(),this.focusInput()},this._mouseEnter=t=>{this._isConsciousChoice()||t!==this.selectedIndex&&(this.selectedIndex=t,this.clearSubMenu(),this.selectedItem?.mouseEnter?.())},this.initTime=0,this.mouseEnterHeader=()=>{this.isSearchMode||this._mouseEnter(-1)}}setChecked(t,e){this._checked[t]=e,this.requestUpdate()}getChecked(t){return this._checked[t]}get minIndex(){return this.isSearchMode?0:-1}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if((this._selectedIndex!=null?this.selectableItems[this._selectedIndex]:void 0)?.onHover?.(!1),t==null){this._selectedIndex=t;return}const n=Lk(t??this.minIndex,this.minIndex,this.selectableItems.length);this._selectedIndex=n,this.selectableItems[n]?.onHover?.(!0)}get text(){return this._text??this.options.input?.initValue??""}set text(t){this._text=t}close(){this.options.onClose?.()}firstUpdated(){this.initTime=Date.now();const t=this.inputRef.value;if(t){this.focusInput();const e=t.value.length;t.setSelectionRange(e,e),this._disposables.addFromEvent(t,"keydown",n=>{if(n.stopPropagation(),n.key==="Escape"){this.close();return}if(n.key==="Enter"&&!n.isComposing){const i=this.selectedItem;i?i.select():(this.options.input?.onComplete?.(this.text),this._complete());return}if(n.key==="ArrowUp"){n.preventDefault(),this.selectedIndex=this.selectedIndex!=null?this.selectedIndex-1:this.minIndex;return}if(n.key==="ArrowDown"){n.preventDefault(),this.selectedIndex=this.selectedIndex!=null?this.selectedIndex+1:this.minIndex;return}}),this._disposables.addFromEvent(t,"copy",n=>{n.stopPropagation()}),this._disposables.addFromEvent(t,"cut",n=>{n.stopPropagation()})}}disconnectedCallback(){super.disconnectedCallback(),this.selectedItem?.onHover?.(!1)}show(t){if(this.isSearchMode){if(t.type==="group")return!t.hide?.();if(t.type==="custom")return this.text.length===0;if(!t.name.toLowerCase().includes(this.text.toLowerCase()))return!1}return!t.hide?.()}process(t){return this.show(t)?this.processMap[t.type](t):[]}focusInput(){this.inputRef.value?.focus()}get selectedItem(){return this.selectedIndex!=null?this.selectableItems[this.selectedIndex]:void 0}_isConsciousChoice(){return Date.now()<this.initTime+100}clearSubMenu(){this.subMenu?.remove(),this.subMenu=void 0,this.focusInput()}processItems(){this.allItems=[],this.selectableItems=[],this.options.items.flatMap(t=>this.process(t)).forEach(t=>{const e=jre(t);this.allItems.push({...t,index:e?this.selectableItems.length:void 0}),e&&this.selectableItems.push(t)})}render(){this.processItems(),this.selectedIndex=this._selectedIndex;const t=this.showHeader(),e=we({opacity:t?"1":"0",height:t?void 0:"0",overflow:t?void 0:"hidden"}),n=this.selectableItems.length>0&&t;return b`
      <div
        class="affine-menu"
        style=${dk(this.options.style)}
        @click="${this._clickContainer}"
      >
        ${this.options.input?b` <div
                class="affine-menu-header"
                style=${e}
                @mouseenter="${this.mouseEnterHeader}"
              >
                <input
                  autocomplete="off"
                  data-1p-ignore
                  ${$t(this.inputRef)}
                  type="text"
                  placeholder="${this.options.input?.placeholder??""}"
                  value="${this.text??this.options.input?.initValue??""}"
                  @input="${this._inputText}"
                />
              </div>
              ${n?b` <div class="affine-menu-divider"></div>`:null}`:null}
        <div class="affine-menu-body">
          ${this.selectableItems.length===0&&this.isSearchMode?b` <div class="no-results">No Results</div>`:""}
          ${Fe(this.allItems,(i,r)=>{const o=i.index,s=o===0&&n,a=i.upDivider||this.allItems[r-1]?.downDivider,l=()=>{this._mouseEnter(o)};if(i.type==="ui")return b`
                ${a?b` <div class="affine-menu-divider"></div>`:null}
                <div @mouseenter=${l}>${i.render}</div>
              `;const c=i.class??"",d=Qe({"affine-menu-action":!0,selected:this._selectedIndex===o,[c]:!0});return b`
              ${a&&!s?b` <div class="affine-menu-divider"></div>`:null}
              <div
                class="${d}"
                @click="${i.select}"
                @mouseenter="${l}"
              >
                <div class="content">${i.label}</div>
              </div>
            `})}
        </div>
      </div>
    `}showHeader(){return!this.isSearchMode||!!this.text}get isSearchMode(){return this.options.input?.search}};Da.styles=X`
    affine-menu {
      display: flex;
      flex-direction: column;
      user-select: none;
      min-width: 200px;
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
      background-color: var(--affine-background-overlay-panel-color);
      padding: 8px;
      position: absolute;
      z-index: 999;
    }

    affine-menu * {
      box-sizing: border-box;
    }

    .affine-menu-body {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .affine-menu-header input {
      width: 100%;
      border-radius: 4px;
      outline: none;
      font-size: 14px;
      line-height: 22px;
      padding: 5px 12px;
      border: 1px solid var(--affine-border-color);
    }

    .affine-menu-header input::placeholder {
      color: var(--affine-placeholder-color);
    }

    .affine-menu-header input:focus {
      border: 1px solid var(--affine-primary-color);
    }

    .affine-menu-divider {
      height: 0.5px;
      background: var(--affine-divider-color);
      margin: 7px 0;
    }

    .affine-menu-action {
      padding: 4px 12px;
      cursor: pointer;
      display: flex;
      gap: 4px;
      border-radius: 4px;
    }

    .affine-menu-action svg {
      width: 20px;
      height: 20px;
      color: var(--affine-icon-color);
      fill: var(--affine-icon-color);
    }

    .affine-menu-action .icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .affine-menu-action .content {
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
      justify-content: space-between;
      display: flex;
      align-items: center;
      font-size: 14px;
      line-height: 22px;
      flex: 1;
      gap: 8px;
    }

    .affine-menu-action.selected {
      background-color: var(--affine-hover-color);
    }

    .affine-menu-action.selected.delete-item {
      background-color: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }

    .affine-menu-action.selected.delete-item .icon > svg {
      color: var(--affine-error-color);
    }

    .affine-menu-action.selected-item {
      color: var(--affine-text-emphasis-color);
    }

    .affine-menu-action.selected-item svg {
      color: var(--affine-text-emphasis-color);
    }

    .database-menu-component-action-button:hover {
      background-color: rgba(0, 0, 0, 0.1);
    }

    .no-results {
      font-size: 12px;
      line-height: 20px;
      color: var(--affine-text-secondary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 8px;
    }

    .affine-menu-action-text {
      flex: 1;
      padding: 0 4px;
    }
  `;G3([L({attribute:!1})],Da.prototype,"options",2);G3([ie()],Da.prototype,"_text",2);G3([ie()],Da.prototype,"_selectedIndex",2);Da=G3([W("affine-menu")],Da);const cv=(t=document.body)=>{const e=document.createElement("div");return e.classList.add("blocksuite-overlay"),e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="100vw",e.style.height="100vh",e.style.zIndex="1001",t.append(e),e},gd=(t,e)=>({getBoundingClientRect(){return{x:t,y:e,width:0,height:0,top:e,bottom:e,left:t,right:t}}}),ws=t=>gd(t.x,t.y),du=(t,e,n)=>{const i=cv();return zl(t,e,()=>{ii(t,e,{middleware:n?.middleware??[tr({crossAxis:!0})]}).then(({x:r,y:o})=>{Object.assign(e.style,{left:`${r}px`,top:`${o}px`})}).catch(console.error)}),i.append(e),ii(t,e,{middleware:n?.middleware??[tr({crossAxis:!0})]}).then(({x:r,y:o})=>{Object.assign(e.style,{left:`${r}px`,top:`${o}px`})}).catch(console.error),i.onmousedown=r=>{r.target===i&&(i.remove(),n?.onClose?.())},i.oncontextmenu=r=>{r.preventDefault(),r.target===i&&(i.remove(),n?.onClose?.())},()=>i.remove()},hn=(t,e)=>{const n=new Da;n.options={...e.options,onClose:()=>{e.options.onClose?.(),i()}};const i=du(t,n,{onClose:e.options.onClose,middleware:e.middleware});return{close:i}},Ui=(t,e,n)=>{hn(t,{options:{input:{placeholder:"Search",search:!0},items:e,onClose:n}})},Gre=X`
  affine-multi-tag-select {
    position: fixed;
    top: 290px !important;
    left: 50% !important;
    width: 75% !important;
    transform: translate(-50%, -50%);
    z-index: 2;
    border: 1px solid var(--affine-border-color);
    border-radius: 8px;
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-2);
    min-width: 300px;
    max-width: 720px;
  }

  .affine-select-cell-select {
    font-size: var(--affine-font-sm);
  }

  @media print {
    .affine-select-cell-select {
      display: none;
    }
  }

  .select-input-container {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 6px;
    min-height: 44px;
    padding: 10px 8px;
    background: var(--affine-hover-color);
    border-radius: 8px;
  }

  .select-input {
    flex: 1 1 0;
    height: 24px;
    border: none;
    font-family: ${Je(vt.fontSansFamily)};
    color: inherit;
    background: transparent;
    line-height: 24px;
  }

  .select-input:focus {
    outline: none;
  }

  .select-input::placeholder {
    color: var(--affine-placeholder-color);
  }

  .select-option-container {
    padding: 8px;
    color: var(--affine-black-90);
    fill: var(--affine-black-90);
    max-height: 400px;
    overflow-y: auto;
  }

  .select-option-container-header {
    padding: 0px 4px 8px 4px;
    color: var(--affine-black-60);
    font-size: 12px;
    user-select: none;
  }

  .select-input-container .select-selected {
    display: flex;
    align-items: center;
    padding: 2px 10px;
    gap: 10px;
    height: 28px;
    background: var(--affine-tag-white);
    border-radius: 4px;
    color: var(--affine-black-90);
    background: var(--affine-tertiary-color);
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
  }

  .select-selected-text {
    width: calc(100% - 16px);
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
  }

  .select-selected > .close-icon {
    display: flex;
    align-items: center;
  }

  .select-selected > .close-icon:hover {
    cursor: pointer;
  }

  .select-selected > .close-icon > svg {
    fill: var(--affine-black-90);
  }

  .select-option-new {
    display: flex;
    flex-direction: row;
    align-items: center;
    height: 36px;
    padding: 4px;
    gap: 5px;
    border-radius: 4px;
    background: var(--affine-selected-color);
  }

  .select-option-new-text {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    height: 28px;
    padding: 2px 10px;
    border-radius: 4px;
    background: var(--affine-tag-red);
  }

  .select-option-new-icon {
    display: flex;
    align-items: center;
    gap: 6px;
    height: 28px;
    color: var(--affine-text-primary-color);
    margin-right: 8px;
  }

  .select-option-new-icon svg {
    width: 16px;
    height: 16px;
  }

  .select-option {
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px;
    border-radius: 4px;
    margin-bottom: 4px;
    cursor: pointer;
  }

  .select-option.selected {
    background: var(--affine-hover-color);
  }

  .select-option-text-container {
    width: 100%;
    overflow: hidden;
    display: flex;
  }

  .select-option-group-name {
    font-size: 9px;
    padding: 0 2px;
    border-radius: 2px;
  }

  .select-option-name {
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
  }

  .select-option-icon {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 28px;
    height: 28px;
    border-radius: 3px;
    cursor: pointer;
    opacity: 0;
  }

  .select-option.selected .select-option-icon {
    opacity: 1;
  }

  .select-option-icon:hover {
    background: var(--affine-hover-color);
  }

  .select-option-icon svg {
    width: 16px;
    height: 16px;
    pointer-events: none;
  }
`;var Zre=Object.defineProperty,Wre=Object.getOwnPropertyDescriptor,Jo=(t,e,n,i)=>{for(var r=i>1?void 0:i?Wre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Zre(e,n,r),r};let rr=class extends me(De){constructor(){super(...arguments),this.mode="multi",this.options=[],this.filteredOptions=[],this.value=[],this.newTags=t=>{this.onOptionsChange([...t,...this.options])},this.deleteTag=t=>{this.onOptionsChange(this.options.filter(e=>e.id!==t).map(e=>({...e,parentId:e.parentId===t?void 0:e.parentId})))},this.changeTag=t=>{this.onOptionsChange(this.options.map(e=>e.id===t.id?t:e))},this.text="",this.selectedIndex=0,this._currentColor=void 0,this._onDeleteSelected=(t,e)=>{const n=t.filter(i=>i!==e);this.onChange(n)},this._onInput=t=>{this.text=t.target.value},this._onInputKeydown=t=>{t.stopPropagation();const e=this.text.trim();if(t.key==="Backspace"&&e==="")this._onDeleteSelected(this.value,this.value[this.value.length-1]);else if(t.key==="Enter"&&!t.isComposing)this.selectedTag?.select();else if(t.key==="ArrowUp")t.preventDefault(),this.setSelectedOption(this.selectedIndex-1);else if(t.key==="ArrowDown")t.preventDefault(),this.setSelectedOption(this.selectedIndex+1);else if(t.key==="Escape")this.editComplete();else if(t.key==="Tab"){t.preventDefault();const n=this.selectedTag;n&&(this.text=this.getTagFullName(n,n.group))}},this._onSelect=t=>{if(this.value.findIndex(i=>i===t)>-1)return;if(!(this.value.indexOf(t)>-1)){const i=this.isSingleMode?[t]:[...this.value,t];this.onChange(i),this.isSingleMode&&setTimeout(()=>{this.editComplete()},4)}this.text=""},this._createOption=()=>{const t=this.text.trim();if(t==="")return;const e=this.getGroupInfoByFullName(t);if(!e)return;const n=e.name,i=this.color;this.clearColor();const r={id:Oe(),value:n,color:i,parentId:e.parent?.id};this.newTags([r]);const o=this.isSingleMode?[r.id]:[...this.value,r.id];this.onChange(o),this.text="",this.isSingleMode&&this.editComplete()},this._clickItemOption=(t,e)=>{t.stopPropagation();const n=this.options.find(i=>i.id===e);n&&hn(t.target,{options:{input:{initValue:n.value,onComplete:i=>{this.changeTag({...n,value:i})}},items:[{type:"action",name:"Delete",icon:xn,class:"delete-item",select:()=>{this.deleteTag(e)}},{type:"group",name:"color",children:()=>m9.map(i=>{const r=we({backgroundColor:i.color,borderRadius:"50%",width:"20px",height:"20px"});return{type:"action",name:i.name,icon:Be` <div style=${r}></div>`,isSelected:n.color===i.color,select:()=>{this.changeTag({...n,color:i.color})}}})}]},middleware:[uk()]})}}get color(){return this._currentColor||(this._currentColor=Wr()),this._currentColor}clearColor(){this._currentColor=void 0}get isSingleMode(){return this.mode==="single"}firstUpdated(){this._selectInput.focus(),this._disposables.addFromEvent(this,"click",()=>{this._selectInput.focus()}),this._disposables.addFromEvent(this._selectInput,"copy",t=>{t.stopPropagation()}),this._disposables.addFromEvent(this._selectInput,"cut",t=>{t.stopPropagation()})}get selectedTag(){return this.filteredOptions[this.selectedIndex]}optionsIdMap(){return Object.fromEntries(this.options.map(t=>[t.id,t]))}getTagGroup(t,e=this.optionsIdMap()){const n=[];let i=t.parentId;for(;i;){const r=e[i];n.unshift(r),i=r.parentId}return n}setSelectedOption(t){this.selectedIndex=Lk(t,0,this.filteredOptions.length)}getTagFullName(t,e){return[...e,t].map(n=>n.value).join("/")}getGroupInfoByFullName(t){const e=t.split("/"),n=e.slice(0,-1),i=[];for(const r of n){const o=i[i.length-1],s=this.options.find(a=>a.parentId===o?.id&&a.value===r);if(!s)return;i.push(s)}return{name:e[e.length-1],group:i,parent:i[i.length-1]}}_filterOptions(){const t=this.optionsIdMap();let e=!1;const n=this.options.map(i=>({...i,group:this.getTagGroup(i,t)})).filter(i=>this.text?this.getTagFullName(i,i.group).toLocaleLowerCase().includes(this.text.toLocaleLowerCase()):!0).map(i=>(this.getTagFullName(i,i.group)===this.text&&(e=!0),{...i,isCreate:!1,select:()=>this._onSelect(i.id)}));return this.text&&!e&&n.push({id:"create",color:this.color,value:this.text,isCreate:!0,group:[],select:this._createOption}),n}render(){this.filteredOptions=this._filterOptions(),this.setSelectedOption(this.selectedIndex);const t=this.value,e=new Map(this.options.map(n=>[n.id,n]));return Be`
      <div class="affine-select-cell-select">
        <div class="select-input-container">
          ${t.map(n=>{const i=e.get(n);if(!i)return;const r=we({backgroundColor:i.color});return Be` <div class="select-selected" style=${r}>
              <div class="select-selected-text">${i.value}</div>
              <span
                class="close-icon"
                @click="${()=>this._onDeleteSelected(t,n)}"
                >${l3}</span
              >
            </div>`})}
          <input
            class="select-input"
            placeholder="Type here..."
            .value="${this.text}"
            @input="${this._onInput}"
            @keydown="${this._onInputKeydown}"
            @pointerdown="${at}"
          />
        </div>
        <div class="select-option-container">
          <div class="select-option-container-header">
            Select tag or create one
          </div>
          ${Fe(this.filteredOptions,n=>n.id,(n,i)=>{const r=i===this.selectedIndex,o=()=>{this.setSelectedOption(i)},s=Qe({"select-option":!0,selected:r}),a=we({backgroundColor:n.color}),l=c=>this._clickItemOption(c,n.id);return Be`
                <div class="${s}" @mouseenter="${o}">
                  <div
                    class="select-option-text-container"
                    @click="${n.select}"
                  >
                    ${n.isCreate?Be` <div class="select-option-new-icon">
                          Create ${Sr}
                        </div>`:""}
                    <div style="display:flex;flex-direction: column">
                      <div
                        style="display:flex;align-items:center;margin-bottom: 2px;opacity: 0.5;"
                      >
                        ${n.group.map((c,d)=>{const u=we({backgroundColor:c.color});return Be`${d===0?"":Be`<span style="margin: 0 1px">/</span>`}<span
                              class="select-option-group-name"
                              style=${u}
                              >${c.value}</span
                            >`})}
                      </div>
                      <div style="display:flex;">
                        <div style=${a} class="select-option-name">
                          ${n.value}
                        </div>
                      </div>
                    </div>
                  </div>
                  ${n.isCreate?null:Be` <div
                        class="select-option-icon"
                        @click="${l}"
                      >
                        ${Xo}
                      </div>`}
                </div>
              `})}
        </div>
      </div>
    `}};rr.styles=Gre;Jo([L()],rr.prototype,"mode",2);Jo([L({attribute:!1})],rr.prototype,"options",2);Jo([L({attribute:!1})],rr.prototype,"onOptionsChange",2);Jo([L({attribute:!1})],rr.prototype,"value",2);Jo([L({attribute:!1})],rr.prototype,"onChange",2);Jo([L({attribute:!1})],rr.prototype,"editComplete",2);Jo([he(".select-input")],rr.prototype,"_selectInput",2);Jo([ie()],rr.prototype,"text",2);Jo([ie()],rr.prototype,"selectedIndex",2);rr=Jo([W("affine-multi-tag-select")],rr);const Z3=(t,e)=>{const n=new rr;e.mode&&(n.mode=e.mode),n.style.width=`${Math.max(e.minWidth??t.offsetWidth,t.offsetWidth)}px`,n.value=e.value,n.onChange=r=>{e.onChange(r),n.value=r},n.options=e.options,n.onOptionsChange=r=>{e.onOptionsChange(r),n.options=r},n.editComplete=()=>{e.onComplete?.(),i()};const i=du(t,n,{onClose:e.onComplete,middleware:[qre]});return i},qre={name:"middleware",fn:async t=>{const e=await XB(t),n=t.elements.reference.getBoundingClientRect(),i=n.top,r=n.left;let o=i-12,s=r-12;return e.bottom>0&&(o=i-t.elements.floating.getBoundingClientRect().height),e.right>0&&(s=r-e.right),o<0&&(o=240),{y:o,x:s}}},bP=({target:t,inlineEditor:e,onUpdateQuery:n,onMove:i,onConfirm:r,onEsc:o,interceptor:s=(l,c)=>c(),abortController:a})=>{let l="";const c=e?.getInlineRange()?.index??0,d=async()=>{await Dg(0);const h=zg();if(h.startContainer!==h.endContainer){console.warn("Failed to parse query! Current range is not collapsed.",h),a.abort();return}if(h.startContainer.nodeType!==Node.TEXT_NODE){console.warn("Failed to parse query! Current range is not a text node.",h),a.abort();return}const g=e.getInlineRange()?.index??0,f=e.yText.toString(),v=l;l=f.slice(c,g),l!==v&&n(l)},u=h=>{if(h.stopPropagation(),!h.defaultPrevented){if(Uh(h)){if((h.ctrlKey||h.metaKey)&&!h.altKey&&!h.shiftKey&&h.key.length===1)switch(h.key){case"P":case"p":{i(-1),h.preventDefault();return}case"N":case"n":{i(1),h.preventDefault();return}}if(h.key==="Control"||h.key==="Meta"||h.key==="Alt")return;a.abort();return}if(!Uh(h)&&h.key.length===1||h.isComposing){d().catch(console.error);return}switch(h.key){case"Escape":{a.abort();return}case"Backspace":{l.length||a.abort(),d().catch(console.error);return}case"Enter":{if(h.shiftKey){a.abort();return}r(),h.preventDefault();return}case"Tab":{h.shiftKey?i(-1):i(1),h.preventDefault();return}case"ArrowUp":{if(h.shiftKey){a.abort();return}i(-1),h.preventDefault();return}case"ArrowDown":{if(h.shiftKey){a.abort();return}i(1),h.preventDefault();return}case"ArrowLeft":case"ArrowRight":{a.abort();return}default:return}}};if(t.addEventListener("keydown",h=>s(h,()=>u(h)),{capture:!0,signal:a.signal}),t.addEventListener("input",()=>{d().catch(console.error)},{signal:a.signal}),o){const h=p=>{p.key==="Escape"&&o()};window.addEventListener("keydown",h,{signal:a.signal})}};function D8(t,e,n){if(!n){console.warn("Failed to clean text! Unexpected empty string");return}const i=e instanceof Bn?Ja(t,e):e;D(i,"Inline editor not found");const r=i.getInlineRange();D(r);const o=r.index-n.length,s=i.yText.toString().slice(o,o+n.length);if(s!==n){console.warn(`Failed to clean text! Text mismatch expected: ${n} but actual: ${s}`);return}i.deleteText({index:o,length:n.length}),i.setInlineRange({index:o,length:0})}const uu=t=>{if(!t)throw new Error("To prevent style pollution of the whole page, you must add a container before the scrollbar style.");if(t.length>50||t.includes("{")||t.includes("}"))throw new Error("Invalid container name!");return X`
    ${Je(t)}::-webkit-scrollbar {
      -webkit-appearance: none;
      width: 4px;
    }
    ${Je(t)}::-webkit-scrollbar-thumb {
      border-radius: 2px;
      background-color: #b1b1b1;
    }
    ${Je(t)}::-webkit-scrollbar-corner {
      display: none;
    }
  `};function br(t){return t.command.pipe().withHost()}var Yre=Object.defineProperty,Xre=Object.getOwnPropertyDescriptor,vP=(t,e,n,i)=>{for(var r=i>1?void 0:i?Xre(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Yre(e,n,r),r};const Kre=[{type:"table",text:"Table view",icon:nb},{type:"kanban",text:"Kanban view",icon:mL}],Qre=["affine:list","affine:paragraph"];let f5=class extends me(Ae){get page(){return this.host.page}_convertToDatabase(t){const e=this.host.command.getChainCtx(br(this.host.std).getSelectedModels({types:["block","text"]})).selectedModels;if(!e||e.length===0)return;this.page.captureSync();const n=this.page.getParent(e[0]);D(n);const i=this.page.addBlock("affine:database",{},n,n.children.indexOf(e[0])),r=this.page.getBlockById(i);D(r),r.initConvert(t),r.applyColumnUpdate(),this.page.moveBlocks(e,r),this.host.selection.clear(),this.remove()}render(){return b`<div>
      <div
        @click="${()=>{this.remove()}}"
        class="overlay-mask"
      ></div>
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-title">Select Database View</div>
          <div class="modal-header-close-icon">${l3}</div>
        </div>
        <div class="modal-body">
          <div class="modal-desc">
            Group as Database can quickly convert selected blocks into Database
            for easy structuring of data.
          </div>
          <div class="modal-view-container">
            ${Kre.map(t=>b`
                <div
                  class="modal-view-item ${t.type}"
                  @mousedown="${e=>{e.preventDefault()}}"
                  @click="${()=>{this._convertToDatabase(t.type)}}"
                >
                  <div class="modal-view-item-content">
                    <div class="modal-view-item-icon">${t.icon}</div>
                    <div class="modal-view-item-text">${t.text}</div>
                  </div>
                  <div class="modal-view-item-description">
                    ${t.description}
                  </div>
                </div>
              `)}
          </div>
        </div>
        <div class="modal-footer">More views are on the way.</div>
      </div>
    </div>`}};f5.styles=X`
    :host {
      position: fixed;
      inset: 0;
      z-index: var(--affine-z-index-modal);
    }
    .overlay-mask {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: var(--affine-z-index-modal);
    }
    .modal-container {
      position: absolute;
      z-index: var(--affine-z-index-modal);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 720px;
      padding: 24px 40px;
      border-radius: 24px;
      background: var(--affine-background-overlay-panel-color);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-header-title {
      color: var(--affine-text-primary-color);
      font-size: 20px;
      font-weight: 600;
    }
    .modal-header-close-icon {
      display: flex;
      align-items: center;
      color: var(--affine-icon-color);
      cursor: pointer;
    }
    .modal-header-close-icon svg {
      width: 24px;
      height: 24px;
    }
    .modal-footer {
      color: var(--affine-text-secondary-color);
      font-size: 14px;
      text-align: center;
    }
    .modal-body {
      padding: 24px 0;
    }
    .modal-desc {
      margin-bottom: 38px;
      color: var(--affine-text-primary-color);
      font-size: 14px;
    }
    .modal-view-container {
      display: flex;
      justify-content: center;
      gap: 18px;
    }
    .modal-view-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
    }
    .modal-view-item.coming-soon {
      cursor: not-allowed;
    }
    .modal-view-item.coming-soon .modal-view-item-content {
      pointer-events: none;
    }
    .modal-view-item-content:hover {
      background: var(--affine-hover-color);
    }
    .modal-view-item-content:hover .modal-view-item-text,
    .modal-view-item-content:hover svg {
      fill: var(--affine-primary-color);
      color: var(--affine-primary-color);
    }
    .modal-view-item-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 18px 0;
      gap: 6px;
      width: 108px;
      border: 2px solid var(--affine-border-color);
      border-radius: 8px;
    }
    .modal-view-item-icon {
      width: 42px;
      height: 42px;
    }
    .modal-view-item-icon svg {
      width: 42px;
      height: 42px;
      fill: var(--affine-black-50);
    }
    .modal-view-item-text {
      font-size: 14px;
      color: var(--affine-black-50);
    }
    .modal-view-item-description {
      font-size: 12px;
      color: var(--affine-text-secondary-color);
      text-align: center;
    }
  `;vP([L({attribute:!1})],f5.prototype,"host",2);f5=vP([W("database-convert-view")],f5);const yP=[{id:"copy",name:"Copy",disabledToolTip:void 0,icon:Tr,hotkey:void 0,showWhen:()=>!0,enabledWhen:()=>!0,action:t=>{t.std.command.pipe().withHost().getSelectedModels().with({onCopy:()=>{kt(t,"Copied to clipboard")}}).copySelectedModels().run()}},{id:"convert-to-database",name:"Group as Database",disabledToolTip:"Contains Block types that cannot be converted to Database",icon:ib,showWhen:t=>{const e=t.command.getChainCtx(br(t.std).getSelectedModels({types:["block","text"]})).selectedModels;if(!e||e.length===0)return!1;const n=e[0];return D(n),!Ie(n,["affine:database"])},enabledWhen:t=>{const e=t.command.getChainCtx(br(t.std).getSelectedModels({types:["block","text"]})).selectedModels;return!e||e.length===0?!1:e.every(n=>Qre.includes(n.flavour))},action:t=>{dP({template:b`<database-convert-view
          .host=${t}
        ></database-convert-view>`})}},{id:"convert-to-linked-doc",name:"Create Linked Doc",icon:pb,hotkey:"Mod-Shift-l",showWhen:t=>{const e=t.command.getChainCtx(br(t.std).getSelectedModels({types:["block"]})).selectedModels;return!!e&&e.length>0},enabledWhen:t=>{const e=t.command.getChainCtx(br(t.std).getSelectedModels({types:["block"]})).selectedModels;return!!e&&e.length>0},action:t=>{const e=t.command.getChainCtx(br(t.std).getSelectedModels({types:["block"]})).selectedModels;D(e),t.selection.clear();const n=t.page,i=n.workspace.createPage({});i.load(()=>{const o=i.addBlock("affine:page",{title:new n.Text("")});i.addBlock("affine:surface",{},o);const s=i.addBlock("affine:note",{},o),a=e[0];if(D(a),n.addSiblingBlocks(a,[{flavour:"affine:embed-linked-doc",pageId:i.id}],"before"),Ie(a,["affine:paragraph"])&&a.type.match(/^h[1-6]$/)){const l=a.text.toString();i.workspace.setPageMeta(i.id,{title:l});const c=i.getBlockById(o);D(c),i.updateBlock(c,{title:new n.Text(l)}),n.deleteBlock(a),e.shift()}e.forEach(l=>{const c=l.keys,d=c.map(h=>l[h]),u=Object.fromEntries(c.map((h,p)=>[h,d[p]]));i.addBlock(l.flavour,u,s),n.deleteBlock(l)})}).catch(console.error);const r=t.spec.getService("affine:embed-linked-doc");D(r),r.slots.linkedDocCreated.emit({pageId:i.id})}}],Jre=t=>{if(t.displayType!=="text"&&t.displayType!=="block")return null;const e=t.host;return yP.filter(({showWhen:n})=>n(e)).map(({id:n,name:i,icon:r,action:o,enabledWhen:s,disabledToolTip:a})=>{const l=s(e),c=l?b`<affine-tooltip>${i}</affine-tooltip>`:b`<affine-tooltip>${a}</affine-tooltip>`;return b`<icon-button
        size="32px"
        data-testid=${n}
        ?disabled=${!l}
        @click=${()=>l&&o(e)}
      >
        ${r}${c}
      </icon-button>`})};var eoe=Object.defineProperty,toe=Object.getOwnPropertyDescriptor,A0=(t,e,n,i)=>{for(var r=i>1?void 0:i?toe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&eoe(e,n,r),r};let Oa=class extends me(Ae){get currentLink(){const t=this.inlineEditor.getFormat(this.targetInlineRange).link;return D(t),t}_openLink(){let t=this.currentLink;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank"),this.abortController.abort()}_copyUrl(){navigator.clipboard.writeText(this.currentLink).catch(console.error),kt(this.host,"Copied link to clipboard"),this.abortController.abort()}_removeLink(){this.inlineEditor.isValidInlineRange(this.targetInlineRange)&&this.inlineEditor.formatText(this.targetInlineRange,{link:null}),this.abortController.abort()}_delete(){this.inlineEditor.isValidInlineRange(this.targetInlineRange)&&this.inlineEditor.deleteText(this.targetInlineRange),this.abortController.abort()}render(){return b`<div class="link-popup-more-menu">
      <icon-button
        width="126px"
        height="32px"
        class="menu-item open"
        text="Open"
        @click=${()=>this._openLink()}
      >
        ${oo}
      </icon-button>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item copy"
        text="Copy"
        @click=${()=>this._copyUrl()}
      >
        ${Tr}
      </icon-button>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item unlink"
        text="Remove link"
        @click=${()=>this._removeLink()}
      >
        ${ub}
      </icon-button>

      <div class="divider"></div>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item delete"
        text="Delete"
        @click=${()=>this._delete()}
      >
        ${xn}
      </icon-button>
    </div> `}};Oa.styles=X`
    .link-popup-more-menu {
      border-radius: 8px;
      padding: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    .menu-item {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      width: 100%;
    }

    .menu-item:hover {
      background: var(--affine-hover-color);
    }

    .menu-item:hover.delete {
      background: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }
    .menu-item:hover.delete > svg {
      color: var(--affine-error-color);
    }

    .menu-item svg {
      margin: 0 8px;
    }

    .divider {
      width: 148px;
      height: 1px;
      margin: 8px;
      background-color: var(--affine-border-color);
    }
  `;A0([L({attribute:!1})],Oa.prototype,"inlineEditor",2);A0([L({attribute:!1})],Oa.prototype,"targetInlineRange",2);A0([L({attribute:!1})],Oa.prototype,"abortController",2);A0([L({attribute:!1})],Oa.prototype,"host",2);Oa=A0([W("link-popup-more-menu")],Oa);const noe=X`
  .affine-link-edit-popover {
    box-sizing: border-box;
    width: 404px;
    height: 112px;
    padding: 12px;
    box-shadow: var(--affine-shadow-2);
    background: var(--affine-background-overlay-panel-color);
    border-radius: 8px;
    display: grid;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(2, 1fr);
    gap: 12px;
    grid-template-areas:
      'text-area .'
      'link-area btn';
    justify-items: center;
    align-items: center;
    /* breaks 'basic link' test in chromium */
    /* user-select: none; */
  }

  .affine-link-edit-popover label {
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-sm);
    box-sizing: border-box;
    padding: 6px 0 6px 12px;
    color: var(--affine-icon-color);
  }

  .affine-link-edit-popover input {
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-base);
    box-sizing: border-box;
    padding: 6px 12px 6px 0;
    width: 260px;
    height: 34px;
    color: inherit;
    border: none;
    background: transparent;
  }
  .affine-link-edit-popover input::placeholder {
    color: var(--affine-placeholder-color);
  }
  input:focus {
    outline: none;
  }
  .affine-link-edit-popover input:focus ~ label,
  .affine-link-edit-popover input:active ~ label {
    color: var(--affine-primary-color);
  }

  .affine-edit-text-area {
    grid-area: text-area;
    width: 338px;
    display: grid;
    gap: 6px;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(1, 1fr);
    grid-template-areas: 'text span text-input';
    justify-items: center;
    align-items: center;
    user-select: none;
  }
  .affine-edit-text-area {
    border: 1px solid var(--affine-border-color);
    outline: none;
    border-radius: 10px;
    background: transparent;
  }

  .affine-edit-text-area:focus-within {
    border: 1px solid var(--affine-primary-color);
  }

  .affine-edit-link-area {
    grid-area: link-area;
    width: 338px;
    display: grid;
    gap: 6px;
    grid-template-columns: auto auto auto;
    grid-template-rows: repeat(1, 1fr);
    grid-template-areas: 'link span link-input';
    justify-items: center;
    align-items: center;
  }
  .affine-edit-link-area {
    border: 1px solid var(--affine-border-color);
    outline: none;
    border-radius: 10px;
    background: transparent;
  }
  .affine-edit-link-area:focus-within {
    border: 1px solid var(--affine-primary-color);
  }

  .affine-link-popover-dividing-line {
    grid-area: span;
  }
  .affine-edit-text-text {
    grid-area: text;
  }

  .affine-edit-text-input {
    grid-area: text-input;
  }

  .affine-edit-link-text {
    grid-area: link;
  }

  .affine-edit-link-input {
    grid-area: link-input;
  }

  .affine-confirm-button {
    grid-area: btn;
    user-select: none;
  }
`,ioe=X`
  :host {
    box-sizing: border-box;
  }

  .mock-selection {
    position: absolute;
    background-color: rgba(35, 131, 226, 0.28);
  }

  .affine-link-popover-container {
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-base);
    font-style: normal;
    line-height: 24px;
    color: var(--affine-text-primary-color);
    z-index: var(--affine-z-index-popover);
    animation: affine-popover-fade-in 0.2s ease;
    position: absolute;
  }

  @keyframes affine-popover-fade-in {
    from {
      opacity: 0;
      transform: translateY(-3px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .affine-link-popover-overlay-mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--affine-z-index-popover);
  }

  .affine-link-popover {
    box-sizing: border-box;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
    height: 40px;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
  }

  .affine-link-preview {
    display: flex;
    width: 180px;
    padding: var(--1, 0px);
    align-items: flex-start;
    gap: 10px;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
    user-select: none;
    cursor: pointer;
  }

  .affine-link-popover-input {
    border: none;
  }
  .affine-link-popover-input::placeholder {
    color: var(--affine-placeholder-color);
  }
  .affine-link-popover-input:focus {
    border: none;
  }

  .affine-link-preview > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    color: var(--affine-link-color);
    font-feature-settings:
      'clig' off,
      'liga' off;
    font-family: var(--affine-font-family);
    font-size: 15px;
    font-style: normal;
    font-weight: 400;
    line-height: 24px;
    text-overflow: ellipsis;
    overflow: hidden;
    opacity: var(--add, 1);
  }

  .affine-link-popover-dividing-line {
    margin: 0 6px;
    width: 1px;
    height: 20px;
    background-color: var(--affine-border-color);
  }

  .affine-link-popover-view-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 2px;
    border-radius: 6px;
    background: var(--affine-hover-color);
  }
  .affine-link-popover-view-selector > icon-button {
    padding: 0px;
  }
  .affine-link-popover-view-selector .current-view {
    background: var(--affine-background-overlay-panel-color);
  }

  ${noe}
`;var roe=Object.defineProperty,ooe=Object.getOwnPropertyDescriptor,es=(t,e,n,i)=>{for(var r=i>1?void 0:i?ooe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&roe(e,n,r),r};let or=class extends me(Ae){constructor(){super(...arguments),this.type="create",this._bodyOverflowStyle="",this._moreMenuAbortController=null,this._embedOptions=null}connectedCallback(){if(super.connectedCallback(),this.targetInlineRange.length===0)throw new Error("Cannot toggle link popup on empty range");(this.type==="edit"||this.type==="create")&&(this._bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden",this.disposables.add({dispose:()=>{document.body.style.overflow=this._bodyOverflowStyle}}));const t=this.blockElement.page.getParent(this.blockElement.model);D(t),this.disposables.add(t.childrenUpdated.on(()=>{t.children.includes(this.blockElement.model)||this.abortController.abort()}))}firstUpdated(){this.linkInput&&(this._disposables.addFromEvent(this.linkInput,"copy",t=>{t.stopPropagation()}),this._disposables.addFromEvent(this.linkInput,"cut",t=>{t.stopPropagation()}),this._disposables.addFromEvent(this.linkInput,"paste",t=>{t.stopPropagation()}))}updated(){D(this.popupContainer);const t=this.inlineEditor.toDomRange(this.targetInlineRange);if(D(t),this.type!=="view"){const n=t.getClientRects();Object.values(n).forEach(i=>{const r=document.createElement("div");r.classList.add("mock-selection","blocksuite-overlay"),r.style.left=`${i.left}px`,r.style.top=`${i.top}px`,r.style.width=`${i.width}px`,r.style.height=`${i.height}px`,D(this.mockSelectionContainer),this.mockSelectionContainer.appendChild(r)})}ii({getBoundingClientRect:()=>t.getBoundingClientRect(),getClientRects:()=>t.getClientRects()},this.popupContainer,{middleware:[Dt(10),P2(),tr({padding:6})]}).then(({x:n,y:i})=>{const r=this.popupContainer;r&&(r.style.left=`${n}px`,r.style.top=`${i}px`)}).catch(console.error)}get _pageService(){const t=this.std.spec.getService("affine:page");return D(t),t}get host(){return this.blockElement.host}get std(){return this.blockElement.std}get blockElement(){const t=this.inlineEditor.rootElement.closest(`[${lr}]`);return D(t),t}get currentText(){return this.inlineEditor.yTextString.slice(this.targetInlineRange.index,this.targetInlineRange.index+this.targetInlineRange.length)}get currentLink(){const t=this.inlineEditor.getFormat(this.targetInlineRange).link;return D(t),t}get _isBookmarkAllowed(){const t=this.blockElement,e=t.host.page.schema,n=t.host.page.getParent(t.model);D(n);const i=e.flavourSchemaMap.get("affine:bookmark");D(i);const r=e.flavourSchemaMap.get(n.flavour);D(r);try{e.validateSchema(i,r)}catch{return!1}return!0}get _canConvertToEmbedView(){return this._embedOptions?.viewType==="embed"}_onConfirm(){if(!this.inlineEditor.isValidInlineRange(this.targetInlineRange))return;D(this.linkInput);const t=this.linkInput.value;if(!t||!To(t))return;const e=k3(t);if(this.type==="create")this.inlineEditor.formatText(this.targetInlineRange,{link:e,reference:null},{mode:"replace"}),this.inlineEditor.setInlineRange(this.targetInlineRange);else if(this.type==="edit"){const n=this.textInput?.value??e;this.inlineEditor.insertText(this.targetInlineRange,n,{link:e,reference:null}),this.inlineEditor.setInlineRange({index:this.targetInlineRange.index,length:n.length})}this.abortController.abort()}_copyUrl(){navigator.clipboard.writeText(this.currentLink).catch(console.error),kt(this.host,"Copied link to clipboard"),this.abortController.abort()}_convertToCardView(){if(!this.inlineEditor.isValidInlineRange(this.targetInlineRange))return;let t="affine:bookmark";this._embedOptions&&this._embedOptions.viewType==="card"&&(t=this._embedOptions.flavour);const e=this.blockElement,n=this.currentLink,i=this.currentText,r={url:n,title:i===n?"":i},o=e.host.page,s=o.getParent(e.model);D(s);const a=s.children.indexOf(e.model);o.addBlock(t,r,s,a+1);const l=this.inlineEditor.yTextLength,c=this.targetInlineRange.length;l===c?o.deleteBlock(e.model):this.inlineEditor.formatText(this.targetInlineRange,{link:null}),this.abortController.abort()}_convertToEmbedView(){if(!this._embedOptions||this._embedOptions.viewType!=="embed")return;const{flavour:t}=this._embedOptions,e=this.currentLink,n=this.blockElement,i=n.page,r=i.getParent(n.model);D(r);const o=r.children.indexOf(n.model);i.addBlock(t,{url:e},r,o+1);const s=this.inlineEditor.yTextLength,a=this.targetInlineRange.length;s===a?i.deleteBlock(n.model):this.inlineEditor.formatText(this.targetInlineRange,{link:null}),this.abortController.abort()}_removeLink(){this.inlineEditor.isValidInlineRange(this.targetInlineRange)&&this.inlineEditor.formatText(this.targetInlineRange,{link:null}),this.abortController.abort()}_onKeydown(t){t.stopPropagation(),t.key==="Enter"&&!t.isComposing&&(t.preventDefault(),this._onConfirm())}_updateConfirmBtn(){D(this.confirmButton);const t=this.linkInput?.value;this.confirmButton.disabled=!(t&&To(t)),this.confirmButton.requestUpdate()}_confirmBtnTemplate(){return b`<icon-button
      class="affine-confirm-button"
      @click=${this._onConfirm}
      >${cb}</icon-button
    >`}_createTemplate(){return this.updateComplete.then(()=>{this.linkInput?.focus(),this._updateConfirmBtn()}).catch(console.error),b`
      <div class="affine-link-popover create">
        <input
          id="link-input"
          class="affine-link-popover-input"
          type="text"
          spellcheck="false"
          placeholder="Paste or type a link"
          @input=${this._updateConfirmBtn}
        />
        <span class="affine-link-popover-dividing-line"></span>
        ${this._confirmBtnTemplate()}
      </div>
    `}_toggleMoreMenu(){if(this._moreMenuAbortController){this._moreMenuAbortController.abort(),this._moreMenuAbortController=null;return}this._moreMenuAbortController=new AbortController;const t=new Oa;t.abortController=this.abortController,t.inlineEditor=this.inlineEditor,t.targetInlineRange=this.targetInlineRange,t.host=this.blockElement.host,Rs({template:t,container:this.popupContainer,computePosition:{referenceElement:this.popupContainer,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0},abortController:this._moreMenuAbortController})}_viewTemplate(){return this._embedOptions=this._pageService.getEmbedBlockOptions(this.currentLink),b`
      <div class="affine-link-popover view">
        <div class="affine-link-preview" @click=${()=>this._copyUrl()}>
          <span>${this.currentLink}</span>
        </div>

        <icon-button size="32px" @click=${()=>this._copyUrl()}>
          ${Tr}
          <affine-tooltip .offset=${12}>${"Click to copy link"}</affine-tooltip>
        </icon-button>

        <icon-button
          size="32px"
          data-testid="edit"
          @click=${()=>{this.type="edit"}}
        >
          ${p0}
          <affine-tooltip .offset=${12}>Edit</affine-tooltip>
        </icon-button>

        <span class="affine-link-popover-dividing-line"></span>

        ${this._isBookmarkAllowed?b`
              <div class="affine-link-popover-view-selector">
                <icon-button
                  size="24px"
                  class="affine-link-popover-view-selector-button link current-view"
                  hover="false"
                >
                  ${Yd}
                  <affine-tooltip .offset=${12}
                    >${"Inline view"}</affine-tooltip
                  >
                </icon-button>

                <icon-button
                  size="24px"
                  data-testid="link-to-card"
                  class="affine-link-popover-view-selector-button card"
                  hover="false"
                  @click=${()=>this._convertToCardView()}
                >
                  ${Yo}
                  <affine-tooltip .offset=${12}>${"Card view"}</affine-tooltip>
                </icon-button>

                ${this._canConvertToEmbedView?b` <icon-button
                      size="24px"
                      class="affine-link-popover-view-selector-button embed"
                      hover="false"
                      @click=${()=>this._convertToEmbedView()}
                    >
                      ${Qd}
                      <affine-tooltip .offset=${12}
                        >${"Embed view"}</affine-tooltip
                      >
                    </icon-button>`:ae}
              </div>

              <span class="affine-link-popover-dividing-line"></span>
            `:ae}

        <icon-button data-testid="unlink" @click=${()=>this._removeLink()}>
          ${ub}
          <affine-tooltip .offset=${12}>Remove</affine-tooltip>
        </icon-button>

        <span class="affine-link-popover-dividing-line"></span>

        <icon-button size="24px" @click=${()=>this._toggleMoreMenu()}>
          ${d0}
          <affine-tooltip .offset=${12}>More</affine-tooltip>
        </icon-button>
      </div>
    `}_editTemplate(){return this.updateComplete.then(()=>{D(this.textInput),this.textInput.value=this.currentText,D(this.linkInput),this.linkInput.value=this.currentLink,this.textInput.select(),this._updateConfirmBtn()}).catch(console.error),b`
      <div class="affine-link-edit-popover">
        <div class="affine-edit-text-area">
          <input
            class="affine-edit-text-input"
            id="text-input"
            type="text"
            placeholder="Enter text"
            @input=${this._updateConfirmBtn}
          />
          <span class="affine-link-popover-dividing-line"></span>
          <label class="affine-edit-text-text" for="text-input">Text</label>
        </div>
        <div class="affine-edit-link-area">
          <input
            id="link-input"
            class="affine-edit-link-input"
            type="text"
            spellcheck="false"
            placeholder="Paste or type a link"
            @input=${this._updateConfirmBtn}
          />
          <span class="affine-link-popover-dividing-line"></span>
          <label class="affine-edit-link-text" for="link-input">Link</label>
        </div>
        ${this._confirmBtnTemplate()}
      </div>
    `}render(){const t=this.type==="edit"||this.type==="create"?b`<div
            class="affine-link-popover-overlay-mask"
            @click=${()=>this.abortController.abort()}
          ></div>`:ae,e=this.type==="create"?this._createTemplate():this.type==="view"?this._viewTemplate():this._editTemplate();return b`
      <div class="overlay-root blocksuite-overlay">
        ${t}
        <div class="affine-link-popover-container" @keydown=${this._onKeydown}>
          ${e}
        </div>
        <div class="mock-selection-container"></div>
      </div>
    `}};or.styles=ioe;es([L()],or.prototype,"type",2);es([L({attribute:!1})],or.prototype,"inlineEditor",2);es([L({attribute:!1})],or.prototype,"targetInlineRange",2);es([L({attribute:!1})],or.prototype,"abortController",2);es([he("#text-input")],or.prototype,"textInput",2);es([he("#link-input")],or.prototype,"linkInput",2);es([he(".affine-link-popover-container")],or.prototype,"popupContainer",2);es([he(".mock-selection-container")],or.prototype,"mockSelectionContainer",2);es([he(".affine-confirm-button")],or.prototype,"confirmButton",2);or=es([W("link-popup")],or);function wP(t,e,n,i){const r=new or;return r.inlineEditor=t,r.type=e,r.targetInlineRange=n,r.abortController=i,document.body.appendChild(r),r}function V6(t){const e=[];return t.forEach(([n,i])=>{if(!i)return;const r=n.getFormat(i);e.push(r)}),e.length===0?{}:e.reduce((n,i)=>{const r={};for(const o in n){const s=o;n[s]===i[s]&&(r[s]=n[s])}return r})}function soe(t){let e={};return t.std.command.pipe().withHost().try(n=>[n.getTextSelection().getSelectedBlocks({types:["text"],filter:i=>Wm.includes(i.model.flavour)}).inline((i,r)=>{const{selectedBlocks:o}=i;D(o);const s=o.flatMap(a=>{const l=a.querySelector(`[${ni}]`);return l&&l.inlineEditor.getInlineRange()?l.inlineEditor:[]});e=V6(s.map(a=>[a,a.getInlineRange()])),r()}),n.getBlockSelections().getSelectedBlocks({types:["block"],filter:i=>qm.includes(i.model.flavour)}).inline((i,r)=>{const{selectedBlocks:o}=i;D(o);const s=o.flatMap(a=>{const l=a.querySelector(`[${ni}]`);return l?l.inlineEditor:[]});e=V6(s.map(a=>[a,{index:0,length:a.yTextLength}])),r()}),n.inline(()=>{const i=Array.from(t.querySelectorAll(`[${ni}]`)).filter(r=>{const o=document.getSelection();return!o||o.rangeCount===0?!1:o.getRangeAt(0).intersectsNode(r)}).filter(r=>{const o=r.closest(`[${lr}]`);return o?Ym.includes(o.model.flavour):!1}).map(r=>r.inlineEditor);e=V6(i.map(r=>[r,r.getInlineRange()]))})]).run(),e}function Ku(t,e){const n=Bl(t,e),i={styles:{[e]:n?null:!0}};t.std.command.pipe().withHost().try(r=>[r.getTextSelection().formatText(i),r.getBlockSelections().formatBlock(i),r.formatNative(i)]).run()}function Bl(t,e){const n=soe(t);return e in n}function aoe(t){let e=!1;return t.std.command.pipe().withHost().try(n=>[n.getTextSelection().getSelectedBlocks({types:["text"],filter:i=>Wm.includes(i.model.flavour)}).inline((i,r)=>{const{currentTextSelection:o,selectedBlocks:s}=i;if(D(o),D(s),o.isCollapsed())return;e=s.flatMap(l=>{const c=l.querySelector(`[${ni}]`);return c&&c.inlineEditor.getInlineRange()?c.inlineEditor:[]}).length>0,r()}),n.getBlockSelections().getSelectedBlocks({types:["block"],filter:i=>qm.includes(i.model.flavour)}).inline((i,r)=>{const{selectedBlocks:o}=i;D(o),e=o.flatMap(a=>{const l=a.querySelector(`[${ni}]`);return l?l.inlineEditor:[]}).length>0,r()}),n.inline(()=>{e=Array.from(t.querySelectorAll(`[${ni}]`)).filter(r=>{const o=document.getSelection();return!o||o.rangeCount===0?!1:o.getRangeAt(0).intersectsNode(r)}).filter(r=>{const o=r.closest(`[${lr}]`);return o?Ym.includes(o.model.flavour):!1}).map(r=>r.inlineEditor).length>0})]).run(),e}const dv=[{id:"bold",name:"Bold",icon:vL,hotkey:"Mod-b",activeWhen:t=>Bl(t,"bold"),action:t=>{Ku(t,"bold")}},{id:"italic",name:"Italic",icon:yL,hotkey:"Mod-i",activeWhen:t=>Bl(t,"italic"),action:t=>{Ku(t,"italic")}},{id:"underline",name:"Underline",icon:wL,hotkey:"Mod-u",activeWhen:t=>Bl(t,"underline"),action:t=>{Ku(t,"underline")}},{id:"strike",name:"Strikethrough",icon:xL,hotkey:"Mod-shift-s",activeWhen:t=>Bl(t,"strike"),action:t=>{Ku(t,"strike")}},{id:"code",name:"Code",icon:_L,hotkey:"Mod-e",activeWhen:t=>Bl(t,"code"),action:t=>{Ku(t,"code")}},{id:"link",name:"Link",icon:Yd,hotkey:"Mod-k",activeWhen:t=>Bl(t,"link"),action:()=>{const t=document.getSelection();if(!t||t.rangeCount===0)return;const n=t.getRangeAt(0).commonAncestorContainer.parentElement?.closest(`[${ni}]`);if(!n)return;const i=n.inlineEditor,r=i.getInlineRange();if(D(r),r.length===0)return;if(i.getFormat(r).link){i.formatText(r,{link:null});return}const s=new AbortController,a=wP(i,"create",r,s);s.signal.addEventListener("abort",()=>a.remove())}}],xP=["red","orange","yellow","green","teal","blue","purple","grey"],loe=[{name:"Default Background",color:null,hotkey:null},...xP.map(t=>({name:`${t[0].toUpperCase()}${t.slice(1)} Background`,color:`var(--affine-text-highlight-${t})`,hotkey:null}))],coe=[{name:"Default Color",color:null,hotkey:null},...xP.map(t=>({name:`${t[0].toUpperCase()}${t.slice(1)}`,color:`var(--affine-text-highlight-foreground-${t})`,hotkey:null}))];let p2=null,_P=1;const O8=(t,e,n)=>{p2=e,_P=n;const i={styles:{color:n===0?e:null,background:n===1?e:null}};t.std.command.pipe().withHost().try(r=>[r.getTextSelection().formatText(i),r.getBlockSelections().formatBlock(i),r.formatNative(i)]).run()},doe=(t,e)=>b`<div ${$t(e)} class="highlight-panel">
    <!-- Text Color Highlight -->
    <div class="highligh-panel-heading">Color</div>
    ${coe.map(({name:n,color:i})=>b`<icon-button
          width="100%"
          height="32px"
          style="padding-left: 4px; justify-content: flex-start; gap: 8px;"
          text="${n}"
          data-testid="${i??"unset"}"
          @click="${()=>{O8(t.host,i,0),t.requestUpdate()}}"
        >
          <span style="color: ${i}; display: flex; align-items: center;">
            ${VL}
          </span>
        </icon-button>`)}

    <!-- Text Background Highlight -->
    <div class="highligh-panel-heading">Background</div>
    ${loe.map(({name:n,color:i})=>b`<icon-button
          width="100%"
          height="32px"
          style="padding-left: 4px; justify-content: flex-start; gap: 8px;"
          text="${n}"
          @click="${()=>{O8(t.host,i,1),t.requestUpdate()}}"
        >
          <span
            style="color: ${i??"rgba(0,0,0,0)"}; display: flex; align-items: center;"
          >
            ${UL}
          </span>
        </icon-button>`)}
  </div>`,uoe=t=>{const e=t.blockElement.host,{setFloating:n,setReference:i}=sv(o=>{if(!o){const l=t.shadowRoot?.querySelector(".highlight-panel");if(!l)return;l.style.display="none";return}const s=t.shadowRoot?.querySelector(".highlight-button"),a=t.shadowRoot?.querySelector(".highlight-panel");D(s),D(a),a.style.display="block",ii(s,a,{placement:"bottom",middleware:[Dn(),Dt(10),tr({padding:6})]}).then(({x:l,y:c})=>{a.style.left=`${l}px`,a.style.top=`${c}px`}).catch(console.error)}),r=doe(t,n);return b`<div ${$t(i)} class="highlight-button">
    <icon-button
      class="highlight-icon"
      data-last-used="${p2??"unset"}"
      width="52px"
      height="32px"
      @click="${()=>O8(e,p2,_P)}"
    >
      <span
        style="color: ${p2}; display: flex; align-items: center; "
        >${bb}</span
      >
      ${m3}</icon-button
    >
    ${r}
  </div>`},hoe=t=>{const e=t.host;if(!aoe(e))return null;const n=uoe(t);return b`${dv.map(({id:i,name:r,icon:o,action:s,activeWhen:a})=>b`<icon-button
          size="32px"
          data-testid=${i}
          ?active=${a(e)}
          @click=${()=>{s(e),t.requestUpdate()}}
        >
          ${o}
          <affine-tooltip>${r}</affine-tooltip>
        </icon-button>`)}
    <div class="divider"></div>
    ${n}`},wa=[{flavour:"affine:paragraph",type:"text",name:"Text",hotkey:["Mod-Alt-0","Mod-Shift-0"],icon:h0},{flavour:"affine:paragraph",type:"h1",name:"Heading 1",hotkey:["Mod-Alt-1","Mod-Shift-1"],icon:W9},{flavour:"affine:paragraph",type:"h2",name:"Heading 2",hotkey:["Mod-Alt-2","Mod-Shift-2"],icon:q9},{flavour:"affine:paragraph",type:"h3",name:"Heading 3",hotkey:["Mod-Alt-3","Mod-Shift-3"],icon:Y9},{flavour:"affine:paragraph",type:"h4",name:"Heading 4",hotkey:["Mod-Alt-4","Mod-Shift-4"],icon:X9},{flavour:"affine:paragraph",type:"h5",name:"Heading 5",hotkey:["Mod-Alt-5","Mod-Shift-5"],icon:K9},{flavour:"affine:paragraph",type:"h6",name:"Heading 6",hotkey:["Mod-Alt-6","Mod-Shift-6"],icon:Q9},{flavour:"affine:list",type:"bulleted",name:"Bulleted List",hotkey:["Mod-Alt-8","Mod-Shift-8"],icon:J9},{flavour:"affine:list",type:"numbered",name:"Numbered List",hotkey:["Mod-Alt-9","Mod-Shift-9"],icon:eb},{flavour:"affine:list",type:"todo",name:"To-do List",hotkey:null,icon:ob},{flavour:"affine:code",type:void 0,name:"Code Block",hotkey:["Mod-Alt-c"],icon:sb},{flavour:"affine:paragraph",type:"quote",name:"Quote",hotkey:null,icon:ab},{flavour:"affine:divider",type:"divider",name:"Divider",hotkey:["Mod-Alt-d","Mod-Shift-d"],icon:lb}];function CP(t){if(t.length===0)throw new Error("No models to merge");const e=t[0].page,n=e.getParent(t[0]);D(n);const i=n.children.indexOf(t[0]),r=t.map(s=>s.text instanceof Oi?s.text.toString():null).filter(Boolean).join(`
`);return t.map(s=>e.deleteBlock(s)),e.addBlock("affine:code",{text:new Oi(r)},n,i)}function W3(t,e,n){const i=t.page,r=i.getParent(t);D(r);const o={text:t?.text?.clone(),children:t.children,...n},s=r.children.indexOf(t),a=i.addBlock(e,o,r,s);return i.deleteBlock(t),a}function hp(t,e,n){if(t.length===0)return[];const i=t[0].host,r=t[0].page;t.every(g=>g.page===r)||console.error("Not all models have the same page instance, the result for update text type may not be correct",t),r.captureSync();const s=t.map(g=>g.model);if(e==="affine:code"){const g=CP(s),f=r.getBlockById(g);if(!f)throw new Error("Failed to get model after merge code block!");return Zd(i,f,{index:f.text?.length??0,length:0}).catch(console.error),[f]}if(e==="affine:divider"){const g=s.at(-1);if(!g)return[];const f=r.getParent(g);if(!f)return[];const v=f.children.indexOf(g),m=r.getNextSibling(g);let y=m?.id;const x=r.addBlock("affine:divider",{},f,v+1);m||(y=r.addBlock("affine:paragraph",{},f)),$n(i,r,y)?.catch(console.error);const T=r.getBlockById(x);if(!T)throw new Error("Failed to get model after add divider block!");return[T]}const a=[];s.forEach(g=>{if(rO(g,["affine:paragraph","affine:list","affine:code"]),g.flavour===e){r.updateBlock(g,{type:n}),a.push(g);return}const f=W3(g,e,{type:n}),v=r.getBlockById(f);if(!v)throw new Error("Failed to get new model after transform block!");a.push(v)});const l=a[0],c=a[a.length-1],d=a.map(g=>nv(i,g)),u=i.selection,h=u.find("text"),p=u.filter("block");if(h){const g=u.create("text",{from:{path:h.from.path.slice(0,-1).concat(l.id),index:h.from.index,length:h.from.length},to:h.to?{path:h.to.path.slice(0,-1).concat(c.id),index:h.to.index,length:h.to.length}:null});return Promise.all(d).then(()=>{u.setGroup("note",[g])}).catch(console.error),a}return p.length!==0&&requestAnimationFrame(()=>{const g=a.map(f=>u.create("block",{path:p[0].path.slice(0,-1).concat(f.id)}));u.setGroup("note",g)}),a}const poe=(t,e,n)=>{if(t.length===0)throw new Error("No models to update!");const{flavour:i,type:r}=wa[0],o=t.every(a=>a.flavour===e&&a.model.type===n)?i:e,s=t.every(a=>a.flavour===e&&a.model.type===n)?r:n;hp(t,o,s)},foe=({page:t,selectedBlockElements:e,ref:n})=>b`<div ${$t(n)} class="paragraph-panel">
    ${wa.filter(({flavour:i})=>i!=="affine:divider").filter(({flavour:i})=>t.schema.flavourSchemaMap.has(i)).map(({flavour:i,type:r,name:o,icon:s})=>b`<icon-button
            width="100%"
            height="32px"
            style="padding-left: 12px; justify-content: flex-start; gap: 8px;"
            text="${o}"
            data-testid="${i}/${r}"
            @click="${()=>poe(e,i,r)}"
          >
            ${s}
          </icon-button>`)}
  </div>`,goe=t=>{if(t.displayType!=="text"&&t.displayType!=="block")return null;const e=t.selectedBlockElements;if(e.some(a=>!a.model.text))return null;const n=e.length<1?wa[0].icon:wa.find(({flavour:a,type:l})=>e[0].flavour===a&&e[0].model.type===l)?.icon??wa[0].icon,i=t.blockElement;if(!sp(i))throw new Error("paragraph button host is not a page component");const{setFloating:r,setReference:o}=sv(a=>{if(!a){const u=t.shadowRoot?.querySelector(".paragraph-panel");if(!u)return;u.style.display="none";return}const l=t.formatBarElement,c=t.shadowRoot?.querySelector(".paragraph-button"),d=t.shadowRoot?.querySelector(".paragraph-panel");D(c),D(d),D(l,"format quick bar should exist"),d.style.display="block",ii(l,d,{placement:"top-start",middleware:[Dn(),Dt(4),tr({padding:6})]}).then(({x:u,y:h})=>{d.style.left=`${u}px`,d.style.top=`${h}px`}).catch(console.error)}),s=foe({selectedBlockElements:e,page:t.host.page,ref:r});return b`<div ${$t(o)} class="paragraph-button">
    <icon-button class="paragraph-button-icon" width="52px" height="32px">
      ${n} ${m3}</icon-button
    >
    ${s}
  </div>`},moe=X`
  .paragraph-button-icon > svg:nth-child(2) {
    transition-duration: 0.3s;
  }
  .paragraph-button-icon:is(:hover, :focus-visible, :active)
    > svg:nth-child(2) {
    transform: rotate(180deg);
  }

  .paragraph-panel {
    display: none;

    font-size: var(--affine-font-sm);
    box-sizing: border-box;
    position: absolute;
    min-width: 173px;
    padding: 8px 4px;
    overflow-y: auto;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
    z-index: var(--affine-z-index-popover);
  }

  .highlight-icon > svg:nth-child(2) {
    transition-duration: 0.3s;
  }
  .highlight-icon:is(:hover, :focus-visible, :active) > svg:nth-child(2) {
    transform: rotate(180deg);
  }

  .highlight-panel {
    display: none;

    font-size: var(--affine-font-sm);
    box-sizing: border-box;
    position: absolute;
    min-width: 178px;
    padding: 8px 8px;
    max-height: 380px;
    overflow-y: auto;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
    z-index: var(--affine-z-index-popover);
  }

  ${uu(".highlight-panel")}

  .highligh-panel-heading {
    color: var(--affine-text-secondary-color);
    padding: 4px;
  }
`,boe=X`
  .affine-format-bar-widget {
    box-sizing: border-box;
    position: absolute;
    display: none;
    align-items: center;
    padding: 4px 8px;
    gap: 4px;
    height: 40px;
    width: max-content;

    border-radius: 8px;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    z-index: var(--affine-z-index-popover);
    user-select: none;
  }

  .divider {
    width: 1px;
    height: 24px;
    background-color: var(--affine-border-color);
  }

  ${moe}
`;var voe=Object.defineProperty,yoe=Object.getOwnPropertyDescriptor,kP=(t,e,n,i)=>{for(var r=i>1?void 0:i?yoe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&voe(e,n,r),r};const Ra="affine-format-bar-widget";let Na=class extends to{constructor(){super(...arguments),this._dragging=!1,this._displayType="none",this._selectedBlockElements=[],this._abortController=new AbortController,this._placement="top",this._floatDisposables=null}static registerCustomRenderer(t){this._customElements.add(t)}static registerCustomElement(t){let e;this._customElements.add({...t,render:n=>(e||(e=t.init(n)),t.showWhen?.(n)??!0?b`${e}`:void 0)})}static registerCustomAction(t){this._customElements.add({render:e=>{const n=t.icon(e);if(n==null)return;const i=t.disable?t.disable(e):!1;return b`<icon-button
          size="32px"
          ?disabled=${i}
          @click=${()=>{i||t.onClick(e)}}
        >
          <img src="${n}" alt="" />
        </icon-button>`}})}get _selectionManager(){return this.host.selection}get displayType(){return this._displayType}get selectedBlockElements(){return this._selectedBlockElements}get nativeRange(){const t=document.getSelection();return!t||t.rangeCount===0?null:t.getRangeAt(0)}_reset(){this._displayType="none",this._selectedBlockElements=[]}_shouldDisplay(){if(document.querySelector("side-layout-modal")||this.displayType==="block"&&this._selectedBlockElements?.[0]?.flavour==="affine:surface-ref")return!1;if(this.displayType==="block"&&this._selectedBlockElements.length===1){const n=this._selectedBlockElements[0];if(!Ie(n.model,["affine:paragraph","affine:list"]))return!1}return!this.page.awarenessStore.isReadonly(this.page)&&this.displayType!=="none"&&!this._dragging}connectedCallback(){super.connectedCallback(),this._abortController=new AbortController;const t=this.blockElement;D(t);const e=t.widgets;if(Object.hasOwn(e,Ra)){if(!sp(t))throw new Error(`format bar not support pageElement: ${t.constructor.name} but its widgets has format bar`);this.disposables.add(this.host.event.add("dragStart",()=>{this._dragging=!0,this.requestUpdate()})),this.disposables.add(this.host.event.add("dragEnd",()=>{this._dragging=!1,this.requestUpdate()})),this.disposables.add(this.host.event.add("pointerUp",n=>{let i=null;if(this.displayType==="text"||this.displayType==="native"){const a=this.nativeRange;D(a),i=a.getBoundingClientRect()}else if(this.displayType==="block"){const a=this._selectedBlockElements[0];if(!a)return;i=a.getBoundingClientRect()}else return;const{top:r,bottom:o}=this.host.getBoundingClientRect(),s=n.get("pointerState");o-i.bottom<50?this._placement="top":i.top-Math.max(r,0)<50?this._placement="bottom":s.raw.y<i.top+i.height/2?this._placement="top":this._placement="bottom"})),this.disposables.add(this._selectionManager.slots.changed.on(async()=>{await this.host.updateComplete;const n=t.selection.find("text"),i=t.selection.filter("block");if(n){const r=this.host.view.viewFromPath("block",n.path);!n.isCollapsed()&&r&&r.model.role==="content"?(this._displayType="text",D(t.host.rangeManager),this.host.std.command.pipe().withHost().getTextSelection().getSelectedBlocks({types:["text"]}).inline(o=>{const{selectedBlocks:s}=o;D(s),this._selectedBlockElements=s}).run()):this._reset()}else i.length>0?(this._displayType="block",this._selectedBlockElements=i.map(r=>{const o=r.path;return this.blockElement.host.view.viewFromPath("block",o)}).filter(r=>!!r)):this._reset();this.requestUpdate()})),this.disposables.addFromEvent(document,"selectionchange",()=>{const n=this.host.selection.find("database"),i=()=>{this._reset(),this.requestUpdate()};if(n){const r=n.viewSelection;if(r.type==="table"&&!r.isEditing||r.type==="kanban"&&r.selectionType!=="cell"||!r.isEditing)return i();const o=this.nativeRange;if(!o||o.collapsed)return i();this._displayType="native",this.requestUpdate()}})}}updated(){if(!this._shouldDisplay()){this._floatDisposables&&this._floatDisposables.dispose();return}this._floatDisposables=new dt;const t=this.formatBarElement;if(D(t,"format quick bar should exist"),this.displayType==="text"||this.displayType==="native"){const e=this.nativeRange;if(!e)return;const n={getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects()};Xn.globalAbortController?.abort(),this._floatDisposables.add(zl(n,t,()=>{const i=this.nativeRange;if(!i)return;ii({getBoundingClientRect:()=>i.getBoundingClientRect(),getClientRects:()=>i.getClientRects()},t,{placement:this._placement,middleware:[Dt(10),P2(),tr({padding:6})]}).then(({x:o,y:s})=>{t.style.display="flex",t.style.top=`${s}px`,t.style.left=`${o}px`}).catch(console.error)},{animationFrame:!0}))}else if(this.displayType==="block"){let n=this._selectedBlockElements[0]?.getBoundingClientRect();if(!n)return;this._selectedBlockElements.forEach(r=>{const o=r.getBoundingClientRect();o.top<n.top&&(n=new DOMRect(n.left,o.top,n.width,n.bottom)),o.bottom>n.bottom&&(n=new DOMRect(n.left,n.top,n.width,o.bottom)),o.left<n.left&&(n=new DOMRect(o.left,n.top,n.right,n.bottom)),o.right>n.right&&(n=new DOMRect(n.left,n.top,o.right,n.bottom))});const i={getBoundingClientRect:()=>n,getClientRects:()=>this._selectedBlockElements.map(r=>r.getBoundingClientRect())};Xn.globalAbortController?.abort(),this._floatDisposables.add(zl(i,t,()=>{ii(i,t,{placement:this._placement,middleware:[Dt(10),P2(),tr({padding:6})]}).then(({x:r,y:o})=>{t.style.display="flex",t.style.top=`${o}px`,t.style.left=`${r}px`}).catch(console.error)},{animationFrame:!0}))}}_customRender(){const t=[];return Na._customElements.forEach(e=>{const n=e.render(this);n&&t.push(n)}),t.length>0?b` <div
          style="display: flex;align-items: center;justify-content: center"
        >
          ${t}
        </div>`:null}disconnectedCallback(){super.disconnectedCallback(),this._abortController.abort(),this._reset()}render(){if(!this._shouldDisplay())return ae;const t=goe(this),e=hoe(this),n=Jre(this),i=[this._customRender(),t,e,n].filter(o=>!!o),r=i.reduce((o,s,a)=>a===i.length-1?[...o,s]:[...o,s,b` <div class="divider"></div>`],[]);return b` <div
      class="${Ra}"
      @pointerdown="${at}"
    >
      ${r}
    </div>`}};Na.styles=boe;Na._customElements=new Set;kP([he(`.${Ra}`)],Na.prototype,"formatBarElement",2);Na=kP([W(Ra)],Na);const EP={name:"",size:0,type:"application/octet-stream",sourceId:void 0,caption:void 0,embed:!1},q3=_i({flavour:"affine:attachment",props:()=>EP,metadata:{version:1,role:"content",parent:["affine:note"]},toModel:()=>new uv});class uv extends Bn{}const woe="affine-attachment";function xoe(t){const e={};for(const n in EP){const i=n;e[i]=t[i]}return e}async function SP(t){const e=t.page.blob,n=t.sourceId;if(!n)return null;const i=await e.get(n);return i||null}async function _oe(t,e){const n=await SP(e);if(!n){kt(t,"Failed to download attachment!"),console.error("attachment load failed! sourceId:",e.sourceId,"BlobManager:",e.page.blob);return}jm(n,e.name)}async function Coe(t){if(!t.page.schema.flavourSchemaMap.has("affine:image"))throw new Error("The image flavour is not supported!");const e=t.sourceId;D(e);const{saveAttachmentData:n,getImageData:i}=Wk();n(e,{name:t.name});const r=t.sourceId?i(t.sourceId):void 0,o={sourceId:e,caption:t.caption,size:t.size,...r};W3(t,"affine:image",o)}function koe(t,e){if(!t.page.schema.flavourSchemaMap.has("affine:attachment"))throw new Error("The attachment flavour is not supported!");if(!t.sourceId)throw new Error("Image data not aviailable");const n=t.sourceId;D(n);const{saveImageData:i,getAttachmentData:r}=Wk();i(n,{width:t.width,height:t.height});const o=r(t.sourceId),s={sourceId:n,name:woe,size:e.size,type:e.type,caption:t.caption,embed:!1,...o};W3(t,"affine:attachment",s)}async function Eoe(t,e,n,i){if(IP(n))throw new Error("the attachment is already uploading!");U_(n,!0);const o=e.blob;try{const s=await o.set(i),a=e.getBlockById(n);if(!a)throw new Error("the attachment model is not found!");if(!(a instanceof uv))throw console.error(a),new Error("the model is not an attachment model!");e.withoutTransact(()=>{e.updateBlock(a,{sourceId:s})})}catch(s){console.error(s),s instanceof Error&&kt(t,`Failed to upload attachment! ${s.message||s.toString()}`)}finally{U_(n,!1)}return n}async function TP(t,e,n,i,r="after"){if(e.size>n)return kt(t,`You can only upload files less than ${Gl(n,!0,0)}`),null;const o=i.page,a={id:o.generateBlockId(),flavour:"affine:attachment",name:e.name,size:e.size,type:e.type,embed:!1},[l]=o.addSiblingBlocks(i,[a],r);return Eoe(t,o,l,e)}const R8=new Set;function U_(t,e){e?R8.add(t):R8.delete(t)}function IP(t){return R8.has(t)}var V_=Object.freeze,Soe=Object.defineProperty,Toe=(t,e)=>V_(Soe(t,"raw",{value:V_(e||t.slice())})),z_;function Ioe(){const t=b(z_||(z_=Toe([`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>LEDITS - a Hugging Face Space by editing-images</title>
        <script
          type="module"
          src="https://gradio.s3-us-west-2.amazonaws.com/3.36.1/gradio.js"
        ><\/script>
        <style>
          html,
          body {
            margin: 0;
            padding: 0;
          }

          gradio-app .gradio-container {
            margin-top: 0 !important;
            margin-bottom: 0 !important;
          }
        </style>
      </head>
      <body>
        <gradio-app src="https://editing-images-ledits.hf.space"></gradio-app>
      </body>
      <script>
        const queue = [];
        let ready = false;

        const base64ToBlob = (b64Data, contentType = '', sliceSize = 256) => {
          const byteCharacters = atob(b64Data);
          const byteArrays = [];

          for (
            let offset = 0;
            offset < byteCharacters.length;
            offset += sliceSize
          ) {
            const slice = byteCharacters.slice(offset, offset + sliceSize);

            const byteNumbers = new Array(slice.length);
            for (let i = 0; i < slice.length; i++) {
              byteNumbers[i] = slice.charCodeAt(i);
            }

            const byteArray = new Uint8Array(byteNumbers);
            byteArrays.push(byteArray);
          }

          const blob = new Blob(byteArrays, { type: contentType });
          return blob;
        };

        const getResultImage = () => {
          const gradioApp = document.querySelector('gradio-app');
          const resultImg = gradioApp.querySelector('#output_image > img');

          if (resultImg === null) return null;

          const pattern = /^data:(image/w+);/;
          const execResult = pattern.exec(resultImg.src);

          if (!execResult) return null;

          return base64ToBlob(resultImg.src.split(',')[1], execResult[1]);
        };

        const blobToFile = blob => {
          return new File([blob], 'image.png', { type: blob.type });
        };

        function setImage({ image }) {
          const input = getInputElement();
          const file = blobToFile(image);
          const container = new DataTransfer();
          container.items.add(file);

          input.files = container.files;
          input.dispatchEvent(new Event('change', { bubbles: true }));
        }

        window.addEventListener(
          'message',
          e => {
            const { source, data } = e;

            if (ready === false) {
              queue.push(data);
            } else {
              execute(data);
            }
          },
          false
        );

        function execute(task) {
          if (!task.type) return;

          switch (task.type) {
            case 'set_image':
              setImage(task);
              break;
            case 'export_image':
              const resultImage = getResultImage();
              window.parent.postMessage({ blob: resultImage }, '*');
              break;
            default:
              break;
          }
        }

        function executeQueueTask() {
          if (!checkInputReady()) {
            setTimeout(executeQueueTask, 500);
          } else {
            ready = true;
            for (let task of queue) {
              execute(task);
            }
          }
        }

        function getInputElement() {
          const gradioApp = document.querySelector('gradio-app');
          return gradioApp.querySelector('#input_image input[type="file"]');
        }

        function checkInputReady() {
          return !!getInputElement();
        }

        executeQueueTask();
      <\/script>
    </html>`],[`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>LEDITS - a Hugging Face Space by editing-images</title>
        <script
          type="module"
          src="https://gradio.s3-us-west-2.amazonaws.com/3.36.1/gradio.js"
        ><\/script>
        <style>
          html,
          body {
            margin: 0;
            padding: 0;
          }

          gradio-app .gradio-container {
            margin-top: 0 !important;
            margin-bottom: 0 !important;
          }
        </style>
      </head>
      <body>
        <gradio-app src="https://editing-images-ledits.hf.space"></gradio-app>
      </body>
      <script>
        const queue = [];
        let ready = false;

        const base64ToBlob = (b64Data, contentType = '', sliceSize = 256) => {
          const byteCharacters = atob(b64Data);
          const byteArrays = [];

          for (
            let offset = 0;
            offset < byteCharacters.length;
            offset += sliceSize
          ) {
            const slice = byteCharacters.slice(offset, offset + sliceSize);

            const byteNumbers = new Array(slice.length);
            for (let i = 0; i < slice.length; i++) {
              byteNumbers[i] = slice.charCodeAt(i);
            }

            const byteArray = new Uint8Array(byteNumbers);
            byteArrays.push(byteArray);
          }

          const blob = new Blob(byteArrays, { type: contentType });
          return blob;
        };

        const getResultImage = () => {
          const gradioApp = document.querySelector('gradio-app');
          const resultImg = gradioApp.querySelector('#output_image > img');

          if (resultImg === null) return null;

          const pattern = /^data:(image\\/\\w+);/;
          const execResult = pattern.exec(resultImg.src);

          if (!execResult) return null;

          return base64ToBlob(resultImg.src.split(',')[1], execResult[1]);
        };

        const blobToFile = blob => {
          return new File([blob], 'image.png', { type: blob.type });
        };

        function setImage({ image }) {
          const input = getInputElement();
          const file = blobToFile(image);
          const container = new DataTransfer();
          container.items.add(file);

          input.files = container.files;
          input.dispatchEvent(new Event('change', { bubbles: true }));
        }

        window.addEventListener(
          'message',
          e => {
            const { source, data } = e;

            if (ready === false) {
              queue.push(data);
            } else {
              execute(data);
            }
          },
          false
        );

        function execute(task) {
          if (!task.type) return;

          switch (task.type) {
            case 'set_image':
              setImage(task);
              break;
            case 'export_image':
              const resultImage = getResultImage();
              window.parent.postMessage({ blob: resultImage }, '*');
              break;
            default:
              break;
          }
        }

        function executeQueueTask() {
          if (!checkInputReady()) {
            setTimeout(executeQueueTask, 500);
          } else {
            ready = true;
            for (let task of queue) {
              execute(task);
            }
          }
        }

        function getInputElement() {
          const gradioApp = document.querySelector('gradio-app');
          return gradioApp.querySelector('#input_image input[type="file"]');
        }

        function checkInputReady() {
          return !!getInputElement();
        }

        executeQueueTask();
      <\/script>
    </html>`])));return`data:text/html,${encodeURIComponent(String.raw(t.strings,...t.values))}`}var Loe=Object.defineProperty,Moe=Object.getOwnPropertyDescriptor,Poe=(t,e,n,i)=>{for(var r=i>1?void 0:i?Moe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Loe(e,n,r),r};let g5=class extends Ae{constructor(){super(...arguments),this._loaded=!1,this._setImage=t=>{t.contentWindow?.postMessage({type:"set_image",image:this.imageBlob},"*")}}firstUpdated(){const t=this.renderRoot.querySelector("iframe");t&&(t.src=Ioe(),t.onload=()=>{this._setImage(t),t.onload=null},this._iframe=t,this._loaded=!0)}exportImage(){if(!this._iframe||!this._loaded||!this._iframe.contentWindow)return Promise.resolve(this.imageBlob);const t=this._iframe.contentWindow;return new Promise(n=>{window.addEventListener("message",i=>{const r=i.data?.blob;n(r)},{once:!0}),t.postMessage({type:"export_image"},"*")})}render(){return b`<div class="gradio-app-wrapper">
      <iframe
        style="border: 0;width: 100%; height: 100%"
        sandbox="allow-forms allow-scripts allow-downloads"
        src="about:blank"
      ></iframe>
    </div>`}};g5.styles=X`
    .gradio-app-wrapper {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .gradio-app-footer {
      display: flex;
      justify-content: flex-end;
      gap: 2rem;
    }
  `;g5=Poe([W("ledits-gradio-app")],g5);function Aoe(){return new g5}function $oe(t){return D(t.page.root?.id),t.view.viewFromPath("block",[t.page.root.id])}function Boe(t,e,n){const i=$oe(n),r=Aoe(),o=i.widgetElements["affine-modal-widget"].open({footer:[{text:"Cancel",onClick:()=>{o.close()}},{type:"primary",text:"Save",onClick:async()=>{const s=await r.exportImage();(!s||s===e)&&o.close(),t.page.blob.set(s).then(l=>{t.page.updateBlock(t,{sourceId:l}),o.close()}).catch(console.error)}}],entry(s){r.imageBlob=e,s.appendChild(r)}})}function Doe({editorHost:t,ref:e,model:n,blob:i,abortController:r,host:o}){const s=n.page.schema.flavourSchemaMap.has("affine:attachment"),a=n.page.readonly;return b`
    <style>
      :host {
        z-index: 1;
      }
      .affine-embed-editing-state-container > div {
        display: block;
      }

      .embed-editing-state {
        box-sizing: border-box;
        box-shadow: var(--affine-shadow-2);
        border-radius: 8px;
        list-style: none;
        padding: 4px;
        background-color: var(--affine-background-overlay-panel-color);
        margin: 0;
      }
      .delete-image-button:hover {
        background: var(--affine-background-error-color);
        color: var(--affine-error-color);
      }
      .delete-image-button:hover > svg {
        color: var(--affine-error-color);
      }
    </style>

    <div
      ${$t(e)}
      class="affine-embed-editing-state-container"
      @pointerdown=${at}
    >
      <div class="embed-editing-state">
        ${s?b`<icon-button
              size="32px"
              ?hidden=${a||!i}
              @click=${()=>{i&&(r.abort(),koe(n,i))}}
            >
              ${Yo}
              <affine-tooltip>Turn into Card view</affine-tooltip>
            </icon-button>`:ae}
        <icon-button
          size="32px"
          ?hidden=${a}
          @click=${()=>hie(t,n)}
        >
          ${Kd}
          <affine-tooltip tip-position="right">Caption</affine-tooltip>
        </icon-button>
        <icon-button size="32px" @click=${()=>uie(n)}>
          ${g3}
          <affine-tooltip tip-position="right">Download</affine-tooltip>
        </icon-button>
        <icon-button size="32px" @click=${()=>die(t,n)}>
          ${Tr}
          <affine-tooltip tip-position="right"
            >Copy to clipboard</affine-tooltip
          >
        </icon-button>
        <icon-button
          class="delete-image-button"
          size="32px"
          ?hidden=${a}
          @click="${()=>{r.abort(),n.page.deleteBlock(n)}}"
        >
          ${xn}
          <affine-tooltip tip-position="right">Delete</affine-tooltip>
        </icon-button>
        <icon-button
          size="32px"
          ?hidden=${a||!i||!n.page.awarenessStore.getFlag("enable_bultin_ledits")}
          @click="${()=>{i&&(r.abort(),Boe(n,i,o))}}"
        >
          ${bb}
          <affine-tooltip tip-position="right">Edit with LEDITS</affine-tooltip>
        </icon-button>
      </div>
    </div>
  `}var Ooe=Object.defineProperty,Roe=Object.getOwnPropertyDescriptor,Noe=(t,e,n,i)=>{for(var r=i>1?void 0:i?Roe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ooe(e,n,r),r};const Hoe="affine-image-toolbar-widget";let N8=class extends to{constructor(){super(...arguments),this._hoverController=new Xn(this,({abortController:t})=>{const e=this.blockElement,n=this.host.selection,i=n.find("text");if(i&&(i.to||i.from.length))return null;const r=n.filter("block");if(r.length>1||r.length===1&&r[0].path!==e.path)return null;const o=e.resizeImg;return o?{template:Doe({editorHost:this.host,model:e.model,blob:e.blob,abortController:t,host:this.blockElement.host}),computePosition:{referenceElement:o,placement:"right-start",middleware:[Dt({mainAxis:12,crossAxis:10}),tr({crossAxis:!0,padding:{top:B2+12,bottom:12,right:12},limiter:hk()})],autoUpdate:!0}}:null})}connectedCallback(){super.connectedCallback();const t=this.blockElement;this._hoverController.setReference(t)}};N8=Noe([W(Hoe)],N8);var Foe=Object.defineProperty,Uoe=Object.getOwnPropertyDescriptor,Y3=(t,e,n,i)=>{for(var r=i>1?void 0:i?Uoe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Foe(e,n,r),r};let md=class extends Ae{constructor(){super(),this.hostModel=null,this.radius="8px",this.width="150px"}connectedCallback(){super.connectedCallback(),this.hostModel&&(this.setAttribute(lr,this.hostModel.id),this.setAttribute("data-service-loading","true"));const t=this.width;this.style.setProperty("--loader-width",typeof t=="string"?t:`${t}px`)}render(){return b`
      <div class="load-container">
        <div class="load load1"></div>
        <div class="load load2"></div>
        <div class="load"></div>
      </div>
    `}};md.styles=X`
    .load-container {
      margin: 10px auto;
      width: var(--loader-width);
      text-align: center;
    }

    .load-container .load {
      width: 8px;
      height: 8px;
      background-color: var(--affine-text-primary-color);

      border-radius: 100%;
      display: inline-block;
      -webkit-animation: bouncedelay 1.4s infinite ease-in-out;
      animation: bouncedelay 1.4s infinite ease-in-out;
      /* Prevent first note from flickering when animation starts */
      -webkit-animation-fill-mode: both;
      animation-fill-mode: both;
    }
    .load-container .load1 {
      -webkit-animation-delay: -0.32s;
      animation-delay: -0.32s;
    }
    .load-container .load2 {
      -webkit-animation-delay: -0.16s;
      animation-delay: -0.16s;
    }

    @-webkit-keyframes bouncedelay {
      0%,
      80%,
      100% {
        -webkit-transform: scale(0.625);
      }
      40% {
        -webkit-transform: scale(1);
      }
    }

    @keyframes bouncedelay {
      0%,
      80%,
      100% {
        transform: scale(0);
        -webkit-transform: scale(0.625);
      }
      40% {
        transform: scale(1);
        -webkit-transform: scale(1);
      }
    }
  `;Y3([L({attribute:!1})],md.prototype,"hostModel",2);Y3([L({attribute:!1})],md.prototype,"radius",2);Y3([L({attribute:!1})],md.prototype,"width",2);md=Y3([W("loader-element")],md);function ch(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var LP={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,r,o){function s(c,d){if(!r[c]){if(!i[c]){var u=typeof ch=="function"&&ch;if(!d&&u)return u(c,!0);if(a)return a(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var p=r[c]={exports:{}};i[c][0].call(p.exports,function(g){var f=i[c][1][g];return s(f||g)},p,p.exports,n,i,r,o)}return r[c].exports}for(var a=typeof ch=="function"&&ch,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,i,r){var o=n("./utils"),s=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(l){for(var c,d,u,h,p,g,f,v=[],m=0,y=l.length,x=y,T=o.getTypeOf(l)!=="string";m<l.length;)x=y-m,u=T?(c=l[m++],d=m<y?l[m++]:0,m<y?l[m++]:0):(c=l.charCodeAt(m++),d=m<y?l.charCodeAt(m++):0,m<y?l.charCodeAt(m++):0),h=c>>2,p=(3&c)<<4|d>>4,g=1<x?(15&d)<<2|u>>6:64,f=2<x?63&u:64,v.push(a.charAt(h)+a.charAt(p)+a.charAt(g)+a.charAt(f));return v.join("")},r.decode=function(l){var c,d,u,h,p,g,f=0,v=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var y,x=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&x--,l.charAt(l.length-2)===a.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=s.uint8array?new Uint8Array(0|x):new Array(0|x);f<l.length;)c=a.indexOf(l.charAt(f++))<<2|(h=a.indexOf(l.charAt(f++)))>>4,d=(15&h)<<4|(p=a.indexOf(l.charAt(f++)))>>2,u=(3&p)<<6|(g=a.indexOf(l.charAt(f++))),y[v++]=c,p!==64&&(y[v++]=d),g!==64&&(y[v++]=u);return y}},{"./support":30,"./utils":32}],2:[function(n,i,r){var o=n("./external"),s=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(d,u,h,p,g){this.compressedSize=d,this.uncompressedSize=u,this.crc32=h,this.compression=p,this.compressedContent=g}c.prototype={getContentWorker:function(){var d=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),u=this;return d.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(d,u,h){return d.pipe(new a).pipe(new l("uncompressedSize")).pipe(u.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",u)},i.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,r){var o=n("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},r.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,r){var o=n("./utils"),s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();i.exports=function(a,l){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(c,d,u,h){var p=s,g=h+u;c^=-1;for(var f=h;f<g;f++)c=c>>>8^p[255&(c^d[f])];return-1^c}(0|l,a,a.length,0):function(c,d,u,h){var p=s,g=h+u;c^=-1;for(var f=h;f<g;f++)c=c>>>8^p[255&(c^d.charCodeAt(f))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(n,i,r){var o=null;o=typeof Promise<"u"?Promise:n("lie"),i.exports={Promise:o}},{lie:37}],7:[function(n,i,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),c=o?"uint8array":"array";function d(u,h){l.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=h,this.meta={}}r.magic="\b\0",a.inherits(d,l),d.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,u.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(h){u.push({data:h,meta:u.meta})}},r.compressWorker=function(u){return new d("Deflate",u)},r.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,r){function o(p,g){var f,v="";for(f=0;f<g;f++)v+=String.fromCharCode(255&p),p>>>=8;return v}function s(p,g,f,v,m,y){var x,T,M=p.file,k=p.compression,_=y!==c.utf8encode,A=a.transformTo("string",y(M.name)),$=a.transformTo("string",c.utf8encode(M.name)),E=M.comment,R=a.transformTo("string",y(E)),I=a.transformTo("string",c.utf8encode(E)),N=$.length!==M.name.length,P=I.length!==E.length,Z="",pe="",Q="",Le=M.dir,ue=M.date,H={crc32:0,compressedSize:0,uncompressedSize:0};g&&!f||(H.crc32=p.crc32,H.compressedSize=p.compressedSize,H.uncompressedSize=p.uncompressedSize);var ee=0;g&&(ee|=8),_||!N&&!P||(ee|=2048);var K=0,U=0;Le&&(K|=16),m==="UNIX"?(U=798,K|=function(xe,Pe){var ze=xe;return xe||(ze=Pe?16893:33204),(65535&ze)<<16}(M.unixPermissions,Le)):(U=20,K|=function(xe){return 63&(xe||0)}(M.dosPermissions)),x=ue.getUTCHours(),x<<=6,x|=ue.getUTCMinutes(),x<<=5,x|=ue.getUTCSeconds()/2,T=ue.getUTCFullYear()-1980,T<<=4,T|=ue.getUTCMonth()+1,T<<=5,T|=ue.getUTCDate(),N&&(pe=o(1,1)+o(d(A),4)+$,Z+="up"+o(pe.length,2)+pe),P&&(Q=o(1,1)+o(d(R),4)+I,Z+="uc"+o(Q.length,2)+Q);var Ee="";return Ee+=`
\0`,Ee+=o(ee,2),Ee+=k.magic,Ee+=o(x,2),Ee+=o(T,2),Ee+=o(H.crc32,4),Ee+=o(H.compressedSize,4),Ee+=o(H.uncompressedSize,4),Ee+=o(A.length,2),Ee+=o(Z.length,2),{fileRecord:u.LOCAL_FILE_HEADER+Ee+A+Z,dirRecord:u.CENTRAL_FILE_HEADER+o(U,2)+Ee+o(R.length,2)+"\0\0\0\0"+o(K,4)+o(v,4)+A+Z+R}}var a=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),d=n("../crc32"),u=n("../signature");function h(p,g,f,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=f,this.encodeFileName=v,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(h,l),h.prototype.push=function(p){var g=p.meta.percent||0,f=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,l.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:f?(g+100*(f-v-1))/f:100}}))},h.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var g=this.streamFiles&&!p.file.dir;if(g){var f=s(p,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(p){this.accumulate=!1;var g=this.streamFiles&&!p.file.dir,f=s(p,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),g)this.push({data:function(v){return u.DATA_DESCRIPTOR+o(v.crc32,4)+o(v.compressedSize,4)+o(v.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var p=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var f=this.bytesWritten-p,v=function(m,y,x,T,M){var k=a.transformTo("string",M(T));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(m,2)+o(m,2)+o(y,4)+o(x,4)+o(k.length,2)+k}(this.dirRecords.length,f,p,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(p){this._sources.push(p);var g=this;return p.on("data",function(f){g.processChunk(f)}),p.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),p.on("error",function(f){g.error(f)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(p){var g=this._sources;if(!l.prototype.error.call(this,p))return!1;for(var f=0;f<g.length;f++)try{g[f].error(p)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var p=this._sources,g=0;g<p.length;g++)p[g].lock()},i.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,r){var o=n("../compressions"),s=n("./ZipFileWorker");r.generateWorker=function(a,l,c){var d=new s(l.streamFiles,c,l.platform,l.encodeFileName),u=0;try{a.forEach(function(h,p){u++;var g=function(y,x){var T=y||x,M=o[T];if(!M)throw new Error(T+" is not a valid compression method !");return M}(p.options.compression,l.compression),f=p.options.compressionOptions||l.compressionOptions||{},v=p.dir,m=p.date;p._compressWorker(g,f).withStreamInfo("file",{name:h,dir:v,date:m,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(d)}),d.entriesCount=u}catch(h){d.error(h)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,r){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=n("./object")).loadAsync=n("./load"),o.support=n("./support"),o.defaults=n("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=n("./external"),i.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,r){var o=n("./utils"),s=n("./external"),a=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),d=n("./nodejsUtils");function u(h){return new s.Promise(function(p,g){var f=h.decompressed.getContentWorker().pipe(new c);f.on("error",function(v){g(v)}).on("end",function(){f.streamInfo.crc32!==h.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}i.exports=function(h,p){var g=this;return p=o.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),d.isNode&&d.isStream(h)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",h,!0,p.optimizedBinaryString,p.base64).then(function(f){var v=new l(p);return v.load(f),v}).then(function(f){var v=[s.Promise.resolve(f)],m=f.files;if(p.checkCRC32)for(var y=0;y<m.length;y++)v.push(u(m[y]));return s.Promise.all(v)}).then(function(f){for(var v=f.shift(),m=v.files,y=0;y<m.length;y++){var x=m[y],T=x.fileNameStr,M=o.resolve(x.fileNameStr);g.file(M,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:p.createFolders}),x.dir||(g.file(M).unsafeOriginalName=T)}return v.zipComment.length&&(g.comment=v.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,r){var o=n("../utils"),s=n("../stream/GenericWorker");function a(l,c){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}o.inherits(a,s),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(d){c.push({data:d,meta:{percent:0}})}).on("error",function(d){c.isPaused?this.generatedError=d:c.error(d)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,r){var o=n("readable-stream").Readable;function s(a,l,c){o.call(this,l),this._helper=a;var d=this;a.on("data",function(u,h){d.push(u)||d._helper.pause(),c&&c(h)}).on("error",function(u){d.emit("error",u)}).on("end",function(){d.push(null)})}n("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},i.exports=s},{"../utils":32,"readable-stream":16}],14:[function(n,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(n,i,r){function o(M,k,_){var A,$=a.getTypeOf(k),E=a.extend(_||{},d);E.date=E.date||new Date,E.compression!==null&&(E.compression=E.compression.toUpperCase()),typeof E.unixPermissions=="string"&&(E.unixPermissions=parseInt(E.unixPermissions,8)),E.unixPermissions&&16384&E.unixPermissions&&(E.dir=!0),E.dosPermissions&&16&E.dosPermissions&&(E.dir=!0),E.dir&&(M=m(M)),E.createFolders&&(A=v(M))&&y.call(this,A,!0);var R=$==="string"&&E.binary===!1&&E.base64===!1;_&&_.binary!==void 0||(E.binary=!R),(k instanceof u&&k.uncompressedSize===0||E.dir||!k||k.length===0)&&(E.base64=!1,E.binary=!0,k="",E.compression="STORE",$="string");var I=null;I=k instanceof u||k instanceof l?k:g.isNode&&g.isStream(k)?new f(M,k):a.prepareContent(M,k,E.binary,E.optimizedBinaryString,E.base64);var N=new h(M,I,E);this.files[M]=N}var s=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),d=n("./defaults"),u=n("./compressedObject"),h=n("./zipObject"),p=n("./generate"),g=n("./nodejsUtils"),f=n("./nodejs/NodejsStreamInputAdapter"),v=function(M){M.slice(-1)==="/"&&(M=M.substring(0,M.length-1));var k=M.lastIndexOf("/");return 0<k?M.substring(0,k):""},m=function(M){return M.slice(-1)!=="/"&&(M+="/"),M},y=function(M,k){return k=k!==void 0?k:d.createFolders,M=m(M),this.files[M]||o.call(this,M,null,{dir:!0,createFolders:k}),this.files[M]};function x(M){return Object.prototype.toString.call(M)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(M){var k,_,A;for(k in this.files)A=this.files[k],(_=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&M(_,A)},filter:function(M){var k=[];return this.forEach(function(_,A){M(_,A)&&k.push(A)}),k},file:function(M,k,_){if(arguments.length!==1)return M=this.root+M,o.call(this,M,k,_),this;if(x(M)){var A=M;return this.filter(function(E,R){return!R.dir&&A.test(E)})}var $=this.files[this.root+M];return $&&!$.dir?$:null},folder:function(M){if(!M)return this;if(x(M))return this.filter(function($,E){return E.dir&&M.test($)});var k=this.root+M,_=y.call(this,k),A=this.clone();return A.root=_.name,A},remove:function(M){M=this.root+M;var k=this.files[M];if(k||(M.slice(-1)!=="/"&&(M+="/"),k=this.files[M]),k&&!k.dir)delete this.files[M];else for(var _=this.filter(function($,E){return E.name.slice(0,M.length)===M}),A=0;A<_.length;A++)delete this.files[_[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(M){var k,_={};try{if((_=a.extend(M||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");a.checkSupport(_.type),_.platform!=="darwin"&&_.platform!=="freebsd"&&_.platform!=="linux"&&_.platform!=="sunos"||(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var A=_.comment||this.comment||"";k=p.generateWorker(this,_,A)}catch($){(k=new l("error")).error($)}return new c(k,_.type||"string",_.mimeType)},generateAsync:function(M,k){return this.generateInternalStream(M).accumulate(k)},generateNodeStream:function(M,k){return(M=M||{}).type||(M.type="nodebuffer"),this.generateInternalStream(M).toNodejsStream(k)}};i.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,r){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,r){var o=n("./DataReader");function s(a){o.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),u=a.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===d&&this.data[h+3]===u)return h-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),u=a.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&d===h[2]&&u===h[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=s},{"../utils":32,"./DataReader":18}],18:[function(n,i,r){var o=n("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=s},{"../utils":32}],19:[function(n,i,r){var o=n("./Uint8ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,r){var o=n("./DataReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=s},{"../utils":32,"./DataReader":18}],21:[function(n,i,r){var o=n("./ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,r){var o=n("../utils"),s=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),d=n("./Uint8ArrayReader");i.exports=function(u){var h=o.getTypeOf(u);return o.checkSupport(h),h!=="string"||s.uint8array?h==="nodebuffer"?new c(u):s.uint8array?new d(o.transformTo("uint8array",u)):new a(o.transformTo("array",u)):new l(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,r){var o=n("./GenericWorker"),s=n("../utils");function a(l){o.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,o),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,r){var o=n("./GenericWorker"),s=n("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,o),a.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,r){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(a,s),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}s.prototype.processChunk.call(this,l)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,r){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(d){c.dataIsReady=!0,c.data=d,c.max=d&&d.length||0,c.type=o.getTypeOf(d),c.isPaused||c._tickAndRepeat()},function(d){c.error(d)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,r){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},i.exports=o},{}],29:[function(n,i,r){var o=n("../utils"),s=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),c=n("../support"),d=n("../external"),u=null;if(c.nodestream)try{u=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(g,f){return new d.Promise(function(v,m){var y=[],x=g._internalType,T=g._outputType,M=g._mimeType;g.on("data",function(k,_){y.push(k),f&&f(_)}).on("error",function(k){y=[],m(k)}).on("end",function(){try{var k=function(_,A,$){switch(_){case"blob":return o.newBlob(o.transformTo("arraybuffer",A),$);case"base64":return l.encode(A);default:return o.transformTo(_,A)}}(T,function(_,A){var $,E=0,R=null,I=0;for($=0;$<A.length;$++)I+=A[$].length;switch(_){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(R=new Uint8Array(I),$=0;$<A.length;$++)R.set(A[$],E),E+=A[$].length;return R;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+_+"'")}}(x,y),M);v(k)}catch(_){m(_)}y=[]}).resume()})}function p(g,f,v){var m=f;switch(f){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=f,this._mimeType=v,o.checkSupport(m),this._worker=g.pipe(new s(m)),g.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}p.prototype={accumulate:function(g){return h(this,g)},on:function(g,f){var v=this;return g==="data"?this._worker.on(g,function(m){f.call(v,m.data,m.meta)}):this._worker.on(g,function(){o.delay(f,arguments,v)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},g)}},i.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var o=new ArrayBuffer(0);try{r.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),r.blob=s.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!n("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,r){for(var o=n("./utils"),s=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),d=0;d<256;d++)c[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;c[254]=c[254]=1;function u(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}r.utf8encode=function(p){return s.nodebuffer?a.newBufferFrom(p,"utf-8"):function(g){var f,v,m,y,x,T=g.length,M=0;for(y=0;y<T;y++)(64512&(v=g.charCodeAt(y)))==55296&&y+1<T&&(64512&(m=g.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(m-56320),y++),M+=v<128?1:v<2048?2:v<65536?3:4;for(f=s.uint8array?new Uint8Array(M):new Array(M),y=x=0;x<M;y++)(64512&(v=g.charCodeAt(y)))==55296&&y+1<T&&(64512&(m=g.charCodeAt(y+1)))==56320&&(v=65536+(v-55296<<10)+(m-56320),y++),v<128?f[x++]=v:(v<2048?f[x++]=192|v>>>6:(v<65536?f[x++]=224|v>>>12:(f[x++]=240|v>>>18,f[x++]=128|v>>>12&63),f[x++]=128|v>>>6&63),f[x++]=128|63&v);return f}(p)},r.utf8decode=function(p){return s.nodebuffer?o.transformTo("nodebuffer",p).toString("utf-8"):function(g){var f,v,m,y,x=g.length,T=new Array(2*x);for(f=v=0;f<x;)if((m=g[f++])<128)T[v++]=m;else if(4<(y=c[m]))T[v++]=65533,f+=y-1;else{for(m&=y===2?31:y===3?15:7;1<y&&f<x;)m=m<<6|63&g[f++],y--;1<y?T[v++]=65533:m<65536?T[v++]=m:(m-=65536,T[v++]=55296|m>>10&1023,T[v++]=56320|1023&m)}return T.length!==v&&(T.subarray?T=T.subarray(0,v):T.length=v),o.applyFromCharCode(T)}(p=o.transformTo(s.uint8array?"uint8array":"array",p))},o.inherits(u,l),u.prototype.processChunk=function(p){var g=o.transformTo(s.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var f=g;(g=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),g.set(f,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var v=function(y,x){var T;for((x=x||y.length)>y.length&&(x=y.length),T=x-1;0<=T&&(192&y[T])==128;)T--;return T<0||T===0?x:T+c[y[T]]>x?T:x}(g),m=g;v!==g.length&&(s.uint8array?(m=g.subarray(0,v),this.leftOver=g.subarray(v,g.length)):(m=g.slice(0,v),this.leftOver=g.slice(v,g.length))),this.push({data:r.utf8decode(m),meta:p.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=u,o.inherits(h,l),h.prototype.processChunk=function(p){this.push({data:r.utf8encode(p.data),meta:p.meta})},r.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,r){var o=n("./support"),s=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function c(f){return f}function d(f,v){for(var m=0;m<f.length;++m)v[m]=255&f.charCodeAt(m);return v}n("setimmediate"),r.newBlob=function(f,v){r.checkSupport("blob");try{return new Blob([f],{type:v})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(f),m.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(f,v,m){var y=[],x=0,T=f.length;if(T<=m)return String.fromCharCode.apply(null,f);for(;x<T;)v==="array"||v==="nodebuffer"?y.push(String.fromCharCode.apply(null,f.slice(x,Math.min(x+m,T)))):y.push(String.fromCharCode.apply(null,f.subarray(x,Math.min(x+m,T)))),x+=m;return y.join("")},stringifyByChar:function(f){for(var v="",m=0;m<f.length;m++)v+=String.fromCharCode(f[m]);return v},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function h(f){var v=65536,m=r.getTypeOf(f),y=!0;if(m==="uint8array"?y=u.applyCanBeUsed.uint8array:m==="nodebuffer"&&(y=u.applyCanBeUsed.nodebuffer),y)for(;1<v;)try{return u.stringifyByChunk(f,m,v)}catch{v=Math.floor(v/2)}return u.stringifyByChar(f)}function p(f,v){for(var m=0;m<f.length;m++)v[m]=f[m];return v}r.applyFromCharCode=h;var g={};g.string={string:c,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return g.string.uint8array(f).buffer},uint8array:function(f){return d(f,new Uint8Array(f.length))},nodebuffer:function(f){return d(f,a.allocBuffer(f.length))}},g.array={string:h,array:c,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(f)}},g.arraybuffer={string:function(f){return h(new Uint8Array(f))},array:function(f){return p(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:c,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return a.newBufferFrom(new Uint8Array(f))}},g.uint8array={string:h,array:function(f){return p(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:c,nodebuffer:function(f){return a.newBufferFrom(f)}},g.nodebuffer={string:h,array:function(f){return p(f,new Array(f.length))},arraybuffer:function(f){return g.nodebuffer.uint8array(f).buffer},uint8array:function(f){return p(f,new Uint8Array(f.length))},nodebuffer:c},r.transformTo=function(f,v){if(v=v||"",!f)return v;r.checkSupport(f);var m=r.getTypeOf(v);return g[m][f](v)},r.resolve=function(f){for(var v=f.split("/"),m=[],y=0;y<v.length;y++){var x=v[y];x==="."||x===""&&y!==0&&y!==v.length-1||(x===".."?m.pop():m.push(x))}return m.join("/")},r.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(f)?"nodebuffer":o.uint8array&&f instanceof Uint8Array?"uint8array":o.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(f){if(!o[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(f){var v,m,y="";for(m=0;m<(f||"").length;m++)y+="\\x"+((v=f.charCodeAt(m))<16?"0":"")+v.toString(16).toUpperCase();return y},r.delay=function(f,v,m){setImmediate(function(){f.apply(m||null,v||[])})},r.inherits=function(f,v){function m(){}m.prototype=v.prototype,f.prototype=new m},r.extend=function(){var f,v,m={};for(f=0;f<arguments.length;f++)for(v in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],v)&&m[v]===void 0&&(m[v]=arguments[f][v]);return m},r.prepareContent=function(f,v,m,y,x){return l.Promise.resolve(v).then(function(T){return o.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new l.Promise(function(M,k){var _=new FileReader;_.onload=function(A){M(A.target.result)},_.onerror=function(A){k(A.target.error)},_.readAsArrayBuffer(T)}):T}).then(function(T){var M=r.getTypeOf(T);return M?(M==="arraybuffer"?T=r.transformTo("uint8array",T):M==="string"&&(x?T=s.decode(T):m&&y!==!0&&(T=function(k){return d(k,o.uint8array?new Uint8Array(k.length):new Array(k.length))}(T))),T):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,i,r){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./signature"),l=n("./zipEntry"),c=n("./support");function d(u){this.files=[],this.loadOptions=u}d.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(h)+", expected "+s.pretty(u)+")")}},isSignature:function(u,h){var p=this.reader.index;this.reader.setIndex(u);var g=this.reader.readString(4)===h;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",p=s.transformTo(h,u);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,h,p,g=this.zip64EndOfCentralSize-44;0<g;)u=this.reader.readInt(2),h=this.reader.readInt(4),p=this.reader.readData(h),this.zip64ExtensibleData[u]={id:u,length:h,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,h;for(u=0;u<this.files.length;u++)h=this.files[u],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(u=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var h=u;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var g=h-p;if(0<g)this.isSignature(h,a.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(u){this.reader=o(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,i,r){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),d=n("./compressions"),u=n("./support");function h(p,g){this.options=p,this.loadOptions=g}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var g,f;if(p.skip(22),this.fileNameLength=p.readInt(2),f=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(v){for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)&&d[m].magic===v)return d[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g,f,v,m=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<m;)g=p.readInt(2),f=p.readInt(2),v=p.readData(f),this.extraFields[g]={id:g,length:f,value:v};p.setIndex(m)},handleUTF8:function(){var p=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var f=s.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var m=s.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=o(p.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:c.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=o(p.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:c.utf8decode(g.readData(p.length-5))}return null}},i.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,r){function o(g,f,v){this.name=g,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=f,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var s=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),d=n("./stream/GenericWorker");o.prototype={internalStream:function(g){var f=null,v="string";try{if(!g)throw new Error("No output type specified.");var m=(v=g.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),f=this._decompressWorker();var y=!this._dataBinary;y&&!m&&(f=f.pipe(new l.Utf8EncodeWorker)),!y&&m&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(x){(f=new d("error")).error(x)}return new s(f,v,"")},async:function(g,f){return this.internalStream(g).accumulate(f)},nodeStream:function(g,f){return this.internalStream(g||"nodebuffer").toNodejsStream(f)},_compressWorker:function(g,f){if(this._data instanceof c&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,g,f)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof d?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<u.length;p++)o.prototype[u[p]]=h;i.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,r){(function(o){var s,a,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var c=0,d=new l(g),u=o.document.createTextNode("");d.observe(u,{characterData:!0}),s=function(){u.data=c=++c%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var f=o.document.createElement("script");f.onreadystatechange=function(){g(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},o.document.documentElement.appendChild(f)}:function(){setTimeout(g,0)};else{var h=new o.MessageChannel;h.port1.onmessage=g,s=function(){h.port2.postMessage(0)}}var p=[];function g(){var f,v;a=!0;for(var m=p.length;m;){for(v=p,p=[],f=-1;++f<m;)v[f]();m=p.length}a=!1}i.exports=function(f){p.push(f)!==1||a||s()}}).call(this,typeof m1<"u"?m1:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,i,r){var o=n("immediate");function s(){}var a={},l=["REJECTED"],c=["FULFILLED"],d=["PENDING"];function u(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,m!==s&&f(this,m)}function h(m,y,x){this.promise=m,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function p(m,y,x){o(function(){var T;try{T=y(x)}catch(M){return a.reject(m,M)}T===m?a.reject(m,new TypeError("Cannot resolve promise with itself")):a.resolve(m,T)})}function g(m){var y=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof y=="function")return function(){y.apply(m,arguments)}}function f(m,y){var x=!1;function T(_){x||(x=!0,a.reject(m,_))}function M(_){x||(x=!0,a.resolve(m,_))}var k=v(function(){y(M,T)});k.status==="error"&&T(k.value)}function v(m,y){var x={};try{x.value=m(y),x.status="success"}catch(T){x.status="error",x.value=T}return x}(i.exports=u).prototype.finally=function(m){if(typeof m!="function")return this;var y=this.constructor;return this.then(function(x){return y.resolve(m()).then(function(){return x})},function(x){return y.resolve(m()).then(function(){throw x})})},u.prototype.catch=function(m){return this.then(null,m)},u.prototype.then=function(m,y){if(typeof m!="function"&&this.state===c||typeof y!="function"&&this.state===l)return this;var x=new this.constructor(s);return this.state!==d?p(x,this.state===c?m:y,this.outcome):this.queue.push(new h(x,m,y)),x},h.prototype.callFulfilled=function(m){a.resolve(this.promise,m)},h.prototype.otherCallFulfilled=function(m){p(this.promise,this.onFulfilled,m)},h.prototype.callRejected=function(m){a.reject(this.promise,m)},h.prototype.otherCallRejected=function(m){p(this.promise,this.onRejected,m)},a.resolve=function(m,y){var x=v(g,y);if(x.status==="error")return a.reject(m,x.value);var T=x.value;if(T)f(m,T);else{m.state=c,m.outcome=y;for(var M=-1,k=m.queue.length;++M<k;)m.queue[M].callFulfilled(y)}return m},a.reject=function(m,y){m.state=l,m.outcome=y;for(var x=-1,T=m.queue.length;++x<T;)m.queue[x].callRejected(y);return m},u.resolve=function(m){return m instanceof this?m:a.resolve(new this(s),m)},u.reject=function(m){var y=new this(s);return a.reject(y,m)},u.all=function(m){var y=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=m.length,T=!1;if(!x)return this.resolve([]);for(var M=new Array(x),k=0,_=-1,A=new this(s);++_<x;)$(m[_],_);return A;function $(E,R){y.resolve(E).then(function(I){M[R]=I,++k!==x||T||(T=!0,a.resolve(A,M))},function(I){T||(T=!0,a.reject(A,I))})}},u.race=function(m){var y=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=m.length,T=!1;if(!x)return this.resolve([]);for(var M=-1,k=new this(s);++M<x;)_=m[M],y.resolve(_).then(function(A){T||(T=!0,a.resolve(k,A))},function(A){T||(T=!0,a.reject(k,A))});var _;return k}},{immediate:36}],38:[function(n,i,r){var o={};(0,n("./lib/utils/common").assign)(o,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,r){var o=n("./zlib/deflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),d=Object.prototype.toString,u=0,h=-1,p=0,g=8;function f(m){if(!(this instanceof f))return new f(m);this.options=s.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},m||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var x=o.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(x!==u)throw new Error(l[x]);if(y.header&&o.deflateSetHeader(this.strm,y.header),y.dictionary){var T;if(T=typeof y.dictionary=="string"?a.string2buf(y.dictionary):d.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(x=o.deflateSetDictionary(this.strm,T))!==u)throw new Error(l[x]);this._dict_set=!0}}function v(m,y){var x=new f(y);if(x.push(m,!0),x.err)throw x.msg||l[x.err];return x.result}f.prototype.push=function(m,y){var x,T,M=this.strm,k=this.options.chunkSize;if(this.ended)return!1;T=y===~~y?y:y===!0?4:0,typeof m=="string"?M.input=a.string2buf(m):d.call(m)==="[object ArrayBuffer]"?M.input=new Uint8Array(m):M.input=m,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new s.Buf8(k),M.next_out=0,M.avail_out=k),(x=o.deflate(M,T))!==1&&x!==u)return this.onEnd(x),!(this.ended=!0);M.avail_out!==0&&(M.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(M.output,M.next_out))):this.onData(s.shrinkBuf(M.output,M.next_out)))}while((0<M.avail_in||M.avail_out===0)&&x!==1);return T===4?(x=o.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===u):T!==2||(this.onEnd(u),!(M.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},r.Deflate=f,r.deflate=v,r.deflateRaw=function(m,y){return(y=y||{}).raw=!0,v(m,y)},r.gzip=function(m,y){return(y=y||{}).gzip=!0,v(m,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,r){var o=n("./zlib/inflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),d=n("./zlib/zstream"),u=n("./zlib/gzheader"),h=Object.prototype.toString;function p(f){if(!(this instanceof p))return new p(f);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},f||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||f&&f.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var m=o.inflateInit2(this.strm,v.windowBits);if(m!==l.Z_OK)throw new Error(c[m]);this.header=new u,o.inflateGetHeader(this.strm,this.header)}function g(f,v){var m=new p(v);if(m.push(f,!0),m.err)throw m.msg||c[m.err];return m.result}p.prototype.push=function(f,v){var m,y,x,T,M,k,_=this.strm,A=this.options.chunkSize,$=this.options.dictionary,E=!1;if(this.ended)return!1;y=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?_.input=a.binstring2buf(f):h.call(f)==="[object ArrayBuffer]"?_.input=new Uint8Array(f):_.input=f,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new s.Buf8(A),_.next_out=0,_.avail_out=A),(m=o.inflate(_,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&$&&(k=typeof $=="string"?a.string2buf($):h.call($)==="[object ArrayBuffer]"?new Uint8Array($):$,m=o.inflateSetDictionary(this.strm,k)),m===l.Z_BUF_ERROR&&E===!0&&(m=l.Z_OK,E=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&m!==l.Z_STREAM_END&&(_.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=a.utf8border(_.output,_.next_out),T=_.next_out-x,M=a.buf2string(_.output,x),_.next_out=T,_.avail_out=A-T,T&&s.arraySet(_.output,_.output,x,T,0),this.onData(M)):this.onData(s.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(E=!0)}while((0<_.avail_in||_.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(m=o.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(_.avail_out=0))},p.prototype.onData=function(f){this.chunks.push(f)},p.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},r.Inflate=p,r.inflate=g,r.inflateRaw=function(f,v){return(v=v||{}).raw=!0,g(f,v)},r.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,r){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var d=c.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var u in d)d.hasOwnProperty(u)&&(l[u]=d[u])}}return l},r.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var s={arraySet:function(l,c,d,u,h){if(c.subarray&&l.subarray)l.set(c.subarray(d,d+u),h);else for(var p=0;p<u;p++)l[h+p]=c[d+p]},flattenChunks:function(l){var c,d,u,h,p,g;for(c=u=0,d=l.length;c<d;c++)u+=l[c].length;for(g=new Uint8Array(u),c=h=0,d=l.length;c<d;c++)p=l[c],g.set(p,h),h+=p.length;return g}},a={arraySet:function(l,c,d,u,h){for(var p=0;p<u;p++)l[h+p]=c[d+p]},flattenChunks:function(l){return[].concat.apply([],l)}};r.setTyped=function(l){l?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,s)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(o)},{}],42:[function(n,i,r){var o=n("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new o.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function d(u,h){if(h<65537&&(u.subarray&&a||!u.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(u,h));for(var p="",g=0;g<h;g++)p+=String.fromCharCode(u[g]);return p}l[254]=l[254]=1,r.string2buf=function(u){var h,p,g,f,v,m=u.length,y=0;for(f=0;f<m;f++)(64512&(p=u.charCodeAt(f)))==55296&&f+1<m&&(64512&(g=u.charCodeAt(f+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),f++),y+=p<128?1:p<2048?2:p<65536?3:4;for(h=new o.Buf8(y),f=v=0;v<y;f++)(64512&(p=u.charCodeAt(f)))==55296&&f+1<m&&(64512&(g=u.charCodeAt(f+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),f++),p<128?h[v++]=p:(p<2048?h[v++]=192|p>>>6:(p<65536?h[v++]=224|p>>>12:(h[v++]=240|p>>>18,h[v++]=128|p>>>12&63),h[v++]=128|p>>>6&63),h[v++]=128|63&p);return h},r.buf2binstring=function(u){return d(u,u.length)},r.binstring2buf=function(u){for(var h=new o.Buf8(u.length),p=0,g=h.length;p<g;p++)h[p]=u.charCodeAt(p);return h},r.buf2string=function(u,h){var p,g,f,v,m=h||u.length,y=new Array(2*m);for(p=g=0;p<m;)if((f=u[p++])<128)y[g++]=f;else if(4<(v=l[f]))y[g++]=65533,p+=v-1;else{for(f&=v===2?31:v===3?15:7;1<v&&p<m;)f=f<<6|63&u[p++],v--;1<v?y[g++]=65533:f<65536?y[g++]=f:(f-=65536,y[g++]=55296|f>>10&1023,y[g++]=56320|1023&f)}return d(y,g)},r.utf8border=function(u,h){var p;for((h=h||u.length)>u.length&&(h=u.length),p=h-1;0<=p&&(192&u[p])==128;)p--;return p<0||p===0?h:p+l[u[p]]>h?p:h}},{"./common":41}],43:[function(n,i,r){i.exports=function(o,s,a,l){for(var c=65535&o|0,d=o>>>16&65535|0,u=0;a!==0;){for(a-=u=2e3<a?2e3:a;d=d+(c=c+s[l++]|0)|0,--u;);c%=65521,d%=65521}return c|d<<16|0}},{}],44:[function(n,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,r){var o=function(){for(var s,a=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[l]=s}return a}();i.exports=function(s,a,l,c){var d=o,u=c+l;s^=-1;for(var h=c;h<u;h++)s=s>>>8^d[255&(s^a[h])];return-1^s}},{}],46:[function(n,i,r){var o,s=n("../utils/common"),a=n("./trees"),l=n("./adler32"),c=n("./crc32"),d=n("./messages"),u=0,h=4,p=0,g=-2,f=-1,v=4,m=2,y=8,x=9,T=286,M=30,k=19,_=2*T+1,A=15,$=3,E=258,R=E+$+1,I=42,N=113,P=1,Z=2,pe=3,Q=4;function Le(B,_e){return B.msg=d[_e],_e}function ue(B){return(B<<1)-(4<B?9:0)}function H(B){for(var _e=B.length;0<=--_e;)B[_e]=0}function ee(B){var _e=B.state,fe=_e.pending;fe>B.avail_out&&(fe=B.avail_out),fe!==0&&(s.arraySet(B.output,_e.pending_buf,_e.pending_out,fe,B.next_out),B.next_out+=fe,_e.pending_out+=fe,B.total_out+=fe,B.avail_out-=fe,_e.pending-=fe,_e.pending===0&&(_e.pending_out=0))}function K(B,_e){a._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,_e),B.block_start=B.strstart,ee(B.strm)}function U(B,_e){B.pending_buf[B.pending++]=_e}function Ee(B,_e){B.pending_buf[B.pending++]=_e>>>8&255,B.pending_buf[B.pending++]=255&_e}function xe(B,_e){var fe,G,j=B.max_chain_length,re=B.strstart,Ce=B.prev_length,Se=B.nice_match,oe=B.strstart>B.w_size-R?B.strstart-(B.w_size-R):0,se=B.window,Te=B.w_mask,Y=B.prev,be=B.strstart+E,O=se[re+Ce-1],C=se[re+Ce];B.prev_length>=B.good_match&&(j>>=2),Se>B.lookahead&&(Se=B.lookahead);do if(se[(fe=_e)+Ce]===C&&se[fe+Ce-1]===O&&se[fe]===se[re]&&se[++fe]===se[re+1]){re+=2,fe++;do;while(se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&se[++re]===se[++fe]&&re<be);if(G=E-(be-re),re=be-E,Ce<G){if(B.match_start=_e,Se<=(Ce=G))break;O=se[re+Ce-1],C=se[re+Ce]}}while((_e=Y[_e&Te])>oe&&--j!=0);return Ce<=B.lookahead?Ce:B.lookahead}function Pe(B){var _e,fe,G,j,re,Ce,Se,oe,se,Te,Y=B.w_size;do{if(j=B.window_size-B.lookahead-B.strstart,B.strstart>=Y+(Y-R)){for(s.arraySet(B.window,B.window,Y,Y,0),B.match_start-=Y,B.strstart-=Y,B.block_start-=Y,_e=fe=B.hash_size;G=B.head[--_e],B.head[_e]=Y<=G?G-Y:0,--fe;);for(_e=fe=Y;G=B.prev[--_e],B.prev[_e]=Y<=G?G-Y:0,--fe;);j+=Y}if(B.strm.avail_in===0)break;if(Ce=B.strm,Se=B.window,oe=B.strstart+B.lookahead,se=j,Te=void 0,Te=Ce.avail_in,se<Te&&(Te=se),fe=Te===0?0:(Ce.avail_in-=Te,s.arraySet(Se,Ce.input,Ce.next_in,Te,oe),Ce.state.wrap===1?Ce.adler=l(Ce.adler,Se,Te,oe):Ce.state.wrap===2&&(Ce.adler=c(Ce.adler,Se,Te,oe)),Ce.next_in+=Te,Ce.total_in+=Te,Te),B.lookahead+=fe,B.lookahead+B.insert>=$)for(re=B.strstart-B.insert,B.ins_h=B.window[re],B.ins_h=(B.ins_h<<B.hash_shift^B.window[re+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[re+$-1])&B.hash_mask,B.prev[re&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=re,re++,B.insert--,!(B.lookahead+B.insert<$)););}while(B.lookahead<R&&B.strm.avail_in!==0)}function ze(B,_e){for(var fe,G;;){if(B.lookahead<R){if(Pe(B),B.lookahead<R&&_e===u)return P;if(B.lookahead===0)break}if(fe=0,B.lookahead>=$&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+$-1])&B.hash_mask,fe=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),fe!==0&&B.strstart-fe<=B.w_size-R&&(B.match_length=xe(B,fe)),B.match_length>=$)if(G=a._tr_tally(B,B.strstart-B.match_start,B.match_length-$),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=$){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+$-1])&B.hash_mask,fe=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,--B.match_length!=0;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else G=a._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(G&&(K(B,!1),B.strm.avail_out===0))return P}return B.insert=B.strstart<$-1?B.strstart:$-1,_e===h?(K(B,!0),B.strm.avail_out===0?pe:Q):B.last_lit&&(K(B,!1),B.strm.avail_out===0)?P:Z}function le(B,_e){for(var fe,G,j;;){if(B.lookahead<R){if(Pe(B),B.lookahead<R&&_e===u)return P;if(B.lookahead===0)break}if(fe=0,B.lookahead>=$&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+$-1])&B.hash_mask,fe=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=$-1,fe!==0&&B.prev_length<B.max_lazy_match&&B.strstart-fe<=B.w_size-R&&(B.match_length=xe(B,fe),B.match_length<=5&&(B.strategy===1||B.match_length===$&&4096<B.strstart-B.match_start)&&(B.match_length=$-1)),B.prev_length>=$&&B.match_length<=B.prev_length){for(j=B.strstart+B.lookahead-$,G=a._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-$),B.lookahead-=B.prev_length-1,B.prev_length-=2;++B.strstart<=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+$-1])&B.hash_mask,fe=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),--B.prev_length!=0;);if(B.match_available=0,B.match_length=$-1,B.strstart++,G&&(K(B,!1),B.strm.avail_out===0))return P}else if(B.match_available){if((G=a._tr_tally(B,0,B.window[B.strstart-1]))&&K(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return P}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(G=a._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<$-1?B.strstart:$-1,_e===h?(K(B,!0),B.strm.avail_out===0?pe:Q):B.last_lit&&(K(B,!1),B.strm.avail_out===0)?P:Z}function He(B,_e,fe,G,j){this.good_length=B,this.max_lazy=_e,this.nice_length=fe,this.max_chain=G,this.func=j}function Ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*_),this.dyn_dtree=new s.Buf16(2*(2*M+1)),this.bl_tree=new s.Buf16(2*(2*k+1)),H(this.dyn_ltree),H(this.dyn_dtree),H(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(A+1),this.heap=new s.Buf16(2*T+1),H(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*T+1),H(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ue(B){var _e;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=m,(_e=B.state).pending=0,_e.pending_out=0,_e.wrap<0&&(_e.wrap=-_e.wrap),_e.status=_e.wrap?I:N,B.adler=_e.wrap===2?0:1,_e.last_flush=u,a._tr_init(_e),p):Le(B,g)}function lt(B){var _e=Ue(B);return _e===p&&function(fe){fe.window_size=2*fe.w_size,H(fe.head),fe.max_lazy_match=o[fe.level].max_lazy,fe.good_match=o[fe.level].good_length,fe.nice_match=o[fe.level].nice_length,fe.max_chain_length=o[fe.level].max_chain,fe.strstart=0,fe.block_start=0,fe.lookahead=0,fe.insert=0,fe.match_length=fe.prev_length=$-1,fe.match_available=0,fe.ins_h=0}(B.state),_e}function et(B,_e,fe,G,j,re){if(!B)return g;var Ce=1;if(_e===f&&(_e=6),G<0?(Ce=0,G=-G):15<G&&(Ce=2,G-=16),j<1||x<j||fe!==y||G<8||15<G||_e<0||9<_e||re<0||v<re)return Le(B,g);G===8&&(G=9);var Se=new Ne;return(B.state=Se).strm=B,Se.wrap=Ce,Se.gzhead=null,Se.w_bits=G,Se.w_size=1<<Se.w_bits,Se.w_mask=Se.w_size-1,Se.hash_bits=j+7,Se.hash_size=1<<Se.hash_bits,Se.hash_mask=Se.hash_size-1,Se.hash_shift=~~((Se.hash_bits+$-1)/$),Se.window=new s.Buf8(2*Se.w_size),Se.head=new s.Buf16(Se.hash_size),Se.prev=new s.Buf16(Se.w_size),Se.lit_bufsize=1<<j+6,Se.pending_buf_size=4*Se.lit_bufsize,Se.pending_buf=new s.Buf8(Se.pending_buf_size),Se.d_buf=1*Se.lit_bufsize,Se.l_buf=3*Se.lit_bufsize,Se.level=_e,Se.strategy=re,Se.method=fe,lt(B)}o=[new He(0,0,0,0,function(B,_e){var fe=65535;for(fe>B.pending_buf_size-5&&(fe=B.pending_buf_size-5);;){if(B.lookahead<=1){if(Pe(B),B.lookahead===0&&_e===u)return P;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var G=B.block_start+fe;if((B.strstart===0||B.strstart>=G)&&(B.lookahead=B.strstart-G,B.strstart=G,K(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-R&&(K(B,!1),B.strm.avail_out===0))return P}return B.insert=0,_e===h?(K(B,!0),B.strm.avail_out===0?pe:Q):(B.strstart>B.block_start&&(K(B,!1),B.strm.avail_out),P)}),new He(4,4,8,4,ze),new He(4,5,16,8,ze),new He(4,6,32,32,ze),new He(4,4,16,16,le),new He(8,16,32,32,le),new He(8,16,128,128,le),new He(8,32,128,256,le),new He(32,128,258,1024,le),new He(32,258,258,4096,le)],r.deflateInit=function(B,_e){return et(B,_e,y,15,8,0)},r.deflateInit2=et,r.deflateReset=lt,r.deflateResetKeep=Ue,r.deflateSetHeader=function(B,_e){return B&&B.state?B.state.wrap!==2?g:(B.state.gzhead=_e,p):g},r.deflate=function(B,_e){var fe,G,j,re;if(!B||!B.state||5<_e||_e<0)return B?Le(B,g):g;if(G=B.state,!B.output||!B.input&&B.avail_in!==0||G.status===666&&_e!==h)return Le(B,B.avail_out===0?-5:g);if(G.strm=B,fe=G.last_flush,G.last_flush=_e,G.status===I)if(G.wrap===2)B.adler=0,U(G,31),U(G,139),U(G,8),G.gzhead?(U(G,(G.gzhead.text?1:0)+(G.gzhead.hcrc?2:0)+(G.gzhead.extra?4:0)+(G.gzhead.name?8:0)+(G.gzhead.comment?16:0)),U(G,255&G.gzhead.time),U(G,G.gzhead.time>>8&255),U(G,G.gzhead.time>>16&255),U(G,G.gzhead.time>>24&255),U(G,G.level===9?2:2<=G.strategy||G.level<2?4:0),U(G,255&G.gzhead.os),G.gzhead.extra&&G.gzhead.extra.length&&(U(G,255&G.gzhead.extra.length),U(G,G.gzhead.extra.length>>8&255)),G.gzhead.hcrc&&(B.adler=c(B.adler,G.pending_buf,G.pending,0)),G.gzindex=0,G.status=69):(U(G,0),U(G,0),U(G,0),U(G,0),U(G,0),U(G,G.level===9?2:2<=G.strategy||G.level<2?4:0),U(G,3),G.status=N);else{var Ce=y+(G.w_bits-8<<4)<<8;Ce|=(2<=G.strategy||G.level<2?0:G.level<6?1:G.level===6?2:3)<<6,G.strstart!==0&&(Ce|=32),Ce+=31-Ce%31,G.status=N,Ee(G,Ce),G.strstart!==0&&(Ee(G,B.adler>>>16),Ee(G,65535&B.adler)),B.adler=1}if(G.status===69)if(G.gzhead.extra){for(j=G.pending;G.gzindex<(65535&G.gzhead.extra.length)&&(G.pending!==G.pending_buf_size||(G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),ee(B),j=G.pending,G.pending!==G.pending_buf_size));)U(G,255&G.gzhead.extra[G.gzindex]),G.gzindex++;G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),G.gzindex===G.gzhead.extra.length&&(G.gzindex=0,G.status=73)}else G.status=73;if(G.status===73)if(G.gzhead.name){j=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),ee(B),j=G.pending,G.pending===G.pending_buf_size)){re=1;break}re=G.gzindex<G.gzhead.name.length?255&G.gzhead.name.charCodeAt(G.gzindex++):0,U(G,re)}while(re!==0);G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),re===0&&(G.gzindex=0,G.status=91)}else G.status=91;if(G.status===91)if(G.gzhead.comment){j=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),ee(B),j=G.pending,G.pending===G.pending_buf_size)){re=1;break}re=G.gzindex<G.gzhead.comment.length?255&G.gzhead.comment.charCodeAt(G.gzindex++):0,U(G,re)}while(re!==0);G.gzhead.hcrc&&G.pending>j&&(B.adler=c(B.adler,G.pending_buf,G.pending-j,j)),re===0&&(G.status=103)}else G.status=103;if(G.status===103&&(G.gzhead.hcrc?(G.pending+2>G.pending_buf_size&&ee(B),G.pending+2<=G.pending_buf_size&&(U(G,255&B.adler),U(G,B.adler>>8&255),B.adler=0,G.status=N)):G.status=N),G.pending!==0){if(ee(B),B.avail_out===0)return G.last_flush=-1,p}else if(B.avail_in===0&&ue(_e)<=ue(fe)&&_e!==h)return Le(B,-5);if(G.status===666&&B.avail_in!==0)return Le(B,-5);if(B.avail_in!==0||G.lookahead!==0||_e!==u&&G.status!==666){var Se=G.strategy===2?function(oe,se){for(var Te;;){if(oe.lookahead===0&&(Pe(oe),oe.lookahead===0)){if(se===u)return P;break}if(oe.match_length=0,Te=a._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++,Te&&(K(oe,!1),oe.strm.avail_out===0))return P}return oe.insert=0,se===h?(K(oe,!0),oe.strm.avail_out===0?pe:Q):oe.last_lit&&(K(oe,!1),oe.strm.avail_out===0)?P:Z}(G,_e):G.strategy===3?function(oe,se){for(var Te,Y,be,O,C=oe.window;;){if(oe.lookahead<=E){if(Pe(oe),oe.lookahead<=E&&se===u)return P;if(oe.lookahead===0)break}if(oe.match_length=0,oe.lookahead>=$&&0<oe.strstart&&(Y=C[be=oe.strstart-1])===C[++be]&&Y===C[++be]&&Y===C[++be]){O=oe.strstart+E;do;while(Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&Y===C[++be]&&be<O);oe.match_length=E-(O-be),oe.match_length>oe.lookahead&&(oe.match_length=oe.lookahead)}if(oe.match_length>=$?(Te=a._tr_tally(oe,1,oe.match_length-$),oe.lookahead-=oe.match_length,oe.strstart+=oe.match_length,oe.match_length=0):(Te=a._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++),Te&&(K(oe,!1),oe.strm.avail_out===0))return P}return oe.insert=0,se===h?(K(oe,!0),oe.strm.avail_out===0?pe:Q):oe.last_lit&&(K(oe,!1),oe.strm.avail_out===0)?P:Z}(G,_e):o[G.level].func(G,_e);if(Se!==pe&&Se!==Q||(G.status=666),Se===P||Se===pe)return B.avail_out===0&&(G.last_flush=-1),p;if(Se===Z&&(_e===1?a._tr_align(G):_e!==5&&(a._tr_stored_block(G,0,0,!1),_e===3&&(H(G.head),G.lookahead===0&&(G.strstart=0,G.block_start=0,G.insert=0))),ee(B),B.avail_out===0))return G.last_flush=-1,p}return _e!==h?p:G.wrap<=0?1:(G.wrap===2?(U(G,255&B.adler),U(G,B.adler>>8&255),U(G,B.adler>>16&255),U(G,B.adler>>24&255),U(G,255&B.total_in),U(G,B.total_in>>8&255),U(G,B.total_in>>16&255),U(G,B.total_in>>24&255)):(Ee(G,B.adler>>>16),Ee(G,65535&B.adler)),ee(B),0<G.wrap&&(G.wrap=-G.wrap),G.pending!==0?p:1)},r.deflateEnd=function(B){var _e;return B&&B.state?(_e=B.state.status)!==I&&_e!==69&&_e!==73&&_e!==91&&_e!==103&&_e!==N&&_e!==666?Le(B,g):(B.state=null,_e===N?Le(B,-3):p):g},r.deflateSetDictionary=function(B,_e){var fe,G,j,re,Ce,Se,oe,se,Te=_e.length;if(!B||!B.state||(re=(fe=B.state).wrap)===2||re===1&&fe.status!==I||fe.lookahead)return g;for(re===1&&(B.adler=l(B.adler,_e,Te,0)),fe.wrap=0,Te>=fe.w_size&&(re===0&&(H(fe.head),fe.strstart=0,fe.block_start=0,fe.insert=0),se=new s.Buf8(fe.w_size),s.arraySet(se,_e,Te-fe.w_size,fe.w_size,0),_e=se,Te=fe.w_size),Ce=B.avail_in,Se=B.next_in,oe=B.input,B.avail_in=Te,B.next_in=0,B.input=_e,Pe(fe);fe.lookahead>=$;){for(G=fe.strstart,j=fe.lookahead-($-1);fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[G+$-1])&fe.hash_mask,fe.prev[G&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=G,G++,--j;);fe.strstart=G,fe.lookahead=$-1,Pe(fe)}return fe.strstart+=fe.lookahead,fe.block_start=fe.strstart,fe.insert=fe.lookahead,fe.lookahead=0,fe.match_length=fe.prev_length=$-1,fe.match_available=0,B.next_in=Se,B.input=oe,B.avail_in=Ce,fe.wrap=re,p},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,r){i.exports=function(o,s){var a,l,c,d,u,h,p,g,f,v,m,y,x,T,M,k,_,A,$,E,R,I,N,P,Z;a=o.state,l=o.next_in,P=o.input,c=l+(o.avail_in-5),d=o.next_out,Z=o.output,u=d-(s-o.avail_out),h=d+(o.avail_out-257),p=a.dmax,g=a.wsize,f=a.whave,v=a.wnext,m=a.window,y=a.hold,x=a.bits,T=a.lencode,M=a.distcode,k=(1<<a.lenbits)-1,_=(1<<a.distbits)-1;e:do{x<15&&(y+=P[l++]<<x,x+=8,y+=P[l++]<<x,x+=8),A=T[y&k];t:for(;;){if(y>>>=$=A>>>24,x-=$,($=A>>>16&255)===0)Z[d++]=65535&A;else{if(!(16&$)){if(!(64&$)){A=T[(65535&A)+(y&(1<<$)-1)];continue t}if(32&$){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}E=65535&A,($&=15)&&(x<$&&(y+=P[l++]<<x,x+=8),E+=y&(1<<$)-1,y>>>=$,x-=$),x<15&&(y+=P[l++]<<x,x+=8,y+=P[l++]<<x,x+=8),A=M[y&_];n:for(;;){if(y>>>=$=A>>>24,x-=$,!(16&($=A>>>16&255))){if(!(64&$)){A=M[(65535&A)+(y&(1<<$)-1)];continue n}o.msg="invalid distance code",a.mode=30;break e}if(R=65535&A,x<($&=15)&&(y+=P[l++]<<x,(x+=8)<$&&(y+=P[l++]<<x,x+=8)),p<(R+=y&(1<<$)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(y>>>=$,x-=$,($=d-u)<R){if(f<($=R-$)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(N=m,(I=0)===v){if(I+=g-$,$<E){for(E-=$;Z[d++]=m[I++],--$;);I=d-R,N=Z}}else if(v<$){if(I+=g+v-$,($-=v)<E){for(E-=$;Z[d++]=m[I++],--$;);if(I=0,v<E){for(E-=$=v;Z[d++]=m[I++],--$;);I=d-R,N=Z}}}else if(I+=v-$,$<E){for(E-=$;Z[d++]=m[I++],--$;);I=d-R,N=Z}for(;2<E;)Z[d++]=N[I++],Z[d++]=N[I++],Z[d++]=N[I++],E-=3;E&&(Z[d++]=N[I++],1<E&&(Z[d++]=N[I++]))}else{for(I=d-R;Z[d++]=Z[I++],Z[d++]=Z[I++],Z[d++]=Z[I++],2<(E-=3););E&&(Z[d++]=Z[I++],1<E&&(Z[d++]=Z[I++]))}break}}break}}while(l<c&&d<h);l-=E=x>>3,y&=(1<<(x-=E<<3))-1,o.next_in=l,o.next_out=d,o.avail_in=l<c?c-l+5:5-(l-c),o.avail_out=d<h?h-d+257:257-(d-h),a.hold=y,a.bits=x}},{}],49:[function(n,i,r){var o=n("../utils/common"),s=n("./adler32"),a=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),d=1,u=2,h=0,p=-2,g=1,f=852,v=592;function m(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(I){var N;return I&&I.state?(N=I.state,I.total_in=I.total_out=N.total=0,I.msg="",N.wrap&&(I.adler=1&N.wrap),N.mode=g,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new o.Buf32(f),N.distcode=N.distdyn=new o.Buf32(v),N.sane=1,N.back=-1,h):p}function T(I){var N;return I&&I.state?((N=I.state).wsize=0,N.whave=0,N.wnext=0,x(I)):p}function M(I,N){var P,Z;return I&&I.state?(Z=I.state,N<0?(P=0,N=-N):(P=1+(N>>4),N<48&&(N&=15)),N&&(N<8||15<N)?p:(Z.window!==null&&Z.wbits!==N&&(Z.window=null),Z.wrap=P,Z.wbits=N,T(I))):p}function k(I,N){var P,Z;return I?(Z=new y,(I.state=Z).window=null,(P=M(I,N))!==h&&(I.state=null),P):p}var _,A,$=!0;function E(I){if($){var N;for(_=new o.Buf32(512),A=new o.Buf32(32),N=0;N<144;)I.lens[N++]=8;for(;N<256;)I.lens[N++]=9;for(;N<280;)I.lens[N++]=7;for(;N<288;)I.lens[N++]=8;for(c(d,I.lens,0,288,_,0,I.work,{bits:9}),N=0;N<32;)I.lens[N++]=5;c(u,I.lens,0,32,A,0,I.work,{bits:5}),$=!1}I.lencode=_,I.lenbits=9,I.distcode=A,I.distbits=5}function R(I,N,P,Z){var pe,Q=I.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new o.Buf8(Q.wsize)),Z>=Q.wsize?(o.arraySet(Q.window,N,P-Q.wsize,Q.wsize,0),Q.wnext=0,Q.whave=Q.wsize):(Z<(pe=Q.wsize-Q.wnext)&&(pe=Z),o.arraySet(Q.window,N,P-Z,pe,Q.wnext),(Z-=pe)?(o.arraySet(Q.window,N,P-Z,Z,0),Q.wnext=Z,Q.whave=Q.wsize):(Q.wnext+=pe,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=pe))),0}r.inflateReset=T,r.inflateReset2=M,r.inflateResetKeep=x,r.inflateInit=function(I){return k(I,15)},r.inflateInit2=k,r.inflate=function(I,N){var P,Z,pe,Q,Le,ue,H,ee,K,U,Ee,xe,Pe,ze,le,He,Ne,Ue,lt,et,B,_e,fe,G,j=0,re=new o.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return p;(P=I.state).mode===12&&(P.mode=13),Le=I.next_out,pe=I.output,H=I.avail_out,Q=I.next_in,Z=I.input,ue=I.avail_in,ee=P.hold,K=P.bits,U=ue,Ee=H,_e=h;e:for(;;)switch(P.mode){case g:if(P.wrap===0){P.mode=13;break}for(;K<16;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(2&P.wrap&&ee===35615){re[P.check=0]=255&ee,re[1]=ee>>>8&255,P.check=a(P.check,re,2,0),K=ee=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&ee)<<8)+(ee>>8))%31){I.msg="incorrect header check",P.mode=30;break}if((15&ee)!=8){I.msg="unknown compression method",P.mode=30;break}if(K-=4,B=8+(15&(ee>>>=4)),P.wbits===0)P.wbits=B;else if(B>P.wbits){I.msg="invalid window size",P.mode=30;break}P.dmax=1<<B,I.adler=P.check=1,P.mode=512&ee?10:12,K=ee=0;break;case 2:for(;K<16;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(P.flags=ee,(255&P.flags)!=8){I.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){I.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=ee>>8&1),512&P.flags&&(re[0]=255&ee,re[1]=ee>>>8&255,P.check=a(P.check,re,2,0)),K=ee=0,P.mode=3;case 3:for(;K<32;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.head&&(P.head.time=ee),512&P.flags&&(re[0]=255&ee,re[1]=ee>>>8&255,re[2]=ee>>>16&255,re[3]=ee>>>24&255,P.check=a(P.check,re,4,0)),K=ee=0,P.mode=4;case 4:for(;K<16;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.head&&(P.head.xflags=255&ee,P.head.os=ee>>8),512&P.flags&&(re[0]=255&ee,re[1]=ee>>>8&255,P.check=a(P.check,re,2,0)),K=ee=0,P.mode=5;case 5:if(1024&P.flags){for(;K<16;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.length=ee,P.head&&(P.head.extra_len=ee),512&P.flags&&(re[0]=255&ee,re[1]=ee>>>8&255,P.check=a(P.check,re,2,0)),K=ee=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(ue<(xe=P.length)&&(xe=ue),xe&&(P.head&&(B=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),o.arraySet(P.head.extra,Z,Q,xe,B)),512&P.flags&&(P.check=a(P.check,Z,xe,Q)),ue-=xe,Q+=xe,P.length-=xe),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(ue===0)break e;for(xe=0;B=Z[Q+xe++],P.head&&B&&P.length<65536&&(P.head.name+=String.fromCharCode(B)),B&&xe<ue;);if(512&P.flags&&(P.check=a(P.check,Z,xe,Q)),ue-=xe,Q+=xe,B)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(ue===0)break e;for(xe=0;B=Z[Q+xe++],P.head&&B&&P.length<65536&&(P.head.comment+=String.fromCharCode(B)),B&&xe<ue;);if(512&P.flags&&(P.check=a(P.check,Z,xe,Q)),ue-=xe,Q+=xe,B)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;K<16;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(ee!==(65535&P.check)){I.msg="header crc mismatch",P.mode=30;break}K=ee=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),I.adler=P.check=0,P.mode=12;break;case 10:for(;K<32;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}I.adler=P.check=m(ee),K=ee=0,P.mode=11;case 11:if(P.havedict===0)return I.next_out=Le,I.avail_out=H,I.next_in=Q,I.avail_in=ue,P.hold=ee,P.bits=K,2;I.adler=P.check=1,P.mode=12;case 12:if(N===5||N===6)break e;case 13:if(P.last){ee>>>=7&K,K-=7&K,P.mode=27;break}for(;K<3;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}switch(P.last=1&ee,K-=1,3&(ee>>>=1)){case 0:P.mode=14;break;case 1:if(E(P),P.mode=20,N!==6)break;ee>>>=2,K-=2;break e;case 2:P.mode=17;break;case 3:I.msg="invalid block type",P.mode=30}ee>>>=2,K-=2;break;case 14:for(ee>>>=7&K,K-=7&K;K<32;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if((65535&ee)!=(ee>>>16^65535)){I.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&ee,K=ee=0,P.mode=15,N===6)break e;case 15:P.mode=16;case 16:if(xe=P.length){if(ue<xe&&(xe=ue),H<xe&&(xe=H),xe===0)break e;o.arraySet(pe,Z,Q,xe,Le),ue-=xe,Q+=xe,H-=xe,Le+=xe,P.length-=xe;break}P.mode=12;break;case 17:for(;K<14;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(P.nlen=257+(31&ee),ee>>>=5,K-=5,P.ndist=1+(31&ee),ee>>>=5,K-=5,P.ncode=4+(15&ee),ee>>>=4,K-=4,286<P.nlen||30<P.ndist){I.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;K<3;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.lens[Ce[P.have++]]=7&ee,ee>>>=3,K-=3}for(;P.have<19;)P.lens[Ce[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,fe={bits:P.lenbits},_e=c(0,P.lens,0,19,P.lencode,0,P.work,fe),P.lenbits=fe.bits,_e){I.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;He=(j=P.lencode[ee&(1<<P.lenbits)-1])>>>16&255,Ne=65535&j,!((le=j>>>24)<=K);){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(Ne<16)ee>>>=le,K-=le,P.lens[P.have++]=Ne;else{if(Ne===16){for(G=le+2;K<G;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(ee>>>=le,K-=le,P.have===0){I.msg="invalid bit length repeat",P.mode=30;break}B=P.lens[P.have-1],xe=3+(3&ee),ee>>>=2,K-=2}else if(Ne===17){for(G=le+3;K<G;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}K-=le,B=0,xe=3+(7&(ee>>>=le)),ee>>>=3,K-=3}else{for(G=le+7;K<G;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}K-=le,B=0,xe=11+(127&(ee>>>=le)),ee>>>=7,K-=7}if(P.have+xe>P.nlen+P.ndist){I.msg="invalid bit length repeat",P.mode=30;break}for(;xe--;)P.lens[P.have++]=B}}if(P.mode===30)break;if(P.lens[256]===0){I.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,fe={bits:P.lenbits},_e=c(d,P.lens,0,P.nlen,P.lencode,0,P.work,fe),P.lenbits=fe.bits,_e){I.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,fe={bits:P.distbits},_e=c(u,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,fe),P.distbits=fe.bits,_e){I.msg="invalid distances set",P.mode=30;break}if(P.mode=20,N===6)break e;case 20:P.mode=21;case 21:if(6<=ue&&258<=H){I.next_out=Le,I.avail_out=H,I.next_in=Q,I.avail_in=ue,P.hold=ee,P.bits=K,l(I,Ee),Le=I.next_out,pe=I.output,H=I.avail_out,Q=I.next_in,Z=I.input,ue=I.avail_in,ee=P.hold,K=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;He=(j=P.lencode[ee&(1<<P.lenbits)-1])>>>16&255,Ne=65535&j,!((le=j>>>24)<=K);){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(He&&!(240&He)){for(Ue=le,lt=He,et=Ne;He=(j=P.lencode[et+((ee&(1<<Ue+lt)-1)>>Ue)])>>>16&255,Ne=65535&j,!(Ue+(le=j>>>24)<=K);){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}ee>>>=Ue,K-=Ue,P.back+=Ue}if(ee>>>=le,K-=le,P.back+=le,P.length=Ne,He===0){P.mode=26;break}if(32&He){P.back=-1,P.mode=12;break}if(64&He){I.msg="invalid literal/length code",P.mode=30;break}P.extra=15&He,P.mode=22;case 22:if(P.extra){for(G=P.extra;K<G;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.length+=ee&(1<<P.extra)-1,ee>>>=P.extra,K-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;He=(j=P.distcode[ee&(1<<P.distbits)-1])>>>16&255,Ne=65535&j,!((le=j>>>24)<=K);){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(!(240&He)){for(Ue=le,lt=He,et=Ne;He=(j=P.distcode[et+((ee&(1<<Ue+lt)-1)>>Ue)])>>>16&255,Ne=65535&j,!(Ue+(le=j>>>24)<=K);){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}ee>>>=Ue,K-=Ue,P.back+=Ue}if(ee>>>=le,K-=le,P.back+=le,64&He){I.msg="invalid distance code",P.mode=30;break}P.offset=Ne,P.extra=15&He,P.mode=24;case 24:if(P.extra){for(G=P.extra;K<G;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}P.offset+=ee&(1<<P.extra)-1,ee>>>=P.extra,K-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){I.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(H===0)break e;if(xe=Ee-H,P.offset>xe){if((xe=P.offset-xe)>P.whave&&P.sane){I.msg="invalid distance too far back",P.mode=30;break}Pe=xe>P.wnext?(xe-=P.wnext,P.wsize-xe):P.wnext-xe,xe>P.length&&(xe=P.length),ze=P.window}else ze=pe,Pe=Le-P.offset,xe=P.length;for(H<xe&&(xe=H),H-=xe,P.length-=xe;pe[Le++]=ze[Pe++],--xe;);P.length===0&&(P.mode=21);break;case 26:if(H===0)break e;pe[Le++]=P.length,H--,P.mode=21;break;case 27:if(P.wrap){for(;K<32;){if(ue===0)break e;ue--,ee|=Z[Q++]<<K,K+=8}if(Ee-=H,I.total_out+=Ee,P.total+=Ee,Ee&&(I.adler=P.check=P.flags?a(P.check,pe,Ee,Le-Ee):s(P.check,pe,Ee,Le-Ee)),Ee=H,(P.flags?ee:m(ee))!==P.check){I.msg="incorrect data check",P.mode=30;break}K=ee=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;K<32;){if(ue===0)break e;ue--,ee+=Z[Q++]<<K,K+=8}if(ee!==(4294967295&P.total)){I.msg="incorrect length check",P.mode=30;break}K=ee=0}P.mode=29;case 29:_e=1;break e;case 30:_e=-3;break e;case 31:return-4;case 32:default:return p}return I.next_out=Le,I.avail_out=H,I.next_in=Q,I.avail_in=ue,P.hold=ee,P.bits=K,(P.wsize||Ee!==I.avail_out&&P.mode<30&&(P.mode<27||N!==4))&&R(I,I.output,I.next_out,Ee-I.avail_out)?(P.mode=31,-4):(U-=I.avail_in,Ee-=I.avail_out,I.total_in+=U,I.total_out+=Ee,P.total+=Ee,P.wrap&&Ee&&(I.adler=P.check=P.flags?a(P.check,pe,Ee,I.next_out-Ee):s(P.check,pe,Ee,I.next_out-Ee)),I.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(U==0&&Ee===0||N===4)&&_e===h&&(_e=-5),_e)},r.inflateEnd=function(I){if(!I||!I.state)return p;var N=I.state;return N.window&&(N.window=null),I.state=null,h},r.inflateGetHeader=function(I,N){var P;return I&&I.state&&2&(P=I.state).wrap?((P.head=N).done=!1,h):p},r.inflateSetDictionary=function(I,N){var P,Z=N.length;return I&&I.state?(P=I.state).wrap!==0&&P.mode!==11?p:P.mode===11&&s(1,N,Z,0)!==P.check?-3:R(I,N,Z,Z)?(P.mode=31,-4):(P.havedict=1,h):p},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,r){var o=n("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(d,u,h,p,g,f,v,m){var y,x,T,M,k,_,A,$,E,R=m.bits,I=0,N=0,P=0,Z=0,pe=0,Q=0,Le=0,ue=0,H=0,ee=0,K=null,U=0,Ee=new o.Buf16(16),xe=new o.Buf16(16),Pe=null,ze=0;for(I=0;I<=15;I++)Ee[I]=0;for(N=0;N<p;N++)Ee[u[h+N]]++;for(pe=R,Z=15;1<=Z&&Ee[Z]===0;Z--);if(Z<pe&&(pe=Z),Z===0)return g[f++]=20971520,g[f++]=20971520,m.bits=1,0;for(P=1;P<Z&&Ee[P]===0;P++);for(pe<P&&(pe=P),I=ue=1;I<=15;I++)if(ue<<=1,(ue-=Ee[I])<0)return-1;if(0<ue&&(d===0||Z!==1))return-1;for(xe[1]=0,I=1;I<15;I++)xe[I+1]=xe[I]+Ee[I];for(N=0;N<p;N++)u[h+N]!==0&&(v[xe[u[h+N]]++]=N);if(_=d===0?(K=Pe=v,19):d===1?(K=s,U-=257,Pe=a,ze-=257,256):(K=l,Pe=c,-1),I=P,k=f,Le=N=ee=0,T=-1,M=(H=1<<(Q=pe))-1,d===1&&852<H||d===2&&592<H)return 1;for(;;){for(A=I-Le,E=v[N]<_?($=0,v[N]):v[N]>_?($=Pe[ze+v[N]],K[U+v[N]]):($=96,0),y=1<<I-Le,P=x=1<<Q;g[k+(ee>>Le)+(x-=y)]=A<<24|$<<16|E|0,x!==0;);for(y=1<<I-1;ee&y;)y>>=1;if(y!==0?(ee&=y-1,ee+=y):ee=0,N++,--Ee[I]==0){if(I===Z)break;I=u[h+v[N]]}if(pe<I&&(ee&M)!==T){for(Le===0&&(Le=pe),k+=P,ue=1<<(Q=I-Le);Q+Le<Z&&!((ue-=Ee[Q+Le])<=0);)Q++,ue<<=1;if(H+=1<<Q,d===1&&852<H||d===2&&592<H)return 1;g[T=ee&M]=pe<<24|Q<<16|k-f|0}}return ee!==0&&(g[k+ee]=I-Le<<24|64<<16|0),m.bits=pe,0}},{"../utils/common":41}],51:[function(n,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,r){var o=n("../utils/common"),s=0,a=1;function l(j){for(var re=j.length;0<=--re;)j[re]=0}var c=0,d=29,u=256,h=u+1+d,p=30,g=19,f=2*h+1,v=15,m=16,y=7,x=256,T=16,M=17,k=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(h+2));l(R);var I=new Array(2*p);l(I);var N=new Array(512);l(N);var P=new Array(256);l(P);var Z=new Array(d);l(Z);var pe,Q,Le,ue=new Array(p);function H(j,re,Ce,Se,oe){this.static_tree=j,this.extra_bits=re,this.extra_base=Ce,this.elems=Se,this.max_length=oe,this.has_stree=j&&j.length}function ee(j,re){this.dyn_tree=j,this.max_code=0,this.stat_desc=re}function K(j){return j<256?N[j]:N[256+(j>>>7)]}function U(j,re){j.pending_buf[j.pending++]=255&re,j.pending_buf[j.pending++]=re>>>8&255}function Ee(j,re,Ce){j.bi_valid>m-Ce?(j.bi_buf|=re<<j.bi_valid&65535,U(j,j.bi_buf),j.bi_buf=re>>m-j.bi_valid,j.bi_valid+=Ce-m):(j.bi_buf|=re<<j.bi_valid&65535,j.bi_valid+=Ce)}function xe(j,re,Ce){Ee(j,Ce[2*re],Ce[2*re+1])}function Pe(j,re){for(var Ce=0;Ce|=1&j,j>>>=1,Ce<<=1,0<--re;);return Ce>>>1}function ze(j,re,Ce){var Se,oe,se=new Array(v+1),Te=0;for(Se=1;Se<=v;Se++)se[Se]=Te=Te+Ce[Se-1]<<1;for(oe=0;oe<=re;oe++){var Y=j[2*oe+1];Y!==0&&(j[2*oe]=Pe(se[Y]++,Y))}}function le(j){var re;for(re=0;re<h;re++)j.dyn_ltree[2*re]=0;for(re=0;re<p;re++)j.dyn_dtree[2*re]=0;for(re=0;re<g;re++)j.bl_tree[2*re]=0;j.dyn_ltree[2*x]=1,j.opt_len=j.static_len=0,j.last_lit=j.matches=0}function He(j){8<j.bi_valid?U(j,j.bi_buf):0<j.bi_valid&&(j.pending_buf[j.pending++]=j.bi_buf),j.bi_buf=0,j.bi_valid=0}function Ne(j,re,Ce,Se){var oe=2*re,se=2*Ce;return j[oe]<j[se]||j[oe]===j[se]&&Se[re]<=Se[Ce]}function Ue(j,re,Ce){for(var Se=j.heap[Ce],oe=Ce<<1;oe<=j.heap_len&&(oe<j.heap_len&&Ne(re,j.heap[oe+1],j.heap[oe],j.depth)&&oe++,!Ne(re,Se,j.heap[oe],j.depth));)j.heap[Ce]=j.heap[oe],Ce=oe,oe<<=1;j.heap[Ce]=Se}function lt(j,re,Ce){var Se,oe,se,Te,Y=0;if(j.last_lit!==0)for(;Se=j.pending_buf[j.d_buf+2*Y]<<8|j.pending_buf[j.d_buf+2*Y+1],oe=j.pending_buf[j.l_buf+Y],Y++,Se===0?xe(j,oe,re):(xe(j,(se=P[oe])+u+1,re),(Te=_[se])!==0&&Ee(j,oe-=Z[se],Te),xe(j,se=K(--Se),Ce),(Te=A[se])!==0&&Ee(j,Se-=ue[se],Te)),Y<j.last_lit;);xe(j,x,re)}function et(j,re){var Ce,Se,oe,se=re.dyn_tree,Te=re.stat_desc.static_tree,Y=re.stat_desc.has_stree,be=re.stat_desc.elems,O=-1;for(j.heap_len=0,j.heap_max=f,Ce=0;Ce<be;Ce++)se[2*Ce]!==0?(j.heap[++j.heap_len]=O=Ce,j.depth[Ce]=0):se[2*Ce+1]=0;for(;j.heap_len<2;)se[2*(oe=j.heap[++j.heap_len]=O<2?++O:0)]=1,j.depth[oe]=0,j.opt_len--,Y&&(j.static_len-=Te[2*oe+1]);for(re.max_code=O,Ce=j.heap_len>>1;1<=Ce;Ce--)Ue(j,se,Ce);for(oe=be;Ce=j.heap[1],j.heap[1]=j.heap[j.heap_len--],Ue(j,se,1),Se=j.heap[1],j.heap[--j.heap_max]=Ce,j.heap[--j.heap_max]=Se,se[2*oe]=se[2*Ce]+se[2*Se],j.depth[oe]=(j.depth[Ce]>=j.depth[Se]?j.depth[Ce]:j.depth[Se])+1,se[2*Ce+1]=se[2*Se+1]=oe,j.heap[1]=oe++,Ue(j,se,1),2<=j.heap_len;);j.heap[--j.heap_max]=j.heap[1],function(C,S){var V,J,de,ve,Ye,ot,rt=S.dyn_tree,ft=S.max_code,Lt=S.stat_desc.static_tree,NB=S.stat_desc.has_stree,HB=S.stat_desc.extra_bits,zy=S.stat_desc.extra_base,Bu=S.stat_desc.max_length,lf=0;for(ve=0;ve<=v;ve++)C.bl_count[ve]=0;for(rt[2*C.heap[C.heap_max]+1]=0,V=C.heap_max+1;V<f;V++)Bu<(ve=rt[2*rt[2*(J=C.heap[V])+1]+1]+1)&&(ve=Bu,lf++),rt[2*J+1]=ve,ft<J||(C.bl_count[ve]++,Ye=0,zy<=J&&(Ye=HB[J-zy]),ot=rt[2*J],C.opt_len+=ot*(ve+Ye),NB&&(C.static_len+=ot*(Lt[2*J+1]+Ye)));if(lf!==0){do{for(ve=Bu-1;C.bl_count[ve]===0;)ve--;C.bl_count[ve]--,C.bl_count[ve+1]+=2,C.bl_count[Bu]--,lf-=2}while(0<lf);for(ve=Bu;ve!==0;ve--)for(J=C.bl_count[ve];J!==0;)ft<(de=C.heap[--V])||(rt[2*de+1]!==ve&&(C.opt_len+=(ve-rt[2*de+1])*rt[2*de],rt[2*de+1]=ve),J--)}}(j,re),ze(se,O,j.bl_count)}function B(j,re,Ce){var Se,oe,se=-1,Te=re[1],Y=0,be=7,O=4;for(Te===0&&(be=138,O=3),re[2*(Ce+1)+1]=65535,Se=0;Se<=Ce;Se++)oe=Te,Te=re[2*(Se+1)+1],++Y<be&&oe===Te||(Y<O?j.bl_tree[2*oe]+=Y:oe!==0?(oe!==se&&j.bl_tree[2*oe]++,j.bl_tree[2*T]++):Y<=10?j.bl_tree[2*M]++:j.bl_tree[2*k]++,se=oe,O=(Y=0)===Te?(be=138,3):oe===Te?(be=6,3):(be=7,4))}function _e(j,re,Ce){var Se,oe,se=-1,Te=re[1],Y=0,be=7,O=4;for(Te===0&&(be=138,O=3),Se=0;Se<=Ce;Se++)if(oe=Te,Te=re[2*(Se+1)+1],!(++Y<be&&oe===Te)){if(Y<O)for(;xe(j,oe,j.bl_tree),--Y!=0;);else oe!==0?(oe!==se&&(xe(j,oe,j.bl_tree),Y--),xe(j,T,j.bl_tree),Ee(j,Y-3,2)):Y<=10?(xe(j,M,j.bl_tree),Ee(j,Y-3,3)):(xe(j,k,j.bl_tree),Ee(j,Y-11,7));se=oe,O=(Y=0)===Te?(be=138,3):oe===Te?(be=6,3):(be=7,4)}}l(ue);var fe=!1;function G(j,re,Ce,Se){Ee(j,(c<<1)+(Se?1:0),3),function(oe,se,Te,Y){He(oe),Y&&(U(oe,Te),U(oe,~Te)),o.arraySet(oe.pending_buf,oe.window,se,Te,oe.pending),oe.pending+=Te}(j,re,Ce,!0)}r._tr_init=function(j){fe||(function(){var re,Ce,Se,oe,se,Te=new Array(v+1);for(oe=Se=0;oe<d-1;oe++)for(Z[oe]=Se,re=0;re<1<<_[oe];re++)P[Se++]=oe;for(P[Se-1]=oe,oe=se=0;oe<16;oe++)for(ue[oe]=se,re=0;re<1<<A[oe];re++)N[se++]=oe;for(se>>=7;oe<p;oe++)for(ue[oe]=se<<7,re=0;re<1<<A[oe]-7;re++)N[256+se++]=oe;for(Ce=0;Ce<=v;Ce++)Te[Ce]=0;for(re=0;re<=143;)R[2*re+1]=8,re++,Te[8]++;for(;re<=255;)R[2*re+1]=9,re++,Te[9]++;for(;re<=279;)R[2*re+1]=7,re++,Te[7]++;for(;re<=287;)R[2*re+1]=8,re++,Te[8]++;for(ze(R,h+1,Te),re=0;re<p;re++)I[2*re+1]=5,I[2*re]=Pe(re,5);pe=new H(R,_,u+1,h,v),Q=new H(I,A,0,p,v),Le=new H(new Array(0),$,0,g,y)}(),fe=!0),j.l_desc=new ee(j.dyn_ltree,pe),j.d_desc=new ee(j.dyn_dtree,Q),j.bl_desc=new ee(j.bl_tree,Le),j.bi_buf=0,j.bi_valid=0,le(j)},r._tr_stored_block=G,r._tr_flush_block=function(j,re,Ce,Se){var oe,se,Te=0;0<j.level?(j.strm.data_type===2&&(j.strm.data_type=function(Y){var be,O=4093624447;for(be=0;be<=31;be++,O>>>=1)if(1&O&&Y.dyn_ltree[2*be]!==0)return s;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return a;for(be=32;be<u;be++)if(Y.dyn_ltree[2*be]!==0)return a;return s}(j)),et(j,j.l_desc),et(j,j.d_desc),Te=function(Y){var be;for(B(Y,Y.dyn_ltree,Y.l_desc.max_code),B(Y,Y.dyn_dtree,Y.d_desc.max_code),et(Y,Y.bl_desc),be=g-1;3<=be&&Y.bl_tree[2*E[be]+1]===0;be--);return Y.opt_len+=3*(be+1)+5+5+4,be}(j),oe=j.opt_len+3+7>>>3,(se=j.static_len+3+7>>>3)<=oe&&(oe=se)):oe=se=Ce+5,Ce+4<=oe&&re!==-1?G(j,re,Ce,Se):j.strategy===4||se===oe?(Ee(j,2+(Se?1:0),3),lt(j,R,I)):(Ee(j,4+(Se?1:0),3),function(Y,be,O,C){var S;for(Ee(Y,be-257,5),Ee(Y,O-1,5),Ee(Y,C-4,4),S=0;S<C;S++)Ee(Y,Y.bl_tree[2*E[S]+1],3);_e(Y,Y.dyn_ltree,be-1),_e(Y,Y.dyn_dtree,O-1)}(j,j.l_desc.max_code+1,j.d_desc.max_code+1,Te+1),lt(j,j.dyn_ltree,j.dyn_dtree)),le(j),Se&&He(j)},r._tr_tally=function(j,re,Ce){return j.pending_buf[j.d_buf+2*j.last_lit]=re>>>8&255,j.pending_buf[j.d_buf+2*j.last_lit+1]=255&re,j.pending_buf[j.l_buf+j.last_lit]=255&Ce,j.last_lit++,re===0?j.dyn_ltree[2*Ce]++:(j.matches++,re--,j.dyn_ltree[2*(P[Ce]+u+1)]++,j.dyn_dtree[2*K(re)]++),j.last_lit===j.lit_bufsize-1},r._tr_align=function(j){Ee(j,2,3),xe(j,x,R),function(re){re.bi_valid===16?(U(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(j)}},{"../utils/common":41}],53:[function(n,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,r){(function(o){(function(s,a){if(!s.setImmediate){var l,c,d,u,h=1,p={},g=!1,f=s.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(s);v=v&&v.setTimeout?v:s,l={}.toString.call(s.process)==="[object process]"?function(T){process.nextTick(function(){y(T)})}:function(){if(s.postMessage&&!s.importScripts){var T=!0,M=s.onmessage;return s.onmessage=function(){T=!1},s.postMessage("","*"),s.onmessage=M,T}}()?(u="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",x,!1):s.attachEvent("onmessage",x),function(T){s.postMessage(u+T,"*")}):s.MessageChannel?((d=new MessageChannel).port1.onmessage=function(T){y(T.data)},function(T){d.port2.postMessage(T)}):f&&"onreadystatechange"in f.createElement("script")?(c=f.documentElement,function(T){var M=f.createElement("script");M.onreadystatechange=function(){y(T),M.onreadystatechange=null,c.removeChild(M),M=null},c.appendChild(M)}):function(T){setTimeout(y,0,T)},v.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var M=new Array(arguments.length-1),k=0;k<M.length;k++)M[k]=arguments[k+1];var _={callback:T,args:M};return p[h]=_,l(h),h++},v.clearImmediate=m}function m(T){delete p[T]}function y(T){if(g)setTimeout(y,0,T);else{var M=p[T];if(M){g=!0;try{(function(k){var _=k.callback,A=k.args;switch(A.length){case 0:_();break;case 1:_(A[0]);break;case 2:_(A[0],A[1]);break;case 3:_(A[0],A[1],A[2]);break;default:_.apply(a,A)}})(M)}finally{m(T),g=!1}}}}function x(T){T.source===s&&typeof T.data=="string"&&T.data.indexOf(u)===0&&y(+T.data.slice(u.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof m1<"u"?m1:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(LP);var Voe=LP.exports;const $0=rk(Voe),zoe=X`
  .container {
    position: absolute;
    width: 480px;
    left: calc(50% - 480px / 2);
    top: calc(50% - 270px / 2);
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-base);
    line-height: var(--affine-line-height);
    padding: 12px 40px 36px;
    gap: 20px;
    display: flex;
    flex-direction: column;
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 16px;
    z-index: var(--affine-z-index-popover);
  }

  .container[hidden] {
    display: none;
  }

  header {
    cursor: move;
    user-select: none;
    font-size: var(--affine-font-h-6);
    font-weight: 600;
  }

  a {
    white-space: nowrap;
    word-break: break-word;
    color: var(--affine-link-color);
    fill: var(--affine-link-color);
    text-decoration: none;
    cursor: pointer;
  }

  header icon-button {
    margin-left: auto;
    position: relative;
    left: 24px;
  }

  .button-container {
    display: flex;
    justify-content: space-between;
  }

  .button-container icon-button {
    padding: 8px 12px;
    justify-content: flex-start;
    gap: 12px;
    width: 190px;
    height: 40px;
    box-shadow: var(--affine-shadow-1);
    border-radius: 10px;
  }

  .footer {
    display: flex;
    align-items: center;
    color: var(--affine-text-secondary-color);
  }

  .loading-header {
    display: flex;
    align-items: center;
  }

  .button-suffix {
    display: flex;
    margin-left: auto;
  }

  .overlay-mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--affine-z-index-popover);
  }
`;var joe=Object.defineProperty,Goe=Object.getOwnPropertyDescriptor,Oc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Goe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&joe(e,n,r),r};const z6=1024*200;async function Zoe(t,e){const n=new ar({workspace:t,middlewares:[Xl]}),i=new Ws;i.applyConfigs(n.adapterConfigs);const r=await i.toPageSnapshot({file:e});return[(await n.snapshotToPage(r)).id]}async function Woe(t,e){const n=new ar({workspace:t,middlewares:[Xl]}),i=new b9;i.applyConfigs(n.adapterConfigs);const r=await i.toPageSnapshot({file:e});return[(await n.snapshotToPage(r)).id]}async function qoe(t,e){const n=[];let i=!1;const r=async s=>{const l=await new $0().loadAsync(s),c=new Map,d=Object.keys(l.files),u=[];for(let p=0;p<d.length;p++){const g=d[p];if(g.startsWith("__MACOSX/"))continue;const f=g.lastIndexOf("/"),v=g.substring(f+1);if(v.endsWith(".html")||v.endsWith(".md")){if(g.endsWith("/index.html")){i=!0;continue}if(f!==-1){const m=await l.files[g].async("text"),x=new DOMParser().parseFromString(m,"text/html").querySelector(".page-body");if(x&&x.children.length==0)continue}c.set(g,t.idGenerator())}if(p===0&&v.endsWith(".csv")&&window.open("https://affine.pro/blog/import-your-data-from-notion-into-affine","_blank"),v.endsWith(".zip")){const m=await l.file(v)?.async("blob");m&&u.push(...await r(m))}}const h=Array.from(c.keys()).map(async p=>{const g=new ar({workspace:t,middlewares:[Xl]}),f=new b9;f.applyConfigs(g.adapterConfigs);const v=await f.toPageSnapshot({file:await l.files[p].async("text"),pageId:c.get(p),pageMap:c}),m=await g.snapshotToPage(v);n.push(m.id)});return u.push(...h),u},o=await r(e);return await Promise.all(o.flat()),{pageIds:n,isWorkspaceFile:i}}let Ao=class extends me(Ae){constructor(t,e,n=new AbortController){super(),this.workspace=t,this.onSuccess=e,this.abortController=n,this._loading=!1,this.x=0,this.y=0,this._startX=0,this._startY=0,this._loading=!1,this.x=0,this.y=0,this._startX=0,this._startY=0,this._onMouseMove=this._onMouseMove.bind(this)}updated(t){(t.has("x")||t.has("y"))&&(this.containerEl.style.transform=`translate(${this.x}px, ${this.y}px)`)}_onMouseDown(t){this._startX=t.clientX-this.x,this._startY=t.clientY-this.y,window.addEventListener("mousemove",this._onMouseMove)}_onMouseUp(){window.removeEventListener("mousemove",this._onMouseMove)}_onMouseMove(t){this.x=t.clientX-this._startX,this.y=t.clientY-this._startY}_onCloseClick(t){t.stopPropagation(),this.abortController.abort()}_onImportSuccess(t,e=!1){this.onSuccess?.(t,e)}async _importMarkDown(){const t=await yh({acceptType:"Markdown"});if(!t)return;const e=await t.text(),n=t.size>z6;n?(this.hidden=!1,this._loading=!0):this.abortController.abort();const i=await Zoe(this.workspace,e);n&&this.abortController.abort(),this._onImportSuccess(i)}async _importHtml(){const t=await yh({acceptType:"Html"});if(!t)return;const e=await t.text(),n=t.size>z6;n?(this.hidden=!1,this._loading=!0):this.abortController.abort();const i=await Woe(this.workspace,e);n&&this.abortController.abort(),this._onImportSuccess(i)}async _importNotion(){const t=await yh({acceptType:"Zip"});if(!t)return;let e=0;const i=await new $0().loadAsync(t),r=Object.values(i.files);for(const l of r){if(l.dir)continue;const c=await l.async("uint8array");e+=c.length}const o=e>z6;o?(this.hidden=!1,this._loading=!0):this.abortController.abort();const{pageIds:s,isWorkspaceFile:a}=await qoe(this.workspace,t);o&&this.abortController.abort(),this._onImportSuccess(s,a)}_openLearnImportLink(t){t.stopPropagation(),window.open("https://affine.pro/blog/import-your-data-from-notion-into-affine","_blank")}render(){return this._loading?b`
        <div class="overlay-mask blocksuite-overlay"></div>
        <div class="container">
          <header
            class="loading-header"
            @mousedown="${this._onMouseDown}"
            @mouseup="${this._onMouseUp}"
          >
            <div>Import</div>
            <loader-element .width=${"50px"}></loader-element>
          </header>
          <div>
            Importing the file may take some time. It depends on document size
            and complexity.
          </div>
        </div>
      `:b`
      <div
        class="overlay-mask blocksuite-overlay"
        @click="${()=>this.abortController.abort()}"
      ></div>
      <div class="container">
        <header @mousedown="${this._onMouseDown}" @mouseup="${this._onMouseUp}">
          <icon-button height="28px" @click="${this._onCloseClick}">
            ${Z9}
          </icon-button>
          <div>Import</div>
        </header>
        <div>
          AFFiNE will gradually support more file formats for import.
          <a
            href="https://community.affine.pro/c/feature-requests/import-export"
            target="_blank"
            >Provide feedback.</a
          >
        </div>
        <div class="button-container">
          <icon-button
            class="button-item"
            text="Markdown"
            @click="${this._importMarkDown}"
          >
            ${oL}
          </icon-button>
          <icon-button
            class="button-item"
            text="HTML"
            @click="${this._importHtml}"
          >
            ${sL}
          </icon-button>
        </div>
        <div class="button-container">
          <icon-button
            class="button-item"
            text="Notion"
            @click="${this._importNotion}"
          >
            ${aL}
            <div
              slot="suffix"
              class="button-suffix"
              @click="${this._openLearnImportLink}"
            >
              ${cL}
              <affine-tooltip>
                Learn how to Import your Notion pages into AFFiNE.
              </affine-tooltip>
            </div>
          </icon-button>
          <icon-button class="button-item" text="Coming soon..." disabled>
            ${lL}
          </icon-button>
        </div>
        <!-- <div class="footer">
        <div>Migrate from other versions of AFFiNE?</div>
      </div> -->
      </div>
    `}};Ao.styles=zoe;Oc([ie()],Ao.prototype,"_loading",2);Oc([ie()],Ao.prototype,"x",2);Oc([ie()],Ao.prototype,"y",2);Oc([ie()],Ao.prototype,"_startX",2);Oc([ie()],Ao.prototype,"_startY",2);Oc([he(".container")],Ao.prototype,"containerEl",2);Ao=Oc([W("import-doc")],Ao);function MP({workspace:t,onSuccess:e,container:n=document.body,abortController:i=new AbortController}){const r=new Ao(t,e,i);return n.appendChild(r),i.signal.addEventListener("abort",()=>r.remove()),r}function Yoe({positioningPoint:t,objRect:e={width:0,height:0},boundaryRect:n=document.body.getBoundingClientRect(),offsetX:i=0,offsetY:r=0,edgeGap:o=20}){const s=Es(t.x+i,o,n.width-e.width-o),a=t.y+r;return{x:s,y:a}}function Xoe(t,e=document.body,n=20){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=i.top-r.top,s=r.bottom-i.bottom,a=o>s?"top":"bottom";return{placement:a,height:(a==="top"?o:s)-n}}function PP(t,e,{gap:n=12,offsetY:i=5}={}){t||console.warn("The popper element is not exist. Popper position maybe incorrect");const{placement:r,height:o}=Xoe(e,document.body,n+i),s=e.getBoundingClientRect(),a={x:s.x,y:s.y+(r==="bottom"?s.height:0)},l=document.body.getBoundingClientRect(),c=t?.getBoundingClientRect(),d=Yoe({positioningPoint:a,objRect:c,boundaryRect:l,offsetY:r==="bottom"?i:-i});return{placement:r,height:o,x:`${d.x}px`,y:r==="bottom"?`${d.y}px`:`calc(${d.y}px - 100%)`}}const bd=" ",j_="Untitled";function Koe(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function AP(t,e){const n=t.trim().toLowerCase().split("").filter(r=>r!==" ").join("");return new RegExp(e.split("").filter(r=>r!==" ").map(r=>`${Koe(r)}.*`).join(""),"i").test(n)}const G_="Untitled",Z_=8;function f2({editorHost:t,model:e,pageId:n}){const i=Ja(t,e);D(i,"Editor not found");const r=i.getInlineRange();D(r),i.insertText(r,bd,{reference:{type:"LinkedPage",pageId:n}}),i.setInlineRange({index:r.index+1,length:0})}const Qoe=({editorHost:t,query:e,page:n,model:i,pageMetas:r})=>{const o=e||G_,s=o.slice(0,Z_)+(o.length>Z_?"..":"");return[{name:"Link to Page",styles:"overflow-y: scroll; max-height: 224px;",items:r.filter(({id:l})=>l!==n.id).filter(({title:l})=>AP(l,e)).map(l=>({key:l.id,name:l.title||G_,icon:b3,action:()=>f2({editorHost:t,model:i,pageId:l.id})}))},{name:"New page",items:[{key:"create",name:`Create "${s}" page`,icon:gb,action:async()=>{const l=e,c=await Vg(n.workspace,{title:l});f2({editorHost:t,model:i,pageId:c.id})}},{key:"import",name:"Import",icon:dL,action:()=>{const l=c=>{if(kt(t,`Successfully imported ${c.length} Page${c.length>1?"s":""}.`),c.length===0)return;const d=c[0];f2({editorHost:t,model:i,pageId:d})};MP({workspace:n.workspace,onSuccess:l})}}]}]},Joe=X`
  :host {
    position: absolute;
  }

  .linked-doc-popover {
    position: fixed;
    left: 0;
    top: 0;
    box-sizing: border-box;
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-base);
    padding: 12px 8px;
    display: flex;
    flex-direction: column;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 12px;
    z-index: var(--affine-z-index-popover);
  }

  .linked-doc-popover icon-button {
    padding: 8px;
    justify-content: flex-start;
    gap: 8px;
  }

  .linked-doc-popover .group-title {
    color: var(--affine-text-secondary-color);
    margin: 8px 12px;
  }

  .linked-doc-popover .divider {
    margin: 6px 12px;
    height: 1px;
    background: var(--affine-border-color);
  }

  ${uu(".linked-doc-popover .group")}
`;var ese=Object.defineProperty,tse=Object.getOwnPropertyDescriptor,Rc=(t,e,n,i)=>{for(var r=i>1?void 0:i?tse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ese(e,n,r),r};let $o=class extends me(Ae){constructor(t,e,n=new AbortController){super(),this.editorHost=t,this.model=e,this.abortController=n,this._position=null,this._query="",this._activatedItemIndex=0,this._actionGroup=[]}get _flattenActionList(){return this._actionGroup.map(t=>t.items.map(e=>({...e,groupName:t.name}))).flat()}_updateActionList(){this._actionGroup=this.options.getMenus({editorHost:this.editorHost,query:this._query,page:this._page,model:this.model,pageMetas:this._page.workspace.meta.pageMetas})}get _page(){return this.model.page}connectedCallback(){super.connectedCallback();const t=Vm(this.editorHost,this.model);D(t,"RichText not found");const e=t.inlineEditor;D(e,"RichText InlineEditor not found"),this._updateActionList(),this._disposables.add(this.model.page.workspace.slots.pagesUpdated.on(()=>{this._updateActionList()})),this._disposables.addFromEvent(this,"mousedown",n=>{n.preventDefault()}),bP({target:e.eventSource,inlineEditor:e,onUpdateQuery:n=>{this._query=n,this._activatedItemIndex=0,this._updateActionList()},abortController:this.abortController,onMove:n=>{const i=this._flattenActionList.length;this._activatedItemIndex=(i+this._activatedItemIndex+n)%i;const r=this._flattenActionList[this._activatedItemIndex],o=this.shadowRoot;if(!o){console.warn("Failed to find the shadow root!",this);return}const s=o.querySelector(`icon-button[data-id="${r.key}"]`);if(!s){console.warn("Failed to find the active item!",r);return}s.scrollIntoView({block:"nearest"})},onConfirm:()=>{this.abortController.abort(),D8(this.editorHost,this.model,this.triggerKey+this._query),this._flattenActionList[this._activatedItemIndex].action()?.catch(console.error)},onEsc:()=>{this.abortController.abort()}})}updatePosition(t){this._position=t}render(){const e=this._position?we({transform:`translate(${this._position.x}, ${this._position.y})`,maxHeight:`${Math.min(this._position.height,396)}px`}):we({visibility:"hidden"});let n=0;return b`<div
      class="linked-doc-popover blocksuite-overlay"
      style="${e}"
    >
      ${this._actionGroup.filter(i=>i.items.length).map((i,r)=>b`
            <div class="divider" ?hidden=${r===0}></div>
            <div class="group-title">${i.name}</div>
            <div class="group" style=${i.styles??""}>
              ${i.items.map(({key:o,name:s,icon:a,action:l})=>{n++;const c=n-1;return b`<icon-button
                  width="280px"
                  height="32px"
                  data-id=${o}
                  text=${s}
                  ?hover=${this._activatedItemIndex===c}
                  @click=${()=>{this.abortController.abort(),D8(this.editorHost,this.model,this.triggerKey+this._query),l()?.catch(console.error)}}
                  @mousemove=${()=>{this._activatedItemIndex=c}}
                  >${a}</icon-button
                >`})}
            </div>
          `)}
    </div>`}};$o.styles=Joe;Rc([L({attribute:!1})],$o.prototype,"options",2);Rc([L({attribute:!1})],$o.prototype,"triggerKey",2);Rc([ie()],$o.prototype,"_position",2);Rc([ie()],$o.prototype,"_query",2);Rc([ie()],$o.prototype,"_activatedItemIndex",2);Rc([he(".linked-doc-popover")],$o.prototype,"linkedDocElement",2);$o=Rc([W("affine-linked-doc-popover")],$o);var nse=Object.defineProperty,ise=Object.getOwnPropertyDescriptor,rse=(t,e,n,i)=>{for(var r=i>1?void 0:i?ise(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&nse(e,n,r),r};function ose({editorHost:t,model:e,range:n,container:i=document.body,abortController:r=new AbortController,options:o,triggerKey:s}){const a=new dt;r.signal.addEventListener("abort",()=>a.dispose());const l=new $o(t,e,r);l.options=o,l.triggerKey=s,i.appendChild(l),a.add(()=>l.remove());const c=Vd(()=>{const u=l.linkedDocElement;D(u,"You should render the linked page node even if no position");const h=PP(u,n);l.updatePosition(h)},10);a.addFromEvent(window,"resize",c);const d=hO(t);return d&&a.addFromEvent(d,"scroll",c,{passive:!0}),setTimeout(c),a.addFromEvent(window,"mousedown",u=>{u.target!==l&&r.abort()}),l}const pp="affine-linked-doc-widget";let fp=class extends to{constructor(){super(...arguments),this.options=fp.DEFAULT_OPTIONS,this.showLinkedDoc=(t,e)=>{const n=zg();ose({editorHost:this.host,model:t,range:n,options:this.options,triggerKey:e})},this._onKeyDown=t=>{const n=t.get("keyboardState").raw;if(Uh(n)||n.key.length!==1)return;const i=this.host.selection.value.find(h=>h.is("text"));if(!i)return;const r=this.host.page.getBlockById(i.blockId);if(!r||Ie(r,this.options.ignoreBlockTypes))return;const o=Ja(this.host,r);if(!o)return;const s=o.getInlineRange();if(!s||s.length>0)return;const[a,l]=o.getTextPoint(s.index),c=a.textContent?a.textContent.slice(0,l):"",d=this.options.triggerKeys.find(h=>(c+n.key).endsWith(h));if(!d)return;const u=this.options.triggerKeys[0];o.slots.inlineRangeApply.once(()=>{if(this.options.convertTriggerKey&&u!==d){const h=s.index-(d.length-1);o.deleteText({index:h,length:d.length}),o.insertText({index:h,length:0},u),o.setInlineRange({index:h+u.length,length:0}),o.slots.inlineRangeApply.once(()=>{this.showLinkedDoc(r,u)});return}this.showLinkedDoc(r,d)})}}connectedCallback(){super.connectedCallback(),this.handleEvent("keyDown",this._onKeyDown)}};fp.DEFAULT_OPTIONS={triggerKeys:["@","[[",""],ignoreBlockTypes:["affine:code"],convertTriggerKey:!0,getMenus:Qoe};fp=rse([W(pp)],fp);var sse=Object.defineProperty,ase=Object.getOwnPropertyDescriptor,lse=(t,e,n,i)=>{for(var r=i>1?void 0:i?ase(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&sse(e,n,r),r};let m5=class extends Ae{close(){this.remove()}modalRef(t){t&&this.onOpen?.(t)}render(){const{options:t}=this;return b`<div class="modal-background blocksuite-overlay">
      <div class="modal-window">
        <div class="modal-main" ${$t(this.modalRef)}></div>
        <div class="modal-footer">
          ${t.footer?Fe(t.footer,e=>e.text,e=>b`
                  <button
                    class="button ${e.type??""}"
                    @click=${e.onClick}
                  >
                    ${e.text}
                  </button>
                `):ae}
        </div>
      </div>
    </div>`}};m5.styles=X`
    :host {
      z-index: calc(var(--affine-z-index-modal) + 3);
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
    }

    .modal-background {
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      align-items: center;
      background-color: var(--affine-background-modal-color);
      justify-content: center;
      display: flex;
    }

    .modal-window {
      width: 70%;
      min-width: 500px;
      height: 80%;
      overflow-y: scroll;
      background-color: var(--affine-background-overlay-panel-color);
      border-radius: 12px;
      box-shadow: var(--affine-shadow-3);
      position: relative;
    }

    .modal-main {
      height: 100%;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 20px;
      padding: 24px;
      position: absolute;
      box-sizing: border-box;
      bottom: 0;
      right: 0;
    }

    .modal-footer .button {
      align-items: center;
      background: var(--affine-white);
      border: 1px solid;
      border-color: var(--affine-border-color);
      border-radius: 8px;
      color: var(--affine-text-primary-color);
      cursor: pointer;
      display: inline-flex;
      font-size: var(--affine-font-sm);
      font-weight: 500;
      justify-content: center;
      outline: 0;
      padding: 12px 18px;
      touch-action: manipulation;
      transition: all 0.3s;
      user-select: none;
    }

    .modal-footer .primary {
      background: var(--affine-primary-color);
      border-color: var(--affine-black-10);
      box-shadow: var(--affine-button-inner-shadow);
      color: var(--affine-pure-white);
    }
  `;m5=lse([W("affine-custom-modal")],m5);function cse(t,e=document.body){const n=new m5;return n.onOpen=t.entry,n.options=t,e.appendChild(n),n}var dse=Object.defineProperty,use=Object.getOwnPropertyDescriptor,hse=(t,e,n,i)=>{for(var r=i>1?void 0:i?use(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&dse(e,n,r),r};const gp="affine-modal-widget";let H8=class extends to{open(t){return cse(t,this.ownerDocument.body)}render(){return ae}};H8=hse([W(gp)],H8);class hv extends li{constructor(){super(...arguments),this.maxFileSize=10*1e3*1e3,this.slots={onFilesDropped:new Ve},this._fileDropOptions={flavour:this.flavour,onDrop:async({files:e,targetModel:n,place:i})=>{if(!e.length||!n||Ie(n,["affine:surface"]))return!1;const r=e.filter(o=>!o.type.startsWith("image/"));return r.forEach(o=>{TP(this.std.host,o,this.maxFileSize,n,i).catch(console.error)}),this.slots.onFilesDropped.emit(r),!0}}}mounted(){super.mounted(),this.fileDropManager=new ps(this,this._fileDropOptions)}}function W_(t){return t.reduce((e,n)=>((!e.length||e[e.length-1]!==n.groupName)&&e.push(n.groupName),e),[])}function r1(t,e,n,i){if(!e.text)throw new Error("Can't insert text! Text not found");const r=Ja(t,e);if(!r)throw new Error("Can't insert text! Inline editor not found");const o=r.getInlineRange(),s=o?o.index:e.text.length;e.text.insert(n,s,i),r.setInlineRange({index:s+n.length,length:0})}function j6(t){const e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${e}-${n}-${i}`}function ss(t){return Hg(t.page,t,"affine:database")}function sa(t){return async e=>{await t(e);const{model:n}=e;n.text?.length||n.page.deleteBlock(n)}}const pse=[{name:"Text",items:[...wa.filter(t=>t.flavour!=="affine:list").map(({name:t,icon:e,flavour:n,type:i})=>({name:t,icon:e,showWhen:r=>r.page.schema.flavourSchemaMap.has(n)?["Quote","Code Block","Divider"].includes(t)?!ss(r):!0:!1,action:({pageElement:r})=>{r.host.std.command.pipe().withHost().tryAll(o=>[o.getTextSelection(),o.getBlockSelections()]).getSelectedBlocks({types:["text","block"]}).inline(o=>{const{selectedBlocks:s}=o;D(s);const a=hp(s,n,i);if(n==="affine:code"){if(a.length!==1)throw new Error("Failed to reset selection! New model length isn't 1");const l=a[0];nv(r.host,l,c=>{const d=c.inlineEditor;D(d),d.focusEnd()}).catch(console.error)}}).run()}}))]},{name:"Style",items:dv.filter(t=>!["Link","Code"].includes(t.name)).map(({name:t,icon:e,id:n})=>({name:t,icon:e,action:({pageElement:i,model:r})=>{if(!r.text)return;const o=r.text.length;if(!o){const s=Ja(i.host,r);D(s,"Can't set style mark! Inline editor not found"),s.setMarks({[n]:!0}),Yk(s);return}r.text.format(0,o,{[n]:!0})}}))},{name:"List",items:wa.filter(t=>t.flavour==="affine:list").map(({name:t,icon:e,flavour:n,type:i})=>({name:t,icon:e,showWhen:r=>!!r.page.schema.flavourSchemaMap.has(n),action:({pageElement:r})=>{r.host.std.command.pipe().withHost().tryAll(o=>[o.getTextSelection(),o.getBlockSelections()]).getSelectedBlocks({types:["text","block"]}).inline(o=>{const{selectedBlocks:s}=o;D(s),hp(s,n,i)}).run()}}))},{name:"Pages",items:[{name:"New Page",icon:gb,action:async({pageElement:t,model:e})=>{const n=await Vg(t.page.workspace);r1(t.host,e,bd,{reference:{type:"LinkedPage",pageId:n.id}})}},{name:"Link Page",alias:["dual link"],icon:RL,showWhen:(t,e)=>{const n=e.widgetElements["affine-linked-doc-widget"];return n?"showLinkedDoc"in n?!0:(console.warn('You may not have correctly implemented the linkedDoc widget! "showLinkedDoc(model)" method not found on widget'),!1):!1},action:({model:t,pageElement:e})=>{const n="@";r1(e.host,t,n),D(t.page.root);const i=e.widgetElements["affine-linked-doc-widget"];D(i);const r=i;setTimeout(()=>{r.showLinkedDoc(t,n)})}}]},{name:"Content & Media",items:[{name:"Image",icon:rI,showWhen:t=>!(!t.page.schema.flavourSchemaMap.has("affine:image")||ss(t)),action:sa(async({pageElement:t,model:e})=>{if(!t.page.getParent(e))return;const i=await R2(),r=t.host.spec.getService("affine:image");D(r),Cs(r,hd);const o=r.maxFileSize;Qb(t.host,i,o,e)})},{name:"Links",icon:Yo,showWhen:t=>t.page.schema.flavourSchemaMap.has("affine:bookmark")?!ss(t):!1,action:sa(async({pageElement:t,model:e})=>{const n=t.page.getParent(e);if(!n)return;const i=n.children.indexOf(e)+1;await yo(t.host,"Links","The added link will be displayed as a card view.",{mode:"page",parentModel:n,index:i})})},{name:"File",icon:FL,alias:["attachment"],showWhen:t=>t.page.schema.flavourSchemaMap.has("affine:attachment")?!ss(t):!1,action:sa(async({pageElement:t,model:e})=>{if(!t.page.getParent(e))return;const r=await yh();if(!r)return;const o=t.host.spec.getService("affine:attachment");D(o),Cs(o,hv);const s=o.maxFileSize;TP(t.host,r,s,e).catch(console.error)})},{name:"YouTube",icon:Ib,showWhen:t=>t.page.schema.flavourSchemaMap.has("affine:embed-youtube")?!ss(t):!1,action:sa(async({pageElement:t,model:e})=>{const n=t.page.getParent(e);if(!n)return;const i=n.children.indexOf(e)+1;await yo(t.host,"YouTube","The added YouTube video link will be displayed as an embed view.",{mode:"page",parentModel:n,index:i})})},{name:"Figma",icon:Sb,showWhen:t=>t.page.schema.flavourSchemaMap.has("affine:embed-figma")?!ss(t):!1,action:sa(async({pageElement:t,model:e})=>{const n=t.page.getParent(e);if(!n)return;const i=n.children.indexOf(e)+1;await yo(t.host,"Figma","The added Figma link will be displayed as an embed view.",{mode:"page",parentModel:n,index:i})})},{name:"GitHub",icon:Tb,showWhen:t=>t.page.schema.flavourSchemaMap.has("affine:embed-github")?!ss(t):!1,action:sa(async({pageElement:t,model:e})=>{const n=t.page.getParent(e);if(!n)return;const i=n.children.indexOf(e)+1;await yo(t.host,"GitHub","The added GitHub issue or pull request link will be displayed as a card view.",{mode:"page",parentModel:n,index:i})})}]},{name:"Date & Time",items:[{name:"Today",icon:kL,action:({pageElement:t,model:e})=>{const n=new Date;r1(t.host,e,j6(n))}},{name:"Tomorrow",icon:EL,action:({pageElement:t,model:e})=>{const n=new Date;n.setDate(n.getDate()+1),r1(t.host,e,j6(n))}},{name:"Yesterday",icon:SL,action:({pageElement:t,model:e})=>{const n=new Date;n.setDate(n.getDate()-1),r1(t.host,e,j6(n))}},{name:"Now",icon:TL,action:({pageElement:t,model:e})=>{const n=new Date;let i=n.getHours();const r=n.getMinutes().toString().padStart(2,"0"),o=i>=12?"pm":"am";i=i%12,i=i||12;const s=i+":"+r+" "+o;r1(t.host,e,s)}}]},{name:"Database",items:[{name:"Table View",alias:["database"],icon:ib,showWhen:t=>!(!t.page.schema.flavourSchemaMap.has("affine:database")||ss(t)),action:sa(async({pageElement:t,model:e})=>{const n=t.page.getParent(e);D(n);const i=n.children.indexOf(e),r=t.page.addBlock("affine:database",{},t.page.getParent(e),i+1);t.std.spec.getService("affine:database").initDatabaseBlock(t.page,e,r,"table",!1)})},{name:"Kanban View",alias:["database"],disabled:!1,icon:bL,showWhen:t=>!(!t.page.schema.flavourSchemaMap.has("affine:database")||ss(t)),action:sa(async({model:t,pageElement:e})=>{const n=e.page.getParent(t);D(n);const i=n.children.indexOf(t),r=e.page.addBlock("affine:database",{},e.page.getParent(t),i+1);e.std.spec.getService("affine:database").initDatabaseBlock(e.page,t,r,"kanban",!1)})}]},{name:"Frames",items:t=>t.pageElement.page.getBlockByFlavour("affine:frame").map(n=>({name:"Frame: "+n.title,icon:Lc,action:async({pageElement:i,model:r})=>{const{page:o}=i,a=o.getParent(r).children.indexOf(r),l={flavour:"affine:surface-ref",reference:n.id,refFlavour:"affine:frame"};o.addSiblingBlocks(r,[l],a===0?"before":"after"),Ie(r,["affine:paragraph"])&&r.text.length===0&&o.deleteBlock(r)}}))},{name:"Group",items:t=>{const e=t.pageElement.page.getBlockByFlavour("affine:surface")[0];return e?Array.from(e.elements.getValue()?.values()??[]).filter(i=>i.get("type")===kn.GROUP).map(i=>({name:"Group: "+i.get("title"),icon:A9,action:async({pageElement:r,model:o})=>{const{page:s}=r,l=s.getParent(o).children.indexOf(o),c={flavour:"affine:surface-ref",reference:i.get("id"),refFlavour:"group"};s.addSiblingBlocks(o,[c],l===0?"before":"after"),Ie(o,["affine:paragraph"])&&o.text.length===0&&s.deleteBlock(o)}}))??[]:[]}},{name:"Actions",items:[{name:"Move Up",icon:GL,action:async({pageElement:t,model:e})=>{const n=t.page,i=n.getPreviousSibling(e);if(!i)return;const r=n.getParent(i);r&&n.moveBlocks([e],r,i,!0)}},{name:"Move Down",icon:ZL,action:async({pageElement:t,model:e})=>{const n=t.page,i=n.getNextSibling(e);if(!i)return;const r=n.getParent(i);r&&n.moveBlocks([e],r,i,!1)}},{name:"Copy",icon:Tr,action:async({pageElement:t,model:e})=>{const n=Ud.fromModels(t.std.page,[e]);t.std.clipboard.copy(n).then(()=>{kt(t.host,"Copied to clipboard")}).catch(i=>{console.error(i)})}},{name:"Duplicate",icon:il,action:({pageElement:t,model:e})=>{if(!e.text||!(e.text instanceof Oi))throw new Error("Can't duplicate a block without text");const n=t.page.getParent(e);if(!n)throw new Error("Failed to duplicate block! Parent not found");const i=n.children.indexOf(e);t.page.addBlock(e.flavour,{type:e.type,text:t.page.Text.fromDelta(e.text.toDelta()),checked:e.checked},t.page.getParent(e),i)}},{name:"Delete",alias:["remove"],icon:xn,action:({pageElement:t,model:e})=>{t.page.deleteBlock(e)}}]}],fse=X`
  .overlay-mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--affine-z-index-popover);
  }

  .slash-menu-container {
    z-index: var(--affine-z-index-popover);
    user-select: none;
  }

  .slash-menu {
    position: fixed;
    left: 0;
    top: 0;
    box-sizing: border-box;
    font-size: var(--affine-font-base);
    padding: 12px 0;
    display: flex;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 12px;
    z-index: var(--affine-z-index-popover);
    /* transition: max-height 0.2s ease-in-out; */
  }

  .slash-category {
    position: relative;
    overflow: hidden;
    box-sizing: border-box;
    width: 150px;
    max-width: 150px;
    display: flex;
    flex-direction: column;
    color: var(--affine-text-secondary-color);
    gap: 5px;
    margin-bottom: 20px;
    /* transition: max-width 0.2s ease-in-out; */
  }
  .slash-category::before {
    content: '';
    position: absolute;
    top: 10px;
    right: 0;
    height: 100%;
    width: 1px;
    background-color: var(--affine-border-color);
  }

  .slash-category-hide {
    max-width: 0;
    padding: 0;
    margin: 0;
    height: 0;
  }

  .slash-category-name {
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-sm);
    white-space: nowrap;
    cursor: pointer;
    padding: 4px 20px;
  }

  .slash-active-category {
    position: relative;
    box-sizing: border-box;
    color: var(--affine-primary-color);
  }

  .slash-active-category::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 1px;
    height: 12px;
    background: linear-gradient(
      180deg,
      var(--affine-text-emphasis-color) 0%,
      var(--affine-palette-purple) 100%
    );
    border-radius: 1px;
  }

  .slash-item-container {
    box-sizing: border-box;
    overflow-y: auto;
    padding: 0 8px;
    width: 200px;
  }

  ${uu(".slash-item-container")}

  .slash-item-divider {
    border-top: 1px dashed var(--affine-border-color);
    margin: 8px 0;
  }
  .slash-item.Delete:hover {
    background: var(--affine-background-error-color);
    color: var(--affine-error-color);
    fill: var(--affine-error-color);
  }
`;var gse=Object.defineProperty,mse=Object.getOwnPropertyDescriptor,lo=(t,e,n,i)=>{for(var r=i>1?void 0:i?mse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&gse(e,n,r),r};let Vi=class extends me(Ae){constructor(){super(...arguments),this._leftPanelActivated=!1,this._activatedItemIndex=0,this._filterItems=[],this._hide=!1,this._position=null,this.abortController=new AbortController,this._searchString="",this._onClickAway=()=>{this._hide&&this.abortController.abort()}}get host(){return this.pageElement.host}connectedCallback(){super.connectedCallback(),this._disposables.addFromEvent(window,"mousedown",this._onClickAway),this._disposables.addFromEvent(this,"mousedown",n=>{n.preventDefault()}),this._filterItems=this._updateItem("");const t=Vm(this.host,this.model);if(!t){console.warn("Slash Menu may not work properly! No rich text found for model",this.model);return}const e=t.inlineEditor;D(e,"RichText InlineEditor not found"),bP({target:e.eventSource,inlineEditor:e,abortController:this.abortController,interceptor:(n,i)=>{if(n.key==="/")return;if(this._hide&&n.key!=="Backspace"){this.abortController.abort();return}if(n.key===" "){this._hide=!0,i();return}this._hide&&(this._hide=!1);const r=Uh(n),o=n.shiftKey;if(n.key==="ArrowLeft"&&!r&&!o){if(n.stopPropagation(),n.preventDefault(),this._searchString.length)return;this._leftPanelActivated=!0;return}if(n.key==="ArrowRight"&&!r&&!o){n.stopPropagation(),n.preventDefault(),this._leftPanelActivated=!1;return}i()},onUpdateQuery:n=>{const i=this._updateItem(n);this._filterItems=i,i.length||(this._hide=!0)},onMove:n=>{const i=this._filterItems.length;if(this._leftPanelActivated){const o=W_(this._filterItems),s=o.findIndex(l=>l===this._filterItems[this._activatedItemIndex].groupName),a=o[(s+n+o.length)%o.length];this._handleClickCategory(a);return}let r=i;do this._activatedItemIndex=(this._activatedItemIndex+n+i)%i;while(this._filterItems[this._activatedItemIndex].disabled&&r--);this._scrollToItem(this._filterItems[this._activatedItemIndex],!1)},onConfirm:()=>{this._handleClickItem(this._activatedItemIndex)},onEsc:()=>{this.abortController.abort()}})}updatePosition(t){this._position=t}_updateItem(t){this._searchString=t,this._activatedItemIndex=0,this._leftPanelActivated&&(this._leftPanelActivated=!1);const e=this._searchString.toLowerCase();let n=this.options.menus.map(i=>typeof i.items=="function"?i.items({pageElement:this.pageElement,model:this.model}).map(r=>({...r,groupName:i.name})):i.items.map(r=>({...r,groupName:i.name}))).flat();return n=n.filter(({showWhen:i=()=>!0})=>i(this.model,this.pageElement)),e?n.filter(({name:i,alias:r=[]})=>[i,...r].some(o=>AP(o,e))):n}_scrollToItem(t,e=!0){const n=this.shadowRoot;if(!n)return;const i=n.querySelector(`icon-button[text="${t.name}"]`);if(i){if(e){i.scrollIntoView(!0);return}i.scrollIntoView({block:"nearest"})}}_handleClickItem(t){if(this._leftPanelActivated||t<0||t>=this._filterItems.length)return;D8(this.host,this.model,this.triggerKey+this._searchString),this.abortController.abort();const{action:e}=this._filterItems[t];e({pageElement:this.pageElement,model:this.model})?.catch(console.error)}_handleClickCategory(t){const e=this._filterItems.find(n=>n.groupName===t);e&&(this._scrollToItem(e),this._activatedItemIndex=this._filterItems.findIndex(n=>n.name===e.name))}_categoryTemplate(){const t=!this._searchString.length,e=this._filterItems[this._activatedItemIndex]?.groupName,n=W_(this._filterItems);return b`<div
      class="slash-category ${t?"":"slash-category-hide"}"
    >
      ${n.map(i=>b`<div
            class="slash-category-name ${e===i?"slash-active-category":""}"
            @click=${()=>this._handleClickCategory(i)}
          >
            ${i}
          </div>`)}
    </div>`}render(){if(this._hide)return ae;const t=408,e=344,n=!this._searchString.length,i=this._position?we({transform:`translate(${this._position.x}, ${this._position.y})`,maxHeight:`${Math.min(this._position.height,n?t:e)}px`}):we({visibility:"hidden"}),r=this._filterItems.map(({name:o,icon:s,suffix:a,disabled:l=!1,groupName:c},d)=>{const u=d!==0&&this._filterItems[d-1].groupName!==c;return b`<div
            class="slash-item-divider"
            ?hidden=${!u||!!this._searchString.length}
          ></div>
          <icon-button
            class="slash-item ${o}"
            ?disabled=${l}
            width="100%"
            height="32px"
            style="padding-left: 12px; justify-content: flex-start; gap: 8px;"
            hover=${!l&&!this._leftPanelActivated&&this._activatedItemIndex===d?"true":"false"}
            text="${o}"
            data-testid="${o}"
            @mousemove=${()=>{this._leftPanelActivated=!1,this._activatedItemIndex=d}}
            @click=${()=>{this._handleClickItem(d)}}
          >
            ${s}
            <div slot="suffix">${a}</div>
          </icon-button>`});return b`<div class="slash-menu-container blocksuite-overlay">
      <div
        class="overlay-mask"
        @click="${()=>this.abortController.abort()}"
      ></div>
      <div class="slash-menu" style="${i}">
        ${this._categoryTemplate()}
        <div class="slash-item-container">${r}</div>
      </div>
    </div>`}};Vi.styles=fse;lo([L({attribute:!1})],Vi.prototype,"pageElement",2);lo([L({attribute:!1})],Vi.prototype,"model",2);lo([L({attribute:!1})],Vi.prototype,"options",2);lo([L({attribute:!1})],Vi.prototype,"triggerKey",2);lo([he(".slash-menu")],Vi.prototype,"slashMenuElement",2);lo([ie()],Vi.prototype,"_leftPanelActivated",2);lo([ie()],Vi.prototype,"_activatedItemIndex",2);lo([ie()],Vi.prototype,"_filterItems",2);lo([ie()],Vi.prototype,"_hide",2);lo([ie()],Vi.prototype,"_position",2);Vi=lo([W("affine-slash-menu")],Vi);var bse=Object.defineProperty,vse=Object.getOwnPropertyDescriptor,yse=(t,e,n,i)=>{for(var r=i>1?void 0:i?vse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&bse(e,n,r),r};let q_=new AbortController;function wse({pageElement:t,model:e,range:n,container:i=document.body,abortController:r=new AbortController,options:o,triggerKey:s}){q_.abort(),q_=r;const a=new dt;r.signal.addEventListener("abort",()=>a.dispose());const l=new Vi;a.add(()=>l.remove()),l.model=e,l.abortController=r,l.options=o,l.pageElement=t,l.triggerKey=s;const c=Vd(()=>{const d=l.slashMenuElement;D(d,"You should render the slash menu node even if no position");const u=PP(d,n);l.updatePosition(u)},10);return a.addFromEvent(window,"resize",c),i.appendChild(l),setTimeout(c),l}const mp="affine-slash-menu-widget";let bp=class extends to{constructor(){super(...arguments),this.options=bp.DEFAULT_OPTIONS,this._onKeyDown=t=>{const n=t.get("keyboardState").raw,i=this.options.isTriggerKey(n);if(i===!1)return;const r=this.host.selection.value.find(a=>a.is("text"));if(!r||r.start.index!==0)return;const o=this.host.page.getBlockById(r.blockId);if(!o||Ie(o,["affine:code"]))return;const s=Ja(this.host,o);s&&s.slots.inlineRangeApply.once(()=>{const a=this.blockElement;if(!sp(a))throw new Error("SlashMenuWidget should be used in PageBlock");requestAnimationFrame(()=>{const l=zg();wse({pageElement:a,model:o,range:l,triggerKey:i,options:this.options})})})}}connectedCallback(){super.connectedCallback(),this.handleEvent("keyDown",this._onKeyDown)}};bp.DEFAULT_OPTIONS={isTriggerKey:t=>{const e=["/"];if(t.key==="Process"&&t.code==="Slash"&&!t.shiftKey)return"/";if(Uh(t)||t.key.length!==1)return!1;const n=e.find(i=>i===t.key);return n||!1},menus:pse};bp=yse([W(mp)],bp);var xse=Object.defineProperty,_se=Object.getOwnPropertyDescriptor,X3=(t,e,n,i)=>{for(var r=i>1?void 0:i?_se(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&xse(e,n,r),r};let vd=class extends me(De){firstUpdated(){this.disposables.add(this.model.propsUpdated.on(()=>this.requestUpdate()))}render(){const{model:t,index:e}=this,n=ne.deserialize(t.xywh),i={position:"absolute",zIndex:`${e}`,width:`${n.w}px`,height:`${n.h}px`,transform:`translate(${n.x}px, ${n.y}px)`};return Be`
      <div
        style=${we(i)}
        data-portal-reference-block-id="${t.id}"
      >
        ${this.renderModel(t)}
      </div>
    `}};vd.styles=X`
    surface-ref-image-portal {
      position: relative;
    }
  `;X3([L({attribute:!1})],vd.prototype,"index",2);X3([L({attribute:!1})],vd.prototype,"model",2);X3([L({attribute:!1})],vd.prototype,"renderModel",2);vd=X3([W("surface-ref-image-portal")],vd);const $P=t=>t.host.selection;function Y_(t,e){return $P(t).filter("block").at(e?-1:0)??null}function X_(t){return $P(t).find("text")}const Bf=(t,e)=>t.host.view.viewFromPath("block",e),Cse=[{name:"Move Up",hotkey:["Mod-Alt-ArrowUp","Mod-Shift-ArrowUp"],action:t=>{const e=t.page,n=X_(t);if(n){const r=Bf(t,n.from.path)?.model;if(!r)return;const o=e.getPreviousSibling(r);if(!o)return;const s=t.page.getParent(o);return s?(t.page.moveBlocks([r],s,o,!0),t.updateComplete.then(()=>{const a=t.host.rangeManager;D(a),a.syncTextSelectionToRange(n)}).catch(console.error),!0):void 0}const i=Y_(t,!0);if(i){const r=Bf(t,i.path)?.model;if(!r)return;const o=e.getPreviousSibling(r);if(!o)return;const s=e.getParent(o);return s?(e.moveBlocks([r],s,o,!1),!0):void 0}}},{name:"Move Down",hotkey:["Mod-Alt-ArrowDown","Mod-Shift-ArrowDown"],action:t=>{const e=t.page,n=X_(t);if(n){const r=Bf(t,n.from.path)?.model;if(!r)return;const o=e.getNextSibling(r);if(!o)return;const s=e.getParent(o);return s?(e.moveBlocks([r],s,o,!1),t.updateComplete.then(()=>{const a=t.host.rangeManager;D(a),a.syncTextSelectionToRange(n)}).catch(console.error),!0):void 0}const i=Y_(t,!0);if(i){const r=Bf(t,i.path)?.model;if(!r)return;const o=e.getNextSibling(r);if(!o)return;const s=e.getParent(o);return s?(e.moveBlocks([r],s,o,!1),!0):void 0}}}],Df=(t,e)=>e.contains(t)&&t!==e;class kse{constructor(e){this._anchorSel=null,this._focusBlock=null,this._reset=()=>{this._anchorSel=null,this._focusBlock=null},this.bind=()=>{this.host.handleEvent("keyDown",n=>{n.get("keyboardState").raw.key!=="Shift"&&this._reset()}),this.host.bindHotKey({ArrowDown:this._onArrowDown,ArrowUp:this._onArrowUp,"Shift-ArrowDown":this._onShiftArrowDown,"Shift-ArrowUp":this._onShiftArrowUp,Escape:this._onEsc,Enter:this._onEnter,"Mod-a":this._onSelectAll}),this._bindQuickActionHotKey(),this._bindTextConversionHotKey(),this._bindMoveBlockHotKey()},this._onArrowDown=()=>this._std.command.pipe().inline((n,i)=>(this._reset(),i())).try(n=>[this._onBlockDown(n)]).run(),this._onBlockDown=n=>n.getBlockSelections().inline((i,r)=>{const o=i.currentBlockSelections;D(o);const s=o.at(-1);if(s)return r({currentSelectionPath:s.path})}).getNextBlock().inline((i,r)=>{const{nextBlock:o}=i;if(D(o),!!Df(o,this.host))return r({focusBlock:o})}).selectBlock(),this._onArrowUp=()=>this._std.command.pipe().inline((n,i)=>(this._reset(),i())).try(n=>[this._onBlockUp(n)]).run(),this._onBlockUp=n=>n.getBlockSelections().inline((i,r)=>{const o=i.currentBlockSelections;D(o);const s=o.at(0);if(s)return r({currentSelectionPath:s.path})}).getPrevBlock().inline((i,r)=>{const{prevBlock:o}=i;if(D(o),!!Df(o,this.host))return r({focusBlock:o})}).selectBlock(),this._onShiftArrowDown=()=>this._std.command.pipe().try(n=>[this._onBlockShiftDown(n)]).run(),this._onBlockShiftDown=n=>n.getBlockSelections().inline((i,r)=>{const o=i.currentBlockSelections;if(D(o),this._anchorSel||(this._anchorSel=o.at(-1)??null),!this._anchorSel)return;const s=i.std.view.viewFromPath("block",this._anchorSel.path);if(s)return r({anchorBlock:s,currentSelectionPath:this._focusBlock?.path??s?.path})}).getNextBlock({}).inline((i,r)=>{if(D(i.nextBlock),this._focusBlock=i.nextBlock,!!Df(this._focusBlock,this.host))return r({focusBlock:this._focusBlock})}).selectBlocksBetween({tail:!0}),this._onShiftArrowUp=()=>this._std.command.pipe().try(n=>[this._onBlockShiftUp(n)]).run(),this._onBlockShiftUp=n=>n.getBlockSelections().inline((i,r)=>{const o=i.currentBlockSelections;if(D(o),this._anchorSel||(this._anchorSel=o.at(0)??null),!this._anchorSel)return;const s=i.std.view.viewFromPath("block",this._anchorSel.path);if(s)return r({anchorBlock:s,currentSelectionPath:this._focusBlock?.path??s?.path})}).getPrevBlock({}).inline((i,r)=>{if(D(i.prevBlock),this._focusBlock=i.prevBlock,!!Df(this._focusBlock,this.host))return r({focusBlock:this._focusBlock})}).selectBlocksBetween({tail:!1}),this._onEsc=()=>this._std.command.pipe().getBlockSelections().inline((n,i)=>{if(n.currentBlockSelections?.at(-1))return n.std.selection.update(o=>o.filter(s=>!s.is("block"))),i()}).run(),this._onEnter=()=>this._std.command.pipe().getBlockSelections().inline((n,i)=>{const r=n.currentBlockSelections?.at(-1);if(!r)return;const{view:o,page:s,selection:a}=n.std,l=o.viewFromPath("block",r.path);if(!l)return;const{model:c}=l,d=s.getParent(c);if(!d)return;const u=d.children.indexOf(c)??void 0,h=s.addBlock("affine:paragraph",{},d,u+1),p=a.create("text",{from:{path:l.parentPath.concat(h),index:0,length:0},to:null});return a.setGroup("note",[p]),i()}).run(),this._onSelectAll=n=>{n.get("defaultState").event.preventDefault();const i=this._std.view,r=this._std.selection;if(!r.find("block"))return;const o=[];i.walkThrough(s=>(s.type==="block"&&!o.map(a=>a.path).reduce((a,l)=>a||l.every(c=>s.path.includes(c)),!1)&&o.push(r.create("block",{path:s.path})),null),this.host.path),r.update(s=>s.filter(a=>!a.is("block")).concat(o))},this._bindQuickActionHotKey=()=>{yP.forEach(n=>{n.hotkey&&this.host.bindHotKey({[n.hotkey]:i=>{n.showWhen(this.host.host)&&(i.get("defaultState").event.preventDefault(),n.action(this.host.host))}})})},this._bindTextConversionHotKey=()=>{wa.forEach(n=>{n.hotkey&&n.hotkey.forEach(i=>{this.host.bindHotKey({[i]:r=>(r.get("defaultState").event.preventDefault(),this._std.command.pipe().withHost().tryAll(o=>[o.getTextSelection(),o.getBlockSelections()]).getSelectedBlocks({types:["text","block"]}).inline((o,s)=>{const{selectedBlocks:a}=o;D(a);const l=hp(a,n.flavour,n.type);if(n.flavour!=="affine:code")return;const[c]=l;rP(this._std.host,c,()=>{const d=this._std.view.viewFromPath("block",qn(c));D(d),this._std.selection.setGroup("note",[this._std.selection.create("text",{from:{path:d.path,index:0,length:c.text?.length??0},to:null})])}).catch(console.error),s()}).run())})})})},this._bindMoveBlockHotKey=()=>{Cse.forEach(n=>{n.hotkey.forEach(i=>{this.host.bindHotKey({[i]:r=>(r.get("defaultState").event.preventDefault(),n.action(this.host))})})})},(this.host=e).addController(this)}get _std(){return this.host.std}hostConnected(){this._reset()}hostDisconnected(){this._reset()}}var Ese=Object.defineProperty,Sse=Object.getOwnPropertyDescriptor,Tse=(t,e,n,i)=>{for(var r=i>1?void 0:i?Sse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ese(e,n,r),r};let b5=class extends wn{constructor(){super(...arguments),this.keymapController=new kse(this),this._dragHandleOption={flavour:S1.model.flavour,edgeless:!0,onDragStart:({state:t,startDragging:e,anchorBlockPath:n})=>{if(!n||!!!jn(t.raw.target)?.closest(wr))return!1;const o=this.std.view.viewFromPath("block",n);if(!o||!Ie(o.model,[S1.model.flavour]))return!1;const s=o,a=s.closest(".edgeless-block-portal-note");D(a);const l=a.cloneNode();l.style.transform="",l.style.left="0",l.style.top="0";const c=a.querySelector(".note-background");D(c);const d=c.cloneNode();l.appendChild(d);const u=document.createElement("div");return u.style.width="100%",u.style.height="100%",u.style.overflow="hidden",l.appendChild(u),Qa(s.host.renderModel(s.model),u),e([s],t,l),!0},onDragEnd:({draggingElements:t,dropBlockId:e,dropType:n})=>{if(t.length!==1||!Ie(t[0].model,[S1.model.flavour]))return!1;if(n==="in")return!0;const i=t[0].model,r=this.page.getBlockById(e),o=this.page.getParent(e);return!r||!o||(this.page.moveBlocks(i.children,o,r,n==="before"),this.page.deleteBlock(i)),!0}}}connectedCallback(){super.connectedCallback(),this.setAttribute(Qp.rangeSyncExcludeAttr,"true"),this.keymapController.bind(),this.disposables.add(ri.registerOption(this._dragHandleOption))}renderBlock(){return b`
      <div class="affine-note-block-container">
        <div class="affine-block-children-container">
          ${this.renderModelChildren(this.model)}
        </div>
      </div>
    `}};b5.styles=X`
    .affine-note-block-container {
      display: flow-root;
      position: relative;
    }
    .affine-note-block-container.selected {
      background-color: var(--affine-hover-color);
    }
  `;b5=Tse([W("affine-note")],b5);const Ise=(t,e)=>{const{focusBlock:n,std:i}=t;if(!n)return;const{selection:r}=i;return r.setGroup("note",[r.create("block",{path:n.path})]),e()},Lse=(t,e)=>{const{focusBlock:n,anchorBlock:i,tail:r}=t;if(!n||!i)return;const o=t.std.selection;if(gt.equals(i.path,n.path)){const c=n.path;return o.setGroup("note",[o.create("block",{path:c})]),e()}const s=[...o.value];s.every(c=>!gt.equals(c.path,n.path))&&(r?s.push(o.create("block",{path:n.path})):s.unshift(o.create("block",{path:n.path})));let a=!1;const l=s.filter(c=>gt.equals(c.path,i.path)||gt.equals(c.path,n.path)?(a=!a,!0):a);return o.setGroup("note",l),e()};class BP extends li{mounted(){super.mounted(),this.std.command.add("selectBlocksBetween",Lse).add("selectBlock",Ise)}}var Mse=Object.defineProperty,Pse=Object.getOwnPropertyDescriptor,K3=(t,e,n,i)=>{for(var r=i>1?void 0:i?Pse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Mse(e,n,r),r};let yd=class extends me(De){connectedCallback(){super.connectedCallback()}firstUpdated(){this.disposables.add(this.model.propsUpdated.on(()=>this.requestUpdate()))}updated(){setTimeout(()=>{const t=Array.from(this.querySelectorAll("[contenteditable]")),e=Array.from(this.querySelectorAll("[data-block-id]"));t.forEach(n=>{n.contentEditable==="true"&&(n.contentEditable="false")}),e.forEach(n=>{n.setAttribute(Qp.rangeQueryExcludeAttr,"true")})},500)}render(){const{model:t,index:e}=this,{displayMode:n}=t;if(n&&n===qe.DocOnly)return ae;const{xywh:i,background:r}=t,[o,s,a,l]=Wn(i),c={zIndex:`${e}`,width:a+"px",height:l+"px",transform:`translate(${o}px, ${s}px)`,padding:`${n2}px`,border:`${sO}px solid var(--affine-black-10)`,background:`var(${r??_3})`,boxShadow:"var(--affine-shadow-3)",position:"absolute",borderRadius:"8px",boxSizing:"border-box",pointerEvents:"none",overflow:"hidden",transformOrigin:"0 0",userSelect:"none"};return Be`
      <div
        class="surface-ref-note-portal"
        style=${we(c)}
        data-model-height="${l}"
        data-portal-reference-block-id="${t.id}"
      >
        ${this.renderModel(t)}
      </div>
    `}};yd.styles=X`
    surface-ref-note-portal {
      position: relative;
    }
  `;K3([L({attribute:!1})],yd.prototype,"index",2);K3([L({attribute:!1})],yd.prototype,"model",2);K3([L({attribute:!1})],yd.prototype,"renderModel",2);yd=K3([W("surface-ref-note-portal")],yd);var Ase=Object.defineProperty,$se=Object.getOwnPropertyDescriptor,Nc=(t,e,n,i)=>{for(var r=i>1?void 0:i?$se(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ase(e,n,r),r};const Bse={"affine:note":"surface-ref-note-portal","affine:image":"surface-ref-image-portal"};let Ns=class extends me(De){constructor(){super(...arguments),this.setViewport=t=>{this.requestUpdate(),this.updateComplete.then(()=>{this.portal?.style.setProperty("transform",`translate(${t.translateX}px, ${t.translateY}px) scale(${t.zoom})`),this.portal?.style.setProperty("transform-origin","0 0"),this.canvasSlot?.style.setProperty("--stacking-canvas-transform",`scale(${1/t.zoom}) translate(${-t.translateX}px, ${-t.translateY}px)`)}).catch(console.error)}}get surfaceService(){return this.host.std.spec.getService("affine:surface")}setStackingCanvas(t){this.canvasSlot&&this.canvasSlot.replaceChildren(...t)}_getBlocksInFrame(t){const e=t.elementBound;return this.surfaceService.layer.blocksGrid.search(e)}_getBlocksInGroup(t){return Array.from(t.childIds).map(e=>this.page.getBlockById(e)).filter(e=>e)}_renderEdgelessBlocks(){const t=this.refModel,e="flavour"in t?this._getBlocksInFrame(t):this._getBlocksInGroup(t),n=this.surfaceService.layer.layers.filter(o=>o.type==="block");let i=0,r=0;return Fe(e,o=>o.id,(o,s)=>{const a=st`${zn(Bse[o.flavour])}`;let l=n[i];if(!n[i].set.has(o)){for(;!l.set.has(o);)l=n[++i];r=0}const c=l.zIndexes[0]+r++;return Be`<${a}
          .index=${s}
          .model=${o}
          .page=${this.page}
          .host=${this.host}
          .renderModel=${this.renderModel}
          style=${we({"z-index":c})}
        ></${a}>`})}render(){return b`<div class="surface-blocks-portal">
      <div class="stacking-canvas"></div>
      ${this._renderEdgelessBlocks()}
    </div>`}};Ns.styles=X`
    .surface-blocks-portal {
      pointer-events: none;
      position: absolute;
      left: 0;
      top: 0;
      transform-origin: 0 0;
    }
    .stacking-canvas {
      position: absolute;
      left: 0;
      top: 0;
    }

    .stacking-canvas > canvas {
      transform: var(--stacking-canvas-transform);
      transform-origin: 0 0;
      position: absolute;
      left: 0;
      top: 0;
    }
  `;Nc([L({attribute:!1})],Ns.prototype,"host",2);Nc([L({attribute:!1})],Ns.prototype,"page",2);Nc([L({attribute:!1})],Ns.prototype,"refModel",2);Nc([L({attribute:!1})],Ns.prototype,"renderModel",2);Nc([he(".surface-blocks-portal")],Ns.prototype,"portal",2);Nc([he(".stacking-canvas")],Ns.prototype,"canvasSlot",2);Ns=Nc([W("surface-ref-portal")],Ns);function K_(t){return t.getBlockByFlavour("affine:surface")[0]??null}const Dse=b`
  <svg
    width="182"
    height="182"
    viewBox="0 0 182 182"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <rect
      x="37.645"
      y="37.6452"
      width="106.71"
      height="106.71"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M91 144.234L37.7664 91.0003L91 37.7666L144.234 91.0003L91 144.234Z"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M90.564 37.352C99.4686 32.1345 109.836 29.1436 120.902 29.1436C154.093 29.1436 181 56.0502 181 89.2413C181 113.999 166.03 135.259 144.648 144.466"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M144.465 90.707C149.683 99.6117 152.674 109.979 152.674 121.045C152.674 154.236 125.767 181.143 92.5759 181.143C67.8187 181.143 46.5579 166.173 37.3516 144.791"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M91.436 144.465C82.5314 149.683 72.1639 152.674 61.0978 152.674C27.9068 152.674 1.0001 125.767 1.0001 92.576C1.00011 67.8188 15.9701 46.558 37.3519 37.3518"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M37.3518 91.436C32.1342 82.5314 29.1433 72.1639 29.1433 61.0978C29.1433 27.9067 56.05 1.00002 89.241 1.00001C113.998 1.00001 135.259 15.97 144.465 37.3518"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M37.3518 37.3521L144.648 144.649"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path
      d="M144.648 37.3521L37.3518 144.649"
      stroke="#D2D2D2"
      stroke-width="0.586319"
    />
    <path d="M91 37.3521V144.649" stroke="#D2D2D2" stroke-width="0.586319" />
    <path d="M144.648 91L37.3518 91" stroke="#D2D2D2" stroke-width="0.586319" />
    <ellipse cx="144.355" cy="37.645" rx="4.39739" ry="4.3974" fill="#5B5B5B" />
    <ellipse
      cx="144.355"
      cy="144.355"
      rx="4.39739"
      ry="4.3974"
      fill="#5B5B5B"
    />
    <ellipse
      cx="144.355"
      cy="90.9999"
      rx="4.39739"
      ry="4.3974"
      fill="#5B5B5B"
    />
    <ellipse cx="37.645" cy="37.645" rx="4.39739" ry="4.3974" fill="#5B5B5B" />
    <ellipse cx="37.645" cy="144.355" rx="4.39739" ry="4.3974" fill="#5B5B5B" />
    <ellipse cx="37.645" cy="90.9999" rx="4.39739" ry="4.3974" fill="#5B5B5B" />
    <ellipse
      cx="90.9999"
      cy="37.6451"
      rx="4.3974"
      ry="4.39739"
      transform="rotate(-90 90.9999 37.6451)"
      fill="#5B5B5B"
    />
    <ellipse
      cx="90.9999"
      cy="90.4136"
      rx="4.3974"
      ry="4.39739"
      transform="rotate(-90 90.9999 90.4136)"
      fill="#5B5B5B"
    />
    <ellipse
      cx="90.9999"
      cy="144.356"
      rx="4.3974"
      ry="4.39739"
      transform="rotate(-90 90.9999 144.356)"
      fill="#5B5B5B"
    />
  </svg>
`;var Ose=Object.defineProperty,Rse=Object.getOwnPropertyDescriptor,Hc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Rse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ose(e,n,r),r};const Q_={"affine:frame":Lc,DEFAULT_NOTE_HEIGHT:F9},J_={"affine:frame":"Frame",group:"Group",DEFAULT:"Content"},eC={group:"This content was ungrouped or deleted on edgeless mode",DEFAULT:"This content was deleted on edgeless mode"};let Bo=class extends wn{constructor(){super(...arguments),this._surfaceModel=null,this._focused=!1,this._caption="",this._showCaption=!1,this._referencedModel=null}get _shouldRender(){return this.isConnected&&this.parentElement&&!this.parentBlockElement.closest("affine-surface-ref")}get surfaceRenderer(){return this._surfaceRefRenderer.surfaceRenderer}get referenceModel(){return this._referencedModel}connectedCallback(){if(super.connectedCallback(),!this._shouldRender)return;const t=this.service;D(t,"Surface ref block must run with its service."),this._surfaceRefRenderer=t.getRenderer(gt.id(this.path),this.page,!0),this._disposables.add(this._surfaceRefRenderer.slots.surfaceModelChanged.on(e=>{this._surfaceModel=e})),this._disposables.add(this._surfaceRefRenderer.slots.surfaceRendererRefresh.on(()=>{this.requestUpdate()})),this._disposables.add(this._surfaceRefRenderer.slots.surfaceRendererInit.on(()=>{let e=0;const n=new ResizeObserver(i=>{i[0].contentRect.width!==e&&(e=i[0].contentRect.width,this._refreshViewport())});n.observe(this),this._disposables.add(()=>n.disconnect())})),this._disposables.add(this._surfaceRefRenderer.surfaceService.layer.slots.layerUpdated.on(()=>{this.portal.setStackingCanvas(this._surfaceRefRenderer.surfaceRenderer.stackingCanvas)})),this._surfaceRefRenderer.mount(),this._initHotkey(),this._initReferencedModel(),this._initSelection()}disconnectedCallback(){this._shouldRender&&(this.service?.removeRenderer(this._surfaceRefRenderer.id),super.disconnectedCallback())}updated(){this._shouldRender&&this._attachRenderer()}_attachRenderer(){this._surfaceRefRenderer?.surfaceRenderer.canvas.isConnected||!this.container||!this.portal||(this.surfaceRenderer.attach(this.container),this.portal.isUpdatePending?this.portal.updateComplete.then(()=>{this.portal.setStackingCanvas(this._surfaceRefRenderer.surfaceRenderer.stackingCanvas)}).catch(console.error):this.portal.setStackingCanvas(this._surfaceRefRenderer.surfaceRenderer.stackingCanvas))}_initHotkey(){const t=this.host.selection,e=()=>{if(!this.page.getParent(this.model))return;const[n]=this.page.addSiblingBlocks(this.model,[{flavour:"affine:paragraph"}]),i=qn(this.page.getBlockById(n));Eo(()=>{t.update(r=>r.filter(o=>!o.is("block")).concat(t.create("text",{from:{path:i,index:0,length:0},to:null})))},this)};this.bindHotKey({Enter:()=>{if(this._focused)return e(),!0}})}_initReferencedModel(){let t=null;const e=()=>{t?.dispose();const n=this._surfaceRefRenderer.getModel(this.model.reference);this._referencedModel=n&&"xywh"in n?n:null,n&&("propsUpdated"in n&&(t=n.propsUpdated.on(()=>{n.flavour!==this.model.refFlavour&&this.page.updateBlock(this.model,{refFlavour:n.flavour}),this.updateComplete.then(()=>{this._refreshViewport()}).catch(console.error)})),this._refreshViewport())};e(),this._disposables.add(()=>{this.page.slots.blockUpdated.on(({type:n,id:i})=>{n==="delete"&&i===this.model.reference&&e()})}),this._disposables.add(()=>{this.model.propsUpdated.on(()=>{this._caption=this.model.caption??"",this.model.reference!==this._referencedModel?.id&&e()})}),this._disposables.add(()=>{t?.dispose()})}_initSelection(){const t=this.host.selection;this._disposables.add(t.slots.changed.on(e=>{this._focused=e.some(n=>gt.equals(n.path,this.path)&&n.is("block"))}))}_refreshViewport(){if(!this._referencedModel)return;const t=this._referencedModel;this.requestUpdate(),this.updateComplete.then(()=>{this.surfaceRenderer.onResize(),this.surfaceRenderer.setViewportByBound(ne.fromXYWH(Wn(t.xywh))),this.portal?.setViewport(this.surfaceRenderer)}).catch(console.error)}_deleteThis(){this.page.deleteBlock(this.model)}_focusBlock(){this.selection.update(()=>[this.selection.create("block",{path:this.path})])}_updateCaption(){this.page.updateBlock(this.model,{caption:this._caption})}_onCaptionKeydown(t){t.isComposing||t.key==="Enter"&&(t.stopPropagation(),this._updateCaption())}_onCaptionBlur(){this._updateCaption(),!this._caption.length&&this._showCaption&&(this._showCaption=!1)}_renderCaption(){return!this._caption&&!this._showCaption?ae:b`<div class="surface-ref-caption">
      <input
        .value=${this._caption}
        .disabled=${this.model.page.readonly}
        placeholder="Write a caption"
        class="caption-input"
        @input=${t=>this._caption=t.target.value}
        @keydown=${this._onCaptionKeydown}
        @blur=${this._onCaptionBlur}
        @pointerdown=${at}
        @click=${at}
        @paste=${at}
        @cut=${at}
        @copy=${at}
      />
    </div>`}showCaption(){this._showCaption=!0,this.updateComplete.then(()=>{this.renderRoot.querySelector(".caption-input")?.focus()}).catch(console.error)}viewInEdgeless(){if(!this._referencedModel)return;const t=uO(this.host);if(t.mode!=="edgeless"){t.mode="edgeless";const e={xywh:"",referenceId:this.model.reference,padding:[60,20,20,20]};this.std.spec.getService("affine:page").editSession.setItem("viewport",e)}this.selection.update(e=>e.filter(n=>!gt.equals(n.path,this.path)))}_renderMask(t,e){const n="title"in t?t.title:"";return b`
      <div class="surface-ref-mask">
        <div class="ref-label">
          <div class="title">
            ${Q_[e??"DEFAULT"]??Q_.DEFAULT}
            <span>${n}</span>
          </div>
          <div class="suffix">from edgeless mode</div>
        </div>
      </div>
    `}_renderRefPlaceholder(t){return b`<div class="ref-placeholder">
      <div class="placeholder-image">${Dse}</div>
      <div class="placeholder-text">
        No Such
        ${J_[t.refFlavour??"DEFAULT"]??J_.DEFAULT}
      </div>
      <div class="placeholder-action">
        <button class="delete-button" type="button" @click=${this._deleteThis}>
          <span class="icon">${h3}</span
          ><span>Delete this block</span>
        </button>
      </div>
      <div class="placeholder-reason">
        ${eC[t.refFlavour??"DEFAULT"]??eC.DEFAULT}
      </div>
    </div>`}_renderRefContent(t,e){const[,,n,i]=Wn(t.xywh),{zoom:r}=e,{gap:o}=$b(r,!0),s="flavour"in t?t.flavour:t.type,a=s==="affine:frame"||s==="group"?b`<surface-ref-portal
            .page=${this.page}
            .host=${this.host}
            .refModel=${t}
            .renderModel=${this.renderModel}
          ></surface-ref-portal>`:ae;return b`<div
      class="ref-content"
      style=${we({backgroundSize:`${o}px ${o}px`})}
    >
      <div
        class="ref-viewport ${s==="affine:frame"?"frame":""}"
        style=${we({width:`${n}px`,aspectRatio:`${n} / ${i}`})}
      >
        ${a}
        <div class="ref-canvas-container">
          <!-- attach canvas here -->
        </div>
      </div>
      ${this._renderMask(t,s)}
    </div>`}render(){if(!this._shouldRender)return;const{_surfaceModel:t,_referencedModel:e,surfaceRenderer:n,model:i}=this,o=!t||!e||!e.xywh?this._renderRefPlaceholder(i):this._renderRefContent(e,n);return b`
      <div
        class="affine-surface-ref"
        @click=${this._focusBlock}
        style=${we({outline:this._focused?"2px solid var(--affine-primary-color)":void 0})}
      >
        ${o} ${this._renderCaption()}
      </div>
      ${Object.values(this.widgets)}
    `}};Bo.styles=X`
    .affine-surface-ref {
      position: relative;
      user-select: none;
      margin: 10px 0;
    }

    .ref-placeholder {
      padding: 26px 0px 0px;
    }

    .placeholder-image {
      margin: 0 auto;
      text-align: center;
    }

    .placeholder-text {
      margin: 12px auto 0;
      text-align: center;
      font-size: 28px;
      font-weight: 600;
      line-height: 36px;
      font-family: var(--affine-font-family);
    }

    .placeholder-action {
      margin: 32px auto 0;
      text-align: center;
    }

    .delete-button {
      width: 204px;
      padding: 4px 18px;

      display: inline-flex;
      justify-content: center;
      align-items: center;
      gap: 4px;

      border-radius: 8px;
      border: 1px solid var(--affine-border-color);

      font-family: var(--affine-font-family);
      font-size: 12px;
      font-weight: 500;
      line-height: 20px;

      background-color: transparent;
      cursor: pointer;
    }

    .delete-button > .icon > svg {
      color: var(--affine-icon-color);
      width: 16px;
      height: 16px;
      display: block;
    }

    .placeholder-reason {
      margin: 72px auto 0;
      padding: 10px;

      text-align: center;
      font-size: 12px;
      font-family: var(--affine-font-family);
      line-height: 20px;

      color: var(--affine-warning-color);
      background-color: var(--affine-background-error-color);
    }

    .ref-content {
      position: relative;
      padding: 20px;
      background-color: var(--affine-background-primary-color);
      background: radial-gradient(
        var(--affine-edgeless-grid-color) 1px,
        var(--affine-background-primary-color) 1px
      );
    }

    .ref-viewport {
      max-width: 100%;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      pointer-events: none;
      user-select: none;
    }

    .ref-viewport.frame {
      border-radius: 2px;
      border: 1px solid var(--affine-black-30);
    }

    .ref-canvas-container {
      height: 100%;
      width: 100%;
      position: relative;
    }

    .surface-ref-mask {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }

    .surface-ref-mask:hover {
      background-color: rgba(211, 211, 211, 0.1);
    }

    .surface-ref-mask:hover .ref-label {
      display: block;
    }

    .ref-label {
      display: none;
      user-select: none;
    }

    .ref-label {
      position: absolute;
      left: 0;
      bottom: 0;

      width: 100%;
      padding: 8px 16px;
      border: 1px solid var(--affine-border-color);
      gap: 14px;

      background: var(--affine-background-primary-color);

      font-size: 12px;

      user-select: none;
    }

    .ref-label .title {
      display: inline-block;
      font-weight: 600;
      font-family: var(--affine-font-family);
      line-height: 20px;

      color: var(--affine-text-secondary-color);
    }

    .ref-label .title > svg {
      color: var(--affine-icon-secondary);
      display: inline-block;
      vertical-align: baseline;
      width: 20px;
      height: 20px;
      vertical-align: bottom;
    }

    .ref-label .suffix {
      display: inline-block;
      font-weight: 400;
      color: var(--affine-text-disable-color);
      line-height: 20px;
    }

    .surface-ref-caption {
      margin-top: 10px;
      text-align: center;
    }

    .caption-input {
      border: 0;
      outline: none;
      width: 100%;
      display: block;
      text-align: center;

      font-size: var(--affine-font-sm);
      color: var(--affine-icon-color);
      background-color: transparent;
    }

    .caption-input::placeholder {
      color: var(--affine-placeholder-color);
    }
  `;Hc([ie()],Bo.prototype,"_surfaceModel",2);Hc([ie()],Bo.prototype,"_focused",2);Hc([ie()],Bo.prototype,"_caption",2);Hc([ie()],Bo.prototype,"_showCaption",2);Hc([he(".ref-canvas-container")],Bo.prototype,"container",2);Hc([he("surface-ref-portal")],Bo.prototype,"portal",2);Bo=Hc([W("affine-surface-ref")],Bo);var Nse=Object.defineProperty,Hse=Object.getOwnPropertyDescriptor,Fse=(t,e,n,i)=>{for(var r=i>1?void 0:i?Hse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Nse(e,n,r),r};let F8=class extends wn{render(){return ae}};F8=Fse([W("affine-edgeless-surface-ref")],F8);const Q3=_i({flavour:"affine:surface-ref",props:()=>({reference:"",caption:""}),metadata:{version:1,role:"content",parent:["affine:note"]}});class Use{constructor(e,n,i,r={enableStackingCanvas:!1}){this.id=e,this.page=n,this.std=i,this._surfaceModel=null,this._disposables=new dt,this.slots={surfaceRendererInit:new Ve,surfaceRendererRefresh:new Ve,surfaceModelChanged:new Ve,mounted:new Ve,unmounted:new Ve};const o=new cu,s=new ET({layerManager:this.surfaceService.layer,enableStackingCanvas:r.enableStackingCanvas,provider:{getVariableColor:a=>o.getVariableValue(a)}});o.observe(document.documentElement),this._surfaceRenderer=s,this.slots.unmounted.once(()=>{o.dispose()})}get surfaceService(){return this.std.spec.getService("affine:surface")}get surfaceRenderer(){return this._surfaceRenderer}get surfaceModel(){return this._surfaceModel}mount(){this._disposables.disposed&&(this._disposables=new dt),this._initSurfaceModel(),this._initSurfaceRenderer(),this.slots.mounted.emit()}unmount(){this._disposables.dispose(),this.slots.unmounted.emit()}getModel(e){return this.page.getBlockById(e)??this._surfaceModel?.getElementById(e)??null}_initSurfaceRenderer(){this.slots.surfaceRendererInit.emit()}_initSurfaceModel(){const e=()=>{const n=K_(this.page);this._surfaceModel=n,this.slots.surfaceModelChanged.emit(n),this._surfaceModel};e(),this._surfaceModel||this._disposables.add(this.page.slots.blockUpdated.on(({type:n})=>{n==="add"&&!this._surfaceModel&&K_(this.page)&&e()}))}}class pv extends li{constructor(){super(...arguments),this._rendererMap=new Map}getRenderer(e,n=this.page,i=!1){if(this._rendererMap.has(e))return this._rendererMap.get(e);const r=new Use(e,n,this.std,{enableStackingCanvas:i});return this._rendererMap.set(e,r),r}removeRenderer(e){const n=this._rendererMap.get(e);n&&(n.unmount(),this._rendererMap.delete(e))}}const tC=async(t,e)=>{const{edgelessElement:n,blockContainer:i}=e,o=t.spec.getService("affine:page").exportManager,s=ne.deserialize(n.xywh),a=Xr(n);return o.edgelessToCanvas(e.surfaceRenderer,s,l=>i.querySelector(`[data-portal-reference-block-id="${l.id}"]`),void 0,a?[n]:void 0,a?void 0:[n],{zoom:e.surfaceRenderer.zoom}).then(l=>(D(l),new Promise((c,d)=>{l.toBlob(u=>u?c(u):d(null),"image/png")})))},Vse=async t=>{window.apis?.clipboard?.copyAsImageFromString?await window.apis.clipboard?.copyAsImageFromString(t):await navigator.clipboard.write([new ClipboardItem({[t.type]:t})])};var zse=Object.defineProperty,jse=Object.getOwnPropertyDescriptor,Gse=(t,e,n,i)=>{for(var r=i>1?void 0:i?jse(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&zse(e,n,r),r};const Zse="affine-surface-ref-toolbar";let U8=class extends to{constructor(){super(...arguments),this._hoverController=new Xn(this,({abortController:t})=>{const e=this.blockElement,n=this.host.selection,i=n.find("text");if(i&&(i.to||i.from.length))return null;const r=n.filter("block");return r.length>1||r.length===1&&r[0].path!==e.path?null:{template:Wse({blockElement:this.blockElement,model:this.blockElement.model,abortController:t}),computePosition:{referenceElement:this.blockElement,placement:"top-start",middleware:[Dt({mainAxis:12,crossAxis:10}),tr({crossAxis:!0,padding:{top:B2+12,bottom:12,right:12}})],autoUpdate:!0}}})}connectedCallback(){super.connectedCallback(),this._hoverController.setReference(this.blockElement)}};U8=Gse([W(Zse)],U8);function Wse(t){const{blockElement:e,model:n,abortController:i}=t,r=n.page.readonly,o=!!e.referenceModel;return b`
    <style>
      :host {
        z-index: 1;
      }
      .surface-ref-toolbar-container {
        display: flex;
        box-sizing: border-box;
        box-shadow: var(--affine-shadow-2);
        border-radius: 8px;
        list-style: none;
        padding: 4px 8px;
        gap: 4px;
        align-items: center;
        background-color: var(--affine-background-overlay-panel-color);
        margin: 0;
      }
      .delete-button:hover {
        background: var(--affine-background-error-color);
        color: var(--affine-error-color);
      }
      .delete-button:hover > svg {
        color: var(--affine-error-color);
      }

      .divider {
        width: 1px;
        height: 24px;
        background-color: var(--affine-border-color);
        margin: 0 8px;
      }

      .view-in-edgeless-button {
        font-size: 12px;
        color: var(--affine-text-secondary-color);
        font-weight: 600;
        gap: 2px;
      }
    </style>

    <div class="surface-ref-toolbar-container">
      <icon-button
        ?hidden=${!o||r}
        class="view-in-edgeless-button"
        text="View in Edgeless"
        width="fit-content"
        @click=${()=>e.viewInEdgeless()}
        >${F9}
      </icon-button>
      <div
        class="divider"
        ?hidden=${r}
        style=${we({display:o?void 0:"none"})}
      ></div>
      <icon-button
        size="32px"
        ?hidden=${r}
        @click=${()=>{e.showCaption()}}
      >
        ${Kd}
        <affine-tooltip tip-position="top">Caption</affine-tooltip>
      </icon-button>
      <icon-button
        size="32px"
        ?hidden=${!o}
        @click=${()=>{const s=e.referenceModel;s&&tC(e.host,{surfaceRefBlock:e,surfaceRenderer:e.surfaceRenderer,edgelessElement:s,blockContainer:e.portal}).then(a=>{const l="title"in s?s.title?.toString()??"Edgeless Content":"Edgeless Content";jm(a,l)}).catch(a=>{console.error(a)})}}
      >
        ${g3}
        <affine-tooltip tip-position="top">Download</affine-tooltip>
      </icon-button>
      <icon-button
        size="32px"
        ?hidden=${!o}
        @click=${()=>{tC(e.host,{surfaceRefBlock:e,surfaceRenderer:e.surfaceRenderer,edgelessElement:e.referenceModel,blockContainer:e.portal}).then(s=>Vse(s)).then(()=>{kt(e.host,"Copied image to clipboard")}).catch(s=>{console.error(s)})}}
      >
        ${Tr}
        <affine-tooltip tip-position="top">Copy to clipboard</affine-tooltip>
      </icon-button>
      <icon-button
        class="delete-button"
        size="32px"
        ?hidden=${r}
        @click="${()=>{n.page.deleteBlock(n),i.abort()}}"
      >
        ${xn}
        <affine-tooltip tip-position="top">Delete</affine-tooltip>
      </icon-button>
    </div>
  `}const V8="npm/shiki@0.14.1/themes/dark-plus",z8="npm/shiki@0.14.1/themes/light-plus",vp="Plain Text",L1={id:vp,displayName:vp,scopeName:"source.plaintext",path:"PLEASE-DO-NOT-USE-THIS",aliases:["plaintext","txt","text"]},qse=["python","c","java","cpp","csharp","vb","javascript","php","sql","asm","pascal","go","swift","matlab","r","rust","ruby","sas","ada","perl","objective-c","cobol","lisp","dart","lua","julia","d","kotlin","logo","scala","haskell","fsharp","scheme","typescript","groovy","abap","prolog","plsql","bash","apex","markdown","json","html","css","diff","jsx","tsx","vue"],Yse=qse.reduce((t,e,n)=>({[e]:n,...t}),{});function nC(t,e=!1){return e?-1/0:Yse[t]??1/0}function Xse(t){return[L1.id,...L1.aliases].includes(t.toLowerCase())}const g2=(t,e=!1)=>{if(!t||Xse(t))return null;const n=Wl.find(r=>r.id.toLowerCase()===t.toLowerCase());return n||(e?null:Wl.find(r=>r.aliases?.includes(t.toLowerCase()))??null)};function v5(t,e){t.model.text?.insert(" ",e);const n=t.selection.find("text");t.selection.setGroup("note",[t.selection.create("text",{from:{path:t.path,index:(n?.from.index??0)+1,length:0},to:null})])}function Of(t,e,n,i){const{page:r,model:o}=t;if(Ie(o,["affine:list"]))return!1;if(Ie(o,["affine:paragraph"])){const s=r.getParent(o);if(!s)return!1;const a=s.children.indexOf(o);v5(t,n.length),r.captureSync(),o.text?.delete(0,n.length+1);const l={type:e,text:o.text?.clone(),children:o.children,...i};r.deleteBlock(o,{deleteChildren:!1});const c=r.addBlock("affine:list",l,s,a);$n(t.host,r,c)?.catch(console.error)}return!0}function Tl(t,e,n){const{page:i,model:r}=t;if(Ie(r,["affine:paragraph"])&&r.type===e)return!1;if(Ie(r,["affine:paragraph"])){if(Ie(r,["affine:paragraph"])&&r.type!==e){v5(t,n.length),i.captureSync(),r.text?.delete(0,n.length+1);const o=Ja(t.host,r);o&&o.setInlineRange({index:0,length:0}),i.updateBlock(r,{type:e})}}else{const o=i.getParent(r);if(!o)return!1;const s=o.children.indexOf(r);v5(t,n.length),i.captureSync(),r.text?.delete(0,n.length+1);const a={type:e,text:r.text?.clone(),children:r.children};i.deleteBlock(r,{deleteChildren:!1});const l=i.addBlock("affine:paragraph",a,o,s);$n(t.host,i,l)?.catch(console.error)}return!0}function Kse(t,e){const{page:n,model:i}=t;if(Ie(i,["affine:divider"])||Ie(i,["affine:paragraph"])&&i.type==="quote")return!1;if(!Ie(i,["affine:divider"])){const r=n.getParent(i);if(!r)return!1;const o=r.children.indexOf(i);v5(t,e.length),n.captureSync(),i.text?.delete(0,e.length+1);const s={children:i.children};n.addBlock("affine:divider",s,r,o);const a=r.children[o+1];if(a)$n(t.host,n,a.id)?.catch(console.error);else{const l=n.addBlock("affine:paragraph",{},r);$n(t.host,n,l)?.catch(console.error)}}return!0}function iC(t,e,n,i){const{model:r}=t;if(!n.match(/^(\d+\.|-|\*|\[ ?\]|\[x\]|(#){1,6}|(-){3}|(\*){3}|>|```([a-zA-Z0-9]*))$/))return Vn;const[,o]=e.getLine(i.index);if(o>n.length)return Vn;const s=Ie(r,["affine:paragraph"]),a=s&&r.type.startsWith("h"),l=s&&km(r.type,"quote"),c=Ie(r,["affine:code"]);if(a||l||c)return Vn;const d=n.match(/^```([a-zA-Z0-9]*)$/g);if(d){if(r.flavour==="affine:paragraph"&&r.type==="quote")return Vn;const h=r.page;h.captureSync();const p=h.getParent(r);D(p);const g=p.children.indexOf(r),f=h.addBlock("affine:code",{language:g2(d[0].slice(3))?.id??vp},p,g);if(r.text&&r.text.length>n.length){const m=r.text.clone();h.addBlock("affine:paragraph",{text:m},p,g+1),m.delete(0,n.length)}h.deleteBlock(r,{bringChildrenTo:p});const v=h.getBlockById(f);return D(v),Zd(t.host,v,{index:0,length:0}).catch(console.error),cn}let u=!1;switch(n.trim()){case"[]":case"[ ]":u=Of(t,"todo",n,{checked:!1});break;case"[x]":u=Of(t,"todo",n,{checked:!0});break;case"-":case"*":u=Of(t,"bulleted",n);break;case"***":case"---":u=Kse(t,n);break;case"#":u=Tl(t,"h1",n);break;case"##":u=Tl(t,"h2",n);break;case"###":u=Tl(t,"h3",n);break;case"####":u=Tl(t,"h4",n);break;case"#####":u=Tl(t,"h5",n);break;case"######":u=Tl(t,"h6",n);break;case">":u=Tl(t,"quote",n);break;default:u=Of(t,"numbered",n)}return u?cn:Vn}function DP(t){return!(Ie(t,["affine:image","affine:divider","affine:code"])||Ie(t,["affine:paragraph"])&&["h1","h2","h3","h4","h5","h6","quote"].includes(t.type??""))}function G6(t,e){const n=e.page,i=n.getParent(e),r=n.getNextSibling(e);if(!i)return;const o=()=>Ie(e,["affine:list"])?[e.flavour,{type:e.type}]:["affine:paragraph",{type:"text"}],[s,a]=o();if(Hg(n,e,"affine:database")){n.captureSync();const u=i.children.findIndex(v=>v.id===e.id);let h=i,p=u+1;const g=i.children.length;if(u===g-1&&e.text?.yText.length===0){g!==1&&n.deleteBlock(e);const v=n.getNextSibling(h);if(v&&Ie(v,["affine:paragraph"])){$n(t,n,v.id,{index:v.text.yText.length,length:0})?.catch(console.error);return}const m=n.getParent(i);if(!m)return;const y=m.children.findIndex(x=>x.id===i.id);h=m,p=y+1}const f=n.addBlock(s,a,h,p);$n(t,n,f)?.catch(console.error);return}const l=i.children.indexOf(e);if(l===-1)return;n.captureSync();const c=n.addBlock(s,a,i,l+1),d=n.getBlockById(c);if(D(d),n.moveBlocks(e.children,d),Ie(e,["affine:list"])&&e.type==="numbered"){let u=r;for(;u&&Ie(u,["affine:list"])&&e.type==="numbered";)n.updateBlock(u,{}),u=n.getNextSibling(u)}$n(t,n,c)?.catch(console.error)}function Qse(t,e,n,i){if(!(e.text instanceof Oi)||e.text.yText.length<n+i)return;const r=e.page,o=r.getParent(e);if(!o)return;r.captureSync();const s=e.text.split(n,i),a=o,l=a.children.indexOf(e)+1,c=[...e.children];r.updateBlock(e,{children:[]});const d=r.addBlock(e.flavour,{text:s,type:e.type,children:c},a,l);return $n(t,r,d)}function OP(t,e,n=0){const i=e.page,r=i.getPreviousSibling(e);if(!r||!DP(r))return;const o=i.getNextSiblings(e);i.captureSync(),i.moveBlocks([e],r),Ie(e,["affine:list"])&&e.type==="numbered"&&i.updateBlock(e,{}),o.filter(s=>Ie(s,["affine:list"])&&s.type==="numbered").forEach(s=>{i.updateBlock(s,{})}),Ie(r,["affine:list"])&&r.collapsed&&i.updateBlock(r,{collapsed:!1}),Zd(t,e,{index:n,length:0}).catch(console.error)}function Jse(t,e){if(!e.length)return;const n=e[0].page;let i=-1,r=null;for(let s=0;s<e.length;s++)if(r=n.getPreviousSibling(e[s]),r&&DP(r)){i=s;break}if(i===-1)return;n.captureSync();const o=e.slice(i);o.forEach(s=>{const a=n.getParent(s);D(a),o.includes(a)||OP(t,s)})}function B0(t,e,n=0){const i=e.page,r=i.getParent(e);if(!r||r.role!=="content")return;const o=i.getParent(r);if(!o)return;i.captureSync();const s=i.getNextSiblings(e),a=i.getNextSiblings(r);i.moveBlocks(s,e),i.moveBlocks([e],o,r,!1),Ie(e,["affine:list"])&&e.type==="numbered"&&i.updateBlock(e,{}),e.children.forEach(l=>{Ie(l,["affine:list"])&&l.type==="numbered"&&i.updateBlock(l,{})}),a.filter(l=>Ie(l,["affine:list"])&&l.type==="numbered").forEach(l=>{i.updateBlock(l,{})}),Zd(t,e,{index:n,length:0}).catch(console.error)}function eae(t,e){if(!e.length)return;const n=e[0].page;let i=-1,r;for(let s=0;s<e.length;s++)if(r=n.getParent(e[s]),r&&!Ie(r,["affine:note"])){i=s;break}const o=e.slice(i);for(let s=o.length-1;s>=0;s--){const a=o[s],l=n.getParent(a);D(l),o.includes(l)||B0(t,a)}}function RP(t,e,n=0){const i=e.page;let r=i.getParent(e);for(;r&&!Ie(r,["affine:note"]);)B0(t,e,n),r=i.getParent(e)}function tae(t,e){if(!e.length)return;const n=e[0].page;for(let i=e.length-1;i>=0;i--){const r=e[i],o=n.getParent(r);D(o),Ie(o,["affine:note"])||RP(t,r)}}function nae(t){return!!Ie(t,["affine:code"])}function iae(t){const e=t.page;return!!Hg(e,t,"affine:database")}function rae(t,e){const n=e.page;if(!Ie(e,["affine:list"]))return!1;const i=n.getParent(e);if(!i)return!1;const r=n.getNextSiblings(e),o=i.children.indexOf(e),s={type:"text",text:e.text?.clone(),children:e.children};n.captureSync(),n.deleteBlock(e,{deleteChildren:!1}),r.filter(l=>Ie(l,["affine:list"])&&l.type==="numbered").forEach(l=>n.updateBlock(l,{}));const a=n.addBlock("affine:paragraph",s,i,o);return $n(t,n,a)?.catch(console.error),!0}function oae(t,e){if(!Ie(e,["affine:list"]))return!1;const n=e.page,i=e.firstChild();if(i){e.text?.join(i.text);const r=i.children;return r?(n.moveBlocks(r,e),n.deleteBlock(i),!0):(n.deleteBlock(i),!0)}else{const r=n.getNextSibling(e);if(r)if(e.text?.join(r.text),r.children){const o=n.getParent(r);return o?(n.moveBlocks(r.children,o,e,!1),n.deleteBlock(r),!0):!1}else return n.deleteBlock(r),!0;else{const o=D2(t,e);if(!o)return!0;if(e.text?.join(o.text),o.children){const s=n.getParent(o);return s?(n.moveBlocks(o.children,s,n.getParent(e),!1),n.deleteBlock(o),!0):!1}else return n.deleteBlock(o),!0}}}function sae(t,e,n,i){const r=e.page;if(!Ie(n,["affine:paragraph","affine:list"]))return!1;r.captureSync();const o=n.text?.length||0;return e.text?.length&&n.text?.join(e.text),r.deleteBlock(e,{bringChildrenTo:i}),Ja(t,n)?.setInlineRange({index:o,length:0}),!0}function aae(t,e,n,i){const r=e.page;return Ie(n,["affine:divider"])?(r.deleteBlock(n),!0):Ie(n,["affine:image","affine:code","affine:bookmark","affine:attachment","affine:surface-ref"])?(N2(t,n),e.text?.length||(r.captureSync(),r.deleteBlock(e,{bringChildrenTo:i})),!0):!1}function lae(t,e){const n=e.page,i=e.text;if(!Ok(t))return!1;const s=e.page.root.title;n.captureSync();let a=0;if(i&&(a=i.length,s.join(i)),n.getNextSibling(e)||e.children.length>0){const l=n.getParent(e);D(l),n.deleteBlock(e,{bringChildrenTo:l})}else i?.clear();return IO(t,s.length-a),!0}function cae(t,e){const n=e.page,i=n.getParent(e);if(!i)return!1;const r=dO(t,e);if(r){if(Ie(r,["affine:paragraph","affine:list"])){const o=i.children.indexOf(e);if((o===-1||o===i.children.length-1)&&i.role==="content")return!1;const s=r.text?.length??0;return r.text?.join(e.text),n.deleteBlock(e,{bringChildrenTo:i}),Zd(t,r,{index:s,length:0}).catch(console.error),!0}else if(Ie(r,["affine:attachment","affine:bookmark","affine:code","affine:image"])){n.deleteBlock(e,{bringChildrenTo:i});const o=T7(t,r);D(o);const s=t.selection.create("block",{path:o.path});return t.selection.setGroup("note",[s]),!0}}else return lae(t,e);return Ie(i,["affine:database"])?(n.deleteBlock(e),N2(t,r),!0):Ie(i,["affine:note"])?sae(t,e,r,i)||aae(t,e,r,i)||NP(r):!1}function dae(t,e){const n=e.page;return Ie(e,["affine:paragraph"])?e.type!=="text"?(n.captureSync(),n.updateBlock(e,{type:"text"}),!0):(cae(t,e)||B0(t,e),!0):!1}function uae(t,e){const n=e.page;function i(l,c,d,u){function h(f,v,m){if(m&&Ie(m,["affine:paragraph","affine:list"]))if(v.text?.join(m.text),m.children){const y=f.getParent(m);return y?(f.moveBlocks(m.children,y,v,!1),f.deleteBlock(m),!0):!1}else return f.deleteBlock(m),!0;else{const y=D2(t,v);if(!y||!Ie(y,["affine:paragraph","affine:list"]))return!1;if(v.text?.join(y.text),y.children){const x=f.getParent(y);return x?(f.moveBlocks(y.children,x,f.getParent(v),!1),f.deleteBlock(y),!0):!1}else return f.deleteBlock(y),!0}}function p(f,v,m){if(!m||!Ie(m,["affine:paragraph","affine:list"]))return!1;const y=m.children;return v.text?.join(m.text),y&&f.moveBlocks(y,v),f.deleteBlock(m),!0}const g=D2(t,c);return!u&&!g?!0:p(l,c,u)||h(l,c,d)}function r(l,c){function d(h){return!h||!Ie(h,["affine:image","affine:divider","affine:code"])?!1:(N2(t,h),!0)}function u(h){return Ie(h,["affine:divider"])?(n.deleteBlock(h),!0):!h||!Ie(h,["affine:image","affine:code"])?!1:(N2(t,h),!0)}return d(c)||u(l)}if(!Ie(e,["affine:paragraph"]))return!1;const o=n.getParent(e);if(!o)return!1;const s=n.getNextSibling(e),a=e.firstChild();return Ie(o,["affine:database"])?!1:i(n,e,s,a)||r(s,a)}function NP(t){throw new Error("Failed to handle backspace! Unknown block flavours! flavour:"+t.flavour)}function hae(t){throw new Error("Failed to handle forwarddelete! Unknown block flavours! flavour:"+t.flavour)}function HP(t,e){rae(t,e)||dae(t,e)||NP(e)}function pae(t,e){if(nae(e)||oae(t,e)||uae(t,e)){iae(e);return}hae(e)}const Rf=[{name:"parenthesis",left:"(",right:")"},{name:"square bracket",left:"[",right:"]"},{name:"curly bracket",left:"{",right:"}"},{name:"single quote",left:"'",right:"'"},{name:"double quote",left:'"',right:'"'},{name:"angle bracket",left:"<",right:">"},{name:"fullwidth single quote",left:"",right:""},{name:"fullwidth double quote",left:"",right:""},{name:"fullwidth parenthesis",left:"",right:""},{name:"fullwidth square bracket",left:"",right:""},{name:"fullwidth angle bracket",left:"",right:""},{name:"corner bracket",left:"",right:""},{name:"white corner bracket",left:"",right:""}];function fae(t){const e=t.getInlineRange();return e?.index===0&&e?.length===0}function gae(t){const e=t.getInlineRange();return e?.index===t.yText.length&&e?.length===0}function Z6(t,e){return e.insertText(t,`
`),e.setInlineRange({index:t.index+1,length:0}),cn}function rC(t,e,n,i,r,o=!1){const s=e.page;r.stopPropagation();const a=s.getParent(e),l=a?.lastChild()===e,c=Ie(e,["affine:list"])&&e.text.length===0;if(D(e.text,"Failed to hardEnter! model.text not exists!"),c&&a&&Ie(a,["affine:note","affine:database"])&&e.children.length===0)return HP(t,e),cn;if(c&&l)return B0(t,e,n.index),cn;const d=e.text.length===n.index,u=oC(e);if(d&&u){if(Ie(e,["affine:code"]))return o?(G6(t,e),cn):(Z6(n,i),cn);const p=e.text.toString(),g=p===`
`||p.endsWith(`
`);return u&&!g||o?(Z6(n,i),cn):(e.text.delete(n.index-1,1),G6(t,e),cn)}return d||o?(G6(t,e),cn):oC(e)?(Z6(n,i),cn):(Qse(t,e,n.index,n.length)?.catch(console.error),cn)}function oC(t){return Ie(t,["affine:code"])?!0:Ie(t,["affine:paragraph"])?t.type==="quote":!1}function mae(t,e,n,i){return fae(i)?e.flavour==="affine:code"?Vn:(n.stopPropagation(),HP(t,e),cn):(n.stopPropagation(),Vn)}function bae(t,e,n,i){return n.stopPropagation(),gae(i)?(pae(t,e),cn):Vn}const fv=t=>{const e=t.host.selection,n=t.model,i=t.host,r=i.std,o=r.command,s=Rf.map(v=>v.left),a=()=>(e.update(v=>v.map(m=>gt.equals(m.path,t.path)?e.create("block",{path:t.path}):m)),!0),l=v=>(e.update(m=>m.map(y=>gt.equals(y.path,t.path)?e.create("text",{from:{path:t.path,index:v?0:t.model.text?.length??0,length:0},to:null}):y)),!0),c=()=>{const v=t.querySelector(`[${ni}]`);if(!v)throw new Error("Inline editor root not found");return v.inlineEditor},d=v=>{const m=v.getInlineRange();D(m);const[y,x]=v.getTextPoint(m.index);return y.textContent?y.textContent.slice(0,x):""},u=v=>{v.get("defaultState").event.preventDefault()},h=()=>(e.update(v=>v.map(m=>gt.equals(m.path,t.path)?e.create("text",{from:{path:t.path,index:0,length:t.model.text?.length??0},to:null}):m)),!0);t.bindHotKey({Escape:()=>{if(t.selected?.is("text"))return a()},Enter:v=>{if(u(v),t.selected?.is("block"))return l(!1);const m=v.get("defaultState").event.target;if(!t.host.contains(m)||!t.selected?.is("text"))return;t.model.page.captureSync();const y=c(),x=y.getInlineRange();if(D(x),!iC(t,y,d(y),x))return!0;const T=v.get("keyboardState");return rC(i,n,x,y,T.raw),!0},"Mod-Enter":v=>{if(!t.selected?.is("text"))return;const m=v.get("keyboardState"),y=c(),x=y.getInlineRange();return D(x),rC(i,n,x,y,m.raw,!0),u(v),!0},Space:v=>p(v),"Shift-Space":v=>p(v),"Mod-a":v=>{if(u(v),!t.selected?.is("text"))return;const m=t.selected,y=t.querySelector(`[${ni}]`);return m.from.index===0&&m.from.length===y?.inlineEditor.yText.length?a():h()},Tab:v=>{if(!(t.selected?.is("block")||t.selected?.is("text")))return;const m=o.getChainCtx(br(r).getSelectedModels({types:["text"]})).selectedModels;if(m&&m.length===1){const T=c().getInlineRange();return D(T),OP(t.host,n,T.index),u(v),!0}const y=o.getChainCtx(br(r).getSelectedModels({types:["text","block"]})).selectedModels;if(y)return Jse(t.host,y),!0},"Mod-Backspace":v=>{if(!(t.selected?.is("block")||t.selected?.is("text"))||!t.closest("affine-doc-page,affine-edgeless-page"))return;const y=o.getChainCtx(br(r).getSelectedModels({types:["text"]})).selectedModels;if(y&&y.length===1){const M=c().getInlineRange();return D(M),M.index===0&&(RP(t.host,n,M.index),u(v)),!0}const x=o.getChainCtx(br(r).getSelectedModels({types:["text","block"]})).selectedModels;if(x)return tae(t.host,x),!0},"Shift-Tab":v=>{if(!(t.selected?.is("block")||t.selected?.is("text"))||!t.closest("affine-doc-page,affine-edgeless-page"))return;const y=o.getChainCtx(br(r).getSelectedModels({types:["text"]})).selectedModels;if(y&&y.length===1){const M=c().getInlineRange();return D(M),B0(t.host,n,M.index),u(v),!0}const x=o.getChainCtx(br(r).getSelectedModels({types:["text","block"]})).selectedModels;if(x)return eae(t.host,x),!0},Backspace:v=>{if(!t.selected?.is("text"))return;const m=v.get("keyboardState"),y=c();if(mae(i,n,m.raw,y)||u(v),Ie(t.model,["affine:code"])){const x=y.getInlineRange();D(x);const T=y.yText.toString()[x.index-1],M=y.yText.toString()[x.index];if(Rf[s.indexOf(T)]?.right===M){const k=x.index-1;y.deleteText({index:k,length:2}),y.setInlineRange({index:k,length:0}),u(v)}}return!0},Delete:v=>g(v),"Control-d":v=>{Ag&&g(v)}}),dv.forEach(v=>{v.hotkey&&t.bindHotKey({[v.hotkey]:m=>{if(!(t.page.readonly||!t.selection.find("text")))return u(m),v.action(i),!0}})});function p(v){if(!t.selected?.is("text"))return;const m=c(),y=m.getInlineRange();D(y);const x=d(m);return iC(t,m,x,y)||u(v),!0}function g(v){if(!t.selected?.is("text"))return;const m=v.get("keyboardState"),y=c();return bae(i,n,m.raw,y)||u(v),!0}function f(){const v=t.host.view.viewFromPath("block",qn(n.page.root));if(D(v),!v.widgetElements["affine-linked-doc-widget"])return!1;const y=c(),x=y.getInlineRange();D(x);const T=y.yText.toString(),M=T[x.index-1],k=T[x.index+x.length];if(!(M==="["&&k==="]"))return!1;const A=T.slice(x.index,x.index+x.length);return y.deleteText({index:x.index-1,length:x.length+2}),y.setInlineRange({index:x.index-1,length:0}),Vg(t.page.workspace,{title:A}).then($=>{f2({editorHost:t.host,model:t.model,pageId:$.id})}).catch($=>console.error($)),!0}Rf.forEach(v=>{t.bindHotKey({[v.left]:m=>{if(t.page.readonly)return;const y=t.selection.find("text");if(!y||y.isCollapsed()&&!Ie(t.model,["affine:code"])||!y.isInSameBlock())return;u(m);const x=c(),T=x.getInlineRange();D(T);const M=x.yText.toString().slice(T.index,T.index+T.length);if(!(v.name==="square bracket"&&f()))return x.insertText(T,v.left+M+v.right),x.setInlineRange({index:T.index+1,length:T.length}),!0}})}),Rf.forEach(v=>{t.bindHotKey({[v.right]:m=>{if(!Ie(t.model,["affine:code"]))return;const y=c(),x=y.getInlineRange();D(x);const T=y.yText.toString()[x.index-1],M=y.yText.toString()[x.index];v.left===T&&v.right===M&&(y.setInlineRange({index:x.index+1,length:0}),u(m))}})}),t.bindHotKey({"`":v=>{if(t.page.readonly)return;const m=t.selection.find("text");if(!m||m.isCollapsed()||!m.isInSameBlock())return;u(v);const y=c(),x=y.getInlineRange();return D(x),y.formatText(x,{code:!0}),y.setInlineRange({index:x.index,length:x.length}),!0}})};var vae=Object.defineProperty,yae=Object.getOwnPropertyDescriptor,gv=(t,e,n,i)=>{for(var r=i>1?void 0:i?yae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&vae(e,n,r),r};const wae=t=>t.type==="text"?"Type '/' for commands":{h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",quote:""}[t.type];let wd=class extends wn{constructor(){super(...arguments),this._inlineRangeProvider=null,this._updatePlaceholder=()=>{!this._placeholderContainer||!this._richTextElement||!this.inlineEditor||(this.inlineEditor.yTextLength>0||this.inlineEditor.isComposing||!this.selected||this._isInDatabase()?this._placeholderContainer.classList.remove("visible"):this._placeholderContainer.classList.add("visible"))},this._isInDatabase=()=>{let t=this.parentElement;for(;t&&t!==document.body;){if(t.tagName.toLowerCase()==="affine-database")return!0;t=t.parentElement}return!1}}get inlineManager(){const t=this.service?.inlineManager;return D(t),t}get attributesSchema(){return this.inlineManager.getSchema()}get attributeRenderer(){return this.inlineManager.getRenderer()}get markdownShortcutHandler(){return this.inlineManager.markdownShortcutHandler}get embedChecker(){return this.inlineManager.embedChecker}get topContenteditableElement(){return this.rootBlockElement instanceof Fi?this.closest("affine-note"):this.rootBlockElement}get inlineEditor(){return this._richTextElement?.inlineEditor}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this._richTextElement?.updateComplete,t}connectedCallback(){super.connectedCallback(),fv(this),this._inlineRangeProvider=Xm(this)}firstUpdated(){this.model.propsUpdated.on(this._updatePlaceholder),this.host.selection.slots.changed.on(this._updatePlaceholder),this.updateComplete.then(()=>{this._updatePlaceholder();const t=this.inlineEditor;t&&this.disposables.add(t.slots.inputting.on(this._updatePlaceholder))}).catch(console.error)}renderBlock(){const{type:t}=this.model,e=b`<div
      class="affine-block-children-container"
      style="padding-left: ${Fh}px"
    >
      ${this.renderModelChildren(this.model)}
    </div>`;return b`
      <div class="affine-paragraph-block-container ${t}">
        <div class="affine-paragraph-rich-text-wrapper">
          <div contenteditable="false" class="affine-paragraph-placeholder">
            ${wae(this.model)}
          </div>
          <rich-text
            .yText=${this.model.text.yText}
            .inlineEventSource=${this.topContenteditableElement??ae}
            .undoManager=${this.model.page.history}
            .attributesSchema=${this.attributesSchema}
            .attributeRenderer=${this.attributeRenderer}
            .markdownShortcutHandler=${this.markdownShortcutHandler}
            .embedChecker=${this.embedChecker}
            .readonly=${this.model.page.readonly}
            .inlineRangeProvider=${this._inlineRangeProvider}
            .enableClipboard=${!1}
            .enableUndoRedo=${!1}
          ></rich-text>
        </div>
        ${e}
        ${Tm(this.selected?.is("block"),()=>b`<affine-block-selection></affine-block-selection>`)}
      </div>
    `}};wd.styles=X`
    .affine-paragraph-block-container {
      position: relative;
      border-radius: 4px;
    }
    .affine-paragraph-rich-text-wrapper {
      position: relative;
    }
    /* .affine-paragraph-rich-text-wrapper rich-text {
      -webkit-font-smoothing: antialiased;
    } */
    code {
      font-size: calc(var(--affine-font-base) - 3px);
    }
    .h1 {
      font-size: var(--affine-font-h-1);
      font-weight: 600;
      line-height: calc(1em + 8px);
      margin-top: 18px;
      margin-bottom: 10px;
    }
    .h1 code {
      font-size: calc(var(--affine-font-base) + 8px);
    }
    .h2 {
      font-size: var(--affine-font-h-2);
      font-weight: 600;
      line-height: calc(1em + 10px);
      margin-top: 14px;
      margin-bottom: 10px;
    }
    .h2 code {
      font-size: calc(var(--affine-font-base) + 6px);
    }
    .h3 {
      font-size: var(--affine-font-h-3);
      font-weight: 600;
      line-height: calc(1em + 8px);
      margin-top: 12px;
      margin-bottom: 10px;
    }
    .h3 code {
      font-size: calc(var(--affine-font-base) + 4px);
    }
    .h4 {
      font-size: var(--affine-font-h-4);
      font-weight: 600;
      line-height: calc(1em + 8px);
      margin-top: 12px;
      margin-bottom: 10px;
    }
    .h4 code {
      font-size: calc(var(--affine-font-base) + 2px);
    }
    .h5 {
      font-size: var(--affine-font-h-5);
      font-weight: 600;
      line-height: calc(1em + 8px);
      margin-top: 12px;
      margin-bottom: 10px;
    }
    .h5 code {
      font-size: calc(var(--affine-font-base));
    }
    .h6 {
      font-size: var(--affine-font-h-6);
      font-weight: 600;
      line-height: calc(1em + 8px);
      margin-top: 12px;
      margin-bottom: 10px;
    }
    .h6 code {
      font-size: calc(var(--affine-font-base) - 2px);
    }
    .quote {
      line-height: 26px;
      padding-left: 17px;
      margin-top: var(--affine-paragraph-space);
      padding-top: 10px;
      padding-bottom: 10px;
      position: relative;
    }
    .quote::after {
      content: '';
      width: 2px;
      height: calc(100% - 20px);
      margin-top: 10px;
      margin-bottom: 10px;
      position: absolute;
      left: 0;
      top: 0;
      background: var(--affine-quote-color);
      border-radius: 18px;
    }
    .text {
      margin-top: 10px;
      margin-bottom: 10px;
      font-size: var(--affine-font-base);
    }

    .affine-paragraph-placeholder {
      position: absolute;
      display: none;
      left: 0;
      bottom: 0;
      pointer-events: none;
      color: var(--affine-black-30);
      fill: var(--affine-black-30);
    }
    .affine-paragraph-placeholder.visible {
      display: block;
    }
  `;gv([he("rich-text")],wd.prototype,"_richTextElement",2);gv([he(".affine-paragraph-placeholder")],wd.prototype,"_placeholderContainer",2);wd=gv([W("affine-paragraph")],wd);const mv=_i({flavour:"affine:paragraph",props:t=>({type:"text",text:t.Text()}),metadata:{version:1,role:"content",parent:["affine:note","affine:database","affine:paragraph","affine:list"]}});class D0{constructor(){this._specs=[],this._markdownMatches=[],this.markdownShortcutHandler=(e,n)=>{const{inlineEditor:i,prefixText:r,inlineRange:o}=e;for(const s of this._markdownMatches)if(r.match(s.pattern))return s.action({inlineEditor:i,prefixText:r,inlineRange:o,pattern:s.pattern,undoManager:n});return Vn},this.embedChecker=e=>{for(const n of this._specs)if(n.embed&&n.match(e))return!0;return!1}}get specs(){return this._specs}get markdownMatches(){return this._markdownMatches}registerSpecs(e){this._specs=e}registerMarkdownMatches(e){this._markdownMatches=e}getRenderer(){const e=QB();return(i,r)=>{for(const o of this._specs)if(o.match(i))return o.renderer(i,r);return e(i,r)}}getSchema(){const e=KB;return this._specs.reduce((i,r)=>{const o=ge.object({[r.name]:r.schema});return i.merge(o)},e)}}var xae=Object.defineProperty,_ae=Object.getOwnPropertyDescriptor,FP=(t,e,n,i)=>{for(var r=i>1?void 0:i?_ae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&xae(e,n,r),r};function bv(t,e){let n="";t.underline&&(n+="underline"),t.strike&&(n+=" line-through");let i={};return t.code&&(i={"font-family":"var(--affine-font-code-family)",background:"var(--affine-background-code-block)",color:"var(--affine-text-primary-color)","border-radius":"2px",padding:"3px 6px 4px","font-variant-ligatures":"none","line-height":"var(--affine-font-base)"}),we({"font-weight":t.bold?"bolder":"inherit","font-style":t.italic?"italic":"normal","background-color":t.background?t.background:void 0,color:t.color?t.color:void 0,"text-decoration":n.length>0?n:"none",...i,...e})}let y5=class extends De{constructor(){super(...arguments),this.delta={insert:Bg}}render(){const t=this.delta.attributes?bv(this.delta.attributes):we({});return this.delta.attributes?.code?b`<code style=${t}
        ><v-text .str=${this.delta.insert}></v-text
      ></code>`:b`<span style=${t}
      ><v-text .str=${this.delta.insert}></v-text
    ></span>`}};y5.styles=X`
    affine-text {
      white-space: break-spaces;
      word-break: break-word;
    }
  `;FP([L({type:Object})],y5.prototype,"delta",2);y5=FP([W("affine-text")],y5);var Cae=Object.defineProperty,kae=Object.getOwnPropertyDescriptor,UP=(t,e,n,i)=>{for(var r=i>1?void 0:i?kae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Cae(e,n,r),r};let w5=class extends De{constructor(){super(...arguments),this.delta={insert:Bg},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.std.selection,n=e.find("text");return n&&(n.to||n.from.length)||e.filter("block").length?null:{template:wP(this.inlineEditor,"view",this.selfInlineRange,t)}})}get link(){const t=this.delta.attributes?.link;return t||""}get inlineEditor(){const t=this.closest(`[${ni}]`);return D(t),t.inlineEditor}get selfInlineRange(){const t=this.inlineEditor.getInlineRangeFromElement(this);return D(t),t}get blockElement(){const t=this.inlineEditor.rootElement.closest(`[${lr}]`);return D(t),t}get std(){const t=this.blockElement.std;return D(t),t}_onMouseUp(){const t=this.querySelector("a");D(t),t.isContentEditable&&(t.contentEditable="false",setTimeout(()=>{t.removeAttribute("contenteditable")},0))}render(){const t=this.delta.attributes?bv(this.delta.attributes):we({});return b`<a
      ${$t(this._whenHover.setReference)}
      href=${this.link}
      rel="noopener noreferrer"
      target="_blank"
      style=${t}
      @mouseup=${this._onMouseUp}
      ><v-text .str=${this.delta.insert}></v-text
    ></a>`}};w5.styles=X`
    affine-link > a {
      white-space: nowrap;
      word-break: break-word;
      color: var(--affine-link-color);
      fill: var(--affine-link-color);
      text-decoration: none;
      cursor: pointer;
    }

    affine-link > a:hover [data-v-text='true'] {
      text-decoration: underline;
    }

    affine-link > a > v-text {
      white-space: break-spaces;
    }
  `;UP([L({type:Object})],w5.prototype,"delta",2);w5=UP([W("affine-link")],w5);var Eae=Object.defineProperty,Sae=Object.getOwnPropertyDescriptor,J3=(t,e,n,i)=>{for(var r=i>1?void 0:i?Sae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Eae(e,n,r),r};let lc=class extends me(Ae){get referencePageId(){const t=this.inlineEditor.getFormat(this.targetInlineRange).reference?.pageId;return D(t),t}get blockElement(){const t=this.inlineEditor.rootElement.closest(`[${lr}]`);return D(t),t}get std(){const t=this.blockElement.std;return D(t),t}_openPage(){const t=this.referencePageId,e=this.blockElement;if(t===e.model.page.id)return;const n=this.std.view.viewFromPath("block",[e.model.page.root?.id??""]);D(n),n.slots.pageLinkClicked.emit({pageId:t})}_delete(){this.inlineEditor.isValidInlineRange(this.targetInlineRange)&&this.inlineEditor.deleteText(this.targetInlineRange),this.abortController.abort()}render(){return b`<div class="reference-popup-more-menu">
      <icon-button
        width="126px"
        height="32px"
        class="menu-item open"
        text="Open"
        @click=${()=>this._openPage()}
      >
        ${oo}
      </icon-button>

      <div class="divider"></div>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item delete"
        text="Delete"
        @click=${()=>this._delete()}
      >
        ${xn}
      </icon-button>
    </div> `}};lc.styles=X`
    .reference-popup-more-menu {
      border-radius: 8px;
      padding: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    .menu-item {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      width: 100%;
    }

    .menu-item:hover {
      background: var(--affine-hover-color);
    }

    .menu-item:hover.delete {
      background: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }
    .menu-item:hover.delete > svg {
      color: var(--affine-error-color);
    }

    .menu-item svg {
      margin: 0 8px;
    }

    .divider {
      width: 148px;
      height: 1px;
      margin: 8px;
      background-color: var(--affine-border-color);
    }
  `;J3([L({attribute:!1})],lc.prototype,"inlineEditor",2);J3([L({attribute:!1})],lc.prototype,"targetInlineRange",2);J3([L({attribute:!1})],lc.prototype,"abortController",2);lc=J3([W("reference-popup-more-menu")],lc);const Tae=X`
  :host {
    box-sizing: border-box;
  }

  .affine-reference-popover-container {
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-base);
    font-style: normal;
    line-height: 24px;
    color: var(--affine-text-primary-color);
    z-index: var(--affine-z-index-popover);
    animation: affine-popover-fade-in 0.2s ease;
    position: absolute;
  }

  @keyframes affine-popover-fade-in {
    from {
      opacity: 0;
      transform: translateY(-3px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .affine-reference-popover {
    box-sizing: border-box;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
    height: 40px;

    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
  }

  .affine-reference-popover-dividing-line {
    margin: 0 6px;
    width: 1px;
    height: 20px;
    background-color: var(--affine-border-color);
  }

  .affine-reference-popover-view-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 2px;
    border-radius: 6px;
    background: var(--affine-hover-color);
  }
  .affine-reference-popover-view-selector > icon-button {
    padding: 0px;
  }
  .affine-reference-popover-view-selector .current-view {
    background: var(--affine-background-overlay-panel-color);
  }
`;var Iae=Object.defineProperty,Lae=Object.getOwnPropertyDescriptor,hu=(t,e,n,i)=>{for(var r=i>1?void 0:i?Lae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Iae(e,n,r),r};let Hs=class extends me(Ae){constructor(){super(...arguments),this._moreMenuAbortController=null}get referencePageId(){const t=this.inlineEditor.getFormat(this.targetInlineRange).reference?.pageId;return D(t),t}connectedCallback(){if(super.connectedCallback(),this.targetInlineRange.length===0)throw new Error("Cannot toggle reference popup on empty range");const t=this.blockElement.host.page.getParent(this.blockElement.model);D(t),this.disposables.add(t.childrenUpdated.on(()=>{t.children.includes(this.blockElement.model)||this.abortController.abort()}))}updated(){D(this.popupContainer);const t=this.inlineEditor.toDomRange(this.targetInlineRange);D(t),ii({getBoundingClientRect:()=>t.getBoundingClientRect(),getClientRects:()=>t.getClientRects()},this.popupContainer,{middleware:[Dt(10),P2(),tr({padding:6})]}).then(({x:n,y:i})=>{const r=this.popupContainer;r&&(r.style.left=`${n}px`,r.style.top=`${i}px`)}).catch(console.error)}get blockElement(){const t=this.inlineEditor.rootElement.closest(`[${lr}]`);return D(t),t}get std(){const t=this.blockElement.std;return D(t),t}_openPage(){const t=this.referencePageId,e=this.blockElement;if(t===e.model.page.id)return;const n=this.std.view.viewFromPath("block",[e.model.page.root?.id??""]);D(n),n.slots.pageLinkClicked.emit({pageId:t})}_convertToCardView(){const t=this.blockElement,e=t.host.page,n=e.getParent(t.model);D(n);const i=n.children.indexOf(t.model),r=this.referencePageId;e.addBlock("affine:embed-linked-doc",{pageId:r},n,i+1);const o=this.inlineEditor.yTextLength,s=this.targetInlineRange.length;o===s?e.deleteBlock(t.model):this.inlineEditor.insertText(this.targetInlineRange,this.pageTitle),this.abortController.abort()}_toggleMoreMenu(){if(this._moreMenuAbortController){this._moreMenuAbortController.abort(),this._moreMenuAbortController=null;return}this._moreMenuAbortController=new AbortController;const t=new lc;t.abortController=this.abortController,t.inlineEditor=this.inlineEditor,t.targetInlineRange=this.targetInlineRange,Rs({template:t,container:this.popupContainer,computePosition:{referenceElement:this.popupContainer,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0},abortController:this._moreMenuAbortController})}render(){return b`
      <div class="overlay-root blocksuite-overlay">
        <div class="affine-reference-popover-container">
          <div class="affine-reference-popover view">
            <icon-button size="32px" @click=${this._openPage}>
              ${oo}
              <affine-tooltip .offset=${12}
                >${"Click to open page"}</affine-tooltip
              >
            </icon-button>

            <span class="affine-reference-popover-dividing-line"></span>

            <div class="affine-reference-popover-view-selector">
              <icon-button
                size="24px"
                class="affine-reference-popover-view-selector-button link current-view"
                hover="false"
              >
                ${Yd}
                <affine-tooltip .offset=${12}>${"Inline view"}</affine-tooltip>
              </icon-button>

              <icon-button
                size="24px"
                class="affine-reference-popover-view-selector-button embed"
                hover="false"
                @click=${()=>this._convertToCardView()}
              >
                ${Yo}
                <affine-tooltip .offset=${12}>${"Card view"}</affine-tooltip>
              </icon-button>
            </div>

            <span class="affine-reference-popover-dividing-line"></span>

            <icon-button size="24px" @click=${()=>this._toggleMoreMenu()}>
              ${d0}
              <affine-tooltip .offset=${12}>More</affine-tooltip>
            </icon-button>
          </div>
        </div>
      </div>
    `}};Hs.styles=Tae;hu([L({attribute:!1})],Hs.prototype,"inlineEditor",2);hu([L({attribute:!1})],Hs.prototype,"targetInlineRange",2);hu([L({attribute:!1})],Hs.prototype,"pageTitle",2);hu([L({attribute:!1})],Hs.prototype,"abortController",2);hu([he(".affine-reference-popover-container")],Hs.prototype,"popupContainer",2);Hs=hu([W("reference-popup")],Hs);function Mae(t,e,n,i){const r=new Hs;return r.inlineEditor=t,r.targetInlineRange=e,r.pageTitle=n,r.abortController=i,document.body.appendChild(r),r}var Pae=Object.defineProperty,Aae=Object.getOwnPropertyDescriptor,O0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Aae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Pae(e,n,r),r};let cc=class extends me(De){constructor(){super(...arguments),this.delta={insert:Bg,attributes:{}},this.selected=!1,this._refAttribute={type:"LinkedPage",pageId:"0"},this._updateRefMeta=t=>{const e=this.delta.attributes?.reference;D(e,"Failed to get reference attribute!"),this._refAttribute=e;const n=t.workspace.meta.pageMetas.find(i=>i.id===e.pageId);this._refMeta=n?{...n}:void 0},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.std.selection,n=e.find("text");return n&&(n.to||n.from.length)||e.filter("block").length?null:{template:Mae(this.inlineEditor,this.selfInlineRange,this._refMeta?.title??j_,t)}})}get inlineEditor(){const t=this.closest(`[${ni}]`);return D(t),t.inlineEditor}get selfInlineRange(){const t=this.inlineEditor.getInlineRangeFromElement(this);return D(t),t}get blockElement(){const t=this.inlineEditor.rootElement.closest(`[${lr}]`);return D(t),t}get std(){const t=this.blockElement.std;return D(t),t}get page(){const t=this.config.page;return D(t,"`reference-node` need `Page`."),t}get customIcon(){return this.config.customIcon}get customTitle(){return this.config.customTitle}get customContent(){return this.config.customContent}connectedCallback(){super.connectedCallback(),D(this.config,"`reference-node` need `ReferenceNodeConfig`."),this.delta.insert!==bd&&console.error(`Reference node must be initialized with '${bd}', but got '${this.delta.insert}'`);const t=this.page;this._updateRefMeta(t),this._disposables.add(t.workspace.slots.pagesUpdated.on(()=>this._updateRefMeta(t))),this.updateComplete.then(()=>{this.disposables.add(this.inlineEditor.slots.textChange.on(()=>this._updateRefMeta(t)))}).catch(console.error)}_onClick(){if(!this.config.interactable)return;const t=this._refMeta,e=Dk(this);if(!t){console.warn("The page is deleted",this._refAttribute.pageId);return}if(t.id===e.page.id)return;const n=t.id,i=e.page.root;D(i);const r=gs(this);D(r),r.slots.pageLinkClicked.emit({pageId:n})}render(){const t=this._refMeta,e=!t,n=this.delta.attributes;D(n,"Failed to get attributes!");const i=n.reference?.type;D(i,"Unable to get reference type!");const r=this.customTitle?this.customTitle(this):e?"Deleted page":t.title.length>0?t.title:j_,o=this.customIcon?this.customIcon(this):i==="LinkedPage"?pb:OL,s=bv(n,e?{color:"var(--affine-text-disable-color)",textDecoration:"line-through",fill:"var(--affine-text-disable-color)"}:{}),a=this.customContent?this.customContent(this):b`${o}<span data-title=${r} class="affine-reference-title"
            >${r}</span
          >`;return b`<span
      ${this.config.interactable?$t(this._whenHover.setReference):""}
      data-selected=${this.selected}
      class="affine-reference"
      style=${s}
      @click=${this._onClick}
      >${a}<v-text .str=${JB}></v-text
    ></span>`}};cc.styles=X`
    .affine-reference {
      white-space: nowrap;
      word-break: break-word;
      color: var(--affine-text-primary-color);
      fill: var(--affine-icon-color);
      border-radius: 4px;
      text-decoration: none;
      cursor: pointer;
      user-select: none;
      padding: 1px 2px 1px 0;
    }
    .affine-reference:hover {
      background: var(--affine-hover-color);
    }

    .affine-reference[data-selected='true'] {
      background: var(--affine-hover-color);
    }

    .affine-reference-title {
      margin-left: 4px;
      border-bottom: 0.5px solid var(--affine-divider-color);
      transition: border 0.2s ease-out;
    }
    .affine-reference-title:hover {
      border-bottom: 0.5px solid var(--affine-icon-color);
    }

    .affine-reference > span {
      white-space: break-spaces;
    }
  `;O0([L({type:Object})],cc.prototype,"delta",2);O0([L({type:Boolean})],cc.prototype,"selected",2);O0([L({attribute:!1})],cc.prototype,"config",2);O0([ie()],cc.prototype,"_refMeta",2);cc=O0([W("affine-reference")],cc);const $ae=[{name:"bold",schema:ge.literal(!0).optional().nullable().catch(void 0),match:t=>!!t.attributes?.bold,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"italic",schema:ge.literal(!0).optional().nullable().catch(void 0),match:t=>!!t.attributes?.italic,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"underline",schema:ge.literal(!0).optional().nullable().catch(void 0),match:t=>!!t.attributes?.underline,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"strike",schema:ge.literal(!0).optional().nullable().catch(void 0),match:t=>!!t.attributes?.strike,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"code",schema:ge.literal(!0).optional().nullable().catch(void 0),match:t=>!!t.attributes?.code,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"link",schema:ge.string().optional().nullable().catch(void 0),match:t=>!!t.attributes?.link,renderer:t=>b`<affine-link .delta=${t}></affine-link>`},{name:"background",schema:ge.string().optional().nullable().catch(void 0),match:t=>!!t.attributes?.background,renderer:t=>b`<affine-text .delta=${t}></affine-text>`},{name:"color",schema:ge.string().optional().nullable().catch(void 0),match:t=>!!t.attributes?.color,renderer:t=>b`<affine-text .delta=${t}></affine-text>`}];function R0(t){return[...$ae,{name:"reference",schema:ge.object({type:ge.enum(["Subpage","LinkedPage"]),pageId:ge.string()}).optional().nullable().catch(void 0),match:e=>!!e.attributes?.reference,renderer:(e,n)=>b`<affine-reference
          .delta=${e}
          .selected=${n}
          .config=${t}
        ></affine-reference>`,embed:!0}]}const vv=[{name:"bolditalic",pattern:/(?:\*\*\*)([^\s\*](?:[^*]*?[^\s\*])?)(?:\*\*\*)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{bold:!0,italic:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:a+s.length-3,length:3}),t.deleteText({index:a,length:3}),t.setInlineRange({index:a+s.length-6,length:0}),cn}},{name:"bold",pattern:/(?:\*\*)([^\s\*](?:[^*]*?[^\s\*])?)(?:\*\*)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{bold:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:a+s.length-2,length:2}),t.deleteText({index:a,length:2}),t.setInlineRange({index:a+s.length-4,length:0}),cn}},{name:"italic",pattern:/(?:\*)([^\s\*](?:[^*]*?[^\s\*])?)(?:\*)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{italic:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:a+s.length-1,length:1}),t.deleteText({index:a,length:1}),t.setInlineRange({index:a+s.length-2,length:0}),cn}},{name:"strikethrough",pattern:/(?:~~)([^\s~](?:[^~]*?[^\s~])?)(?:~~)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{strike:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:a+s.length-2,length:2}),t.deleteText({index:a,length:2}),t.setInlineRange({index:a+s.length-4,length:0}),cn}},{name:"underthrough",pattern:/(?:~)([^\s~](?:[^~]*?[^\s~])?)(?:~)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{underline:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:n.index-1,length:1}),t.deleteText({index:a,length:1}),t.setInlineRange({index:a+s.length-2,length:0}),cn}},{name:"code",pattern:/(?:`)([^\s`](?:[^`]*?[^\s`])?)(?:`)$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=i.exec(e);if(!o)return Vn;const s=o[0],a=n.index-s.length;return e.match(/^([* \n]+)$/g)?Vn:(t.insertText({index:a+s.length,length:0}," "),t.setInlineRange({index:a+s.length+1,length:0}),r.stopCapturing(),t.formatText({index:a,length:s.length},{code:!0}),t.deleteText({index:a+s.length,length:1}),t.deleteText({index:a+s.length-1,length:1}),t.deleteText({index:a,length:1}),t.setInlineRange({index:a+s.length-2,length:0}),cn)}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))$/g,action:({inlineEditor:t,prefixText:e,inlineRange:n,pattern:i,undoManager:r})=>{const o=e.search(i),s=e.match(i)?.[0],a=e.match(/(?:\[(.*?)\])/g)?.[0],l=e.match(/(?:\((.*?)\))/g)?.[0];if(o===-1||!s||!a||!l)return Vn;const c=n.index-s.length;return t.insertText({index:n.index,length:0}," "),t.setInlineRange({index:n.index+1,length:0}),r.stopCapturing(),t.formatText({index:c,length:a.length},{link:l.slice(1,l.length-1)}),t.deleteText({index:n.index+s.length,length:1}),t.deleteText({index:n.index-l.length-1,length:l.length+1}),t.deleteText({index:c,length:1}),t.setInlineRange({index:c+a.length-1,length:0}),cn}}];class N0{constructor(){this._customIcon=null,this._customTitle=null,this._customContent=null,this._page=null,this._interactable=!0}get customIcon(){return this._customIcon}get customTitle(){return this._customTitle}get page(){return this._page}get customContent(){return this._customContent}get interactable(){return this._interactable}setInteractable(e){this._interactable=e}setCustomContent(e){this._customContent=e}setCustomIcon(e){this._customIcon=e}setCustomTitle(e){this._customTitle=e}setPage(e){this._page=e}}class VP extends li{constructor(){super(...arguments),this.inlineManager=new D0,this.referenceNodeConfig=new N0}mounted(){super.mounted(),this.referenceNodeConfig.setPage(this.page);const e=R0(this.referenceNodeConfig);this.inlineManager.registerSpecs(e),this.inlineManager.registerMarkdownMatches(vv)}}const zP=X`
  .affine-list-block__prefix {
    display: flex;
    color: var(--affine-blue-700);
    font-size: var(--affine-font-sm);
    user-select: none;
    position: relative;
  }

  .affine-list-block__numbered {
    min-width: 22px;
    height: 24px;
    margin-left: 2px;
  }

  .affine-list-block__todo-prefix {
    display: flex;
    align-items: center;
    cursor: pointer;
    width: 24px;
    height: 24px;
    color: var(--affine-icon-color);
  }

  .affine-list-block__todo-prefix > svg {
    width: 20px;
    height: 20px;
  }
`,jP=X`
  .toggle-icon {
    display: flex;
    align-items: center;
    height: 16px;
    margin: 4px 0;
    position: absolute;
    left: 0;
    transform: translateX(-100%);
    border-radius: 4px;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
  }
  .toggle-icon:hover {
    background: var(--affine-hover-color);
  }
  .affine-list-rich-text-wrapper:hover .toggle-icon {
    opacity: 1;
  }
  .toggle-icon__collapsed {
    opacity: 1;
  }

  .with-drag-handle .affine-list-rich-text-wrapper .toggle-icon {
    opacity: 1;
  }
  .with-drag-handle .affine-block-children-container .toggle-icon {
    opacity: 0;
  }
`,Bae=X`
  .affine-list-block-container {
    box-sizing: border-box;
    border-radius: 4px;
    padding: 4px 0;
    position: relative;
  }
  .affine-list-block-container--first {
    margin-top: 14px;
  }
  .affine-list-block-container .affine-list-block-container {
    margin-top: 0;
  }
  .affine-list-rich-text-wrapper {
    position: relative;
    display: flex;
    position: relative;
  }
  .affine-list-rich-text-wrapper rich-text {
    flex: 1;
  }

  .affine-list--checked {
    color: var(--affine-text-secondary-color);
  }

  ${zP}
  ${jP}
`,Dae=t=>{const e=t.page.getParent(t)?.children||[],n=e.findIndex(r=>r===t);let i=0;for(let r=0;r<n;r++)e[r].flavour===t.flavour&&e[r].type===t.type?i+=1:i=0;return i},Oae=t=>{let e=0,n=t.page.getParent(t);for(;n?.flavour===t.flavour;)e++,n=t.page.getParent(n);return e},GP=t=>{const e=Oae(t),n=Dae(t);return{deep:e,index:n}};function Rae(t){let r="";for(;t>=0;)r=String.fromCharCode(t%26+97)+r,t=Math.floor(t/26)-1;return r}function Nae(t){const e={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let n="";for(const i in e)for(;t>=e[i];)n+=i,t-=e[i];return n}function Hae(t,e){const n=[()=>e+1,Rae,()=>Nae(e+1)];return n[t%n.length](e)}function Fae(t,e){return`${Hae(e,t)}.`}function ZP(t,e,n){const{index:i,deep:r}=GP(t);switch(t.type){case"bulleted":return b`<div class="affine-list-block__prefix" @click=${n}>
        ${F_[r%F_.length]}
      </div>`;case"numbered":return b`<div
        class="affine-list-block__prefix affine-list-block__numbered"
        @click=${n}
      >
        ${Fae(i,r)}
      </div>`;case"todo":return b`<div
        class="affine-list-block__prefix affine-list-block__todo-prefix"
        @click=${n}
      >
        ${t.checked?av():lv()}
      </div>`;case"toggle":return b`<div class="affine-list-block__prefix" @click=${n}>
        ${e?gP:fP}
      </div>`;default:return console.error("Unknown list type",t.type,t),null}}var Uae=Object.defineProperty,Vae=Object.getOwnPropertyDescriptor,yv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Vae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Uae(e,n,r),r};let xd=class extends wn{constructor(){super(...arguments),this._isCollapsedWhenReadOnly=!!this.model?.collapsed,this._onClickIcon=t=>{if(t.stopPropagation(),this.model.type==="toggle"){this._toggleChildren();return}else if(this.model.type==="todo"){this.model.page.captureSync();const e={checked:!this.model.checked};if(this.model.page.updateBlock(this.model,e),this.model.checked){const n=this.querySelector(".affine-list-block__todo-prefix");D(n),mP(n).catch(console.error)}return}this._select()},this._inlineRangeProvider=null}get inlineManager(){const t=this.service?.inlineManager;return D(t),t}get attributesSchema(){return this.inlineManager.getSchema()}get attributeRenderer(){return this.inlineManager.getRenderer()}get markdownShortcutHandler(){return this.inlineManager.markdownShortcutHandler}get embedChecker(){return this.inlineManager.embedChecker}_select(){const t=this.host.selection;t.update(e=>e.filter(n=>!n.is("text")&&!n.is("block")).concat(t.create("block",{path:this.path})))}get topContenteditableElement(){return this.rootBlockElement instanceof Fi?this.closest("affine-note"):this.rootBlockElement}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this._richTextElement?.updateComplete,t}firstUpdated(){this._updateFollowingListSiblings(),this.model.childrenUpdated.on(()=>{this._updateFollowingListSiblings()})}_updateFollowingListSiblings(){this.updateComplete.then(()=>{let t=this;for(;t&&t.tagName=="AFFINE-LIST";)t.requestUpdate(),t=this.std.view.findNext(t.path,()=>!0)?.view}).catch(console.error)}connectedCallback(){super.connectedCallback(),fv(this),this._inlineRangeProvider=Xm(this)}_toggleChildren(){if(this.page.readonly){this._isCollapsedWhenReadOnly=!this._isCollapsedWhenReadOnly;return}const t=!this.model.collapsed;this._isCollapsedWhenReadOnly=t,this.page.captureSync(),this.page.updateBlock(this.model,{collapsed:t})}_toggleTemplate(t){if(this.model.children.length===0)return ae;const n=b`<div
      class="toggle-icon"
      @click=${this._toggleChildren}
    >
      ${gP}
    </div>`,i=b`<div
      class="toggle-icon toggle-icon__collapsed"
      @click=${this._toggleChildren}
    >
      ${fP}
    </div>`;return t?i:n}renderBlock(){const{deep:t,index:e}=GP(this.model),{model:n,_onClickIcon:i}=this,r=this.page.readonly?this._isCollapsedWhenReadOnly:!!n.collapsed,o=ZP(n,!r,i),a=e===0&&t===0?"affine-list-block-container--first":"",l=this.model.type==="todo"&&this.model.checked?"affine-list--checked":"",c=b`<div
      class="affine-block-children-container"
      style="padding-left: ${Fh}px"
    >
      ${this.renderModelChildren(this.model)}
    </div>`;return b`
      <div class=${`affine-list-block-container ${a}`}>
        <div class=${`affine-list-rich-text-wrapper ${l}`}>
          ${this._toggleTemplate(r)} ${o}
          <rich-text
            .yText=${this.model.text.yText}
            .inlineEventSource=${this.topContenteditableElement??ae}
            .undoManager=${this.model.page.history}
            .attributeRenderer=${this.attributeRenderer}
            .attributesSchema=${this.attributesSchema}
            .markdownShortcutHandler=${this.markdownShortcutHandler}
            .embedChecker=${this.embedChecker}
            .readonly=${this.model.page.readonly}
            .inlineRangeProvider=${this._inlineRangeProvider}
            .enableClipboard=${!1}
            .enableUndoRedo=${!1}
          ></rich-text>
        </div>
        ${r?ae:c}
        ${Tm(this.selected?.is("block"),()=>b`<affine-block-selection></affine-block-selection>`)}
      </div>
    `}};xd.styles=Bae;yv([ie()],xd.prototype,"_isCollapsedWhenReadOnly",2);yv([he("rich-text")],xd.prototype,"_richTextElement",2);xd=yv([W("affine-list")],xd);const wv=_i({flavour:"affine:list",props:t=>({type:"bulleted",text:t.Text(),checked:!1,collapsed:!1}),metadata:{version:1,role:"content",parent:["affine:note","affine:database","affine:list","affine:paragraph"]}});class WP extends li{constructor(){super(...arguments),this.inlineManager=new D0,this.referenceNodeConfig=new N0,this.styles={icon:ZP,prefix:zP,toggle:jP}}mounted(){super.mounted(),this.referenceNodeConfig.setPage(this.page);const e=R0(this.referenceNodeConfig);this.inlineManager.registerSpecs(e),this.inlineManager.registerMarkdownMatches(vv)}}var zae=Object.defineProperty,jae=Object.getOwnPropertyDescriptor,qP=(t,e,n,i)=>{for(var r=i>1?void 0:i?jae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&zae(e,n,r),r};let x5=class extends wn{constructor(){super(...arguments),this._isNavigator=!1}get titleElement(){return this.closest("affine-edgeless-page")?.querySelector?.(`[data-frame-title-id="${this.model.id}"]`)??null}get isInner(){const t=this.titleElement;return t?t.isInner:!1}get surface(){return this.closest("affine-edgeless-page").surface}get edgeless(){return this.closest("affine-edgeless-page")}connectedCallback(){super.connectedCallback();let t=0;this._disposables.add(this.edgeless.service.viewport.viewportUpdated.on(({zoom:e})=>{e!==t&&(this.requestUpdate(),t=e)})),this._disposables.add(this.model.page.slots.blockUpdated.on(({type:e,id:n})=>{n===this.model.id&&e==="update"&&this.requestUpdate()}))}createRenderRoot(){return this}firstUpdated(){this.surface.edgeless.slots.edgelessToolUpdated.on(t=>{this._isNavigator=t.type==="frameNavigator"})}renderBlock(){const{model:t,_isNavigator:e}=this,n=ne.deserialize(t.xywh);return b`
      <div
        class="affine-frame-container"
        style=${we({width:n.w+"px",height:n.h+"px",backgroundColor:$3(t.background)?`var(${t.background})`:"",borderRadius:"8px",border:e?"none":"2px solid var(--affine-black-30)"})}
      ></div>
    `}};qP([ie()],x5.prototype,"_isNavigator",2);x5=qP([W("affine-frame")],x5);const xv=_i({flavour:"affine:frame",props:t=>({title:t.Text(),background:"--affine-palette-transparent",xywh:"[0,0,100,100]",index:"a0"}),metadata:{version:1,role:"content",parent:["affine:surface"],children:[]},toModel:()=>new dc});class dc extends C0(Bn){static{this.PADDING=[8,10]}hitTest(e,n,i){const r=ne.deserialize(this.xywh),o=r.isPointNearBound([e,n],5),s=i.zoom??1;if(o)return!0;const a=uY(this.title.toString(),"Inter",14);return a.w=(a.w+dc.PADDING[1]*2)/s,a.h=(a.h+dc.PADDING[0]*2)/s,r.y-=a.h,r.w=a.w,r.h=a.h,r.isPointInBound([e,n])}boxSelect(e){const n=ne.deserialize(this.xywh);return n.isIntersectWithBound(e)||e.contains(n)}}var Gae=Object.defineProperty,Zae=Object.getOwnPropertyDescriptor,Wae=(t,e,n,i)=>{for(var r=i>1?void 0:i?Zae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Gae(e,n,r),r};let _5=class extends wn{connectedCallback(){super.connectedCallback(),this.contentEditable="false",this.handleEvent("click",()=>{this.host.selection.set([this.host.selection.create("block",{path:this.path})])})}renderBlock(){const t=b`<div
      class="affine-block-children-container"
      style="padding-left: ${Fh}px"
    >
      ${this.renderModelChildren(this.model)}
    </div>`;return b`
      <div class="affine-divider-block-container">
        <hr />
        ${t}
        ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:null}
      </div>
    `}};_5.styles=X`
    .affine-divider-block-container {
      position: relative;
      width: 100%;
      height: 1px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 18px 8px;
      margin-top: var(--affine-paragraph-space);
    }
    hr {
      border: none;
      border-top: 1px solid var(--affine-divider-color);
      width: 100%;
    }
  `;_5=Wae([W("affine-divider")],_5);const _v=_i({flavour:"affine:divider",metadata:{version:1,role:"content",children:[]}});var qae=Object.defineProperty,Yae=Object.getOwnPropertyDescriptor,Cv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Yae(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qae(e,n,r),r};let C5=class extends De{constructor(){super(...arguments),this.delta={insert:Bg},this.highlightOptionsGetter=null}render(){D(this.highlightOptionsGetter,"highlightOptionsGetter is not set");const{lang:t,highlighter:e}=this.highlightOptionsGetter();if(!e||!e.getLoadedLanguages().includes(t))return b`<span
        ><v-text
          .str=${this.delta.insert}
          .styles=${{"word-wrap":"break-word","white-space":"break-spaces"}}
        ></v-text
      ></span>`;const n=Wo(),i=`${this.delta.insert}-${t}-${n}`,r=z2.get(i);let o=[{content:this.delta.insert}];r?o=r:(o=e.codeToThemedTokens(this.delta.insert,t,n==="dark"?V8:z8)[0],z2.set(i,o));const s=o.map(a=>b`<v-text
        .str=${a.content}
        .styles=${{"word-wrap":"break-word","white-space":"break-spaces",color:a.color}}
      ></v-text>`);return b`<span>${s}</span>`}};Cv([L({type:Object})],C5.prototype,"delta",2);Cv([L({attribute:!1})],C5.prototype,"highlightOptionsGetter",2);C5=Cv([W("affine-code-line")],C5);const sC=b`<style>
  .affine-page-selected-embed-rects-container {
    position: absolute;
    border: 2px solid var(--affine-primary-color);
    left: 0;
    top: 0;
    width: 100%;
    height: calc(100% + 1px);
    user-select: none;
    pointer-events: none;
    box-sizing: border-box;
    line-height: 0;
  }

  .affine-page-selected-embed-rects-container .resize {
    position: absolute;
    padding: 5px;
    pointer-events: auto;
    z-index: 1;
  }

  .affine-page-selected-embed-rects-container .resize-inner {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: white;
    border: 2px solid var(--affine-primary-color);
    pointer-events: none;
  }

  .affine-page-selected-embed-rects-container .resize.top-left {
    left: 0;
    top: 0;
    transform: translate(-50%, -50%);
    cursor: nwse-resize; /*resizer cursor*/
  }
  .affine-page-selected-embed-rects-container .resize.top-right {
    right: 0;
    top: 0;
    transform: translate(50%, -50%);
    cursor: nesw-resize;
  }
  .affine-page-selected-embed-rects-container .resize.bottom-left {
    left: 0;
    bottom: 0;
    transform: translate(-50%, 50%);
    cursor: nesw-resize;
  }
  .affine-page-selected-embed-rects-container .resize.bottom-right {
    right: 0;
    bottom: 0;
    transform: translate(50%, 50%);
    cursor: nwse-resize;
  }
</style>`;function Xae(t){return t?b`${sC}
      <div
        class="affine-page-selected-embed-rects-container resizable resizes"
      ></div> `:b`
    ${sC}
    <div class="affine-page-selected-embed-rects-container resizable resizes">
      <div class="resize top-left">
        <div class="resize-inner"></div>
      </div>
      <div class="resize top-right">
        <div class="resize-inner"></div>
      </div>
      <div class="resize bottom-left">
        <div class="resize-inner"></div>
      </div>
      <div class="resize bottom-right">
        <div class="resize-inner"></div>
      </div>
    </div>
  `}function Kae(t){return t.closest("affine-edgeless-page, affine-page-block")}class Qae{constructor(){this._activeComponent=null,this._imageContainer=null,this._imageCenterX=0,this._dragMoveTarget="right",this._zoom=1}onStart(e){const n=e.raw.target;this._activeComponent=Ug(n);const i=Kae(this._activeComponent);i&&Hk(i)?this._zoom=i.service.viewport.zoom:this._zoom=1,this._imageContainer=n.closest(".resizable-img"),D(this._imageContainer);const r=this._imageContainer.getBoundingClientRect();this._imageCenterX=r.left+r.width/2,n.className.includes("right")?this._dragMoveTarget="right":this._dragMoveTarget="left"}onMove(e){D(this._activeComponent);const n=this._activeComponent,i=this._imageContainer;D(i);const r=n.querySelector("img");D(r);let o=0;this._dragMoveTarget==="right"?o=(e.raw.pageX-this._imageCenterX)*2:o=(this._imageCenterX-e.raw.pageX)*2;const s=50;o<s&&(o=s),o>n.getBoundingClientRect().width&&(o=n.getBoundingClientRect().width);const a=o*(r.naturalHeight/r.naturalWidth),l=i.getBoundingClientRect();l.width===o&&l.height===a||requestAnimationFrame(()=>{i.style.width=(o/this._zoom).toFixed(2)+"px",i.style.height=(a/this._zoom).toFixed(2)+"px"})}onEnd(){D(this._activeComponent),D(this._imageContainer);const e=Dk(this._activeComponent);e.page.captureSync();const{width:n,height:i}=this._imageContainer.getBoundingClientRect();e.page.updateBlock(e,{width:n/this._zoom,height:i/this._zoom})}}var Jae=Object.defineProperty,ele=Object.getOwnPropertyDescriptor,pu=(t,e,n,i)=>{for(var r=i>1?void 0:i?ele(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Jae(e,n,r),r};let Ha=class extends wn{constructor(){super(...arguments),this._focused=!1,this._isDragging=!1}connectedCallback(){super.connectedCallback(),this._bindKeymap(),this._handleSelection(),this._observeDrag()}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{this._caption=this.model?.caption??"",this._caption.length>0&&this._input.classList.add("caption-show")}).catch(console.error),this.addEventListener("click",()=>{document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()})}_onInputChange(){this._caption=this._input.value,this.model.page.updateBlock(this.model,{caption:this._caption})}_onInputBlur(){this._caption||this._input.classList.remove("caption-show")}_observeDrag(){const t=new Qae;this._disposables.add(this.host.event.add("dragStart",e=>{const n=e.get("pointerState"),i=n.event.target;return fie(this,i)?(this._isDragging=!0,t.onStart(n),!0):!1})),this._disposables.add(this.host.event.add("dragMove",e=>{const n=e.get("pointerState");return this._isDragging?(t.onMove(n),!0):!1})),this._disposables.add(this.host.event.add("dragEnd",()=>this._isDragging?(this._isDragging=!1,t.onEnd(),!0):!1))}_handleSelection(){const t=this.host.selection;this._disposables.add(t.slots.changed.on(e=>{const n=e.find(i=>gt.equals(i.path,this.path)&&i.is("image"));this._focused=!!n})),this.handleEvent("click",()=>(t.update(e=>e.filter(n=>!["text","block","image"].includes(n.type)).concat(t.create("image",{path:this.path}))),!0)),this.handleEvent("click",()=>{this._focused&&t.update(e=>e.filter(n=>!(n.is("image")&&gt.equals(n.path,this.path))))},{global:!0})}_bindKeymap(){const t=this.host.selection,e=()=>{const n=this.page.getParent(this.model);if(!n)return;const i=n.children.indexOf(this.model),r=this.page.addBlock("affine:paragraph",{},n,i+1);requestAnimationFrame(()=>{t.update(o=>o.filter(s=>!s.is("image")).concat(t.create("text",{from:{path:this.parentPath.concat(r),index:0,length:0},to:null})))})};this.bindHotKey({Escape:()=>(t.update(n=>n.map(i=>i.is("image")&&gt.equals(i.path,this.path)?t.create("block",{path:this.path}):i)),!0),Delete:()=>{if(this._focused)return e(),this.page.deleteBlock(this.model),!0},Backspace:()=>{if(this._focused)return e(),this.page.deleteBlock(this.model),!0},Enter:()=>{if(this._focused)return e(),!0}})}_imageResizeBoardTemplate(){if(!this._focused)return null;const e=this.model.page.readonly;return Xae(e)}_normalizeImageSize(){if(this._isDragging&&this.resizeImg)return{width:this.resizeImg.style.width,height:this.resizeImg.style.height};const{width:t,height:e}=this.model;return!t||!e||t===0||e===0?{width:"unset",height:"unset"}:{width:`${t}px`,height:`${e}px`}}_onCaptionKeydown(t){if(t.stopPropagation(),this.std.event.activate(),!t.isComposing&&t.key==="Enter"){t.preventDefault();const e=this.model,n=e.page,i=t.target,r=i.selectionStart;if(r===null)return;const o=i.value,s=this._caption=o.slice(0,r);i.value=s,n.updateBlock(e,{caption:s});const a=o.slice(r),l=n.getParent(e);if(!l)return;const c=l.children.indexOf(e),d=n.addBlock("affine:paragraph",{text:new Oi(a)},l,c+1);$n(this.host,e.page,d)?.catch(console.error)}}renderBlock(){const t=this._normalizeImageSize();return b`
      <div style="position: relative;">
        <div class="affine-image-wrapper">
          <div class="resizable-img" style=${we(t)}>
            <img src=${this.source} draggable="false" />
            ${this._imageResizeBoardTemplate()}
          </div>
        </div>
        ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:null}
      </div>

      <div class="affine-embed-block-container">
        <div class="affine-embed-wrapper">
          <input
            .disabled=${this.model.page.readonly}
            placeholder="Write a caption"
            class="affine-embed-wrapper-caption"
            value=${this._caption}
            @input=${this._onInputChange}
            @blur=${this._onInputBlur}
            @click=${at}
            @keydown=${this._onCaptionKeydown}
            @keyup=${at}
            @pointerdown=${at}
            @pointerup=${at}
            @pointermove=${at}
            @paste=${at}
            @cut=${at}
            @copy=${at}
          />
        </div>
      </div>
      ${Object.values(this.widgets)}
    `}};Ha.styles=X`
    affine-image {
      display: block;
    }

    .affine-embed-wrapper {
      text-align: center;
      margin-bottom: 18px;
    }

    .affine-embed-wrapper-caption {
      width: 100%;
      font-size: var(--affine-font-sm);
      outline: none;
      border: 0;
      font-family: inherit;
      text-align: center;
      color: var(--affine-icon-color);
      display: none;
      background: transparent;
    }

    .affine-embed-wrapper-caption::placeholder {
      color: var(--affine-placeholder-color);
    }

    .affine-embed-wrapper .caption-show {
      display: inline-block;
    }

    .affine-image-wrapper {
      padding: 8px;
      width: 100%;
      text-align: center;
      line-height: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: 18px;
    }

    .affine-image-wrapper img {
      max-width: 100%;
      margin: auto;
      width: 100%;
    }

    .resizable-img {
      position: relative;
      border-radius: 8px;
      cursor: pointer;
    }

    .resizable-img img {
      width: 100%;
    }
  `;pu([L()],Ha.prototype,"source",2);pu([he("input")],Ha.prototype,"_input",2);pu([he(".resizable-img")],Ha.prototype,"resizeImg",2);pu([ie()],Ha.prototype,"_caption",2);pu([ie()],Ha.prototype,"_focused",2);Ha=pu([W("affine-page-image")],Ha);var tle=Object.defineProperty,nle=Object.getOwnPropertyDescriptor,YP=(t,e,n,i)=>{for(var r=i>1?void 0:i?nle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&tle(e,n,r),r};let j8=class extends wn{get edgeless(){return this.host.querySelector("affine-edgeless-page")}renderBlock(){const t=ne.deserialize((this.edgeless?.service.getElementById(this.model.id)??this.model).xywh);return b`<img
      style=${we({transform:`rotate(${this.model.rotate}deg)`,transformOrigin:"center"})}
      src=${this.source}
      draggable="false"
      width="${t.w}px"
      height="${t.h}px"
    />`}};YP([L()],j8.prototype,"source",2);j8=YP([W("affine-edgeless-image")],j8);var ile=Object.defineProperty,rle=Object.getOwnPropertyDescriptor,e4=(t,e,n,i)=>{for(var r=i>1?void 0:i?rle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ile(e,n,r),r};const ole=3;let _d=class extends wn{constructor(){super(...arguments),this._imageState=ls.Loading,this._isInSurface=!1,this._lastSourceId="",this._source="",this._retryCount=0,this._fetchImage=()=>{if(P8(this.model.id)){this._retryCount=0;return}if(!this.model.sourceId){this._imageState=ls.Failed;return}if(this._imageState===ls.Ready&&this._lastSourceId&&this._lastSourceId===this.model.sourceId)return;this._imageState=ls.Loading;const t=this.model.page.blob,e=this.model.sourceId;t.get(e).then(n=>{if(n)this.blob=n,this._source=URL.createObjectURL(n),this._lastSourceId=e,this._imageState=ls.Ready;else throw new Error("Cannot find blob")}).catch(n=>{this._retryCount++,console.warn("Cannot find blob, retrying",this._retryCount),this._retryCount<ole?setTimeout(()=>{this._fetchImage()},1e3*this._retryCount):(console.error(n),this._imageState=ls.Failed)})},this._dragHandleOption={flavour:I1.model.flavour,edgeless:!0,onDragStart:({state:t,startDragging:e,anchorBlockPath:n})=>{const i=jn(t.raw.target);if(i?.classList.contains("resize")||!n)return!1;const r=this.std.view.viewFromPath("block",n);if(!r||!Ie(r.model,[I1.model.flavour]))return!1;const o=r,s=!!i?.closest(wr),a=o.contains(i),l=o.isInSurface;if(!l&&(s||a))return this.std.selection.setGroup("note",[this.std.selection.create("block",{path:o.path})]),e([o],t),!0;if(l&&s){const c=Um(o),d=c?c.service.viewport.zoom:1,u=o.getBoundingClientRect().width,h=document.createElement("div");return h.classList.add("affine-block-element"),h.style.border="2px solid var(--affine-border-color)",h.style.borderRadius="4px",h.style.overflow="hidden",h.style.width=`${u/d}px`,Qa(o.renderModel(o.model),h),e([o],t,h),!0}return!1},onDragEnd:t=>{const{state:e,draggingElements:n}=t;if(n.length!==1||!Ie(n[0].model,[I1.model.flavour]))return!1;const i=n[0],r=i.isInSurface,o=jn(e.raw.target),s=o?.classList.contains("edgeless")&&o?.classList.contains("affine-block-children-container");return r?Db({blockComponent:i,...t}):s?Bb({blockComponent:i,cssSelector:"img",...t}):!1}}}get isInSurface(){return this._isInSurface}get resizeImg(){return this._pageImage.resizeImg}_onCardClick(t){t.stopPropagation();const e=this.host.selection;e.setGroup("note",[e.create("block",{path:this.path})])}connectedCallback(){super.connectedCallback(),this.contentEditable="false",this.disposables.add(ri.registerOption(this._dragHandleOption));const t=this.host.page.getParent(this.model);this._isInSurface=t?.flavour==="affine:surface",this._fetchImage(),this.model.propsUpdated.on(({key:e})=>{e==="sourceId"&&(this._source&&(URL.revokeObjectURL(this._source),this._source=""),this._retryCount=0,this._fetchImage())})}disconnectedCallback(){this._source&&URL.revokeObjectURL(this._source),super.disconnectedCallback()}renderBlock(){const t=P8(this.model.id)?ls.Loading:this._imageState;return t!==ls.Ready?b`<affine-image-block-card
        imageState=${t}
        ?isinsurface=${this.isInSurface}
        imageSize=${dk(this.model.size)}
        @click=${this._onCardClick}
      ></affine-image-block-card>`:this.isInSurface?b`<affine-edgeless-image
        .model=${this.model}
        .page=${this.page}
        .host=${this.host}
        .widgets=${this.widgets}
        source=${this._source}
      ></affine-edgeless-image>`:b`<affine-page-image
        .model=${this.model}
        .page=${this.page}
        .host=${this.host}
        .widgets=${this.widgets}
        source=${this._source}
      ></affine-page-image>`}};e4([he("affine-page-image")],_d.prototype,"_pageImage",2);e4([he("affine-edgeless-image")],_d.prototype,"_edgelessImage",2);e4([ie()],_d.prototype,"_imageState",2);_d=e4([W("affine-image")],_d);const sle=t=>({type:"union",title:"union",list:t}),gi=t=>({type:"array",title:"array",ele:t}),XP=t=>t.type==="array",w1=(t,e)=>({type:"typeVar",title:"typeVar",name:t,bound:e}),gr=t=>({type:"typeRef",title:"typeRef",name:t}),It=t=>({type:"function",title:"function",typeVars:t.typeVars??[],args:t.args,rt:t.rt});class ale{constructor(e,n){this.config=e,this.dataMap=n}create(e){return{type:"data",name:this.config.name,data:e}}is(e){return e.type!=="data"?!1:e.name===this.config.name}isByName(e){return e===this.config.name}isSubOf(e){return this.is(e)?!0:this.config.supers.some(n=>n.isSubOf(e))}isSubOfByName(e){return this.isByName(e)?!0:this.config.supers.some(n=>n.isSubOfByName(e))}isSuperOf(e){const n=this.dataMap.get(e.name);if(!n)throw new Error("bug");return n.isSubOfByName(this.config.name)}}const KP=(...t)=>({create(e){return{name:e,supers:t}},extends(e){return KP(...t,e)}}),lle=KP();class cle{constructor(){this.dataMap=new Map}defineData(e){const n=new ale(e,this.dataMap);return this.dataMap.set(e.name,n),n}isDataType(e){return e.type==="data"}isSubtype(e,n,i){if(e.type==="typeRef")return i&&n.type!="typeRef"&&(i[e.name]=n),!0;if(n.type==="typeRef")return i&&(i[n.name]=e),!0;if(k5.is(e))return!0;if(e.type==="union")return e.list.some(r=>this.isSubtype(r,n,i));if(n.type==="union")return n.list.every(r=>this.isSubtype(e,r,i));if(this.isDataType(n)){const r=this.dataMap.get(n.name);if(!r)throw new Error("bug");return this.isDataType(e)?r.isSubOf(e):!1}return e.type==="array"||n.type==="array"?e.type!=="array"||n.type!=="array"?!1:this.isSubtype(e.ele,n.ele,i):!1}subst(e,n){const i=o=>{if(this.isDataType(o))return o;switch(o.type){case"typeRef":return{...e[o.name]};case"union":return sle(o.list.map(s=>i(s)));case"array":return gi(i(o.ele));case"function":throw new Error("TODO")}};return It({args:n.args.map(o=>i(o)),rt:i(n.rt)})}instance(e,n,i,r){const o={...e};return r.args.forEach((s,a)=>{const l=n[a];l&&this.isSubtype(s,l,o)}),this.isSubtype(i,r.rt),this.subst(o,r)}}const Hn=new cle,k5=Hn.defineData(lle.create("Unknown")),an=Hn.defineData({name:"Number",supers:[]}),ln=Hn.defineData({name:"String",supers:[]}),kv=Hn.defineData({name:"RichText",supers:[ln]}),Pt=Hn.defineData({name:"Boolean",supers:[]}),vs=Hn.defineData({name:"Date",supers:[]});Hn.defineData({name:"URL",supers:[ln]});const dle=Hn.defineData({name:"Image",supers:[]});Hn.defineData({name:"Email",supers:[ln]});Hn.defineData({name:"Phone",supers:[ln]});const Sn=Hn.defineData({name:"Tag",supers:[]});class ule{constructor(){this.map=new Map}getColumn(e){const n=this.map.get(e);if(!n)throw new Error(`${e} is not exist`);return n}register(e,n){const i=new hle(e,n);return this.map.set(e,i),i}}class hle{constructor(e,n){this.type=e,this.ops=n,this.convertMap=new Map}create(e,n){return{type:this.type,name:e,data:n??this.ops.defaultData()}}defaultData(){return this.ops.defaultData()}createWithId(e,n,i){return{id:e,type:this.type,name:n,data:i??this.ops.defaultData()}}dataType(e){return this.ops.type(e)}toString(e,n){return this.ops.cellToString(e,n)}toJson(e,n){return this.ops.cellToJson(e,n)}formatValue(e,n){return e===void 0?void 0:this.ops.formatValue?.(e,n)??e}fromString(e,n){return this.ops.cellFromString(e,n)}convertCell(e,n,i){return this.convertMap.get(e)?.(n,i)}registerConvert(e,n){this.convertMap.set(e,n)}get name(){return this.ops.name}}const Gt=new ule,Ev=Gt.register("checkbox",{name:"Checkbox",type:()=>Pt.create(),defaultData:()=>({}),cellToString:t=>t?"True":"False",cellFromString:t=>({value:t!=="False"}),cellToJson:t=>t??null}),Sv=Gt.register("date",{name:"Date",type:()=>vs.create(),defaultData:()=>({}),cellToString:t=>t?.toString()??"",cellFromString:t=>({value:!isNaN(Date.parse(t))?+new Date(t):null}),cellToJson:t=>t??null}),Tv=Gt.register("link",{name:"Link",type:()=>ln.create(),defaultData:()=>({}),cellToString:t=>t?.toString()??"",cellFromString:t=>({value:t}),cellToJson:t=>t??null});var ple=Object.defineProperty,fle=Object.getOwnPropertyDescriptor,t4=(t,e,n,i)=>{for(var r=i>1?void 0:i?fle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ple(e,n,r),r};let Cd=class extends me(De){constructor(){super(...arguments),this.value=[],this.options=[]}render(){const t=this.value,e=new Map(this.options?.map(n=>[n.id,n]));return Be`
      <div contenteditable="false" class="affine-select-cell-container">
        ${Fe(t,n=>{const i=e.get(n);if(!i)return;const r=we({backgroundColor:i.color});return Be`<span class="select-selected" style=${r}
            >${i.value}</span
          >`})}
      </div>
    `}};Cd.styles=X`
    affine-multi-tag-view {
      display: flex;
      align-items: center;
      width: 100%;
      height: 100%;
      min-height: 22px;
    }

    .affine-select-cell-container * {
      box-sizing: border-box;
    }

    .affine-select-cell-container {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
      width: 100%;
      font-size: var(--affine-font-sm);
    }

    .affine-select-cell-container .select-selected {
      height: 22px;
      font-size: 14px;
      line-height: 22px;
      padding: 0 8px;
      border-radius: 4px;
      white-space: nowrap;
      background: var(--affine-tag-white);
      overflow: hidden;
      text-overflow: ellipsis;
    }
  `;t4([he(".affine-select-cell-container")],Cd.prototype,"selectContainer",2);t4([L({attribute:!1})],Cd.prototype,"value",2);t4([L({attribute:!1})],Cd.prototype,"options",2);Cd=t4([W("affine-multi-tag-view")],Cd);const yp=(t,e)=>(n,i)=>{const r=t(n,e(i));return{unmount:r.unmount,update:o=>{r.update(e(o))},expose:r.expose}};var gle=Object.defineProperty,mle=Object.getOwnPropertyDescriptor,ul=(t,e,n,i)=>{for(var r=i>1?void 0:i?mle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&gle(e,n,r),r};const oi=(t,e,n)=>b` <uni-lit
    .uni="${t}"
    .props="${e}"
    .ref="${n?.ref}"
    style=${n?.style?we(n?.style):""}
  ></uni-lit>`;let kd=class extends De{get expose(){return this.uniReturn?.expose}mount(){this.uniReturn=this.uni?.(this,this.props),this.ref&&(this.ref.value=this.uniReturn?.expose)}unmount(){this.uniReturn?.unmount()}connectedCallback(){super.connectedCallback(),this.mount()}disconnectedCallback(){super.disconnectedCallback(),this.unmount()}updated(t){super.updated(t),t.has("uni")?(this.unmount(),this.mount()):t.has("props")&&this.uniReturn?.update(this.props)}render(){return b``}};kd.styles=X`
    uni-lit {
      display: contents;
    }
  `;ul([L({attribute:!1})],kd.prototype,"uni",2);ul([L({attribute:!1})],kd.prototype,"props",2);ul([L({attribute:!1})],kd.prototype,"ref",2);kd=ul([W("uni-lit")],kd);const Zt=t=>(e,n)=>{const i=new t;return Object.assign(i,n),e.appendChild(i),{update:r=>{Object.assign(i,r)},unmount:()=>{i.remove()},expose:i}};let Ed=class extends De{render(){return this.renderTemplate(this.props,this.expose)}};ul([L({attribute:!1})],Ed.prototype,"props",2);ul([L({attribute:!1})],Ed.prototype,"expose",2);ul([L({attribute:!1})],Ed.prototype,"renderTemplate",2);Ed=ul([W("uni-any-render")],Ed);const ble=t=>(e,n)=>{const i=new Ed;return i.props=n,i.expose={},i.renderTemplate=t,e.appendChild(i),{update:r=>{i.props=r},unmount:()=>{i.remove()},expose:i.expose}};var vle=Object.defineProperty,yle=Object.getOwnPropertyDescriptor,QP=(t,e,n,i)=>{for(var r=i>1?void 0:i?yle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&vle(e,n,r),r};let wp=class extends De{render(){return b`${kX[this.name]}`}};wp.styles=X`
    affine-lit-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    affine-lit-icon svg {
      fill: var(--affine-icon-color);
    }
  `;QP([L({attribute:!1})],wp.prototype,"name",2);wp=QP([W("affine-lit-icon")],wp);const wle=Zt(wp),Mr=t=>yp(wle,()=>({name:t}));var xle=Object.defineProperty,_le=Object.getOwnPropertyDescriptor,H0=(t,e,n,i)=>{for(var r=i>1?void 0:i?_le(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&xle(e,n,r),r};class on extends me(De){get readonly(){return this.column.readonly}get value(){return this.column.getValue(this.rowId)}onChange(e){this.column.setValue(this.rowId,e)}beforeEnterEditMode(){return!0}onEnterEditMode(){}onExitEditMode(){}focusCell(){return!0}blurCell(){return!0}connectedCallback(){super.connectedCallback(),this.style.width="100%",this._disposables.addFromEvent(this,"click",n=>{this.isEditing&&n.stopPropagation()});const e=this.column.type;this._disposables.add(this.column.onCellUpdate(this.rowId,()=>{this.column.type===e&&this.requestUpdate()})),this._disposables.addFromEvent(this,"copy",n=>{this.isEditing&&(n.stopPropagation(),this.onCopy(n))}),this._disposables.addFromEvent(this,"cut",n=>{this.isEditing&&(n.stopPropagation(),this.onCut(n))}),this._disposables.addFromEvent(this,"paste",n=>{this.isEditing&&(n.stopPropagation(),this.onPaste(n))})}forceUpdate(){this.requestUpdate()}onCopy(e){}onCut(e){}onPaste(e){}}H0([L({attribute:!1})],on.prototype,"view",2);H0([L({attribute:!1})],on.prototype,"column",2);H0([L()],on.prototype,"rowId",2);H0([L({attribute:!1})],on.prototype,"isEditing",2);H0([L({attribute:!1})],on.prototype,"selectCurrentCell",2);class Cle{constructor(){this._columns=new Map}register(e){const n=this._columns;if(n.has(e.type))throw new Error("cannot register twice for "+e.type);n.set(e.type,e)}get(e){const n=this._columns.get(e);if(!n)throw new Error(`cannot find renderer of ${e}`);return n}list(){return Array.from(this._columns.values())}}const sr=new Cle,tn=t=>Zt(t),JP="multi-select",hl=Gt.register(JP,{name:"Multi-select",type:t=>gi(Sn.create({tags:t.options})),defaultData:()=>({options:[]}),addGroup:(t,e)=>({options:[...e.options,{id:Oe(),value:t,color:Wr()}]}),formatValue:t=>Array.isArray(t)?t.filter(e=>e!=null):[],cellToString:(t,e)=>t?.map(n=>e.options.find(i=>i.id===n)?.value).join(" "),cellFromString:(t,e)=>{const n=Object.fromEntries(e.options.map(o=>[o.value,o])),i=t.split(",").map(o=>o.trim()).filter(o=>o),r=[];return i.forEach(o=>{if(n[o])r.push(n[o].id);else{const s={id:Oe(),value:o,color:Wr()};e.options.push(s),r.push(s.id)}}),{value:r,data:e}},cellToJson:t=>t??null});hl.registerConvert("select",(t,e)=>({column:t,cells:e.map(n=>n?.[0])}));hl.registerConvert("rich-text",(t,e)=>{const n=Object.fromEntries(t.options.map(i=>[i.id,i]));return{column:{},cells:e.map(i=>new Oi(i?.map(r=>n[r]?.value??"").join(",")).yText)}});var kle=Object.defineProperty,Ele=Object.getOwnPropertyDescriptor,eA=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ele(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&kle(e,n,r),r};let G8=class extends on{render(){return Be`
      <affine-multi-tag-view
        .value="${this.value??[]}"
        .options="${this.column.data.options}"
      ></affine-multi-tag-view>
    `}};G8=eA([W("affine-database-multi-select-cell")],G8);let Z8=class extends on{constructor(){super(...arguments),this._onChange=t=>{this.onChange(t)},this._editComplete=()=>{this.selectCurrentCell(!1)},this._onOptionsChange=t=>{this.column.updateData(e=>({...e,options:t}))},this.popTagSelect=()=>{this._disposables.add({dispose:Z3(this.querySelector("affine-multi-tag-view")??this,{options:this._options,onOptionsChange:this._onOptionsChange,value:this._value,onChange:this._onChange,onComplete:this._editComplete,minWidth:400})})}}get _options(){return this.column.data.options}get _value(){return this.value??[]}firstUpdated(){this.popTagSelect()}render(){return Be`
      <affine-multi-tag-view
        .value="${this._value}"
        .options="${this._options}"
      ></affine-multi-tag-view>
    `}};Z8=eA([W("affine-database-multi-select-cell-editing")],Z8);sr.register({type:hl.type,icon:Mr("DatabaseMultiSelect"),cellRenderer:{view:tn(G8),edit:tn(Z8)}});const tA=hl,nA="select",fu=Gt.register(nA,{name:"Select",type:t=>Sn.create({tags:t.options}),defaultData:()=>({options:[]}),addGroup:(t,e)=>({options:[...e.options,{id:Oe(),value:t,color:Wr()}]}),cellToString:(t,e)=>e.options.find(n=>n.id===t)?.value??"",cellFromString:(t,e)=>{if(!t)return{value:null,data:e};const n=Object.fromEntries(e.options.map(s=>[s.value,s])),i=t.split(",").map(s=>s.trim()).filter(s=>s)[0];let r=null;const o=n[i];if(o)r=o.id;else{const s={id:Oe(),value:i,color:Wr()};e.options.push(s),r=s.id}return{value:r,data:e}},cellToJson:t=>t??null});fu.registerConvert("multi-select",(t,e)=>({column:t,cells:e.map(n=>n?[n]:void 0)}));fu.registerConvert("rich-text",(t,e)=>{const n=Object.fromEntries(t.options.map(i=>[i.id,i]));return{column:{},cells:e.map(i=>new Oi(i?n[i]?.value:"").yText)}});const n4="rich-text",i4=Gt.register(n4,{name:"Text",type:()=>kv.create(),defaultData:()=>({}),cellToString:t=>t?.toString()??"",cellFromString:t=>({value:t}),cellToJson:t=>t?.toString()??null});i4.registerConvert(nA,(t,e)=>{const n={},i=r=>{if(n[r])return n[r];const o={id:Oe(),value:r,color:Wr()};return n[r]=o,o};return{cells:e.map(r=>{const s=r?.toString().split(",")?.[0]?.trim();if(s)return i(s).id}),column:{options:Object.values(n)}}});i4.registerConvert(JP,(t,e)=>{const n={},i=r=>{if(n[r])return n[r];const o={id:Oe(),value:r,color:Wr()};return n[r]=o,o};return{cells:e.map(r=>{const o=[];return r?.toString().split(",")?.forEach(a=>{a=a.trim(),a&&o.push(i(a).id)}),o}),column:{options:Object.values(n)}}});const Sle="number",F0=Gt.register(Sle,{name:"Number",type:()=>an.create(),defaultData:()=>({decimal:0}),cellToString:t=>t?.toString()??"",cellFromString:t=>{const e=t?Number(t):NaN;return{value:isNaN(e)?null:e}},cellToJson:t=>t??null});F0.registerConvert(n4,(t,e)=>({column:{},cells:e.map(n=>new Oi(n?.toString()).yText)}));const Tle="progress",r4=Gt.register(Tle,{name:"Progress",type:()=>an.create(),defaultData:()=>({}),cellToString:t=>t?.toString()??"",cellFromString:t=>{const e=t?Number(t):NaN;return{value:isNaN(e)?null:e}},cellToJson:t=>t??null});r4.registerConvert(n4,(t,e)=>({column:{},cells:e.map(n=>new Oi(n?.toString()).yText)}));class o4{constructor(e=Hn.isSubtype.bind(Hn)){this._match=e,this.list=[]}register(e,n){this.list.push({type:e,data:n})}match(e){for(const n of this.list)if(this._match(n.type,e))return n.data}allMatched(e){const n=[];for(const i of this.list)this._match(i.type,e)&&n.push(i);return n}allMatchedData(e){const n=[];for(const i of this.list)this._match(i.type,e)&&n.push(i.data);return n}findData(e){return this.list.find(n=>e(n.data))?.data}find(e){return this.list.find(e)}all(){return this.list}isMatched(e,n){return this._match(e,n)}}const _r=new o4;var Ile=Object.defineProperty,Lle=Object.getOwnPropertyDescriptor,U0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Lle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ile(e,n,r),r};class pl extends me(De){}U0([L({attribute:!1})],pl.prototype,"data",2);U0([L({attribute:!1})],pl.prototype,"updateData",2);U0([L({attribute:!1})],pl.prototype,"value",2);U0([L({attribute:!1})],pl.prototype,"updateValue",2);U0([L({attribute:!1})],pl.prototype,"readonly",2);var Mle=Object.defineProperty,Ple=Object.getOwnPropertyDescriptor,Ale=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ple(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Mle(e,n,r),r};let E5=class extends pl{constructor(){super(...arguments),this._click=()=>{this.readonly||hn(this,{options:{input:{initValue:this.value?`${this.value*10}`:"",onComplete:t=>{const e=Number.parseFloat(t);Number.isNaN(e)||this.updateValue?.(e)}},items:[]}})}}render(){return this.value==null?b` <div>Ungroups</div>`:this.value>=10?b` <div
        @click="${this._click}"
        class="data-view-group-title-number-view"
      >
        >= 100
      </div>`:b` <div
      @click="${this._click}"
      class="data-view-group-title-number-view"
    >
      ${this.value*10} - ${this.value*10+9}
    </div>`}};E5.styles=X`
    .data-view-group-title-number-view {
      border-radius: 8px;
      padding: 4px 8px;
      width: max-content;
      cursor: pointer;
    }

    .data-view-group-title-number-view:hover {
      background-color: var(--affine-hover-color);
    }
  `;E5=Ale([W("data-view-group-title-number-view")],E5);var $le=Object.defineProperty,Ble=Object.getOwnPropertyDescriptor,Dle=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ble(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&$le(e,n,r),r};let xp=class extends pl{constructor(){super(...arguments),this._click=()=>{this.readonly||hn(this,{options:{input:{initValue:this.tag?.value??"",onComplete:t=>{this.updateTag({value:t})}},items:m9.map(({color:t,name:e})=>{const n=we({backgroundColor:t,borderRadius:"50%",width:"20px",height:"20px"});return{type:"action",name:e,isSelected:this.tag?.color===t,icon:b` <div style=${n}></div>`,select:()=>{this.updateTag({color:t})}}})}})}}get tag(){return this.data.options.find(t=>t.id===this.value)}updateTag(t){this.updateData?.({...this.data,options:this.data.options.map(e=>e.id===this.value?{...e,...t}:e)})}render(){const t=this.tag;if(!t)return b` <div
        style="font-size: 14px;color: var(--affine-text-primary-color);line-height: 22px;"
      >
        Ungroups
      </div>`;const e=we({backgroundColor:t.color}),n=Qe({"data-view-group-title-select-view":!0,readonly:this.readonly});return b` <div @click="${this._click}" class="${n}">
      <div class="tag" style="${e}">${t.value}</div>
    </div>`}};xp.styles=X`
    data-view-group-title-select-view {
      overflow: hidden;
    }
    .data-view-group-title-select-view {
      width: 100%;
      cursor: pointer;
    }

    .data-view-group-title-select-view.readonly {
      cursor: inherit;
    }

    .tag {
      padding: 0 8px;
      border-radius: 4px;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  `;xp=Dle([W("data-view-group-title-select-view")],xp);var Ole=Object.defineProperty,Rle=Object.getOwnPropertyDescriptor,Nle=(t,e,n,i)=>{for(var r=i>1?void 0:i?Rle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ole(e,n,r),r};let S5=class extends pl{constructor(){super(...arguments),this._click=()=>{this.readonly||hn(this,{options:{input:{initValue:this.value??"",onComplete:t=>{this.updateValue?.(t)}},items:[]}})}}render(){return this.value?b` <div
      @click="${this._click}"
      class="data-view-group-title-string-view"
    >
      ${this.value}
    </div>`:b` <div>Ungroups</div>`}};S5.styles=X`
    .data-view-group-title-string-view {
      border-radius: 8px;
      padding: 4px 8px;
      width: max-content;
      cursor: pointer;
    }

    .data-view-group-title-string-view:hover {
      background-color: var(--affine-hover-color);
    }
  `;S5=Nle([W("data-view-group-title-string-view")],S5);const Gr={key:"Ungroups",value:null};_r.register(Sn.create(),{name:"select",groupName:(t,e)=>Sn.is(t)&&t.data?t.data.tags.find(n=>n.id===e)?.value??"":"",defaultKeys:t=>Sn.is(t)&&t.data?[Gr,...t.data.tags.map(e=>({key:e.id,value:e.id}))]:[Gr],valuesGroup:(t,e)=>t==null?[Gr]:[{key:`${t}`,value:t}],view:Zt(xp)});_r.register(gi(Sn.create()),{name:"multi-select",groupName:(t,e)=>Sn.is(t)&&t.data?t.data.tags.find(n=>n.id===e)?.value??"":"",defaultKeys:t=>XP(t)&&Sn.is(t.ele)&&t.ele.data?[Gr,...t.ele.data.tags.map(e=>({key:e.id,value:e.id}))]:[Gr],valuesGroup:(t,e)=>t==null?[Gr]:Array.isArray(t)&&t.length?t.map(n=>({key:`${n}`,value:n})):[Gr],addToGroup:(t,e)=>t==null?e:Array.isArray(e)?[...e,t]:[t],removeFromGroup:(t,e)=>Array.isArray(e)?e.filter(n=>n!==t):e,view:Zt(xp)});_r.register(ln.create(),{name:"text",groupName:(t,e)=>`${e??""}`,defaultKeys:t=>[Gr],valuesGroup:(t,e)=>t?[{key:`g:${t}`,value:t}]:[Gr],view:Zt(S5)});_r.register(an.create(),{name:"number",groupName:(t,e)=>`${e??""}`,defaultKeys:t=>[Gr],valuesGroup:(t,e)=>typeof t!="number"?[Gr]:[{key:`g:${Math.floor(t/10)}`,value:Math.floor(t/10)}],addToGroup:t=>typeof t=="number"?t*10:void 0,view:Zt(E5)});class Hle{constructor(){this.map=new Map}getView(e){const n=this.map.get(e);if(!n)throw new Error(`${e} is not exist`);return n}register(e,n){this.map.set(e,{...n,type:e})}get all(){return Array.from(this.map.values())}}const _p=new Hle;class Fle{constructor(){this.map=new Map}getView(e){const n=this.map.get(e);if(!n)throw new Error(`${e} is not exist`);return n}register(e,n){this.map.set(e,{...n,type:e})}get all(){return Array.from(this.map.values())}}const fs=new Fle;var Ule=Object.defineProperty,Vle=Object.getOwnPropertyDescriptor,iA=(t,e,n,i)=>{for(var r=i>1?void 0:i?Vle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Ule(e,n,r),r};let T5=class extends me(De){get readonly(){return this.viewSource.readonly}_addViewMenu(t){Ui(t.target,_p.all.map(e=>({type:"action",name:e.defaultName,icon:b`<uni-lit
            .uni=${fs.getView(e.type).icon}
          ></uni-lit>`,select:()=>{const n=this.viewSource.viewAdd(e.type);this.viewSource.selectView(n)}})))}_showMore(t){const e=this.viewSource.views;Ui(t.target,[...e.map(n=>({type:"action",icon:b`<uni-lit
          .uni=${fs.getView(n.view.mode).icon}
        ></uni-lit>`,name:n.view.name,isSelected:this.viewSource.currentViewId===n.view.id,select:()=>{this.viewSource.selectView(n.view.id)}})),{type:"group",name:"",hide:()=>this.readonly,children:()=>_p.all.map(n=>({type:"action",name:`Create ${n.defaultName}`,icon:b`<uni-lit
                .uni=${fs.getView(n.type).icon}
              ></uni-lit>`,select:()=>{const i=this.viewSource.viewAdd(n.type);this.viewSource.selectView(i)}}))}])}_clickView(t,e){if(this.viewSource.currentViewId!==e){this.viewSource.selectView(e);return}if(this.readonly)return;const n=this.viewSource.views,i=n.findIndex(o=>o.view.id===e),r=n[i];r&&hn(t.target,{options:{input:{initValue:r.view.name,onComplete:o=>{r.updateView(s=>({name:o}))}},items:[{type:"action",name:"Edit View",icon:oi(fs.getView(r.view.mode).icon,{}),select:()=>{this.closest("affine-data-view-native")?.querySelector("data-view-header-tools-view-options")?.clickMoreAction(t)}},{type:"action",name:"Move Left",hide:()=>i===0,icon:y3,select:()=>{const o=n[i-1];this.viewSource.moveTo(r.view.id,o?{before:!0,id:o.view.id}:"start")}},{type:"action",name:"Move Right",icon:w3,hide:()=>i===n.length-1,select:()=>{const o=n[i+1];this.viewSource.moveTo(r.view.id,o?{before:!1,id:o.view.id}:"end")}},{type:"action",name:"Duplicate",icon:il,select:()=>{this.viewSource.duplicate(r.view.id)}},{type:"group",name:"",children:()=>[{type:"action",name:"Delete View",icon:xn,select:()=>{r.delete()},class:"delete-item"}]}]}})}connectedCallback(){super.connectedCallback(),this.disposables.add(this.viewSource.updateSlot.on(()=>{this.requestUpdate()}))}renderMore(){const t=this.viewSource.views;return t.length<=3?this.readonly?void 0:b`<div
        class="database-view-button dv-icon-16 dv-hover"
        @click="${this._addViewMenu}"
      >
        ${rl}
      </div>`:b`
      <div class="database-view-button dv-hover" @click="${this._showMore}">
        ${t.length-3} More
      </div>
    `}render(){const t=this.viewSource.views,e=t.findIndex(i=>i.view.id===this.viewSource.currentViewId),n=e>2?[...t.slice(0,2),t[e]]:t.slice(0,3);return b`
      ${Fe(n,i=>i.view.id,i=>{const r=Qe({"database-view-button":!0,"dv-hover":!0,active:this.viewSource.currentViewId===i.view.id});return b` <div
            class="${r}"
            @click="${o=>this._clickView(o,i.view.id)}"
          >
            <uni-lit
              class="icon"
              .uni="${fs.getView(i.view.mode).icon}"
            ></uni-lit>
            <div class="name">${i.view.name}</div>
          </div>`})}
      ${this.renderMore()}
    `}};T5.styles=X`
    data-view-header-views {
      height: 32px;
      display: flex;
      user-select: none;
      gap: 4px;
    }
    data-view-header-views::-webkit-scrollbar-thumb {
      width: 1px;
    }

    .database-view-button {
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 14px;
      display: flex;
      align-items: center;
      color: var(--affine-text-secondary-color);
      white-space: nowrap;
    }

    .database-view-button .name {
      display: flex;
      align-items: center;
      height: 22px;
      max-width: 100px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .database-view-button .icon {
      margin-right: 6px;
      display: block;
    }

    .database-view-button .icon svg {
      width: 16px;
      height: 16px;
    }

    .database-view-button.active {
      color: var(--affine-text-primary-color);
      background-color: var(--affine-hover-color-filled);
    }
  `;iA([L({attribute:!1})],T5.prototype,"viewSource",2);T5=iA([W("data-view-header-views")],T5);var zle=Object.defineProperty,jle=Object.getOwnPropertyDescriptor,Fc=(t,e,n,i)=>{for(var r=i>1?void 0:i?jle(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&zle(e,n,r),r};let Fs=class extends me(De){constructor(){super(...arguments),this.isComposing=!1,this._onKeyDown=t=>{if(t.key==="Enter"&&!t.isComposing){t.preventDefault(),this.onPressEnterKey?.();return}},this.isActive=!1}get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}get topContenteditableElement(){const t=this.closest("affine-database");return D(t),t.topContenteditableElement}firstUpdated(){this.titleText.yText.observe(()=>{this.requestUpdate()}),this.updateComplete.then(()=>{this.disposables.add(this.inlineEditor.slots.keydown.on(this._onKeyDown)),this.disposables.add(this.inlineEditor.slots.inputting.on(()=>{this.isComposing=this.inlineEditor.isComposing}));let t=null;this.disposables.add(this.inlineEditor.slots.inlineRangeUpdate.on(([e])=>{e?t||(this.isActive=!0):t&&(this.isActive=!1),t=e}))}).catch(console.error)}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this.richText?.updateComplete,t}render(){const t=(!this.titleText||!this.titleText.length)&&!this.isComposing,e=Qe({"database-title":!0,ellipsis:!this.isActive});return b`<div class="affine-database-title">
      <rich-text
        .yText=${this.titleText.yText}
        .inlineEventSource=${this.topContenteditableElement}
        .enableFormat=${!1}
        .readonly=${this.readonly}
        class="${e}"
        data-title-empty="${t}"
        data-title-focus="${this.isActive}"
        data-block-is-database-title="true"
        title="${this.titleText.toString()}"
      ></rich-text>
      <div class="database-title" style="float:left;height: 0;">Untitled</div>
    </div>`}};Fs.styles=X`
    .affine-database-title {
      position: relative;
      flex: 1;
    }

    .database-title {
      font-size: 20px;
      font-weight: 600;
      line-height: 28px;
      color: var(--affine-text-primary-color);
      font-family: inherit;
      /* overflow-x: scroll; */
      overflow: hidden;
      cursor: text;
    }

    .database-title [data-v-text='true'] {
      display: block;
      word-break: break-all !important;
    }

    .database-title.ellipsis [data-v-text='true'] {
      white-space: nowrap !important;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    .affine-database-title [data-title-empty='true']::before {
      content: 'Untitled';
      position: absolute;
      pointer-events: none;
      color: var(--affine-text-primary-color);
    }

    .affine-database-title [data-title-focus='true']::before {
      color: var(--affine-placeholder-color);
    }
  `;Fc([L({attribute:!1})],Fs.prototype,"titleText",2);Fc([L({attribute:!1})],Fs.prototype,"readonly",2);Fc([L({attribute:!1})],Fs.prototype,"onPressEnterKey",2);Fc([ie()],Fs.prototype,"isComposing",2);Fc([he("rich-text")],Fs.prototype,"richText",2);Fc([ie()],Fs.prototype,"isActive",2);Fs=Fc([W("affine-database-title")],Fs);const Uc=new o4((t,e)=>{if(t.type!=="function")return!1;const i=Hn.subst(Object.fromEntries(t.typeVars?.map(r=>[r.name,r.bound])??[]),t).args[0];return i&&Hn.isSubtype(i,e)});Uc.register(It({args:[ln.create()],rt:an.create()}),{name:"Length",impl:t=>typeof t!="string"?0:t.length});Uc.register(It({args:[vs.create()],rt:an.create()}),{name:"Day of month",impl:t=>typeof t!="number"?0:new Date(t).getDate()});Uc.register(It({args:[vs.create()],rt:an.create()}),{name:"Day of week",impl:t=>typeof t!="number"?0:new Date(t).getDay()});Uc.register(It({args:[vs.create()],rt:an.create()}),{name:"Month of year",impl:t=>typeof t!="number"?0:new Date(t).getMonth()+1});Uc.register(It({args:[gi(k5.create())],rt:an.create()}),{name:"Size",impl:t=>Array.isArray(t)?t.length:0});const Gle={isChecked:{type:It({args:[Pt.create()],rt:Pt.create()}),label:"Is checked",impl:t=>!!t},isUnchecked:{type:It({args:[Pt.create()],rt:Pt.create()}),label:"Is unchecked",impl:t=>!t}},Zle={before:{type:It({args:[vs.create(),vs.create()],rt:Pt.create()}),label:"Before",impl:(t,e)=>typeof t!="number"||typeof e!="number"?!0:t<e},after:{type:It({args:[vs.create(),vs.create()],rt:Pt.create()}),label:"After",impl:(t,e)=>typeof t!="number"||typeof e!="number"?!0:t>e}},Wle={containsAll:{type:It({typeVars:[w1("options",Sn.create())],args:[gi(gr("options")),gi(gr("options"))],rt:Pt.create()}),label:"Contains all",impl:(t,e)=>!Array.isArray(e)||!Array.isArray(t)||!e.length?!0:e.every(n=>t.includes(n))},containsOneOf:{type:It({typeVars:[w1("options",Sn.create())],args:[gi(gr("options")),gi(gr("options"))],rt:Pt.create()}),name:"containsOneOf",label:"Contains one of",impl:(t,e)=>!Array.isArray(e)||!Array.isArray(t)||!e.length?!0:e.some(n=>t.includes(n))},doesNotContainsOneOf:{type:It({typeVars:[w1("options",Sn.create())],args:[gi(gr("options")),gi(gr("options"))],rt:Pt.create()}),label:"Does not contains one of",impl:(t,e)=>!Array.isArray(e)||!Array.isArray(t)||!e.length?!0:e.every(n=>!t.includes(n))},doesNotContainsAll:{type:It({typeVars:[w1("options",Sn.create())],args:[gi(gr("options")),gi(gr("options"))],rt:Pt.create()}),label:"Does not contains all",impl:(t,e)=>!Array.isArray(e)||!Array.isArray(t)||!e.length?!0:!e.every(n=>t.includes(n))}},qle={greatThan:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:">",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t>e)},greatThanOrEqual:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:">=",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t>=e)},lessThan:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:"<",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t<e)},lessThanOrEqual:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:"<=",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t<=e)},equal:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:"==",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t==e)},notEqual:{type:It({args:[an.create(),an.create()],rt:Pt.create()}),label:"!=",impl:(t,e)=>(t=t??0,typeof t!="number"||typeof e!="number"?!0:t!=e)}},Yle={is:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Is",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:t==e},isNot:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Is not",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:t!=e},contains:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Contains",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:t.includes(e)},doesNoContains:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Does no contains",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:!t.includes(e)},startsWith:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Starts with",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:t.startsWith(e)},endsWith:{type:It({args:[ln.create(),ln.create()],rt:Pt.create()}),label:"Ends with",impl:(t,e)=>typeof t!="string"||typeof e!="string"||e===""?!0:t.endsWith(e)}},Xle={isOneOf:{type:It({typeVars:[w1("options",Sn.create())],args:[gr("options"),gi(gr("options"))],rt:Pt.create()}),label:"Is one of",impl:(t,e)=>!Array.isArray(e)||!e.length?!0:e.includes(t)},isNotOneOf:{type:It({typeVars:[w1("options",Sn.create())],args:[gr("options"),gi(gr("options"))],rt:Pt.create()}),label:"Is not one of",impl:(t,e)=>!Array.isArray(e)||!e.length?!0:!e.includes(t)}},Kle={isNotEmpty:{type:It({args:[k5.create()],rt:Pt.create()}),label:"Is not empty",impl:t=>Array.isArray(t)?t.length>0:typeof t=="string"?!!t:t!=null},isEmpty:{type:It({args:[k5.create()],rt:Pt.create()}),label:"Is empty",impl:t=>Array.isArray(t)?t.length===0:typeof t=="string"?!t:t==null}},M1=new o4((t,e)=>{if(t.type!=="function")return!1;const i=Hn.subst(Object.fromEntries(t.typeVars?.map(r=>[r.name,r.bound])??[]),t).args[0];return i&&Hn.isSubtype(i,e)}),Qle={...Zle,...Wle,...qle,...Yle,...Xle,...Gle,...Kle};Object.entries(Qle).forEach(([t,{type:e,...n}])=>{M1.register(e,{name:t,...n})});const W8=(t,e)=>e.type==="ref"?t.find(n=>n.id===e.name)?.type:Uc.find(n=>n.data.name===e.propertyFuncName)?.type.rt,rA=(t,e)=>{const n=W8(t,e);if(!n)throw new Error("can't resolve ref type");return M1.match(n)?.name},oA=(t,e)=>({type:"filter",left:e,function:rA(t,e),args:[]}),Iv=t=>{const e={type:"ref",name:t[0].id},n=rA(t,e);if(!n)throw new Error("can't match any filter");return{type:"filter",left:e,function:n,args:[]}},sA=t=>({type:"group",op:"and",conditions:[Iv(t)]});var Jle=Object.defineProperty,ece=Object.getOwnPropertyDescriptor,s4=(t,e,n,i)=>{for(var r=i>1?void 0:i?ece(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Jle(e,n,r),r};let Sd=class extends me(De){connectedCallback(){super.connectedCallback(),this.disposables.addFromEvent(this,"click",t=>{Ui(ws(t),this.vars.map(e=>({type:"action",name:e.name,icon:oi(e.icon,{}),select:()=>{this.setData({type:"ref",name:e.id})}})))})}get field(){if(this.data)return this.data.type==="ref"?this.data.name:this.data.ref.name}get fieldData(){const t=this.field;if(t)return this.vars.find(e=>e.id===t)}get property(){if(this.data&&this.data.type!=="ref")return this.data.propertyFuncName}render(){const t=this.fieldData;return b` ${oi(t?.icon,{})} ${t?.name} `}};Sd.styles=X`
    variable-ref-view {
      font-size: 12px;
      line-height: 20px;
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0 4px;
      border-radius: 4px;
      cursor: pointer;
    }

    variable-ref-view:hover {
      background-color: var(--affine-hover-color);
    }

    variable-ref-view svg {
      width: 16px;
      height: 16px;
      fill: var(--affine-icon-color);
      color: var(--affine-icon-color);
    }
  `;s4([L({attribute:!1})],Sd.prototype,"data",2);s4([L({attribute:!1})],Sd.prototype,"setData",2);s4([L({attribute:!1})],Sd.prototype,"vars",2);Sd=s4([W("variable-ref-view")],Sd);const aA=(t,e)=>{Ui(t,[...e.vars.map(n=>({type:"action",name:n.name,icon:oi(n.icon,{}),select:()=>{e.onSelect(oA(e.vars,{type:"ref",name:n.id}))}})),{type:"group",name:"",children:()=>[{type:"action",name:"Add filter group",icon:rl,select:()=>{e.onSelect(sA(e.vars))}}]}],e.onClose)},tce=(t,e,n)=>{const i=fl.match(t);if(i)return oi(i.view,{value:e,onChange:n,type:t})},nce=(t,e,n,i)=>{const r=fl.match(e);r&&r.popEdit(t,{value:n,onChange:i,type:e})},fl=new o4;var ice=Object.defineProperty,rce=Object.getOwnPropertyDescriptor,gu=(t,e,n,i)=>{for(var r=i>1?void 0:i?rce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ice(e,n,r),r};class Ks extends me(De){}gu([L({attribute:!1})],Ks.prototype,"type",2);gu([L({attribute:!1})],Ks.prototype,"value",2);gu([L({attribute:!1})],Ks.prototype,"onChange",2);let q8=class extends Ks{render(){return this.value?"True":"False"}};q8=gu([W("data-view-literal-boolean-view")],q8);let I5=class extends Ks{render(){return this.value?.toString()??b`<span class="dv-color-2">Empty</span>`}};I5.styles=X`
    data-view-literal-number-view {
      display: block;
      max-width: 100px;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
  `;I5=gu([W("data-view-literal-number-view")],I5);let L5=class extends Ks{render(){return this.value?.toString()??b`<span class="dv-color-2">Empty</span>`}};L5.styles=X`
    data-view-literal-string-view {
      display: block;
      max-width: 100px;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
  `;L5=gu([W("data-view-literal-string-view")],L5);var oce=Object.defineProperty,sce=Object.getOwnPropertyDescriptor,ace=(t,e,n,i)=>{for(var r=i>1?void 0:i?sce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&oce(e,n,r),r};let Y8=class extends Ks{render(){return this.value?Zh(new Date(this.value),"yyyy/MM/dd"):b`<span class="dv-color-2">Empty</span>`}};Y8=ace([W("data-view-literal-date-view")],Y8);var lce=Object.defineProperty,cce=Object.getOwnPropertyDescriptor,lA=(t,e,n,i)=>{for(var r=i>1?void 0:i?cce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&lce(e,n,r),r};let M5=class extends Ks{tags(){const t=this.type.data?.tags;return t||[]}render(){return this.value?this.tags().find(t=>t.id===this.value)?.value??b`<span class="dv-color-2">Empty</span>`:b`<span class="dv-color-2">Empty</span>`}};M5.styles=X`
    data-view-literal-tag-view {
      max-width: 100px;
      display: block;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
  `;M5=lA([W("data-view-literal-tag-view")],M5);let P5=class extends Ks{tags(){const t=this.type.ele;if(!Sn.is(t))return[];const e=t.data?.tags;return e||[]}render(){if(!this.value?.length)return b`<span class="dv-color-2">Empty</span>`;const t=new Map(this.tags().map(e=>[e.id,e.value]));return b`${this.value.map(e=>t.get(e)).join(",")}`}};P5.styles=X`
    data-view-literal-multi-tag-view {
      max-width: 100px;
      display: block;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }
  `;P5=lA([W("data-view-literal-multi-tag-view")],P5);fl.register(Pt.create(),{view:Zt(q8),popEdit:(t,{value:e,onChange:n})=>{hn(t,{options:{input:{search:!0},items:[!0,!1].map(i=>({type:"action",name:i.toString().toUpperCase(),isSelected:i===e,select:()=>{n(i)}}))}})}});fl.register(ln.create(),{view:Zt(L5),popEdit:(t,{value:e,onChange:n})=>{hn(t,{options:{input:{initValue:e?.toString()??"",onComplete:i=>{n(i||void 0)}},items:[]}})}});fl.register(an.create(),{view:Zt(I5),popEdit:(t,{value:e,onChange:n})=>{hn(t,{options:{input:{initValue:e?.toString()??"",onComplete:i=>{if(!i){n(void 0);return}const r=Number.parseFloat(i);Number.isNaN(r)||n(r)}},items:[]}})}});fl.register(gi(Sn.create()),{view:Zt(P5),popEdit:(t,{value:e,onChange:n,type:i})=>{if(!XP(i)||!Sn.is(i.ele))return;let r=Array.isArray(e)?e:[];hn(t,{options:{input:{search:!0},items:i.ele.data?.tags.map(o=>{const s=we({backgroundColor:o.color,padding:"0 8px",width:"max-content"});return{type:"checkbox",name:o.value,checked:r.includes(o.id),label:b` <div class="dv-round-4" style=${s}>
                ${o.value}
              </div>`,select:a=>a?(r=r.filter(l=>l!==o.id),n(r),!1):(r=[...r,o.id],n(r),!0)}})??[]}})}});fl.register(Sn.create(),{view:Zt(M5),popEdit:(t,{onChange:e,type:n})=>{Sn.is(n)&&hn(t,{options:{input:{search:!0},items:n.data?.tags.map(i=>{const r=we({backgroundColor:i.color,padding:"0 8px",width:"max-content"});return{type:"action",name:i.value,label:b` <div class="dv-round-4" style=${r}>
                ${i.value}
              </div>`,select:()=>{e(i.id)}}})??[]}})}});fl.register(vs.create(),{view:Zt(Y8),popEdit:(t,{value:e,onChange:n})=>{const i=document.createElement("input");i.classList.add("blocksuite-overlay"),i.type="date",i.click(),i.valueAsNumber=e,document.body.append(i),i.style.position="absolute";const r=du(t,i);requestAnimationFrame(()=>{i.showPicker(),i.onchange=()=>{n(i.valueAsNumber),r()}})}});var dce=Object.defineProperty,uce=Object.getOwnPropertyDescriptor,V0=(t,e,n,i)=>{for(var r=i>1?void 0:i?uce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&dce(e,n,r),r};let uc=class extends me(De){constructor(){super(...arguments),this._setRef=t=>{this.setData(oA(this.vars,t))}}_filterLabel(){return M1.find(t=>t.data.name===this.data.function)?.data.label}_filterList(){const t=W8(this.vars,this.data.left);return t?M1.allMatchedData(t):[]}_selectFilter(t){const e=t.currentTarget,n=this._filterList();Ui(e,n.map(i=>{const r=i.name===this.data.function;return{type:"action",name:i.label,isSelected:r,select:()=>{this.setData({...this.data,function:i.name})}}}))}_args(){const t=M1.find(i=>i.data.name===this.data.function);if(!t)return[];const e=W8(this.vars,this.data.left);return e?Hn.instance({},[e],Pt.create(),t.type).args.slice(1):[]}render(){const t=this.data;return b`
      <div class="filter-condition-expression">
        <variable-ref-view
          .data="${t.left}"
          .setData="${this._setRef}"
          .vars="${this.vars}"
          style="height: 24px"
        ></variable-ref-view>
        <div
          class="filter-condition-function-name"
          @click="${this._selectFilter}"
        >
          ${this._filterLabel()}
        </div>
        ${Fe(this._args(),(e,n)=>{const i=this.data.args[n],r=s=>{const a=this.data.args.slice();a[n]={type:"literal",value:s},this.setData({...this.data,args:a})};return b` <div
            class="dv-hover dv-round-4 filter-condition-arg"
            @click="${s=>{nce(s.currentTarget,e,i?.value,r)}}"
          >
            ${tce(e,i?.value,r)}
          </div>`})}
      </div>
      ${this.onDelete?b` <div
            @click="${this.onDelete}"
            class="dv-icon-16 dv-round-4 dv-pd-4 dv-hover"
            style="display:flex;align-items:center;"
          >
            ${Xd}
          </div>`:ae}
    `}};uc.styles=X`
    filter-condition-view {
      display: flex;
      align-items: center;
      padding: 4px;
      gap: 16px;
      border: 1px solid var(--affine-border-color);
      border-radius: 8px;
      background-color: var(--affine-white);
    }

    .filter-condition-expression {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .filter-condition-delete {
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      height: max-content;
      cursor: pointer;
    }

    .filter-condition-delete:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-condition-delete svg {
      width: 16px;
      height: 16px;
    }

    .filter-condition-function-name {
      font-size: 12px;
      line-height: 20px;
      color: var(--affine-text-secondary-color);
      padding: 2px 8px;
      border-radius: 4px;
      cursor: pointer;
    }

    .filter-condition-function-name:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-condition-arg {
      font-size: 12px;
      font-style: normal;
      font-weight: 600;
      padding: 0 4px;
      height: 100%;
      display: flex;
      align-items: center;
    }
  `;V0([L({attribute:!1})],uc.prototype,"data",2);V0([L({attribute:!1})],uc.prototype,"setData",2);V0([L({attribute:!1})],uc.prototype,"vars",2);V0([L({attribute:!1})],uc.prototype,"onDelete",2);uc=V0([W("filter-condition-view")],uc);const cA=(t,e)=>{Ui(t,[{type:"action",name:"Add filter",select:()=>{e.onChange({...e.value,conditions:[...e.value.conditions,Iv(e.vars)]})}},{type:"action",name:"Add filter group",select:()=>{e.onChange({...e.value,conditions:[...e.value.conditions,sA(e.vars)]})}}])};var hce=Object.defineProperty,pce=Object.getOwnPropertyDescriptor,mu=(t,e,n,i)=>{for(var r=i>1?void 0:i?pce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&hce(e,n,r),r};let Fa=class extends me(De){constructor(){super(...arguments),this.depth=1,this.opMap={and:"And",or:"Or"},this._setFilter=(t,e)=>{this.setData({...this.data,conditions:this.data.conditions.map((n,i)=>t===i?e:n)})},this._addNew=t=>{if(this.isMaxDepth){this.setData({...this.data,conditions:[...this.data.conditions,Iv(this.vars)]});return}cA(ws(t),{value:this.data,onChange:this.setData,vars:this.vars})},this._selectOp=t=>{Ui(ws(t),[{type:"action",name:"And",select:()=>{this.setData({...this.data,op:"and"})}},{type:"action",name:"Or",select:()=>{this.setData({...this.data,op:"or"})}}])}}_clickConditionOps(t,e){const n=this.data.conditions[e];Ui(t,[{type:"action",name:n.type==="filter"?"Turn into group":"Wrap in group",icon:P9,onHover:i=>{this.containerClass=i?{index:e,class:"hover-style"}:void 0},hide:()=>this.depth+Lv(n)>3,select:()=>{this.setData({type:"group",op:"and",conditions:[this.data]})}},{type:"action",name:"Duplicate",icon:il,onHover:i=>{this.containerClass=i?{index:e,class:"hover-style"}:void 0},select:()=>{const i=[...this.data.conditions];i.splice(e+1,0,JSON.parse(JSON.stringify(i[e]))),this.setData({...this.data,conditions:i})}},{type:"group",name:"",children:()=>[{type:"action",name:"Delete",icon:xn,class:"delete-item",onHover:i=>{this.containerClass=i?{index:e,class:"delete-style"}:void 0},select:()=>{const i=[...this.data.conditions];i.splice(e,1),this.setData({...this.data,conditions:i})}}]}])}get isMaxDepth(){return this.depth===3}render(){const t=this.data;return b`
      <div class="filter-group-container">
        ${Fe(t.conditions,(e,n)=>{const i=a=>{a.stopPropagation(),a.preventDefault(),this._clickConditionOps(ws(a),n)};let r;n===0?r=b` <div class="filter-group-op">Where</div>`:r=b`
              <div
                class="filter-group-op filter-group-op-clickable"
                @click="${this._selectOp}"
              >
                ${this.opMap[t.op]}
              </div>
            `;const o=Qe({"filter-root-item":!0,"filter-exactly-hover-container":!0,"dv-pd-4 dv-round-4":!0,[this.containerClass?.class??""]:this.containerClass?.index===n}),s=Qe({[`filter-group-bg-${this.depth}`]:e.type!=="filter"});return b` <div class="${o}" @contextmenu="${i}">
            ${r}
            <div
              style="flex:1;display:flex;align-items:start;justify-content: space-between;gap: 8px;"
            >
              ${e.type==="filter"?b`
                    <filter-condition-view
                      .setData="${a=>this._setFilter(n,a)}"
                      .vars="${this.vars}"
                      .data="${e}"
                    ></filter-condition-view>
                  `:b`
                    <filter-group-view
                      class="${s}"
                      style="width: 100%;"
                      .depth="${this.depth+1}"
                      .setData="${a=>this._setFilter(n,a)}"
                      .vars="${this.vars}"
                      .data="${e}"
                    ></filter-group-view>
                  `}
              <div class="filter-group-item-ops" @click="${i}">
                ${Xo}
              </div>
            </div>
          </div>`})}
      </div>
      <div class="filter-group-button" @click="${this._addNew}">
        ${Sr} Add ${this.isMaxDepth?ae:W1}
      </div>
    `}};Fa.styles=X`
    filter-group-view {
      border-radius: 4px;
      padding: 8px 4px 4px;
      display: flex;
      flex-direction: column;
      user-select: none;
    }

    .filter-group-op {
      width: 60px;
      display: flex;
      justify-content: end;
      padding: 4px;
      height: 34px;
      align-items: center;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 22px;
      color: var(--affine-text-primary-color);
    }

    .filter-group-op-clickable {
      border-radius: 4px;
      cursor: pointer;
    }

    .filter-group-op-clickable:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-group-container {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .filter-group-button {
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      line-height: 22px;
      border-radius: 4px;
      cursor: pointer;
      color: var(--affine-text-secondary-color);
    }

    .filter-group-button svg {
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      width: 20px;
      height: 20px;
    }

    .filter-group-button:hover {
      background-color: var(--affine-hover-color);
      color: var(--affine-text-primary-color);
    }

    .filter-group-button:hover svg {
      fill: var(--affine-text-primary-color);
      color: var(--affine-text-primary-color);
    }

    .filter-group-item {
      padding: 4px 0;
      display: flex;
      align-items: start;
      gap: 8px;
    }

    .filter-group-item-ops {
      margin-top: 4px;
      padding: 4px;
      border-radius: 4px;
      height: max-content;
      display: flex;
      cursor: pointer;
    }

    .filter-group-item-ops:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-group-item-ops svg {
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      width: 18px;
      height: 18px;
    }

    .filter-group-item-ops:hover svg {
      fill: var(--affine-text-primary-color);
      color: var(--affine-text-primary-color);
    }

    .delete-style {
      background-color: var(--affine-background-error-color);
    }

    .filter-group-border {
      border: 1px dashed var(--affine-border-color);
    }

    .filter-group-bg-1 {
      background-color: var(--affine-background-secondary-color);
      border: 1px solid var(--affine-border-color);
    }

    .filter-group-bg-2 {
      background-color: var(--affine-background-tertiary-color);
      border: 1px solid var(--affine-border-color);
    }
    .hover-style {
      background-color: var(--affine-hover-color);
    }

    .delete-style {
      background-color: var(--affine-background-error-color);
    }
  `;mu([L({attribute:!1})],Fa.prototype,"depth",2);mu([L({attribute:!1})],Fa.prototype,"data",2);mu([L({attribute:!1})],Fa.prototype,"vars",2);mu([L({attribute:!1})],Fa.prototype,"setData",2);mu([ie()],Fa.prototype,"containerClass",2);Fa=mu([W("filter-group-view")],Fa);const Lv=t=>t.type==="filter"?1:Math.max(...t.conditions.map(Lv))+1;var fce=Object.defineProperty,gce=Object.getOwnPropertyDescriptor,dA=(t,e,n,i)=>{for(var r=i>1?void 0:i?gce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&fce(e,n,r),r};class bu extends me(De){}dA([L({attribute:!1})],bu.prototype,"view",2);dA([L({attribute:!1})],bu.prototype,"viewMethod",2);var mce=Object.defineProperty,bce=Object.getOwnPropertyDescriptor,Mv=(t,e,n,i)=>{for(var r=i>1?void 0:i?bce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&mce(e,n,r),r};const vce=X`
  .affine-database-search-container {
    position: relative;
    display: flex;
    align-items: center;
    gap: 8px;
    width: 24px;
    height: 32px;
    border-radius: 8px;
    transition: all 0.3s ease;
    overflow: hidden;
  }
  .affine-database-search-container svg {
    width: 20px;
    height: 20px;
    fill: var(--affine-icon-color);
  }

  .search-container-expand {
    overflow: visible;
    width: 138px;
    background-color: var(--affine-hover-color);
  }

  .search-input-container {
    display: flex;
    align-items: center;
  }

  .close-icon {
    display: flex;
    align-items: center;
    padding-right: 8px;
    height: 100%;
    cursor: pointer;
  }

  .affine-database-search-input-icon {
    position: absolute;
    left: 0;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    cursor: pointer;
    padding: 2px;
    border-radius: 4px;
    height: max-content;
  }
  .affine-database-search-input-icon:hover {
    background: var(--affine-hover-color);
  }

  .search-container-expand .affine-database-search-input-icon {
    left: 4px;
    pointer-events: none;
  }

  .affine-database-search-input {
    flex: 1;
    width: 100%;
    padding: 0 2px 0 30px;
    border: none;
    font-family: ${Je(vt.fontSansFamily)};
    font-size: var(--affine-font-sm);
    box-sizing: border-box;
    color: inherit;
    background: transparent;
    outline: none;
  }

  .affine-database-search-input::placeholder {
    color: var(--affine-placeholder-color);
    font-size: var(--affine-font-sm);
  }
`;let hc=class extends bu{constructor(){super(...arguments),this._showSearch=!1,this._onSearch=t=>{const n=t.target.value.trim();this.view.setSearch(n)},this.preventBlur=!1,this._onSearchBlur=()=>{this._searchInput.value||this.preventBlur||(this.showSearch=!1)},this._onSearchKeydown=t=>{t.key==="Escape"&&(this._searchInput.value?(this._searchInput.value="",this.view.setSearch("")):this.showSearch=!1)},this._clearSearch=()=>{this._searchInput.value="",this.view.setSearch(""),this.preventBlur=!0,setTimeout(()=>{this.preventBlur=!1})},this._clickSearch=t=>{t.stopPropagation(),this.showSearch=!0}}get showSearch(){return this._showSearch}set showSearch(t){this._showSearch=t;const e=this.closest("data-view-header-tools");e&&(e.showToolBar=t)}render(){const t=Qe({"affine-database-search-container":!0,"search-container-expand":this.showSearch});return b`
      <label class="${t}" @click="${this._clickSearch}">
        <div class="affine-database-search-input-icon dv-icon-20">
          ${NT}
        </div>
        <input
          placeholder="Search..."
          class="affine-database-search-input"
          @input="${this._onSearch}"
          @click="${e=>e.stopPropagation()}"
          @keydown="${this._onSearchKeydown}"
          @pointerdown="${at}"
          @blur="${this._onSearchBlur}"
        />
        <div class="close-icon" @mousedown="${this._clearSearch}">
          ${l3}
          <affine-tooltip>
            <span
              style=${we({display:"flex",alignItems:"center",boxSizing:"border-box",padding:"2px 6px",borderRadius:"4px",background:"var(--affine-white-10)"})}
              >Esc</span
            >
            to clear all
          </affine-tooltip>
        </div>
      </label>
    `}};hc.styles=vce;Mv([he(".affine-database-search-input")],hc.prototype,"_searchInput",2);Mv([ie()],hc.prototype,"_showSearch",2);hc=Mv([W("data-view-header-tools-search")],hc);var yce=Object.defineProperty,wce=Object.getOwnPropertyDescriptor,xce=(t,e,n,i)=>{for(var r=i>1?void 0:i?wce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&yce(e,n,r),r};const _ce=X`
  .affine-database-filter-button {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    line-height: 20px;
    padding: 2px 4px;
    border-radius: 4px;
    cursor: pointer;
  }

  .affine-database-filter-button:hover {
    background-color: var(--affine-hover-color);
  }

  .affine-database-filter-button svg {
    width: 20px;
    height: 20px;
  }
`;let Cp=class extends bu{get readonly(){return this.view.readonly}connectedCallback(){super.connectedCallback(),this.disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()}))}get _filter(){return this.view.filter}set _filter(t){this.view.updateFilter(t)}showToolBar(t){const e=this.closest("data-view-header-tools");e&&(e.showToolBar=t)}addFilter(t){if(!this._filter.conditions.length&&!this.view.filterVisible){this.showToolBar(!0),aA(ws(t),{vars:this.view.vars,onSelect:e=>{this._filter={...this._filter,conditions:[e]},this.view.filterSetVisible(!0)},onClose:()=>{this.showToolBar(!1)}});return}this.view.filterSetVisible(!this.view.filterVisible)}render(){return this.readonly?ae:b`<div
      @click="${this.addFilter}"
      class="affine-database-filter-button dv-icon-20"
    >
      ${c3} Filter
    </div>`}};Cp.styles=_ce;Cp=xce([W("data-view-header-tools-filter")],Cp);const Cce=(t,e,n)=>({type:"custom",render:b`<div
      style="display:flex;align-items:center;gap: 8px;padding: 7px 12px;min-width: 300px;justify-content: space-between"
    >
      ${uA(t,e)}
      <div>${n?.right}</div>
    </div>`}),uA=(t,e)=>b`
    <div style="display:flex;align-items:center;gap: 8px;">
      <div
        @click=${e}
        class="dv-icon-20 dv-hover dv-pd-2 dv-round-4"
        style="display:flex;"
      >
        ${vb}
      </div>
      <div
        style="font-size: 12px;line-height: 20px;color: var(--affine-text-secondary-color)"
      >
        ${t}
      </div>
    </div>
  `;var kce=Object.defineProperty,Ece=Object.getOwnPropertyDescriptor,vu=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ece(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&kce(e,n,r),r};let Ua=class extends me(De){constructor(){super(...arguments),this._setFilter=(t,e)=>{this.setData({...this.data,conditions:this.data.conditions.map((n,i)=>t===i?e:n)})},this._addNew=t=>{cA(gd(t.x,t.y),{value:this.data,onChange:this.setData,vars:this.vars})}}_clickConditionOps(t,e){const n=this.data.conditions[e];Ui(t,[{type:"action",name:n.type==="filter"?"Turn into group":"Wrap in group",icon:P9,onHover:i=>{this.containerClass=i?{index:e,class:"hover-style"}:void 0},hide:()=>Lv(n)>3,select:()=>{this.setData({type:"group",op:"and",conditions:[this.data]})}},{type:"action",name:"Duplicate",icon:il,onHover:i=>{this.containerClass=i?{index:e,class:"hover-style"}:void 0},select:()=>{const i=[...this.data.conditions];i.splice(e+1,0,JSON.parse(JSON.stringify(i[e]))),this.setData({...this.data,conditions:i})}},{type:"group",name:"",children:()=>[{type:"action",name:"Delete",icon:xn,class:"delete-item",onHover:i=>{this.containerClass=i?{index:e,class:"delete-style"}:void 0},select:()=>{const i=[...this.data.conditions];i.splice(e,1),this.setData({...this.data,conditions:i})}}]}])}render(){const t=this.data;return b`
      <div style="padding: 15px 20px">
        ${uA("FILTER",()=>{this.onBack?.()})}
      </div>
      <div class="filter-root-container">
        ${Fe(t.conditions,(e,n)=>{const i=a=>{a.stopPropagation(),a.preventDefault(),this._clickConditionOps(gd(a.x,a.y),n)},r=b`
            <div class="filter-root-item-ops" @click="${i}">
              ${Xo}
            </div>
          `,o=e.type==="filter"?b`
                  <div
                    style="display:flex;align-items:center;justify-content: space-between;width: 100%;gap:8px;"
                  >
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="filter-root-grabber"></div>
                      <filter-condition-view
                        .setData="${a=>this._setFilter(n,a)}"
                        .vars="${this.vars}"
                        .data="${e}"
                      ></filter-condition-view>
                    </div>
                    ${r}
                  </div>
                `:b`
                  <div style="width: 100%;">
                    <div
                      style="display:flex;align-items:center;justify-content: space-between;gap:8px;padding: 4px 4px 0 4px;"
                    >
                      <div class="filter-group-title">
                        <div class="filter-root-grabber"></div>
                        Filter group
                      </div>
                      ${r}
                    </div>
                    <div style="width: 100%;padding: 12px 0 0;">
                      <filter-group-view
                        style="padding: 0"
                        .setData="${a=>this._setFilter(n,a)}"
                        .vars="${this.vars}"
                        .data="${e}"
                      ></filter-group-view>
                    </div>
                  </div>
                `,s=Qe({"filter-root-item":!0,"filter-exactly-hover-container":!0,"dv-pd-4 dv-round-4":!0,[this.containerClass?.class??""]:this.containerClass?.index===n});return b` ${t.conditions[n-1]?.type==="group"||e.type==="group"?b`<div class="divider"></div>`:ae}
            <div @contextmenu=${i} class="${s}">
              ${o}
            </div>`})}
      </div>
      <div class="filter-root-button add-new" @click="${this._addNew}">
        ${Sr} Add ${W1}
      </div>
    `}};Ua.styles=X`
    filter-root-view {
      border-radius: 4px;
      display: flex;
      flex-direction: column;
      user-select: none;
    }

    .filter-root-title {
      padding: 12px;
      font-size: 14px;
      font-weight: 600;
      line-height: 22px;
      color: var(--affine-text-primary-color);
    }

    .filter-root-op {
      width: 60px;
      display: flex;
      justify-content: end;
      padding: 4px;
      height: 34px;
      align-items: center;
    }

    .filter-root-op-clickable {
      border-radius: 4px;
      cursor: pointer;
    }

    .filter-root-op-clickable:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-root-container {
      display: flex;
      flex-direction: column;
      gap: 4px;
      max-height: 400px;
      overflow: auto;
      padding: 0 12px 0 8px;
    }

    .filter-root-button {
      margin: 4px 8px 8px;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      line-height: 22px;
      border-radius: 4px;
      cursor: pointer;
      color: var(--affine-text-secondary-color);
    }

    .filter-root-button svg {
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      width: 20px;
      height: 20px;
    }

    .filter-root-button:hover {
      background-color: var(--affine-hover-color);
      color: var(--affine-text-primary-color);
    }
    .filter-root-button:hover svg {
      fill: var(--affine-text-primary-color);
      color: var(--affine-text-primary-color);
    }

    .filter-root-item {
      padding: 4px 0;
      display: flex;
      align-items: start;
      gap: 8px;
    }

    .filter-group-title {
      font-size: 14px;
      font-style: normal;
      font-weight: 500;
      line-height: 22px;
      display: flex;
      align-items: center;
      color: var(--affine-text-primary-color);
      gap: 6px;
    }

    .filter-root-item-ops {
      margin-top: 2px;
      padding: 4px;
      border-radius: 4px;
      height: max-content;
      display: flex;
      cursor: pointer;
    }

    .filter-root-item-ops:hover {
      background-color: var(--affine-hover-color);
    }

    .filter-root-item-ops svg {
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      width: 18px;
      height: 18px;
    }
    .filter-root-item-ops:hover svg {
      fill: var(--affine-text-primary-color);
      color: var(--affine-text-primary-color);
    }

    .filter-root-grabber {
      cursor: grab;
      width: 4px;
      height: 12px;
      background-color: var(--affine-placeholder-color);
      border-radius: 1px;
    }

    .divider {
      height: 1px;
      background-color: var(--affine-divider-color);
      flex-shrink: 0;
      margin: 8px 0;
    }
  `;vu([L({attribute:!1})],Ua.prototype,"data",2);vu([L({attribute:!1})],Ua.prototype,"vars",2);vu([L({attribute:!1})],Ua.prototype,"setData",2);vu([L({attribute:!1})],Ua.prototype,"onBack",2);vu([ie()],Ua.prototype,"containerClass",2);Ua=vu([W("filter-root-view")],Ua);var Sce=Object.defineProperty,Tce=Object.getOwnPropertyDescriptor,Vc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Tce(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Sce(e,n,r),r};let Do=class extends me(De){constructor(){super(...arguments),this.isRoot=!1}connectedCallback(){super.connectedCallback(),this.disposables.addFromEvent(this,"mouseover",t=>{let e=t.target;for(;e&&e!==this;){if(e.classList.contains("filter-exactly-hover-container")){e.classList.add("filter-exactly-hover-background");break}e=e.parentElement}}),this.disposables.addFromEvent(this,"mouseout",t=>{let e=t.target;for(;e&&e!==this;){if(e.classList.contains("filter-exactly-hover-container")){e.classList.remove("filter-exactly-hover-background");break}e=e.parentElement}})}render(){return b`
      <div class="filter-modal-container">
        ${this.isRoot?b` <filter-root-view
              .onBack=${this.onBack}
              .vars="${this.vars}"
              .data="${this.data}"
              .setData="${this.setData}"
            ></filter-root-view>`:b` <filter-group-view
              .vars="${this.vars}"
              .data="${this.data}"
              .setData="${this.setData}"
            ></filter-group-view>`}
      </div>
      <div class="filter-modal-bottom">
        <div
          @click=${this.onDelete}
          class="filter-modal-button filter-delete-button"
        >
          Delete
        </div>
      </div>
    `}};Do.styles=X`
    advanced-filter-modal {
      background-color: var(--affine-background-overlay-panel-color);
      position: absolute;
      border-radius: 8px;
      box-shadow: var(--affine-shadow-2);
      min-width: 500px;
    }

    .filter-modal-bottom {
      border-top: 1px solid var(--affine-border-color);
      padding: 8px;
    }

    .filter-modal-button {
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      line-height: 22px;
      border-radius: 4px;
      cursor: pointer;
      color: var(--affine-text-secondary-color);
    }

    .filter-modal-button svg {
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      width: 20px;
      height: 20px;
    }

    .filter-modal-button:hover {
      background-color: var(--affine-hover-color);
      color: var(--affine-text-primary-color);
    }
    .filter-modal-button:hover svg {
      fill: var(--affine-text-primary-color);
      color: var(--affine-text-primary-color);
    }

    .filter-delete-button:hover {
      background-color: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }

    .filter-exactly-hover-container {
      transition: background-color 0.2s ease-in-out;
    }

    .filter-exactly-hover-background {
      background-color: var(--affine-hover-color);
    }
  `;Vc([L({attribute:!1})],Do.prototype,"isRoot",2);Vc([L({attribute:!1})],Do.prototype,"data",2);Vc([L({attribute:!1})],Do.prototype,"vars",2);Vc([L({attribute:!1})],Do.prototype,"setData",2);Vc([L({attribute:!1})],Do.prototype,"onDelete",2);Vc([L({attribute:!1})],Do.prototype,"onBack",2);Do=Vc([W("advanced-filter-modal")],Do);const hA=(t,e)=>{const n=new Do;n.vars=e.vars,n.data=e.value,n.isRoot=e.isRoot,n.onDelete=()=>{e.onDelete(),i()},n.onBack=()=>{e.onBack(),i()},n.setData=r=>{e.onChange(r),n.data=r};const i=du(t,n)};/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function aC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Oo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aC(Object(n),!0).forEach(function(i){Ice(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aC(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function m2(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m2=function(e){return typeof e}:m2=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m2(t)}function Ice(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Us(){return Us=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Us.apply(this,arguments)}function Lce(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Mce(t,e){if(t==null)return{};var n=Lce(t,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var Pce="1.15.2";function xs(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Qs=xs(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),z0=xs(/Edge/i),lC=xs(/firefox/i),Ah=xs(/safari/i)&&!xs(/chrome/i)&&!xs(/android/i),pA=xs(/iP(ad|od|hone)/i),fA=xs(/chrome/i)&&xs(/android/i),gA={capture:!1,passive:!1};function Et(t,e,n){t.addEventListener(e,n,!Qs&&gA)}function yt(t,e,n){t.removeEventListener(e,n,!Qs&&gA)}function A5(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Ace(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function Ur(t,e,n,i){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&A5(t,e):A5(t,e))||i&&t===n)return t;if(t===n)break}while(t=Ace(t))}return null}var cC=/\s+/g;function qi(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(cC," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(cC," ")}}function Ke(t,e,n){var i=t&&t.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=n+(typeof n=="string"?"":"px")}}function P1(t,e){var n="";if(typeof t=="string")n=t;else do{var i=Ke(t,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function mA(t,e,n){if(t){var i=t.getElementsByTagName(e),r=0,o=i.length;if(n)for(;r<o;r++)n(i[r],r);return i}return[]}function xo(){var t=document.scrollingElement;return t||document.documentElement}function bn(t,e,n,i,r){if(!(!t.getBoundingClientRect&&t!==window)){var o,s,a,l,c,d,u;if(t!==window&&t.parentNode&&t!==xo()?(o=t.getBoundingClientRect(),s=o.top,a=o.left,l=o.bottom,c=o.right,d=o.height,u=o.width):(s=0,a=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!Qs))do if(r&&r.getBoundingClientRect&&(Ke(r,"transform")!=="none"||n&&Ke(r,"position")!=="static")){var h=r.getBoundingClientRect();s-=h.top+parseInt(Ke(r,"border-top-width")),a-=h.left+parseInt(Ke(r,"border-left-width")),l=s+o.height,c=a+o.width;break}while(r=r.parentNode);if(i&&t!==window){var p=P1(r||t),g=p&&p.a,f=p&&p.d;p&&(s/=f,a/=g,u/=g,d/=f,l=s+d,c=a+u)}return{top:s,left:a,bottom:l,right:c,width:u,height:d}}}function dC(t,e,n){for(var i=ma(t,!0),r=bn(t)[e];i;){var o=bn(i)[n],s=void 0;if(n==="top"||n==="left"?s=r>=o:s=r<=o,!s)return i;if(i===xo())break;i=ma(i,!1)}return!1}function Td(t,e,n,i){for(var r=0,o=0,s=t.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==We.ghost&&(i||s[o]!==We.dragged)&&Ur(s[o],n.draggable,t,!1)){if(r===e)return s[o];r++}o++}return null}function Pv(t,e){for(var n=t.lastElementChild;n&&(n===We.ghost||Ke(n,"display")==="none"||e&&!A5(n,e));)n=n.previousElementSibling;return n||null}function fr(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==We.clone&&(!e||A5(t,e))&&n++;return n}function uC(t){var e=0,n=0,i=xo();if(t)do{var r=P1(t),o=r.a,s=r.d;e+=t.scrollLeft*o,n+=t.scrollTop*s}while(t!==i&&(t=t.parentNode));return[e,n]}function $ce(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n)}return-1}function ma(t,e){if(!t||!t.getBoundingClientRect)return xo();var n=t,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=Ke(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return xo();if(i||e)return n;i=!0}}while(n=n.parentNode);return xo()}function Bce(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function W6(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var $h;function bA(t,e){return function(){if(!$h){var n=arguments,i=this;n.length===1?t.call(i,n[0]):t.apply(i,n),$h=setTimeout(function(){$h=void 0},e)}}}function Dce(){clearTimeout($h),$h=void 0}function vA(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function yA(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function wA(t,e,n){var i={};return Array.from(t.children).forEach(function(r){var o,s,a,l;if(!(!Ur(r,e.draggable,t,!1)||r.animated||r===n)){var c=bn(r);i.left=Math.min((o=i.left)!==null&&o!==void 0?o:1/0,c.left),i.top=Math.min((s=i.top)!==null&&s!==void 0?s:1/0,c.top),i.right=Math.max((a=i.right)!==null&&a!==void 0?a:-1/0,c.right),i.bottom=Math.max((l=i.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var Qi="Sortable"+new Date().getTime();function Oce(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(r){if(!(Ke(r,"display")==="none"||r===We.ghost)){t.push({target:r,rect:bn(r)});var o=Oo({},t[t.length-1].rect);if(r.thisAnimationDuration){var s=P1(r,!0);s&&(o.top-=s.f,o.left-=s.e)}r.fromRect=o}})}},addAnimationState:function(i){t.push(i)},removeAnimationState:function(i){t.splice($ce(t,{target:i}),1)},animateAll:function(i){var r=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var o=!1,s=0;t.forEach(function(a){var l=0,c=a.target,d=c.fromRect,u=bn(c),h=c.prevFromRect,p=c.prevToRect,g=a.rect,f=P1(c,!0);f&&(u.top-=f.f,u.left-=f.e),c.toRect=u,c.thisAnimationDuration&&W6(h,u)&&!W6(d,u)&&(g.top-u.top)/(g.left-u.left)===(d.top-u.top)/(d.left-u.left)&&(l=Nce(g,h,p,r.options)),W6(u,d)||(c.prevFromRect=d,c.prevToRect=u,l||(l=r.options.animation),r.animate(c,g,u,l)),l&&(o=!0,s=Math.max(s,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),o?e=setTimeout(function(){typeof i=="function"&&i()},s):typeof i=="function"&&i(),t=[]},animate:function(i,r,o,s){if(s){Ke(i,"transition",""),Ke(i,"transform","");var a=P1(this.el),l=a&&a.a,c=a&&a.d,d=(r.left-o.left)/(l||1),u=(r.top-o.top)/(c||1);i.animatingX=!!d,i.animatingY=!!u,Ke(i,"transform","translate3d("+d+"px,"+u+"px,0)"),this.forRepaintDummy=Rce(i),Ke(i,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),Ke(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){Ke(i,"transition",""),Ke(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},s)}}}}function Rce(t){return t.offsetWidth}function Nce(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var o1=[],q6={initializeByDefault:!0},j0={mount:function(e){for(var n in q6)q6.hasOwnProperty(n)&&!(n in e)&&(e[n]=q6[n]);o1.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),o1.push(e)},pluginEvent:function(e,n,i){var r=this;this.eventCanceled=!1,i.cancel=function(){r.eventCanceled=!0};var o=e+"Global";o1.forEach(function(s){n[s.pluginName]&&(n[s.pluginName][o]&&n[s.pluginName][o](Oo({sortable:n},i)),n.options[s.pluginName]&&n[s.pluginName][e]&&n[s.pluginName][e](Oo({sortable:n},i)))})},initializePlugins:function(e,n,i,r){o1.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var c=new a(e,n,e.options);c.sortable=e,c.options=e.options,e[l]=c,Us(i,c.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);typeof s<"u"&&(e.options[o]=s)}},getEventProperties:function(e,n){var i={};return o1.forEach(function(r){typeof r.eventProperties=="function"&&Us(i,r.eventProperties.call(n[r.pluginName],e))}),i},modifyOption:function(e,n,i){var r;return o1.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[n]=="function"&&(r=o.optionListeners[n].call(e[o.pluginName],i))}),r}};function Hce(t){var e=t.sortable,n=t.rootEl,i=t.name,r=t.targetEl,o=t.cloneEl,s=t.toEl,a=t.fromEl,l=t.oldIndex,c=t.newIndex,d=t.oldDraggableIndex,u=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[Qi],!!e){var f,v=e.options,m="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!Qs&&!z0?f=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent(i,!0,!0)),f.to=s||n,f.from=a||n,f.item=r||n,f.clone=o,f.oldIndex=l,f.newIndex=c,f.oldDraggableIndex=d,f.newDraggableIndex=u,f.originalEvent=h,f.pullMode=p?p.lastPutMode:void 0;var y=Oo(Oo({},g),j0.getEventProperties(i,e));for(var x in y)f[x]=y[x];n&&n.dispatchEvent(f),v[m]&&v[m].call(e,f)}}var Fce=["evt"],Ti=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.evt,o=Mce(i,Fce);j0.pluginEvent.bind(We)(e,n,Oo({dragEl:Re,parentEl:Kt,ghostEl:tt,rootEl:Vt,nextEl:Dl,lastDownEl:b2,cloneEl:qt,cloneHidden:ua,dragStarted:dh,putSortable:Un,activeSortable:We.active,originalEvent:r,oldIndex:x1,oldDraggableIndex:Bh,newIndex:Yi,newDraggableIndex:da,hideGhostForTarget:kA,unhideGhostForTarget:EA,cloneNowHidden:function(){ua=!0},cloneNowShown:function(){ua=!1},dispatchSortableEvent:function(a){hi({sortable:n,name:a,originalEvent:r})}},o))};function hi(t){Hce(Oo({putSortable:Un,cloneEl:qt,targetEl:Re,rootEl:Vt,oldIndex:x1,oldDraggableIndex:Bh,newIndex:Yi,newDraggableIndex:da},t))}var Re,Kt,tt,Vt,Dl,b2,qt,ua,x1,Yi,Bh,da,Nf,Un,p1=!1,$5=!1,B5=[],Il,Dr,Y6,X6,hC,pC,dh,s1,Dh,Oh=!1,Hf=!1,v2,Qn,K6=[],X8=!1,D5=[],a4=typeof document<"u",Ff=pA,fC=z0||Qs?"cssFloat":"float",Uce=a4&&!fA&&!pA&&"draggable"in document.createElement("div"),xA=function(){if(a4){if(Qs)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),_A=function(e,n){var i=Ke(e),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),o=Td(e,0,n),s=Td(e,1,n),a=o&&Ke(o),l=s&&Ke(s),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+bn(o).width,d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+bn(s).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&a.float!=="none"){var u=a.float==="left"?"left":"right";return s&&(l.clear==="both"||l.clear===u)?"vertical":"horizontal"}return o&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||c>=r&&i[fC]==="none"||s&&i[fC]==="none"&&c+d>r)?"vertical":"horizontal"},Vce=function(e,n,i){var r=i?e.left:e.top,o=i?e.right:e.bottom,s=i?e.width:e.height,a=i?n.left:n.top,l=i?n.right:n.bottom,c=i?n.width:n.height;return r===a||o===l||r+s/2===a+c/2},zce=function(e,n){var i;return B5.some(function(r){var o=r[Qi].options.emptyInsertThreshold;if(!(!o||Pv(r))){var s=bn(r),a=e>=s.left-o&&e<=s.right+o,l=n>=s.top-o&&n<=s.bottom+o;if(a&&l)return i=r}}),i},CA=function(e){function n(o,s){return function(a,l,c,d){var u=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(o==null&&(s||u))return!0;if(o==null||o===!1)return!1;if(s&&o==="clone")return o;if(typeof o=="function")return n(o(a,l,c,d),s)(a,l,c,d);var h=(s?a:l).options.group.name;return o===!0||typeof o=="string"&&o===h||o.join&&o.indexOf(h)>-1}}var i={},r=e.group;(!r||m2(r)!="object")&&(r={name:r}),i.name=r.name,i.checkPull=n(r.pull,!0),i.checkPut=n(r.put),i.revertClone=r.revertClone,e.group=i},kA=function(){!xA&&tt&&Ke(tt,"display","none")},EA=function(){!xA&&tt&&Ke(tt,"display","")};a4&&!fA&&document.addEventListener("click",function(t){if($5)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),$5=!1,!1},!0);var Ll=function(e){if(Re){e=e.touches?e.touches[0]:e;var n=zce(e.clientX,e.clientY);if(n){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[Qi]._onDragOver(i)}}},jce=function(e){Re&&Re.parentNode[Qi]._isOutsideThisEl(e.target)};function We(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Us({},e),t[Qi]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return _A(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,a){s.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:We.supportPointer!==!1&&"PointerEvent"in window&&!Ah,emptyInsertThreshold:5};j0.initializePlugins(this,t,n);for(var i in n)!(i in e)&&(e[i]=n[i]);CA(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:Uce,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Et(t,"pointerdown",this._onTapStart):(Et(t,"mousedown",this._onTapStart),Et(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Et(t,"dragover",this),Et(t,"dragenter",this)),B5.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Us(this,Oce())}We.prototype={constructor:We,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(s1=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,Re):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,i=this.el,r=this.options,o=r.preventOnFilter,s=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,d=r.filter;if(Qce(i),!Re&&!(/mousedown|pointerdown/.test(s)&&e.button!==0||r.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Ah&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Ur(l,r.draggable,i,!1),!(l&&l.animated)&&b2!==l)){if(x1=fr(l),Bh=fr(l,r.draggable),typeof d=="function"){if(d.call(this,e,l,this)){hi({sortable:n,rootEl:c,name:"filter",targetEl:l,toEl:i,fromEl:i}),Ti("filter",n,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(u){if(u=Ur(c,u.trim(),i,!1),u)return hi({sortable:n,rootEl:u,name:"filter",targetEl:l,fromEl:i,toEl:i}),Ti("filter",n,{evt:e}),!0}),d)){o&&e.cancelable&&e.preventDefault();return}r.handle&&!Ur(c,r.handle,i,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,n,i){var r=this,o=r.el,s=r.options,a=o.ownerDocument,l;if(i&&!Re&&i.parentNode===o){var c=bn(i);if(Vt=o,Re=i,Kt=Re.parentNode,Dl=Re.nextSibling,b2=i,Nf=s.group,We.dragged=Re,Il={target:Re,clientX:(n||e).clientX,clientY:(n||e).clientY},hC=Il.clientX-c.left,pC=Il.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,Re.style["will-change"]="all",l=function(){if(Ti("delayEnded",r,{evt:e}),We.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!lC&&r.nativeDraggable&&(Re.draggable=!0),r._triggerDragStart(e,n),hi({sortable:r,name:"choose",originalEvent:e}),qi(Re,s.chosenClass,!0)},s.ignore.split(",").forEach(function(d){mA(Re,d.trim(),Q6)}),Et(a,"dragover",Ll),Et(a,"mousemove",Ll),Et(a,"touchmove",Ll),Et(a,"mouseup",r._onDrop),Et(a,"touchend",r._onDrop),Et(a,"touchcancel",r._onDrop),lC&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Re.draggable=!0),Ti("delayStart",this,{evt:e}),s.delay&&(!s.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(z0||Qs))){if(We.eventCanceled){this._onDrop();return}Et(a,"mouseup",r._disableDelayedDrag),Et(a,"touchend",r._disableDelayedDrag),Et(a,"touchcancel",r._disableDelayedDrag),Et(a,"mousemove",r._delayedDragTouchMoveHandler),Et(a,"touchmove",r._delayedDragTouchMoveHandler),s.supportPointer&&Et(a,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(l,s.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Re&&Q6(Re),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;yt(e,"mouseup",this._disableDelayedDrag),yt(e,"touchend",this._disableDelayedDrag),yt(e,"touchcancel",this._disableDelayedDrag),yt(e,"mousemove",this._delayedDragTouchMoveHandler),yt(e,"touchmove",this._delayedDragTouchMoveHandler),yt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?Et(document,"pointermove",this._onTouchMove):n?Et(document,"touchmove",this._onTouchMove):Et(document,"mousemove",this._onTouchMove):(Et(Re,"dragend",this),Et(Vt,"dragstart",this._onDragStart));try{document.selection?y2(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(p1=!1,Vt&&Re){Ti("dragStarted",this,{evt:n}),this.nativeDraggable&&Et(document,"dragover",jce);var i=this.options;!e&&qi(Re,i.dragClass,!1),qi(Re,i.ghostClass,!0),We.active=this,e&&this._appendGhost(),hi({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Dr){this._lastX=Dr.clientX,this._lastY=Dr.clientY,kA();for(var e=document.elementFromPoint(Dr.clientX,Dr.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Dr.clientX,Dr.clientY),e!==n);)n=e;if(Re.parentNode[Qi]._isOutsideThisEl(e),n)do{if(n[Qi]){var i=void 0;if(i=n[Qi]._onDragOver({clientX:Dr.clientX,clientY:Dr.clientY,target:e,rootEl:n}),i&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);EA()}},_onTouchMove:function(e){if(Il){var n=this.options,i=n.fallbackTolerance,r=n.fallbackOffset,o=e.touches?e.touches[0]:e,s=tt&&P1(tt,!0),a=tt&&s&&s.a,l=tt&&s&&s.d,c=Ff&&Qn&&uC(Qn),d=(o.clientX-Il.clientX+r.x)/(a||1)+(c?c[0]-K6[0]:0)/(a||1),u=(o.clientY-Il.clientY+r.y)/(l||1)+(c?c[1]-K6[1]:0)/(l||1);if(!We.active&&!p1){if(i&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(tt){s?(s.e+=d-(Y6||0),s.f+=u-(X6||0)):s={a:1,b:0,c:0,d:1,e:d,f:u};var h="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");Ke(tt,"webkitTransform",h),Ke(tt,"mozTransform",h),Ke(tt,"msTransform",h),Ke(tt,"transform",h),Y6=d,X6=u,Dr=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!tt){var e=this.options.fallbackOnBody?document.body:Vt,n=bn(Re,!0,Ff,!0,e),i=this.options;if(Ff){for(Qn=e;Ke(Qn,"position")==="static"&&Ke(Qn,"transform")==="none"&&Qn!==document;)Qn=Qn.parentNode;Qn!==document.body&&Qn!==document.documentElement?(Qn===document&&(Qn=xo()),n.top+=Qn.scrollTop,n.left+=Qn.scrollLeft):Qn=xo(),K6=uC(Qn)}tt=Re.cloneNode(!0),qi(tt,i.ghostClass,!1),qi(tt,i.fallbackClass,!0),qi(tt,i.dragClass,!0),Ke(tt,"transition",""),Ke(tt,"transform",""),Ke(tt,"box-sizing","border-box"),Ke(tt,"margin",0),Ke(tt,"top",n.top),Ke(tt,"left",n.left),Ke(tt,"width",n.width),Ke(tt,"height",n.height),Ke(tt,"opacity","0.8"),Ke(tt,"position",Ff?"absolute":"fixed"),Ke(tt,"zIndex","100000"),Ke(tt,"pointerEvents","none"),We.ghost=tt,e.appendChild(tt),Ke(tt,"transform-origin",hC/parseInt(tt.style.width)*100+"% "+pC/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(e,n){var i=this,r=e.dataTransfer,o=i.options;if(Ti("dragStart",this,{evt:e}),We.eventCanceled){this._onDrop();return}Ti("setupClone",this),We.eventCanceled||(qt=yA(Re),qt.removeAttribute("id"),qt.draggable=!1,qt.style["will-change"]="",this._hideClone(),qi(qt,this.options.chosenClass,!1),We.clone=qt),i.cloneId=y2(function(){Ti("clone",i),!We.eventCanceled&&(i.options.removeCloneOnHide||Vt.insertBefore(qt,Re),i._hideClone(),hi({sortable:i,name:"clone"}))}),!n&&qi(Re,o.dragClass,!0),n?($5=!0,i._loopId=setInterval(i._emulateDragOver,50)):(yt(document,"mouseup",i._onDrop),yt(document,"touchend",i._onDrop),yt(document,"touchcancel",i._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(i,r,Re)),Et(document,"drop",i),Ke(Re,"transform","translateZ(0)")),p1=!0,i._dragStartId=y2(i._dragStarted.bind(i,n,e)),Et(document,"selectstart",i),dh=!0,Ah&&Ke(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,i=e.target,r,o,s,a=this.options,l=a.group,c=We.active,d=Nf===l,u=a.sort,h=Un||c,p,g=this,f=!1;if(X8)return;function v(Le,ue){Ti(Le,g,Oo({evt:e,isOwner:d,axis:p?"vertical":"horizontal",revert:s,dragRect:r,targetRect:o,canSort:u,fromSortable:h,target:i,completed:y,onMove:function(ee,K){return Uf(Vt,n,Re,r,ee,bn(ee),e,K)},changed:x},ue))}function m(){v("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function y(Le){return v("dragOverCompleted",{insertion:Le}),Le&&(d?c._hideClone():c._showClone(g),g!==h&&(qi(Re,Un?Un.options.ghostClass:c.options.ghostClass,!1),qi(Re,a.ghostClass,!0)),Un!==g&&g!==We.active?Un=g:g===We.active&&Un&&(Un=null),h===g&&(g._ignoreWhileAnimating=i),g.animateAll(function(){v("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(i===Re&&!Re.animated||i===n&&!i.animated)&&(s1=null),!a.dragoverBubble&&!e.rootEl&&i!==document&&(Re.parentNode[Qi]._isOutsideThisEl(e.target),!Le&&Ll(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function x(){Yi=fr(Re),da=fr(Re,a.draggable),hi({sortable:g,name:"change",toEl:n,newIndex:Yi,newDraggableIndex:da,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=Ur(i,a.draggable,n,!0),v("dragOver"),We.eventCanceled)return f;if(Re.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||g._ignoreWhileAnimating===i)return y(!1);if($5=!1,c&&!a.disabled&&(d?u||(s=Kt!==Vt):Un===this||(this.lastPutMode=Nf.checkPull(this,c,Re,e))&&l.checkPut(this,c,Re,e))){if(p=this._getDirection(e,i)==="vertical",r=bn(Re),v("dragOverValid"),We.eventCanceled)return f;if(s)return Kt=Vt,m(),this._hideClone(),v("revert"),We.eventCanceled||(Dl?Vt.insertBefore(Re,Dl):Vt.appendChild(Re)),y(!0);var T=Pv(n,a.draggable);if(!T||qce(e,p,this)&&!T.animated){if(T===Re)return y(!1);if(T&&n===e.target&&(i=T),i&&(o=bn(i)),Uf(Vt,n,Re,r,i,o,e,!!i)!==!1)return m(),T&&T.nextSibling?n.insertBefore(Re,T.nextSibling):n.appendChild(Re),Kt=n,x(),y(!0)}else if(T&&Wce(e,p,this)){var M=Td(n,0,a,!0);if(M===Re)return y(!1);if(i=M,o=bn(i),Uf(Vt,n,Re,r,i,o,e,!1)!==!1)return m(),n.insertBefore(Re,M),Kt=n,x(),y(!0)}else if(i.parentNode===n){o=bn(i);var k=0,_,A=Re.parentNode!==n,$=!Vce(Re.animated&&Re.toRect||r,i.animated&&i.toRect||o,p),E=p?"top":"left",R=dC(i,"top","top")||dC(Re,"top","top"),I=R?R.scrollTop:void 0;s1!==i&&(_=o[E],Oh=!1,Hf=!$&&a.invertSwap||A),k=Yce(e,i,o,p,$?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,Hf,s1===i);var N;if(k!==0){var P=fr(Re);do P-=k,N=Kt.children[P];while(N&&(Ke(N,"display")==="none"||N===tt))}if(k===0||N===i)return y(!1);s1=i,Dh=k;var Z=i.nextElementSibling,pe=!1;pe=k===1;var Q=Uf(Vt,n,Re,r,i,o,e,pe);if(Q!==!1)return(Q===1||Q===-1)&&(pe=Q===1),X8=!0,setTimeout(Zce,30),m(),pe&&!Z?n.appendChild(Re):i.parentNode.insertBefore(Re,pe?Z:i),R&&vA(R,0,I-R.scrollTop),Kt=Re.parentNode,_!==void 0&&!Hf&&(v2=Math.abs(_-bn(i)[E])),x(),y(!0)}if(n.contains(Re))return y(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){yt(document,"mousemove",this._onTouchMove),yt(document,"touchmove",this._onTouchMove),yt(document,"pointermove",this._onTouchMove),yt(document,"dragover",Ll),yt(document,"mousemove",Ll),yt(document,"touchmove",Ll)},_offUpEvents:function(){var e=this.el.ownerDocument;yt(e,"mouseup",this._onDrop),yt(e,"touchend",this._onDrop),yt(e,"pointerup",this._onDrop),yt(e,"touchcancel",this._onDrop),yt(document,"selectstart",this)},_onDrop:function(e){var n=this.el,i=this.options;if(Yi=fr(Re),da=fr(Re,i.draggable),Ti("drop",this,{evt:e}),Kt=Re&&Re.parentNode,Yi=fr(Re),da=fr(Re,i.draggable),We.eventCanceled){this._nulling();return}p1=!1,Hf=!1,Oh=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),K8(this.cloneId),K8(this._dragStartId),this.nativeDraggable&&(yt(document,"drop",this),yt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ah&&Ke(document.body,"user-select",""),Ke(Re,"transform",""),e&&(dh&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(Vt===Kt||Un&&Un.lastPutMode!=="clone")&&qt&&qt.parentNode&&qt.parentNode.removeChild(qt),Re&&(this.nativeDraggable&&yt(Re,"dragend",this),Q6(Re),Re.style["will-change"]="",dh&&!p1&&qi(Re,Un?Un.options.ghostClass:this.options.ghostClass,!1),qi(Re,this.options.chosenClass,!1),hi({sortable:this,name:"unchoose",toEl:Kt,newIndex:null,newDraggableIndex:null,originalEvent:e}),Vt!==Kt?(Yi>=0&&(hi({rootEl:Kt,name:"add",toEl:Kt,fromEl:Vt,originalEvent:e}),hi({sortable:this,name:"remove",toEl:Kt,originalEvent:e}),hi({rootEl:Kt,name:"sort",toEl:Kt,fromEl:Vt,originalEvent:e}),hi({sortable:this,name:"sort",toEl:Kt,originalEvent:e})),Un&&Un.save()):Yi!==x1&&Yi>=0&&(hi({sortable:this,name:"update",toEl:Kt,originalEvent:e}),hi({sortable:this,name:"sort",toEl:Kt,originalEvent:e})),We.active&&((Yi==null||Yi===-1)&&(Yi=x1,da=Bh),hi({sortable:this,name:"end",toEl:Kt,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Ti("nulling",this),Vt=Re=Kt=tt=Dl=qt=b2=ua=Il=Dr=dh=Yi=da=x1=Bh=s1=Dh=Un=Nf=We.dragged=We.ghost=We.clone=We.active=null,D5.forEach(function(e){e.checked=!0}),D5.length=Y6=X6=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Re&&(this._onDragOver(e),Gce(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,i=this.el.children,r=0,o=i.length,s=this.options;r<o;r++)n=i[r],Ur(n,s.draggable,this.el,!1)&&e.push(n.getAttribute(s.dataIdAttr)||Kce(n));return e},sort:function(e,n){var i={},r=this.el;this.toArray().forEach(function(o,s){var a=r.children[s];Ur(a,this.options.draggable,r,!1)&&(i[o]=a)},this),n&&this.captureAnimationState(),e.forEach(function(o){i[o]&&(r.removeChild(i[o]),r.appendChild(i[o]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return Ur(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var i=this.options;if(n===void 0)return i[e];var r=j0.modifyOption(this,e,n);typeof r<"u"?i[e]=r:i[e]=n,e==="group"&&CA(i)},destroy:function(){Ti("destroy",this);var e=this.el;e[Qi]=null,yt(e,"mousedown",this._onTapStart),yt(e,"touchstart",this._onTapStart),yt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(yt(e,"dragover",this),yt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),B5.splice(B5.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ua){if(Ti("hideClone",this),We.eventCanceled)return;Ke(qt,"display","none"),this.options.removeCloneOnHide&&qt.parentNode&&qt.parentNode.removeChild(qt),ua=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(ua){if(Ti("showClone",this),We.eventCanceled)return;Re.parentNode==Vt&&!this.options.group.revertClone?Vt.insertBefore(qt,Re):Dl?Vt.insertBefore(qt,Dl):Vt.appendChild(qt),this.options.group.revertClone&&this.animate(Re,qt),Ke(qt,"display",""),ua=!1}}};function Gce(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Uf(t,e,n,i,r,o,s,a){var l,c=t[Qi],d=c.options.onMove,u;return window.CustomEvent&&!Qs&&!z0?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=r||e,l.relatedRect=o||bn(e),l.willInsertAfter=a,l.originalEvent=s,t.dispatchEvent(l),d&&(u=d.call(c,l,s)),u}function Q6(t){t.draggable=!1}function Zce(){X8=!1}function Wce(t,e,n){var i=bn(Td(n.el,0,n.options,!0)),r=wA(n.el,n.options,tt),o=10;return e?t.clientX<r.left-o||t.clientY<i.top&&t.clientX<i.right:t.clientY<r.top-o||t.clientY<i.bottom&&t.clientX<i.left}function qce(t,e,n){var i=bn(Pv(n.el,n.options.draggable)),r=wA(n.el,n.options,tt),o=10;return e?t.clientX>r.right+o||t.clientY>i.bottom&&t.clientX>i.left:t.clientY>r.bottom+o||t.clientX>i.right&&t.clientY>i.top}function Yce(t,e,n,i,r,o,s,a){var l=i?t.clientY:t.clientX,c=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,h=!1;if(!s){if(a&&v2<c*r){if(!Oh&&(Dh===1?l>d+c*o/2:l<u-c*o/2)&&(Oh=!0),Oh)h=!0;else if(Dh===1?l<d+v2:l>u-v2)return-Dh}else if(l>d+c*(1-r)/2&&l<u-c*(1-r)/2)return Xce(e)}return h=h||s,h&&(l<d+c*o/2||l>u-c*o/2)?l>d+c/2?1:-1:0}function Xce(t){return fr(Re)<fr(t)?1:-1}function Kce(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function Qce(t){D5.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&D5.push(i)}}function y2(t){return setTimeout(t,0)}function K8(t){return clearTimeout(t)}a4&&Et(document,"touchmove",function(t){(We.active||p1)&&t.cancelable&&t.preventDefault()});We.utils={on:Et,off:yt,css:Ke,find:mA,is:function(e,n){return!!Ur(e,n,e,!1)},extend:Bce,throttle:bA,closest:Ur,toggleClass:qi,clone:yA,index:fr,nextTick:y2,cancelNextTick:K8,detectDirection:_A,getChild:Td};We.get=function(t){return t[Qi]};We.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(We.utils=Oo(Oo({},We.utils),i.utils)),j0.mount(i)})};We.create=function(t,e){return new We(t,e)};We.version=Pce;var gn=[],uh,Q8,J8=!1,J6,e7,O5,hh;function Jce(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?Et(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Et(document,"pointermove",this._handleFallbackAutoScroll):i.touches?Et(document,"touchmove",this._handleFallbackAutoScroll):Et(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?yt(document,"dragover",this._handleAutoScroll):(yt(document,"pointermove",this._handleFallbackAutoScroll),yt(document,"touchmove",this._handleFallbackAutoScroll),yt(document,"mousemove",this._handleFallbackAutoScroll)),gC(),w2(),Dce()},nulling:function(){O5=Q8=uh=J8=hh=J6=e7=null,gn.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var r=this,o=(n.touches?n.touches[0]:n).clientX,s=(n.touches?n.touches[0]:n).clientY,a=document.elementFromPoint(o,s);if(O5=n,i||this.options.forceAutoScrollFallback||z0||Qs||Ah){t7(n,this.options,a,i);var l=ma(a,!0);J8&&(!hh||o!==J6||s!==e7)&&(hh&&gC(),hh=setInterval(function(){var c=ma(document.elementFromPoint(o,s),!0);c!==l&&(l=c,w2()),t7(n,r.options,c,i)},10),J6=o,e7=s)}else{if(!this.options.bubbleScroll||ma(a,!0)===xo()){w2();return}t7(n,this.options,ma(a,!1),!1)}}},Us(t,{pluginName:"scroll",initializeByDefault:!0})}function w2(){gn.forEach(function(t){clearInterval(t.pid)}),gn=[]}function gC(){clearInterval(hh)}var t7=bA(function(t,e,n,i){if(e.scroll){var r=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,a=e.scrollSpeed,l=xo(),c=!1,d;Q8!==n&&(Q8=n,w2(),uh=e.scroll,d=e.scrollFn,uh===!0&&(uh=ma(n,!0)));var u=0,h=uh;do{var p=h,g=bn(p),f=g.top,v=g.bottom,m=g.left,y=g.right,x=g.width,T=g.height,M=void 0,k=void 0,_=p.scrollWidth,A=p.scrollHeight,$=Ke(p),E=p.scrollLeft,R=p.scrollTop;p===l?(M=x<_&&($.overflowX==="auto"||$.overflowX==="scroll"||$.overflowX==="visible"),k=T<A&&($.overflowY==="auto"||$.overflowY==="scroll"||$.overflowY==="visible")):(M=x<_&&($.overflowX==="auto"||$.overflowX==="scroll"),k=T<A&&($.overflowY==="auto"||$.overflowY==="scroll"));var I=M&&(Math.abs(y-r)<=s&&E+x<_)-(Math.abs(m-r)<=s&&!!E),N=k&&(Math.abs(v-o)<=s&&R+T<A)-(Math.abs(f-o)<=s&&!!R);if(!gn[u])for(var P=0;P<=u;P++)gn[P]||(gn[P]={});(gn[u].vx!=I||gn[u].vy!=N||gn[u].el!==p)&&(gn[u].el=p,gn[u].vx=I,gn[u].vy=N,clearInterval(gn[u].pid),(I!=0||N!=0)&&(c=!0,gn[u].pid=setInterval(function(){i&&this.layer===0&&We.active._onTouchMove(O5);var Z=gn[this.layer].vy?gn[this.layer].vy*a:0,pe=gn[this.layer].vx?gn[this.layer].vx*a:0;typeof d=="function"&&d.call(We.dragged.parentNode[Qi],pe,Z,t,O5,gn[this.layer].el)!=="continue"||vA(gn[this.layer].el,pe,Z)}.bind({layer:u}),24))),u++}while(e.bubbleScroll&&h!==l&&(h=ma(h,!1)));J8=c}},30),SA=function(e){var n=e.originalEvent,i=e.putSortable,r=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(n){var c=i||o;a();var d=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,u=document.elementFromPoint(d.clientX,d.clientY);l(),c&&!c.el.contains(u)&&(s("spill"),this.onSpill({dragEl:r,putSortable:i}))}};function Av(){}Av.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var r=Td(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:SA};Us(Av,{pluginName:"revertOnSpill"});function $v(){}$v.prototype={onSpill:function(e){var n=e.dragEl,i=e.putSortable,r=i||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:SA};Us($v,{pluginName:"removeOnSpill"});We.mount(new Jce);We.mount($v,Av);class TA{constructor(e){this.dataSource=e,this.searchString="",this.slots={update:new Ve},this.dataSource.slots.update.pipe(this.slots.update)}get rows(){return this.filteredRows(this.searchString)}setSearch(e){this.searchString=e,this.slots.update.emit()}filteredRows(e){return this.dataSource.rows.filter(n=>e&&!this.columns.some(r=>this.cellGetStringValue(n,r)?.toLowerCase().includes(e?.toLowerCase()))?!1:this.isShow(n))}get columnManagerList(){return this.columns.map(e=>this.columnGet(e))}get readonly(){return!1}onCellUpdate(e,n,i){return this.dataSource.onCellUpdate(e,n,i)}cellGetValue(e,n){return Gt.getColumn(this.columnGetType(n)).formatValue(this.dataSource.cellGetValue(e,n),this.columnGetData(n))}cellGetJsonValue(e,n){return Gt.getColumn(this.columnGetType(n)).toJson(this.dataSource.cellGetValue(e,n),this.columnGetData(n))}cellGetRenderValue(e,n){return this.dataSource.cellGetRenderValue(e,n)}cellGetStringValue(e,n){return Gt.getColumn(this.columnGetType(n)).toString(this.dataSource.cellGetValue(e,n),this.columnGetData(n))??""}cellGetExtra(e,n){return this.dataSource.cellGetExtra(e,n)}cellSetValueFromString(e,n){return Gt.getColumn(this.columnGetType(e)).fromString(n,this.columnGetData(e))??""}cellUpdateRenderValue(e,n,i){this.dataSource.cellChangeValue(e,n,i)}cellUpdateValue(e,n,i){this.dataSource.cellChangeValue(e,n,i)}columnAdd(e,n){const i=this.dataSource.propertyAdd(e,n);return this.columnMove(i,e),i}columnDelete(e){this.dataSource.propertyDelete(e)}columnDuplicate(e){const n=this.dataSource.propertyDuplicate(e);this.columnMove(n,{before:!1,id:e})}columnGetData(e){return this.dataSource.propertyGetData(e)}columnGetDataType(e){return Gt.getColumn(this.columnGetType(e)).dataType(this.columnGetData(e))}columnGetIdByIndex(e){return this.columns[e]}columnGetReadonly(e){return this.dataSource.propertyGetReadonly(e)}columnGetIndex(e){return this.columns.indexOf(e)}columnGetName(e){return this.dataSource.propertyGetName(e)}columnGetNextColumn(e){return this.columnGet(this.columnGetIdByIndex(this.columnGetIndex(e)+1))}columnGetPreColumn(e){return this.columnGet(this.columnGetIdByIndex(this.columnGetIndex(e)-1))}columnGetType(e){return this.dataSource.propertyGetType(e)}columnUpdateData(e,n){this.dataSource.propertyChangeData(e,n)}columnUpdateName(e,n){this.dataSource.propertyChangeName(e,n)}columnUpdateType(e,n){this.dataSource.propertyChangeType(e,n)}rowAdd(e){return this.dataSource.rowAdd(e)}rowDelete(e){this.dataSource.rowDelete(e)}captureSync(){this.dataSource.captureSync()}get allColumnConfig(){return this.dataSource.allPropertyConfig}get columnConfigManager(){return this.dataSource.columnConfigManager}getIcon(e){return sr.get(e).icon}get detailSlots(){return this.dataSource.detailSlots}get vars(){return this.columnsWithoutFilter.map(e=>{const n=this.columnGet(e);return{id:n.id,name:n.name,type:Gt.getColumn(n.type).dataType(n.data),icon:n.icon}})}filterSetVisible(e){this._filterVisible=e,this.slots.update.emit()}get filterVisible(){return this._filterVisible??this.filter.conditions.length>0}rowMove(e,n){this.dataSource.rowMove(e,n)}}class IA{constructor(e,n){this.propertyId=e,this.dataViewManager=n}get index(){return this.dataViewManager.columnGetIndex(this.id)}get data(){return this.dataViewManager.columnGetData(this.id)}get hide(){return this.dataViewManager.columnGetHide(this.id)}get id(){return this.propertyId}get isFirst(){return this.dataViewManager.columnGetIndex(this.id)===0}get isLast(){return this.dataViewManager.columnGetIndex(this.id)===this.dataViewManager.columnManagerList.length-1}get name(){return this.dataViewManager.columnGetName(this.id)}get renderer(){return sr.get(this.type).cellRenderer}get detailRenderer(){return sr.get(this.type).detailCellRenderer??this.renderer}get type(){return this.dataViewManager.columnGetType(this.id)}get dataType(){return Gt.getColumn(this.type).dataType(this.data)}getValue(e){return this.dataViewManager.cellGetRenderValue(e,this.id)}getExtra(e){return this.dataViewManager.cellGetExtra(e,this.id)}setValue(e,n){this.dataViewManager.cellUpdateRenderValue(e,this.id,n)}updateData(e){const n=this.dataViewManager.columnGetData(this.id);this.dataViewManager.columnUpdateData(this.id,{...n,...e(n)})}updateHide(e){this.dataViewManager.columnUpdateHide(this.id,e)}updateName(e){this.dataViewManager.columnUpdateName(this.id,e)}get delete(){return()=>this.dataViewManager.columnDelete(this.id)}get duplicate(){return()=>this.dataViewManager.columnDuplicate(this.id)}get updateType(){return e=>this.dataViewManager.columnUpdateType(this.id,e)}get readonly(){return this.dataViewManager.readonly||this.dataViewManager.columnGetReadonly(this.id)}captureSync(){this.dataViewManager.captureSync()}getJsonValue(e){return this.dataViewManager.cellGetJsonValue(e,this.id)}getStringValue(e){return this.dataViewManager.cellGetStringValue(e,this.id)}setValueFromString(e){const n=this.dataViewManager.cellSetValueFromString(this.id,e);return n.data&&this.dataViewManager.columnUpdateData(this.id,n.data),n.value}get icon(){if(this.type)return this.dataViewManager.getIcon(this.type)}onCellUpdate(e,n){return this.dataViewManager.onCellUpdate(e,this.id,n)}}function Qr(t,e,n=i=>i.id){return typeof t=="object"?e.findIndex(r=>n(r)===t.id)+(t.before?0:1):t==null||t==="start"?0:t==="end"?e.length:e.findIndex(i=>n(i)===t)+1}const e1e=(t,e,n)=>{const i=t.findIndex(a=>e(a));if(i<0)return t;const r=[...t],[o]=r.splice(i,1),s=n(r);return r.splice(s,0,o),r};class LA{constructor(e,n,i,r,o){this.groupBy=e,this.viewManager=r,this.ops=o,this.updateData=a=>{this.viewManager.columnUpdateData(this.columnId,a)},this.groupMap=Object.fromEntries(n.defaultKeys(i).map(({key:a,value:l})=>[a,{key:a,name:n.groupName(i,l),helper:this,type:i,value:l,rows:[]}])),this.viewManager.rows.forEach(a=>{const l=this.viewManager.cellGetJsonValue(a,e.columnId);n.valuesGroup(l,i).forEach(({key:d,value:u})=>{this.groupMap[d]||(this.groupMap[d]={key:d,name:n.groupName(i,u),helper:this,value:u,rows:[],type:i}),this.groupMap[d].rows.push(a)})});const s=o.sortGroup(Object.keys(this.groupMap));s.forEach(a=>{this.groupMap[a].rows=o.sortRow(a,this.groupMap[a].rows)}),this.groups=s.map(a=>this.groupMap[a])}get dataType(){return this.viewManager.columnGetDataType(this.groupBy.columnId)}get column(){return this.viewManager.columnGet(this.groupBy.columnId)}get columnId(){return this.groupBy.columnId}get type(){return this.viewManager.columnGetType(this.columnId)}get data(){return this.viewManager.columnGetData(this.columnId)}updateValue(e,n){e.forEach(i=>{this.viewManager.cellUpdateValue(i,this.columnId,n)})}groupConfig(){return _r.findData(e=>e.name===this.groupBy.name)}defaultGroupProperty(e){return{key:e,hide:!1,manuallyCardSort:[]}}addToGroup(e,n){const i=this.columnId,o=(this.groupConfig()?.addToGroup??(s=>s))(this.groupMap[n].value,this.viewManager.cellGetJsonValue(e,i));this.viewManager.cellUpdateValue(e,i,o)}removeFromGroup(e,n){const i=this.columnId,o=(this.groupConfig()?.removeFromGroup??(()=>{}))(this.groupMap[n].value,this.viewManager.cellGetJsonValue(e,i));this.viewManager.cellUpdateValue(e,i,o)}changeCardSort(e,n){this.ops.changeRowSort(this.groups.map(i=>i.key),e,n)}changeGroupSort(e){this.ops.changeGroupSort(e)}moveGroupTo(e,n){const i=this.groups.map(o=>o.key);i.splice(i.findIndex(o=>o===e),1);const r=Qr(n,i,o=>o);i.splice(r,0,e),this.changeGroupSort(i)}moveCardTo(e,n,i,r){if(n!==i){const a=this.columnId,l=this.groupConfig()?.removeFromGroup??(()=>{}),c=n!=null?this.groupMap[n]:void 0;let d;c&&(d=l(c.value,this.viewManager.cellGetJsonValue(e,a))),d=(this.groupConfig()?.addToGroup??(h=>h))(this.groupMap[i].value,d),this.viewManager.cellUpdateValue(e,a,d)}const o=this.groupMap[i].rows.filter(a=>a!==e),s=Qr(r,o,a=>a);o.splice(s,0,e),this.changeCardSort(i,o)}get addGroup(){return this.viewManager.columnConfigManager.getColumn(this.column.type).ops.addGroup}}const R5=(t,e,n)=>{const i=new Map(t.map(o=>[e(o),o])),r=[];for(const o of n){const s=i.get(o);s&&(i.delete(o),r.push(s))}return r.push(...i.values()),r},Bv=(t,e,n)=>{const i=_r.match(Gt.getColumn(e).dataType(n))?.name;return i!=null?{type:"groupBy",columnId:t,name:i}:void 0},MA=(t,e)=>{if(t.type==="ref")return e[t.name];const n=MA(t.ref,e),i=Uc.findData(r=>r.name===t.propertyFuncName);try{return i?.impl(n)}catch(r){console.error(r);return}},t1e=(t,e)=>t.value,PA=(t,e)=>{const n=i=>{if(i.type==="filter"){const r=MA(i.left,e),o=M1.findData(a=>a.name===i.function),s=i.args.map(a=>t1e(a));try{return(o?.impl.length??0)>s.length+1?!0:o?.impl(r,...s)??!0}catch(a){return console.error(a),!0}}else if(i.type==="group"){if(i.op==="and")return i.conditions.every(r=>n(r));if(i.op==="or")return i.conditions.some(r=>n(r))}return!0};return n(t)};var n1e=Object.defineProperty,i1e=Object.getOwnPropertyDescriptor,l4=(t,e,n,i)=>{for(var r=i>1?void 0:i?i1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&n1e(e,n,r),r};const r1e=X`
  data-view-header-area-text {
    width: 100%;
    display: flex;
  }

  data-view-header-area-text-editing {
    width: 100%;
    display: flex;
    cursor: text;
  }

  .data-view-header-area-rich-text {
    display: flex;
    flex-direction: column;
    justify-content: center;
    width: 100%;
    height: 100%;
    outline: none;
    word-break: break-all;
    font-size: var(--data-view-cell-text-size);
    line-height: var(--data-view-cell-text-line-height);
  }

  .data-view-header-area-rich-text v-line {
    display: flex !important;
    align-items: center;
    height: 100%;
    width: 100%;
  }

  .data-view-header-area-rich-text v-line > div {
    flex-grow: 1;
  }

  .data-view-header-area-icon {
    height: max-content;
    display: flex;
    align-items: center;
    margin-right: 8px;
    padding: 2px;
    border-radius: 4px;
    margin-top: 2px;
    background-color: var(--affine-background-secondary-color);
  }

  .data-view-header-area-icon svg {
    width: 14px;
    height: 14px;
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
  }
`;class c4 extends on{constructor(){super(...arguments),this.showIcon=!1}static{this.styles=r1e}get topContenteditableElement(){return this.closest("affine-database")?.topContenteditableElement}get titleColumn(){const e=this.view.header.titleColumn;return D(e),this.view.columnGet(e)}get inlineEditor(){D(this.richText);const e=this.richText.inlineEditor;return D(e),e}onExitEditMode(){this._isRichText||this.view.cellUpdateValue(this.rowId,this.titleColumn.id,this._isRichText?this.inlineEditor?.yText:this.inlineEditor?.yText.toString())}getYText(e){if(this._isRichText&&(e instanceof nt.Y.Text||e==null)){let i=e;return i||(i=new nt.Y.Text,this.titleColumn?.setValue(this.rowId,i)),i}const n=new nt.Y.Doc().getText("title");return e instanceof nt.Y.Text?e:(n.insert(0,e??""),n)}renderIcon(){if(!this.showIcon)return;const e=this.view.header.iconColumn;if(!e)return;const n=this.view.columnGet(e).getValue(this.rowId);if(n)return Be`<div class="data-view-header-area-icon">${n}</div>`}get _isRichText(){return kv.is(this.titleColumn.dataType)}}l4([L({attribute:!1})],c4.prototype,"showIcon",2);l4([he("rich-text")],c4.prototype,"richText",2);let N5=class extends c4{render(){const t=this.getYText(this.titleColumn.getValue(this.rowId));return Be`${this.renderIcon()}
      <rich-text
        .yText=${t}
        .inlineEventSource=${this.topContenteditableElement}
        .readonly=${!0}
        class="data-view-header-area-rich-text"
      ></rich-text>`}};N5=l4([W("data-view-header-area-text")],N5);let H5=class extends c4{firstUpdated(t){super.firstUpdated(t),this.richText.updateComplete.then(()=>{this.inlineEditor.focusEnd(),this.disposables.add(this.inlineEditor.slots.inlineRangeUpdate.on(([e])=>{e?this.isEditing||this.selectCurrentCell(!0):this.isEditing&&this.selectCurrentCell(!1)}))}).catch(console.error)}render(){const t=this.getYText(this.titleColumn.getValue(this.rowId));return Be`${this.renderIcon()}
      <rich-text
        .yText=${t}
        .inlineEventSource=${this.topContenteditableElement}
        .readonly=${this.readonly}
        class="data-view-header-area-rich-text"
      ></rich-text>`}};H5=l4([W("data-view-header-area-text-editing")],H5);const o1e={view:yp(tn(N5),t=>({...t,showIcon:!1})),edit:yp(tn(H5),t=>({...t,showIcon:!1}))};class AA extends TA{constructor(e,n){super(n),this.viewSource=e,this.updateView=i=>{this.syncView(),e.updateView(i)},e.updateSlot.pipe(this.slots.update)}get view(){return this.viewSource.view}get filter(){return this.view.filter}get id(){return this.view.id}get name(){return this.view.name}updateFilter(e){this.updateView(()=>({filter:e}))}updateName(e){this.updateView(()=>({name:e}))}syncView(){this.view.columns.length!==this.columns.length&&this.viewSource.updateView(e=>({columns:this.columnsWithoutFilter.map(n=>{const i=this.columnGet(n);return{id:i.id,hide:i.hide}})}))}columnGet(e){return new s1e(e,this)}columnMove(e,n){this.updateView(i=>{const r=i.columns.findIndex(l=>l.id===e);if(r<0)return{};const o=[...i.columns],[s]=o.splice(r,1),a=Qr(n,o);return o.splice(a,0,s),{columns:o}})}rowMove(e,n){this.dataSource.rowMove(e,n)}get columns(){return this.columnsWithoutFilter.filter(e=>!this.columnGetHide(e))}get detailColumns(){return this.columnsWithoutFilter.filter(e=>this.columnGetType(e)!=="title")}get columnsWithoutFilter(){const e=new Set(this.dataSource.properties),n=[];return this.view.columns.forEach(i=>{e.has(i.id)&&(n.push(i.id),e.delete(i.id))}),n.push(...e),n}isShow(e){if(this.filter.conditions.length){const n=Object.fromEntries(this.columnManagerList.map(i=>[i.id,i.getJsonValue(e)]));return PA(this.filter,n)}return!0}get readonly(){return this.viewSource.readonly}checkGroup(e,n,i){return _r.isMatched(n,i)?!0:(this.changeGroup(e),!1)}changeGroup(e){const n=this.columnGet(e);this.updateView(i=>({groupBy:Bv(n.id,n.type,n.data)}))}get groupHelper(){const e=this.view.groupBy;if(!e)return;const n=_r.find(o=>o.data.name===e.name);if(!n)return;const i=n.data,r=this.columnGetDataType(e.columnId);return this.checkGroup(e.columnId,n.type,r)?new LA(e,i,r,this,{sortGroup:o=>R5(o,s=>s,this.view.groupProperties.map(s=>s.key)),sortRow:(o,s)=>{const a=this.view.groupProperties.find(l=>l.key===o);return R5(s,l=>l,a?.manuallyCardSort??[])},changeGroupSort:o=>{const s=new Map(this.view.groupProperties.map(a=>[a.key,a]));this.updateView(()=>({groupProperties:o.map(a=>{const l=s.get(a);return l||{key:a,hide:!1,manuallyCardSort:[]}})}))},changeRowSort:(o,s,a)=>{const l=new Map(this.view.groupProperties.map(c=>[c.key,c]));this.updateView(()=>({groupProperties:o.map(c=>{if(c===s){const d=l.get(c);return d?{...d,manuallyCardSort:a}:{key:c,hide:!1,manuallyCardSort:a}}else return l.get(c)??{key:c,hide:!1,manuallyCardSort:[]}})}))}}):this.groupHelper}addCard(e,n){const i=this.rowAdd(e);return this.groupHelper?.addToGroup(i,n),i}get type(){return this.view.mode}get header(){return this.view.header}isInHeader(e){const n=this.view.header;return n.titleColumn===e||n.iconColumn===e||n.coverColumn===e}hasHeader(e){const n=this.view.header;return!!n.titleColumn||!!n.iconColumn||!!n.coverColumn}getHeaderTitle(e){const n=this.view.header.titleColumn;if(n)return this.columnGet(n)}getHeaderIcon(e){const n=this.view.header.iconColumn;if(n)return this.columnGet(n)}getHeaderCover(e){const n=this.view.header.coverColumn;if(n)return this.columnGet(n)}columnUpdateHide(e,n){this.updateView(i=>({columns:i.columns.map(r=>r.id===e?{...r,hide:n}:r)}))}columnGetHide(e){return this.view.columns.find(n=>n.id===e)?.hide??!1}duplicateView(){this.viewSource.duplicate()}deleteView(){this.viewSource.delete()}get isDeleted(){return this.viewSource.isDeleted()}}class s1e extends IA{constructor(e,n){super(e,n),this.dataViewManager=n}get renderer(){return this.id===this.dataViewManager.header.titleColumn?o1e:super.renderer}}const a1e={view:yp(tn(N5),t=>({...t,showIcon:!0})),edit:yp(tn(H5),t=>({...t,showIcon:!0}))};class $A extends TA{constructor(e,n){super(n),this.viewSource=e,this.updateView=i=>{this.syncView(),e.updateView(i)},e.updateSlot.pipe(this.slots.update)}get type(){return this.view.mode}get view(){return this.viewSource.view}get filter(){return this.view.filter}get id(){return this.view.id}get name(){return this.view.name}updateFilter(e){this.updateView(()=>({filter:e}))}updateName(e){this.updateView(()=>({name:e}))}rowMove(e,n,i,r){if(r==null){super.rowMove(e,n);return}this.groupHelper?.moveCardTo(e,i,r,n)}syncView(){this.view.columns.length!==this.columns.length&&this.viewSource.updateView(e=>({columns:this.columnsWithoutFilter.map(n=>{const i=this.columnGet(n);return{id:i.id,hide:i.hide,width:i.width}})}))}columnGet(e){return new l1e(e,this)}columnGetWidth(e){return this.view.columns.find(n=>n.id===e)?.width??this.dataSource.propertyGetDefaultWidth(e)}columnMove(e,n){this.updateView(i=>{const r=i.columns.findIndex(l=>l.id===e);if(r<0)return{};const o=[...i.columns],[s]=o.splice(r,1),a=Qr(n,o);return o.splice(a,0,s),{columns:o}})}columnUpdateWidth(e,n){this.updateView(i=>({columns:i.columns.map(r=>r.id===e?{...r,width:n}:r)}))}get columns(){return this.columnsWithoutFilter.filter(e=>!this.columnGetHide(e))}get detailColumns(){return this.columnsWithoutFilter.filter(e=>this.columnGetType(e)!=="title")}rowAdd(e,n){const i=super.rowAdd(e);return n&&this.groupHelper?.addToGroup(i,n),i}get columnsWithoutFilter(){const e=new Set(this.dataSource.properties),n=[];return this.view.columns.forEach(i=>{e.has(i.id)&&(n.push(i.id),e.delete(i.id))}),n.push(...e),n}get readonly(){return this.viewSource.readonly}isShow(e){if(this.filter.conditions.length){const n=Object.fromEntries(this.columnManagerList.map(i=>[i.id,i.getJsonValue(e)]));return PA(this.filter,n)}return!0}columnUpdateHide(e,n){this.updateView(i=>({columns:i.columns.map(r=>r.id===e?{...r,hide:n}:r)}))}columnGetHide(e){return this.view.columns.find(n=>n.id===e)?.hide??!1}duplicateView(){this.viewSource.duplicate()}deleteView(){this.viewSource.delete()}get isDeleted(){return this.viewSource.isDeleted()}get header(){return this.view.header??{titleColumn:this.columnsWithoutFilter.find(e=>this.columnGetType(e)==="title"),iconColumn:"type"}}isInHeader(e){return Object.values(this.header).some(n=>n===e)}hasHeader(e){return Object.values(this.header).some(n=>this.cellGetValue(e,n))}changeGroup(e){if(e==null){this.updateView(()=>({groupBy:void 0}));return}const n=this.columnGet(e);this.updateView(i=>({groupBy:Bv(n.id,n.type,n.data)}))}checkGroup(e,n,i){return _r.isMatched(n,i)?!0:(this.changeGroup(e),!1)}get groupProperties(){return this.view.groupProperties??[]}get groupHelper(){const e=this.view.groupBy;if(!e)return;const n=_r.find(o=>o.data.name===e.name);if(!n)return;const i=n.data,r=this.columnGetDataType(e.columnId);return this.checkGroup(e.columnId,n.type,r)?new LA(e,i,r,this,{sortGroup:o=>R5(o,s=>s,this.groupProperties.map(s=>s.key)),sortRow:(o,s)=>{const a=this.groupProperties.find(l=>l.key===o);return R5(s,l=>l,a?.manuallyCardSort??[])},changeGroupSort:o=>{const s=new Map(this.groupProperties.map(a=>[a.key,a]));this.updateView(()=>({groupProperties:o.map(a=>{const l=s.get(a);return l||{key:a,hide:!1,manuallyCardSort:[]}})}))},changeRowSort:(o,s,a)=>{const l=new Map(this.groupProperties.map(c=>[c.key,c]));this.updateView(()=>({groupProperties:o.map(c=>{if(c===s){const d=l.get(c);return d?{...d,manuallyCardSort:a}:{key:c,hide:!1,manuallyCardSort:a}}else return l.get(c)??{key:c,hide:!1,manuallyCardSort:[]}})}))}}):this.groupHelper}}class l1e extends IA{constructor(e,n){super(e,n),this.dataViewManager=n}get width(){return this.dataViewManager.columnGetWidth(this.id)}updateWidth(e){this.dataViewManager.columnUpdateWidth(this.id,e)}get renderer(){return this.id===this.dataViewManager.header.titleColumn?a1e:super.renderer}}const em=()=>`
  --data-view-cell-text-size:14px;
  --data-view-cell-text-line-height:22px;
`,Dv=t=>`
  ${t}{
    ${em()}
  }
  .with-data-view-css-variable{
    ${em()}
    font-family: var(--affine-font-family)
  }
  .dv-pd-2{
    padding:2px;
  }
  .dv-pd-4{
    padding:4px;
  }
  .dv-pd-8{
    padding:8px;
  }
  .dv-hover:hover{
    background-color: var(--affine-hover-color);
    cursor: pointer;
  }
  .dv-icon-16 svg{
    width: 16px;
    height: 16px;
    color: var(--affine-icon-color);
    fill: var(--affine-icon-color);
  }
  .dv-icon-20 svg{
    width: 20px;
    height: 20px;
    color: var(--affine-icon-color);
    fill: var(--affine-icon-color);
  }
  .dv-border{
    border: 1px solid var(--affine-border-color);
  }
  .dv-round-4{
    border-radius: 4px;
  }
  .dv-round-8{
    border-radius: 8px;
  }
  .dv-color-2{
    color: var(--affine-text-secondary-color);
  }
  .dv-shadow-2{
    box-shadow: var(--affine-shadow-2)
  }
  .dv-divider-h{
    height: 1px;
    background-color: var(--affine-divider-color);
    margin: 8px 0;
  }
`;var c1e=Object.defineProperty,d1e=Object.getOwnPropertyDescriptor,Ov=(t,e,n,i)=>{for(var r=i>1?void 0:i?d1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&c1e(e,n,r),r};let kp=class extends me(De){connectedCallback(){super.connectedCallback(),this._disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()})),this._disposables.addFromEvent(this,"pointerdown",t=>{t.stopPropagation()})}firstUpdated(t){super.firstUpdated(t);const e=new We(this.groupContainer,{animation:150,group:`group-sort-${this.view.id}`,onEnd:n=>{const i=this.view.groupHelper;if(!i)return;const r=[...i.groups],o=n.oldIndex??-1,s=r[o];r.splice(o,1);const a=r[n.newIndex??-1];i.moveGroupTo(s.key,a?{before:!0,id:a.key}:"end")}});this._disposables.add({dispose:()=>e.destroy()})}render(){const t=this.view.groupHelper;if(t)return b`
      <div style="padding: 7px 12px;">
        <div
          style="padding: 0 4px; font-size: 12px;color: var(--affine-text-secondary-color);line-height: 20px;"
        >
          Groups
        </div>
        <div></div>
      </div>
      <div
        style="display:flex;flex-direction: column;gap: 4px;"
        class="group-sort-setting"
      >
        ${Fe(t.groups,e=>e.key,e=>{const n={value:e.value,data:e.helper.data,readonly:!0},i=e.helper.groupConfig();return b` <div class="dv-hover dv-round-4 group-item">
              <div class="group-item-drag-bar"></div>
              <div style="padding: 0 4px;position:relative;">
                ${oi(i?.view,n)}
                <div
                  style="position:absolute;left: 0;top: 0;right: 0;bottom: 0;"
                ></div>
              </div>
            </div>`})}
      </div>
    `}};kp.styles=X`
    data-view-group-setting {
      display: flex;
      flex-direction: column;
      gap: 4px;
      ${Je(em())};
    }
    .group-item {
      display: flex;
      padding: 4px 12px;
      position: relative;
      cursor: grab;
    }

    .group-item-drag-bar {
      width: 4px;
      height: 12px;
      border-radius: 1px;
      background-color: #efeff0;
      position: absolute;
      left: 4px;
      top: 0;
      bottom: 0;
      margin: auto;
    }

    .group-item:hover .group-item-drag-bar {
      background-color: #c0bfc1;
    }
  `;Ov([L({attribute:!1})],kp.prototype,"view",2);Ov([he(".group-sort-setting")],kp.prototype,"groupContainer",2);kp=Ov([W("data-view-group-setting")],kp);const BA=(t,e)=>({onClose:e,input:{search:!0,placeholder:"Search"},items:[...t.columnsWithoutFilter.filter(n=>t.columnGet(n).type==="title"?!1:!!_r.match(t.columnGet(n).dataType)).map(n=>{const i=t.columnGet(n);return{type:"action",name:i.name,isSelected:t.view.groupBy?.columnId===n,icon:b` <uni-lit .uni="${i.icon}"></uni-lit>`,select:()=>{t.changeGroup(n)}}}),{type:"group",name:"",hide:()=>t instanceof AA||t.view.groupBy==null,children:()=>[{type:"action",icon:xn,class:"delete-item",name:"Remove Grouping",select:()=>{t instanceof $A&&t.changeGroup(void 0)}}]}]}),u1e=(t,e,n)=>{hn(t,{options:BA(e,n)})},DA=(t,e,n)=>{const i=e.view.groupBy;if(i==null)return;const r=()=>{DA(t,e,n)},o=e.columnGetType(i.columnId),s=e.getIcon(o),a=hn(t,{options:{input:{search:!0},items:[Cce("GROUP",()=>{n(),a.close()}),{type:"group",name:"",children:()=>[{type:"sub-menu",name:"Group By",postfix:b`
                <div
                  style="display:flex;align-items:center;gap: 4px;font-size: 12px;line-height: 20px;color: var(--affine-text-secondary-color);margin-right: 4px;margin-left: 8px;"
                  class="dv-icon-16"
                >
                  ${oi(s,{})}
                  ${e.columnGetName(i.columnId)}
                </div>
                ${ya}
              `,options:BA(e,r)}]},{type:"group",name:"",children:()=>[{type:"custom",render:b` <data-view-group-setting
                .view="${e}"
                .columnId="${i.columnId}"
              ></data-view-group-setting>`}]}]}})};var h1e=Object.defineProperty,p1e=Object.getOwnPropertyDescriptor,d4=(t,e,n,i)=>{for(var r=i>1?void 0:i?p1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&h1e(e,n,r),r};const f1e=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M12.0004 5.75C8.06451 5.75 4.70095 8.20857 3.36528 11.6764C3.28512 11.8845 3.28512 12.1155 3.36527 12.3236C4.70093 15.7914 8.06451 18.25 12.0005 18.25C15.9364 18.25 19.2999 15.7914 20.6356 12.3236C20.7158 12.1155 20.7158 11.8846 20.6356 11.6764C19.3 8.2086 15.9364 5.75 12.0004 5.75ZM1.96552 11.1372C3.51675 7.10978 7.42369 4.25 12.0004 4.25C16.5772 4.25 20.4842 7.10982 22.0354 11.1373C22.2492 11.6924 22.2492 12.3077 22.0354 12.8628C20.4841 16.8902 16.5772 19.75 12.0005 19.75C7.42369 19.75 3.51672 16.8902 1.96551 12.8627C1.75171 12.3076 1.75171 11.6923 1.96552 11.1372ZM12 9.75C10.7574 9.75 9.74999 10.7574 9.74999 12C9.74999 13.2426 10.7574 14.25 12 14.25C13.2426 14.25 14.25 13.2426 14.25 12C14.25 10.7574 13.2426 9.75 12 9.75ZM8.24999 12C8.24999 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.24999 14.0711 8.24999 12Z"
  />
</svg> `,g1e=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path d="M5 4L20 19" stroke="white" stroke-width="2" stroke-linecap="round" />
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.59938 7.54961C4.35061 7.21842 3.88046 7.1516 3.54927 7.40037C3.21808 7.64913 3.15126 8.11928 3.40002 8.45047C4.2023 9.51858 5.19943 10.4327 6.33872 11.1399L4.37596 14.084C4.1462 14.4287 4.23933 14.8943 4.58397 15.1241C4.92862 15.3538 5.39427 15.2607 5.62404 14.9161L7.62404 11.9161C7.6403 11.8917 7.65495 11.8667 7.66801 11.8412C8.77638 12.3299 9.98299 12.6369 11.25 12.7243V17.5C11.25 17.9143 11.5858 18.25 12 18.25C12.4142 18.25 12.75 17.9143 12.75 17.5V12.7243C14.0171 12.637 15.2237 12.3301 16.3322 11.8415C16.3452 11.8669 16.3598 11.8918 16.376 11.9161L18.376 14.9161C18.6057 15.2607 19.0714 15.3538 19.416 15.1241C19.7607 14.8943 19.8538 14.4287 19.624 14.084L17.6615 11.1403C18.8011 10.433 19.7985 9.51878 20.6009 8.45047C20.8497 8.11928 20.7828 7.64913 20.4516 7.40037C20.1205 7.1516 19.6503 7.21842 19.4015 7.54961C17.7127 9.79805 15.0263 11.2501 12.0005 11.2501C8.97467 11.2501 6.28823 9.79805 4.59938 7.54961Z"
  />
</svg> `;let pc=class extends me(De){constructor(){super(...arguments),this.renderColumn=t=>{const e=t.type==="title",n=t.hide?g1e:f1e,i=()=>{t.type!=="title"&&t.updateHide(!t.hide)},r=Qe({"property-item-op-icon":!0,disabled:e});return b` <div class="property-item">
      <div class="property-item-drag-bar"></div>
      <uni-lit class="property-item-icon" .uni="${t.icon}"></uni-lit>
      <div class="property-item-name">${t.name}</div>
      <div class="${r}" @click="${i}">${n}</div>
    </div>`},this.clickChangeAll=t=>{this.view.columnsWithoutFilter.forEach(e=>{this.view.columnGetType(e)!=="title"&&this.view.columnUpdateHide(e,t)})}}connectedCallback(){super.connectedCallback(),this._disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()})),this._disposables.addFromEvent(this,"pointerdown",t=>{t.stopPropagation()})}firstUpdated(){const t=new We(this.groupContainer,{animation:150,group:`properties-sort-${this.view.id}`,onEnd:e=>{const n=[...this.view.columnsWithoutFilter],i=e.oldIndex??-1,r=n[i];n.splice(i,1);const o=n[e.newIndex??-1];this.view.columnMove(r,o?{before:!0,id:o}:"end")}});this._disposables.add({dispose:()=>t.destroy()})}itemsGroup(){return this.view.columnsWithoutFilter.map(t=>this.view.columnGet(t))}render(){const t=this.itemsGroup(),e=t.every(i=>!i.hide),n=()=>this.clickChangeAll(e);return b`
      <div class="properties-group-header">
        <div class="properties-group-title dv-icon-20">
          <div
            @click=${this.onBack}
            style="display:flex;"
            class="dv-hover dv-round-4 dv-pd-2"
          >
            ${vb}
          </div>
          PROPERTIES
        </div>
        <div class="properties-group-op" @click="${n}">
          ${e?"Hide All":"Show All"}
        </div>
      </div>
      <div class="properties-group">
        ${Fe(t,i=>i.id,this.renderColumn)}
      </div>
    `}};pc.styles=X`
    data-view-properties-setting {
      position: absolute;
      background-color: var(--affine-background-overlay-panel-color);
      border-radius: 8px;
      box-shadow: var(--affine-shadow-2);
      padding: 8px;
      min-width: 300px;
    }

    .properties-group-header {
      user-select: none;
      padding: 4px 12px 12px 12px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--affine-divider-color);
    }

    .properties-group-title {
      font-size: 12px;
      line-height: 20px;
      color: var(--affine-text-secondary-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .properties-group-op {
      padding: 4px 8px;
      font-size: 12px;
      line-height: 20px;
      font-weight: 500;
      border-radius: 4px;
      cursor: pointer;
    }

    .properties-group-op:hover {
      background-color: var(--affine-hover-color);
    }

    .properties-group {
      min-height: 40px;
    }

    .property-item {
      padding: 4px;
      display: flex;
      align-items: center;
      gap: 8px;
      user-select: none;
      cursor: pointer;
      border-radius: 4px;
    }

    .property-item:hover {
      background-color: var(--affine-hover-color);
    }

    .property-item-drag-bar {
      width: 4px;
      height: 12px;
      border-radius: 1px;
      background-color: #efeff0;
    }

    .property-item:hover .property-item-drag-bar {
      background-color: #c0bfc1;
    }

    .property-item-icon {
      display: flex;
      align-items: center;
    }

    .property-item-icon svg {
      color: var(--affine-icon-color);
      fill: var(--affine-icon-color);
      width: 20px;
      height: 20px;
    }

    .property-item-op-icon {
      display: flex;
      align-items: center;
      border-radius: 4px;
    }

    .property-item-op-icon:hover {
      background-color: var(--affine-hover-color);
    }
    .property-item-op-icon.disabled:hover {
      background-color: transparent;
    }

    .property-item-op-icon svg {
      fill: var(--affine-icon-color);
      color: var(--affine-icon-color);
      width: 20px;
      height: 20px;
    }

    .property-item-op-icon.disabled svg {
      fill: var(--affine-text-disable-color);
      color: var(--affine-text-disable-color);
    }

    .property-item-name {
      font-size: 14px;
      line-height: 22px;
      flex: 1;
    }
  `;d4([L({attribute:!1})],pc.prototype,"view",2);d4([L({attribute:!1})],pc.prototype,"onBack",2);d4([he(".properties-group")],pc.prototype,"groupContainer",2);pc=d4([W("data-view-properties-setting")],pc);const m1e=(t,e)=>{const n=new pc;n.view=e.view,n.onBack=()=>{i(),e.onBack?.()};const i=du(t,n,{onClose:e.onClose})};var b1e=Object.defineProperty,v1e=Object.getOwnPropertyDescriptor,y1e=(t,e,n,i)=>{for(var r=i>1?void 0:i?v1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&b1e(e,n,r),r};const w1e=X`
  .affine-database-toolbar-item.more-action {
    padding: 2px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    cursor: pointer;
  }

  .affine-database-toolbar-item.more-action:hover {
    background: var(--affine-hover-color);
  }

  .affine-database-toolbar-item.more-action svg {
    width: 20px;
    height: 20px;
    fill: var(--affine-icon-color);
  }

  .more-action.active {
    background: var(--affine-hover-color);
  }
`;let Ep=class extends bu{constructor(){super(...arguments),this.clickMoreAction=t=>{t.stopPropagation(),this.showToolBar(!0);const e=ws(t);OA(e,this.view,()=>{this.showToolBar(!1)})}}showToolBar(t){const e=this.closest("data-view-header-tools");e&&(e.showToolBar=t)}render(){if(!this.view.readonly)return b` <div
      class="affine-database-toolbar-item more-action dv-icon-20"
      @click="${this.clickMoreAction}"
    >
      ${Xo}
    </div>`}};Ep.styles=w1e;Ep=y1e([W("data-view-header-tools-view-options")],Ep);const OA=(t,e,n)=>{const i=()=>{OA(t,e)};hn(t,{options:{style:"min-width:300px",input:{initValue:e.name,onComplete:r=>{e.updateName(r)}},items:[{type:"action",name:"Properties",icon:UT,postfix:ya,select:()=>{requestAnimationFrame(()=>{m1e(t,{view:e,onBack:i})})}},{type:"action",name:"Filter",icon:c3,postfix:ya,select:()=>{hA(t,{vars:e.vars,value:e.filter,onChange:e.updateFilter.bind(e),isRoot:!0,onBack:i,onDelete:()=>{e.updateFilter({...e.filter,conditions:[]})}})}},{type:"action",name:"Group",icon:A9,postfix:ya,select:()=>{e.view.groupBy?DA(t,e,i):u1e(t,e)}},{type:"action",name:"Duplicate",icon:il,select:()=>{e.duplicateView()}},{type:"group",name:"",children:()=>[{type:"action",name:"Delete View",icon:xn,select:()=>{e.deleteView()},class:"delete-item"}]}],onClose:n}})},zc=(t,e)=>{const n=e?.transform??(l=>l),i={data:e.onDrag(n(t)),move:l=>{i.data=e.onMove(l)}},r=()=>{window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",a),window.removeEventListener("keydown",o),e.onClear()},o=l=>{l.key==="Escape"&&r()},s=l=>{l.preventDefault(),i.data=e.onMove(n(l))},a=()=>{try{e.onDrop(i.data)}finally{r()}};return window.addEventListener("pointermove",s),window.addEventListener("pointerup",a),window.addEventListener("keydown",o),i};var x1e=Object.defineProperty,_1e=Object.getOwnPropertyDescriptor,C1e=(t,e,n,i)=>{for(var r=i>1?void 0:i?_1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&x1e(e,n,r),r};let tm=class extends De{render(){return b`
      <style>
        affine-database-new-record-preview {
          display: flex;
          align-items: center;
          justify-content: center;
          position: fixed;
          top: 0;
          left: 0;
          height: 32px;
          width: 32px;
          border: 1px solid var(--affine-border-color);
          border-radius: 50%;
          background: var(--affine-blue-100);
          box-shadow:
            0px 0px 10px rgba(0, 0, 0, 0.05),
            0px 0px 0px 0.5px var(--affine-black-10);
          cursor: none;
          user-select: none;
          pointer-events: none;
          caret-color: transparent;
          z-index: 99999;
        }

        affine-database-new-record-preview svg {
          width: 16px;
          height: 16px;
        }

        affine-database-new-record-preview path {
          fill: var(--affine-brand-color);
        }
      </style>
      ${Sr}
    `}};tm=C1e([W("affine-database-new-record-preview")],tm);var k1e=Object.defineProperty,E1e=Object.getOwnPropertyDescriptor,RA=(t,e,n,i)=>{for(var r=i>1?void 0:i?E1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&k1e(e,n,r),r};const S1e=X`
  .affine-database-toolbar-item.new-record {
    margin-left: 12px;
    display: flex;
    align-items: center;
    gap: 4px;
    width: 120px;
    height: 32px;
    padding: 6px 8px;
    border-radius: 8px;
    font-size: 14px;
    background: var(--affine-white);
    box-shadow: 0px 0px 0px 0.5px rgba(0, 0, 0, 0.1);
    cursor: grab;
  }

  .new-record svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-icon-color);
  }
`;let Sp=class extends bu{constructor(){super(...arguments),this.showToolBar=!1,this._dragStart=t=>{t.preventDefault(),t.stopPropagation();const e=this.closest("affine-data-view-native"),n=e?.querySelector("affine-database-table")?.getBoundingClientRect(),i=e?.querySelectorAll(".affine-database-block-row");if(!i||!n)return;const r=Array.from(i).map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-row-id"),top:c.top,bottom:c.bottom,mid:(c.top+c.bottom)/2,width:c.width,left:c.left}}),o=l=>{const c=r.find(d=>l<d.bottom);if(!(!c||l<c.top))return{position:{id:c.id,before:l<c.mid},y:l<c.mid?c.top:c.bottom,width:c.width,x:c.left}},s=T1e(),a=I1e();zc(t,{transform:l=>l,onDrag:()=>({}),onMove:l=>{a.display(l.x,l.y);const c=o(l.y);return c?s.display(n.left,c.y,n.width):s.remove(),{position:c?.position}},onDrop:l=>{l.position&&this.viewMethod.addRow?.(l.position)},onClear:()=>{s.remove(),a.remove()}})},this.addRow=t=>{this.viewMethod.addRow?.(t)},this._onAddNewRecord=()=>{if(this.readonly)return;const t=this.viewMethod.getSelection?.();if(!t)this.addRow("start");else if(t.type==="table"){const{rowsSelection:e,columnsSelection:n,focus:i}=t;let r=0;e&&!n||e&&n?r=e.end:!e&&!n&&i&&(r=i.rowIndex),this.addRow(r+1)}}}get readonly(){return this.view.readonly}connectedCallback(){super.connectedCallback(),this.readonly||this.disposables.addFromEvent(this,"pointerdown",t=>{this._dragStart(t)})}render(){if(!this.readonly)return b` <div
      class="affine-database-toolbar-item new-record"
      draggable="true"
      @click="${this._onAddNewRecord}"
    >
      ${Sr}<span>New Record</span>
    </div>`}};Sp.styles=S1e;RA([ie()],Sp.prototype,"showToolBar",2);Sp=RA([W("data-view-header-tools-add-row")],Sp);const T1e=()=>{const t=document.createElement("div");return t.classList.add("blocksuite-overlay"),t.setAttribute("data-is-drop-preview","true"),t.style.pointerEvents="none",t.style.position="fixed",t.style.zIndex="9999",t.style.height="4px",t.style.borderRadius="2px",t.style.backgroundColor="var(--affine-primary-color)",t.style.boxShadow="0px 0px 8px 0px rgba(30, 150, 235, 0.35)",{display(e,n,i){document.body.append(t),t.style.left=`${e}px`,t.style.top=`${n-2}px`,t.style.width=`${i}px`},remove(){t.remove()}}},I1e=()=>{const t=new tm;return t.classList.add("blocksuite-overlay"),document.body.append(t),{display(e,n){t.style.left=`${e}px`,t.style.top=`${n}px`},remove(){t.remove()}}};var L1e=Object.defineProperty,M1e=Object.getOwnPropertyDescriptor,u4=(t,e,n,i)=>{for(var r=i>1?void 0:i?M1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&L1e(e,n,r),r};const P1e=X`
  .affine-database-toolbar {
    display: flex;
    align-items: center;
    gap: 6px;
    visibility: hidden;
    opacity: 0;
    transition: opacity 150ms cubic-bezier(0.42, 0, 1, 1);
  }

  .toolbar-hover-container:hover .affine-database-toolbar {
    visibility: visible;
    opacity: 1;
  }

  .show-toolbar {
    visibility: visible;
    opacity: 1;
  }

  @media print {
    .affine-database-toolbar {
      display: none;
    }
  }
`;let Id=class extends me(De){constructor(){super(...arguments),this.showToolBar=!1}render(){if(this.view.isDeleted)return;const t=Qe({"show-toolbar":this.showToolBar,"affine-database-toolbar":!0}),e=fs.getView(this.view.type).tools;return b` <div class="${t}">
      ${Fe(e??[],n=>{const i={view:this.view,viewMethod:this.viewMethod};return oi(n,i)})}
    </div>`}};Id.styles=P1e;u4([L({attribute:!1})],Id.prototype,"viewMethod",2);u4([L({attribute:!1})],Id.prototype,"view",2);u4([ie()],Id.prototype,"showToolBar",2);Id=u4([W("data-view-header-tools")],Id);const A1e=(t,e)=>b` <data-view-header-tools
    .viewMethod="${e}"
    .view="${t}"
  ></data-view-header-tools>`;var $1e=Object.defineProperty,B1e=Object.getOwnPropertyDescriptor,Rv=(t,e,n,i)=>{for(var r=i>1?void 0:i?B1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&$1e(e,n,r),r};let Tp=class extends De{render(){return this.renderTemplate(this.props)}};Rv([L({attribute:!1})],Tp.prototype,"props",2);Rv([L({attribute:!1})],Tp.prototype,"renderTemplate",2);Tp=Rv([W("any-render")],Tp);const Nv=t=>{const e=new Tp;return e.renderTemplate=t,e};var D1e=Object.defineProperty,O1e=Object.getOwnPropertyDescriptor,h4=(t,e,n,i)=>{for(var r=i>1?void 0:i?O1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&D1e(e,n,r),r};let Ld=class extends me(De){constructor(){super(...arguments),this._setFilter=(t,e)=>{this.setData({...this.data,conditions:this.data.conditions.map((n,i)=>t===i?e:n)})},this.addFilter=t=>{aA(ws(t),{vars:this.vars,onSelect:e=>{const n=this.data.conditions.length;this.setData({...this.data,conditions:[...this.data.conditions,e]}),requestAnimationFrame(()=>{this.expandGroup(t,n)})}})},this.expandGroup=(t,e)=>{const n=this.data.conditions[e];n.type==="group"&&hA(ws(t),{isRoot:!1,vars:this.vars,value:n,onBack:()=>{},onChange:i=>this._setFilter(e,i),onDelete:()=>{this.deleteFilter(e)}})},this.renderMoreFilter=()=>b` <div
      class="dv-shadow-2 dv-round-8"
      style="padding: 8px;background-color: var(--affine-background-overlay-panel-color);display:flex;flex-direction: column;gap: 8px;"
    >
      ${Fe(this.data.conditions.slice(2),(t,e)=>b` <div style="width: max-content;">
            ${this.renderCondition(e+2)}
          </div>`)}
      <div class="dv-divider-h"></div>
      ${this.renderAddFilter()}
    </div>`}updated(){this.updateMoreFilterPanel?.()}showMoreFilter(t){const e=Nv(this.renderMoreFilter);e.style.position="absolute",this.updateMoreFilterPanel=()=>{if(this.data.conditions.length<=2){n(),this.updateMoreFilterPanel=void 0;return}e.requestUpdate()};const n=du(ws(t),e,{onClose:()=>{this.updateMoreFilterPanel=void 0}})}renderAddFilter(){return b` <div
      class="filter-bar-add-filter dv-icon-16 dv-round-4 dv-hover"
      @click="${this.addFilter}"
    >
      ${rl} Add filter
    </div>`}renderAddFilterOrMore(){const t=this.data.conditions.length;return t<=2?this.renderAddFilter():b` <div
      class="filter-bar-add-filter dv-icon-16 dv-round-4 dv-hover"
      @click="${this.showMoreFilter}"
    >
      ${t-2} More
    </div>`}renderCondition(t){const e=this.data.conditions[t],n=()=>{this.deleteFilter(t)};if(e.type==="filter")return b` <filter-condition-view
        .vars="${this.vars}"
        .data="${e}"
        .setData="${s=>this._setFilter(t,s)}"
        .onDelete="${n}"
      ></filter-condition-view>`;const i=s=>{this.expandGroup(s,t)},r=e.conditions.length,o=r>1?`${r} rules`:`${r} rule`;return b` <div class="filter-group-tag dv-icon-16 dv-border dv-round-8">
      <div
        class="dv-round-4 dv-hover"
        @click="${i}"
        style="display:flex;gap: 6px;padding: 0 4px;align-items:center;height: 100%;"
      >
        ${c3} ${o}
      </div>
      <div
        class="dv-icon-16 dv-round-4 dv-pd-4 dv-hover"
        style="display:flex;align-items:center;margin-left: 16px;"
        @click="${n}"
      >
        ${Xd}
      </div>
    </div>`}render(){const t=this.data.conditions;return b`
      ${Fe(t.slice(0,2),(e,n)=>this.renderCondition(n))}
      ${this.renderAddFilterOrMore()}
    `}deleteFilter(t){this.setData({...this.data,conditions:this.data.conditions.filter((e,n)=>n!==t)})}};Ld.styles=X`
    filter-bar {
      margin-top: 8px;
      display: flex;
      gap: 8px;
    }

    .filter-group-tag {
      font-size: 12px;
      font-style: normal;
      font-weight: 600;
      line-height: 20px;
      display: flex;
      align-items: center;
      padding: 4px;
      background-color: var(--affine-white);
    }

    .filter-bar-add-filter {
      color: var(--affine-text-secondary-color);
      padding: 4px 8px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 22px;
    }
  `;h4([L({attribute:!1})],Ld.prototype,"data",2);h4([L({attribute:!1})],Ld.prototype,"vars",2);h4([L({attribute:!1})],Ld.prototype,"setData",2);Ld=h4([W("filter-bar")],Ld);const R1e=t=>{if(!(!t||!t.filterVisible))return b`<filter-bar
    .vars=${t.vars}
    .data=${t.filter}
    .setData=${t.updateFilter.bind(t)}
  ></filter-bar>`};_p.register("table",{defaultName:"Table View",init(t,e,n){return{id:e,name:n,mode:"table",columns:[],filter:{type:"group",op:"and",conditions:[]},header:{titleColumn:t.columns.find(i=>i.type==="title")?.id,iconColumn:"type"}}}});const N1e=ge.object({viewId:ge.string(),type:ge.literal("table"),rowsSelection:ge.object({start:ge.number(),end:ge.number()}).optional(),columnsSelection:ge.object({start:ge.number(),end:ge.number()}).optional(),focus:ge.object({rowIndex:ge.number(),columnIndex:ge.number()}),isEditing:ge.boolean()}),H1e=ge.object({selectionType:ge.literal("cell"),groupKey:ge.string(),cardId:ge.string(),columnId:ge.string(),isEditing:ge.boolean()}),F1e=ge.object({selectionType:ge.literal("card"),cards:ge.array(ge.object({groupKey:ge.string(),cardId:ge.string()}))}),U1e=ge.object({selectionType:ge.literal("group"),groupKeys:ge.array(ge.string())}),V1e=ge.object({path:ge.array(ge.string()),viewSelection:ge.union([N1e,H1e,F1e,U1e])});class Va extends ck{static{this.type="database"}static{this.group="note"}constructor({path:e,viewSelection:n}){super({path:e}),this.viewSelection=n}get viewId(){return this.viewSelection.viewId}getSelection(e){return this.viewSelection.type===e?this.viewSelection:void 0}equals(e){return e instanceof Va?this.blockId===e.blockId:!1}toJSON(){return{type:"database",path:this.path,viewSelection:this.viewSelection}}static fromJSON(e){return V1e.parse(e),new Va({path:e.path,viewSelection:e.viewSelection})}}var z1e=Object.defineProperty,j1e=Object.getOwnPropertyDescriptor,Hv=(t,e,n,i)=>{for(var r=i>1?void 0:i?j1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&z1e(e,n,r),r};function G1e(t){const e=new Ip;e.database=t;const n=document.querySelector("editor-host");D(n);const i=cv(n),r=()=>{i.remove()},o=Nv(()=>b`
      <style>
        .database-block-preview-container {
          position: absolute;
          display: flex;
          padding: 24px 53px;
          border-radius: 8px;
          left: 0;
          right: 0;
          margin: 20px auto auto;
          width: calc(100% - 300px);
          max-height: calc(100% - 40px);
          box-shadow: var(--affine-shadow-1);
          background-color: var(--affine-background-primary-color);
        }
        .database-block-preview-close {
          position: absolute;
          right: -48px;
          top: 0;
          padding: 10px;
          border-radius: 8px;
          cursor: pointer;
          display: flex;
          background-color: var(--affine-background-primary-color);
        }
        .database-block-preview-close svg {
          color: var(--affine-icon-color);
          width: 16px;
          height: 16px;
        }
        .database-block-preview-close:hover {
          background-color: var(--affine-hover-color-filled);
        }
      </style>
      <div class="database-block-preview-container">
        <database-block-modal-preview
          .database="${t}"
        ></database-block-modal-preview>
        <div @click="${r}" class="database-block-preview-close">
          ${Xd}
        </div>
      </div>
    `);o.onclick=s=>{s.stopPropagation()},i.onclick=r,i.style.backgroundColor="var(--affine-black-60)",i.append(o)}let F5=class extends me(De){constructor(){super(...arguments),this.expandDatabase=()=>{const t=this.closest("affine-database");t&&G1e(t)}}get database(){return this.closest("affine-database")}render(){if(!(this.closest("database-block-modal-preview")||!this.database?.page.awarenessStore.getFlag("enable_expand_database_block")))return b` <div
      @click="${this.expandDatabase}"
      class="dv-icon-20 dv-pd-2 dv-hover dv-round-4"
      style="display:flex;"
    >
      ${jL}
    </div>`}};F5=Hv([W("expand-database-block-modal")],F5);let Ip=class extends me(De){constructor(){super(...arguments),this.path=["modal","preview"],this.selectionUpdated=new Ve,this.setSelection=t=>{this.database.host.selection.set(t?[new Va({path:this.path,viewSelection:t})]:[])},this.bindHotkey=t=>({dispose:this.database.host.event.bindHotkey(t,{path:[]})}),this.handleEvent=(t,e)=>({dispose:this.database.host.event.add(t,e,{path:[]})})}connectedCallback(){super.connectedCallback(),this.database.selection.slots.changed.on(t=>{const e=t.find(n=>gt.equals(n.path,this.path));e&&e instanceof Va?this.selectionUpdated.emit(e.viewSelection):this.selectionUpdated.emit(void 0)})}firstUpdated(t){super.firstUpdated(t),requestAnimationFrame(()=>{this.querySelector("affine-data-view-native")?.focusFirstCell()})}render(){const t={bindHotkey:this.bindHotkey,handleEvent:this.handleEvent,getFlag:this.database.getFlag,selectionUpdated:this.selectionUpdated,setSelection:this.setSelection,dataSource:this.database.dataSource,viewSource:this.database.viewSource,headerComponent:this.database.headerComponent,std:this.database.std};return b`
      <affine-data-view-native .config="${t}"></affine-data-view-native>
    `}};Ip.styles=X`
    database-block-modal-preview {
      display: flex;
      flex-direction: column;
      flex: 1;
      overflow: hidden;
    }
  `;Hv([L({attribute:!1})],Ip.prototype,"database",2);Ip=Hv([W("database-block-modal-preview")],Ip);const Z1e=t=>{let e=0,n=0;const i=()=>{e=requestAnimationFrame(r=>{try{t(r-n)}finally{n=r,i()}})};return i(),()=>{cancelAnimationFrame(e)}},NA=(t,e,n)=>Math.max(e,Math.min(n,t)),W1e=180,Fv=100,HA=36,q1e=40,Uv=8,n7=t=>{const e=t.closest(".affine-database-table-container");return D(e),e};var Y1e=Object.defineProperty,X1e=Object.getOwnPropertyDescriptor,p4=(t,e,n,i)=>{for(var r=i>1?void 0:i?X1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Y1e(e,n,r),r};let fc=class extends me(De){renderGroup(t){const e=this.tableViewManager.columnGetIndex(this.column.id);return Be`
      <div
        style="background-color: var(--affine-background-primary-color);border-top: 1px solid var(--affine-border-color);box-shadow: var(--affine-shadow-2);"
      >
        <affine-database-header-column
          .tableViewManager="${this.tableViewManager}"
          .column="${this.column}"
        ></affine-database-header-column>
        ${Fe(t,(n,i)=>{const r=this.table.querySelector(`affine-database-cell-container[data-row-id="${n}"]`)?.clientHeight,o=we({height:r+"px"});return Be`<div
            style="border-top: 1px solid var(--affine-border-color)"
          >
            <div style="${o}">
              <affine-database-cell-container
                .column="${this.column}"
                .view="${this.tableViewManager}"
                .rowId="${n}"
                .columnId="${this.column.id}"
                .rowIndex="${i}"
                .columnIndex="${e}"
              ></affine-database-cell-container>
            </div>
          </div>`})}
      </div>
      <div style="height: 45px;"></div>
    `}render(){const t=this.tableViewManager.groupHelper;if(!t){const e=this.tableViewManager.rows;return this.renderGroup(e)}return t.groups.map(e=>Be`
        <div style="height: 40px;"></div>
        ${this.renderGroup(e.rows)}
      `)}};fc.styles=X`
    affine-data-view-column-preview {
      pointer-events: none;
      display: block;
    }
  `;p4([L({attribute:!1})],fc.prototype,"tableViewManager",2);p4([L({attribute:!1})],fc.prototype,"column",2);p4([L({attribute:!1})],fc.prototype,"table",2);fc=p4([W("affine-data-view-column-preview")],fc);var K1e=Object.defineProperty,Q1e=Object.getOwnPropertyDescriptor,yu=(t,e,n,i)=>{for(var r=i>1?void 0:i?Q1e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&K1e(e,n,r),r};let Vs=class extends me(De){constructor(){super(...arguments),this.shadow=!1}render(){const t=we({top:`${this.top}px`,left:`${this.left}px`,width:`${Math.max(this.width,1)}px`});return b`
      <div class="vertical-indicator-container" style=${t}>
        ${Fe(this.lines,({top:e,bottom:n})=>{const i=we({top:`${e}px`,height:`${n-e}px`}),r=Qe({"with-shadow":this.shadow,"vertical-indicator-group":!0});return b`<div class="${r}" style=${i}></div>`})}
      </div>
    `}};Vs.styles=X`
    data-view-table-vertical-indicator {
      position: fixed;
      left: 0;
      top: 0;
      z-index: 1;
      pointer-events: none;
    }

    .vertical-indicator-container {
      position: absolute;
      pointer-events: none;
    }

    .vertical-indicator-group {
      position: absolute;
      z-index: 1;
      width: 100%;
      background-color: var(--affine-hover-color);
      pointer-events: none;
    }
    .vertical-indicator-group::after {
      position: absolute;
      z-index: 1;
      width: 2px;
      height: 100%;
      content: '';
      right: 0;
      background-color: var(--affine-primary-color);
      border-radius: 1px;
    }
    .with-shadow.vertical-indicator-group::after {
      box-shadow: 0px 0px 8px 0px rgba(30, 150, 235, 0.35);
    }
  `;yu([L({attribute:!1})],Vs.prototype,"top",2);yu([L({attribute:!1})],Vs.prototype,"left",2);yu([L({attribute:!1})],Vs.prototype,"width",2);yu([L({attribute:!1})],Vs.prototype,"lines",2);yu([L({attribute:!1})],Vs.prototype,"shadow",2);Vs=yu([W("data-view-table-vertical-indicator")],Vs);const nm=t=>{const e=t.getBoundingClientRect(),n=t.querySelectorAll("affine-data-view-table-group");return Array.from(n).map(i=>{const r=i.getBoundingClientRect(),o=i.querySelector("affine-database-column-header")?.getBoundingClientRect().top??r.top,s=i.querySelector(".affine-database-block-rows")?.getBoundingClientRect().bottom??r.bottom;return{top:o-e.top,bottom:s-e.top}})},J1e=(t,e,n,i)=>{const r=i.width/n,o=e.getBoundingClientRect(),s=e.querySelector(`affine-database-header-column[data-column-id='${i.id}']`)?.getBoundingClientRect().left??0,a=nm(e),l=x2();l.display(i.width*r,o.top,a,s),e.style.pointerEvents="none",zc(t,{onDrag:()=>({width:i.width}),onMove:({x:c})=>{const d=Math.round(NA((c-s)/r,Fv,1/0));return l.display(d*r,o.top,a,s),{width:d}},onDrop:({width:c})=>{i.updateWidth(c)},onClear:()=>{e.style.pointerEvents="auto",l.remove()}})};let i7=null;const x2=()=>{if(!i7){const t=new Vs;t.classList.add("blocksuite-overlay"),i7={display(e,n,i,r,o=!1){document.body.append(t),t.left=r,t.lines=i,t.top=n,t.width=e,t.shadow=o},remove(){t.remove()}}}return i7};var ede=Object.defineProperty,tde=Object.getOwnPropertyDescriptor,f4=(t,e,n,i)=>{for(var r=i>1?void 0:i?tde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ede(e,n,r),r};let _s=class extends me(De){constructor(){super(...arguments),this.grabStatus="grabEnd",this.widthDragBar=Ri(),this._columnsOffset=(t,e)=>{const n=t.querySelectorAll("affine-database-header-column"),i=[],r=[];let o=i;const s=[],a=Array.from(n);for(let u=0;u<a.length;u++){const h=a[u];if(h===this){o=r,s.push(-1);continue}o.push({x:h.offsetLeft+h.offsetWidth/2,ele:h}),s.push(h.getBoundingClientRect().left-t.getBoundingClientRect().left),u===a.length-1&&s.push(h.getBoundingClientRect().right-t.getBoundingClientRect().left)}i.reverse();const l=(u,h)=>{let p;for(let f=0;f<i.length;f++){const{x:v,ele:m}=i[f];if(v<u){if(p)return p;break}else p={before:!0,id:m.column.id}}const g=u+h;for(const{x:f,ele:v}of r)if(f>g){if(p)return p;break}else p={before:!1,id:v.column.id};return p},c=a.map(u=>({id:u.column.id})),d=u=>s[Qr(u,c)];return{computeInsertInfo:(u,h)=>{const p=l(u,h);return{insertPosition:p,insertOffset:p?d(p):void 0}}}},this._drag=t=>{const e=n7(this),n=this.closest("affine-database-column-header"),i=e?.parentElement;D(n),D(e),D(i);const r=this.getBoundingClientRect(),o=r.width/this.column.width,s=i.getBoundingClientRect(),a=e.getBoundingClientRect(),l=t.x-r.left,c=r.right-t.x,d=(r.left-a.left)/o,u=(a.width-r.width)/o,{computeInsertInfo:h}=this._columnsOffset(n,o),p=new fc;p.tableViewManager=this.tableViewManager,p.column=this.column,p.table=e;const g=nde(e,r.width/o,a.height/o,d,p),f=nm(e),v=x2(),m=Z1e(T=>{const M=T*.4;x.data.x<s.left+l?(i.scrollLeft-=M,x.move({x:x.data.x})):x.data.x>s.right-c&&(i.scrollLeft+=M,x.move({x:x.data.x}))}),y=document.querySelector("html");y?.classList.toggle("affine-database-header-column-grabbing",!0);const x=zc(t,{onDrag:T=>(this.grabStatus="grabbing",{x:T.x}),onMove:({x:T})=>{this.grabStatus="grabbing";const M=NA((T-e.getBoundingClientRect().left-l)/o,0,u),k=h(M,r.width/o);return k.insertOffset!=null?v.display(0,a.top,f,e.getBoundingClientRect().left+k.insertOffset,!0):v.remove(),g.display(M),{x:T,insertPosition:k.insertPosition}},onDrop:({insertPosition:T})=>{this.grabStatus="grabEnd",T&&this.tableViewManager.columnMove(this.column.id,T)},onClear:()=>{m(),y?.classList.toggle("affine-database-header-column-grabbing",!1),v.remove(),g.remove()}})},this.editTitle=()=>{this._clickColumn()},this._clickColumn=()=>{this.tableViewManager.readonly||this.popMenu()},this._contextMenu=t=>{t.preventDefault(),this.popMenu(gd(t.x,t.y))},this._clickTypeIcon=t=>{this.tableViewManager.readonly||this.column.type!=="title"&&(t.stopPropagation(),hn(this,{options:{input:{search:!0,placeholder:"Search"},items:this.tableViewManager.allColumnConfig.map(e=>({type:"action",name:e.name,isSelected:e.type===this.column.type,icon:Be` <uni-lit
              .uni="${this.tableViewManager.getIcon(e.type)}"
            ></uni-lit>`,select:()=>{this.column.updateType?.(e.type)}}))}}))},this.drawWidthDragBarTask=0,this.drawWidthDragBar=()=>{const t=n7(this),e=t.getBoundingClientRect(),n=nm(t);x2().display(0,e.top,n,this.getBoundingClientRect().right),this.drawWidthDragBarTask=requestAnimationFrame(this.drawWidthDragBar)},this._enterWidthDragBar=()=>{this.drawWidthDragBarTask&&(cancelAnimationFrame(this.drawWidthDragBarTask),this.drawWidthDragBarTask=0),this.drawWidthDragBar()},this._leaveWidthDragBar=()=>{cancelAnimationFrame(this.drawWidthDragBarTask),this.drawWidthDragBarTask=0,x2().remove()}}connectedCallback(){super.connectedCallback(),this.disposables.add(this.tableViewManager.slots.update.on(()=>{this.requestUpdate()}));const t=this.closest("affine-database-table");t&&this.disposables.add(t.handleEvent("dragStart",e=>{const n=e.get("pointerState").raw,i=n.target;if(i instanceof Element){if(this.widthDragBar.value?.contains(i))return n.preventDefault(),this.widthDragStart(n),!0;if(this.contains(i))return n.preventDefault(),this._drag(n),!0}return!1}))}get readonly(){return this.tableViewManager.readonly}popMenu(t){hn(t??this,{options:{input:{initValue:this.column.name,onComplete:e=>{this.column.updateName(e)}},items:[{type:"sub-menu",name:"Column Type",icon:h0,hide:()=>!this.column.updateType||this.column.type==="title",options:{input:{search:!0},items:this.tableViewManager.allColumnConfig.map(e=>({type:"action",isSelected:e.type===this.column.type,name:e.name,icon:Be` <uni-lit
                    .uni="${this.tableViewManager.getIcon(e.type)}"
                  ></uni-lit>`,select:()=>{this.column.type!==e.type&&this.column.updateType?.(e.type)}}))}},{type:"action",name:"Duplicate Column",icon:I9,hide:()=>!this.column.duplicate||this.column.type==="title",select:()=>{this.column.duplicate?.(),Promise.resolve().then(()=>{const e=this.nextElementSibling;e instanceof _s&&(e.editTitle(),e.scrollIntoView())}).catch(console.error)}},{type:"action",name:"Insert Left Column",icon:HT,select:()=>{this.tableViewManager.columnAdd({id:this.column.id,before:!0}),Promise.resolve().then(()=>{const e=this.previousElementSibling;e instanceof _s&&(e.editTitle(),e.scrollIntoView())}).catch(console.error)}},{type:"action",name:"Insert Right Column",icon:FT,select:()=>{this.tableViewManager.columnAdd({id:this.column.id,before:!1}),Promise.resolve().then(()=>{const e=this.nextElementSibling;e instanceof _s&&(e.editTitle(),e.scrollIntoView())}).catch(console.error)}},{type:"action",name:"Move Left",icon:L9,hide:()=>this.column.isFirst,select:()=>{const e=this.tableViewManager.columnGetPreColumn(this.column.id)?.id;e&&this.tableViewManager.columnMove(this.column.id,{id:e,before:!0})}},{type:"action",name:"Move Right",icon:M9,hide:()=>this.column.isLast,select:()=>{const e=this.tableViewManager.columnGetNextColumn(this.column.id)?.id;e&&this.tableViewManager.columnMove(this.column.id,{id:e,before:!1})}},{type:"group",name:"operation",children:()=>[{type:"action",name:"Delete Column",icon:xn,hide:()=>!this.column.delete||this.column.type==="title",select:()=>{this.column.delete?.()},class:"delete-item"}]}]}})}render(){const t=this.column,e=we({height:HA+"px"}),n=Qe({"affine-database-column-move":!0,[this.grabStatus]:!0});return Be`
      <div
        style=${e}
        class="affine-database-column-content"
        @click="${this._clickColumn}"
        @contextmenu="${this._contextMenu}"
      >
        ${this.readonly?null:Be`<button class=${n}>
              <div class="hover-trigger"></div>
              <div class="control-h"></div>
              <div class="control-l"></div>
              <div class="control-r"></div>
            </button>`}
        <div class="affine-database-column-text ${t.type}">
          <div
            class="affine-database-column-type-icon dv-hover"
            @click="${this._clickTypeIcon}"
          >
            <uni-lit .uni="${t.icon}"></uni-lit>
          </div>
          <div class="affine-database-column-text-content">
            <div class="affine-database-column-text-input">${t.name}</div>
          </div>
        </div>
      </div>
      <div
        ${$t(this.widthDragBar)}
        @mouseenter=${this._enterWidthDragBar}
        @mouseleave=${this._leaveWidthDragBar}
        style="width: 0;position: relative;height: 100%;z-index: 1;cursor: col-resize"
      >
        <div style="width: 8px;height: 100%;margin-left: -4px;"></div>
      </div>
    `}widthDragStart(t){J1e(t,n7(this),this.getBoundingClientRect().width,this.column)}};_s.styles=X`
    affine-database-header-column {
      display: flex;
    }
    .affine-database-header-column-grabbing * {
      cursor: grabbing;
    }
  `;f4([L({attribute:!1})],_s.prototype,"tableViewManager",2);f4([L({attribute:!1})],_s.prototype,"column",2);f4([L({attribute:!1})],_s.prototype,"grabStatus",2);_s=f4([W("affine-database-header-column")],_s);const nde=(t,e,n,i,r)=>{const o=document.createElement("div");return o.append(r),o.style.opacity="0.8",o.style.position="absolute",o.style.width=`${e}px`,o.style.height=`${n}px`,o.style.left=`${i}px`,o.style.top="0px",o.style.zIndex="9",t.append(o),{display(s){o.style.left=`${Math.round(s)}px`},remove(){o.remove()}}},ide=X`
  .affine-database-column-header {
    position: relative;
    display: flex;
    flex-direction: row;
    border-bottom: 1px solid var(--affine-border-color);
    border-top: 1px solid var(--affine-border-color);
    box-sizing: border-box;
    user-select: none;
  }

  .affine-database-column {
    cursor: pointer;
  }
  .database-cell {
    min-width: ${Fv}px;
  }
  .database-cell.add-column-button {
    flex: 1;
    min-width: ${q1e}px;
    min-height: 100%;
    display: flex;
    align-items: center;
  }
  .affine-database-column-content {
    display: flex;
    align-items: center;
    gap: 6px;
    width: 100%;
    height: 100%;
    padding: 8px;
    box-sizing: border-box;
    position: relative;
  }
  .affine-database-column-content:hover,
  .affine-database-column-content.edit {
    background: var(--affine-hover-color);
  }
  .affine-database-column-content.edit .affine-database-column-text-icon {
    opacity: 1;
  }
  .affine-database-column-text {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 6px;
    /* https://stackoverflow.com/a/36247448/15443637 */
    overflow: hidden;
    color: var(--affine-text-secondary-color);
    font-size: 14px;
    position: absolute;
  }
  .affine-database-column-type-icon {
    display: flex;
    align-items: center;
    border-radius: 4px;
    padding: 2px;
  }
  .affine-database-column-type-icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-icon-color);
  }
  .affine-database-column-text-content {
    flex: 1;
    display: flex;
    align-items: center;
    overflow: hidden;
  }
  .affine-database-column-content:hover .affine-database-column-text-icon {
    opacity: 1;
  }
  .affine-database-column-text-input {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .affine-database-column-text-icon {
    display: flex;
    align-items: center;
    width: 16px;
    height: 16px;
    background: var(--affine-white);
    border: 1px solid var(--affine-border-color);
    border-radius: 4px;
    opacity: 0;
  }
  .affine-database-column-text-save-icon {
    display: flex;
    align-items: center;
    width: 16px;
    height: 16px;
    border: 1px solid transparent;
    border-radius: 4px;
    fill: var(--affine-icon-color);
  }
  .affine-database-column-text-save-icon:hover {
    background: var(--affine-white);
    border-color: var(--affine-border-color);
  }
  .affine-database-column-text-icon svg {
    fill: var(--affine-icon-color);
  }
  .affine-database-column-input {
    width: 100%;
    height: 24px;
    padding: 0;
    border: none;
    color: inherit;
    font-weight: 600;
    font-size: 14px;
    font-family: ${Je(vt.fontSansFamily)};
    background: transparent;
  }
  .affine-database-column-input:focus {
    outline: none;
  }
  .affine-database-column-move {
    display: flex;
    align-items: center;
  }
  .affine-database-column-move svg {
    width: 10px;
    height: 14px;
    color: var(--affine-black-10);
    cursor: grab;
    opacity: 0;
  }
  .affine-database-column-content:hover svg {
    opacity: 1;
  }

  .affine-database-add-column-button {
    position: sticky;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 38px;
    cursor: pointer;
  }
  .header-add-column-button {
    height: ${HA}px;
    background-color: var(--affine-background-primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    cursor: pointer;
  }
  .header-add-column-button svg {
    color: var(--affine-icon-color);
  }

  .affine-database-column-move-preview {
    position: fixed;
    z-index: 100;
    width: 100px;
    height: 100px;
    background: var(--affine-text-emphasis-color);
  }

  .affine-database-column-move {
    --color: var(--affine-placeholder-color);
    --active: var(--affine-black-10);
    --bw: 1px;
    --bw2: -1px;
    cursor: grab;
    background: none;
    border: none;
    border-radius: 0;
    position: absolute;
    inset: 0;
  }
  .affine-database-column-move .control-l::before,
  .affine-database-column-move .control-h::before,
  .affine-database-column-move .control-l::after,
  .affine-database-column-move .control-h::after,
  .affine-database-column-move .control-r,
  .affine-database-column-move .hover-trigger {
    --delay: 0s;
    --delay-opacity: 0s;
    content: '';
    position: absolute;
    transition:
      all 0.2s ease var(--delay),
      opacity 0.2s ease var(--delay-opacity);
  }
  .affine-database-column-move .control-r {
    --delay: 0s;
    --delay-opacity: 0.6s;
    width: 4px;
    border-radius: 1px;
    height: 32%;
    background: var(--color);
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0;
    pointer-events: none;
  }
  .affine-database-column-move .hover-trigger {
    width: 12px;
    height: 80%;
    right: 3px;
    top: 10%;
    background: transparent
    z-index: 1;
    opacity: 1;
  }
  .affine-database-column-move:hover .control-r {
    opacity: 1;
  }
  .affine-database-column-move .control-h::before,
  .affine-database-column-move .control-h::after {
    --delay: 0.2s;
    width: calc(100% - var(--bw2) * 2);
    opacity: 0;
    height: var(--bw);
    right: var(--bw2);
    background: var(--active);
  }
  .affine-database-column-move .control-h::before {
    top: var(--bw2);
  }
  .affine-database-column-move .control-h::after {
    bottom: var(--bw2);
  }
  .affine-database-column-move .control-l::before{
    --delay: 0s;
    width: var(--bw);
    height: 100%;
    opacity: 0;
    background: var(--active);
    left: var(--bw2);
  }
  .affine-database-column-move .control-l::before {
    top: 0;
  }
  .affine-database-column-move .control-l::after {
    bottom: 0;
  }

  /* handle--active style */
  .affine-database-column-move:hover .control-r {
    --delay-opacity: 0s;
    opacity: 1;
  }
  .affine-database-column-move:active .control-r,
  .hover-trigger:hover ~ .control-r,
  .grabbing.affine-database-column-move .control-r {
    opacity: 1;
    --delay: 0s;
    --delay-opacity: 0s;
    right: var(--bw2);
    width: var(--bw);
    height: 100%;
    background: var(--active);
  }
  .affine-database-column-move:active .control-h::before,
  .affine-database-column-move:active .control-h::after,
  .hover-trigger:hover ~ .control-h::before,
  .hover-trigger:hover ~ .control-h::after,
  .grabbing.affine-database-column-move .control-h::before,
  .grabbing.affine-database-column-move .control-h::after {
    --delay: 0.2s;
    width: calc(100% - var(--bw2) * 2);
    opacity: 1;
  }

  .affine-database-column-move:active .control-l::before,
  .affine-database-column-move:active .control-l::after,
  .hover-trigger:hover ~ .control-l::before,
  .hover-trigger:hover ~ .control-l::after,
  .grabbing.affine-database-column-move .control-l::before,
  .grabbing.affine-database-column-move .control-l::after {
    --delay: 0.4s;
    opacity: 1;
  }
`;var rde=Object.defineProperty,ode=Object.getOwnPropertyDescriptor,FA=(t,e,n,i)=>{for(var r=i>1?void 0:i?ode(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&rde(e,n,r),r};let U5=class extends me(De){constructor(){super(...arguments),this.addColumnPositionRef=Ri(),this.addColumnButton=Nv(()=>this.readonly?ae:Be`<div
      @click="${this._onAddColumn}"
      class="header-add-column-button dv-hover"
    >
      ${rl}
    </div>`),this.updateAddButton=()=>{const t=this.addColumnPositionRef.value;t&&ii(t,this.addColumnButton,{middleware:[tr({boundary:this.closest("affine-database-table")??this,padding:-20})]}).then(({x:e,y:n})=>{Object.assign(this.addColumnButton.style,{left:`${e}px`,top:`${n}px`})}).catch(console.error)},this._onAddColumn=()=>{this.readonly||(this.tableViewManager.columnAdd("end"),requestAnimationFrame(()=>{this.editLastColumnTitle()}))},this.editLastColumnTitle=()=>{const t=this.querySelectorAll("affine-database-header-column"),e=t.item(t.length-1);e.scrollIntoView({block:"nearest",inline:"nearest"}),e.editTitle()}}get readonly(){return this.tableViewManager.readonly}connectedCallback(){super.connectedCallback(),this.disposables.add(this.tableViewManager.slots.update.on(()=>{this.requestUpdate()}));const t=this.closest("affine-data-view-table-group");t&&(this.disposables.addFromEvent(t,"mouseenter",()=>{this.addColumnButton.style.visibility="visible"}),this.disposables.addFromEvent(t,"mouseleave",()=>{this.addColumnButton.style.visibility="hidden"}),this.disposables.addFromEvent(this.addColumnButton,"mouseenter",()=>{this.addColumnButton.style.visibility="visible"}),this.disposables.addFromEvent(this.addColumnButton,"mouseleave",()=>{this.addColumnButton.style.visibility="hidden"}),this.addColumnButton.style.visibility="hidden",this.addColumnButton.style.transition="visibility 0.2s",this.addColumnButton.style.marginLeft="20px",this.addColumnButton.style.position="absolute",this.addColumnButton.style.zIndex="1",this.closest("affine-data-view-native")?.append(this.addColumnButton),requestAnimationFrame(()=>{const e=this.addColumnPositionRef.value;if(!e)return;const n=zl(e,this.addColumnButton,this.updateAddButton);this.disposables.add({dispose:()=>{n(),this.addColumnButton.remove()}})}))}render(){return this.updateAddButton(),Be`
      <div class="affine-database-column-header database-row">
        <div class="data-view-table-left-bar"></div>
        ${Fe(this.tableViewManager.columnManagerList,t=>t.id,(t,e)=>{const n=we({width:`${t.width}px`,border:e===0?"none":void 0});return Be` <affine-database-header-column
              style="${n}"
              data-column-id="${t.id}"
              data-column-index="${e}"
              class="affine-database-column database-cell"
              .column="${t}"
              .tableViewManager="${this.tableViewManager}"
            ></affine-database-header-column>`})}
        <div
          style="background-color: var(--affine-border-color);width: 1px;"
        ></div>
        <div style="height: 0;" ${$t(this.addColumnPositionRef)}></div>
      </div>
    `}};U5.styles=ide;FA([L({attribute:!1})],U5.prototype,"tableViewManager",2);U5=FA([W("affine-database-column-header")],U5);var sde=Object.defineProperty,ade=Object.getOwnPropertyDescriptor,gl=(t,e,n,i)=>{for(var r=i>1?void 0:i?ade(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&sde(e,n,r),r};let Ro=class extends me(De){constructor(){super(...arguments),this.isEditing=!1,this.selectCurrentCell=t=>{this.selectionView&&(this.selectionView.selection={groupKey:this.groupKey,focus:{rowIndex:this.rowIndex,columnIndex:this.columnIndex},isEditing:t})},this._cell=Ri()}get selectionView(){return this.closest("affine-database-table")?.selectionController}get groupKey(){return this.closest("affine-data-view-table-group")?.group?.key}get readonly(){return this.column.readonly}get table(){const t=this.closest("affine-database-table");return D(t),t}get cell(){return this._cell.value}connectedCallback(){super.connectedCallback(),this._disposables.addFromEvent(this,"click",()=>{this.isEditing||this.selectCurrentCell(!this.column.readonly)})}render(){const{edit:t,view:e}=this.column.renderer,n=!this.readonly&&this.isEditing&&t!=null?t:e,i={view:this.view,column:this.column,rowId:this.rowId,isEditing:this.isEditing,selectCurrentCell:this.selectCurrentCell};return oi(n,i,{ref:this._cell,style:{display:"contents"}})}};Ro.styles=X`
    affine-database-cell-container {
      display: flex;
      align-items: start;
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
    }

    affine-database-cell-container * {
      box-sizing: border-box;
    }

    affine-database-cell-container uni-lit > *:first-child {
      padding: 8px;
    }
  `;gl([ie()],Ro.prototype,"isEditing",2);gl([L({attribute:!1})],Ro.prototype,"view",2);gl([L({attribute:!1})],Ro.prototype,"rowId",2);gl([L({attribute:!1})],Ro.prototype,"rowIndex",2);gl([L({attribute:!1})],Ro.prototype,"columnId",2);gl([L({attribute:!1})],Ro.prototype,"columnIndex",2);gl([L({attribute:!1})],Ro.prototype,"column",2);Ro=gl([W("affine-database-cell-container")],Ro);var lde=Object.defineProperty,cde=Object.getOwnPropertyDescriptor,wu=(t,e,n,i)=>{for(var r=i>1?void 0:i?cde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&lde(e,n,r),r};let zs=class extends me(De){constructor(){super(...arguments),this.isFocus=!1,this.editing=!1,this._cell=Ri(),this.changeEditing=t=>{const e=this.closest("affine-data-view-record-detail")?.selection;e&&(e.selection={propertyId:this.column.id,isEditing:t})},this._click=t=>{t.stopPropagation(),!this.readonly&&this.changeEditing(!0)},this._clickLeft=t=>{if(this.readonly)return;const e=t.currentTarget,n=this.view.detailColumns;hn(e,{options:{input:{initValue:this.column.name,onComplete:i=>{this.column.updateName(i)}},items:[{type:"sub-menu",name:"Column Type",icon:h0,hide:()=>!this.column.updateType||this.column.type==="title",options:{input:{search:!0},items:this.view.allColumnConfig.filter(i=>i.type!==this.column.type).map(i=>({type:"action",name:i.name,icon:Be` <uni-lit
                      .uni="${this.view.getIcon(i.type)}"
                    ></uni-lit>`,select:()=>{this.column.updateType?.(i.type)}}))}},{type:"action",name:"Duplicate Column",icon:I9,hide:()=>!this.column.duplicate||this.column.type==="title",select:()=>{this.column.duplicate?.()}},{type:"action",name:"Move Up",icon:Be` <div
              style="transform: rotate(90deg);display:flex;align-items:center;"
            >
              ${L9}
            </div>`,hide:()=>n.findIndex(i=>i===this.column.id)===0,select:()=>{const i=n.findIndex(o=>o===this.column.id),r=n[i-1];r&&this.view.columnMove(this.column.id,{id:r,before:!0})}},{type:"action",name:"Move Down",icon:Be` <div
              style="transform: rotate(90deg);display:flex;align-items:center;"
            >
              ${M9}
            </div>`,hide:()=>n.findIndex(i=>i===this.column.id)===n.length-1,select:()=>{const i=n.findIndex(o=>o===this.column.id),r=n[i+1];r&&this.view.columnMove(this.column.id,{id:r,before:!1})}},{type:"group",name:"operation",children:()=>[{type:"action",name:"Delete Column",icon:xn,hide:()=>!this.column.delete||this.column.type==="title",select:()=>{this.column.delete?.()},class:"delete-item"}]}]}})}}get readonly(){return this.view.readonly}get cell(){return this._cell.value}render(){const t=this.column,e={view:this.view,column:this.column,rowId:this.rowId,isEditing:this.editing,selectCurrentCell:this.changeEditing},{view:n,edit:i}=this.column.renderer,r=Qe({"field-content":!0,"is-editing":this.editing,"is-focus":this.isFocus});return Be`
      <div class="field-left" @click="${this._clickLeft}">
        <div class="icon">
          <uni-lit .uni="${this.column.icon}"></uni-lit>
        </div>
        <div class="filed-name">${t.name}</div>
      </div>
      <div @click="${this._click}" class="${r}">
        ${oi(this.editing&&i?i:n,e,{ref:this._cell,class:"kanban-cell"})}
      </div>
    `}};zs.styles=X`
    affine-data-view-record-field {
      display: flex;
      gap: 12px;
    }

    .field-left {
      padding: 4px 6px 4px 4px;
      display: flex;
      height: max-content;
      align-items: center;
      gap: 4px;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      color: var(--affine-text-secondary-color);
      width: 116px;
      border-radius: 4px;
      cursor: pointer;
    }

    .field-left:hover {
      background-color: var(--affine-hover-color);
    }

    affine-data-view-record-field .icon {
      display: flex;
      align-items: center;
      width: 16px;
      height: 16px;
    }

    affine-data-view-record-field .icon svg {
      width: 16px;
      height: 16px;
      fill: var(--affine-icon-color);
    }

    .filed-name {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .field-content {
      padding: 4px 6px;
      border-radius: 4px;
      flex: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      border: 1px solid transparent;
    }

    .field-content:hover {
      background-color: var(--affine-hover-color);
    }

    .field-content.is-editing {
      box-shadow: 0px 0px 0px 2px rgba(30, 150, 235, 0.3);
    }

    .field-content.is-focus {
      border: 1px solid var(--affine-primary-color);
    }
  `;wu([L({attribute:!1})],zs.prototype,"view",2);wu([L({attribute:!1})],zs.prototype,"column",2);wu([L({attribute:!1})],zs.prototype,"rowId",2);wu([ie()],zs.prototype,"isFocus",2);wu([ie()],zs.prototype,"editing",2);zs=wu([W("affine-data-view-record-field")],zs);var dde=Object.defineProperty,ude=Object.getOwnPropertyDescriptor,ml=(t,e,n,i)=>{for(var r=i>1?void 0:i?ude(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&dde(e,n,r),r};const hde=X`
  affine-data-view-kanban-cell {
    border-radius: 4px;
    display: flex;
    align-items: center;
    padding: 4px;
    min-height: 20px;
    border: 1px solid transparent;
    box-sizing: border-box;
  }

  affine-data-view-kanban-cell:hover {
    background-color: var(--affine-hover-color);
  }

  affine-data-view-kanban-cell .icon {
    display: flex;
    align-items: center;
    justify-content: center;
    align-self: start;
    margin-right: 12px;
    height: var(--data-view-cell-text-line-height);
  }

  affine-data-view-kanban-cell .icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
  }

  .kanban-cell {
    flex: 1;
    display: block;
    width: 196px;
  }
`;let Cr=class extends me(De){constructor(){super(...arguments),this.contentOnly=!1,this.isFocus=!1,this.editing=!1,this._cell=Ri(),this.selectCurrentCell=t=>{const e=this.closest("affine-data-view-kanban")?.selectionController;e&&(e.selection={selectionType:"cell",groupKey:this.groupKey,cardId:this.cardId,columnId:this.column.id,isEditing:t})}}get cell(){return this._cell.value}connectedCallback(){super.connectedCallback(),this._disposables.addFromEvent(this,"click",t=>{t.shiftKey||(t.stopPropagation(),!this.closest("affine-data-view-kanban")?.selectionController)||t.shiftKey||this.editing||this.selectCurrentCell(!this.column.readonly)})}get selection(){return this.closest("affine-data-view-kanban")?.selectionController}renderIcon(){if(!this.contentOnly)return Be` <uni-lit class="icon" .uni="${this.column.icon}"></uni-lit>`}render(){const t={view:this.view,column:this.column,rowId:this.cardId,isEditing:this.editing,selectCurrentCell:this.selectCurrentCell},{view:e,edit:n}=this.column.renderer;return this.style.border=this.isFocus?"1px solid var(--affine-primary-color)":"",this.style.boxShadow=this.editing?"0px 0px 0px 2px rgba(30, 150, 235, 0.30)":"",Be` ${this.renderIcon()}
    ${oi(this.editing&&n?n:e,t,{ref:this._cell,class:"kanban-cell",style:{display:"block",flex:"1",overflow:"hidden"}})}`}};Cr.styles=hde;ml([L({attribute:!1})],Cr.prototype,"contentOnly",2);ml([L({attribute:!1})],Cr.prototype,"view",2);ml([L({attribute:!1})],Cr.prototype,"groupKey",2);ml([L({attribute:!1})],Cr.prototype,"cardId",2);ml([L({attribute:!1})],Cr.prototype,"column",2);ml([ie()],Cr.prototype,"isFocus",2);ml([ie()],Cr.prototype,"editing",2);Cr=ml([W("affine-data-view-kanban-cell")],Cr);class pde{constructor(e){this.viewEle=e,this.onSelect=n=>{const i=this._selection;i&&this.blur(i),this._selection=n,n&&this.focus(n)}}get selection(){return this._selection}set selection(e){if(!e){this.onSelect();return}if(e.isEditing){const i=this.getFocusCellContainer(e)?.cell,r=i&&i.beforeEnterEditMode()?e.isEditing:!1;this.onSelect({propertyId:e.propertyId,isEditing:r})}else this.onSelect(e)}blur(e){const n=this.getFocusCellContainer(e);if(!n)return;n.isFocus=!1;const i=n?.cell;e.isEditing?(i?.onExitEditMode(),i?.blurCell()&&n.blur(),n.editing=!1):n.blur()}focus(e){const n=this.getFocusCellContainer(e);if(!n)return;n.isFocus=!0;const i=n?.cell;e.isEditing?(i?.onEnterEditMode(),i?.focusCell()&&n.focus(),n.editing=!0):n.focus()}getSelectCard(e){const{groupKey:n,cardId:i}=e.cards[0];return this.viewEle.querySelector(`affine-data-view-kanban-group[data-key="${n}"]`)?.querySelector(`affine-data-view-kanban-card[data-card-id="${i}"]`)}getFocusCellContainer(e){return this.viewEle.querySelector(`affine-data-view-record-field[data-column-id="${e.propertyId}"]`)}focusUp(){const e=this.selection;if(!e||e?.isEditing)return;const n=this.getFocusCellContainer(e)?.previousElementSibling;n instanceof zs&&(this.selection={propertyId:n.column.id,isEditing:!1})}focusDown(){const e=this.selection;if(!e||e?.isEditing)return;const n=this.getFocusCellContainer(e)?.nextElementSibling;n instanceof Cr&&(this.selection={propertyId:n.column.id,isEditing:!1})}deleteProperty(){}focusFirstCell(){const e=this.viewEle.querySelector("affine-data-view-record-field")?.column.id;e&&(this.selection={propertyId:e,isEditing:!0})}}var fde=Object.defineProperty,gde=Object.getOwnPropertyDescriptor,g4=(t,e,n,i)=>{for(var r=i>1?void 0:i?gde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&fde(e,n,r),r};const mde=X`
  ${Je(Dv("affine-data-view-record-detail"))}
  affine-data-view-record-detail {
    display: flex;
    flex-direction: column;
    padding: 0 36px;
    gap: 12px;
    height: 100%;
  }

  .add-property {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: var(--data-view-cell-text-size);
    font-style: normal;
    font-weight: 400;
    line-height: var(--data-view-cell-text-line-height);
    color: var(--affine-text-secondary-color);
    border-radius: 4px;
    padding: 4px;
    cursor: pointer;
  }

  .add-property:hover {
    background-color: var(--affine-hover-color);
  }

  .add-property .icon {
    display: flex;
    align-items: center;
  }

  .add-property .icon svg {
    fill: var(--affine-icon-color);
    width: 20px;
    height: 20px;
  }
`;let gc=class extends me(De){constructor(){super(...arguments),this.selection=new pde(this),this._clickAddProperty=()=>{Ui(this.addPropertyButton,this.view.allColumnConfig.map(t=>({type:"action",name:t.name,icon:Be` <uni-lit
            .uni="${this.view.getIcon(t.type)}"
          ></uni-lit>`,select:()=>{this.view.columnAdd("end",t.type)}})))}}get readonly(){return this.view.readonly}connectedCallback(){super.connectedCallback(),this.disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()})),this.disposables.addFromEvent(this,"click",t=>{t.stopPropagation(),this.selection.selection=void 0}),this.setAttribute("data-widget-id","affine-detail-widget")}get columns(){return this.view.detailColumns.map(t=>this.view.columnGet(t))}render(){const t=this.columns;return Be`
      ${this.renderHeader()}
      ${Fe(t,e=>e,e=>Be` <affine-data-view-record-field
            .view="${this.view}"
            .column="${e}"
            .rowId="${this.rowId}"
            data-column-id="${e.id}"
          ></affine-data-view-record-field>`)}
      ${this.readonly?ae:Be`<div class="add-property" @click="${this._clickAddProperty}">
            <div class="icon">${Sr}</div>
            Add Property
          </div>`}
    `}renderHeader(){const t=this.view.detailSlots.header;if(t){const e={view:this.view,rowId:this.rowId};return oi(t,e)}}};gc.styles=mde;g4([L({attribute:!1})],gc.prototype,"view",2);g4([L({attribute:!1})],gc.prototype,"rowId",2);g4([he(".add-property")],gc.prototype,"addPropertyButton",2);gc=g4([W("affine-data-view-record-detail")],gc);var bde=Object.defineProperty,vde=Object.getOwnPropertyDescriptor,Vv=(t,e,n,i)=>{for(var r=i>1?void 0:i?vde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&bde(e,n,r),r};let Md=class extends De{renderOps(){return b``}render(){return b`
      <div class="side-modal-header">
        <div class="header-ops">${this.renderOps()}</div>
        <div @click="${this.close}" class="close-modal header-op">
          ${Xd}
        </div>
      </div>
      ${this.content}
    `}};Md.styles=X`
    side-layout-modal {
      display: block;
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 500px;
      background-color: var(--affine-background-overlay-panel-color);
      border-left: 0.5px solid var(--affine-border-color);
      box-shadow: -5px 0px 10px 0px rgba(0, 0, 0, 0.05);
    }

    .side-modal-header {
      margin: 12px 0;
      padding: 0 12px;
      display: flex;
      align-items: center;
      justify-content: end;
    }

    .header-ops {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .header-op {
      display: flex;
      align-items: center;
      padding: 2px;
      border-radius: 4px;
      cursor: pointer;
    }

    .header-op svg {
      width: 20px;
      height: 20px;
      color: var(--affine-icon-color);
    }

    .header-op:hover {
      background-color: var(--affine-hover-color);
    }

    .close-modal {
      margin-left: 20px;
    }
  `;Vv([L({attribute:!1})],Md.prototype,"content",2);Vv([L({attribute:!1})],Md.prototype,"close",2);Md=Vv([W("side-layout-modal")],Md);const zv=t=>{const e=t.pageElement;D(e);const n=yde(e)??e,i=cv(e),r=zl(n,i,()=>{ii(n,i,{middleware:[pk({apply:({rects:l})=>{Object.assign(i.style,{left:`${l.reference.x}px`,top:`${l.reference.y}px`,width:`${l.reference.width}px`,height:`${l.reference.height}px`})}})]}).catch(console.error)}),o=()=>{i.remove(),t.onClose?.(),r()},s=new gc;s.view=t.view,s.rowId=t.rowId;const a=new Md;a.content=s,a.close=o,a.onclick=l=>{l.stopPropagation()},i.onclick=o,i.append(a)},yde=t=>{for(;t&&t.computedStyleMap().get("display")?.toString()!=="block";)t=t.parentElement;return t},UA=(t,e,n)=>{const i=n.selection;n.selection=void 0,zv({pageElement:t,view:n.host.view,rowId:e,onClose:()=>{n.selection=i}})},im=(t,e,n,i)=>{Ui(e,[{type:"action",name:"Expand Row",icon:yb,select:()=>{UA(t,n,i)}},{type:"group",name:"",children:()=>[{type:"action",name:"Insert Before",icon:b` <div
            style="transform: rotate(90deg);display:flex;align-items:center;"
          >
            ${y3}
          </div>`,select:()=>{i.insertRowBefore(n)}},{type:"action",name:"Insert After",icon:b` <div
            style="transform: rotate(90deg);display:flex;align-items:center;"
          >
            ${w3}
          </div>`,select:()=>{i.insertRowAfter(i.selection?.groupKey,n)}}]},{type:"group",name:"",children:()=>[{type:"action",name:"Delete Row",class:"delete-item",icon:xn,select:()=>{i.deleteRow(n)}}]}])};var wde=Object.defineProperty,xde=Object.getOwnPropertyDescriptor,m4=(t,e,n,i)=>{for(var r=i>1?void 0:i?xde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&wde(e,n,r),r};let mc=class extends me(De){constructor(){super(...arguments),this.setSelection=t=>{this.selectionController&&(this.selectionController.selection=t)},this.contextMenu=t=>{const e=this.selectionController;if(!e)return;t.preventDefault();const i=t.target.closest("affine-database-cell-container")?.columnIndex??0;e.selection={rowsSelection:{start:this.rowIndex,end:this.rowIndex},focus:{rowIndex:this.rowIndex,columnIndex:i},isEditing:!1};const r=gs(this);im(r,gd(t.x,t.y),this.rowId,e)},this._clickDragHandler=()=>{const t=this.selectionController;t&&(t.isRowSelection(this.groupKey,this.rowIndex)&&t.selection?t.selection={...t.selection,rowsSelection:void 0}:t.selection={groupKey:this.groupKey,rowsSelection:{start:this.rowIndex,end:this.rowIndex},focus:{rowIndex:this.rowIndex,columnIndex:0},isEditing:!1})}}get selectionController(){return this.closest("affine-database-table")?.selectionController}get groupKey(){return this.closest("affine-data-view-table-group")?.group?.key}connectedCallback(){super.connectedCallback(),this.disposables.addFromEvent(this,"contextmenu",this.contextMenu),this.classList.add("affine-database-block-row","database-row")}render(){const t=this.view;return Be`
      <div class="data-view-table-left-bar">
        <div
          class="data-view-table-view-drag-handler"
          @click=${this._clickDragHandler}
          style="width: 8px;height: 100%;display:flex;align-items:center;justify-content:center;cursor:grab;"
        >
          <div
            class="show-on-hover-row"
            style="width: 4px;
            border-radius: 2px;
            height: 12px;
            background-color: var(--affine-placeholder-color);"
          ></div>
        </div>
      </div>
      ${Fe(t.columnManagerList,e=>e.id,(e,n)=>{const i=()=>{if(!this.selectionController)return;this.setSelection({rowsSelection:{start:this.rowIndex,end:this.rowIndex},focus:{rowIndex:this.rowIndex,columnIndex:n},isEditing:!1});const o=gs(this);UA(o,this.rowId,this.selectionController)},r=o=>{if(!this.selectionController)return;const s=o.currentTarget;this.setSelection({rowsSelection:{start:this.rowIndex,end:this.rowIndex},focus:{rowIndex:this.rowIndex,columnIndex:n},isEditing:!1});const a=gs(this);im(a,s,this.rowId,this.selectionController)};return Be`
            <div>
              <affine-database-cell-container
                class="database-cell"
                style=${we({width:`${e.width}px`,border:n===0?"none":void 0})}
                .view="${t}"
                .column="${e}"
                .rowId="${this.rowId}"
                data-row-id="${this.rowId}"
                .rowIndex="${this.rowIndex}"
                data-row-index="${this.rowIndex}"
                .columnId="${e.id}"
                data-column-id="${e.id}"
                .columnIndex="${n}"
                data-column-index="${n}"
              >
              </affine-database-cell-container>
            </div>
            ${e.dataViewManager.header.titleColumn===e.id?Be`<div class="row-ops">
                  <div class="row-op" @click="${i}">
                    ${db}
                  </div>
                  ${t.readonly?ae:Be`<div class="row-op" @click="${r}">
                        ${Xo}
                      </div>`}
                </div>`:ae}
          `})}
      <div class="database-cell add-column-button"></div>
    `}};mc.styles=X`
    .data-view-table-row {
      width: 100%;
    }
    .affine-database-block-row {
      width: 100%;
      display: flex;
      flex-direction: row;
      border-bottom: 1px solid var(--affine-border-color);
      position: relative;
    }

    .affine-database-block-row.selected > .database-cell {
      background: transparent;
    }

    .database-cell {
      min-width: ${Fv}px;
    }

    .row-ops {
      position: relative;
      width: 0;
      margin-top: 8px;
      height: max-content;
      visibility: hidden;
      display: flex;
      gap: 4px;
      cursor: pointer;
      justify-content: end;
    }

    .row-op:last-child {
      margin-right: 8px;
    }

    .affine-database-block-row:hover .row-ops {
      visibility: visible;
    }
    .affine-database-block-row .show-on-hover-row {
      visibility: hidden;
      opacity: 0;
      transition: opacity 150ms cubic-bezier(0.42, 0, 1, 1);
    }
    .affine-database-block-row:hover .show-on-hover-row {
      visibility: visible;
      opacity: 1;
    }

    .row-op {
      display: flex;
      padding: 4px;
      border-radius: 4px;
      box-shadow: 0px 0px 4px 0px rgba(66, 65, 73, 0.14);
      background-color: var(--affine-background-primary-color);
      position: relative;
    }

    .row-op:hover:before {
      content: '';
      border-radius: 4px;
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background-color: var(--affine-hover-color);
    }

    .row-op svg {
      fill: var(--affine-icon-color);
      color: var(--affine-icon-color);
      width: 16px;
      height: 16px;
    }
  `;m4([L({attribute:!1})],mc.prototype,"view",2);m4([L({attribute:!1})],mc.prototype,"rowIndex",2);m4([L({attribute:!1})],mc.prototype,"rowId",2);mc=m4([W("data-view-table-row")],mc);function _de(t){const e=t.rows;if(e.length)return Be` <div class="group-header-count">${e.length}</div>`}function VA(t,e){const n=t.helper.groupConfig();if(!n)return ae;const i=t.value==null?"":Be` <uni-lit
          class="group-header-icon"
          .uni="${t.helper.column.icon}"
        ></uni-lit>`,r={value:t.value,data:t.helper.data,updateData:t.helper.updateData,updateValue:o=>t.helper.updateValue(t.rows,o),readonly:e.readonly};return Be`
    <style>
      .group-header-count {
        flex-shrink: 0;
        width: 20px;
        height: 20px;
        border-radius: 4px;
        background-color: var(--affine-background-secondary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--affine-text-secondary-color);
        font-size: var(--data-view-cell-text-size);
      }

      .group-header-name {
        flex: 1;
        overflow: hidden;
      }

      .group-header-ops {
        display: flex;
        align-items: center;
      }

      .group-header-op {
        display: flex;
        align-items: center;
        cursor: pointer;
        padding: 4px;
        border-radius: 4px;
        visibility: hidden;
        opacity: 0;
        transition: all 150ms cubic-bezier(0.42, 0, 1, 1);
      }

      .group-header-icon {
        display: flex;
        align-items: center;
        margin-right: -4px;
      }

      .group-header-icon svg {
        width: 16px;
        height: 16px;
        color: var(--affine-icon-color);
        fill: var(--affine-icon-color);
      }

      .group-header-op:hover {
        background-color: var(--affine-hover-color);
      }

      .group-header-op svg {
        width: 16px;
        height: 16px;
        fill: var(--affine-icon-color);
        color: var(--affine-icon-color);
      }
    </style>
    <div
      style="display:flex;align-items:center;gap: 8px;overflow: hidden;height: 22px;"
    >
      ${i} ${oi(n.view,r)} ${_de(t)}
    </div>
    ${e.readonly?ae:Be` <div class="group-header-ops">
          <div @click="${e.clickAdd}" class="group-header-op add-card">
            ${Sr}
          </div>
          <div @click="${e.clickOps}" class="group-header-op">
            ${Xo}
          </div>
        </div>`}
  `}var Cde=Object.defineProperty,kde=Object.getOwnPropertyDescriptor,b4=(t,e,n,i)=>{for(var r=i>1?void 0:i?kde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Cde(e,n,r),r};const Ede=X`
  affine-data-view-table-group .group-header-op {
    visibility: visible;
  }
  .data-view-table-group-add-row {
    display: flex;
    width: 100%;
    height: 28px;
    position: relative;
    z-index: 0;
    cursor: pointer;
    transition: opacity 0.2s ease-in-out;
    padding: 4px 8px;
    border-bottom: 1px solid var(--affine-border-color);
  }

  @media print {
    .data-view-table-group-add-row {
      display: none;
    }
  }

  .data-view-table-group-add-row-button {
    position: sticky;
    left: ${8+Uv}px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    user-select: none;
    font-size: 12px;
    line-height: 20px;
    color: var(--affine-text-secondary-color);
  }
`;let Pd=class extends me(De){constructor(){super(...arguments),this.clickAddRow=()=>{this.view.rowAdd("end",this.group?.key),requestAnimationFrame(()=>{const t=this.viewEle.selectionController;t.selection={groupKey:this.group?.key,focus:{rowIndex:this.rows.length-1,columnIndex:0},isEditing:!0}})},this.clickAddRowInStart=()=>{this.view.rowAdd("start",this.group?.key),requestAnimationFrame(()=>{const t=this.viewEle.selectionController;t.selection={groupKey:this.group?.key,focus:{rowIndex:0,columnIndex:0},isEditing:!0}})},this.clickGroupOptions=t=>{const e=this.group;if(!e)return;const n=t.currentTarget;Ui(n,[{type:"action",name:"Ungroup",hide:()=>e.value==null,select:()=>{e.rows.forEach(i=>{e.helper.removeFromGroup(i,e.key)})}},{type:"action",name:"Delete Cards",select:()=>{this.view.rowDelete(e.rows)}}])}}get rows(){return this.group?.rows??this.view.rows}updated(t){super.updated(t),this.querySelectorAll("data-view-table-row").forEach(e=>{e.requestUpdate()})}renderRows(t){return b`
      <affine-database-column-header
        .tableViewManager="${this.view}"
      ></affine-database-column-header>
      <div class="affine-database-block-rows">
        ${Fe(t,e=>e,(e,n)=>b`<data-view-table-row
              data-row-index="${n}"
              data-row-id="${e}"
              .view="${this.view}"
              .rowId="${e}"
              .rowIndex="${n}"
            ></data-view-table-row>`)}
      </div>
      ${this.view.readonly?null:b` <div
            class="data-view-table-group-add-row dv-hover"
            @click="${this.clickAddRow}"
          >
            <div
              class="data-view-table-group-add-row-button dv-icon-16"
              data-test-id="affine-database-add-row-button"
              role="button"
            >
              ${Sr}<span>New Record</span>
            </div>
          </div>`}
    `}render(){return this.group?b`
      <div
        style="position: sticky;left: 0;width: max-content;padding: 6px 0;margin-bottom: 4px;display:flex;align-items:center;gap: 12px;max-width: 400px"
      >
        ${VA(this.group,{readonly:this.view.readonly,clickAdd:this.clickAddRowInStart,clickOps:this.clickGroupOptions})}
      </div>
      ${this.renderRows(this.group.rows)}
    `:this.renderRows(this.view.rows)}};Pd.styles=Ede;b4([L({attribute:!1})],Pd.prototype,"view",2);b4([L({attribute:!1})],Pd.prototype,"viewEle",2);b4([L({attribute:!1})],Pd.prototype,"group",2);Pd=b4([W("affine-data-view-table-group")],Pd);var Sde=Object.defineProperty,Tde=Object.getOwnPropertyDescriptor,ts=(t,e,n,i)=>{for(var r=i>1?void 0:i?Tde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Sde(e,n,r),r};class Pr extends me(De){}ts([L({attribute:!1})],Pr.prototype,"std",2);ts([L({attribute:!1})],Pr.prototype,"header",2);ts([L({attribute:!1})],Pr.prototype,"view",2);ts([L({attribute:!1})],Pr.prototype,"bindHotkey",2);ts([L({attribute:!1})],Pr.prototype,"handleEvent",2);ts([L({attribute:!1})],Pr.prototype,"modalMode",2);ts([L({attribute:!1})],Pr.prototype,"setSelection",2);ts([L({attribute:!1})],Pr.prototype,"selectionUpdated",2);ts([L({attribute:!1})],Pr.prototype,"onDrag",2);ts([L({attribute:!1})],Pr.prototype,"getFlag",2);const mC="blocksuite/database",Ide="text/plain";class Lde{constructor(e){this.host=e,this._onCopy=async(n,i,r=!1)=>{const o=this.host,s=this.host.view,a=Pde(i,s,o),c=Mde(i,s,o,r).map(d=>d.join("	")).join(`
`);return this.std.clipboard.writeToClipboard(async d=>({...d,[Ide]:c,[mC]:JSON.stringify(a)})).catch(console.error),!0},this._onCut=async(n,i)=>{this._onCopy(n,i,!0).catch(console.error)},this._onPaste=async n=>{const i=n.get("clipboardState").raw;i.stopPropagation();const r=this.host,o=this.host.view,s=i.clipboardData;if(!s)return;const a=this.host.selectionController.selection;if(a){const c=(await this.std.clipboard.readFromClipboard(s))[mC];if(!c)return;const d=JSON.parse(c),u=Ade(a,o);let h=u.row.start,p=u.column.start,g=u.row.length,f=u.column.length;u.anchor&&(h=a.focus.rowIndex,p=a.focus.columnIndex,g=d.length,f=d[0].length),$de(o,r,d,a.groupKey,h,p,g,f)}return!0},e.addController(this)}get readonly(){return this.host.view.readonly}get std(){return this.host.std}hostConnected(){this.host.disposables.add(this.host.handleEvent("copy",e=>{const n=this.host.selectionController.selection;return n?(this._onCopy(e,n).catch(console.error),!0):!1})),this.host.disposables.add(this.host.handleEvent("cut",e=>{const n=this.host.selectionController.selection;return n?(this._onCut(e,n).catch(console.error),!0):!1})),this.host.disposables.add(this.host.handleEvent("paste",e=>this.readonly?!1:(this._onPaste(e).catch(console.error),!0)))}}function as(t){const e=t?.dataset.rowId;return D(e),t?.column.getStringValue(e)??""}const bC=["progress","checkbox"];function Mde(t,e,n,i=!1){const{rowsSelection:r,columnsSelection:o,focus:s,groupKey:a}=t,l=[];if(r&&!o){const{start:c,end:d}=r,u=e.columnsWithoutFilter.findIndex(h=>e.columnGetType(h)==="title");for(let h=c;h<=d;h++){const p=n.selectionController.getCellContainer(a,h,u),g=A1.title?.(p)??"";l.push([g])}}else if(r&&o)for(let c=r.start;c<=r.end;c++){const d=[];for(let u=o.start;u<=o.end;u++){const h=e.columnGet(e.columns[u]),p=n.selectionController.getCellContainer(a,c,u),g=A1[h.type]?.(p)??"";if(i||d.push(g),i&&!bC.includes(h.type)&&(d.push(g),p?.column.setValue(p.rowId,void 0),h.type==="title"||h.type==="rich-text")){const f=p?.column.getValue(p.rowId);f.delete(0,f.length)}}l.push(d)}else if(!r&&!o&&s){const c=e.columnGet(e.columns[s.columnIndex]),d=n.selectionController.getCellContainer(a,s.rowIndex,s.columnIndex),u=A1[c.type]?.(d)??"";if(i||l.push([u]),i&&!bC.includes(c.type)&&(l.push([u]),d?.column.setValue(d.rowId,void 0),c.type==="title"||c.type==="rich-text")){const h=d?.column.getValue(d.rowId);h.delete(0,h.length)}}return l}function Pde(t,e,n){const{rowsSelection:i,columnsSelection:r,focus:o,groupKey:s}=t,a=[];if(i&&!r){const{start:l,end:c}=i;for(let d=l;d<=c;d++){const u=[];for(let h=0;h<e.columns.length;h++){const p=e.columnGet(e.columns[h]),g=n.selectionController.getCellContainer(s,d,h),f=A1[p.type]?.(g);u.push({type:p.type,value:f})}a.push(u)}}else if(i&&r)for(let l=i.start;l<=i.end;l++){const c=[];for(let d=r.start;d<=r.end;d++){const u=e.columnGet(e.columns[d]),h=n.selectionController.getCellContainer(s,l,d),p=A1[u.type]?.(h);c.push({type:u.type,value:p})}a.push(c)}else if(!i&&!r&&o){const l=n.selectionController.getCellContainer(s,o.rowIndex,o.columnIndex),c=e.columnGet(e.columns[o.columnIndex]),d=A1[c.type]?.(l);a.push([{type:c.type,value:d}])}return a}function Ade(t,e){const{rowsSelection:n,columnsSelection:i,focus:r}=t;let o={row:{start:0,end:0,length:0},column:{start:0,end:0,length:0}};return n&&!i?(o={row:{start:n.start,end:n.end,length:n.end-n.start+1},column:{start:0,end:e.columns.length-1,length:e.columns.length}},n.start===n.end&&(o.anchor=!0)):n&&i?o={row:{start:n.start,end:n.end,length:n.end-n.start+1},column:{start:i.start,end:i.end,length:i.end-i.start+1}}:!n&&!i&&r&&(o={anchor:!0,row:{start:r.rowIndex,end:r.rowIndex,length:1},column:{start:r.columnIndex,end:r.columnIndex,length:1}}),o}function $de(t,e,n,i,r,o,s,a){const l=n,c=l.length,d=l[0].length;for(let u=0;u<s;u++)for(let h=0;h<a;h++){const p=r+u,g=o+h,f=u%c,v=h%d,m=l[f][v],y=e.selectionController.getCellContainer(i,p,g),x=y?.dataset.rowId,T=y?.dataset.columnId;if(x&&T){const M=y?.column.setValueFromString(m.value);t.cellUpdateValue(x,T,M)}}}const A1={"rich-text":t=>{const e=t?.querySelector("affine-database-rich-text-cell-editing"),n=as(t),i=e?.inlineEditor?.getInlineRange();if(i){const r=i.index,o=i.index+i.length;return n?.slice(r,o)??""}return n??""},title:t=>{const e=t?.querySelector("data-view-header-area-text-editing"),n=as(t),i=e?.inlineEditor?.getInlineRange();if(i){const r=i.index,o=i.index+i.length;return n?.slice(r,o)??""}return n??""},date:t=>as(t),number:t=>as(t),select:t=>as(t),"multi-select":t=>as(t),progress:t=>as(t),link:t=>as(t),checkbox:t=>as(t)};class Bde{constructor(e){this.host=e,this.dropPreview=Ode(),this.getInsertPosition=n=>{const i=n.y,r=this.host.getBoundingClientRect(),o=this.host.querySelectorAll("data-view-table-row");if(!(!o||!r||i<r.top))for(let s=0;s<o.length;s++){const a=o.item(s),l=a.getBoundingClientRect(),c=(l.top+l.bottom)/2;if(i<l.bottom)return{groupKey:a.groupKey,position:{id:a.getAttribute("data-row-id"),before:i<c},y:i<c?l.top:l.bottom,width:r.width,x:r.left}}},this.showIndicator=n=>{const i=this.getInsertPosition(n);return i?this.dropPreview.display(i.x,i.y,i.width):this.dropPreview.remove(),i},this.dragStart=(n,i)=>{const r=n.getBoundingClientRect(),o=i.x-r.left,s=i.y-r.top,a=Dde(n,i.x-o,i.y-s),l=n.groupKey;zc(i,{onDrag:()=>{},onMove:c=>{if(a.display(c.x-o,c.y-s),!this.host.contains(c.target)){const u=this.host.onDrag;return u?(this.dropPreview.remove(),{type:"out",callback:u(c,n.rowId)}):void 0}const d=this.showIndicator(c);if(d)return{type:"self",groupKey:d.groupKey,position:d.position}},onClear:()=>{a.remove(),this.dropPreview.remove()},onDrop:c=>{if(c){if(c.type==="out"){c.callback();return}c.type==="self"&&this.host.view.rowMove(n.rowId,c.position,l,c.groupKey)}}})},this.host.addController(this)}hostConnected(){this.host.view.readonly||this.host.disposables.add(this.host.handleEvent("dragStart",e=>{const n=e.get("pointerState").raw,i=n.target;if(i instanceof Element&&this.host.contains(i)&&i.closest(".data-view-table-view-drag-handler")){n.preventDefault();const r=i.closest("data-view-table-row");return r&&(getSelection()?.removeAllRanges(),this.dragStart(r,n)),!0}return!1}))}}const Dde=(t,e,n)=>{const i=document.createElement("div"),r=new mc;return r.view=t.view,r.rowIndex=t.rowIndex,r.rowId=t.rowId,i.append(r),i.className="with-data-view-css-variable blocksuite-overlay",i.style.width=`${t.getBoundingClientRect().width}px`,i.style.position="fixed",i.style.pointerEvents="none",i.style.backgroundColor="var(--affine-background-primary-color)",i.style.boxShadow="var(--affine-shadow-2)",i.style.left=`${e}px`,i.style.top=`${n}px`,i.style.zIndex="9999",document.body.append(i),{display(o,s){i.style.left=`${Math.round(o)}px`,i.style.top=`${Math.round(s)}px`},remove(){i.remove()}}},Ode=()=>{const t=document.createElement("div");return t.classList.add("blocksuite-overlay"),t.setAttribute("data-is-drop-preview","true"),t.style.pointerEvents="none",t.style.position="fixed",t.style.zIndex="9999",t.style.height="2px",t.style.borderRadius="1px",t.style.backgroundColor="var(--affine-primary-color)",t.style.boxShadow="0px 0px 8px 0px rgba(30, 150, 235, 0.35)",{display(e,n,i){document.body.append(t),t.style.left=`${e}px`,t.style.top=`${n-2}px`,t.style.width=`${i}px`},remove(){t.remove()}}};class Rde{constructor(e){this.host=e,this.host.addController(this)}get selectionController(){return this.host.selectionController}hostConnected(){this.host.disposables.add(this.host.bindHotkey({Backspace:()=>{const e=this.selectionController.selection;if(!e)return;const{focus:n,rowsSelection:i,columnsSelection:r,isEditing:o,groupKey:s}=e;if(i&&!r){const a=Array.from(this.selectionController.rows(e.groupKey)).filter((l,c)=>c>=i.start&&c<=i.end).map(l=>l.rowId);this.selectionController.focusTo("up"),this.host.view.rowDelete(a)}else if(n&&!o){const a=this.host.view;if(i&&r)for(let l=i.start;l<=i.end;l++){const{start:c,end:d}=r;for(let u=c;u<=d;u++){const h=this.selectionController.getCellContainer(s,l,u),p=h?.dataset.rowId,g=h?.dataset.columnId;if(p&&g){const f=h?.column.setValueFromString("");a.cellUpdateValue(p,g,f)}}}else{const l=this.selectionController.getCellContainer(s,n.rowIndex,n.columnIndex),c=l?.dataset.rowId,d=l?.dataset.columnId;if(c&&d){const u=l?.column.setValueFromString("");a.cellUpdateValue(c,d,u)}}}},Escape:()=>{const e=this.selectionController.selection;if(!e)return!1;const n=e.rowsSelection;return e.isEditing?this.selectionController.selection={...e,isEditing:!1}:n&&!e.columnsSelection?this.selectionController.selection={...e,rowsSelection:void 0,columnsSelection:void 0}:this.selectionController.selection={...e,rowsSelection:{start:n?.start??e.focus.rowIndex,end:n?.end??e.focus.rowIndex},columnsSelection:void 0},!0},Enter:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(this.selectionController.selection={...n,rowsSelection:void 0,columnsSelection:void 0,isEditing:!0},e.get("keyboardState").raw.preventDefault(),!0)},"Shift-Enter":()=>{const e=this.selectionController.selection;if(!e||e.isEditing)return!1;const n=this.selectionController.getCellContainer(e.groupKey,e.focus.rowIndex,e.focus.columnIndex);return n&&this.selectionController.insertRowAfter(e.groupKey,n.rowId),!0},Tab:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(e.get("keyboardState").raw.preventDefault(),this.selectionController.focusTo("right"),!0)},"Shift-Tab":e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(e.get("keyboardState").raw.preventDefault(),this.selectionController.focusTo("left"),!0)},ArrowLeft:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(this.selectionController.focusTo("left"),e.get("keyboardState").raw.preventDefault(),!0)},ArrowRight:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(this.selectionController.focusTo("right"),e.get("keyboardState").raw.preventDefault(),!0)},ArrowUp:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(this.selectionController.focusTo("up"),e.get("keyboardState").raw.preventDefault(),!0)},ArrowDown:e=>{const n=this.selectionController.selection;return!n||n.isEditing?!1:(this.selectionController.focusTo("down"),e.get("keyboardState").raw.preventDefault(),!0)},"Mod-a":e=>{const n=this.selectionController.selection;if(n?.isEditing)return!0;if(n){e.get("keyboardState").raw.preventDefault();const i=0,r=this.host.view.rows.length-1;return n.rowsSelection?.start===i&&n.rowsSelection.end===r&&!n.columnsSelection?!1:(this.selectionController.selection={rowsSelection:{start:i,end:r},focus:n.focus,isEditing:!1},!0)}},"/":e=>{const n=this.selectionController.selection;if(!n||n.columnsSelection||n.isEditing)return;const i=this.selectionController.getCellContainer(n.groupKey,n.focus.rowIndex,n.focus.columnIndex);if(i){e.get("keyboardState").raw.preventDefault();const r=gs(i);im(r,i,i.rowId,this.selectionController)}}}))}}var Nde=Object.defineProperty,Hde=Object.getOwnPropertyDescriptor,Fde=(t,e,n,i)=>{for(var r=i>1?void 0:i?Hde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Nde(e,n,r),r};class Ude{constructor(e){this.host=e,this.__selectionElement=new V5,this.selectionStyleUpdateTask=0,e.addController(this)}get focusSelectionElement(){return this.__selectionElement.focusRef.value}get areaSelectionElement(){return this.__selectionElement.selectionRef.value}get tableContainer(){const e=this.host.querySelector(".affine-database-table-container");return D(e),e}get viewData(){return this.view}hostConnected(){requestAnimationFrame(()=>{this.tableContainer.append(this.__selectionElement)}),this.handleDragEvent(),this.handleSelectionChange()}handleSelectionChange(){this.host.disposables.add(this.host.selectionUpdated.on(e=>{if(!this.isValidSelection(e)){this.selection=void 0;return}const n=this._tableViewSelection;if(requestAnimationFrame(()=>{this.scrollToFocus()}),n){const i=this.getCellContainer(n.groupKey,n.focus.rowIndex,n.focus.columnIndex);if(i){const r=i.cell;n.isEditing&&(r?.onExitEditMode(),r?.blurCell(),i.isEditing=!1)}}if(this.updateSelection(e),e){const i=this.getCellContainer(e.groupKey,e.focus.rowIndex,e.focus.columnIndex);if(i){const r=i.cell;e.isEditing&&(r?.onEnterEditMode(),i.isEditing=!0,r?.focusCell())}}}))}handleDragEvent(){this.host.disposables.add(this.host.handleEvent("dragStart",e=>{const n=e.get("pointerState").raw,i=n.target;if(i instanceof Element){const r=i.closest("affine-database-cell-container");if(r){const o=this.selection;return o&&o.isEditing&&o.focus.rowIndex===r.rowIndex&&o.focus.columnIndex===r.columnIndex?!1:(this.startDrag(n,r),n.preventDefault(),!0)}return!1}return!1}))}isValidSelection(e){return e?e.focus.rowIndex>this.view.rows.length-1?(this.selection=void 0,!1):e.focus.columnIndex>this.view.columns.length-1?(this.selection=void 0,!1):!0:!0}clearSelection(){this.host.setSelection()}get selection(){return this._tableViewSelection}set selection(e){if(!e){this.clearSelection();return}const n={...e,viewId:this.view.id,type:"table"};if(n.isEditing){const i=n.focus,o=this.getCellContainer(n.groupKey,i.rowIndex,i.columnIndex)?.cell,s=o?o.beforeEnterEditMode():!0;this.host.setSelection({...n,isEditing:s})}else this.host.setSelection(n)}cellPosition(e,n,i){const r=this.rows(e),o=r?.item(0).querySelectorAll("affine-database-cell-container"),s=Array.from(r??[]).map(l=>l.getBoundingClientRect().top-i),a=Array.from(o??[]).map(l=>l.getBoundingClientRect().left-n);return(l,c,d,u)=>{const[h,p]=l<c?[l,c]:[c,l],[g,f]=d<u?[d,u]:[u,d],v={start:0,end:0},m={start:0,end:0};for(let y=0;y<s.length;y++){const x=s[y];x<g&&(v.start=y),x<f&&(v.end=y)}for(let y=0;y<a.length;y++){const x=a[y];x<h&&(m.start=y),x<p&&(m.end=y)}return{row:v,column:m}}}startDrag(e,n){const i=n.closest("affine-data-view-table-group")?.group?.key,o=this.tableContainer.getBoundingClientRect(),s=e.x-o.left,a=e.y-o.top,l=this.cellPosition(i,o.left,o.top),c=d=>{this.selection={groupKey:i,rowsSelection:d.row,columnsSelection:d.column,focus:{rowIndex:n.rowIndex,columnIndex:n.columnIndex},isEditing:!1}};zc(e,{transform:d=>({x:d.x,y:d.y}),onDrag:()=>{},onMove:({x:d,y:u})=>{const h=d-o.left,p=u-o.top,g=l(h,s,p,a);return c(g),g},onDrop:d=>{d&&c(d)},onClear:()=>{}})}focusTo(e){if(!this.selection)return;const n=this.getCellContainer(this.selection.groupKey,this.selection.focus.rowIndex,this.selection.focus.columnIndex);if(!n)return;const i=n.closest("data-view-table-row"),r=Array.from(i?.closest(".affine-database-table-container")?.querySelectorAll("data-view-table-row")??[]),o=Array.from(i?.querySelectorAll("affine-database-cell-container")??[]);if(!i||!r||!o)return;let s=r.indexOf(i),a=o.indexOf(n);e==="left"&&(a===0?(a=o.length-1,s--):a--),e==="right"&&(a===o.length-1?(a=0,s++):a++),e==="up"&&(s===0||s--),e==="down"&&(s===r.length-1||s++),r[s]?.querySelectorAll("affine-database-cell-container")?.item(a)?.selectCurrentCell(!1)}selectRange(e,n,i){this.selection={...e,rowsSelection:n,columnsSelection:i,isEditing:!1}}getCellContainer(e,n,i){return this.rows(e)?.item(n)?.querySelectorAll("affine-database-cell-container").item(i)}rows(e){const n=e!=null?this.tableContainer.querySelector(`affine-data-view-table-group[data-group-key="${e}"]`):this.tableContainer;return D(n),n.querySelectorAll("data-view-table-row")}updateSelection(e){const n=()=>{if(!this.checkSelection())return!1;this.updateSelectionStyle(e?.groupKey,e?.rowsSelection,e?.columnsSelection);const r=e?.rowsSelection&&!e?.columnsSelection;return this.updateFocusSelectionStyle(e?.groupKey,e?.focus,r,e?.isEditing),!0};if(this._tableViewSelection=e,!e)cancelAnimationFrame(this.selectionStyleUpdateTask),n();else{const i=()=>{if(cancelAnimationFrame(this.selectionStyleUpdateTask),!n()){this.selection=void 0;return}this.selectionStyleUpdateTask=requestAnimationFrame(i)};i()}}updateSelectionStyle(e,n,i){const r=this.areaSelectionElement;if(!r)return;if(!n&&!i){r.style.display="none";return}const o=this.tableContainer.getBoundingClientRect();let{left:s,top:a,width:l,height:c,scale:d}=this.getRect(e,n?.start??0,n?.end??this.view.rows.length-1,i?.start??0,i?.end??this.view.columnManagerList.length-1);const u=n&&!i;u&&(s=o.left,l=o.width),r.style.left=`${s-o.left/d}px`,r.style.top=`${a-o.top/d}px`,r.style.width=`${l}px`,r.style.height=`${c}px`,r.style.display="block",r.style.border=u?"1px solid var(--affine-primary-color)":"unset"}updateFocusSelectionStyle(e,n,i,r=!1){const o=this.focusSelectionElement;if(o)if(n&&!i){if((this.rows(e)??[]).length<=n.rowIndex)return;const{left:a,top:l,width:c,height:d,scale:u}=this.getRect(e,n.rowIndex,n.rowIndex,n.columnIndex,n.columnIndex),h=this.tableContainer.getBoundingClientRect();o.style.left=`${a-h.left/u}px`,o.style.top=`${l-1-h.top/u}px`,o.style.width=`${c+1}px`,o.style.height=`${d+1}px`,o.style.borderColor="var(--affine-primary-color)",o.style.boxShadow=r?"0px 0px 0px 2px rgba(30, 150, 235, 0.30)":"unset",o.style.display="block"}else o.style.display="none"}getRect(e,n,i,r,o){const s=this.rows(e),a=s.item(n),l=s.item(i),c=a.querySelectorAll("affine-database-cell-container"),d=c.item(r),u=c.item(o),h=d.getBoundingClientRect(),p=h.width/d.column.width;return{top:h.top/p,left:h.left/p,width:(u.getBoundingClientRect().right-h.left)/p,height:(l.getBoundingClientRect().bottom-h.top)/p,scale:p}}selectRow(e){this.selection={rowsSelection:{start:e,end:e},focus:{rowIndex:e,columnIndex:0},isEditing:!1}}toggleRow(e){const n=this.selection;if(n){const i=n.rowsSelection;if(i&&!n.columnsSelection&&i.start===e&&i.end===e){this.selection={...n,rowsSelection:void 0};return}}this.selection={rowsSelection:{start:e,end:e},focus:{rowIndex:e,columnIndex:0},isEditing:!1}}focusFirstCell(){this.selection={focus:{rowIndex:0,columnIndex:0},isEditing:!1}}scrollToFocus(){this.focusSelectionElement?.scrollIntoView({block:"nearest",inline:"nearest"})}insertRowBefore(e){const n=this.view.rowAdd({before:!0,id:e});this.selection={focus:{rowIndex:this.view.rows.findIndex(i=>i===n),columnIndex:this.selection?.focus.columnIndex??0},isEditing:!1}}insertRowAfter(e,n){const i=this.view.rowAdd({before:!1,id:n});e!=null&&this.view.groupHelper?.moveCardTo(i,void 0,e,{before:!1,id:n});const r=e!=null?this.view.groupHelper?.groupMap[e].rows:this.view.rows;requestAnimationFrame(()=>{this.selection={groupKey:e,focus:{rowIndex:r?.findIndex(o=>o===i)??0,columnIndex:this.selection?.focus.columnIndex??0},isEditing:!0}})}get view(){return this.host.view}deleteRow(e){this.view.rowDelete([e]),this.focusTo("up")}checkSelection(){const e=this.selection;return e?!!this.getCellContainer(e.groupKey,e.focus.rowIndex,e.focus.columnIndex):!0}isRowSelection(e,n){const i=this.selection;if(!i||i.groupKey!=e)return!1;const{rowsSelection:r,columnsSelection:o}=i;return!r||o?!1:r.start===n&&r.end===n}}let V5=class extends De{constructor(){super(...arguments),this.focusRef=Ri(),this.selectionRef=Ri()}render(){return b`
      <div ${$t(this.selectionRef)} class="database-selection"></div>
      <div tabindex="0" ${$t(this.focusRef)} class="database-focus"></div>
    `}};V5.styles=X`
    .database-selection {
      position: absolute;
      z-index: 1;
      box-sizing: border-box;
      background: var(--affine-primary-color-04);
      pointer-events: none;
      display: none;
    }

    .database-focus {
      position: absolute;
      width: 100%;
      z-index: 1;
      box-sizing: border-box;
      border: 1px solid var(--affine-primary-color);
      border-radius: 2px;
      pointer-events: none;
      display: none;
      outline: none;
    }

    @media print {
      affine-database-selection {
        display: none;
      }
    }
  `;V5=Fde([W("data-view-table-selection")],V5);var Vde=Object.defineProperty,zde=Object.getOwnPropertyDescriptor,jde=(t,e,n,i)=>{for(var r=i>1?void 0:i?zde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Vde(e,n,r),r};const Gde=X`
  affine-database-table {
    position: relative;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  affine-database-table * {
    box-sizing: border-box;
  }
  .affine-database-table {
    overflow-y: auto;
  }

  .affine-database-block-title-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 44px;
    margin: 2px 0 2px;
  }

  .affine-database-block-table {
    position: relative;
    width: 100%;
    padding-bottom: 4px;
    z-index: 1;
    overflow-x: scroll;
    overflow-y: hidden;
  }

  .affine-database-block-table:hover {
    padding-bottom: 0px;
  }

  .affine-database-block-table::-webkit-scrollbar {
    -webkit-appearance: none;
    display: block;
  }

  .affine-database-block-table::-webkit-scrollbar:horizontal {
    height: 4px;
  }

  .affine-database-block-table::-webkit-scrollbar-thumb {
    border-radius: 2px;
    background-color: transparent;
  }

  .affine-database-block-table:hover::-webkit-scrollbar:horizontal {
    height: 8px;
  }

  .affine-database-block-table:hover::-webkit-scrollbar-thumb {
    border-radius: 16px;
    background-color: var(--affine-black-30);
  }

  .affine-database-block-table:hover::-webkit-scrollbar-track {
    background-color: var(--affine-hover-color);
  }

  .affine-database-table-container {
    position: relative;
    width: fit-content;
    min-width: 100%;
  }

  .affine-database-block-tag-circle {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: inline-block;
  }

  .affine-database-block-tag {
    display: inline-flex;
    border-radius: 11px;
    align-items: center;
    padding: 0 8px;
    cursor: pointer;
  }

  .database-cell {
    border-left: 1px solid var(--affine-border-color);
  }
  .data-view-table-left-bar {
    display: flex;
    align-items: center;
    position: sticky;
    left: 0;
    width: ${Uv}px;
    flex-shrink: 0;
    background-color: var(--affine-background-primary-color);
  }
  .affine-database-block-rows {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
  }
`;let z5=class extends Pr{constructor(){super(...arguments),this.dragController=new Bde(this),this.selectionController=new Ude(this),this.hotkeysController=new Rde(this),this.clipboardController=new Lde(this),this._addRow=(t,e)=>{if(this.readonly)return;const n=typeof e=="number"?e:Qr(e,this.view.rows.map(i=>({id:i})));t.rowAdd(e),requestAnimationFrame(()=>{this.selectionController.selection={focus:{rowIndex:n,columnIndex:0},isEditing:!0}})},this.renderAddGroup=t=>{const e=t.addGroup;return e?Be` <div style="display:flex;">
      <div
        class="dv-hover dv-round-8"
        style="display:flex;align-items:center;gap: 10px;padding: 6px 12px 6px 8px;color: var(--affine-text-secondary-color);font-size: 12px;line-height: 20px;position: sticky;left: ${Uv}px;"
        @click="${i=>{const r=i.currentTarget;hn(r,{options:{input:{onComplete:o=>{const s=t.column;s&&s.updateData(()=>e(o,s.data))}},items:[]}})}}"
      >
        <div class="dv-icon-16" style="display:flex;">${rl}</div>
        <div>New Group</div>
      </div>
    </div>`:void 0},this.onWheel=t=>{if(t.metaKey||t.ctrlKey)return;const e=t.currentTarget;if(e instanceof HTMLElement){if(e.scrollWidth===e.clientWidth)return;t.stopPropagation()}},this.getSelection=()=>this.selectionController.selection}get readonly(){return this.view.readonly}connectedCallback(){super.connectedCallback(),this._disposables.add(this.view.slots.update.on(()=>{this.requestUpdate(),this.querySelectorAll("affine-data-view-table-group").forEach(t=>{t.requestUpdate()})})),this.readonly}addRow(t){this._addRow(this.view,t)}renderTable(){const t=this.view.groupHelper;return t?Be`
        <div style="display:flex;flex-direction: column;gap: 16px;">
          ${t.groups.map(e=>Be`<affine-data-view-table-group
              data-group-key="${e.key}"
              .view="${this.view}"
              .viewEle="${this}"
              .group="${e}"
            ></affine-data-view-table-group>`)}
          ${this.renderAddGroup(t)}
        </div>
      `:Be`<affine-data-view-table-group
      .view="${this.view}"
      .viewEle="${this}"
    ></affine-data-view-table-group>`}hideIndicator(){this.dragController.dropPreview.remove()}moveTo(t,e){const n=this.dragController.getInsertPosition(e);n&&this.view.rowMove(t,n.position,void 0,n.groupKey)}showIndicator(t){return this.dragController.showIndicator(t)!=null}render(){return Be`
      ${oi(this.header,{view:this.view,viewMethods:this})}
      <div class="affine-database-table">
        <div class="affine-database-block-table" @wheel="${this.onWheel}">
          <div class="affine-database-table-container">
            ${this.renderTable()}
          </div>
        </div>
      </div>
    `}focusFirstCell(){this.selectionController.focusFirstCell()}};z5.styles=Gde;z5=jde([W("affine-database-table")],z5);fs.register("table",{view:Zt(z5),icon:Mr("DatabaseTableViewIcon"),tools:[Zt(Cp),Zt(F5),Zt(hc),Zt(Ep),Zt(Sp)]});const Zde="text",Wde=Gt.register(Zde,{name:"Plain-Text",type:()=>ln.create(),defaultData:()=>({}),cellToString:t=>t??"",cellFromString:t=>({value:t}),cellToJson:t=>t??null});_p.register("kanban",{defaultName:"Kanban View",init(t,e,n){const i=t.columns.filter(s=>{const a=Gt.getColumn(s.type).dataType(s.data);return!!_r.match(a)&&s.type!=="title"}),r=s=>[fu.type,hl.type].includes(s.type)?3:[F0.type,Wde.type].includes(s.type)?2:1,o=i.sort((s,a)=>r(a)-r(s))[0];if(!o)throw new Error("not implement yet");return{id:e,name:n,mode:"kanban",columns:t.columns.map(s=>({id:s.id,hide:!1})),filter:{type:"group",op:"and",conditions:[]},groupBy:Bv(o.id,o.type,o.data),header:{titleColumn:t.columns.find(s=>s.type==="title")?.id,iconColumn:"type"},groupProperties:[]}}});const zA=(t,e,n)=>{const i=n.selection;n.selection=void 0,zv({pageElement:t,view:n.view,rowId:e,onClose:()=>{n.selection=i}})},vC=(t,e,n,i)=>{Ui(e,[{type:"action",name:"Expand Card",icon:yb,select:()=>{zA(t,n,i)}},{type:"sub-menu",name:"Move To",icon:zL,options:{input:{search:!0},items:i.view.groupHelper?.groups.filter(r=>{const o=i.selection;return o?.selectionType==="card"?r.key!==o?.cards[0].groupKey:!1}).map(r=>({type:"action",name:r.value!=null?r.name:"Ungroup",select:()=>{i.moveCard(n,r.key)}}))??[]}},{type:"group",name:"",children:()=>[{type:"action",name:"Insert Before",icon:b` <div
            style="transform: rotate(90deg);display:flex;align-items:center;"
          >
            ${y3}
          </div>`,select:()=>{i.insertRowBefore()}},{type:"action",name:"Insert After",icon:b` <div
            style="transform: rotate(90deg);display:flex;align-items:center;"
          >
            ${w3}
          </div>`,select:()=>{i.insertRowAfter()}}]},{type:"group",name:"",children:()=>[{type:"action",name:"Delete Card",class:"delete-item",icon:xn,select:()=>{i.deleteCard()}}]}])};var qde=Object.defineProperty,Yde=Object.getOwnPropertyDescriptor,G0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Yde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qde(e,n,r),r};const Xde=X`
  affine-data-view-kanban-card {
    display: flex;
    position: relative;
    flex-direction: column;
    border: 1px solid var(--affine-border-color);
    box-shadow: 0px 2px 3px 0px rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    transition: background-color 100ms ease-in-out;
    background-color: var(--affine-background-kanban-card-color);
  }

  affine-data-view-kanban-card:hover {
    background-color: var(--affine-hover-color);
  }

  affine-data-view-kanban-card .card-header {
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  affine-data-view-kanban-card .card-header-title uni-lit {
    width: 100%;
  }

  .card-header.has-divider {
    border-bottom: 0.5px solid var(--affine-border-color);
  }

  affine-data-view-kanban-card .card-header-title {
    font-size: var(--data-view-cell-text-size);
    line-height: var(--data-view-cell-text-line-height);
  }

  affine-data-view-kanban-card .card-header-icon {
    padding: 4px;
    background-color: var(--affine-background-secondary-color);
    display: flex;
    align-items: center;
    border-radius: 4px;
    width: max-content;
  }

  affine-data-view-kanban-card .card-header-icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
  }

  affine-data-view-kanban-card .card-body {
    display: flex;
    flex-direction: column;
    padding: 8px;
    gap: 4px;
  }

  affine-data-view-kanban-card:hover .card-ops {
    visibility: visible;
  }

  .card-ops {
    position: absolute;
    right: 8px;
    top: 8px;
    visibility: hidden;
    display: flex;
    gap: 4px;
    cursor: pointer;
  }

  .card-op {
    display: flex;
    position: relative;
    padding: 4px;
    border-radius: 4px;
    box-shadow: 0px 0px 4px 0px rgba(66, 65, 73, 0.14);
    background-color: var(--affine-background-primary-color);
  }

  .card-op:hover:before {
    content: '';
    border-radius: 4px;
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background-color: var(--affine-hover-color);
  }

  .card-op svg {
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
    width: 16px;
    height: 16px;
  }
`;let js=class extends me(De){constructor(){super(...arguments),this.isFocus=!1,this.clickEdit=t=>{t.stopPropagation();const e=this.getSelection(),n=gs(this);e&&zA(n,this.cardId,e)},this.clickMore=t=>{t.stopPropagation();const e=this.getSelection(),n=t.currentTarget;if(e){e.selection={selectionType:"card",cards:[{groupKey:this.groupKey,cardId:this.cardId}]};const i=gs(this);vC(i,n,this.cardId,e)}},this.contextMenu=t=>{t.stopPropagation(),t.preventDefault();const e=this.getSelection();if(e){e.selection={selectionType:"card",cards:[{groupKey:this.groupKey,cardId:this.cardId}]};const n=gs(this);vC(n,gd(t.x,t.y),this.cardId,e)}}}connectedCallback(){super.connectedCallback(),this._disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()})),!this.view.readonly&&(this._disposables.addFromEvent(this,"contextmenu",t=>{this.contextMenu(t)}),this._disposables.addFromEvent(this,"click",t=>{if(t.shiftKey){this.getSelection()?.shiftClickCard(t);return}const e=this.getSelection(),n=e?.selection;if(n?.selectionType!=="card")return;e&&(e.selection=void 0);const i=gs(this);zv({pageElement:i,view:this.view,rowId:this.cardId,onClose:()=>{e&&(e.selection=n)}})}))}renderTitle(){const t=this.view.getHeaderTitle(this.cardId);if(t)return Be` <div class="card-header-title">
      <affine-data-view-kanban-cell
        .contentOnly="${!0}"
        data-column-id="${t.id}"
        .view="${this.view}"
        .groupKey="${this.groupKey}"
        .column="${t}"
        .cardId="${this.cardId}"
      ></affine-data-view-kanban-cell>
    </div>`}renderIcon(){const t=this.view.getHeaderIcon(this.cardId);if(t)return Be` <div class="card-header-icon">
      ${t.getValue(this.cardId)}
    </div>`}renderHeader(t){if(!this.view.hasHeader(this.cardId))return"";const e=Qe({"card-header":!0,"has-divider":t.length>0});return Be`
      <div class="${e}">${this.renderTitle()} ${this.renderIcon()}</div>
    `}renderBody(t){return t.length===0?"":Be` <div class="card-body">
      ${Fe(t,e=>e.id,e=>this.view.isInHeader(e.id)?"":Be` <affine-data-view-kanban-cell
            .contentOnly="${!1}"
            data-column-id="${e.id}"
            .view="${this.view}"
            .groupKey="${this.groupKey}"
            .column="${e}"
            .cardId="${this.cardId}"
          ></affine-data-view-kanban-cell>`)}
    </div>`}render(){const t=this.view.columnManagerList.filter(e=>!this.view.isInHeader(e.id));return this.style.border=this.isFocus?"1px solid var(--affine-primary-color)":"",Be`
      ${this.renderHeader(t)} ${this.renderBody(t)}
      ${this.renderOps()}
    `}renderOps(){if(!this.view.readonly)return Be`
      <div class="card-ops">
        <div class="card-op" @click="${this.clickEdit}">${db}</div>
        <div class="card-op" @click="${this.clickMore}">
          ${Xo}
        </div>
      </div>
    `}getSelection(){return this.closest("affine-data-view-kanban")?.selectionController}};js.styles=Xde;G0([L({attribute:!1})],js.prototype,"view",2);G0([L({attribute:!1})],js.prototype,"groupKey",2);G0([L({attribute:!1})],js.prototype,"cardId",2);G0([ie()],js.prototype,"isFocus",2);js=G0([W("affine-data-view-kanban-card")],js);var Kde=Object.defineProperty,Qde=Object.getOwnPropertyDescriptor,jv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Qde(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Kde(e,n,r),r};const Jde=X`
  affine-data-view-kanban-group {
    width: 260px;
    flex-shrink: 0;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
  }

  .group-header {
    height: 32px;
    padding: 6px 4px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    overflow: hidden;
  }

  .group-header-title {
    overflow: hidden;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: var(--data-view-cell-text-size);
  }

  affine-data-view-kanban-group:hover .group-header-op {
    visibility: visible;
    opacity: 1;
  }

  .group-body {
    margin-top: 4px;
    display: flex;
    flex-direction: column;
    padding: 0 4px;
    gap: 12px;
  }

  .add-card {
    display: flex;
    align-items: center;
    height: 28px;
    padding: 4px;
    border-radius: 4px;
    cursor: pointer;
    font-size: var(--data-view-cell-text-size);
    line-height: var(--data-view-cell-text-line-height);
    visibility: hidden;
    opacity: 0;
    transition: all 150ms cubic-bezier(0.42, 0, 1, 1);
    color: var(--affine-text-secondary-color);
  }

  affine-data-view-kanban-group:hover .add-card {
    visibility: visible;
    opacity: 1;
  }

  affine-data-view-kanban-group .add-card:hover {
    background-color: var(--affine-hover-color);
    color: var(--affine-text-primary-color);
  }

  affine-data-view-kanban-group:has(.add-card:hover) .add-card {
    background-color: var(--affine-hover-color);
    color: var(--affine-text-primary-color);
  }

  .sortable-ghost {
    background-color: var(--affine-hover-color);
    opacity: 0.5;
  }

  .sortable-drag {
    background-color: var(--affine-background-primary-color);
  }
`;let bc=class extends me(De){constructor(){super(...arguments),this.clickAddCard=()=>{const t=this.view.addCard("end",this.group.key);requestAnimationFrame(()=>{const e=this.closest("affine-data-view-kanban");e&&(e.selectionController.selection={selectionType:"cell",groupKey:this.group.key,cardId:t,columnId:this.view.header.titleColumn||this.view.columns[0],isEditing:!0})})},this.clickAddCardInStart=()=>{const t=this.view.addCard("start",this.group.key);requestAnimationFrame(()=>{const e=this.closest("affine-data-view-kanban");e&&(e.selectionController.selection={selectionType:"cell",groupKey:this.group.key,cardId:t,columnId:this.view.header.titleColumn||this.view.columns[0],isEditing:!0})})},this.clickGroupOptions=t=>{const e=t.currentTarget;Ui(e,[{type:"action",name:"Ungroup",hide:()=>this.group.value==null,select:()=>{this.group.rows.forEach(n=>{this.group.helper.removeFromGroup(n,this.group.key)})}},{type:"action",name:"Delete Cards",select:()=>{this.view.rowDelete(this.group.rows)}}])}}render(){const t=this.group.rows;return Be`
      <div class="group-header">
        ${VA(this.group,{readonly:this.view.readonly,clickAdd:this.clickAddCardInStart,clickOps:this.clickGroupOptions})}
      </div>
      <div class="group-body">
        ${Fe(t,e=>e,e=>Be`
              <affine-data-view-kanban-card
                data-card-id="${e}"
                .groupKey="${this.group.key}"
                .view="${this.view}"
                .cardId="${e}"
              ></affine-data-view-kanban-card>
            `)}
        ${this.view.readonly?ae:Be`<div class="add-card" @click="${this.clickAddCard}">
              <div
                style="margin-right: 4px;width: 16px;height: 16px;display:flex;align-items:center;"
              >
                ${rl}
              </div>
              Add
            </div>`}
      </div>
    `}};bc.styles=Jde;jv([L({attribute:!1})],bc.prototype,"view",2);jv([L({attribute:!1})],bc.prototype,"group",2);bc=jv([W("affine-data-view-kanban-group")],bc);var eue=Object.defineProperty,tue=Object.getOwnPropertyDescriptor,jA=(t,e,n,i)=>{for(var r=i>1?void 0:i?tue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&eue(e,n,r),r};const nue=X`
  affine-data-view-kanban-header {
    display: flex;
    justify-content: space-between;
    padding: 4px;
  }

  .select-group {
    border-radius: 8px;
    padding: 4px 8px;
    cursor: pointer;
  }

  .select-group:hover {
    background-color: var(--affine-hover-color);
  }
`;let j5=class extends me(De){constructor(){super(...arguments),this.clickGroup=t=>{hn(t.target,{options:{input:{search:!0},items:this.view.columnManagerList.filter(e=>e.id!==this.view.view.groupBy?.columnId).map(e=>({type:"action",name:e.name,select:()=>{this.view.changeGroup(e.id)}}))}})}}render(){return Be`
      <div></div>
      <div>
        <div class="select-group" @click="${this.clickGroup}">Group</div>
      </div>
    `}};j5.styles=nue;jA([L({attribute:!1})],j5.prototype,"view",2);j5=jA([W("affine-data-view-kanban-header")],j5);class iue{constructor(e){this.host=e,this.dropPreview=oue(),this.getInsertPosition=n=>{const r=document.elementsFromPoint(n.x,n.y).find(o=>o instanceof bc);if(r){const o=sue(r,n.y);return{group:r,card:o,position:o?{before:!0,id:o.cardId}:"end"}}else return},this.shooIndicator=(n,i)=>{const r=this.getInsertPosition(n);return r?this.dropPreview.display(r.group,i,r.card):this.dropPreview.remove(),r},this.dragStart=(n,i)=>{const r=n.getBoundingClientRect(),o=i.x-r.left,s=i.y-r.top,a=rue(n,i.x-o,i.y-s),l=n.closest("affine-data-view-kanban-group");zc(i,{onDrag:()=>{},onMove:c=>{if(!(c.target instanceof HTMLElement))return;if(a.display(c.x-o,c.y-s),!Bi.fromDOM(this.host).isPointIn(je.from(c))){const u=this.host.onDrag;return u?(this.dropPreview.remove(),{type:"out",callback:u(c,n.cardId)}):void 0}const d=this.shooIndicator(c,n);if(d)return{type:"self",key:d.group.group.key,position:d.position}},onClear:()=>{a.remove(),this.dropPreview.remove()},onDrop:c=>{if(c){if(c.type==="out"){c.callback();return}c&&l&&l.group.helper.moveCardTo(n.cardId,l.group.key,c.key,c.position)}}})},this.host.addController(this)}hostConnected(){this.host.view.readonly||this.host.disposables.add(this.host.handleEvent("dragStart",e=>{const n=this.host.selectionController.selection;if(n&&n.selectionType==="cell"&&n.isEditing)return;const i=e.get("pointerState").raw,r=i.target;if(r instanceof Element){const o=r.closest("affine-data-view-kanban-card");o&&this.dragStart(o,i)}return!0}))}}const rue=(t,e,n)=>{const i=t.style.opacity;t.style.opacity="0.5";const r=document.createElement("div"),o=new js;return o.cardId=t.cardId,o.view=t.view,o.isFocus=!0,o.style.backgroundColor="var(--affine-background-primary-color)",r.append(o),r.className="with-data-view-css-variable blocksuite-overlay",r.style.width=`${t.getBoundingClientRect().width}px`,r.style.position="fixed",r.style.transform="rotate(-3deg)",r.style.left=`${e}px`,r.style.top=`${n}px`,r.style.zIndex="9999",document.body.append(r),{display(s,a){r.style.left=`${Math.round(s)}px`,r.style.top=`${Math.round(a)}px`},remove(){t.style.opacity=i,r.remove()}}},oue=()=>{const t=document.createElement("div");return t.style.height="2px",t.style.borderRadius="1px",t.style.backgroundColor="var(--affine-primary-color)",t.style.boxShadow="0px 0px 8px 0px rgba(30, 150, 235, 0.35)",{display(e,n,i){const r=i??e.querySelector(".add-card");if(D(r),r.previousElementSibling===n||r===n){t.remove();return}r.previousElementSibling!==t&&r.insertAdjacentElement("beforebegin",t)},remove(){t.remove()}}},sue=(t,e)=>{const n=Array.from(t.querySelectorAll("affine-data-view-kanban-card")),r=n.map(o=>{const s=o.getBoundingClientRect();return(s.top+s.bottom)/2}).findIndex(o=>o>e);return n[r]};class aue{constructor(e){this.host=e,this._onCopy=async(n,i)=>!0,this._onPaste=n=>!0,e.addController(this)}get readonly(){return this.host.view.readonly}hostConnected(){this.host.disposables.add(this.host.handleEvent("copy",e=>{const n=this.host.selectionController.selection;return n?(this._onCopy(e,n).catch(console.error),!0):!1})),this.host.disposables.add(this.host.handleEvent("paste",e=>this.readonly?!1:(this._onPaste(e),!0)))}}class lue{constructor(e){this.host=e,this.host.addController(this)}hostConnected(){this.host.disposables.add(this.host.bindHotkey({Escape:()=>(this.host.selectionController.focusOut(),!0),Enter:()=>{this.host.selectionController.focusIn()},ArrowUp:e=>(this.host.selectionController.focusNext("up"),e.get("keyboardState").raw.preventDefault(),!0),ArrowDown:e=>(this.host.selectionController.focusNext("down"),e.get("keyboardState").raw.preventDefault(),!0),ArrowLeft:e=>(this.host.selectionController.focusNext("left"),e.get("keyboardState").raw.preventDefault(),!0),ArrowRight:e=>(this.host.selectionController.focusNext("right"),e.get("keyboardState").raw.preventDefault(),!0),Backspace:()=>{this.host.selectionController.deleteCard()}}))}}class cue{constructor(e){this.host=e,this.shiftClickCard=n=>{n.preventDefault();const i=this.selection,r=n.target,o=r.closest("affine-data-view-kanban-card")?.cardId,s=r.closest("affine-data-view-kanban-group")?.group.key;if(!o||!s)return;const a=i?.selectionType==="card"?i.cards:[],l=a.findIndex(c=>c.cardId===o)>=0?a.filter(c=>c.cardId!==o):[...a,{cardId:o,groupKey:s}];this.selection=zf(l)?{selectionType:"card",cards:l}:void 0},this.host.addController(this)}get view(){return this.host.view}hostConnected(){this.host.disposables.add(this.host.selectionUpdated.on(e=>{const n=this._selection;n&&this.blur(n),this._selection=e,e&&this.focus(e)}))}get selection(){return this._selection}set selection(e){if(!e){this.host.setSelection();return}const n={...e,viewId:this.host.view.id,type:"kanban"};if(n.selectionType==="cell"&&n.isEditing){const r=C2(this.host,n)?.cell,o=r&&r.beforeEnterEditMode()?n.isEditing:!1;this.host.setSelection({...n,isEditing:o})}else this.host.setSelection(n)}blur(e){if(e.selectionType!=="cell"){_2(this.host,e).forEach(o=>o.isFocus=!1);return}const n=C2(this.host,e);if(!n)return;n.isFocus=!1;const i=n?.cell;e.isEditing?(i?.onExitEditMode(),i?.blurCell()&&n.blur(),n.editing=!1):n.blur()}focus(e){if(e.selectionType!=="cell"){_2(this.host,e).forEach((o,s)=>{s===0&&o.scrollIntoView({block:"nearest",inline:"nearest"}),o.isFocus=!0});return}const n=C2(this.host,e);if(!n)return;n.scrollIntoView({block:"nearest",inline:"nearest"}),n.isFocus=!0;const i=n?.cell;e.isEditing?(i?.onEnterEditMode(),i?.focusCell()&&n.focus(),n.editing=!0):n.focus()}getNextFocusCell(e,n,i){const r=wC(this.host,e),o=this.host.querySelector(`affine-data-view-kanban-group[data-key="${e.groupKey}"]`),s=Array.from(o?.querySelectorAll("affine-data-view-kanban-card")??[]);if(i==="up"){const l=n-1;return l<0?s.length>1?yC(i,s,e,c=>c===0?s.length-1:c-1):{cell:r[r.length-1]}:{cell:r[l]}}if(i==="down"){const l=n+1;return l>=r.length?s.length>1?yC(i,s,e,c=>c===s.length-1?0:c+1):{cell:r[0]}:{cell:r[l]}}const a=Array.from(this.host.querySelectorAll("affine-data-view-kanban-group"));if(i==="right")return Vf(this.host,a,e,l=>l===a.length-1?0:l+1);if(i==="left")return Vf(this.host,a,e,l=>l===0?a.length-1:l-1);throw new Error("Unknown arrow keys, only support: up, down, left, and right keys.")}getNextFocusCard(e,n,i){const r=this.host.querySelector(`affine-data-view-kanban-group[data-key="${e.cards[0].groupKey}"]`),o=Array.from(r?.querySelectorAll("affine-data-view-kanban-card")??[]);if(i==="up"){const a=n-1,l=a<0?o.length-1:a,c=o[l];return{card:c,cards:[{cardId:c.cardId,groupKey:c.groupKey}]}}if(i==="down"){const a=n+1,l=a>o.length-1?0:a,c=o[l];return{card:c,cards:[{cardId:c.cardId,groupKey:c.groupKey}]}}const s=Array.from(this.host.querySelectorAll("affine-data-view-kanban-group"));if(i==="right")return Vf(this.host,s,e,a=>a===s.length-1?0:a+1);if(i==="left")return Vf(this.host,s,e,a=>a===0?s.length-1:a-1);throw new Error("Unknown arrow keys, only support: up, down, left, and right keys.")}focusNext(e){const n=this.selection;if(n){if(n.selectionType==="cell"&&!n.isEditing){const r=wC(this.host,n).findIndex(l=>l.column.id===n.columnId),{cell:o,cardId:s,groupKey:a}=this.getNextFocusCell(n,r,e);o instanceof Cr&&(this.selection={...n,cardId:s??n.cardId,groupKey:a??n.groupKey,columnId:o.column.id})}else if(n.selectionType==="card"){const i=this.host.querySelector(`affine-data-view-kanban-group[data-key="${n.cards[0].groupKey}"]`),o=Array.from(i?.querySelectorAll("affine-data-view-kanban-card")??[]).findIndex(l=>l.cardId===n.cards[0].cardId),{card:s,cards:a}=this.getNextFocusCard(n,o,e);if(s instanceof js){const l=a??n.cards;this.selection=zf(l)?{...n,cards:l}:void 0}}}}focusOut(){const e=this.selection;if(e?.selectionType==="card")if(zf(e.cards))this.selection={...e,cards:[e.cards[0]]};else return;e?.selectionType==="cell"&&(e.isEditing?this.selection={...e,isEditing:!1}:this.selection={selectionType:"card",cards:[{cardId:e.cardId,groupKey:e.groupKey}]})}focusIn(){const e=this.selection;if(e&&!(e.selectionType==="cell"&&e.isEditing)){if(e.selectionType==="cell"){this.selection={...e,isEditing:!0};return}if(e.selectionType==="card"){const n=_2(this.host,e)[0],i=n?.querySelector("affine-data-view-kanban-cell");i&&(this.selection={groupKey:n.groupKey,cardId:n.cardId,selectionType:"cell",columnId:i.column.id,isEditing:!1})}}}deleteCard(){const e=this.selection;!e||e.selectionType==="cell"||e.selectionType==="card"&&(this.host.view.rowDelete(e.cards.map(n=>n.cardId)),this.selection=void 0)}focusFirstCell(){const e=this.host.groupHelper?.groups[0],n=e?.rows[0],i=n&&this.host.view.getHeaderTitle(n)?.id;e&&n&&i&&(this.selection={selectionType:"cell",groupKey:e.key,cardId:n,columnId:i,isEditing:!1})}insertRowBefore(){const e=this.selection;if(e?.selectionType!=="card")return;const{cardId:n,groupKey:i}=e.cards[0],r=this.view.addCard({before:!0,id:n},i);requestAnimationFrame(()=>{const o=this.view.header.titleColumn;o?this.selection={selectionType:"cell",groupKey:i,cardId:r,columnId:o,isEditing:!0}:this.selection={selectionType:"card",cards:[{cardId:r,groupKey:i}]}})}insertRowAfter(){const e=this.selection;if(e?.selectionType!=="card")return;const{cardId:n,groupKey:i}=e.cards[0],r=this.view.addCard({before:!1,id:n},i);requestAnimationFrame(()=>{const o=this.view.header.titleColumn;o?this.selection={selectionType:"cell",groupKey:i,cardId:r,columnId:o,isEditing:!0}:this.selection={selectionType:"card",cards:[{cardId:r,groupKey:i}]}})}moveCard(e,n){const i=this.selection;i?.selectionType==="card"&&(this.view.groupHelper?.moveCardTo(e,i.cards[0].groupKey,n,"start"),requestAnimationFrame(()=>{if(this.selection?.selectionType!=="card")return;const r=i.cards.map(o=>({...o,groupKey:o.groupKey}));this.selection=zf(r)?{...i,cards:r}:void 0}))}}function Vf(t,e,n,i){const r=e.findIndex(f=>n.selectionType==="cell"?f.group.key===n.groupKey:f.group.key===n.cards[0].groupKey),o=i(r),s=e[o],a=n.selectionType==="cell"?C2(t,n):_2(t,n)[0];D(a);const l=a.getBoundingClientRect(),c=Array.from(s.querySelectorAll("affine-data-view-kanban-card")),d=c.map((f,v)=>{const m=f.getBoundingClientRect();return{offsetY:xC(l,m),index:v}}).reduce((f,v)=>f.offsetY<v.offsetY?f:v),u=c[d.index];if(n.selectionType==="card")return{card:u,cards:[{cardId:u.cardId,groupKey:s.group.key}]};const h=Array.from(u.querySelectorAll("affine-data-view-kanban-cell")),p=h.map((f,v)=>{const m=f.getBoundingClientRect();return{offsetY:xC(l,m),index:v}}).reduce((f,v)=>f.offsetY<v.offsetY?f:v);return{cell:h[p.index],cardId:u.cardId,groupKey:s.group.key}}function yC(t,e,n,i){const r=e.findIndex(c=>c.cardId===n.cardId),o=i(r),s=e[o],a=Array.from(s.querySelectorAll("affine-data-view-kanban-cell")),l=t==="up"?a.length-1:0;return{cell:a[l],cardId:s.cardId}}function wC(t,e){const n=GA(t,e);return Array.from(n?.querySelectorAll("affine-data-view-kanban-cell")??[])}function GA(t,e){const n=t.querySelector(`affine-data-view-kanban-group[data-key="${e.groupKey}"]`);return n?n.querySelector(`affine-data-view-kanban-card[data-card-id="${e.cardId}"]`):null}function _2(t,e){if(e.selectionType==="group")return[];const i=e.cards.map(s=>s.groupKey).map(s=>t.querySelector(`affine-data-view-kanban-group[data-key="${s}"]`)).filter(s=>s!==null),r=e.cards.map(s=>s.cardId);return i.flatMap(s=>r.map(a=>s.querySelector(`affine-data-view-kanban-card[data-card-id="${a}"]`))).filter(s=>s!==null)}function C2(t,e){return GA(t,e)?.querySelector(`affine-data-view-kanban-cell[data-column-id="${e.columnId}"]`)}function xC(t,e){return Math.abs(t.top+(t.bottom-t.top)/2-(e.top+(e.bottom-e.top)/2))}const zf=t=>t.length>0;var due=Object.defineProperty,uue=Object.getOwnPropertyDescriptor,ZA=(t,e,n,i)=>{for(var r=i>1?void 0:i?uue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&due(e,n,r),r};const hue=X`
  affine-data-view-kanban {
    user-select: none;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .affine-data-view-kanban-groups {
    position: relative;
    z-index: 1;
    display: flex;
    gap: 20px;
    width: 100%;
    padding-bottom: 4px;
    overflow-x: scroll;
    overflow-y: hidden;
  }

  .affine-data-view-kanban-groups:hover {
    padding-bottom: 0px;
  }

  .affine-data-view-kanban-groups::-webkit-scrollbar {
    -webkit-appearance: none;
    display: block;
  }

  .affine-data-view-kanban-groups::-webkit-scrollbar:horizontal {
    height: 4px;
  }

  .affine-data-view-kanban-groups::-webkit-scrollbar-thumb {
    border-radius: 2px;
    background-color: transparent;
  }

  .affine-data-view-kanban-groups:hover::-webkit-scrollbar:horizontal {
    height: 8px;
  }

  .affine-data-view-kanban-groups:hover::-webkit-scrollbar-thumb {
    border-radius: 16px;
    background-color: var(--affine-black-30);
  }

  .affine-data-view-kanban-groups:hover::-webkit-scrollbar-track {
    background-color: var(--affine-hover-color);
  }

  .add-group-icon {
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    cursor: pointer;
  }

  .add-group-icon:hover {
    background-color: var(--affine-hover-color);
  }

  .add-group-icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-icon-color);
    color: var(--affine-icon-color);
  }
`;let Lp=class extends Pr{constructor(){super(...arguments),this.dragController=new iue(this),this.selectionController=new cue(this),this.hotkeysController=new lue(this),this.clipboardController=new aue(this),this.renderAddGroup=()=>{const t=this.groupHelper?.addGroup;return t?Be` <div
      style="height: 32px;width: 100px;flex-shrink:0;display:flex;align-items:center;"
      @click="${n=>{const i=n.currentTarget;hn(i,{options:{input:{onComplete:r=>{const o=this.groupHelper?.column;o&&o.updateData(()=>t(r,o.data))}},items:[]}})}}"
    >
      <div class="add-group-icon">${rl}</div>
    </div>`:void 0},this.onWheel=t=>{if(t.metaKey||t.ctrlKey)return;const e=t.currentTarget;if(e instanceof HTMLElement){if(e.scrollWidth===e.clientWidth)return;t.stopPropagation()}}}connectedCallback(){super.connectedCallback(),this.disposables.add(this.view.slots.update.on(()=>{this.requestUpdate()})),this.view.readonly}firstUpdated(){const t=We.create(this.groups,{group:`kanban-group-drag-${this.view.id}`,handle:".group-header",draggable:"affine-data-view-kanban-group",animation:100,onEnd:e=>{if(e.item instanceof bc){const n=Array.from(this.groups.querySelectorAll("affine-data-view-kanban-group")),i=e.newIndex!=null?n[e.newIndex-1]?.group.key:void 0;this.groupHelper?.moveGroupTo(e.item.group.key,i?{before:!1,id:i}:"start")}}});this._disposables.add({dispose:()=>{t.destroy()}})}render(){this.groupHelper=this.view.groupHelper;const t=this.groupHelper?.groups;return t?Be`
      ${oi(this.header,{view:this.view,viewMethods:this})}
      <div class="affine-data-view-kanban-groups" @wheel="${this.onWheel}">
        ${Fe(t,e=>e.key,e=>Be` <affine-data-view-kanban-group
              data-key="${e.key}"
              .view="${this.view}"
              .group="${e}"
            ></affine-data-view-kanban-group>`)}
        ${this.renderAddGroup()}
      </div>
    `:Be``}focusFirstCell(){this.selectionController.focusFirstCell()}getSelection(){return this.selectionController.selection}hideIndicator(){this.dragController.dropPreview.remove()}moveTo(t,e){const n=this.dragController.getInsertPosition(e);n&&n.group.group.helper.moveCardTo(t,"",n.group.group.key,n.position)}showIndicator(t){return this.dragController.shooIndicator(t,void 0)!=null}};Lp.styles=hue;ZA([he(".affine-data-view-kanban-groups")],Lp.prototype,"groups",2);Lp=ZA([W("affine-data-view-kanban")],Lp);fs.register("kanban",{icon:Mr("DatabaseKanbanViewIcon"),view:Zt(Lp),tools:[Zt(Cp),Zt(F5),Zt(hc),Zt(Ep)]});/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const WA=eD(class extends tD{constructor(){super(...arguments),this.key=ae}render(t,e){return this.key=t,e}update(t,[e,n]){return e!==this.key&&(nD(t),this.key=e),n}});var pue=Object.defineProperty,fue=Object.getOwnPropertyDescriptor,Gv=(t,e,n,i)=>{for(var r=i>1?void 0:i?fue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&pue(e,n,r),r};const gue={table:$A,kanban:AA};let Mp=class extends me(De){constructor(){super(...arguments),this._view=Ri(),this.viewMap={},this.focusFirstCell=()=>{this._view.value?.focusFirstCell()}}get expose(){return this._view.value}connectedCallback(){super.connectedCallback(),this.disposables.add(this.config.selectionUpdated.on(t=>{Object.entries(this.viewMap).forEach(([e,n])=>{if(!t||t.viewId!==e){n.selectionUpdated.emit(void 0);return}n.selectionUpdated.emit(t)})})),this.disposables.add(this.config.viewSource.updateSlot.on(()=>{this.requestUpdate(),this.config.viewSource.views.forEach(t=>{t.updateSlot.emit()})}))}getView(t){if(!this.viewMap[t]){const e=this.config.viewSource.viewGet(t),n=new gue[e.view.mode](e,this.config.dataSource);this.viewMap[t]={view:n,viewUpdated:e.updateSlot,selectionUpdated:new Ve,setSelection:i=>{this.config.setSelection(i)},handleEvent:(i,r)=>this.config.handleEvent(i,o=>{if(this.config.viewSource.currentViewId===t)return r(o)}),bindHotkey:i=>this.config.bindHotkey(Object.fromEntries(Object.entries(i).map(([r,o])=>[r,s=>{if(this.config.viewSource.currentViewId===t)return o(s)}])))}}return this.viewMap[t]}renderView(t){if(!t)return;const e={view:t.view,header:this.config.headerComponent,selectionUpdated:t.selectionUpdated,setSelection:t.setSelection,bindHotkey:t.bindHotkey,handleEvent:t.handleEvent,getFlag:this.config.getFlag,onDrag:this.config.onDrag,std:this.config.std};return WA(t.view.id,oi(fs.getView(t.view.type).view,e,{ref:this._view}))}render(){const e=this.config.viewSource.views.map(i=>this.getView(i.view.id)).find(i=>i.view.id===this.config.viewSource.currentViewId),n=Qe({"toolbar-hover-container":!0,"data-view-root":!0});return Be`
      <div style="display: contents" class="${n}">
        ${this.renderView(e)}
      </div>
    `}};Mp.styles=X`
    ${Je(Dv("affine-data-view-native"))}
    affine-data-view-native {
      background-color: var(--affine-background-primary-color);
      display: contents;
    }
  `;Gv([L({attribute:!1})],Mp.prototype,"config",2);Gv([ie()],Mp.prototype,"currentView",2);Mp=Gv([W("affine-data-view-native")],Mp);var mue=Object.defineProperty,bue=Object.getOwnPropertyDescriptor,qA=(t,e,n,i)=>{for(var r=i>1?void 0:i?bue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&mue(e,n,r),r};let Pp=class extends on{beforeEnterEditMode(){const t=!this.value;return this.onChange(t),t&&mP(this._checkbox,{left:-2}).catch(console.error),!1}onCopy(t){t.preventDefault()}onPaste(t){t.preventDefault()}onCut(t){t.preventDefault()}render(){const t=this.value??!1,e=t?av():lv();return b` <div class="affine-database-checkbox-container">
      <div
        class="affine-database-checkbox checkbox ${t?"checked":""}"
      >
        ${e}
      </div>
    </div>`}};Pp.styles=X`
    affine-database-checkbox-cell {
      display: block;
      width: 100%;
      cursor: pointer;
    }

    .affine-database-checkbox-container {
      height: 100%;
    }

    .affine-database-checkbox {
      display: flex;
      align-items: center;
      height: var(--data-view-cell-text-line-height);
      width: 100%;
      position: relative;
    }
    .affine-database-checkbox svg {
      width: 16px;
      height: 16px;
    }
  `;qA([he(".affine-database-checkbox")],Pp.prototype,"_checkbox",2);Pp=qA([W("affine-database-checkbox-cell")],Pp);sr.register({type:Ev.type,icon:Mr("CheckBoxIcon"),cellRenderer:{view:tn(Pp)}});const vue=Ev;function rm(t,e){const n=G2(t),i=G2(e);return+n==+i}function _C(t,e){const n=xr(t),i=xr(e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function yue(t){return rm(t,Date.now())}const CC=Ht`<svg width="7" height="10" viewBox="0 0 7 10" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path 
    fill="currentColor"
    fill-rule="evenodd"
    clip-rule="evenodd" 
    d="M6.10861 0.391387C6.35269 0.635464 6.35269 1.03119 6.10861 1.27527L2.38388 5L6.10861 8.72472C6.35269 8.9688 6.35269 9.36453 6.10861 9.6086C5.86453 9.85268 5.4688 9.85268 5.22473 9.6086L1.05806 5.44194C0.813981 5.19786 0.813981 4.80213 1.05806 4.55805L5.22473 0.391387C5.4688 0.147309 5.86453 0.147309 6.10861 0.391387Z" 
  />
</svg>
`,wue=X`
  :host {
    display: block;
  }

  .date-picker {
    background: var(--affine-background-overlay-panel-color);
    border-radius: 12px;
    box-sizing: border-box;
    box-shadow: var(--affine-menu-shadow);
    display: flex;
    flex-direction: column;
    gap: var(--gap-v);
    font-family: var(--affine-font-family);
  }

  /* small action */
  .date-picker-small-action {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 4px;
  }
  .interactive.date-picker-small-action,
  .interactive.action-label.today {
    color: var(--affine-icon-color);
  }
  .date-picker-small-action:hover {
    color: var(--affine-icon-hover-color);
    background: var(--affine-icon-hover-background);
  }
  .date-picker-small-action.left > svg {
    transform: rotate(0deg);
  }
  .date-picker-small-action.right > svg {
    transform: rotate(180deg);
  }
  .date-picker-small-action.down > svg {
    transform: rotate(-90deg);
  }

  /* action-header */
  .date-picker-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .date-picker-header__buttons {
    display: flex;
  }
  .date-picker-header__date {
    display: flex;
    align-items: center;
    gap: 4px;
    color: var(--affine-text-primary-color);
    font-weight: 600;
    padding: 2px;
    border-radius: 4px;
    font-size: 14px;
    line-height: 22px;
  }
  .date-picker-header__date > div {
    padding: 0px 4px;
  }
  .date-picker-header__action {
    display: flex;
    align-items: center;
    gap: 16px;
    color: var(--affine-icon-color);
  }
  .date-picker-header__action.with-slot {
    gap: 4px;
  }
  .date-picker-header__action .action-label {
    font-size: 12px;
    padding: 0px 4px;
    height: 20px;
    border-radius: 4px;
    transition: all 0.23s ease;
    max-width: 100px;
  }
  .date-picker-header__action .action-label > span {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
  }

  /** days header */
  .days-header {
    display: flex;
    gap: var(--gap-h);
  }
  .days-header > div {
    color: var(--affine-text-secondary-color);
    font-weight: 500;
    font-size: 12px;
    cursor: default;
  }

  /** week */
  .date-picker-weeks {
    display: flex;
    flex-direction: column;
    gap: var(--gap-v);
  }
  .date-picker-week {
    display: flex;
    gap: var(--gap-h);
  }

  /** cell */
  .date-cell {
    width: var(--cell-size);
    height: var(--cell-size);
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    border-radius: 8px;
  }
  .date-cell[data-date] {
    font-weight: 400;
    font-size: 14px;
  }
  .date-cell.date-cell--not-curr-month {
    opacity: 0.1;
  }
  .date-cell.date-cell--today {
    color: var(--affine-primary-color);
    font-weight: 600;
  }
  .date-cell.date-cell--selected {
    background: var(--affine-primary-color);
    color: var(--affine-pure-white);
    font-weight: 500;
  }

  /** interactive  */
  .interactive {
    cursor: pointer;
    /* transition:
      background 0.23s ease,
      color 0.23s ease; */
    user-select: none;
    position: relative;
    border: none;
    background-color: unset;
    font-family: var(--affine-font-family);
    color: var(--affine-text-primary-color);
  }
  /* --hover */
  .interactive::after,
  .interactive::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    transition: background 0.23s ease;
  }
  .interactive::after {
    opacity: 1;
    background: transparent;
  }
  .interactive:hover::after {
    background: var(--affine-hover-color);
  }
  /* --focus */
  .interactive::before {
    opacity: 0;
    transition: none;
    box-shadow: 0 0 0 3px var(--affine-primary-color);
  }
  /* .interactive:active, */
  .interactive:focus-visible {
    outline: none;
    outline: 1px solid var(--affine-primary-color);
  }
  /* .interactive:active::before, */
  .interactive:focus-visible::before {
    opacity: 0.5;
  }
  /** disabled */
  .interactive[disabled] {
    cursor: not-allowed;
    opacity: 0.5;
  }

  /** Month Select */
  .date-picker-month {
    --btn-width: 36px;
  }
  .date-picker-year {
    --btn-width: 46px;
  }
  .date-picker-month,
  .date-picker-year {
    display: grid;
    grid-template-columns: repeat(3, var(--btn-width));
    gap: 18px 32px;
    justify-content: space-between;
  }
  .date-picker-month button,
  .date-picker-year button {
    height: 34px;
    width: fit-content;
    padding: 4px;
    border-radius: 8px;
    font-size: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--btn-width);
  }
  .date-picker-month button.active,
  .date-picker-year button.active {
    color: var(--affine-primary-color);
    /* background: var(--affine-primary-color); */
    font-weight: 600;
  }
  .date-picker .date-picker-header {
    padding: 0px;
    transition: padding 0.23s ease;
  }
  .date-picker--mode-month,
  .date-picker--mode-year {
    gap: 26px;
  }
  .date-picker--mode-month .date-picker-header,
  .date-picker--mode-year .date-picker-header {
    /* padding: 0 10px; */
  }
`;function xue(t){return/^\d+$/.test(t)}function $1(t){return t instanceof Date?t:(typeof t=="string"&&xue(t)&&(t=+t),t?new Date(t):new Date)}function _ue(t){const e=$1(t);return new Date(e.getFullYear(),e.getMonth(),1)}function Cue(t){const e=$1(t);return new Date(e.getFullYear(),e.getMonth()+1,0)}function kue(t){const e=$1(t),n=_ue(e),i=Cue(e),r=new Date(n);r.setDate(n.getDate()-n.getDay());const o=new Date(i);o.setDate(i.getDate()+(6-i.getDay()));const s=[];let a=[];const l=new Date(r);for(;l<=o;)a.push(new Date(l)),a.length===7&&(s.push(a),a=[]),l.setDate(l.getDate()+1);return s}function kC(t,e,n){const[i,r]=[t,e].sort();return Math.min(Math.max(n,i),r)}var Eue=Object.defineProperty,Sue=Object.getOwnPropertyDescriptor,cr=(t,e,n,i)=>{for(var r=i>1?void 0:i?Sue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Eue(e,n,r),r};const EC=["Su","Mo","Tu","We","Th","Fr","Sa"],SC=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let si=class extends me(Ae){constructor(){super(...arguments),this.padding=20,this.size=28,this.gapH=10,this.gapV=8,this._cursor=new Date,this._monthCursor=0,this._yearCursor=0,this._monthPickYearCursor=0,this._matrix=[],this._yearMatrix=[],this._mode="date",this._maxYear=2099,this._minYear=1970}get year(){return this._cursor.getFullYear()}get month(){return this._cursor.getMonth()}get date(){return this._cursor.getDate()}get day(){return this._cursor.getDay()}get yearLabel(){return this.year}get monthLabel(){return SC[this.month]}get dayLabel(){return EC[this.day]}get cardWidth(){return this.size*7+this.padding*2+this.gapH*6}get cardHeight(){return this.size*7+this.padding*2+this.gapV*6-2}get minHeight(){return this.size*8+this.padding*2+this.gapV*7-2}get _cardStyle(){return{"--cell-size":`${this.size}px`,"--gap-h":`${this.gapH}px`,"--gap-v":`${this.gapV}px`,"min-width":`${this.cardWidth}px`,"min-height":`${this.cardHeight}px`,padding:`${this.padding}px`}}focusDateCell(){this.shadowRoot?.querySelector('button.date-cell[tabindex="0"]')?.focus()}isDateCellFocused(){return this.shadowRoot?.activeElement?.classList.contains("date-cell")}focusMonthCell(){this.shadowRoot?.querySelector('button.month-cell[tabindex="0"]')?.focus()}isMonthCellFocused(){return this.shadowRoot?.activeElement?.classList.contains("month-cell")}focusYearCell(){this.shadowRoot?.querySelector('button.year-cell[tabindex="0"]')?.focus()}isYearCellFocused(){return this.shadowRoot?.activeElement?.classList.contains("year-cell")}openMonthSelector(){this._monthCursor=this.month,this._monthPickYearCursor=this.year,this._mode="month"}closeMonthSelector(){this._mode="date"}toggleMonthSelector(){this._mode==="month"?this.closeMonthSelector():this.openMonthSelector()}openYearSelector(){this._yearCursor=kC(this._minYear,this._maxYear,this.year),this._mode="year",this._getYearMatrix()}closeYearSelector(){this._mode="date"}toggleYearSelector(){this._mode==="year"?this.closeYearSelector():this.openYearSelector()}_moveMonth(t){this._cursor.setMonth(this._cursor.getMonth()+t),this._getMatrix()}_modeDecade(t){this._yearCursor=kC(this._minYear,this._maxYear,this._yearCursor+t),this._getYearMatrix()}_onChange(t,e=!0){this._cursor=t,this.value=t.getTime(),this._getMatrix(),e&&this.onChange?.(t)}_getMatrix(){this._matrix=kue(this._cursor).map(t=>t.map(e=>{const n=rm(e,this._cursor)?0:-1;return{date:e,label:e.getDate().toString(),isToday:yue(e),notCurrentMonth:!_C(e,this._cursor),selected:this.value?rm(e,$1(this.value)):!1,tabIndex:n}}))}_getYearMatrix(){const e=Math.floor((this._yearCursor-this._minYear)/12)*12,n=this._minYear+e,i=n+12;this._yearMatrix=Array.from({length:i-n},(r,o)=>n+o).filter(r=>r>=this._minYear&&r<=this._maxYear)}firstUpdated(){this._disposables.addFromEvent(this,"keydown",t=>{t.stopPropagation();const e=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];e.includes(t.key)&&this.isDateCellFocused()&&(t.preventDefault(),t.key==="ArrowLeft"?this._cursor.setDate(this._cursor.getDate()-1):t.key==="ArrowRight"?this._cursor.setDate(this._cursor.getDate()+1):t.key==="ArrowUp"?this._cursor.setDate(this._cursor.getDate()-7):t.key==="ArrowDown"&&this._cursor.setDate(this._cursor.getDate()+7),this._getMatrix(),setTimeout(this.focusDateCell.bind(this))),e.includes(t.key)&&this.isMonthCellFocused()&&(t.preventDefault(),t.key==="ArrowLeft"?this._monthCursor=(this._monthCursor-1+12)%12:t.key==="ArrowRight"?this._monthCursor=(this._monthCursor+1)%12:t.key==="ArrowUp"?this._monthCursor=(this._monthCursor-3+12)%12:t.key==="ArrowDown"&&(this._monthCursor=(this._monthCursor+3)%12),setTimeout(this.focusMonthCell.bind(this))),e.includes(t.key)&&this.isYearCellFocused()&&(t.preventDefault(),t.key==="ArrowLeft"?this._modeDecade(-1):t.key==="ArrowRight"?this._modeDecade(1):t.key==="ArrowUp"?this._modeDecade(-3):t.key==="ArrowDown"&&this._modeDecade(3),setTimeout(this.focusYearCell.bind(this))),t.key==="Tab"&&setTimeout(()=>{const n=this.shadowRoot?.activeElement,i=this.shadowRoot?.querySelector("button");!t.shiftKey&&!n&&i?.focus(),t.shiftKey&&!this.shadowRoot?.contains(n)&&this.focusDateCell()})},!0)}_switchMode(t){return t[this._mode]??ae}updated(t){t.has("value")&&(this.value?this._onChange($1(this.value),!1):this._getMatrix())}connectedCallback(){super.connectedCallback(),this.value&&(this._cursor=$1(this.value)),this._getMatrix()}_navAction(t,e,n){const i=typeof t=="function"?t:t.action,r=typeof e=="function"?e:e.action,o=typeof t=="function"?!1:t.disable,s=typeof e=="function"?!1:e.disable,a=Qe({"date-picker-header__action":!0,"with-slot":!!n});return b`<div class=${a}>
      <button
        aria-label="previous month"
        class="date-picker-small-action interactive left"
        @click=${i}
        ?disabled=${o}
      >
        ${CC}
      </button>
      ${n??ae}
      <button
        aria-label="next month"
        class="date-picker-small-action interactive right"
        @click=${r}
        ?disabled=${s}
      >
        ${CC}
      </button>
    </div>`}_dayHeaderRenderer(){return b`<div class="days-header">
      ${EC.map(t=>b`<div class="date-cell">${t}</div>`)}
    </div>`}_cellRenderer(t){const e=Qe({interactive:!0,"date-cell":!0,"date-cell--today":t.isToday,"date-cell--not-curr-month":t.notCurrentMonth,"date-cell--selected":!!t.selected}),n=`${t.date.getFullYear()}-${t.date.getMonth()}-${t.date.getDate()}(${t.date.getDay()})`;return b`<button
      tabindex=${t.tabIndex??-1}
      aria-label=${n}
      data-date=${n}
      class=${e}
      @click=${()=>{this._onChange(t.date)}}
    >
      ${t.label}
    </button>`}_dateContent(){return b` <div class="date-picker-header">
        <div class="date-picker-header__buttons">
          <button
            class="date-picker-header__date interactive"
            @click=${()=>this.toggleMonthSelector()}
          >
            <div>${this.monthLabel}</div>
          </button>

          <button
            class="date-picker-header__date interactive"
            @click=${()=>this.toggleYearSelector()}
          >
            <div>${this.yearLabel}</div>
          </button>
        </div>

        ${this._navAction(()=>this._moveMonth(-1),()=>this._moveMonth(1),b`<button
            tabindex="0"
            aria-label="today"
            class="action-label interactive today"
            @click=${()=>{this._onChange(new Date)}}
          >
            <span>TODAY</span>
          </button>`)}
      </div>
      ${this._dayHeaderRenderer()}
      <div class="date-picker-weeks">
        ${this._matrix.map(t=>b`<div class="date-picker-week">
              ${t.map(e=>this._cellRenderer(e))}
            </div>`)}
      </div>`}_monthContent(){return b` <div class="date-picker-header">
        <button
          class="date-picker-header__date interactive"
          @click=${()=>this.toggleMonthSelector()}
        >
          <div>${this._monthPickYearCursor}</div>
        </button>

        ${this._navAction({action:()=>this._monthPickYearCursor--,disable:this._monthPickYearCursor<=this._minYear},{action:()=>this._monthPickYearCursor++,disable:this._monthPickYearCursor>=this._maxYear})}
      </div>
      <div class="date-picker-month">
        ${SC.map((t,e)=>{const n=this.value?_C(this.value,new Date(this._monthPickYearCursor,e,1)):!1,i=Qe({"month-cell":!0,interactive:!0,active:n});return b`<button
            tabindex=${this._monthCursor===e?0:-1}
            aria-label=${t}
            class=${i}
            @click=${()=>{this._cursor.setMonth(e),this._cursor.setFullYear(this._monthPickYearCursor),this._mode="date",this._getMatrix()}}
          >
            ${t}
          </button>`})}
      </div>`}_yearContent(){const t=this._yearMatrix[0],e=this._yearMatrix[this._yearMatrix.length-1];return b`<div class="date-picker-header">
        <button
          class="date-picker-header__date interactive"
          @click=${()=>this.toggleYearSelector()}
        >
          <div>${t}-${e}</div>
        </button>
        ${this._navAction({action:()=>this._modeDecade(-12),disable:t<=this._minYear},{action:()=>this._modeDecade(12),disable:e>=this._maxYear})}
      </div>
      <div class="date-picker-year">
        ${this._yearMatrix.map(n=>{const i=n===this._cursor.getFullYear(),r=Qe({"year-cell":!0,interactive:!0,active:i});return b`<button
            tabindex=${this._yearCursor===n?0:-1}
            aria-label=${n}
            class=${r}
            @click=${()=>{this._cursor.setFullYear(n),this._mode="date",this._getMatrix()}}
          >
            ${n}
          </button>`})}
      </div>`}render(){const t=Qe({"date-picker":!0,[`date-picker--mode-${this._mode}`]:!0}),e=we({"min-height":`${this.minHeight}px`});return b`<div style=${e} class="date-picker-height-wrapper">
      <div class=${t} style=${we(this._cardStyle)}>
        ${this._switchMode({date:this._dateContent(),month:this._monthContent(),year:this._yearContent()})}
      </div>
    </div>`}};si.styles=wue;cr([L({type:Number})],si.prototype,"value",2);cr([L({attribute:!1})],si.prototype,"onChange",2);cr([L({type:Number})],si.prototype,"padding",2);cr([L({type:Number})],si.prototype,"size",2);cr([L({type:Number})],si.prototype,"gapH",2);cr([L({type:Number})],si.prototype,"gapV",2);cr([L({attribute:!1})],si.prototype,"_monthCursor",2);cr([L({attribute:!1})],si.prototype,"_yearCursor",2);cr([L({attribute:!1})],si.prototype,"_monthPickYearCursor",2);cr([L({attribute:!1})],si.prototype,"_matrix",2);cr([L({attribute:!1})],si.prototype,"_yearMatrix",2);cr([L({attribute:!1})],si.prototype,"_mode",2);si=cr([W("date-picker")],si);var Tue=Object.defineProperty,Iue=Object.getOwnPropertyDescriptor,Zv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Iue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Tue(e,n,r),r};let G5=class extends on{render(){const t=this.value?Zh(new Date(this.value),"yyyy-MM-dd"):"";return t?b` <input
      type="date"
      value="${t}"
      class="affine-database-date date"
    />`:""}};G5.styles=X`
    affine-database-date-cell {
      width: 100%;
    }

    .affine-database-date {
      display: flex;
      align-items: center;
      width: 100%;
      padding: 0;
      border: none;
      font-family: ${Je(vt.fontSansFamily)};
      color: var(--affine-text-primary-color);
      font-weight: 400;
      background-color: transparent;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      height: var(--data-view-cell-text-line-height);
    }

    input.affine-database-date[type='date']::-webkit-calendar-picker-indicator {
      display: none;
    }
  `;G5=Zv([W("affine-database-date-cell")],G5);let Ap=class extends on{constructor(){super(...arguments),this._prevPortalAbortController=null,this._datePicker=null,this._setValue=(t=this._inputEle.value)=>{if(t===""){this.onChange(void 0),this._inputEle.value="";return}const e=new Date(t),n=Zh(e,"yyyy-MM-dd");this.onChange(e.getTime()),this._inputEle.value=`${n??""}`},this._onFocus=()=>{if(this._prevPortalAbortController&&!this._prevPortalAbortController.signal.aborted)return;this._prevPortalAbortController?.abort();const t=new AbortController;this._prevPortalAbortController=t,t.signal.addEventListener("abort",()=>this._datePicker=null,{once:!0});const e=Rs({abortController:t,closeOnClickAway:!0,computePosition:{referenceElement:this._inputEle,placement:"bottom",middleware:[Dt(10),Dn()]},template:()=>{const n=new si;return n.value=this.value??Date.now(),n.onChange=i=>{this._setValue(i.toISOString())},setTimeout(()=>n.focusDateCell()),this._datePicker=n,n}});e.style.zIndex="1002"}}onExitEditMode(){this._setValue()}firstUpdated(){this._inputEle.focus()}_onInput(t){if(!this._datePicker)return;const e=t.target.value;this._datePicker.value=e?new Date(e).getTime():void 0}render(){const t=this.value?Zh(this.value,"yyyy-MM-dd"):"";return b`<input
      type="date"
      class="affine-database-date date"
      .value="${t}"
      @focus=${this._onFocus}
      @input=${this._onInput}
    />`}};Ap.styles=X`
    affine-database-date-cell-editing {
      width: 100%;
      cursor: text;
    }

    .affine-database-date:focus {
      outline: none;
    }
  `;Zv([he("input")],Ap.prototype,"_inputEle",2);Ap=Zv([W("affine-database-date-cell-editing")],Ap);sr.register({type:Sv.type,icon:Mr("DateTime"),cellRenderer:{view:tn(G5),edit:tn(Ap)}});const Lue=Sv,YA="image";Gt.register(YA,{name:"image",type:()=>dle.create(),defaultData:()=>({}),cellToString:t=>t??"",cellFromString:t=>({value:t}),cellToJson:t=>t??null});var Mue=Object.defineProperty,Pue=Object.getOwnPropertyDescriptor,Aue=(t,e,n,i)=>{for(var r=i>1?void 0:i?Pue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Mue(e,n,r),r};let Z5=class extends on{render(){return b`<img src=${this.value??""}></img>`}};Z5.styles=X`
    affine-database-image-cell {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
    }
    affine-database-image-cell img {
      width: 20px;
      height: 20px;
    }
  `;Z5=Aue([W("affine-database-image-cell")],Z5);sr.register({type:YA,icon:Mr("ImageIcon"),cellRenderer:{view:tn(Z5)}});var $ue=Object.defineProperty,Bue=Object.getOwnPropertyDescriptor,XA=(t,e,n,i)=>{for(var r=i>1?void 0:i?Bue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&$ue(e,n,r),r};let W5=class extends De{render(){return To(this.link)?b`<a
      class="link-node"
      href=${this.link}
      rel="noopener noreferrer"
      target="_blank"
      ><span class="link-node-text">${this.link}</span></a
    >`:b`<span class="normal-text">${this.link}</span>`}};W5.styles=X`
    .link-node {
      word-break: break-all;
      color: var(--affine-link-color);
      fill: var(--affine-link-color);
      cursor: pointer;
      font-weight: normal;
      font-style: normal;
      text-decoration: none;
    }
  `;XA([L({attribute:!1})],W5.prototype,"link",2);W5=XA([W("affine-database-link-node")],W5);var Due=Object.defineProperty,Oue=Object.getOwnPropertyDescriptor,Wv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Oue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Due(e,n,r),r};let q5=class extends on{constructor(){super(...arguments),this._onClick=t=>{t.stopPropagation();const e=this.value??"";if(!e||!To(e)){this.selectCurrentCell(!0);return}if(To(e)){const i=t.target.querySelector(".link-node");i&&(t.preventDefault(),i.click());return}},this._onEdit=t=>{t.stopPropagation(),this.selectCurrentCell(!0)}}render(){const t=this.value??"";return Be`
      <div class="affine-database-link" @click="${this._onClick}">
        <affine-database-link-node
          .link="${t}"
        ></affine-database-link-node>
        <div class="affine-database-link-icon" @click="${this._onEdit}">
          ${oI}
        </div>
      </div>
    `}};q5.styles=X`
    affine-database-link-cell {
      width: 100%;
      user-select: none;
      cursor: pointer;
    }

    affine-database-link-cell:hover .affine-database-link-icon {
      visibility: visible;
    }

    .affine-database-link {
      display: flex;
      position: relative;
      align-items: center;
      width: 100%;
      height: 100%;
      outline: none;
      overflow: hidden;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      word-break: break-all;
    }

    affine-database-link-node {
      flex: 1;
      word-break: break-all;
    }

    .affine-database-link-icon {
      position: absolute;
      right: 0;
      display: flex;
      align-items: center;
      visibility: hidden;
      cursor: pointer;
      background: var(--affine-background-primary-color);
      border-radius: 4px;
    }
    .affine-database-link-icon:hover {
      background: var(--affine-hover-color);
    }

    .affine-database-link-icon svg {
      width: 16px;
      height: 16px;
      fill: var(--affine-icon-color);
    }
  `;q5=Wv([W("affine-database-link-cell")],q5);let $p=class extends on{constructor(){super(...arguments),this._focusEnd=()=>{const t=this._container.value.length;this._container.focus(),this._container.setSelectionRange(t,t)},this._setValue=(t=this._container.value)=>{let e=t;To(t)&&(e=k3(t)),this.onChange(e),this._container.value=e},this._onKeydown=t=>{t.key==="Enter"&&!t.isComposing&&(this._setValue(),setTimeout(()=>{this.selectCurrentCell(!1)}))}}firstUpdated(){this._focusEnd()}onExitEditMode(){this._setValue()}render(){const t=this.value??"";return Be`<input
      class="affine-database-link-editing link"
      .value=${t}
      @keydown=${this._onKeydown}
      @pointerdown=${at}
    />`}};$p.styles=X`
    affine-database-link-cell-editing {
      width: 100%;
      cursor: text;
    }

    .affine-database-link-editing {
      display: flex;
      align-items: center;
      width: 100%;
      padding: 0;
      border: none;
      font-family: ${Je(vt.fontSansFamily)};
      color: var(--affine-text-primary-color);
      font-weight: 400;
      background-color: transparent;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      word-break: break-all;
    }

    .affine-database-link-editing:focus {
      outline: none;
    }
  `;Wv([he(".affine-database-link-editing")],$p.prototype,"_container",2);$p=Wv([W("affine-database-link-cell-editing")],$p);sr.register({type:Tv.type,icon:Mr("LinkIcon"),cellRenderer:{view:tn(q5),edit:tn($p)}});const Rue=Tv;var Nue=Object.defineProperty,Hue=Object.getOwnPropertyDescriptor,qv=(t,e,n,i)=>{for(var r=i>1?void 0:i?Hue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Nue(e,n,r),r};let Y5=class extends on{render(){return b` <div class="affine-database-number number">
      ${this.value??""}
    </div>`}};Y5.styles=X`
    affine-database-number-cell {
      display: block;
      width: 100%;
    }

    .affine-database-number {
      display: flex;
      align-items: center;
      width: 100%;
      padding: 0;
      border: none;
      font-family: ${Je(vt.fontSansFamily)};
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      color: var(--affine-text-primary-color);
      font-weight: 400;
      background-color: transparent;
    }
  `;Y5=qv([W("affine-database-number-cell")],Y5);let Bp=class extends on{constructor(){super(...arguments),this.focusEnd=()=>{const t=this._inputEle.value.length;this._inputEle.focus(),this._inputEle.setSelectionRange(t,t)},this._setValue=(t=this._inputEle.value)=>{if(!t){this.onChange(void 0);return}const e=Number.parseFloat(t);if(Object.is(e,NaN)){this._inputEle.value=`${this.value??""}`;return}this._inputEle.value=`${this.value??""}`,this.onChange(e)},this._keydown=t=>{t.key==="Enter"&&!t.isComposing&&requestAnimationFrame(()=>{this.selectCurrentCell(!1)})}}onExitEditMode(){this._setValue()}firstUpdated(){requestAnimationFrame(()=>{this.focusEnd()})}_blur(){this.selectCurrentCell(!1)}_focus(){this.isEditing||this.selectCurrentCell(!0)}render(){const t=`${this.value??""}`;return b`<input
      .value="${t}"
      @keydown="${this._keydown}"
      @blur="${this._blur}"
      @focus="${this._focus}"
      class="affine-database-number number"
      @pointerdown="${at}"
    />`}};Bp.styles=X`
    affine-database-number-cell-editing {
      display: block;
      width: 100%;
      cursor: text;
    }

    .affine-database-number {
      display: flex;
      align-items: center;
      width: 100%;
      padding: 0;
      border: none;
      font-family: ${Je(vt.fontSansFamily)};
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      color: var(--affine-text-primary-color);
      font-weight: 400;
      background-color: transparent;
    }

    .affine-database-number:focus {
      outline: none;
    }
  `;qv([he("input")],Bp.prototype,"_inputEle",2);Bp=qv([W("affine-database-number-cell-editing")],Bp);sr.register({type:F0.type,icon:Mr("DatabaseNumber"),cellRenderer:{view:tn(Y5),edit:tn(Bp)}});const Fue=F0;var Uue=Object.defineProperty,Vue=Object.getOwnPropertyDescriptor,v4=(t,e,n,i)=>{for(var r=i>1?void 0:i?Vue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Uue(e,n,r),r};const KA=X`
  affine-database-progress-cell-editing {
    display: block;
    width: 100%;
    padding: 0 4px;
  }

  affine-database-progress-cell {
    display: block;
    width: 100%;
    padding: 0 4px;
  }

  .affine-database-progress {
    display: flex;
    align-items: center;
    height: var(--data-view-cell-text-line-height);
    gap: 4px;
  }

  .affine-database-progress-bar {
    position: relative;
    width: 104px;
  }

  .affine-database-progress-bg {
    overflow: hidden;
    width: 100%;
    height: 10px;
    border-radius: 22px;
  }

  .affine-database-progress-fg {
    height: 100%;
  }

  .affine-database-progress-drag-handle {
    position: absolute;
    top: 0;
    left: 0;
    transform: translate(0px, -1px);
    width: 6px;
    height: 12px;
    border-radius: 2px;
    opacity: 1;
    cursor: ew-resize;
    background: var(--affine-primary-color);
    transition: opacity 0.2s ease-in-out;
  }

  .progress-number {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 18px;
    width: 25px;
    color: var(--affine-text-secondary-color);
    font-size: 14px;
  }
`,B1={empty:"var(--affine-black-10)",processing:"var(--affine-processing-color)",success:"var(--affine-success-color)"};let X5=class extends on{_bgClick(t){this.column.readonly||this.onChange(Math.round(t.offsetX*100/t.currentTarget.offsetWidth))}render(){const t=this.value??0;let e=B1.processing;t===100&&(e=B1.success);const n=we({width:`${t}%`,backgroundColor:e}),i=we({backgroundColor:t===0?B1.empty:"var(--affine-hover-color)"});return b` <div class="affine-database-progress">
      <div class="affine-database-progress-bar">
        <div
          class="affine-database-progress-bg"
          @click="${this._bgClick}"
          style=${i}
        >
          <div class="affine-database-progress-fg" style=${n}></div>
        </div>
      </div>
      <div class="progress-number progress">${t}</div>
    </div>`}};X5.styles=KA;X5=v4([W("affine-database-progress-cell")],X5);let Ad=class extends on{constructor(){super(...arguments),this.startDrag=t=>{const e=this._progressBg.getBoundingClientRect(),n=e.left,i=e.right,r=o=>{this.tempValue=Math.round((Math.min(i,Math.max(n,o))-n)/(i-n)*100)};zc(t,{onDrag:({x:o})=>{r(o)},onMove:({x:o})=>{r(o)},onDrop:()=>{},onClear:()=>{}})}}onExitEditMode(){this.onChange(this._value)}get _value(){return this.tempValue??this.value??0}_onChange(t){this.tempValue=t}firstUpdated(){const t=this._disposables;t.addFromEvent(this._progressBg,"pointerdown",this.startDrag),t.addFromEvent(window,"keydown",e=>{if(e.key==="ArrowDown"){this._onChange(Math.max(0,this._value-1));return}if(e.key==="ArrowUp"){this._onChange(Math.min(100,this._value+1));return}})}onCopy(t){t.preventDefault()}onPaste(t){t.preventDefault()}onCut(t){t.preventDefault()}render(){const t=this._value;let e=B1.processing;t===100&&(e=B1.success);const n=we({width:`${t}%`,backgroundColor:e}),i=we({backgroundColor:t===0?B1.empty:"var(--affine-hover-color)"}),r=we({left:`calc(${t}% - 3px)`});return b` <div class="affine-database-progress">
      <div class="affine-database-progress-bar">
        <div class="affine-database-progress-bg" style=${i}>
          <div class="affine-database-progress-fg" style=${n}></div>
          <div
            class="affine-database-progress-drag-handle"
            style=${r}
          ></div>
        </div>
      </div>
      <div class="progress-number progress">${t}</div>
    </div>`}};Ad.styles=KA;v4([ie()],Ad.prototype,"tempValue",2);v4([he(".affine-database-progress-bg")],Ad.prototype,"_progressBg",2);Ad=v4([W("affine-database-progress-cell-editing")],Ad);sr.register({type:r4.type,icon:Mr("DatabaseProgress"),cellRenderer:{view:tn(X5),edit:tn(Ad)}});const zue=r4;var jue=Object.defineProperty,Gue=Object.getOwnPropertyDescriptor,y4=(t,e,n,i)=>{for(var r=i>1?void 0:i?Gue(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&jue(e,n,r),r};function Qu(t,e){const n=t.getInlineRange();if(!n)return;const i=t.rootElement;if(!i)return;const r=t.getDeltasByInlineRange(n);let o={};for(const[a]of r){const l=a.attributes;l&&(o={...l})}const s=Object.fromEntries(Object.entries(e).map(([a,l])=>typeof l=="boolean"&&l===o[a]?[a,!l]:[a,l]));t.formatText(n,s,{mode:"merge"}),i.blur(),t.syncInlineRange()}let $d=class extends on{constructor(){super(...arguments),this._initYText=t=>{const e=new nt.Y.Text(t);this.onChange(e)}}get service(){return this.closest("affine-database")?.service}get inlineManager(){return D(this.service),this.service.inlineManager}get attributesSchema(){return this.inlineManager.getSchema()}get attributeRenderer(){return this.inlineManager.getRenderer()}get inlineEditor(){D(this._richTextElement);const t=this._richTextElement.inlineEditor;return D(t),t}get topContenteditableElement(){return this.closest("affine-database")?.topContenteditableElement}connectedCallback(){super.connectedCallback(),(!this.value||typeof this.value=="string")&&this._initYText(this.value)}render(){return this.service?Be`<rich-text
      .yText=${this.value}
      .inlineEventSource=${this.topContenteditableElement}
      .attributesSchema=${this.attributesSchema}
      .attributeRenderer=${this.attributeRenderer}
      .markdownShortcutHandler=${this.inlineManager.markdownShortcutHandler}
      .readonly=${!0}
      class="affine-database-rich-text inline-editor"
    ></rich-text>`:ae}};$d.styles=X`
    affine-database-rich-text-cell {
      display: flex;
      align-items: center;
      width: 100%;
      user-select: none;
    }

    .affine-database-rich-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
      width: 100%;
      height: 100%;
      outline: none;
      font-size: var(--data-view-cell-text-size);
      line-height: var(--data-view-cell-text-line-height);
      word-break: break-all;
    }

    .affine-database-rich-text v-line {
      display: flex !important;
      align-items: center;
      height: 100%;
      width: 100%;
    }

    .affine-database-rich-text v-line > div {
      flex-grow: 1;
    }
  `;y4([he("rich-text")],$d.prototype,"_richTextElement",2);$d=y4([W("affine-database-rich-text-cell")],$d);let Bd=class extends on{constructor(){super(...arguments),this._initYText=t=>{const e=new Oi(t);this.onChange(e)},this._handleKeyDown=t=>{if(t.key!=="Escape"){if(t.key==="Tab"){t.preventDefault();return}t.stopPropagation()}if(t.key==="Enter"&&!t.isComposing){t.shiftKey?this._onSoftEnter():this.selectCurrentCell(!1),t.preventDefault();return}const e=this.inlineEditor;switch(t.key){case"B":case"b":(t.metaKey||t.ctrlKey)&&(t.preventDefault(),Qu(this.inlineEditor,{bold:!0}));break;case"I":case"i":(t.metaKey||t.ctrlKey)&&(t.preventDefault(),Qu(this.inlineEditor,{italic:!0}));break;case"U":case"u":(t.metaKey||t.ctrlKey)&&(t.preventDefault(),Qu(this.inlineEditor,{underline:!0}));break;case"S":case"s":(t.metaKey||t.ctrlKey)&&t.shiftKey&&(t.preventDefault(),Qu(e,{strike:!0}));break;case"E":case"e":(t.metaKey||t.ctrlKey)&&t.shiftKey&&(t.preventDefault(),Qu(e,{code:!0}));break}},this._onSoftEnter=()=>{if(this.value&&this.inlineEditor){const t=this.inlineEditor.getInlineRange();D(t),this.column.captureSync(),new Oi(this.inlineEditor.yText).replace(t.index,length,`
`),this.inlineEditor.setInlineRange({index:t.index+1,length:0})}}}get service(){return this.closest("affine-database")?.service}get inlineManager(){return D(this.service),this.service.inlineManager}get attributesSchema(){return this.inlineManager.getSchema()}get attributeRenderer(){return this.inlineManager.getRenderer()}get inlineEditor(){D(this._richTextElement);const t=this._richTextElement.inlineEditor;return D(t),t}get topContenteditableElement(){const t=this.closest("affine-database");return D(t),t.topContenteditableElement}connectedCallback(){super.connectedCallback(),(!this.value||typeof this.value=="string")&&this._initYText(this.value)}firstUpdated(){this._richTextElement?.updateComplete.then(()=>{this.disposables.add(this.inlineEditor.slots.keydown.on(this._handleKeyDown)),this.inlineEditor.focusEnd()}).catch(console.error)}render(){return this.service?Be`<rich-text
      .yText=${this.value}
      .inlineEventSource=${this.topContenteditableElement}
      .attributesSchema=${this.attributesSchema}
      .attributeRenderer=${this.attributeRenderer}
      .markdownShortcutHandler=${this.inlineManager.markdownShortcutHandler}
      class="affine-database-rich-text inline-editor"
    ></rich-text>`:ae}};Bd.styles=X`
    affine-database-rich-text-cell-editing {
      display: flex;
      align-items: center;
      width: 100%;
      min-width: 1px;
      cursor: text;
    }

    .affine-database-rich-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
      width: 100%;
      height: 100%;
      outline: none;
    }

    .affine-database-rich-text v-line {
      display: flex !important;
      align-items: center;
      height: 100%;
      width: 100%;
    }

    .affine-database-rich-text v-line > div {
      flex-grow: 1;
    }
  `;y4([he("rich-text")],Bd.prototype,"_richTextElement",2);Bd=y4([W("affine-database-rich-text-cell-editing")],Bd);sr.register({type:n4,icon:Mr("TextIcon"),cellRenderer:{view:tn($d),edit:tn(Bd)}});const Zue=i4;var Wue=Object.defineProperty,que=Object.getOwnPropertyDescriptor,QA=(t,e,n,i)=>{for(var r=i>1?void 0:i?que(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Wue(e,n,r),r};let om=class extends on{render(){const t=this.value?[this.value]:[];return Be`
      <affine-multi-tag-view
        .value="${t}"
        .options="${this.column.data.options}"
      ></affine-multi-tag-view>
    `}};om=QA([W("affine-database-select-cell")],om);let sm=class extends on{constructor(){super(...arguments),this._onChange=([t])=>{this.onChange(t)},this._editComplete=()=>{this.selectCurrentCell(!1)},this._onOptionsChange=t=>{this.column.updateData(e=>({...e,options:t}))},this.popTagSelect=()=>{this._disposables.add({dispose:Z3(this.querySelector("affine-multi-tag-view")??this,{mode:"single",options:this._options,onOptionsChange:this._onOptionsChange,value:this._value,onChange:this._onChange,onComplete:this._editComplete,minWidth:400})})}}get _options(){return this.column.data.options}get _value(){const t=this.value;return t?[t]:[]}firstUpdated(){this.popTagSelect()}render(){return Be`
      <affine-multi-tag-view
        .value="${this._value}"
        .options="${this._options}"
      ></affine-multi-tag-view>
    `}};sm=QA([W("affine-database-select-cell-editing")],sm);sr.register({type:fu.type,icon:Mr("DatabaseSelect"),cellRenderer:{view:tn(om),edit:tn(sm)}});const Yue=fu,JA="title",TC=Gt.register(JA,{name:"Title",type:()=>kv.create(),defaultData:()=>({}),cellToString:t=>t?.toString()??"",cellFromString:t=>({value:t}),cellToJson:t=>t?.toString()??null});sr.register({type:JA,icon:Mr("TitleIcon"),cellRenderer:{view:tn($d),edit:tn(Bd)}});class Xue{constructor(){this.columnConfigManager=Gt}cellChangeRenderValue(e,n,i){this.cellChangeValue(e,n,i)}cellGetRenderValue(e,n){return this.cellGetValue(e,n)}cellGetExtra(e,n){}propertyGetReadonly(e){return!1}propertyGetDefaultWidth(e){return W1e}onCellUpdate(e,n,i){return{dispose:()=>{}}}captureSync(){}get detailSlots(){return{}}}const Kue=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.29999 7.5C4.85227 7.5 5.29999 7.05228 5.29999 6.5C5.29999 5.94772 4.85227 5.5 4.29999 5.5C3.7477 5.5 3.29999 5.94772 3.29999 6.5C3.29999 7.05228 3.7477 7.5 4.29999 7.5ZM8.33335 5.75073C7.91914 5.75071 7.58334 6.08648 7.58331 6.50069C7.58329 6.9149 7.91906 7.25071 8.33327 7.25073L20.2499 7.2514C20.6641 7.25142 20.9999 6.91565 21 6.50144C21 6.08722 20.6642 5.75142 20.25 5.7514L8.33335 5.75073ZM8.33336 11.2508C7.91914 11.2508 7.58334 11.5865 7.58331 12.0007C7.58329 12.415 7.91905 12.7508 8.33327 12.7508L20.25 12.7515C20.6642 12.7515 21 12.4158 21 12.0015C21 11.5873 20.6643 11.2515 20.2501 11.2515L8.33336 11.2508ZM8.33336 16.7508C7.91914 16.7508 7.58334 17.0865 7.58331 17.5007C7.58329 17.915 7.91905 18.2508 8.33327 18.2508L20.25 18.2515C20.6642 18.2515 21 17.9158 21 17.5016C21 17.0873 20.6643 16.7515 20.25 16.7515L8.33336 16.7508ZM5.29999 12C5.29999 12.5523 4.85227 13 4.29999 13C3.7477 13 3.29999 12.5523 3.29999 12C3.29999 11.4477 3.7477 11 4.29999 11C4.85227 11 5.29999 11.4477 5.29999 12ZM4.29999 18.5C4.85227 18.5 5.29999 18.0523 5.29999 17.5C5.29999 16.9477 4.85227 16.5 4.29999 16.5C3.7477 16.5 3.29999 16.9477 3.29999 17.5C3.29999 18.0523 3.7477 18.5 4.29999 18.5Z"
    fill="currentColor"
  />
</svg> `,Que=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.1287 5.76205C4.18101 5.74447 4.22813 5.71723 4.27846 5.68228L4.53386 5.50534V7.63997C4.53386 7.82761 4.59717 7.9904 4.71548 8.10631C4.83355 8.222 4.99776 8.28258 5.18421 8.28258C5.37066 8.28258 5.53488 8.222 5.65295 8.10631C5.77126 7.9904 5.83457 7.82761 5.83457 7.63997V4.93384C5.83457 4.72505 5.76932 4.54353 5.6384 4.41417C5.50756 4.2849 5.32242 4.21887 5.10409 4.21887C4.88258 4.21887 4.6705 4.24086 4.42948 4.40154L3.75168 4.85427C3.57975 4.97094 3.5 5.12628 3.5 5.31379C3.5 5.58698 3.70304 5.7858 3.96426 5.7858C4.02312 5.7858 4.07561 5.7799 4.1287 5.76205ZM9.40567 5.6015C8.98147 5.60148 8.63757 5.94534 8.63755 6.36953C8.63752 6.79373 8.98138 7.13762 9.40557 7.13765L19.7319 7.13827C20.1561 7.1383 20.5 6.79444 20.5 6.37024C20.5 5.94605 20.1562 5.60215 19.732 5.60213L9.40567 5.6015ZM9.40567 11.234C8.98147 11.234 8.63757 11.5779 8.63755 12.0021C8.63752 12.4263 8.98138 12.7702 9.40557 12.7702L19.7319 12.7708C20.1561 12.7708 20.5 12.427 20.5 12.0028C20.5 11.5786 20.1562 11.2347 19.732 11.2347L9.40567 11.234ZM9.40567 16.8666C8.98147 16.8666 8.63757 17.2104 8.63755 17.6346C8.63752 18.0588 8.98138 18.4027 9.40557 18.4027L19.7319 18.4033C20.1561 18.4034 20.5 18.0595 20.5 17.6353C20.5 17.2111 20.1562 16.8672 19.732 16.8672L9.40567 16.8666ZM6.62426 11.114C6.63609 11.048 6.6419 10.9782 6.6419 10.9031C6.6419 10.2259 6.06294 9.7684 5.15573 9.7684C4.5044 9.7684 3.97971 10.045 3.78328 10.4895C3.77042 10.5192 3.76022 10.5492 3.75251 10.5798C3.76022 10.5492 3.77044 10.5191 3.78331 10.4894C3.97974 10.0449 4.50442 9.7683 5.15575 9.7683C6.06297 9.7683 6.64193 10.2258 6.64193 10.903C6.64193 10.9782 6.6361 11.048 6.62426 11.114ZM5.12474 12.7537L5.12471 12.7537V12.7744H6.30848C6.58246 12.7744 6.73753 12.9372 6.73753 13.1879C6.73753 13.2197 6.73493 13.2502 6.72981 13.2792C6.73495 13.2502 6.73756 13.2196 6.73756 13.1878C6.73756 12.9371 6.58248 12.7743 6.30851 12.7743H5.12474V12.7537ZM3.73998 12.9913C3.77464 12.8518 3.86616 12.7304 4.02368 12.5985L5.04978 11.7197C5.38832 11.4292 5.53086 11.2672 5.57304 11.0983C5.5309 11.2672 5.38836 11.4293 5.04976 11.7198L4.02365 12.5986C3.86617 12.7305 3.77466 12.8519 3.73998 12.9913ZM4.50342 11.1816C4.59839 11.1252 4.67754 11.0396 4.75422 10.9274C4.81979 10.8327 4.87897 10.7719 4.93846 10.7343C4.99601 10.6979 5.05933 10.6797 5.14025 10.6797C5.25266 10.6797 5.33878 10.7139 5.39544 10.7645C5.45119 10.8143 5.48498 10.8855 5.48498 10.9753C5.48498 11.1448 5.40603 11.2791 4.9831 11.642L3.95747 12.5204C3.73832 12.704 3.62145 12.8851 3.62145 13.1283C3.62145 13.2841 3.66578 13.4314 3.77329 13.5397C3.88112 13.6484 4.03847 13.7037 4.23562 13.7037H6.30851C6.46671 13.7037 6.60202 13.6548 6.69803 13.5592C6.79392 13.4637 6.83997 13.3323 6.83997 13.1878C6.83997 13.0412 6.79418 12.9093 6.6977 12.8141C6.60129 12.719 6.46582 12.6718 6.30851 12.6718H5.37617L5.87155 12.2443C6.15942 11.9949 6.3783 11.7967 6.52349 11.5947C6.67287 11.3868 6.74434 11.1753 6.74434 10.903C6.74434 10.5321 6.58449 10.2187 6.30157 10.0006C6.02097 9.78425 5.62548 9.66589 5.15575 9.66589C4.48013 9.66589 3.90785 9.95417 3.68934 10.4487C3.64978 10.54 3.63179 10.6341 3.63179 10.7324C3.63179 10.8869 3.68238 11.0223 3.78385 11.1187C3.8847 11.2145 4.02467 11.2613 4.18393 11.2613C4.30216 11.2613 4.40667 11.2391 4.50342 11.1816ZM3.67138 16.0785C3.82347 15.664 4.34013 15.2247 5.22801 15.2247C5.68517 15.2247 6.09277 15.3214 6.38781 15.5143C6.68486 15.7085 6.86644 15.9999 6.86644 16.3799C6.86644 16.8627 6.55828 17.1838 6.17395 17.3212C6.40817 17.3704 6.60427 17.4641 6.75036 17.5998C6.93436 17.7707 7.035 18.0045 7.035 18.2873C7.035 18.6915 6.86059 19.0236 6.54548 19.2529C6.23205 19.4811 5.78277 19.6055 5.23363 19.6055C4.27385 19.6055 3.73928 19.1473 3.59258 18.7372C3.56511 18.6608 3.55307 18.5763 3.55307 18.5092C3.55307 18.3499 3.60652 18.216 3.70785 18.1223C3.80872 18.0289 3.95152 17.9805 4.12117 17.9805C4.23774 17.9805 4.33814 17.9997 4.42613 18.0439C4.51436 18.0882 4.58653 18.1558 4.64935 18.247C4.72378 18.3559 4.79404 18.4374 4.8851 18.4925C4.97546 18.5471 5.09131 18.5788 5.26173 18.5788C5.53989 18.5788 5.7218 18.414 5.7218 18.2002C5.7218 18.0706 5.67315 17.9761 5.58111 17.9118C5.48617 17.8455 5.33953 17.8076 5.13812 17.8076H5.11003C4.96167 17.8076 4.84264 17.7662 4.76061 17.6859C4.67849 17.6054 4.64024 17.4925 4.64024 17.3631C4.64024 17.2388 4.6788 17.1269 4.76042 17.0461C4.84209 16.9653 4.96094 16.9214 5.11003 16.9214H5.13812C5.3156 16.9214 5.449 16.8827 5.53665 16.8186C5.62237 16.7559 5.66843 16.6661 5.66843 16.5512C5.66843 16.4399 5.62767 16.3529 5.5564 16.293C5.48412 16.2322 5.37547 16.1951 5.23363 16.1951C5.1199 16.1951 5.02579 16.2182 4.94752 16.2628C4.86935 16.3074 4.80383 16.3753 4.74999 16.4698C4.68013 16.5935 4.60457 16.683 4.50858 16.7408C4.41232 16.7988 4.30106 16.8216 4.16612 16.8216C3.99313 16.8216 3.85731 16.7706 3.76471 16.6781C3.67224 16.5856 3.62892 16.4576 3.62892 16.3153C3.62892 16.2303 3.64147 16.1623 3.67138 16.0785Z"
    fill="currentColor"
  />
</svg> `,Jue=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H18C18.6904 4.75 19.25 5.30964 19.25 6V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6ZM16.5303 9.53033C16.8232 9.23744 16.8232 8.76256 16.5303 8.46967C16.2374 8.17678 15.7626 8.17678 15.4697 8.46967L10.5 13.4393L9.03033 11.9697C8.73744 11.6768 8.26256 11.6768 7.96967 11.9697C7.67678 12.2626 7.67678 12.7374 7.96967 13.0303L9.96967 15.0303C10.2626 15.3232 10.7374 15.3232 11.0303 15.0303L16.5303 9.53033Z"
    fill="currentColor"
  />
</svg> `,ehe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M6 3.25C4.48122 3.25 3.25 4.48122 3.25 6V18C3.25 19.5188 4.48122 20.75 6 20.75H18C19.5188 20.75 20.75 19.5188 20.75 18V6C20.75 4.48122 19.5188 3.25 18 3.25H6ZM4.75 6C4.75 5.30964 5.30964 4.75 6 4.75H18C18.6904 4.75 19.25 5.30964 19.25 6V18C19.25 18.6904 18.6904 19.25 18 19.25H6C5.30964 19.25 4.75 18.6904 4.75 18V6ZM16.5303 9.53033C16.8232 9.23744 16.8232 8.76256 16.5303 8.46967C16.2374 8.17678 15.7626 8.17678 15.4697 8.46967L10.5 13.4393L9.03033 11.9697C8.73744 11.6768 8.26256 11.6768 7.96967 11.9697C7.67678 12.2626 7.67678 12.7374 7.96967 13.0303L9.96967 15.0303C10.2626 15.3232 10.7374 15.3232 11.0303 15.0303L16.5303 9.53033Z"
    fill="currentColor"
  />
</svg> `,the=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.25 4C3.25 3.58579 3.58579 3.25 4 3.25H20C20.4142 3.25 20.75 3.58579 20.75 4V6.66667C20.75 7.08088 20.4142 7.41667 20 7.41667C19.5858 7.41667 19.25 7.08088 19.25 6.66667V4.75H12.75V19.25H16C16.4142 19.25 16.75 19.5858 16.75 20C16.75 20.4142 16.4142 20.75 16 20.75H8C7.58579 20.75 7.25 20.4142 7.25 20C7.25 19.5858 7.58579 19.25 8 19.25H11.25V4.75H4.75V6.66667C4.75 7.08088 4.41421 7.41667 4 7.41667C3.58579 7.41667 3.25 7.08088 3.25 6.66667V4Z"
    fill="currentColor"
  />
</svg> `,nhe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M5 10.9655V11.0953V15.0608C5 15.6262 5.45838 16.0846 6.02382 16.0846H10.119C10.6845 16.0846 11.1429 15.6262 11.1429 15.0608V10.9655C11.1429 10.4001 10.6845 9.9417 10.119 9.9417H6.70422C7.17415 8.66255 8.40313 7.75 9.84524 7.75V6.25C7.24961 6.25 5.13069 8.29105 5.00582 10.8557C5.00197 10.8918 5 10.9284 5 10.9655ZM13 10.9655V11.0953V15.0608C13 15.6262 13.4584 16.0846 14.0238 16.0846H18.119C18.6845 16.0846 19.1429 15.6262 19.1429 15.0608V10.9655C19.1429 10.4001 18.6845 9.9417 18.119 9.9417H14.7042C15.1741 8.66255 16.4031 7.75 17.8452 7.75V6.25C15.2496 6.25 13.1307 8.29105 13.0058 10.8557C13.002 10.8918 13 10.9284 13 10.9655Z"
    fill="currentColor"
  />
</svg> `,ihe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.9256 6.5784V17.4764C17.9256 18.078 18.2564 18.4389 18.7878 18.4389C19.3292 18.4389 19.65 18.088 19.65 17.4764V5.72621C19.65 5.04445 19.1988 4.57324 18.5572 4.57324C18.1662 4.57324 17.8153 4.72363 17.1836 5.19484L15.1584 6.69871C14.7574 6.98946 14.5669 7.26016 14.5669 7.55091C14.5669 7.93189 14.8677 8.24269 15.2386 8.24269C15.4592 8.24269 15.6697 8.16248 15.9605 7.95194L17.8453 6.5784H17.9256ZM4.41998 4.90259C4.84523 4.90259 5.18996 5.24732 5.18996 5.67257V11.0239H11.3584V5.67257C11.3584 5.24732 11.7031 4.90259 12.1284 4.90259C12.5536 4.90259 12.8983 5.24732 12.8983 5.67257V11.7939V17.9153C12.8983 18.3405 12.5536 18.6853 12.1284 18.6853C11.7031 18.6853 11.3584 18.3405 11.3584 17.9153V12.5639H5.18996V17.9153C5.18996 18.3405 4.84523 18.6853 4.41998 18.6853C3.99473 18.6853 3.64999 18.3405 3.64999 17.9153V5.67257C3.64999 5.24732 3.99473 4.90259 4.41998 4.90259Z"
    fill="currentColor"
  />
</svg> `,rhe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M14.1588 15.9996C13.5966 16.6381 13.4346 16.9049 13.4346 17.2479C13.4346 17.8006 13.873 18.1342 14.5686 18.1342H20.8578C21.3819 18.1342 21.6869 17.8578 21.6869 17.4099C21.6869 16.9525 21.3629 16.6762 20.8578 16.6762H15.5691V16.5618L19.0949 12.531C20.8102 10.5775 21.2962 9.67223 21.2962 8.43344C21.2962 6.33702 19.6476 4.85046 17.3035 4.85046C14.7878 4.85046 13.2154 6.54666 13.2154 8.16662C13.2154 8.6812 13.5204 9.03378 13.9873 9.03378C14.378 9.03378 14.6448 8.77649 14.7782 8.27144C15.0641 7.03265 15.9694 6.2989 17.1986 6.2989C18.6471 6.2989 19.6095 7.19464 19.6095 8.53826C19.6095 9.434 19.1998 10.2345 18.123 11.4637L14.1588 15.9996ZM3.41871 5.36361C3.82289 5.36361 4.15055 5.69127 4.15055 6.09545V11.1818H10.0134V6.09545C10.0134 5.69127 10.341 5.36361 10.7452 5.36361C11.1494 5.36361 11.4771 5.69127 11.4771 6.09545V11.9136V17.7317C11.4771 18.1359 11.1494 18.4636 10.7452 18.4636C10.341 18.4636 10.0134 18.1359 10.0134 17.7317V12.6454H4.15055V17.7317C4.15055 18.1359 3.82289 18.4636 3.41871 18.4636C3.01452 18.4636 2.68687 18.1359 2.68687 17.7317V6.09545C2.68687 5.69127 3.01452 5.36361 3.41871 5.36361Z"
    fill="currentColor"
  />
</svg> `,ohe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.04957 5.85587C4.04957 5.44177 3.71388 5.10608 3.29979 5.10608C2.88569 5.10608 2.55 5.44177 2.55 5.85587V17.7775C2.55 18.1916 2.88569 18.5273 3.29979 18.5273C3.71388 18.5273 4.04957 18.1916 4.04957 17.7775V12.5665H10.0562V17.7775C10.0562 18.1916 10.3919 18.5273 10.806 18.5273C11.2201 18.5273 11.5558 18.1916 11.5558 17.7775V11.8167V5.85587C11.5558 5.44177 11.2201 5.10608 10.806 5.10608C10.3919 5.10608 10.0562 5.44177 10.0562 5.85587V11.0669H4.04957V5.85587ZM13.5289 15.0901C13.1108 15.0901 12.8162 15.3942 12.8162 15.8218C12.8162 17.2759 14.6124 18.7585 17.0643 18.7585C19.7063 18.7585 21.55 17.1999 21.55 14.976C21.55 13.3414 20.324 11.9349 18.7179 11.7543V11.6592C20.0389 11.4312 21.1128 10.0626 21.1128 8.62759C21.1128 6.65084 19.4212 5.2348 17.0453 5.2348C14.7074 5.2348 13.1203 6.66034 13.1203 8.1334C13.1203 8.60859 13.4054 8.92221 13.8426 8.92221C14.2132 8.92221 14.4508 8.72263 14.6409 8.19993C15.021 7.22106 15.8763 6.66034 17.0073 6.66034C18.4613 6.66034 19.4402 7.53468 19.4402 8.83667C19.4402 10.1387 18.4328 11.0795 17.0453 11.0795H15.9239C15.4677 11.0795 15.1636 11.3741 15.1636 11.7923C15.1636 12.201 15.4867 12.5146 15.9239 12.5146H17.1118C18.7654 12.5146 19.8774 13.4934 19.8774 14.9475C19.8774 16.4016 18.7939 17.3329 17.0928 17.3329C15.8003 17.3329 14.8119 16.7627 14.3177 15.7458C14.0707 15.2611 13.8616 15.0901 13.5289 15.0901Z"
    fill="currentColor"
  />
</svg> `,she=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M18.7933 15.7548V17.6864C18.7933 18.2383 19.0787 18.5523 19.583 18.5523C20.0968 18.5523 20.3823 18.2383 20.3823 17.6864V15.7548H21.3719C21.9143 15.7548 22.2188 15.4884 22.2188 15.0317C22.2188 14.5654 21.9047 14.299 21.3719 14.299H20.3823V6.69626C20.3823 5.81134 19.897 5.31654 19.0311 5.31654C18.3746 5.31654 17.9369 5.602 17.3755 6.42983C15.2155 9.66503 14.3591 11.0352 12.9984 13.4426C12.6654 14.0516 12.5512 14.3846 12.5512 14.7367C12.5512 15.3647 13.046 15.7548 13.7882 15.7548H18.7933ZM18.7933 14.299H14.1498V14.2038C15.3963 12.0439 17.09 9.32248 18.7076 6.93414H18.7933V14.299ZM2.94953 5.70536C3.35312 5.70536 3.6803 6.03254 3.6803 6.43613V11.515H9.53462V6.43613C9.53462 6.03254 9.86179 5.70536 10.2654 5.70536C10.669 5.70536 10.9962 6.03254 10.9962 6.43613V12.2458V18.0555C10.9962 18.459 10.669 18.7862 10.2654 18.7862C9.86179 18.7862 9.53462 18.459 9.53462 18.0555V12.9766H3.6803V18.0555C3.6803 18.459 3.35312 18.7862 2.94953 18.7862C2.54593 18.7862 2.21875 18.459 2.21875 18.0555V6.43613C2.21875 6.03254 2.54593 5.70536 2.94953 5.70536Z"
    fill="currentColor"
  />
</svg> `,ahe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M13.6153 15.0526C13.2062 15.0526 12.9366 15.3687 12.9366 15.8335C12.9366 17.135 14.4705 18.6316 16.9246 18.6316C19.5182 18.6316 21.3682 16.8096 21.3682 14.2439C21.3682 11.8362 19.7042 10.1443 17.343 10.1443C16.2739 10.1443 15.1863 10.5905 14.768 11.2134H14.675L15.0283 7.0766H20.0388C20.5873 7.0766 20.8941 6.8256 20.8941 6.37939C20.8941 5.92388 20.578 5.6543 20.0388 5.6543H14.8237C14.0243 5.6543 13.6246 5.97966 13.5688 6.66757L13.1598 11.8734C13.1133 12.5892 13.3829 13.0075 13.9127 13.0075C14.2102 13.0075 14.3961 12.8959 15.0747 12.2638C15.6139 11.7804 16.2553 11.5387 16.9804 11.5387C18.5886 11.5387 19.7321 12.6914 19.7321 14.3275C19.7321 16.038 18.5515 17.2279 16.8596 17.2279C15.7441 17.2279 14.8888 16.6887 14.3775 15.6941C14.1358 15.22 13.9313 15.0526 13.6153 15.0526ZM3.08209 5.90389C3.47639 5.90389 3.79603 6.22353 3.79603 6.61783V11.5797H9.51545V6.61783C9.51545 6.22353 9.83509 5.90389 10.2294 5.90389C10.6237 5.90389 10.9433 6.22353 10.9433 6.61783V12.2936V17.9695C10.9433 18.3638 10.6237 18.6834 10.2294 18.6834C9.83509 18.6834 9.51545 18.3638 9.51545 17.9695V13.0076H3.79603V17.9695C3.79603 18.3638 3.47639 18.6834 3.08209 18.6834C2.6878 18.6834 2.36816 18.3638 2.36816 17.9695V6.61783C2.36816 6.22353 2.6878 5.90389 3.08209 5.90389Z"
    fill="currentColor"
  />
</svg> `,lhe=b`<svg
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M17.6502 5.51672C14.5518 5.51672 12.8253 8.00853 12.8253 12.4975C12.8253 14.4294 13.1426 15.8759 13.7865 16.9025C14.5518 18.1064 15.8117 18.7597 17.3889 18.7597C19.9834 18.7597 21.7379 17.0145 21.7379 14.448C21.7379 12.0122 20.0767 10.3043 17.7062 10.3043C16.2503 10.3043 14.9158 11.107 14.4865 12.2455H14.4118C14.4398 8.75514 15.5411 6.92595 17.6222 6.92595C18.4528 6.92595 19.1528 7.22459 19.8247 7.8872C20.1607 8.21385 20.3567 8.3165 20.618 8.3165C21.0193 8.3165 21.3086 8.01786 21.3086 7.61656C21.3086 7.18726 20.9353 6.67397 20.3193 6.27266C19.6101 5.78737 18.6488 5.51672 17.6502 5.51672ZM17.4542 17.3598C15.8024 17.3598 14.6451 16.1746 14.6451 14.504C14.6451 12.8521 15.7744 11.6949 17.3889 11.6949C19.0501 11.6949 20.1327 12.8148 20.1327 14.5134C20.1327 16.2306 19.0594 17.3598 17.4542 17.3598ZM3.45463 5.99129C3.85047 5.99129 4.17137 6.31218 4.17137 6.70803V11.6894H9.91326V6.70803C9.91326 6.31218 10.2342 5.99129 10.63 5.99129C11.0259 5.99129 11.3467 6.31218 11.3467 6.70803V12.4061V18.1043C11.3467 18.5001 11.0259 18.821 10.63 18.821C10.2342 18.821 9.91326 18.5001 9.91326 18.1043V13.1229H4.17137V18.1043C4.17137 18.5001 3.85047 18.821 3.45463 18.821C3.05878 18.821 2.73788 18.5001 2.73788 18.1043V6.70803C2.73788 6.31218 3.05878 5.99129 3.45463 5.99129Z"
    fill="currentColor"
  />
</svg> `,che=t=>{if(t.flavour==="affine:paragraph"){const e=t.type;return{text:the,quote:nhe,h1:ihe,h2:rhe,h3:ohe,h4:she,h5:ahe,h6:lhe}[e]}return t.flavour==="affine:list"?{bulleted:Kue,numbered:Que,todo:Jue,toggle:ehe}[t.type??"bulleted"]??b``:b``};var dhe=Object.defineProperty,uhe=Object.getOwnPropertyDescriptor,Yv=(t,e,n,i)=>{for(var r=i>1?void 0:i?uhe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&dhe(e,n,r),r};let Dd=class extends me(De){get model(){return this.root?.page.getBlockById(this.rowId)}get topContenteditableElement(){const t=this.closest("affine-database");return D(t),t.topContenteditableElement}connectedCallback(){super.connectedCallback(),this.root=this.closest("editor-host")??void 0,this._disposables.addFromEvent(this.topContenteditableElement??this,"keydown",t=>{if(t.key==="Enter"&&!t.shiftKey&&!t.isComposing){t.stopPropagation(),t.preventDefault();return}if(t.key==="Backspace"&&!t.shiftKey&&!t.metaKey&&this.model?.text?.length===0){t.stopPropagation(),t.preventDefault();return}},!0)}renderIcon(){const t=this.view.header.iconColumn;if(t)return b` <div class="database-block-detail-header-icon">
      ${this.view.cellGetValue(this.rowId,t)}
    </div>`}render(){const t=this.model;if(t)return b` ${this.root?.renderModel(t)} ${this.renderIcon()} `}};Dd.styles=X`
    database-datasource-block-renderer {
      padding-bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 4px;
      border-bottom: 1px solid var(--affine-border-color);
      font-size: var(--affine-font-base);
      line-height: var(--affine-line-height);
    }

    database-datasource-block-renderer .tips-placeholder {
      display: none;
    }

    .database-block-detail-header-icon {
      width: 20px;
      height: 20px;
      padding: 2px;
      border-radius: 4px;
      background-color: var(--affine-background-secondary-color);
    }

    .database-block-detail-header-icon svg {
      width: 16px;
      height: 16px;
    }
  `;Yv([L({attribute:!1})],Dd.prototype,"view",2);Yv([L({attribute:!1})],Dd.prototype,"rowId",2);Dd=Yv([W("database-datasource-block-renderer")],Dd);class hhe extends Xue{constructor(e,n){super(),this.host=e,this._batch=0,this.slots={update:new Ve},this._model=e.page.workspace.getPage(n.pageId)?.getBlockById(n.blockId),this._model.childrenUpdated.pipe(this.slots.update)}get page(){return this._model.page}get rows(){return this._model.children.map(e=>e.id)}get properties(){return[...this._model.columns.map(e=>e.id)]}_runCapture(){this._batch||(this._batch=requestAnimationFrame(()=>{this.page.captureSync(),this._batch=0}))}cellChangeValue(e,n,i){this._runCapture();const r=this.propertyGetType(n);if(r==="title"&&typeof i=="string"){const o=this.getModelById(e)?.text;o&&o.replace(0,o.length,i),this.slots.update.emit();return}else if(r==="rich-text"&&typeof i=="string"){const s=this._model.getCell(e,n)?.value;if(s){const a=new Oi(s);a.replace(0,a.length,i)}return}this._model.columns.find(o=>o.id===n)&&(this._model.updateCell(e,{columnId:n,value:i}),this._model.applyColumnUpdate())}cellGetValue(e,n){if(n==="type"){const r=this.getModelById(e);return r?che(r):void 0}if(this.propertyGetType(n)==="title"){const r=this.getModelById(e);return r?r.text?.yText:void 0}return this._model.getCell(e,n)?.value}cellGetExtra(e,n){if(this.propertyGetType(n)==="title"){const i=this.getModelById(e);if(i)return{result:this.host.renderModel(i),model:i}}return super.cellGetExtra(e,n)}getModelById(e){return this._model.children[this._model.childMap.get(e)??-1]}cellGetRenderValue(e,n){return this.cellGetValue(e,n)}newColumnName(){let e=1;for(;this._model.columns.find(n=>n.name===`Column ${e}`);)e++;return`Column ${e}`}propertyAdd(e,n){return this.page.captureSync(),this._model.addColumn(e,Gt.getColumn(n??hl.type).create(this.newColumnName()))}propertyChangeData(e,n){this._runCapture(),this._model.updateColumn(e,()=>({data:n})),this._model.applyColumnUpdate()}propertyChangeName(e,n){this.page.captureSync(),this._model.updateColumn(e,()=>({name:n})),this._model.applyColumnUpdate()}propertyChangeType(e,n){const i=this.propertyGetType(e),r=this.propertyGetData(e),o=this.rows,s=o.map(c=>this.cellGetValue(c,e)),a=Gt.getColumn(i)?.convertCell(n,r,s)??{column:Gt.getColumn(n).defaultData(),cells:s.map(()=>{})};this.page.captureSync(),this._model.updateColumn(e,()=>({type:n,data:a.column}));const l={};s.forEach((c,d)=>{(c!=null||a.cells[d]!=null)&&(l[o[d]]=a.cells[d])}),this._model.updateCells(e,l),this._model.applyColumnUpdate()}propertyDelete(e){this.page.captureSync();const n=this._model.findColumnIndex(e);n<0||(this.page.transact(()=>{this._model.columns.splice(n,1)}),this._model.applyColumnUpdate())}propertyGetData(e){return this._model.columns.find(n=>n.id===e)?.data??{}}propertyGetReadonly(e){return e==="type"}propertyGetName(e){return e==="type"?"Block Type":this._model.columns.find(n=>n.id===e)?.name??""}propertyGetType(e){return e==="type"?"image":this._model.columns.find(n=>n.id===e)?.type??""}propertyDuplicate(e){this.page.captureSync();const n=this._model.getColumn(e);D(n);const{id:i,...r}=n,o={...r},s=this._model.addColumn({before:!1,id:e},o);return this._model.copyCellsByColumn(i,s),this._model.applyColumnUpdate(),s}rowAdd(e){this.page.captureSync();const n=typeof e=="number"?e:Qr(e,this._model.children);return this.page.addBlock("affine:paragraph",{},this._model.id,n)}rowDelete(e){this.page.captureSync(),this.page.updateBlock(this._model,{children:this._model.children.filter(n=>!e.includes(n.id))})}captureSync(){this.page.captureSync()}propertyGetDefaultWidth(e){return this.propertyGetType(e)==="title"?260:super.propertyGetDefaultWidth(e)}onCellUpdate(e,n,i){return this.propertyGetType(n)==="title"?(this.getModelById(e)?.text?.yText.observe(i),{dispose:()=>{this.getModelById(e)?.text?.yText.unobserve(i)}}):this._model.propsUpdated.on(i)}get allPropertyConfig(){return[Lue,Fue,zue,Yue,tA,Zue,Rue,vue]}get detailSlots(){return{...super.detailSlots,header:Zt(Dd)}}rowMove(e,n){const i=this.page.getBlockById(e);if(i){const r=Qr(n,this._model.children),o=this._model.children[r];this.page.moveBlocks([i],this._model,o)}}}class e$ extends Bn{getViewList(){return this.views}initEmpty(e){this.addColumn("start",TC.create(TC.name)),this.addView(e)}initConvert(e){this.addColumn("end",hl.create("Tag",{options:[]})),this.initEmpty(e)}initTemplate(e){const n=[Oe(),Oe(),Oe()],i=this.addColumn("end",fu.create("Status",{options:[{id:n[0],color:Wr(),value:"TODO"},{id:n[1],color:Wr(),value:"In Progress"},{id:n[2],color:Wr(),value:"Done"}]}));for(let r=0;r<4;r++){const o=this.page.addBlock("affine:paragraph",{text:new this.page.Text(`Task ${r+1}`)},this.id);this.updateCell(o,{columnId:i,value:n[r]})}this.initEmpty(e)}addView(e){const n=this.page.generateBlockId(),i=_p.getView(e),r=i.init(this,n,i.defaultName);return this.page.transact(()=>{this.views.push(r)}),r}duplicateView(e){const n=this.page.generateBlockId();return this.page.transact(()=>{const i=this.views.findIndex(o=>o.id===e),r=this.views[i];r&&this.views.splice(i+1,0,JSON.parse(JSON.stringify({...r,id:n})))}),n}deleteView(e){this.page.captureSync(),this.page.transact(()=>{this.views=this.views.filter(n=>n.id!==e)})}updateView(e,n){this.page.transact(()=>{this.views=this.views.map(i=>i.id!==e?i:{...i,...n(i)})}),this.applyViewsUpdate()}moveViewTo(e,n){this.page.transact(()=>{this.views=e1e(this.views,i=>i.id===e,i=>Qr(n,i))}),this.applyViewsUpdate()}applyViewsUpdate(){this.page.updateBlock(this,{views:this.views})}applyColumnUpdate(){this.page.updateBlock(this,{columns:this.columns})}findColumnIndex(e){return this.columns.findIndex(n=>n.id===e)}getColumn(e){return this.columns.find(n=>n.id===e)}addColumn(e,n){const i=n.id??this.page.generateBlockId();return this.columns.find(r=>r.id===i)||this.page.transact(()=>{const r={...n,id:i};this.columns.splice(Qr(e,this.columns),0,r)}),i}updateColumn(e,n){const i=this.columns.findIndex(r=>r.id===e);if(i!=null)return this.page.transact(()=>{const r=this.columns[i];this.columns[i]={...r,...n(r)}}),e}deleteColumn(e){const n=this.findColumnIndex(e);n<0||this.page.transact(()=>{this.columns.splice(n,1)})}getCell(e,n){if(n==="title")return{columnId:"title",value:e};const r=this.cells[e]?.[n]??null;return r?{columnId:r.columnId,value:r.value}:null}updateCell(e,n){e in this.cells||(this.cells[e]=Object.create(null)),this.page.transact(()=>{this.cells[e][n.columnId]={columnId:n.columnId,value:n.value}})}copyCellsByColumn(e,n){this.page.transact(()=>{Object.keys(this.cells).forEach(i=>{const r=this.cells[i][e];r&&(this.cells[i][n]={...r,columnId:n})})})}updateCells(e,n){this.page.transact(()=>{Object.entries(n).forEach(([i,r])=>{this.cells[i][e]={columnId:e,value:r}})})}}const phe={toV3:t=>{const e=Oe(),n=t.titleColumnName,i=t.titleColumnWidth;delete t.titleColumnName,delete t.titleColumnWidth,t.columns.unshift({id:e,type:"title",name:n,data:{}}),t.views.forEach(r=>{r.mode==="table"&&r.columns.unshift({id:e,width:i})})}},w4=_i({flavour:"affine:database",props:t=>({views:[],title:t.Text(),cells:Object.create(null),columns:[]}),metadata:{role:"hub",version:3,parent:["affine:note"],children:["affine:paragraph","affine:list"]},toModel:()=>new e$,onUpgrade:(t,e,n)=>{e<3&&n>=3&&phe.toV3(t)}});var fhe=Object.defineProperty,ghe=Object.getOwnPropertyDescriptor,mhe=(t,e,n,i)=>{for(var r=i>1?void 0:i?ghe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&fhe(e,n,r),r};let K5=class extends wn{constructor(){super(...arguments),this.indicator=new dp,this.onDrag=(t,e)=>{const n=nee(t);return n&&n.rect?(document.body.append(this.indicator),this.indicator.rect=Bi.fromLWTH(n.rect.left,n.rect.width,n.rect.top,n.rect.height),()=>{this.indicator.remove();const i=this.page.getBlockById(e),r=this.page.getBlockById(n.dropBlockId);let o=this.page.getParent(n.dropBlockId);const s=n.dropType==="in";s&&(o=r),i&&r&&o&&(s?this.page.moveBlocks([i],o):this.page.moveBlocks([i],o,r,n.dropType==="before"))}):(this.indicator.remove(),()=>{})},this._clickDatabaseOps=t=>{hn(t.currentTarget,{options:{input:{initValue:this.model.title.toString(),placeholder:"Untitled",onComplete:e=>{this.model.title.replace(0,this.model.title.length,e)}},items:[{type:"action",icon:Tr,name:"Copy",select:()=>{const e=Ud.fromModels(this.page,[this.model]);this.std.clipboard.copySlice(e).catch(console.error)}},{type:"group",name:"",children:()=>[{type:"action",icon:xn,class:"delete-item",name:"Delete Database",select:()=>{this.model.children.slice().forEach(e=>{this.page.deleteBlock(e)}),this.page.deleteBlock(this.model)}}]}]}})},this._view=Ri(),this.focusFirstCell=()=>{this._view.value?.focusFirstCell()},this.renderViews=()=>Be` <data-view-header-views
      style="flex:1"
      .viewSource="${this._viewSource}"
    ></data-view-header-views>`,this.renderTitle=t=>{const e=()=>t.addRow?.("start");return Be` <affine-database-title
      style="overflow: hidden"
      .titleText="${this.model.title}"
      .readonly="${this.model.page.readonly}"
      .onPressEnterKey="${e}"
    ></affine-database-title>`},this.renderReference=()=>Be`<div></div>`,this.headerComponent=ble(({view:t,viewMethods:e})=>Be`
        <div style="margin-bottom: 16px;display:flex;flex-direction: column">
          <div style="display:flex;gap:8px;padding: 0 6px;margin-bottom: 8px;">
            ${this.renderTitle(e)} ${this.renderDatabaseOps()}
            ${this.renderReference()}
          </div>
          <div
            style="display:flex;align-items:center;justify-content: space-between;gap: 12px"
          >
            ${this.renderViews()} ${A1e(t,e)}
          </div>
          ${R1e(t)}
        </div>
      `),this.setSelection=t=>{this.selection.setGroup("note",t?[new Va({path:this.path,viewSelection:t})]:[])},this.selectionUpdated=new Ve,this._bindHotkey=t=>({dispose:this.host.event.bindHotkey(t,{path:this.topContenteditableElement?.path??this.path})}),this._handleEvent=(t,e)=>({dispose:this.host.event.add(t,e,{path:this.path})})}renderDatabaseOps(){return this.page.readonly?ae:Be`<div class="database-ops" @click="${this._clickDatabaseOps}">
      ${Xo}
    </div>`}get topContenteditableElement(){return this.rootBlockElement instanceof Fi?this.closest("affine-note"):this.rootBlockElement}connectedCallback(){super.connectedCallback(),this.setAttribute(Qp.rangeSyncExcludeAttr,"true"),this._disposables.add(this.selection.slots.changed.on(e=>{const n=e.find(i=>gt.equals(i.path,this.path)?i instanceof Va:!1);this.selectionUpdated.emit(n?.viewSelection)})),this._disposables.add(this.model.propsUpdated.on(()=>{this.viewSource.updateSlot.emit()}));let t=!1;this.disposables.add(ri.registerOption({flavour:w4.model.flavour,onDragMove:e=>{const n=jn(e.raw.target),i=this.view;return i&&n instanceof HTMLElement&&this.contains(n)?(t=i.showIndicator?.(e.raw)??!1,!1):(t&&(i?.hideIndicator?.(),t=!1),!1)},onDragEnd:({state:e,draggingElements:n})=>{const i=e.raw.target,r=this.view;if(t&&r&&r.moveTo&&i instanceof HTMLElement&&this.parentElement?.contains(i)){const o=n.map(s=>s.model);return this.model.page.moveBlocks(o,this.model),o.forEach(s=>{r.moveTo?.(s.id,e.raw)}),r.hideIndicator?.(),!1}return t&&(r?.hideIndicator?.(),t=!1),!1}}))}get view(){return this._view.value?.expose}get dataSource(){return this._dataSource||(this._dataSource=new hhe(this.host,{type:"database-block",pageId:this.host.page.id,blockId:this.model.id})),this._dataSource}get viewSource(){return this._viewSource||(this._viewSource=new bhe(this.model)),this._viewSource}get getFlag(){return this.host.page.awarenessStore.getFlag.bind(this.host.page.awarenessStore)}renderBlock(){const t={bindHotkey:this._bindHotkey,handleEvent:this._handleEvent,getFlag:this.getFlag,selectionUpdated:this.selectionUpdated,setSelection:this.setSelection,dataSource:this.dataSource,viewSource:this.viewSource,headerComponent:this.headerComponent,onDrag:this.onDrag,std:this.std};return Be`
      <div contenteditable="false" style="position: relative">
        <affine-data-view-native
          ${$t(this._view)}
          .config="${t}"
        ></affine-data-view-native>
        ${Tm(this.selected?.is("block"),()=>Be` <affine-block-selection
              style="z-index: 1"
            ></affine-block-selection>`)}
      </div>
    `}};K5.styles=X`
    ${Je(Dv("affine-database"))}
    affine-database {
      display: block;
      border-radius: 8px;
      background-color: var(--affine-background-primary-color);
      padding: 8px;
      margin: 8px -8px -8px;
    }

    .database-block-selected {
      background-color: var(--affine-hover-color);
      border-radius: 4px;
    }
    .database-ops {
      margin-top: 4px;
      padding: 2px;
      border-radius: 4px;
      display: flex;
      cursor: pointer;
    }
    .database-ops svg {
      width: 16px;
      height: 16px;
      color: var(--affine-icon-color);
    }
    .database-ops:hover {
      background-color: var(--affine-hover-color);
    }
  `;K5=mhe([W("affine-database")],K5);class bhe{constructor(e){this.model=e,this.viewMap=new Map,this.updateSlot=new Ve}get currentViewId(){return this.currentId??this.model.views[0].id}selectView(e){this.currentId=e,this.updateSlot.emit()}get views(){return this.model.views.map(e=>this.viewGet(e.id))}get currentView(){return this.viewGet(this.currentViewId)}get readonly(){return this.model.page.readonly}viewAdd(e){this.model.page.captureSync();const n=this.model.addView(e);return this.model.applyViewsUpdate(),n.id}viewGet(e){let n=this.viewMap.get(e);if(!n){const i=()=>this.model.views.find(a=>a.id===e);if(!i())throw new Error("view not found");const o=this,s=new Ve;this.updateSlot.pipe(s),n={duplicate(){o.duplicate(e)},get view(){const a=i();if(!a)throw new Error("view not found");return a},updateView:a=>{this.model.page.captureSync(),this.model.updateView(e,a),this.model.applyViewsUpdate()},delete:()=>{this.model.page.captureSync(),this.model.deleteView(e),this.currentId=void 0,this.model.applyViewsUpdate()},get readonly(){return o.model.page.readonly},updateSlot:s,isDeleted(){return!o.model.views.find(a=>a.id===e)}},this.viewMap.set(e,n)}return n}duplicate(e){const n=this.model.duplicateView(e);this.selectView(n)}moveTo(e,n){this.model.moveViewTo(e,n)}}class t$ extends li{constructor(){super(...arguments),this.inlineManager=new D0,this.referenceNodeConfig=new N0}mounted(){super.mounted(),this.selectionManager.register(Va),this.referenceNodeConfig.setPage(this.page);const e=R0(this.referenceNodeConfig);this.inlineManager.registerSpecs(e),this.inlineManager.registerMarkdownMatches(vv)}initDatabaseBlock(e,n,i,r,o=!0){const s=e.getBlockById(i);if(D(s),s.initTemplate(r),o){const a=e.getParent(n);D(a),e.addBlock("affine:paragraph",{},a.id)}s.applyColumnUpdate()}}const xu={gapHorizontal:130,gapVertical:10},n$=t=>t.reduce((e,n)=>e+n,0),x4=(t,e)=>{const{height:n}=t,i=t.children.map(r=>x4(r,e));return{self:t,height:Math.max(n,i.reduce((r,o)=>r+o.height,0)+e.gapVertical*(i.length-1)),children:i}},Xv=(t,e,n,i,r)=>{const{self:o,children:s,height:a}=t,l={connector:i?{direction:i}:null,self:{x:e,y:n-o.height/2,width:o.width,height:o.height},children:[]};let c=n-a/2;return s.forEach(d=>{const{height:u}=d,h=c+u/2;c+=u+r.gapVertical,l.children.push(Xv(d,e+t.self.width+r.gapHorizontal,h,"right",r))}),l},vhe=(t,e)=>{const n={...xu,...e},i=x4(t,n);return Xv(i,0,0,null,n)},Kv=(t,e,n,i,r)=>{const{self:o,children:s,height:a}=t,l={connector:i?{direction:i}:null,self:{x:e-o.width,y:n-o.height/2,width:o.width,height:o.height},children:[]};let c=n-a/2;return s.forEach(d=>{const{height:u}=d,h=c+u/2;c+=u+r.gapVertical,l.children.push(Kv(d,e-t.self.width-r.gapHorizontal,h,"left",r))}),l},yhe=(t,e)=>{const n={...xu,...e},i=x4(t,n);return Kv(i,0,0,null,n)},whe=(t,e)=>{const n={...xu,...e},i=t.children.map(h=>x4(h,n)),r=i.reduce((h,p)=>Math.max(h,p.height),0)/2,o=[],s=[];let a=!0,l=0;i.forEach(h=>{a?o.push(h):s.push(h),l+=h.height,a&&l>r&&(a=!1,l=0)});let c=0-(n$(s.map(h=>h.height))+n.gapVertical*(s.length-1))/2,d=0-(o.reduce((h,p)=>h+p.height,0)+n.gapVertical*(o.length-1))/2;const u={connector:null,self:{x:0-t.width/2,y:0-t.height/2,width:t.width,height:t.height},children:[]};return o.forEach(h=>{u.children.push(Kv(h,0-(t.width/2+n.gapHorizontal),d+h.height/2,"left",n)),d+=h.height+n.gapVertical}),s.forEach(h=>{u.children.push(Xv(h,t.width/2+n.gapHorizontal,c+h.height/2,"right",n)),c+=h.height+n.gapVertical}),u},_4=(t,e)=>{const{width:n}=t,i=t.children.map(r=>_4(r,e));return{self:t,width:Math.max(n,i.reduce((r,o)=>r+o.width,0)+e.gapHorizontal*(i.length-1)),children:i}},Qv=(t,e,n,i,r)=>{const{self:o,children:s,width:a}=t,l={connector:i?{direction:i}:null,self:{x:e,y:n,width:o.width,height:o.height},children:[]};let c=e-a/2;return s.forEach(d=>{const{self:u,width:h}=d,p=c+h/2;c+=h+r.gapHorizontal,l.children.push(Qv(d,p,n-u.height-r.gapVertical,"top",r))}),l},xhe=(t,e)=>{const n={...xu,...e},i=_4(t,n);return Qv(i,0,0,null,n)},Jv=(t,e,n,i,r)=>{const{self:o,children:s,width:a}=t,l={connector:i?{direction:i}:null,self:{x:e,y:n,width:o.width,height:o.height},children:[]};let c=e-a/2;return s.forEach(d=>{const{self:u,width:h}=d,p=c+h/2;c+=h+r.gapHorizontal,l.children.push(Jv(d,p,n+u.height+r.gapVertical,"bottom",r))}),l},_he=(t,e)=>{const n={...xu,...e},i=_4(t,n);return Jv(i,0,0,null,n)},Che=(t,e)=>{const n={...xu,...e},i=t.children.map(h=>_4(h,n)),r=i.reduce((h,p)=>Math.max(h,p.width),0)/2,o=[],s=[];let a=!0,l=0;i.forEach(h=>{a?o.push(h):s.push(h),l+=h.width,a&&l>r&&(a=!1,l=0)});let c=0-(n$(o.map(h=>h.width))+n.gapHorizontal*(o.length-1))/2,d=0-(s.reduce((h,p)=>h+p.width,0)+n.gapHorizontal*(s.length-1))/2;const u={connector:null,self:{x:0,y:0,width:t.width,height:t.height},children:[]};return o.forEach(h=>{u.children.push(Qv(h,c+h.width/2,0-(t.height/2+n.gapVertical),"top",n)),c+=h.width+n.gapHorizontal}),s.forEach(h=>{u.children.push(Jv(h,d+h.width/2,t.height/2+n.gapVertical,"bottom",n)),d+=h.width+n.gapHorizontal}),u},i$={right:vhe,left:yhe,leftRight:whe,top:xhe,bottom:_he,topBottom:Che},khe={shapeType:"rect",strokeColor:"--affine-palette-line-black",filled:!1,radius:.1,strokeWidth:2,strokeStyle:Yt.Solid,shapeStyle:dn.General},Ehe={stroke:"--affine-palette-line-black",mode:jt.Orthogonal,controllers:[],strokeWidth:2,strokeStyle:Yt.Solid,frontEndpointStyle:St.None,rearEndpointStyle:St.None},She={left:{from:[0,.5],to:[1,.5]},right:{from:[1,.5],to:[0,.5]},top:{from:[.5,0],to:[.5,1]},bottom:{from:[.5,1],to:[.5,0]}},The=(t,e)=>{const n=[],i=[],r=[],o=c=>{const{text:d,children:u}=c,h=e.edgeless.service,p=h.addElement(kn.SHAPE,{...khe,xywh:"[0,0,0,0]",text:new nt.Y.Text(d)});n.push(p);const g=h.getElementById(p),f=Math.max(...d.split(`
`).map(m=>dY(m,Ic(g))))+LT*2,v=k9(g,new ne(0,0,Math.min(600,f),0));return{id:p,width:v.w,height:v.h,children:u.map(m=>{const y=o(m);return r.push({from:p,to:y.id}),y})}},s=o(t),a=i$.leftRight(s,{gapHorizontal:130,gapVertical:10}),l=(c,d)=>{const{id:u,width:h,height:p}=c,{x:g,y:f}=d.self,v=e.edgeless.service;v.updateElement(u,{xywh:`[${g},${f},${h},${p}]`}),c.children.forEach((m,y)=>{const x=d.children[y];if(l(m,x),x.connector){const T=She[x.connector.direction],M=v.addElement(kn.CONNECTOR,{...Ehe,source:{id:u,position:T.from},target:{id:m.id,position:T.to}});i.push(M)}})};return l(s,a),{shapeIds:n,connectorIds:i}};function Ihe(t,e){const{shapeIds:n,connectorIds:i}=The(e,t),{edgeless:r}=t;r.service.selection.set({elements:[...n,...i],editing:!1}),t.edgeless.service.createGroupFromSelected()}const Lhe={layout:i$,drawInEdgeless:Ihe};class _u extends wn{constructor(){super(...arguments),this._cardStyle="horizontal",this._width=At.horizontal,this._height=bt.horizontal,this._isInSurface=!1,this._dragHandleOption={flavour:/affine:embed-*/,edgeless:!0,onDragStart:({state:e,startDragging:n,anchorBlockPath:i})=>{if(!i)return!1;const r=this.std.view.viewFromPath("block",i);if(!r||!Ie(r.model,[this.flavour]))return!1;const o=r,s=jn(e.raw.target),a=!!s?.closest(wr),l=o.contains(s),c=o.isInSurface;if(!c&&(a||l))return this.host.selection.setGroup("note",[this.host.selection.create("block",{path:o.path})]),n([o],e),!0;if(c&&a){const d=o.closest(".edgeless-block-portal-embed");D(d);const u=d.cloneNode();return u.style.transform="",u.style.left="0",u.style.top="0",Qa(o.host.renderModel(o.model),u),n([o],e,u),!0}return!1},onDragEnd:e=>{const{state:n,draggingElements:i,dropBlockId:r}=e;if(i.length!==1||!Ie(i[0].model,[this.flavour]))return!1;const o=i[0],s=o.isInSurface,a=jn(n.raw.target),l=a?.classList.contains("edgeless")&&a?.classList.contains("affine-block-children-container");if(s){if(r){const c=o._cardStyle;if(c==="vertical"||c==="cube"){const{xywh:d}=o.model,u=ne.deserialize(d);u.w=At.horizontal,u.h=bt.horizontal,this.page.updateBlock(o.model,{style:"horizontal",xywh:u.serialize()})}}return Db({blockComponent:o,...e})}else if(l){const c=o._cardStyle;return Bb({blockComponent:o,cssSelector:".embed-block-container",width:At[c],height:bt[c],...e})}return!1}},this.renderEmbed=e=>{if(!this.isInSurface)return b`
        <div
          class="embed-block-container"
          style=${we({width:"100%",margin:"18px 0px"})}
        >
          ${e()}
        </div>
      `;const n=this.surface;D(n);const i=this._width,r=this._height,o=ne.deserialize((this.edgeless?.service.getElementById(this.model.id)??this.model).xywh),s=o.w/i,a=o.h/r;return b`
      <div
        class="embed-block-container"
        style=${we({width:`${i}px`,height:`${r}px`,transform:`scale(${s}, ${a})`,transformOrigin:"0 0"})}
      >
        ${e()}
      </div>
    `}}get isInSurface(){return this._isInSurface}get edgeless(){return this._isInSurface?null:this.host.querySelector("affine-edgeless-page")}get surface(){return this.isInSurface?this.host.querySelector("affine-surface"):null}get bound(){return ne.deserialize((this.edgeless?.service.getElementById(this.model.id)??this.model).xywh)}connectedCallback(){super.connectedCallback();const e=this.host.page.getParent(this.model);this._isInSurface=e?.flavour==="affine:surface",this.disposables.add(ri.registerOption(this._dragHandleOption))}}function Cu(t){return C0(t)}function ku({schema:t,service:e,view:n}){return{schema:_i({flavour:`affine:embed-${t.name}`,props:r=>({index:"a0",xywh:"[0,0,0,0]",rotate:0,...t.props?.(r)||{}}),metadata:{version:t.version,role:"content"},toModel:t.toModel,transformer:t.transformer}),service:e,view:n}}class ey{constructor(){this.endpoint=aO}setEndpoint(e){this.endpoint=e}async query(e){if((e.startsWith("https://x.com/")||e.startsWith("https://www.x.com/")||e.startsWith("https://www.twitter.com/")||e.startsWith("https://twitter.com/"))&&e.includes("/status/")){e="https://api.fxtwitter.com/status/"+/\/status\/(.*)/.exec(e)?.[1];try{const{tweet:n}=await fetch(e).then(i=>i.json());return{title:n.author.name,icon:n.author.avatar_url,description:n.text,image:n.media?.photos[0].url||n.author.banner_url}}catch{throw new Error("Failed to fetch tweet")}}else{const i=await(await fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})}).then(r=>{if(!r||!r.ok)throw new Error("Failed to fetch link preview");return r}).catch(r=>{throw new Error("Failed to fetch link preview")})).json();return{title:i.title?this.getStringFromHTML(i.title):null,description:i.description?this.getStringFromHTML(i.description):null,icon:i.favicons?.[0],image:i.images?.[0]}}}getStringFromHTML(e){const n=document.createElement("div");return n.innerHTML=e,n.textContent}}class Mhe{constructor(){this.updateBlockElementType=hp,this.mergeToCodeModel=CP,this.transformModel=W3}}class Phe{constructor(){this.pageBlock=new Mhe}}function Ahe(t){return JSON.parse(Bhe(JSON.stringify(t)))}const $he=['"attributes"','"conditions"','"iconColumn"','"background"'];function Bhe(t){const e=/("block:[A-Za-z0-9-_]{10}")|("[A-Za-z0-9-_]{10}")|("var\(--affine-tag-[a-z]{3,10}\)")|("[A-Za-z0-9-_=]{44}")/g,n=t.matchAll(e),i=new Map;let r=0;return Array.from(n).map((o,s)=>{$he.includes(o[0])?(i.set(o[0],o[0]),r++):i.set(o[0],`"matchesReplaceMap[${s-r}]"`)}),t.replace(e,o=>i.get(o))}function r$(t,e){const n=new $0,i=n.folder("assets");return D(t),t.forEach((r,o)=>{e.includes(o)&&i?.file(ys(t,o),r)}),n}function o$(t,e){const n=document.createElement("a");n.setAttribute("download",e);const i=URL.createObjectURL(t);n.setAttribute("href",i),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}async function Dhe(t){const e=new ar({workspace:t.workspace}),n=await e.pageToSnapshot(t),r=await new Kg().fromPageSnapshot({snapshot:n,assets:e.assetsManager});let o;const s=t.meta.title||"Untitled";let a;const l=new Blob([r.file],{type:"plain/text"});if(r.assetsIds.length>0){const c=r$(e.assets,r.assetsIds);c.file("index.html",l),o=await c.generateAsync({type:"blob"}),a=`${s}.zip`}else o=l,a=`${s}.html`;o$(o,a)}const Ohe=Object.freeze(Object.defineProperty({__proto__:null,exportPage:Dhe},Symbol.toStringTag,{value:"Module"}));async function Rhe(t){const e=new ar({workspace:t.workspace}),n=await e.pageToSnapshot(t),r=await new Ws().fromPageSnapshot({snapshot:n,assets:e.assetsManager});let o;const s=t.meta.title||"Untitled";let a;const l=new Blob([r.file],{type:"plain/text"});if(r.assetsIds.length>0){const c=r$(e.assets,r.assetsIds);c.file("index.md",l),o=await c.generateAsync({type:"blob"}),a=`${s}.zip`}else o=l,a=`${s}.md`;o$(o,a)}async function Nhe({page:t,markdown:e,noteId:n}){const i=new ar({workspace:t.workspace,middlewares:[Xl]}),r=new Ws;r.applyConfigs(i.adapterConfigs);const o=await r.toSliceSnapshot({file:e,assets:i.assetsManager,pageVersion:t.workspace.meta.pageVersion,workspaceVersion:t.workspace.meta.workspaceVersion,workspaceId:t.workspace.id,pageId:t.id});D(o,"import markdown failed, expected to get a snapshot");const s=o.content.flatMap(a=>a.children);for(const a of s)await i.snapshotToBlock(a,t,n)}const Hhe=Object.freeze(Object.defineProperty({__proto__:null,exportPage:Rhe,importMarkdown:Nhe},Symbol.toStringTag,{value:"Module"}));async function Fhe(t,e){const n=new $0,i=new ar({workspace:t}),r=await Promise.all(e.map(i.pageToSnapshot)),o=i.workspaceInfoToSnapshot();n.file("info.json",JSON.stringify(o,null,2)),r.forEach(l=>{const c=`${l.meta.id}.snapshot.json`;n.file(c,JSON.stringify(l,null,2))});const s=n.folder("assets");D(s);const a=i.assets;return a.forEach((l,c)=>{s.file(ys(a,c),l)}),n.generateAsync({type:"blob"})}async function Uhe(t,e){const n=new $0,{files:i}=await n.loadAsync(e),r=[],o=[];let s,a;Object.entries(i).map(([u,h])=>{if(!(u.includes("MACOSX")||u.includes("DS_Store"))){if(u.startsWith("assets/")&&!h.dir){r.push(h);return}if(u==="info.json"){s=h;return}if(u.endsWith(".snapshot.json")){o.push(h);return}}});{const u=await s?.async("text");D(u),a=JSON.parse(u)}const l=({slots:u,workspace:h})=>{u.afterImport.on(p=>{p.type==="page"&&h.schema.upgradePage(a?.pageVersion??0,{},p.page.spaceDoc)})},c=new ar({workspace:t,middlewares:[Y2,l]}),d=c.assets;return c.snapshotToWorkspaceInfo(a),await Promise.all(r.map(async u=>{const h=u.name.replace("assets/",""),p=h.replace(/\.[^/.]+$/,""),g=await u.async("blob"),f=new File([g],h);d.set(p,f)})),Promise.all(o.map(async u=>{const h=await u.async("text"),p=JSON.parse(h);return c.snapshotToPage(p)}))}const Vhe=Object.freeze(Object.defineProperty({__proto__:null,exportPages:Fhe,importPages:Uhe},Symbol.toStringTag,{value:"Module"}));class Dp extends li{constructor(){super(...arguments),this.queryUrlData=e=>Dp.linkPreviewer.query(e)}static{this.linkPreviewer=new ey}static{this.setLinkPreviewEndpoint=Dp.linkPreviewer.setEndpoint}}const zhe=X`
  .affine-bookmark-card {
    margin: 0 auto;
    box-sizing: border-box;
    display: flex;
    width: 100%;
    max-width: ${At.horizontal}px;
    height: ${bt.horizontal}px;

    border-radius: 8px;
    border: 1px solid var(--affine-background-tertiary-color);

    opacity: var(--add, 1);
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-1);
    user-select: none;
  }

  .affine-bookmark-content {
    width: 536px;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-self: stretch;
    gap: 4px;
    padding: 12px;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-bookmark-content-title {
    display: flex;
    flex-direction: row;
    gap: 8px;
    align-items: center;

    align-self: stretch;
    padding: var(--1, 0px);
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-bookmark-content-title-icon {
    display: flex;
    width: 16px;
    height: 16px;
    justify-content: center;
    align-items: center;
  }

  .affine-bookmark-content-title-icon img,
  .affine-bookmark-content-title-icon object,
  .affine-bookmark-content-title-icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-background-primary-color);
  }

  .affine-bookmark-content-title-text {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    font-style: normal;
    font-weight: 600;
    line-height: 22px;
  }

  .affine-bookmark-content-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;

    flex-grow: 1;

    white-space: normal;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-bookmark-content-url {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 4px;
    width: max-content;
    max-width: 100%;
    cursor: pointer;
  }

  .affine-bookmark-content-url > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;

    word-break: break-all;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-secondary-color);

    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }
  .affine-bookmark-content-url:hover > span {
    color: var(--affine-link-color);
  }
  .affine-bookmark-content-url:hover .open-icon {
    fill: var(--affine-link-color);
  }

  .affine-bookmark-content-url-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 12px;
    height: 20px;
  }
  .affine-bookmark-content-url-icon .open-icon {
    height: 12px;
    width: 12px;
    fill: var(--affine-text-secondary-color);
  }

  .affine-bookmark-banner {
    margin: 12px 12px 0px 0px;
    width: 204px;
    max-width: 100%;
    height: 102px;
    opacity: var(--add, 1);
  }

  .affine-bookmark-banner img,
  .affine-bookmark-banner object,
  .affine-bookmark-banner svg {
    width: 204px;
    max-width: 100%;
    height: 102px;
    object-fit: fill;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-bookmark-card.loading {
    .affine-bookmark-content-title-text {
      color: var(--affine-placeholder-color);
    }
  }

  .affine-bookmark-card.loading-failed {
    .affine-bookmark-content-description {
      color: var(--affine-placeholder-color);
    }
  }

  .affine-bookmark-card.selected {
    .affine-bookmark-content-url > span {
      color: var(--affine-link-color);
    }
    .affine-bookmark-content-url .open-icon {
      fill: var(--affine-link-color);
    }
  }

  .affine-bookmark-card.list {
    height: ${bt.list}px;

    .affine-bookmark-content {
      width: 100%;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }

    .affine-bookmark-content-title {
      width: 536px;
    }

    .affine-bookmark-content-url {
      width: 204px;
      justify-content: flex-end;
    }

    .affine-bookmark-content-description {
      display: none;
    }

    .affine-bookmark-banner {
      display: none;
    }
  }

  .affine-bookmark-card.vertical {
    width: ${At.vertical}px;
    height: ${bt.vertical}px;
    flex-direction: column-reverse;

    .affine-bookmark-content {
      width: 100%;
    }

    .affine-bookmark-content-description {
      -webkit-line-clamp: 6;
      max-height: 120px;
    }

    .affine-bookmark-content-url {
      flex-grow: 1;
      align-items: flex-end;
    }

    .affine-bookmark-banner {
      width: 340px;
      height: 170px;
      margin-left: 12px;
    }

    .affine-bookmark-banner img,
    .affine-bookmark-banner object,
    .affine-bookmark-banner svg {
      width: 340px;
      height: 170px;
    }
  }

  .affine-bookmark-card.cube {
    width: ${At.cube}px;
    height: ${bt.cube}px;

    .affine-bookmark-content {
      width: 100%;
      flex-direction: column;
      align-items: flex-start;
      justify-content: space-between;
    }

    .affine-bookmark-content-title {
      flex-direction: column;
      gap: 4px;
      align-items: flex-start;
    }

    .affine-bookmark-content-title-text {
      -webkit-line-clamp: 2;
    }

    .affine-bookmark-content-description {
      display: none;
    }

    .affine-bookmark-banner {
      display: none;
    }
  }
`;var jhe=Object.defineProperty,Ghe=Object.getOwnPropertyDescriptor,ty=(t,e,n,i)=>{for(var r=i>1?void 0:i?Ghe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&jhe(e,n,r),r};let Op=class extends me(De){constructor(){super(...arguments),this._isSelected=!1,this._themeObserver=new cu}connectedCallback(){super.connectedCallback(),this.disposables.add(this.bookmark.model.propsUpdated.on(()=>{this.requestUpdate()})),this.disposables.add(this.bookmark.slots.loadingUpdated.on(()=>this.requestUpdate())),this._themeObserver.observe(document.documentElement),this._themeObserver.on(()=>this.requestUpdate()),this.disposables.add(()=>this._themeObserver.dispose()),this.disposables.add(this.bookmark.selection.slots.changed.on(t=>{this._isSelected=t.some(e=>gt.equals(e.path,this.bookmark.path))}))}_selectBlock(){const t=this.bookmark.host.selection,e=t.create("block",{path:this.bookmark.path});t.setGroup("note",[e])}_openLink(){let t=this.bookmark.model.url;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank")}_handleClick(){this.bookmark.isInSurface||this._selectBlock()}_handleDoubleClick(t){t.stopPropagation(),this._openLink()}render(){const{icon:t,title:e,url:n,description:i,image:r,style:o}=this.bookmark.model,s=this.bookmark.loading,a=this.bookmark.loadingFailed,l=Qe({loading:s,"loading-failed":a,[o]:!0,selected:this._isSelected}),c=n.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n]+)/im)?.[1],d=s?"Loading...":e||(a?c??"Link card":""),{LoadingIcon:u,EmbedCardBannerIcon:h}=w0(),p=!t?.split(".").pop()||t?.split(".").pop()==="svg"?"svg+xml":t?.split(".").pop(),g=s?u:t?b`<object type="image/${p}" data=${t}>
            ${b8}
          </object>`:b8,f=s?"":i?i??"":a?"Failed to retrieve link information.":n,v=!s&&r?b`<object type="image/webp" data=${r}>
            ${h}
          </object>`:h;return b`
      <div
        class="affine-bookmark-card${l}"
        @click=${this._handleClick}
        @dblclick=${this._handleDoubleClick}
      >
        <div class="affine-bookmark-content">
          <div class="affine-bookmark-content-title">
            <div class="affine-bookmark-content-title-icon">${g}</div>
            <div class="affine-bookmark-content-title-text">${d}</div>
          </div>
          <div class="affine-bookmark-content-description">
            ${f}
          </div>
          <div class="affine-bookmark-content-url" @click=${this._openLink}>
            <span>${n}</span>
            <div class="affine-bookmark-content-url-icon">${oo}</div>
          </div>
        </div>
        <div class="affine-bookmark-banner">${v}</div>
      </div>
    `}};Op.styles=zhe;ty([ie()],Op.prototype,"bookmark",2);ty([ie()],Op.prototype,"_isSelected",2);Op=ty([W("bookmark-card")],Op);var Zhe=Object.defineProperty,Whe=Object.getOwnPropertyDescriptor,bl=(t,e,n,i)=>{for(var r=i>1?void 0:i?Whe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Zhe(e,n,r),r};let No=class extends Ae{constructor(){super(),this.size=null,this.width=null,this.height=null,this.text=null,this.active=!1,this.hover=void 0,this.disabled=void 0,this.addEventListener("keypress",t=>{this.disabled||t.key==="Enter"&&!t.isComposing&&this.click()}),this.addEventListener("click",t=>{this.disabled===!0&&(t.preventDefault(),t.stopPropagation())},{capture:!0})}connectedCallback(){super.connectedCallback(),this.tabIndex=0;const t="28px";if(this.size&&(this.width||this.height))throw new Error("Cannot set both size and width/height on an icon-button");let e=this.width??t,n=this.height??t;this.size&&(e=this.size,n=this.size),this.style.setProperty("--button-width",typeof e=="string"?e:`${e}px`),this.style.setProperty("--button-height",typeof n=="string"?n:`${n}px`)}render(){if(this.hidden)return ae;if(this.disabled)this.style.setProperty("--svg-icon-color","var(--affine-text-disable-color)"),this.dataset.testDisabled="true";else{this.dataset.testDisabled="false";const t=this.active?"var(--affine-primary-color)":"var(--affine-icon-color)";this.style.setProperty("--svg-icon-color",t)}return b`<slot></slot>${this.text?b`<span class="text">${this.text}</span>`:""}<slot name="suffix"></slot>`}};No.styles=X`
    :host {
      box-sizing: border-box;
      display: flex;
      justify-content: center;
      align-items: center;
      border: none;
      width: var(--button-width);
      height: var(--button-height);
      border-radius: 4px;
      background: transparent;
      cursor: pointer;
      user-select: none;
      font-family: ${Je(vt.fontSansFamily)};
      color: var(--affine-text-primary-color);
      pointer-events: auto;
      padding: 4px;
    }

    :host(:hover) {
      background: var(--affine-hover-color);
    }

    :host(:active) {
      background: transparent;
    }

    :host([disabled]),
    :host(:disabled) {
      background: transparent;
      color: var(--affine-text-disable-color);
      cursor: not-allowed;
    }

    /* You can add a 'hover' attribute to the button to show the hover style */
    :host([hover]) {
      background: var(--affine-hover-color);
    }
    :host([hover='false']) {
      background: transparent;
    }

    :host(:active[active]) {
      background: transparent;
    }

    /* not supported "until-found" yet */
    :host([hidden]) {
      display: none;
    }

    :host > .text {
      flex: 1;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    ::slotted(svg) {
      color: var(--svg-icon-color);
    }
  `;bl([L()],No.prototype,"size",2);bl([L()],No.prototype,"width",2);bl([L()],No.prototype,"height",2);bl([L()],No.prototype,"text",2);bl([L({attribute:!0,type:Boolean})],No.prototype,"active",2);bl([L({attribute:!0,type:Boolean})],No.prototype,"hover",2);bl([L({attribute:!0,type:Boolean})],No.prototype,"disabled",2);No=bl([W("icon-button")],No);var qhe=Object.defineProperty,Yhe=Object.getOwnPropertyDescriptor,C4=(t,e,n,i)=>{for(var r=i>1?void 0:i?Yhe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&qhe(e,n,r),r};let Od=class extends me(De){get caption(){return this.block.model.caption??""}_onInputChange(){this.block.model.page.updateBlock(this.block.model,{caption:this.input.value}),this.requestUpdate()}_onInputBlur(){this.dispatchEvent(new CustomEvent("blur",{bubbles:!0}))}render(){if(!this.display)return ae;const t=this.block.model;return b`<input
      .disabled=${t.page.readonly}
      placeholder="Write a caption"
      class="affine-embed-card-caption"
      value=${this.caption}
      @input=${this._onInputChange}
      @blur=${this._onInputBlur}
      @pointerdown=${at}
    />`}};Od.styles=X`
    .affine-embed-card-caption {
      width: 100%;
      font-size: var(--affine-font-sm);
      outline: none;
      border: 0;
      font-family: inherit;
      text-align: center;
      color: var(--affine-icon-color);
      display: inline-block;
      background: transparent;
    }
    .affine-embed-card-caption::placeholder {
      color: var(--affine-placeholder-color);
    }
  `;C4([L({attribute:!1})],Od.prototype,"block",2);C4([L({attribute:!1})],Od.prototype,"display",2);C4([he(".affine-embed-card-caption")],Od.prototype,"input",2);Od=C4([W("embed-card-caption")],Od);var Xhe=Object.defineProperty,Khe=Object.getOwnPropertyDescriptor,Z0=(t,e,n,i)=>{for(var r=i>1?void 0:i?Khe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Xhe(e,n,r),r};let za=class extends me(Ae){_open(){this.block.open(),this.abortController.abort()}async _copyBlock(){const t=Ud.fromModels(this.model.page,[this.model]);await this.std.clipboard.copySlice(t),kt(this.block.host,"Copied link to clipboard"),this.abortController.abort()}_duplicateBlock(){const t=this.model,e=t.keys,n=e.map(p=>t[p]),i=Object.fromEntries(e.map((p,g)=>[p,n[g]])),{width:r,height:o,xywh:s,rotate:a,zIndex:l,...c}=i,{page:d}=t,u=d.getParent(t),h=u?.children.indexOf(t);d.addBlock(t.flavour,c,u,h),this.abortController.abort()}_refreshData(){this.block.refreshData(),this.abortController.abort()}render(){return b`<div class="embed-card-more-menu">
      <icon-button
        width="126px"
        height="32px"
        class="menu-item open"
        text="Open"
        @click=${()=>this._open()}
      >
        ${oo}
      </icon-button>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item copy"
        text="Copy"
        @click=${()=>this._copyBlock()}
      >
        ${Tr}
      </icon-button>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item duplicate"
        text="Duplicate"
        ?disabled=${this.model.page.readonly}
        @click=${()=>this._duplicateBlock()}
      >
        ${il}
      </icon-button>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item reload"
        text="Reload"
        ?disabled=${this.model.page.readonly}
        @click=${()=>this._refreshData()}
      >
        ${f3}
      </icon-button>

      <div class="divider"></div>

      <icon-button
        width="126px"
        height="32px"
        class="menu-item delete"
        text="Delete"
        ?disabled=${this.model.page.readonly}
        @click=${()=>this.model.page.deleteBlock(this.model)}
      >
        ${xn}
      </icon-button>
    </div> `}};za.styles=X`
    .embed-card-more-menu {
      border-radius: 8px;
      padding: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    .embed-card-more-menu .menu-item {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      width: 100%;
    }

    .embed-card-more-menu .menu-item:hover {
      background: var(--affine-hover-color);
    }

    .embed-card-more-menu .menu-item:hover.delete {
      background: var(--affine-background-error-color);
      color: var(--affine-error-color);
    }
    .embed-card-more-menu .menu-item:hover.delete > svg {
      color: var(--affine-error-color);
    }

    .embed-card-more-menu .menu-item svg {
      margin: 0 8px;
    }

    .embed-card-more-menu .divider {
      width: 148px;
      height: 1px;
      margin: 8px;
      background-color: var(--affine-border-color);
    }
  `;Z0([L({attribute:!1})],za.prototype,"model",2);Z0([L({attribute:!1})],za.prototype,"block",2);Z0([L({attribute:!1})],za.prototype,"std",2);Z0([L({attribute:!1})],za.prototype,"abortController",2);za=Z0([W("embed-card-more-menu")],za);var Qhe=Object.defineProperty,Jhe=Object.getOwnPropertyDescriptor,k4=(t,e,n,i)=>{for(var r=i>1?void 0:i?Jhe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Qhe(e,n,r),r};let vc=class extends me(Ae){_setEmbedCardStyle(t){this.model.page.updateBlock(this.model,{style:t}),this.requestUpdate(),this.abortController.abort()}render(){const{EmbedCardHorizontalIcon:t,EmbedCardListIcon:e}=w0();return b`
      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.model.style==="horizontal"})}
        @click=${()=>this._setEmbedCardStyle("horizontal")}
      >
        ${t}
        <affine-tooltip .offset=${4}
          >${"Large horizontal style"}</affine-tooltip
        >
      </icon-button>

      <icon-button
        width="76px"
        height="76px"
        class=${Qe({selected:this.model.style==="list"})}
        @click=${()=>this._setEmbedCardStyle("list")}
      >
        ${e}
        <affine-tooltip .offset=${4}
          >${"Small horizontal style"}</affine-tooltip
        >
      </icon-button>
    `}};vc.styles=X`
    :host {
      border-radius: 8px;
      padding: 8px;
      gap: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
    }

    icon-button {
      padding: var(--1, 0px);
    }

    icon-button.selected {
      border: 1px solid var(--affine-brand-color);
    }
  `;k4([L({attribute:!1})],vc.prototype,"model",2);k4([L({attribute:!1})],vc.prototype,"std",2);k4([L({attribute:!1})],vc.prototype,"abortController",2);vc=k4([W("embed-card-style-menu")],vc);var epe=Object.defineProperty,tpe=Object.getOwnPropertyDescriptor,vl=(t,e,n,i)=>{for(var r=i>1?void 0:i?tpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&epe(e,n,r),r};let Ho=class extends me(Ae){constructor(){super(...arguments),this._cardStyleMenuAbortController=null,this._moreMenuAbortController=null,this._embedOptions=null}get _pageService(){const t=this.std.spec.getService("affine:page");return D(t),t}get _canShowUrlOptions(){return"url"in this.model&&(vi(this.model)||ed(this.model)||Ki(this.model))}get _isCardView(){return vi(this.model)||Ki(this.model)?!0:this._embedOptions?.viewType==="card"}get _isEmbedView(){return vi(this.model)||Ki(this.model)?!1:this._embedOptions?.viewType==="embed"}get _canConvertToEmbedView(){return this._embedOptions?.viewType==="embed"}get _canShowCardStylePanel(){return vi(this.model)||ed(this.model)||Ki(this.model)}_copyUrl(){"url"in this.model&&(navigator.clipboard.writeText(this.model.url).catch(console.error),kt(this.host,"Copied link to clipboard"),this.remove())}_turnIntoInlineView(){if(Ki(this.model)){this.block.covertToInline();return}const{page:t}=this.model,e=t.getParent(this.model),n=e?.children.indexOf(this.model),i=new nt.Y.Text,r=this.model.title||this.model.caption||this.model.url;i.insert(0,r),i.format(0,r.length,{link:this.model.url});const o=new t.Text(i);t.addBlock("affine:paragraph",{text:o},e,n),t.deleteBlock(this.model)}_convertToCardView(){if(this._isCardView||!("url"in this.model))return;const{page:t,url:e,style:n}=this.model;let i="affine:bookmark",r=n;if(this._embedOptions&&this._embedOptions.viewType==="card"){const{flavour:a,styles:l}=this._embedOptions;i=a,r=l.includes(n)?n:l[0]}else r=rc.includes(n)?n:rc.filter(a=>a!=="vertical"&&a!=="cube")[0];const o=t.getParent(this.model);D(o);const s=o.children.indexOf(this.model);t.addBlock(i,{url:e,style:r},o,s),this.std.selection.setGroup("note",[]),t.deleteBlock(this.model)}_convertToEmbedView(){if(this._isEmbedView||!("url"in this.model))return;const{page:t,url:e,style:n}=this.model;if(!this._embedOptions||this._embedOptions.viewType!=="embed")return;const{flavour:i,styles:r}=this._embedOptions,o=r.includes(n)?n:r.filter(l=>l!=="vertical"&&l!=="cube")[0],s=t.getParent(this.model);D(s);const a=s.children.indexOf(this.model);t.addBlock(i,{url:e,style:o},s,a),this.std.selection.setGroup("note",[]),t.deleteBlock(this.model)}_showCaption(){this.block.showCaption=!0,this.block.updateComplete.then(()=>this.block.captionElement.input.focus()).catch(console.error),this.abortController.abort()}_refreshData(){this.block.refreshData(),this.abortController.abort()}_toggleCardStyleMenu(){if(this._moreMenuAbortController&&(this._moreMenuAbortController.abort(),this._moreMenuAbortController=null),this._cardStyleMenuAbortController){this._cardStyleMenuAbortController.abort(),this._cardStyleMenuAbortController=null;return}this._cardStyleMenuAbortController=new AbortController;const t=new vc;t.model=this.model,t.std=this.std,t.abortController=this.abortController,Rs({template:t,container:this.embedCardToolbarElement,computePosition:{referenceElement:this.cardStyleButton,placement:"top",middleware:[Dn(),Dt(8)],autoUpdate:!0},abortController:this._cardStyleMenuAbortController})}_toggleMoreMenu(){if(this._cardStyleMenuAbortController&&(this._cardStyleMenuAbortController.abort(),this._cardStyleMenuAbortController=null),this._moreMenuAbortController){this._moreMenuAbortController.abort(),this._moreMenuAbortController=null;return}this._moreMenuAbortController=new AbortController;const t=new za;t.model=this.model,t.block=this.block,t.std=this.std,t.abortController=this.abortController,Rs({template:t,container:this.embedCardToolbarElement,computePosition:{referenceElement:this.embedCardToolbarElement,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0},abortController:this._moreMenuAbortController})}render(){const t=this.model;return"url"in this.model&&(this._embedOptions=this._pageService.getEmbedBlockOptions(this.model.url)),b`
      <div class="embed-card-toolbar">
        ${this._canShowUrlOptions&&"url"in t?b`<div
                class="embed-card-toolbar-button url"
                @click=${()=>this._copyUrl()}
              >
                <span>${t.url}</span>
              </div>

              <icon-button
                size="32px"
                class="embed-card-toolbar-button copy"
                ?disabled=${t.page.readonly}
                @click=${()=>this._copyUrl()}
              >
                ${Tr}
                <affine-tooltip .offset=${12}
                  >${"Click to copy link"}</affine-tooltip
                >
              </icon-button>

              <icon-button
                size="32px"
                class="embed-card-toolbar-button edit"
                ?disabled=${t.page.readonly}
                @click=${()=>wM(this.host,t)}
              >
                ${p0}
                <affine-tooltip .offset=${12}>${"Edit"}</affine-tooltip>
              </icon-button>

              <div class="divider"></div>`:ae}
        ${Ki(t)?b`<icon-button
                size="32px"
                class="embed-card-toolbar-button open"
                @click=${()=>this.block.open()}
              >
                ${oo}
                <affine-tooltip .offset=${12}>${"Open"}</affine-tooltip>
              </icon-button>

              <div class="divider"></div>`:ae}

        <div class="embed-card-toolbar-button view-selector">
          <icon-button
            size="24px"
            class="embed-card-toolbar-button link"
            hover="false"
            ?disabled=${t.page.readonly}
            @click=${()=>this._turnIntoInlineView()}
          >
            ${Yd}
            <affine-tooltip .offset=${12}>${"Inline view"}</affine-tooltip>
          </icon-button>

          <icon-button
            size="24px"
            class=${Qe({"embed-card-toolbar-button":!0,card:!0,"current-view":this._isCardView})}
            hover="false"
            ?disabled=${t.page.readonly}
            @click=${()=>this._convertToCardView()}
          >
            ${Yo}
            <affine-tooltip .offset=${12}>${"Card view"}</affine-tooltip>
          </icon-button>
          ${this._canConvertToEmbedView?b`<icon-button
                size="24px"
                class=${Qe({"embed-card-toolbar-button":!0,embed:!0,"current-view":this._isEmbedView})}
                hover="false"
                ?disabled=${t.page.readonly}
                @click=${()=>this._convertToEmbedView()}
              >
                ${Qd}
                <affine-tooltip .offset=${12}>${"Embed view"}</affine-tooltip>
              </icon-button>`:ae}
        </div>

        ${this._canShowCardStylePanel?b` <icon-button
              size="32px"
              class="embed-card-toolbar-button card-style"
              ?disabled=${t.page.readonly}
              @click=${()=>this._toggleCardStyleMenu()}
            >
              ${wb}
              <affine-tooltip .offset=${12}>${"Card style"}</affine-tooltip>
            </icon-button>`:ae}

        <div class="divider"></div>

        <icon-button
          size="32px"
          class="embed-card-toolbar-button caption"
          ?disabled=${t.page.readonly}
          @click=${()=>this._showCaption()}
        >
          ${Kd}
          <affine-tooltip .offset=${12}>${"Add Caption"}</affine-tooltip>
        </icon-button>

        <div class="divider"></div>

        <icon-button
          size="32px"
          class="embed-card-toolbar-button reload"
          ?disabled=${t.page.readonly}
          @click=${()=>this._refreshData()}
        >
          ${f3}
          <affine-tooltip .offset=${12}>${"Reload"}</affine-tooltip>
        </icon-button>

        <div class="divider"></div>

        <icon-button
          size="24px"
          class="embed-card-toolbar-button more-button"
          @click=${()=>this._toggleMoreMenu()}
        >
          ${d0}
          <affine-tooltip .offset=${12}>More</affine-tooltip>
        </icon-button>
      </div>
    `}};Ho.styles=X`
    .embed-card-toolbar {
      box-sizing: border-box;
      display: flex;
      align-items: center;
      padding: 8px;
      gap: 8px;
      height: 40px;

      border-radius: 8px;
      background: var(--affine-background-overlay-panel-color);
      box-shadow: var(--affine-shadow-2);
      user-select: none;
    }

    .embed-card-toolbar .divider {
      width: 1px;
      height: 24px;
      background-color: var(--affine-border-color);
    }

    .embed-card-toolbar-button.url {
      display: flex;
      width: 180px;
      padding: var(--1, 0px);
      align-items: flex-start;
      gap: 10px;
      border-radius: var(--1, 0px);
      opacity: var(--add, 1);
      user-select: none;
      cursor: pointer;
    }

    .embed-card-toolbar-button.url > span {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;

      color: var(--affine-link-color);
      font-feature-settings:
        'clig' off,
        'liga' off;
      font-family: var(--affine-font-family);
      font-size: 15px;
      font-style: normal;
      font-weight: 400;
      line-height: 24px;
      text-overflow: ellipsis;
      overflow: hidden;
      opacity: var(--add, 1);
    }

    .embed-card-toolbar-button.view-selector {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 2px;
      border-radius: 6px;
      background: var(--affine-hover-color);
    }
    .embed-card-toolbar-button.view-selector > icon-button {
      padding: 0px;
    }
    .embed-card-toolbar-button.view-selector .current-view {
      background: var(--affine-background-overlay-panel-color);
      border-radius: 6px;
    }
  `;vl([L({attribute:!1})],Ho.prototype,"model",2);vl([L({attribute:!1})],Ho.prototype,"block",2);vl([L({attribute:!1})],Ho.prototype,"host",2);vl([L({attribute:!1})],Ho.prototype,"abortController",2);vl([L({attribute:!1})],Ho.prototype,"std",2);vl([he(".embed-card-toolbar")],Ho.prototype,"embedCardToolbarElement",2);vl([he(".embed-card-toolbar-button.card-style")],Ho.prototype,"cardStyleButton",2);Ho=vl([W("embed-card-toolbar")],Ho);var npe=Object.defineProperty,ipe=Object.getOwnPropertyDescriptor,ny=(t,e,n,i)=>{for(var r=i>1?void 0:i?ipe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&npe(e,n,r),r};let Q5=class extends me(De){constructor(){super(...arguments),this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.block.path?null:{template:b`
        <style>
          :host {
            z-index: 1;
          }
        </style>
        <embed-card-toolbar
          .model=${this.model}
          .block=${this.block}
          .host=${this.host}
          .abortController=${t}
          .std=${this.block.std}
        ></embed-card-toolbar>
      `,computePosition:{referenceElement:this.bookmardCardElement,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}})}get model(){return this.block.model}get host(){return this.block.host}connectedCallback(){super.connectedCallback(),this.disposables.add(this.host.selection.slots.changed.on(()=>this.requestUpdate()))}render(){return b`
      <div
        ${$t(this._whenHover.setReference)}
        style=${we({width:"100%",margin:"18px 0",position:"relative"})}
      >
        <bookmark-card .bookmark=${this.block}></bookmark-card>
        <embed-card-caption
          .block=${this.block}
          .display=${this.block.showCaption}
          @blur=${()=>{this.model.caption||(this.block.showCaption=!1)}}
        ></embed-card-caption>
        ${this.block.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
      </div>
    `}};ny([L({attribute:!1})],Q5.prototype,"block",2);ny([he(".affine-bookmark-card")],Q5.prototype,"bookmardCardElement",2);Q5=ny([W("affine-doc-bookmark")],Q5);var rpe=Object.defineProperty,ope=Object.getOwnPropertyDescriptor,s$=(t,e,n,i)=>{for(var r=i>1?void 0:i?ope(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&rpe(e,n,r),r};let am=class extends me(De){get model(){return this.block.model}get edgeless(){const t=Um(this);return D(t),t}connectedCallback(){super.connectedCallback(),this.disposables.add(this.model.page.slots.blockUpdated.on(({id:t})=>{t===this.model.id&&this.requestUpdate()}))}render(){const t=this.model.style,e=At[t],n=bt[t],i=ne.deserialize((this.edgeless.service.getElementById(this.model.id)??this.model).xywh),r=i.w/e,o=i.h/n;return b`<div
      style=${we({width:`${e}px`,height:`${n}px`,transform:`scale(${r}, ${o})`,transformOrigin:"0 0"})}
    >
      <bookmark-card .bookmark=${this.block}></bookmark-card>
      <embed-card-caption
        .block=${this.block}
        .display=${this.block.showCaption}
        @blur=${()=>{this.model.caption||(this.block.showCaption=!1)}}
      ></embed-card-caption>
      ${this.block.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
    </div>`}};s$([L({attribute:!1})],am.prototype,"block",2);am=s$([W("affine-edgeless-bookmark")],am);async function spe(t){t.loading=!0;const e=t.service?.queryUrlData;D(e);let n,i,r,o;try{const s=await e(t.model.url);n=s.title??null,i=s.description??null,r=s.icon??null,o=s.image??null,!n&&!i&&!r&&!o&&(t.loadingFailed=!0)}catch(s){console.error(s),t.loadingFailed=!0}t.page.updateBlock(t.model,{title:n,description:i,icon:r,image:o}),t.loading=!1}var ape=Object.defineProperty,lpe=Object.getOwnPropertyDescriptor,Eu=(t,e,n,i)=>{for(var r=i>1?void 0:i?lpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ape(e,n,r),r};let ja=class extends wn{constructor(){super(...arguments),this.loading=!1,this.loadingFailed=!1,this.showCaption=!1,this._isInSurface=!1,this.slots={loadingUpdated:new Ve},this._dragHandleOption={flavour:T1.model.flavour,edgeless:!0,onDragStart:({state:t,startDragging:e,anchorBlockPath:n})=>{if(!n)return!1;const i=this.std.view.viewFromPath("block",n);if(!i||!Ie(i.model,[T1.model.flavour]))return!1;const r=i,o=jn(t.raw.target),s=!!o?.closest(wr),a=r.contains(o),l=r.isInSurface;if(!l&&(s||a))return this.host.selection.setGroup("note",[this.host.selection.create("block",{path:r.path})]),e([r],t),!0;if(l&&s){const c=r.closest(".edgeless-block-portal-bookmark");D(c);const d=c.cloneNode();return d.style.transform="",d.style.left="0",d.style.top="0",Qa(r.host.renderModel(r.model),d),e([r],t,d),!0}return!1},onDragEnd:t=>{const{state:e,draggingElements:n,dropBlockId:i}=t;if(n.length!==1||!Ie(n[0].model,[T1.model.flavour]))return!1;const r=n[0],o=r.isInSurface,s=jn(e.raw.target),a=s?.classList.contains("edgeless")&&s?.classList.contains("affine-block-children-container");if(o){if(i){const l=r.model.style;if(l==="vertical"||l==="cube"){const{xywh:c}=r.model,d=ne.deserialize(c);d.w=At.horizontal,d.h=bt.horizontal,this.page.updateBlock(r.model,{style:"horizontal",xywh:d.serialize()})}}return Db({blockComponent:r,...t})}else if(a){const l=r.model.style;return Bb({blockComponent:r,cssSelector:".affine-bookmark-card",width:At[l],height:bt[l],...t})}return!1}},this.open=()=>{let t=this.model.url;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank")},this.refreshData=()=>{spe(this).catch(console.error)}}get isInSurface(){return this._isInSurface}connectedCallback(){super.connectedCallback(),this.contentEditable="false",this.model.caption&&this.model.caption.length>0&&(this.showCaption=!0);const t=this.host.page.getParent(this.model);this._isInSurface=t?.flavour==="affine:surface",!this.model.description&&!this.model.title&&this.refreshData(),this.disposables.add(this.model.propsUpdated.on(({key:e})=>{this.edgelessOrDocBookmark?.requestUpdate(),e==="url"&&this.refreshData()})),this.disposables.add(ri.registerOption(this._dragHandleOption))}updated(t){super.updated(t),t.has("loading")&&this.slots.loadingUpdated.emit()}renderBlock(){return b`${this.isInSurface?b`<affine-edgeless-bookmark
          .block=${this}
        ></affine-edgeless-bookmark>`:b`<affine-doc-bookmark .block=${this}></affine-doc-bookmark>`} `}};Eu([L({attribute:!1})],ja.prototype,"loading",2);Eu([L({attribute:!1})],ja.prototype,"loadingFailed",2);Eu([ie()],ja.prototype,"showCaption",2);Eu([he("affine-edgeless-bookmark, affine-doc-bookmark")],ja.prototype,"edgelessOrDocBookmark",2);Eu([he("embed-card-caption")],ja.prototype,"captionElement",2);ja=Eu([W("affine-bookmark")],ja);const iy=_i({flavour:"affine:code",props:t=>({text:t.Text(),language:vp}),metadata:{version:1,role:"content",parent:["affine:note","affine:paragraph","affine:list"],children:[]}});var cpe=Object.defineProperty,dpe=Object.getOwnPropertyDescriptor,upe=(t,e,n,i)=>{for(var r=i>1?void 0:i?dpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&cpe(e,n,r),r};let lm=class extends wn{connectedCallback(){super.connectedCallback(),this.setAttribute(Qp.rangeSyncExcludeAttr,"true")}renderBlock(){return ae}};lm=upe([W("affine-data-view")],lm);class a$ extends Bn{constructor(){super(),this.created.on(()=>{this.views.length||this.addView("table")})}addView(e){this.page.captureSync();const n=this.page.generateBlockId();return this.page.transact(()=>{this.views.push({id:n,mode:e,columns:[],name:e,filter:{type:"group",op:"and",conditions:[]}})}),n}deleteView(e){this.page.captureSync(),this.page.transact(()=>{this.views=this.views.filter(n=>n.id!==e)})}updateView(e,n){this.page.transact(()=>{this.views=this.views.map(i=>i.id!==e?i:{...i,...n(i)})}),this.applyViewsUpdate()}applyViewsUpdate(){this.page.updateBlock(this,{views:this.views})}}const ry=_i({flavour:"affine:data-view",props:()=>({views:[]}),metadata:{role:"hub",version:1,parent:["affine:note"],children:["affine:paragraph","affine:list"]},toModel:()=>new a$}),l$=/^(?:https:\/\/)?(?:www\.)?figma\.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/,oy=["figma"];class c$ extends Cu(Bn){}class hpe extends li{mounted(){super.mounted();const e=this.std.spec.getService("affine:page");D(e),e.registerEmbedBlockOptions({flavour:this.flavour,urlRegex:l$,styles:oy,viewType:"embed"})}}const ppe={style:oy[0],url:"",caption:null,title:null,description:null},sy=ku({schema:{name:"figma",version:1,toModel:()=>new c$,props:()=>ppe},view:{component:st`affine-embed-figma-block`},service:hpe}),ay=/^(?:https?:\/\/)?(?:www\.)?github\.com\/([^/]+)\/([^/]+)\/(issue|pull)s?\/(\d+)$/,ly=["vertical","horizontal","list","cube"];class d$ extends Cu(Bn){}async function fpe(t,e){const[n,i]=await Promise.all([u$(t),e.query(t.url)]);return{...n,...i}}async function u$(t){const{owner:e,repo:n,githubType:i,githubId:r}=t;let o={};const s=`https://api.github.com/repos/${e}/${n}/${i==="issue"?"issues":"pulls"}/${r}`,a=await fetch(s,{cache:"no-cache"}).catch(()=>null);if(a&&a.ok){const l=await a.json(),{state:c,state_reason:d,draft:u,merged:h,created_at:p,assignees:g}=l,f=g.map(m=>m.login);let v=c;h?v="merged":c==="open"&&u&&(v="draft"),o={status:v,statusReason:d,createdAt:p,assignees:f}}return o}async function gpe(t){t.loading=!0;const e=t.service?.queryUrlData;D(e);const n=await e(t.model),{image:i=null,status:r=null,statusReason:o=null,title:s=null,description:a=null,createdAt:l=null,assignees:c=null}=n;t.page.updateBlock(t.model,{image:i,status:r,statusReason:o,title:s,description:a,createdAt:l,assignees:c}),t.loading=!1}async function mpe(t){const e=t.service?.queryApiData;D(e);const n=await e(t.model);n.status&&t.page.updateBlock(t.model,{status:n.status})}function bpe(t,e,n){if(t==="issue")return e==="open"?uQ:e==="closed"&&n==="completed"?hQ:e==="closed"&&n==="not_planned"?pQ:ae;if(t==="pr"){if(e==="open")return fQ;if(e==="draft")return gQ;if(e==="merged")return mQ;if(e==="closed")return bQ}return ae}var vpe=Object.defineProperty,ype=Object.getOwnPropertyDescriptor,W0=(t,e,n,i)=>{for(var r=i>1?void 0:i?ype(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&vpe(e,n,r),r};let Ga=class extends _u{constructor(){super(...arguments),this._cardStyle="horizontal",this._isSelected=!1,this.loading=!1,this.showCaption=!1,this.open=()=>{let t=this.model.url;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank")},this.refreshData=()=>{gpe(this).catch(console.error)},this.refreshStatus=()=>{mpe(this).catch(console.error)},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:b`
        <style>
          :host {
            z-index: 1;
          }
        </style>
        <embed-card-toolbar
          .model=${this.model}
          .block=${this}
          .host=${this.host}
          .abortController=${t}
          .std=${this.std}
        ></embed-card-toolbar>
      `,computePosition:{referenceElement:this,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}})}_selectBlock(){const t=this.host.selection,e=t.create("block",{path:this.path});t.setGroup("note",[e])}_handleClick(){this.isInSurface||this._selectBlock()}_handleDoubleClick(t){t.stopPropagation(),this.open()}_handleAssigneeClick(t){const e=`https://www.github.com/${t}`;window.open(e,"_blank")}connectedCallback(){if(super.connectedCallback(),this.model.caption&&this.model.caption.length&&(this.showCaption=!0),(!this.model.owner||!this.model.repo||!this.model.githubId)&&this.page.withoutTransact(()=>{const e=this.model.url.match(ay);if(e){const[,n,i,r,o]=e;this.page.updateBlock(this.model,{owner:n,repo:i,githubType:r==="issue"?"issue":"pr",githubId:o})}}),this.page.withoutTransact(()=>{!this.model.description&&!this.model.title?this.refreshData():this.refreshStatus()}),this.disposables.add(this.model.propsUpdated.on(({key:t})=>{this.requestUpdate(),t==="url"&&this.refreshData()})),this.disposables.add(this.selection.slots.changed.on(t=>{this._isSelected=t.some(e=>gt.equals(e.path,this.path))})),this.isInSurface){const t=this.surface;D(t),this.disposables.add(this.model.propsUpdated.on(()=>{this.requestUpdate()}))}}renderBlock(){const{title:t="GitHub",githubType:e,status:n,statusReason:i,owner:r,repo:o,createdAt:s,assignees:a,description:l,image:c,style:d}=this.model;this._cardStyle=d,this._width=At[this._cardStyle],this._height=bt[this._cardStyle];const u=this.loading,{LoadingIcon:h,EmbedCardBannerIcon:p}=w0(),g=u?h:Tb,f=n?bpe(e,n,i):ae,v=u?"":n,m=u?"Loading...":t,y=u?"":l,x=!u&&c?b`<object type="image/webp" data=${c}>
            ${p}
          </object>`:p;let T="";if(s){const M=new Date(s);T=M.toLocaleDateString("en-US",{month:"short",day:"numeric"});const k=M.getDate(),_=["th","st","nd","rd"][(k/10|0)!==1?k%10:4]||"th";T=T.replace(/\d+/,`${k}${_}`)}return this.renderEmbed(()=>b`
        <div
          style=${we({position:"relative"})}
        >
          <div
            ${this.isInSurface?ae:$t(this._whenHover.setReference)}
            class=${Qe({"affine-embed-github-block":!0,loading:u,[d]:!0,selected:this._isSelected})}
            @click=${this._handleClick}
            @dblclick=${this._handleDoubleClick}
          >
            <div class="affine-embed-github-content">
              <div class="affine-embed-github-content-title">
                <div class="affine-embed-github-content-title-icons">
                  <div class="affine-embed-github-content-title-site-icon">
                    ${g}
                  </div>

                  ${n&&v?b`<div
                        class=${Qe({"affine-embed-github-content-title-status-icon":!0,[e]:!0,[n]:!0,success:i==="completed",failure:i==="not_planned"})}
                      >
                        ${f}

                        <span>${v}</span>
                      </div>`:ae}
                </div>

                <div class="affine-embed-github-content-title-text">
                  ${m}
                </div>
              </div>

              <div class="affine-embed-github-content-description">
                ${y}
              </div>

              ${e==="issue"&&a?b`
                    <div class="affine-embed-github-content-assignees">
                      <div
                        class="affine-embed-github-content-assignees-text label"
                      >
                        Assignees
                      </div>

                      <div
                        class="affine-embed-github-content-assignees-text users"
                      >
                        ${a.length===0?b`<span
                              class="affine-embed-github-content-assignees-text-users placeholder"
                              >No one</span
                            >`:Fe(a,M=>M,(M,k)=>b`<span
                                    class="affine-embed-github-content-assignees-text-users user"
                                    @click=${()=>this._handleAssigneeClick(M)}
                                    >${`@${M}`}</span
                                  >
                                  ${k===a.length-1?"":", "}`)}
                      </div>
                    </div>
                  `:ae}

              <div class="affine-embed-github-content-url" @click=${this.open}>
                <span class="affine-embed-github-content-repo"
                  >${`${r}/${o} |`}</span
                >

                ${s?b`<span class="affine-embed-github-content-date"
                      >${T} |</span
                    >`:ae}
                <span>github.com</span>

                <div class="affine-embed-github-content-url-icon">
                  ${oo}
                </div>
              </div>
            </div>

            <div class="affine-embed-github-banner">${x}</div>
          </div>

          <embed-card-caption
            .block=${this}
            .display=${this.showCaption}
            @blur=${()=>{this.model.caption||(this.showCaption=!1)}}
          ></embed-card-caption>

          ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
        </div>
      `)}};Ga.styles=dQ;W0([ie()],Ga.prototype,"_isSelected",2);W0([L({attribute:!1})],Ga.prototype,"loading",2);W0([ie()],Ga.prototype,"showCaption",2);W0([he("embed-card-caption")],Ga.prototype,"captionElement",2);Ga=W0([W("affine-embed-github-block")],Ga);class Rp extends li{constructor(){super(...arguments),this.queryUrlData=e=>fpe(e,Rp.linkPreviewer),this.queryApiData=e=>u$(e)}static{this.linkPreviewer=new ey}mounted(){super.mounted();const e=this.std.spec.getService("affine:page");D(e),e.registerEmbedBlockOptions({flavour:this.flavour,urlRegex:ay,styles:ly,viewType:"card"})}static{this.setLinkPreviewEndpoint=Rp.linkPreviewer.setEndpoint}}const wpe={style:ly[1],owner:"",repo:"",githubType:"issue",githubId:"",url:"",caption:null,image:null,status:null,statusReason:null,title:null,description:null,createdAt:null,assignees:null},cy=ku({schema:{name:"github",version:1,toModel:()=>new d$,props:()=>wpe},view:{component:st`affine-embed-github-block`},service:Rp});class dy extends Cu(Bn){}const Np=ku({schema:{name:"html",version:1,toModel:()=>new dy,props:()=>({})},view:{component:st`affine-embed-html-block`}}),xpe=X`
  .affine-embed-linked-doc-block {
    margin: 0 auto;
    box-sizing: border-box;
    display: flex;
    width: 100%;
    max-width: ${At.horizontal}px;
    height: ${bt.horizontal}px;
    border-radius: 8px;
    border: 1px solid var(--affine-background-tertiary-color);
    opacity: var(--add, 1);
    background: var(--affine-background-primary-color);
    box-shadow: var(--affine-shadow-1);
    user-select: none;
  }

  .affine-embed-linked-doc-content {
    width: 536px;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-self: stretch;
    gap: 4px;
    padding: 12px;
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-linked-doc-content-title {
    display: flex;
    flex-direction: row;
    gap: 8px;
    align-items: center;
    align-self: stretch;
    padding: var(--1, 0px);
    border-radius: var(--1, 0px);
    opacity: var(--add, 1);
  }

  .affine-embed-linked-doc-content-title-icon {
    display: flex;
    width: 16px;
    height: 16px;
    justify-content: center;
    align-items: center;
  }
  .affine-embed-linked-doc-content-title-icon img,
  .affine-embed-linked-doc-content-title-icon object,
  .affine-embed-linked-doc-content-title-icon svg {
    width: 16px;
    height: 16px;
    fill: var(--affine-background-primary-color);
  }

  .affine-embed-linked-doc-content-title-text {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-sm);
    font-style: normal;
    font-weight: 600;
    line-height: 22px;
  }

  .affine-embed-linked-doc-content-description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    flex-grow: 1;
    white-space: normal;
    word-break: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-primary-color);
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-linked-doc-content-date {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 8px;
    width: max-content;
    max-width: 100%;
  }

  .affine-embed-linked-doc-content-date > span {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    word-break: break-all;
    white-space: normal;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--affine-text-secondary-color);
    font-family: var(--affine-font-family);
    font-size: var(--affine-font-xs);
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .affine-embed-linked-doc-banner {
    margin: 12px 12px 0px 0px;
    width: 204px;
    max-width: 100%;
    height: 102px;
    opacity: var(--add, 1);
  }
  .affine-embed-linked-doc-banner img,
  .affine-embed-linked-doc-banner object,
  .affine-embed-linked-doc-banner svg {
    width: 204px;
    max-width: 100%;
    height: 102px;
    object-fit: fill;
    border-radius: 4px 4px var(--1, 0px) var(--1, 0px);
  }

  .affine-embed-linked-doc-block.loading {
    .affine-embed-linked-doc-content-date {
      display: none;
    }
  }
  .affine-embed-linked-doc-block:not(.loading).empty {
    .affine-embed-linked-doc-content-description {
      color: var(--affine-placeholder-color);
    }

    .affine-embed-linked-doc-banner.render {
      display: none;
    }

    .affine-embed-linked-doc-banner.default {
      display: block;
    }
  }
  .affine-embed-linked-doc-block:not(.loading):not(.empty).banner-empty {
    .affine-embed-linked-doc-content {
      width: 100%;
      height: 100%;
    }

    .affine-embed-linked-doc-banner.render {
      display: none;
    }

    .affine-embed-linked-doc-banner.default {
      display: none;
    }
  }
  .affine-embed-linked-doc-block:not(.loading).deleted {
    background: var(--affine-background-secondary-color);

    .affine-embed-linked-doc-content-description {
      color: var(--affine-placeholder-color);
    }

    .affine-embed-linked-doc-content-date {
      display: none;
    }

    .affine-embed-linked-doc-banner.render {
      display: none;
    }

    .affine-embed-linked-doc-banner.default {
      display: block;
    }
  }
  .affine-embed-linked-doc-block.horizontalThin {
    height: ${bt.horizontalThin}px;
    background: var(--affine-background-secondary-color);

    .affine-embed-linked-doc-banner {
      height: 66px;
    }

    .affine-embed-linked-doc-banner img,
    .affine-embed-linked-doc-banner object,
    .affine-embed-linked-doc-banner svg {
      height: 66px;
    }

    .affine-embed-linked-doc-content {
      gap: 12px;
    }
  }
  .affine-embed-linked-doc-block.list {
    height: ${bt.list}px;
    .affine-embed-linked-doc-content {
      width: 100%;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }

    .affine-embed-linked-doc-content-title {
      width: 536px;
    }

    .affine-embed-linked-doc-content-description {
      display: none !important;
    }

    .affine-embed-linked-doc-content-date {
      width: 204px;
      justify-content: flex-end;
    }

    .affine-embed-linked-doc-banner {
      display: none !important;
    }
  }
  .affine-embed-linked-doc-block.vertical {
    width: ${At.vertical}px;
    height: ${bt.vertical}px;
    flex-direction: column-reverse;

    .affine-embed-linked-doc-content {
      width: 100%;
    }

    .affine-embed-linked-doc-content-description {
      -webkit-line-clamp: 6;
      max-height: 120px;
    }

    .affine-embed-linked-doc-content-date {
      flex-grow: 1;
      align-items: flex-end;
    }

    .affine-embed-linked-doc-banner {
      width: 340px;
      height: 170px;
      margin-left: 12px;
    }
    .affine-embed-linked-doc-banner img,
    .affine-embed-linked-doc-banner object,
    .affine-embed-linked-doc-banner svg {
      width: 340px;
      height: 170px;
    }
  }
  .affine-embed-linked-doc-block.vertical:not(.loading):not(
      .empty
    ).banner-empty {
    .affine-embed-linked-doc-content {
      width: 100%;
      height: 100%;
    }

    .affine-embed-linked-doc-banner.render {
      display: none;
    }

    .affine-embed-linked-doc-banner.default {
      display: none;
    }

    .affine-embed-linked-doc-content-description {
      -webkit-line-clamp: 16;
      max-height: 320px;
    }

    .affine-embed-linked-doc-content-date {
      flex-grow: unset;
      align-items: center;
    }
  }
  .affine-embed-linked-doc-block.cube {
    width: ${At.cube}px;
    height: ${bt.cube}px;

    .affine-embed-linked-doc-content {
      width: 100%;
      flex-direction: column;
      align-items: flex-start;
      justify-content: space-between;
    }

    .affine-embed-linked-doc-content-title {
      flex-direction: column;
      gap: 4px;
      align-items: flex-start;
    }

    .affine-embed-linked-doc-content-title-text {
      -webkit-line-clamp: 2;
    }

    .affine-embed-linked-doc-content-description {
      display: none !important;
    }

    .affine-embed-linked-doc-banner {
      display: none !important;
    }
  }
`,IC=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.83325 4C2.83325 2.98748 3.65406 2.16667 4.66659 2.16667H11.3333C12.3458 2.16667 13.1666 2.98748 13.1666 4V8C13.1666 8.27614 12.9427 8.5 12.6666 8.5C12.3904 8.5 12.1666 8.27614 12.1666 8V4C12.1666 3.53976 11.7935 3.16667 11.3333 3.16667H4.66659C4.20635 3.16667 3.83325 3.53976 3.83325 4V12C3.83325 12.4602 4.20635 12.8333 4.66659 12.8333H7.99992C8.27606 12.8333 8.49992 13.0572 8.49992 13.3333C8.49992 13.6095 8.27606 13.8333 7.99992 13.8333H4.66659C3.65406 13.8333 2.83325 13.0125 2.83325 12V4ZM5.49992 5.33333C5.49992 5.05719 5.72378 4.83333 5.99992 4.83333H7.99992C8.27606 4.83333 8.49992 5.05719 8.49992 5.33333C8.49992 5.60948 8.27606 5.83333 7.99992 5.83333H5.99992C5.72378 5.83333 5.49992 5.60948 5.49992 5.33333ZM5.99992 7.16667C5.72378 7.16667 5.49992 7.39053 5.49992 7.66667C5.49992 7.94281 5.72378 8.16667 5.99992 8.16667H9.99992C10.2761 8.16667 10.4999 7.94281 10.4999 7.66667C10.4999 7.39053 10.2761 7.16667 9.99992 7.16667H5.99992ZM5.49992 10C5.49992 9.72386 5.72378 9.5 5.99992 9.5H7.66659C7.94273 9.5 8.16659 9.72386 8.16659 10C8.16659 10.2761 7.94273 10.5 7.66659 10.5H5.99992C5.72378 10.5 5.49992 10.2761 5.49992 10ZM10.3333 9.5C10.0571 9.5 9.83325 9.72386 9.83325 10C9.83325 10.2761 10.0571 10.5 10.3333 10.5H12.1261L9.64637 12.9798C9.4511 13.175 9.4511 13.4916 9.64637 13.6869C9.84163 13.8821 10.1582 13.8821 10.3535 13.6869L12.8333 11.2071V13C12.8333 13.2761 13.0571 13.5 13.3333 13.5C13.6094 13.5 13.8333 13.2761 13.8333 13V10C13.8333 9.86739 13.7806 9.74022 13.6868 9.64645C13.593 9.55268 13.4659 9.5 13.3333 9.5H10.3333Z"
    fill="#77757D"
  />
</svg> `,LC=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.33341 3.16663C3.68908 3.16663 3.16675 3.68896 3.16675 4.33329C3.16675 4.97762 3.68908 5.49996 4.33341 5.49996C4.97775 5.49996 5.50008 4.97762 5.50008 4.33329C5.50008 3.68896 4.97775 3.16663 4.33341 3.16663ZM2.16675 4.33329C2.16675 3.13668 3.1368 2.16663 4.33341 2.16663C5.47397 2.16663 6.40869 3.04791 6.49377 4.16668C7.02253 4.1674 7.5335 4.17722 8.065 4.3056C8.66274 4.44999 9.25871 4.7356 9.96675 5.26663L9.98034 5.27682L9.99321 5.28792C10.5691 5.78434 10.9768 6.45481 11.2208 7.17229C11.3097 7.43372 11.1699 7.71774 10.9084 7.80666C10.647 7.89558 10.363 7.75573 10.2741 7.4943C10.0782 6.91833 9.76335 6.41471 9.35274 6.05614C8.73436 5.59445 8.26418 5.38247 7.8302 5.27765C7.38039 5.169 6.9407 5.16663 6.33403 5.16663C6.06985 5.80011 5.51356 6.28132 4.83341 6.44198V8.89127C5.78898 9.11699 6.50008 9.97543 6.50008 11C6.50008 12.1966 5.53003 13.1666 4.33341 13.1666C3.1368 13.1666 2.16675 12.1966 2.16675 11C2.16675 9.97543 2.87785 9.11699 3.83341 8.89127V6.44198C2.87785 6.21626 2.16675 5.35782 2.16675 4.33329ZM4.33341 9.83329C3.68908 9.83329 3.16675 10.3556 3.16675 11C3.16675 11.6443 3.68908 12.1666 4.33341 12.1666C4.97775 12.1666 5.50008 11.6443 5.50008 11C5.50008 10.3556 4.97775 9.83329 4.33341 9.83329ZM9.66675 8.83329C9.39061 8.83329 9.16675 9.05715 9.16675 9.33329C9.16675 9.60944 9.39061 9.83329 9.66675 9.83329H11.4596L8.97986 12.3131C8.7846 12.5083 8.7846 12.8249 8.97986 13.0202C9.17512 13.2154 9.49171 13.2154 9.68697 13.0202L12.1667 10.5404V12.3333C12.1667 12.6094 12.3906 12.8333 12.6667 12.8333C12.9429 12.8333 13.1667 12.6094 13.1667 12.3333V9.33329C13.1667 9.20068 13.1141 9.07351 13.0203 8.97974C12.9265 8.88597 12.7994 8.83329 12.6667 8.83329H9.66675Z"
    fill="#77757D"
  />
</svg> `,jf=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M7.33331 1.5C6.32079 1.5 5.49997 2.32081 5.49997 3.33333V4.09994H2.66664C2.35368 4.09994 2.09998 4.35364 2.09998 4.6666C2.09998 4.97956 2.35368 5.23327 2.66664 5.23327H2.87251L3.41279 12.7973C3.48132 13.7567 4.27963 14.5 5.24147 14.5H10.7585C11.7203 14.5 12.5186 13.7567 12.5872 12.7973L13.1274 5.23327H13.3333C13.6463 5.23327 13.9 4.97956 13.9 4.6666C13.9 4.35364 13.6463 4.09994 13.3333 4.09994H10.5V3.33333C10.5 2.32081 9.67916 1.5 8.66664 1.5H7.33331ZM9.49997 4.09994V3.33333C9.49997 2.8731 9.12688 2.5 8.66664 2.5H7.33331C6.87307 2.5 6.49997 2.8731 6.49997 3.33333V4.09994H9.49997ZM12.1249 5.23327H3.87505L4.41025 12.726C4.4414 13.1621 4.80427 13.5 5.24147 13.5H10.7585C11.1957 13.5 11.5585 13.1621 11.5897 12.726L12.1249 5.23327ZM7.16664 7.33333C7.16664 7.05719 6.94278 6.83333 6.66664 6.83333C6.3905 6.83333 6.16664 7.05719 6.16664 7.33333V11.3333C6.16664 11.6095 6.3905 11.8333 6.66664 11.8333C6.94278 11.8333 7.16664 11.6095 7.16664 11.3333V7.33333ZM9.33331 6.83333C9.60945 6.83333 9.83331 7.05719 9.83331 7.33333V11.3333C9.83331 11.6095 9.60945 11.8333 9.33331 11.8333C9.05716 11.8333 8.83331 11.6095 8.83331 11.3333V7.33333C8.83331 7.05719 9.05716 6.83333 9.33331 6.83333Z"
    fill="#A8A8A0"
  />
</svg> `,_pe=b`<svg
  width="204"
  height="102"
  viewBox="0 0 204 102"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_9783)">
    <g filter="url(#filter0_d_3075_9783)">
      <rect
        x="58"
        y="3"
        width="105.778"
        height="120"
        rx="4"
        transform="rotate(8 58 3)"
        fill="white"
        fill-opacity="0.1"
        shape-rendering="crispEdges"
      />
      <rect
        x="71.6174"
        y="21.071"
        width="52"
        height="7"
        rx="3"
        transform="rotate(8 71.6174 21.071)"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="69.8083"
        y="33.9445"
        width="73.7781"
        height="4"
        rx="2"
        transform="rotate(8 69.8083 33.9445)"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="68.4165"
        y="43.8472"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 68.4165 43.8472)"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="67.0249"
        y="53.7499"
        width="73.7781"
        height="4"
        rx="2"
        transform="rotate(8 67.0249 53.7499)"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="65.6331"
        y="63.6526"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 65.6331 63.6526)"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="64.2415"
        y="73.5553"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 64.2415 73.5553)"
        fill="black"
        fill-opacity="0.1"
      />
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_9783"
      x="36.2993"
      y="-2"
      width="131.449"
      height="143.554"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.17 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9783"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_9783"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_9783">
      <rect width="204" height="102" fill="white" />
    </clipPath>
  </defs>
</svg> `,Cpe=b`<svg
  width="204"
  height="102"
  viewBox="0 0 204 102"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_12065)">
    <g filter="url(#filter0_d_3075_12065)">
      <rect
        x="58"
        y="3"
        width="105.778"
        height="120"
        rx="4"
        transform="rotate(8 58 3)"
        fill="white"
        fill-opacity="0.1"
        shape-rendering="crispEdges"
      />
      <rect
        x="71.6175"
        y="21.071"
        width="52"
        height="7"
        rx="3"
        transform="rotate(8 71.6175 21.071)"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="69.8083"
        y="33.9445"
        width="73.7781"
        height="4"
        rx="2"
        transform="rotate(8 69.8083 33.9445)"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="68.4165"
        y="43.8472"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 68.4165 43.8472)"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="67.0248"
        y="53.7499"
        width="73.7781"
        height="4"
        rx="2"
        transform="rotate(8 67.0248 53.7499)"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="65.6331"
        y="63.6526"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 65.6331 63.6526)"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="64.2413"
        y="73.5553"
        width="39"
        height="4"
        rx="2"
        transform="rotate(8 64.2413 73.5553)"
        fill="white"
        fill-opacity="0.1"
      />
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_12065"
      x="36.2992"
      y="-2"
      width="131.449"
      height="143.554"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.17 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_12065"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_12065"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_12065">
      <rect width="204" height="102" fill="white" />
    </clipPath>
  </defs>
</svg> `,kpe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_10418)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="#F4F4F5"
    />
    <g filter="url(#filter0_d_3075_10418)">
      <rect
        width="268"
        height="300"
        transform="translate(36 26)"
        fill="white"
      />
      <rect
        x="77"
        y="56.3567"
        width="131.747"
        height="18"
        rx="9"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="88.3567"
        width="186.925"
        height="10"
        rx="5"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="112.357"
        width="98.8106"
        height="10"
        rx="5"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="136.357"
        width="186.925"
        height="10"
        rx="5"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="160.357"
        width="98.8106"
        height="10"
        rx="5"
        fill="black"
        fill-opacity="0.1"
      />
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_10418"
      x="12"
      y="15"
      width="316"
      height="348"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset dy="13" />
      <feGaussianBlur stdDeviation="12" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_10418"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_10418"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_10418">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg>`,Epe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_13652)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="white"
      fill-opacity="0.1"
    />
    <g filter="url(#filter0_d_3075_13652)">
      <rect
        width="268"
        height="300"
        transform="translate(36 26)"
        fill="white"
        fill-opacity="0.06"
      />
      <rect
        x="77"
        y="56.3567"
        width="131.747"
        height="18"
        rx="9"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="88.3567"
        width="186.925"
        height="10"
        rx="5"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="112.357"
        width="98.8106"
        height="10"
        rx="5"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="136.357"
        width="186.925"
        height="10"
        rx="5"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="77"
        y="160.357"
        width="98.8106"
        height="10"
        rx="5"
        fill="white"
        fill-opacity="0.1"
      />
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_13652"
      x="8"
      y="11"
      width="324"
      height="356"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset dy="13" />
      <feGaussianBlur stdDeviation="14" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.44 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_13652"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_13652"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_13652">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Spe=b`<svg
  width="204"
  height="66"
  viewBox="0 0 204 66"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_3075_418)">
    <rect width="53" height="66" transform="translate(49 22)" fill="white" />
    <rect
      x="57.0168"
      y="30.8"
      width="26.0545"
      height="3.85"
      rx="1.925"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="38.5"
      width="36.9664"
      height="2.2"
      rx="1.1"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="44"
      width="19.5409"
      height="2.2"
      rx="1.1"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="49.5"
      width="36.9664"
      height="2.2"
      rx="1.1"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="55"
      width="19.5409"
      height="2.2"
      rx="1.1"
      fill="black"
      fill-opacity="0.1"
    />
  </g>
  <path
    d="M157.341 17.6783L144.153 14.3561L144.708 12.2671C145.628 8.80601 143.153 5.189 139.18 4.18818L129.588 1.77201C125.616 0.771194 121.65 2.7656 120.73 6.22672L120.175 8.31566L106.987 4.99344C103.676 4.15945 100.371 5.82152 99.6047 8.70569L98.4946 12.8836C98.188 14.0373 99.013 15.2429 100.337 15.5766L157.885 30.0735C159.209 30.4072 160.531 29.7424 160.837 28.5886L161.948 24.4108C162.714 21.5266 160.651 18.5123 157.341 17.6783ZM125.525 7.4348C125.831 6.28327 127.157 5.61692 128.478 5.9499L138.07 8.36606C139.391 8.69904 140.218 9.90752 139.912 11.059L139.357 13.148L124.97 9.52375L125.525 7.4348Z"
    fill="#E6E6E6"
  />
  <path
    d="M98.6798 34.2639C98.2253 34.2631 97.8625 34.6108 97.8834 35.0271L99.9152 75.4671C100.103 79.2098 103.451 82.1461 107.536 82.1528L146.222 82.216C150.307 82.2227 153.665 79.2973 153.866 75.5553L156.037 35.1222C156.06 34.7059 155.698 34.3571 155.243 34.3563L98.6798 34.2639ZM137.141 40.1651C137.143 38.8748 138.285 37.8316 139.693 37.8339C141.1 37.8362 142.238 38.8831 142.236 40.1734L142.183 70.5327C142.181 71.823 141.039 72.8662 139.632 72.8639C138.225 72.8616 137.086 71.8147 137.089 70.5244L137.141 40.1651ZM124.404 40.1443C124.406 38.854 125.548 37.8108 126.956 37.8131C128.363 37.8154 129.501 38.8623 129.499 40.1526L129.447 70.5119C129.444 71.8022 128.303 72.8454 126.895 72.8431C125.488 72.8408 124.349 71.7938 124.352 70.5036L124.404 40.1443ZM111.667 40.1234C111.669 38.8332 112.811 37.79 114.219 37.7923C115.626 37.7946 116.764 38.8415 116.762 40.1318L116.71 70.4911C116.707 71.7813 115.566 72.8245 114.158 72.8222C112.751 72.8199 111.613 71.773 111.615 70.4827L111.667 40.1234Z"
    fill="#E6E6E6"
  />
  <defs>
    <filter
      id="filter0_d_3075_418"
      x="46"
      y="19"
      width="59"
      height="72"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_418"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_418"
        result="shape"
      />
    </filter>
  </defs>
</svg> `,Tpe=b`<svg
  width="204"
  height="66"
  viewBox="0 0 204 66"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_3075_12843)">
    <rect
      width="53"
      height="66"
      transform="translate(49 22)"
      fill="white"
      fill-opacity="0.08"
    />
    <rect
      x="57.0168"
      y="30.8"
      width="26.0545"
      height="3.85"
      rx="1.925"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="38.5"
      width="36.9664"
      height="2.2"
      rx="1.1"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="44"
      width="19.5409"
      height="2.2"
      rx="1.1"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="49.5"
      width="36.9664"
      height="2.2"
      rx="1.1"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="57.0168"
      y="55"
      width="19.5409"
      height="2.2"
      rx="1.1"
      fill="white"
      fill-opacity="0.1"
    />
  </g>
  <path
    d="M157.341 17.6783L144.153 14.3561L144.708 12.2671C145.628 8.80601 143.153 5.189 139.18 4.18818L129.588 1.77201C125.616 0.771194 121.65 2.7656 120.73 6.22672L120.175 8.31566L106.987 4.99344C103.676 4.15945 100.371 5.82152 99.6048 8.70569L98.4946 12.8836C98.1881 14.0373 99.013 15.2429 100.337 15.5766L157.885 30.0735C159.209 30.4072 160.531 29.7424 160.837 28.5886L161.948 24.4108C162.714 21.5266 160.651 18.5123 157.341 17.6783ZM125.525 7.4348C125.831 6.28327 127.157 5.61692 128.478 5.9499L138.07 8.36606C139.391 8.69904 140.218 9.90752 139.912 11.059L139.357 13.148L124.97 9.52375L125.525 7.4348Z"
    fill="#646464"
  />
  <path
    d="M98.6798 34.2639C98.2253 34.2631 97.8625 34.6108 97.8834 35.0271L99.9152 75.4671C100.103 79.2098 103.451 82.1461 107.536 82.1528L146.222 82.216C150.307 82.2227 153.665 79.2973 153.866 75.5553L156.037 35.1222C156.06 34.7059 155.698 34.3571 155.243 34.3563L98.6798 34.2639ZM137.141 40.1651C137.143 38.8748 138.285 37.8316 139.693 37.8339C141.1 37.8362 142.238 38.8831 142.236 40.1734L142.183 70.5327C142.181 71.823 141.04 72.8662 139.632 72.8639C138.225 72.8616 137.086 71.8147 137.089 70.5244L137.141 40.1651ZM124.404 40.1443C124.406 38.854 125.548 37.8108 126.956 37.8131C128.363 37.8154 129.501 38.8623 129.499 40.1526L129.447 70.5119C129.444 71.8022 128.303 72.8454 126.895 72.8431C125.488 72.8408 124.35 71.7938 124.352 70.5036L124.404 40.1443ZM111.667 40.1234C111.669 38.8332 112.811 37.79 114.219 37.7923C115.626 37.7946 116.764 38.8415 116.762 40.1318L116.71 70.4911C116.707 71.7813 115.566 72.8245 114.158 72.8222C112.751 72.8199 111.613 71.773 111.615 70.4827L111.667 40.1234Z"
    fill="#646464"
  />
  <defs>
    <filter
      id="filter0_d_3075_12843"
      x="46"
      y="19"
      width="59"
      height="72"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_12843"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_12843"
        result="shape"
      />
    </filter>
  </defs>
</svg> `,Ipe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_695)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="white"
    />
    <g filter="url(#filter0_d_3075_695)">
      <rect
        width="124"
        height="154"
        transform="translate(41 61)"
        fill="white"
      />
      <rect
        x="59.7562"
        y="81.5333"
        width="60.9578"
        height="8.98333"
        rx="4.49167"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="99.5"
        width="86.4875"
        height="5.13333"
        rx="2.56667"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="112.333"
        width="45.7183"
        height="5.13333"
        rx="2.56667"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="125.167"
        width="86.4875"
        height="5.13333"
        rx="2.56667"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="138"
        width="45.7183"
        height="5.13333"
        rx="2.56667"
        fill="black"
        fill-opacity="0.1"
      />
    </g>
    <path
      d="M296.961 47.9114L266.018 40.1164L267.32 35.215C269.478 27.0941 263.671 18.6074 254.349 16.2592L231.845 10.5901C222.524 8.2418 213.218 12.9213 211.06 21.0422L209.758 25.9436L178.815 18.1486C171.047 16.1917 163.292 20.0915 161.494 26.8587L158.889 36.6614C158.17 39.3685 160.105 42.1973 163.213 42.98L298.237 76.9947C301.344 77.7775 304.446 76.2177 305.166 73.5106L307.77 63.7079C309.568 56.9407 304.729 49.8682 296.961 47.9114ZM222.312 23.8768C223.03 21.1749 226.139 19.6115 229.241 20.3927L251.745 26.0619C254.846 26.8431 256.786 29.6786 256.068 32.3805L254.766 37.2818L221.01 28.7781L222.312 23.8768Z"
      fill="#E6E6E6"
    />
    <path
      d="M159.323 86.8265C158.256 86.8248 157.405 87.6405 157.454 88.6173L162.221 183.503C162.662 192.284 170.517 199.174 180.103 199.19L270.871 199.338C280.457 199.354 288.336 192.49 288.807 183.71L293.902 88.8403C293.955 87.8637 293.106 87.0452 292.04 87.0435L159.323 86.8265ZM249.566 100.673C249.571 97.6453 252.25 95.1976 255.552 95.203C258.854 95.2084 261.525 97.6648 261.52 100.692L261.397 171.925C261.391 174.952 258.712 177.4 255.41 177.395C252.108 177.389 249.437 174.933 249.443 171.906L249.566 100.673ZM219.68 100.624C219.686 97.5965 222.365 95.1488 225.667 95.1542C228.969 95.1596 231.64 97.616 231.635 100.643L231.512 171.876C231.506 174.904 228.827 177.351 225.525 177.346C222.223 177.341 219.552 174.884 219.557 171.857L219.68 100.624ZM189.795 100.575C189.801 97.5476 192.48 95.0999 195.782 95.1053C199.084 95.1107 201.755 97.5671 201.749 100.595L201.626 171.827C201.621 174.855 198.942 177.302 195.64 177.297C192.338 177.292 189.667 174.835 189.672 171.808L189.795 100.575Z"
      fill="#E6E6E6"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_3075_695"
      x="27"
      y="51"
      width="152"
      height="182"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset dy="4" />
      <feGaussianBlur stdDeviation="7" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_695"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_695"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_695">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Lpe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_10008)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="#141414"
    />
    <g filter="url(#filter0_d_3075_10008)">
      <rect
        width="124"
        height="154"
        transform="translate(41 61)"
        fill="white"
        fill-opacity="0.06"
      />
      <rect
        x="59.7562"
        y="81.5333"
        width="60.9578"
        height="8.98333"
        rx="4.49167"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="99.5"
        width="86.4875"
        height="5.13333"
        rx="2.56667"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="112.333"
        width="45.7183"
        height="5.13333"
        rx="2.56667"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="125.167"
        width="86.4875"
        height="5.13333"
        rx="2.56667"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="59.7562"
        y="138"
        width="45.7183"
        height="5.13333"
        rx="2.56667"
        fill="white"
        fill-opacity="0.1"
      />
    </g>
    <path
      d="M296.961 47.9114L266.018 40.1164L267.32 35.215C269.478 27.0941 263.671 18.6074 254.349 16.2592L231.845 10.5901C222.524 8.2418 213.218 12.9213 211.06 21.0422L209.758 25.9436L178.815 18.1486C171.047 16.1917 163.292 20.0915 161.494 26.8587L158.889 36.6614C158.17 39.3685 160.105 42.1973 163.213 42.98L298.237 76.9947C301.344 77.7775 304.446 76.2177 305.166 73.5106L307.77 63.7079C309.568 56.9407 304.729 49.8682 296.961 47.9114ZM222.312 23.8768C223.03 21.1749 226.139 19.6115 229.241 20.3927L251.745 26.0619C254.846 26.8431 256.786 29.6786 256.068 32.3805L254.766 37.2818L221.01 28.7781L222.312 23.8768Z"
      fill="#313131"
    />
    <path
      d="M159.323 86.8265C158.256 86.8248 157.405 87.6405 157.454 88.6173L162.221 183.503C162.662 192.284 170.517 199.174 180.103 199.19L270.871 199.338C280.457 199.354 288.336 192.49 288.807 183.71L293.902 88.8403C293.955 87.8637 293.106 87.0452 292.04 87.0435L159.323 86.8265ZM249.566 100.673C249.571 97.6453 252.25 95.1976 255.552 95.203C258.854 95.2084 261.525 97.6648 261.52 100.692L261.397 171.925C261.391 174.952 258.712 177.4 255.41 177.395C252.108 177.389 249.437 174.933 249.443 171.906L249.566 100.673ZM219.68 100.624C219.686 97.5965 222.365 95.1488 225.667 95.1542C228.969 95.1596 231.64 97.616 231.635 100.643L231.512 171.876C231.506 174.904 228.827 177.351 225.525 177.346C222.223 177.341 219.552 174.884 219.557 171.857L219.68 100.624ZM189.795 100.575C189.801 97.5476 192.48 95.0999 195.782 95.1053C199.084 95.1107 201.755 97.5671 201.749 100.595L201.626 171.827C201.621 174.855 198.942 177.302 195.64 177.297C192.338 177.292 189.667 174.835 189.672 171.808L189.795 100.575Z"
      fill="#313131"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_3075_10008"
      x="17"
      y="41"
      width="172"
      height="202"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset dy="4" />
      <feGaussianBlur stdDeviation="12" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_10008"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_10008"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_10008">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Mpe=b`<svg
  width="204"
  height="102"
  viewBox="0 0 204 102"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_9806)">
    <g filter="url(#filter0_d_3075_9806)">
      <g clip-path="url(#clip1_3075_9806)">
        <rect
          x="46"
          y="5"
          width="125.328"
          height="85.42"
          rx="4"
          transform="rotate(8 46 5)"
          fill="white"
          fill-opacity="0.1"
          shape-rendering="crispEdges"
        />
        <rect
          x="58.1663"
          y="19.0759"
          width="43.8649"
          height="32.392"
          rx="4"
          transform="rotate(8 58.1663 19.0759)"
          fill="#EEEEEE"
        />
        <rect
          x="110.528"
          y="62.3364"
          width="43.8649"
          height="21.7263"
          rx="4"
          transform="rotate(8 110.528 62.3364)"
          fill="#EEEEEE"
        />
        <rect
          x="54.2542"
          y="62.8047"
          width="41.6532"
          height="4.74028"
          rx="2.37014"
          transform="rotate(8 54.2542 62.8047)"
          fill="black"
          fill-opacity="0.1"
        />
        <rect
          x="52.9346"
          y="72.1931"
          width="29.8576"
          height="4.74028"
          rx="2.37014"
          transform="rotate(8 52.9346 72.1931)"
          fill="black"
          fill-opacity="0.1"
        />
        <path
          d="M102.665 41.4729C102.118 41.396 101.612 41.7771 101.536 42.324C101.459 42.8709 101.84 43.3765 102.387 43.4534L102.665 41.4729ZM105.394 43.876C105.941 43.9529 106.447 43.5719 106.523 43.025C106.6 42.478 106.219 41.9724 105.672 41.8955L105.394 43.876ZM111.687 42.7408C111.14 42.6639 110.634 43.045 110.557 43.5919C110.481 44.1388 110.862 44.6445 111.409 44.7213L111.687 42.7408ZM117.423 45.5666C117.97 45.6435 118.476 45.2625 118.553 44.7155C118.629 44.1686 118.248 43.663 117.702 43.5861L117.423 45.5666ZM123.716 44.4314C123.169 44.3545 122.664 44.7356 122.587 45.2825C122.51 45.8294 122.891 46.3351 123.438 46.4119L123.716 44.4314ZM129.077 47.7514C129.553 48.0319 130.166 47.8737 130.446 47.3979C130.727 46.9222 130.569 46.3091 130.093 46.0286L129.077 47.7514ZM134.305 51.618C134.166 51.0834 133.621 50.7622 133.086 50.9007C132.551 51.0392 132.23 51.5849 132.369 52.1195L134.305 51.618ZM132.272 56.7004C132.195 57.2473 132.576 57.753 133.123 57.8298C133.67 57.9067 134.176 57.5256 134.252 56.9787L132.272 56.7004ZM133.747 60.5748C133.824 60.0279 133.443 59.5222 132.896 59.4453C132.349 59.3685 131.843 59.7495 131.766 60.2964L133.747 60.5748ZM102.387 43.4534L105.394 43.876L105.672 41.8955L102.665 41.4729L102.387 43.4534ZM111.409 44.7213L117.423 45.5666L117.702 43.5861L111.687 42.7408L111.409 44.7213ZM123.438 46.4119L126.445 46.8346L126.723 44.854L123.716 44.4314L123.438 46.4119ZM126.445 46.8346C127.406 46.9696 128.293 47.2891 129.077 47.7514L130.093 46.0286C129.086 45.4351 127.949 45.0263 126.723 44.854L126.445 46.8346ZM132.369 52.1195C132.597 53.0007 132.66 53.9414 132.525 54.9024L134.505 55.1807C134.677 53.9549 134.598 52.7492 134.305 51.618L132.369 52.1195ZM132.525 54.9024L132.272 56.7004L134.252 56.9787L134.505 55.1807L132.525 54.9024ZM131.766 60.2964L131.514 62.0945L133.494 62.3728L133.747 60.5748L131.766 60.2964Z"
          fill="black"
          fill-opacity="0.3"
        />
        <path
          d="M136.622 38.7233C145.813 33.9965 156.074 29.1384 149.749 37.1115C143.424 45.0846 137.142 57.4286 151.255 49.3745"
          stroke="black"
          stroke-opacity="0.3"
          stroke-width="1.90521"
          stroke-linecap="round"
        />
      </g>
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_9806"
      x="29.1118"
      y="0"
      width="145.997"
      height="112.031"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.17 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9806"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_9806"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_9806">
      <rect width="204" height="102" fill="white" />
    </clipPath>
    <clipPath id="clip1_3075_9806">
      <rect
        x="46"
        y="5"
        width="125.328"
        height="85.42"
        rx="4"
        transform="rotate(8 46 5)"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Ppe=b`<svg
  width="204"
  height="102"
  viewBox="0 0 204 102"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_9829)">
    <g filter="url(#filter0_d_3075_9829)">
      <g clip-path="url(#clip1_3075_9829)">
        <rect
          x="46"
          y="5"
          width="125.328"
          height="85.42"
          rx="4"
          transform="rotate(8 46 5)"
          fill="white"
          fill-opacity="0.1"
          shape-rendering="crispEdges"
        />
        <rect
          x="58.1662"
          y="19.0759"
          width="43.8649"
          height="32.392"
          rx="4"
          transform="rotate(8 58.1662 19.0759)"
          fill="#303030"
        />
        <rect
          x="110.528"
          y="62.3364"
          width="43.8649"
          height="21.7263"
          rx="4"
          transform="rotate(8 110.528 62.3364)"
          fill="#303030"
        />
        <rect
          x="54.2541"
          y="62.8047"
          width="41.6532"
          height="4.74028"
          rx="2.37014"
          transform="rotate(8 54.2541 62.8047)"
          fill="white"
          fill-opacity="0.1"
        />
        <rect
          x="52.9347"
          y="72.1931"
          width="29.8576"
          height="4.74028"
          rx="2.37014"
          transform="rotate(8 52.9347 72.1931)"
          fill="white"
          fill-opacity="0.1"
        />
        <path
          d="M102.665 41.4729C102.118 41.396 101.613 41.7771 101.536 42.324C101.459 42.8709 101.84 43.3765 102.387 43.4534L102.665 41.4729ZM105.394 43.876C105.941 43.9529 106.447 43.5719 106.524 43.025C106.6 42.478 106.219 41.9724 105.672 41.8955L105.394 43.876ZM111.687 42.7408C111.14 42.6639 110.634 43.045 110.558 43.5919C110.481 44.1388 110.862 44.6445 111.409 44.7213L111.687 42.7408ZM117.423 45.5666C117.97 45.6435 118.476 45.2625 118.553 44.7155C118.63 44.1686 118.248 43.663 117.702 43.5861L117.423 45.5666ZM123.716 44.4314C123.169 44.3545 122.664 44.7356 122.587 45.2825C122.51 45.8294 122.891 46.3351 123.438 46.4119L123.716 44.4314ZM129.077 47.7514C129.553 48.0319 130.166 47.8737 130.446 47.3979C130.727 46.9222 130.569 46.3091 130.093 46.0286L129.077 47.7514ZM134.305 51.618C134.166 51.0834 133.621 50.7622 133.086 50.9007C132.551 51.0392 132.23 51.5849 132.369 52.1195L134.305 51.618ZM132.272 56.7004C132.195 57.2473 132.576 57.753 133.123 57.8298C133.67 57.9067 134.176 57.5256 134.252 56.9787L132.272 56.7004ZM133.747 60.5748C133.824 60.0279 133.443 59.5222 132.896 59.4453C132.349 59.3685 131.843 59.7495 131.767 60.2964L133.747 60.5748ZM102.387 43.4534L105.394 43.876L105.672 41.8955L102.665 41.4729L102.387 43.4534ZM111.409 44.7213L117.423 45.5666L117.702 43.5861L111.687 42.7408L111.409 44.7213ZM123.438 46.4119L126.445 46.8346L126.723 44.854L123.716 44.4314L123.438 46.4119ZM126.445 46.8346C127.406 46.9696 128.293 47.2891 129.077 47.7514L130.093 46.0286C129.086 45.4351 127.949 45.0263 126.723 44.854L126.445 46.8346ZM132.369 52.1195C132.597 53.0007 132.66 53.9414 132.525 54.9024L134.505 55.1807C134.677 53.9549 134.598 52.7492 134.305 51.618L132.369 52.1195ZM132.525 54.9024L132.272 56.7004L134.252 56.9787L134.505 55.1807L132.525 54.9024ZM131.767 60.2964L131.514 62.0945L133.494 62.3728L133.747 60.5748L131.767 60.2964Z"
          fill="white"
          fill-opacity="0.3"
        />
        <path
          d="M136.622 38.7233C145.813 33.9965 156.074 29.1384 149.749 37.1115C143.424 45.0846 137.142 57.4286 151.254 49.3745"
          stroke="white"
          stroke-opacity="0.3"
          stroke-width="1.90521"
          stroke-linecap="round"
        />
      </g>
    </g>
  </g>
  <defs>
    <filter
      id="filter0_d_3075_9829"
      x="29.1118"
      y="0"
      width="145.997"
      height="112.031"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.17 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9829"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_9829"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_9829">
      <rect width="204" height="102" fill="white" />
    </clipPath>
    <clipPath id="clip1_3075_9829">
      <rect
        x="46"
        y="5"
        width="125.328"
        height="85.42"
        rx="4"
        transform="rotate(8 46 5)"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Ape=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_9936)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="white"
      fill-opacity="0.1"
    />
    <g filter="url(#filter0_dd_3075_9936)">
      <rect x="32" y="19.3782" width="119" height="78" rx="8" fill="#EEEEEE" />
    </g>
    <g filter="url(#filter1_dd_3075_9936)">
      <rect x="189" y="102.378" width="119" height="54" rx="8" fill="#EEEEEE" />
    </g>
    <rect
      x="35.999"
      y="120.552"
      width="113"
      height="11"
      rx="5.5"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="35.999"
      y="145.378"
      width="81"
      height="11"
      rx="5.5"
      fill="black"
      fill-opacity="0.1"
    />
    <path
      d="M160 57.1802C159.172 57.1802 158.5 57.8517 158.5 58.6802C158.5 59.5086 159.172 60.1802 160 60.1802V57.1802ZM164.75 60.1802C165.578 60.1802 166.25 59.5086 166.25 58.6802C166.25 57.8517 165.578 57.1802 164.75 57.1802V60.1802ZM174.25 57.1802C173.422 57.1802 172.75 57.8517 172.75 58.6802C172.75 59.5086 173.422 60.1802 174.25 60.1802V57.1802ZM183.75 60.1802C184.578 60.1802 185.25 59.5086 185.25 58.6802C185.25 57.8517 184.578 57.1802 183.75 57.1802V60.1802ZM193.25 57.1802C192.422 57.1802 191.75 57.8517 191.75 58.6802C191.75 59.5086 192.422 60.1802 193.25 60.1802V57.1802ZM202.75 60.1802C203.578 60.1802 204.25 59.5086 204.25 58.6802C204.25 57.8517 203.578 57.1802 202.75 57.1802V60.1802ZM212.25 57.1802C211.422 57.1802 210.75 57.8517 210.75 58.6802C210.75 59.5086 211.422 60.1802 212.25 60.1802V57.1802ZM221.75 60.1802C222.578 60.1802 223.25 59.5086 223.25 58.6802C223.25 57.8517 222.578 57.1802 221.75 57.1802V60.1802ZM231.25 57.1802C230.422 57.1802 229.75 57.8517 229.75 58.6802C229.75 59.5086 230.422 60.1802 231.25 60.1802V57.1802ZM240.019 60.9763C240.784 61.2937 241.662 60.9306 241.979 60.1653C242.296 59.4001 241.933 58.5225 241.168 58.2052L240.019 60.9763ZM248.475 65.5121C248.158 64.7469 247.28 64.3838 246.515 64.7011C245.75 65.0185 245.387 65.8961 245.704 66.6613L248.475 65.5121ZM246.5 78.1288C246.5 78.9572 247.172 79.6288 248 79.6288C248.828 79.6288 249.5 78.9572 249.5 78.1288H246.5ZM249.5 93.0259C249.5 92.1975 248.828 91.5259 248 91.5259C247.172 91.5259 246.5 92.1975 246.5 93.0259H249.5ZM160 60.1802H164.75V57.1802H160V60.1802ZM174.25 60.1802H183.75V57.1802H174.25V60.1802ZM193.25 60.1802H202.75V57.1802H193.25V60.1802ZM212.25 60.1802H221.75V57.1802H212.25V60.1802ZM231.25 60.1802H236V57.1802H231.25V60.1802ZM236 60.1802C237.426 60.1802 238.783 60.4638 240.019 60.9763L241.168 58.2052C239.574 57.5442 237.828 57.1802 236 57.1802V60.1802ZM245.704 66.6613C246.216 67.8973 246.5 69.2537 246.5 70.6802H249.5C249.5 68.8525 249.136 67.106 248.475 65.5121L245.704 66.6613ZM246.5 70.6802V78.1288H249.5V70.6802H246.5ZM246.5 93.0259V100.475H249.5V93.0259H246.5Z"
      fill="black"
      fill-opacity="0.3"
    />
    <path
      d="M250.185 35.7596C273.092 19.591 298.824 2.66568 284.842 26.4733C270.86 50.2808 258.644 85.8144 293.517 58.8491"
      stroke="black"
      stroke-opacity="0.3"
      stroke-width="3"
      stroke-linecap="round"
    />
  </g>
  <path
    d="M0.5 4C0.5 2.067 2.067 0.5 4 0.5H336C337.933 0.5 339.5 2.067 339.5 4V169.5H0.5V4Z"
    stroke="#E3E2E4"
  />
  <defs>
    <filter
      id="filter0_dd_3075_9936"
      x="22"
      y="19.3782"
      width="139"
      height="98"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feMorphology
        radius="3"
        operator="erode"
        in="SourceAlpha"
        result="effect1_dropShadow_3075_9936"
      />
      <feOffset dy="4" />
      <feGaussianBlur stdDeviation="3" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9936"
      />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feMorphology
        radius="2"
        operator="erode"
        in="SourceAlpha"
        result="effect2_dropShadow_3075_9936"
      />
      <feOffset dy="10" />
      <feGaussianBlur stdDeviation="6" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="effect1_dropShadow_3075_9936"
        result="effect2_dropShadow_3075_9936"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect2_dropShadow_3075_9936"
        result="shape"
      />
    </filter>
    <filter
      id="filter1_dd_3075_9936"
      x="179"
      y="102.378"
      width="139"
      height="74"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feMorphology
        radius="3"
        operator="erode"
        in="SourceAlpha"
        result="effect1_dropShadow_3075_9936"
      />
      <feOffset dy="4" />
      <feGaussianBlur stdDeviation="3" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9936"
      />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feMorphology
        radius="2"
        operator="erode"
        in="SourceAlpha"
        result="effect2_dropShadow_3075_9936"
      />
      <feOffset dy="10" />
      <feGaussianBlur stdDeviation="6" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.1 0"
      />
      <feBlend
        mode="normal"
        in2="effect1_dropShadow_3075_9936"
        result="effect2_dropShadow_3075_9936"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect2_dropShadow_3075_9936"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_9936">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,$pe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M0.5 4C0.5 2.067 2.067 0.5 4 0.5H336C337.933 0.5 339.5 2.067 339.5 4V169.5H0.5V4Z"
    fill="#141414"
  />
  <path
    d="M0.5 4C0.5 2.067 2.067 0.5 4 0.5H336C337.933 0.5 339.5 2.067 339.5 4V169.5H0.5V4Z"
    stroke="#2E2E2E"
  />
  <rect x="32" y="19.3782" width="119" height="78" rx="8" fill="#303030" />
  <rect x="189" y="102.378" width="119" height="54" rx="8" fill="#303030" />
  <rect
    x="35.999"
    y="120.552"
    width="113"
    height="11"
    rx="5.5"
    fill="white"
    fill-opacity="0.1"
  />
  <rect
    x="35.999"
    y="145.378"
    width="81"
    height="11"
    rx="5.5"
    fill="white"
    fill-opacity="0.1"
  />
  <path
    d="M160 57.1802C159.172 57.1802 158.5 57.8517 158.5 58.6802C158.5 59.5086 159.172 60.1802 160 60.1802V57.1802ZM164.75 60.1802C165.578 60.1802 166.25 59.5086 166.25 58.6802C166.25 57.8517 165.578 57.1802 164.75 57.1802V60.1802ZM174.25 57.1802C173.422 57.1802 172.75 57.8517 172.75 58.6802C172.75 59.5086 173.422 60.1802 174.25 60.1802V57.1802ZM183.75 60.1802C184.578 60.1802 185.25 59.5086 185.25 58.6802C185.25 57.8517 184.578 57.1802 183.75 57.1802V60.1802ZM193.25 57.1802C192.422 57.1802 191.75 57.8517 191.75 58.6802C191.75 59.5086 192.422 60.1802 193.25 60.1802V57.1802ZM202.75 60.1802C203.578 60.1802 204.25 59.5086 204.25 58.6802C204.25 57.8517 203.578 57.1802 202.75 57.1802V60.1802ZM212.25 57.1802C211.422 57.1802 210.75 57.8517 210.75 58.6802C210.75 59.5086 211.422 60.1802 212.25 60.1802V57.1802ZM221.75 60.1802C222.578 60.1802 223.25 59.5086 223.25 58.6802C223.25 57.8517 222.578 57.1802 221.75 57.1802V60.1802ZM231.25 57.1802C230.422 57.1802 229.75 57.8517 229.75 58.6802C229.75 59.5086 230.422 60.1802 231.25 60.1802V57.1802ZM240.019 60.9763C240.784 61.2937 241.662 60.9306 241.979 60.1653C242.296 59.4001 241.933 58.5225 241.168 58.2052L240.019 60.9763ZM248.475 65.5121C248.158 64.7469 247.28 64.3838 246.515 64.7011C245.75 65.0185 245.387 65.8961 245.704 66.6613L248.475 65.5121ZM246.5 78.1288C246.5 78.9572 247.172 79.6288 248 79.6288C248.828 79.6288 249.5 78.9572 249.5 78.1288H246.5ZM249.5 93.0259C249.5 92.1975 248.828 91.5259 248 91.5259C247.172 91.5259 246.5 92.1975 246.5 93.0259H249.5ZM160 60.1802H164.75V57.1802H160V60.1802ZM174.25 60.1802H183.75V57.1802H174.25V60.1802ZM193.25 60.1802H202.75V57.1802H193.25V60.1802ZM212.25 60.1802H221.75V57.1802H212.25V60.1802ZM231.25 60.1802H236V57.1802H231.25V60.1802ZM236 60.1802C237.426 60.1802 238.783 60.4638 240.019 60.9763L241.168 58.2052C239.574 57.5442 237.828 57.1802 236 57.1802V60.1802ZM245.704 66.6613C246.216 67.8973 246.5 69.2537 246.5 70.6802H249.5C249.5 68.8525 249.136 67.106 248.475 65.5121L245.704 66.6613ZM246.5 70.6802V78.1288H249.5V70.6802H246.5ZM246.5 93.0259V100.475H249.5V93.0259H246.5Z"
    fill="white"
    fill-opacity="0.3"
  />
  <path
    d="M250.185 35.7596C273.092 19.591 298.824 2.66568 284.842 26.4733C270.86 50.2808 258.644 85.8144 293.517 58.8491"
    stroke="white"
    stroke-opacity="0.3"
    stroke-width="3"
    stroke-linecap="round"
  />
</svg> `,Bpe=b`<svg
  width="204"
  height="66"
  viewBox="0 0 204 66"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_3075_9990)">
    <rect
      x="35.446"
      y="22.3057"
      width="66"
      height="44.9836"
      rx="2"
      fill="white"
    />
    <rect
      x="42.8223"
      y="28.7544"
      width="23.1"
      height="17.0581"
      rx="2"
      fill="#EAEAEA"
    />
    <rect
      x="73.2991"
      y="47.4768"
      width="23.1"
      height="11.4414"
      rx="2"
      fill="#EAEAEA"
    />
    <rect
      x="43.9871"
      y="51.8455"
      width="21.9353"
      height="2.49631"
      rx="1.24816"
      fill="black"
      fill-opacity="0.1"
    />
    <rect
      x="43.9871"
      y="56.8379"
      width="15.7235"
      height="2.49631"
      rx="1.24816"
      fill="black"
      fill-opacity="0.1"
    />
    <path
      d="M67.6697 37.6997H80.752C82.9612 37.6997 84.752 39.4906 84.752 41.6997V45.8127"
      stroke="black"
      stroke-opacity="0.3"
      stroke-linecap="round"
      stroke-dasharray="4 4"
    />
    <path
      d="M85.1761 33.2503C89.6228 30.1117 94.6178 26.8262 91.9036 31.4477C89.1895 36.0691 86.8182 42.9668 93.5876 37.7324"
      stroke="black"
      stroke-opacity="0.3"
      stroke-linecap="round"
    />
  </g>
  <path
    d="M157.341 17.6782L144.153 14.356L144.708 12.267C145.628 8.80589 143.153 5.18888 139.18 4.18806L129.588 1.77189C125.616 0.771072 121.65 2.76548 120.73 6.2266L120.175 8.31554L106.987 4.99332C103.676 4.15932 100.371 5.82139 99.6047 8.70557L98.4946 12.8835C98.188 14.0372 99.013 15.2428 100.337 15.5764L157.885 30.0734C159.209 30.407 160.531 29.7423 160.837 28.5885L161.948 24.4106C162.714 21.5265 160.651 18.5122 157.341 17.6782ZM125.525 7.43468C125.831 6.28315 127.157 5.6168 128.478 5.94978L138.07 8.36594C139.391 8.69892 140.218 9.9074 139.912 11.0589L139.357 13.1479L124.97 9.52362L125.525 7.43468Z"
    fill="#E6E6E6"
  />
  <path
    d="M98.6798 34.2638C98.2253 34.263 97.8625 34.6107 97.8834 35.027L99.9152 75.467C100.103 79.2096 103.451 82.146 107.536 82.1526L146.222 82.2159C150.307 82.2226 153.665 79.2972 153.866 75.5551L156.037 35.122C156.06 34.7058 155.698 34.3569 155.243 34.3562L98.6798 34.2638ZM137.141 40.165C137.143 38.8747 138.285 37.8315 139.693 37.8338C141.1 37.8361 142.238 38.883 142.236 40.1733L142.183 70.5326C142.181 71.8229 141.039 72.8661 139.632 72.8638C138.225 72.8615 137.086 71.8145 137.089 70.5243L137.141 40.165ZM124.404 40.1441C124.406 38.8539 125.548 37.8107 126.956 37.813C128.363 37.8153 129.501 38.8622 129.499 40.1525L129.447 70.5118C129.444 71.802 128.303 72.8452 126.895 72.8429C125.488 72.8406 124.349 71.7937 124.352 70.5034L124.404 40.1441ZM111.667 40.1233C111.669 38.8331 112.811 37.7899 114.219 37.7922C115.626 37.7945 116.764 38.8414 116.762 40.1317L116.71 70.491C116.707 71.7812 115.566 72.8244 114.158 72.8221C112.751 72.8198 111.613 71.7729 111.615 70.4826L111.667 40.1233Z"
    fill="#E6E6E6"
  />
  <defs>
    <filter
      id="filter0_d_3075_9990"
      x="32.446"
      y="19.3057"
      width="72"
      height="50.9836"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_9990"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_9990"
        result="shape"
      />
    </filter>
  </defs>
</svg> `,Dpe=b`<svg
  width="204"
  height="66"
  viewBox="0 0 204 66"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_3075_2681)">
    <rect
      x="35.446"
      y="22.3057"
      width="66"
      height="44.9836"
      rx="2"
      fill="white"
      fill-opacity="0.08"
      shape-rendering="crispEdges"
    />
    <rect
      x="42.8223"
      y="28.7544"
      width="23.1"
      height="17.0581"
      rx="2"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="73.299"
      y="47.4768"
      width="23.1"
      height="11.4414"
      rx="2"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="43.987"
      y="51.8455"
      width="21.9353"
      height="2.49631"
      rx="1.24816"
      fill="white"
      fill-opacity="0.1"
    />
    <rect
      x="43.987"
      y="56.8379"
      width="15.7235"
      height="2.49631"
      rx="1.24816"
      fill="white"
      fill-opacity="0.1"
    />
    <path
      d="M67.6696 37.6997H80.7519C82.9611 37.6997 84.7519 39.4906 84.7519 41.6997V45.8127"
      stroke="white"
      stroke-opacity="0.3"
      stroke-linecap="round"
      stroke-dasharray="4 4"
    />
    <path
      d="M85.1761 33.2503C89.6228 30.1117 94.6177 26.8262 91.9036 31.4477C89.1895 36.0691 86.8182 42.9668 93.5876 37.7324"
      stroke="white"
      stroke-opacity="0.3"
      stroke-linecap="round"
    />
  </g>
  <path
    d="M157.341 17.6782L144.153 14.356L144.708 12.267C145.628 8.80589 143.153 5.18888 139.18 4.18806L129.588 1.77189C125.616 0.771072 121.65 2.76548 120.73 6.2266L120.175 8.31554L106.987 4.99332C103.676 4.15932 100.371 5.82139 99.6047 8.70557L98.4946 12.8835C98.188 14.0372 99.013 15.2428 100.337 15.5764L157.885 30.0734C159.209 30.407 160.531 29.7423 160.837 28.5885L161.948 24.4106C162.714 21.5265 160.651 18.5122 157.341 17.6782ZM125.525 7.43468C125.831 6.28315 127.157 5.6168 128.478 5.94978L138.07 8.36594C139.391 8.69892 140.218 9.9074 139.912 11.0589L139.357 13.1479L124.97 9.52362L125.525 7.43468Z"
    fill="#646464"
  />
  <path
    d="M98.6798 34.2638C98.2253 34.263 97.8625 34.6107 97.8834 35.027L99.9152 75.467C100.103 79.2096 103.451 82.146 107.536 82.1526L146.222 82.2159C150.307 82.2226 153.665 79.2972 153.866 75.5551L156.037 35.122C156.06 34.7058 155.698 34.3569 155.243 34.3562L98.6798 34.2638ZM137.141 40.165C137.143 38.8747 138.285 37.8315 139.693 37.8338C141.1 37.8361 142.238 38.883 142.236 40.1733L142.183 70.5326C142.181 71.8229 141.039 72.8661 139.632 72.8638C138.225 72.8615 137.086 71.8145 137.089 70.5243L137.141 40.165ZM124.404 40.1441C124.406 38.8539 125.548 37.8107 126.956 37.813C128.363 37.8153 129.501 38.8622 129.499 40.1525L129.447 70.5118C129.444 71.802 128.303 72.8452 126.895 72.8429C125.488 72.8406 124.349 71.7937 124.352 70.5034L124.404 40.1441ZM111.667 40.1233C111.669 38.8331 112.811 37.7899 114.219 37.7922C115.626 37.7945 116.764 38.8414 116.762 40.1317L116.71 70.491C116.707 71.7812 115.566 72.8244 114.158 72.8221C112.751 72.8198 111.613 71.7729 111.615 70.4826L111.667 40.1233Z"
    fill="#646464"
  />
  <defs>
    <filter
      id="filter0_d_3075_2681"
      x="32.446"
      y="19.3057"
      width="72"
      height="50.9836"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="1.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_2681"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_2681"
        result="shape"
      />
    </filter>
  </defs>
</svg> `,Ope=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_10039)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="white"
    />
    <g filter="url(#filter0_d_3075_10039)">
      <path
        d="M30 71C30 68.7909 31.7909 67 34 67H175C177.209 67 179 68.7909 179 71V170H30V71Z"
        fill="white"
      />
      <rect
        x="46.6523"
        y="81.7659"
        width="52.15"
        height="39.0585"
        rx="4"
        fill="#EEEEEE"
      />
      <rect x="115" y="125" width="53" height="30" rx="4" fill="#EEEEEE" />
      <rect
        x="49.282"
        y="134.638"
        width="49.5206"
        height="5.71587"
        rx="2.85793"
        fill="black"
        fill-opacity="0.1"
      />
      <rect
        x="49.282"
        y="146.07"
        width="35.4971"
        height="5.71587"
        rx="2.85793"
        fill="black"
        fill-opacity="0.1"
      />
      <path
        d="M102.747 102.248H135.312C138.625 102.248 141.312 104.934 141.312 108.248V120.824"
        stroke="black"
        stroke-opacity="0.3"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="bevel"
        stroke-dasharray="5 5"
      />
      <path
        d="M142.269 92.0603C152.308 84.8737 163.585 77.3509 157.457 87.9327C151.33 98.5146 145.977 114.308 161.259 102.323"
        stroke="black"
        stroke-opacity="0.3"
        stroke-width="2"
        stroke-linecap="round"
      />
    </g>
    <path
      d="M305.571 53.002L275.744 45.4883L276.999 40.7638C279.079 32.9359 273.482 24.7555 264.497 22.492L242.805 17.0275C233.819 14.7639 224.849 19.2746 222.77 27.1025L221.514 31.8269L191.688 24.3132C184.2 22.427 176.725 26.186 174.992 32.709L172.481 42.158C171.788 44.7674 173.653 47.4941 176.649 48.2486L306.801 81.0358C309.796 81.7903 312.786 80.2868 313.479 77.6774L315.99 68.2285C317.723 61.7055 313.058 54.8882 305.571 53.002ZM233.616 29.8347C234.308 27.2304 237.304 25.7233 240.294 26.4764L261.986 31.9409C264.975 32.694 266.846 35.4272 266.153 38.0315L264.898 42.756L232.36 34.5592L233.616 29.8347Z"
      fill="#E6E6E6"
    />
    <path
      d="M172.9 90.5127C171.872 90.511 171.051 91.2973 171.099 92.2389L175.694 183.7C176.119 192.165 183.69 198.806 192.93 198.821L280.423 198.964C289.663 198.979 297.258 192.363 297.712 183.9L302.623 92.4538C302.673 91.5125 301.855 90.7235 300.827 90.7218L172.9 90.5127ZM259.886 103.859C259.891 100.941 262.473 98.5817 265.657 98.5869C268.84 98.5921 271.414 100.96 271.409 103.878L271.29 172.54C271.285 175.458 268.703 177.818 265.52 177.813C262.337 177.807 259.763 175.44 259.768 172.521L259.886 103.859ZM231.08 103.812C231.085 100.894 233.667 98.5346 236.85 98.5398C240.033 98.545 242.607 100.913 242.602 103.831L242.484 172.493C242.479 175.411 239.896 177.771 236.713 177.766C233.53 177.76 230.956 175.393 230.961 172.474L231.08 103.812ZM202.273 103.765C202.278 100.847 204.86 98.4875 208.043 98.4927C211.226 98.4979 213.801 100.866 213.796 103.784L213.677 172.446C213.672 175.364 211.09 177.724 207.907 177.718C204.723 177.713 202.149 175.345 202.154 172.427L202.273 103.765Z"
      fill="#E6E6E6"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_3075_10039"
      x="26"
      y="63"
      width="157"
      height="111"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.14 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_10039"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_10039"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_10039">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Rpe=b`<svg
  width="340"
  height="170"
  viewBox="0 0 340 170"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3075_10071)">
    <path
      d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
      fill="#141414"
    />
    <g filter="url(#filter0_d_3075_10071)">
      <path
        d="M30 71C30 68.7909 31.7909 67 34 67H175C177.209 67 179 68.7909 179 71V170H30V71Z"
        fill="white"
        fill-opacity="0.06"
        shape-rendering="crispEdges"
      />
      <rect
        x="46.6523"
        y="81.7659"
        width="52.15"
        height="39.0585"
        rx="4"
        fill="#303030"
      />
      <rect x="115" y="125" width="53" height="30" rx="4" fill="#303030" />
      <rect
        x="49.282"
        y="134.638"
        width="49.5206"
        height="5.71587"
        rx="2.85793"
        fill="white"
        fill-opacity="0.1"
      />
      <rect
        x="49.282"
        y="146.07"
        width="35.4971"
        height="5.71587"
        rx="2.85793"
        fill="white"
        fill-opacity="0.1"
      />
      <path
        d="M102.747 102.248H135.312C138.625 102.248 141.312 104.934 141.312 108.248V120.824"
        stroke="white"
        stroke-opacity="0.3"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="bevel"
        stroke-dasharray="5 5"
      />
      <path
        d="M142.269 92.0603C152.308 84.8737 163.585 77.3509 157.457 87.9327C151.33 98.5146 145.977 114.308 161.259 102.323"
        stroke="white"
        stroke-opacity="0.3"
        stroke-width="2"
        stroke-linecap="round"
      />
    </g>
    <path
      d="M305.571 53.002L275.744 45.4883L276.999 40.7638C279.079 32.9359 273.482 24.7555 264.497 22.492L242.805 17.0275C233.819 14.7639 224.849 19.2746 222.77 27.1025L221.514 31.8269L191.688 24.3132C184.2 22.427 176.725 26.186 174.992 32.709L172.481 42.158C171.788 44.7674 173.653 47.4941 176.649 48.2486L306.801 81.0358C309.796 81.7903 312.786 80.2868 313.479 77.6774L315.99 68.2285C317.723 61.7055 313.058 54.8882 305.571 53.002ZM233.616 29.8347C234.308 27.2304 237.304 25.7233 240.294 26.4764L261.986 31.9409C264.975 32.694 266.846 35.4272 266.153 38.0315L264.898 42.756L232.36 34.5592L233.616 29.8347Z"
      fill="#313131"
    />
    <path
      d="M172.9 90.5127C171.872 90.511 171.051 91.2973 171.099 92.2389L175.694 183.7C176.119 192.165 183.69 198.806 192.93 198.821L280.423 198.964C289.663 198.979 297.258 192.363 297.712 183.9L302.623 92.4538C302.673 91.5125 301.855 90.7235 300.827 90.7218L172.9 90.5127ZM259.886 103.859C259.891 100.941 262.473 98.5817 265.657 98.5869C268.84 98.5921 271.414 100.96 271.409 103.878L271.29 172.54C271.285 175.458 268.703 177.818 265.52 177.813C262.337 177.807 259.763 175.44 259.768 172.521L259.886 103.859ZM231.08 103.812C231.085 100.894 233.667 98.5346 236.85 98.5398C240.033 98.545 242.607 100.913 242.602 103.831L242.484 172.493C242.479 175.411 239.896 177.771 236.713 177.766C233.53 177.76 230.956 175.393 230.961 172.474L231.08 103.812ZM202.273 103.765C202.278 100.847 204.86 98.4875 208.043 98.4927C211.226 98.4979 213.801 100.866 213.796 103.784L213.677 172.446C213.672 175.364 211.09 177.724 207.907 177.718C204.723 177.713 202.149 175.345 202.154 172.427L202.273 103.765Z"
      fill="#313131"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_3075_10071"
      x="26"
      y="63"
      width="157"
      height="111"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.24 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_3075_10071"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_3075_10071"
        result="shape"
      />
    </filter>
    <clipPath id="clip0_3075_10071">
      <path
        d="M0 4C0 1.79086 1.79086 0 4 0H336C338.209 0 340 1.79086 340 4V170H0V4Z"
        fill="white"
      />
    </clipPath>
  </defs>
</svg> `,Npe=(t,e)=>{const n=Wo(),i=e!=="vertical";return t==="page"?n==="light"?{LoadingIcon:n5,LinkedDocIcon:IC,LinkedDocDeletedIcon:jf,LinkedDocEmptyBanner:i?_pe:kpe,LinkedDocDeletedBanner:i?Spe:Ipe}:{LoadingIcon:i5,LinkedDocIcon:IC,LinkedDocDeletedIcon:jf,LinkedDocEmptyBanner:i?Cpe:Epe,LinkedDocDeletedBanner:i?Tpe:Lpe}:n==="light"?{LoadingIcon:n5,LinkedDocIcon:LC,LinkedDocDeletedIcon:jf,LinkedDocEmptyBanner:i?Mpe:Ape,LinkedDocDeletedBanner:i?Bpe:Ope}:{LoadingIcon:i5,LinkedDocIcon:LC,LinkedDocDeletedIcon:jf,LinkedDocEmptyBanner:i?Ppe:$pe,LinkedDocDeletedBanner:i?Dpe:Rpe}};var Hpe=Object.defineProperty,Fpe=Object.getOwnPropertyDescriptor,jc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Fpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Hpe(e,n,r),r};let Fo=class extends _u{constructor(){super(...arguments),this._cardStyle="horizontal",this._width=At.horizontal,this._height=bt.horizontal,this._loading=!1,this._abstractText="",this._isBannerEmpty=!1,this.showCaption=!1,this._pageMode="page",this._pageUpdatedAt=new Date,this.open=()=>{const t=this.model.pageId;if(t===this.model.page.id)return;const e=this.std.view.viewFromPath("block",[this.model.page.root?.id??""]);D(e),e.slots.pageLinkClicked.emit({pageId:t})},this.covertToInline=()=>{const{page:t,pageId:e}=this.model,n=t.getParent(this.model),i=n?.children.indexOf(this.model),r=new nt.Y.Text;r.insert(0,bd),r.format(0,bd.length,{reference:{type:"LinkedPage",pageId:e}});const o=new t.Text(r);t.addBlock("affine:paragraph",{text:o},n,i),t.deleteBlock(this.model)},this.refreshData=()=>{this._load()},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:b`
        <style>
          :host {
            z-index: 1;
          }
        </style>
        <embed-card-toolbar
          .model=${this.model}
          .block=${this}
          .host=${this.host}
          .abortController=${t}
          .std=${this.std}
        ></embed-card-toolbar>
      `,computePosition:{referenceElement:this,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}})}get _linkedDoc(){return this.std.workspace.getPage(this.model.pageId)}get _service(){const t=super.service;return D(t,"Linked page block must run with its service."),t}_load(){const t=this._linkedDoc;if(!t)return;const e=()=>{this._abstractText=this._getAbstractText(),this._prepareSurfaceRefRenderer()},n=()=>{t.root?(e(),this._loading=!1):t.slots.rootAdded.once(()=>{e(),this._loading=!1})};this._loading=!0,this._abstractText="",this._isBannerEmpty=!0;const{pageId:i}=this.model;this._pageMode=this._service.getPageMode(i),this._pageUpdatedAt=this._service.getPageUpdatedAt(i),t.loaded?n():t.load().then(()=>n()).catch(r=>{console.error(`An error occurred while loading page: ${this.model.pageId}`),console.error(r)})}_isPageEmpty(){const t=this._linkedDoc;return t?!!t&&!t.meta.title.length&&!this._abstractText.length:!1}_getNoteFromPage(){const t=this._linkedDoc;D(t,`Trying to load page ${this.model.pageId} in linked page block, but the page is not found.`);const e=t.root?.children.find(n=>Ie(n,["affine:note"]));return D(e,`Trying to get note block in page ${this.model.pageId}, but note not found.`),e}_prepareSurfaceRefRenderer(){const t=this.std.spec.getService("affine:surface-ref");D(t,"Surface ref service not found."),this._surfaceRefService=t,this._cleanUpSurfaceRefRenderer();const e=this._linkedDoc;D(e,`Trying to load page ${this.model.pageId} in linked page block, but the page is not found.`),this._surfaceRefRenderer=this._surfaceRefService.getRenderer(gt.id(this.path),e),this._surfaceRefRenderer.slots.mounted.on(async()=>{this._pageMode==="edgeless"?await this._renderEdgelessAbstract():await this._renderPageAbstract()}),this._surfaceRefRenderer.mount()}_cleanUpSurfaceRefRenderer(){this._surfaceRefRenderer&&this._surfaceRefService.removeRenderer(this._surfaceRefRenderer.id)}_getAbstractText(){const e=this._getNoteFromPage().children.find(n=>n.text!=null);return e?e.text.toString():""}async _addCover(t){const e=await this._bannerContainer;if(e){for(;e.firstChild;)e.removeChild(e.firstChild);t instanceof HTMLElement?e.appendChild(t):Qa(t,e)}}async _renderEdgelessAbstract(){const t=this._surfaceRefRenderer.surfaceRenderer,e=document.createElement("div");await this._addCover(e),t.attach(e);const n=Array.from(this._surfaceRefRenderer.surfaceModel?.elementModels??[]).map(r=>ne.deserialize(r.xywh)),i=U1(n);i?(t.onResize(),t.setViewportByBound(i)):this._isBannerEmpty=!0}async _renderPageAbstract(){const e=this._getNoteFromPage().children.find(n=>Ie(n,["affine:image","affine:surface-ref"]));switch(e?.flavour){case"affine:image":await this._renderImageAbstract(e);return;case"affine:surface-ref":await this._renderSurfaceRefAbstract(e);return}this._isBannerEmpty=!0}async _renderImageAbstract(t){const e=t.sourceId;if(!e)return;const i=await this.model.page.blob.get(e);if(!i)return;const r=URL.createObjectURL(i),o=document.createElement("img");o.src=r,await this._addCover(o),this._isBannerEmpty=!1}async _renderSurfaceRefAbstract(t){const e=t.reference;if(!e)return;const n=this._surfaceRefRenderer.getModel(e);if(!n)return;const i=this._surfaceRefRenderer.surfaceRenderer,r=document.createElement("div");await this._addCover(r),i.attach(r),i.onResize();const o=ne.fromXYWH(Wn(n.xywh));i.setViewportByBound(o),this._isBannerEmpty=!1}_selectBlock(){const t=this.host.selection,e=t.create("block",{path:this.path});t.setGroup("note",[e])}_handleClick(){this.isInSurface||this._selectBlock()}_handleDoubleClick(t){t.stopPropagation(),this.open()}updated(){const t=this._linkedDoc,{xywh:e,style:n}=this.model,i=ne.deserialize(e);t&&n==="horizontalThin"?(i.w=At.horizontal,i.h=bt.horizontal,this.page.withoutTransact(()=>{this.page.updateBlock(this.model,{xywh:i.serialize(),style:"horizontal"})})):!t&&n==="horizontal"&&(i.w=At.horizontalThin,i.h=bt.horizontalThin,this.page.withoutTransact(()=>{this.page.updateBlock(this.model,{xywh:i.serialize(),style:"horizontalThin"})}))}connectedCallback(){super.connectedCallback(),this.model.caption&&this.model.caption.length&&(this.showCaption=!0),this._load();const t=this._linkedDoc;if(t&&(this.disposables.add(t.workspace.meta.pageMetasUpdated.on(()=>this._load())),this.disposables.add(t.slots.blockUpdated.on(()=>this._load()))),this.model.propsUpdated.on(({key:e})=>{this.requestUpdate(),e==="pageId"&&this._load()}),this.isInSurface){const e=this.surface;D(e),this.disposables.add(this.model.propsUpdated.on(()=>{this.requestUpdate()}))}}disconnectedCallback(){super.disconnectedCallback(),this._cleanUpSurfaceRefRenderer()}renderBlock(){const t=this._linkedDoc,e=!t,n=this._loading,i=this._pageMode;this._cardStyle=this.model.style,this._width=At[this._cardStyle],this._height=bt[this._cardStyle];const r=this._isPageEmpty()&&this._isBannerEmpty,o=Qe({loading:n,deleted:e,empty:r,"banner-empty":this._isBannerEmpty,[this._cardStyle]:!0}),{LoadingIcon:s,LinkedDocIcon:a,LinkedDocDeletedIcon:l,LinkedDocDeletedBanner:c,LinkedDocEmptyBanner:d}=Npe(this._pageMode,this._cardStyle),u=n?s:e?l:a,h=n?"Loading...":e?`Deleted ${i}`:t?.meta.title.length?t.meta.title:"Untitled",p=n?"":e?"This linked page is deleted.":r?"Preview of the page will be displayed here.":this._abstractText,g=this._pageUpdatedAt.toLocaleTimeString(),f=e||r,v=e?c:d;return this.renderEmbed(()=>b`
        <div
          style=${we({position:"relative"})}
        >
          <div
            ${this.isInSurface?ae:$t(this._whenHover.setReference)}
            class="affine-embed-linked-doc-block${o}"
            @click=${this._handleClick}
            @dblclick=${this._handleDoubleClick}
          >
            <div class="affine-embed-linked-doc-content">
              <div class="affine-embed-linked-doc-content-title">
                <div class="affine-embed-linked-doc-content-title-icon">
                  ${u}
                </div>

                <div class="affine-embed-linked-doc-content-title-text">
                  ${h}
                </div>
              </div>

              <div class="affine-embed-linked-doc-content-description">
                ${p}
              </div>

              <div class="affine-embed-linked-doc-content-date">
                <span>Updated</span>

                <span>${g}</span>
              </div>
            </div>

            <div class="affine-embed-linked-doc-banner render"></div>

            ${f?b`<div class="affine-embed-linked-doc-banner default">
                  ${v}
                </div>`:ae}
          </div>

          <embed-card-caption
            .block=${this}
            .display=${this.showCaption}
            @blur=${()=>{this.model.caption||(this.showCaption=!1)}}
          ></embed-card-caption>

          ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
        </div>
      `)}};Fo.styles=xpe;jc([ie()],Fo.prototype,"_loading",2);jc([ie()],Fo.prototype,"_abstractText",2);jc([ie()],Fo.prototype,"_isBannerEmpty",2);jc([ie()],Fo.prototype,"showCaption",2);jc([he("embed-card-caption")],Fo.prototype,"captionElement",2);jc([iD(".affine-embed-linked-doc-banner.render")],Fo.prototype,"_bannerContainer",2);Fo=jc([W("affine-embed-linked-doc-block")],Fo);const h$=["vertical","horizontal","list","cube","horizontalThin"];class p$ extends Cu(Bn){}class f$ extends li{constructor(){super(...arguments),this.slots={linkedDocCreated:new Ve},this._getPageMode=e=>e.endsWith("edgeless")?"edgeless":"page",this._getPageUpdatedAt=()=>new Date}get getPageMode(){return this._getPageMode}set getPageMode(e){this._getPageMode=e}get getPageUpdatedAt(){return this._getPageUpdatedAt}set getPageUpdatedAt(e){this._getPageUpdatedAt=e}}const Upe={style:h$[1],pageId:"",caption:null},uy=ku({schema:{name:"linked-doc",version:1,toModel:()=>new p$,props:()=>Upe},view:{component:st`affine-embed-linked-doc-block`},service:f$}),hy=/(?:https?:\/\/)?(?:(?:www|m)\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w-_]+)/,py=["video"];class g$ extends Cu(Bn){}async function Vpe(t,e){const n=t.url,[i,r]=await Promise.all([e.query(n),zpe(n)]),o={...i,...r};if(o.creatorUrl){const s=await e.query(o.creatorUrl);o.creatorImage=s.image}return o}async function zpe(t){let e={};const n=`https://youtube.com/oembed?url=${t}&format=json`,i=await fetch(n).catch(()=>null);if(i&&i.ok){const r=await i.json(),{title:o,author_name:s,author_url:a}=r;e={title:o,creator:s,creatorUrl:a}}return e}async function jpe(t){t.loading=!0;const e=t.service?.queryUrlData;D(e);const n=await e(t.model),{image:i=null,title:r=null,description:o=null,creator:s=null,creatorUrl:a=null,creatorImage:l=null}=n;t.page.updateBlock(t.model,{image:i,title:r,description:o,creator:s,creatorUrl:a,creatorImage:l}),t.loading=!1}var Gpe=Object.defineProperty,Zpe=Object.getOwnPropertyDescriptor,Gc=(t,e,n,i)=>{for(var r=i>1?void 0:i?Zpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Gpe(e,n,r),r};let Uo=class extends _u{constructor(){super(...arguments),this._cardStyle="video",this.loading=!1,this._isSelected=!1,this._showOverlay=!0,this.showCaption=!1,this._isDragging=!1,this.open=()=>{let t=this.model.url;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank")},this.refreshData=()=>{jpe(this).catch(console.error)},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:b`
        <style>
          :host {
            z-index: 1;
          }
        </style>
        <embed-card-toolbar
          .model=${this.model}
          .block=${this}
          .host=${this.host}
          .abortController=${t}
          .std=${this.std}
        ></embed-card-toolbar>
      `,computePosition:{referenceElement:this._youtubeBlockEl,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}})}_selectBlock(){const t=this.host.selection,e=t.create("block",{path:this.path});t.setGroup("note",[e])}_handleClick(){this.isInSurface||this._selectBlock()}_handleDoubleClick(t){t.stopPropagation(),this.open()}connectedCallback(){if(super.connectedCallback(),this.model.caption&&this.model.caption.length&&(this.showCaption=!0),this.model.videoId||this.page.withoutTransact(()=>{const e=this.model.url.match(hy);if(e){const[,n]=e;this.page.updateBlock(this.model,{videoId:n})}}),!this.model.description&&!this.model.title&&this.page.withoutTransact(()=>{this.refreshData()}),this.disposables.add(this.model.propsUpdated.on(({key:t})=>{this.requestUpdate(),t==="url"&&this.refreshData()})),this.disposables.add(this.std.selection.slots.changed.on(t=>{this._isSelected=t.some(e=>gt.equals(e.path,this.path)),this._showOverlay=this._isDragging||!this._isSelected})),this.handleEvent("pointerMove",t=>{this._isDragging=t.get("pointerState").dragging,this._isDragging&&(this._showOverlay=!0)}),this.isInSurface){const t=this.surface;D(t),this.disposables.add(this.model.propsUpdated.on(()=>{this.requestUpdate()}))}}renderBlock(){const{image:t,title:e="YouTube",description:n,creator:i,creatorImage:r,videoId:o,style:s}=this.model;this._cardStyle=s,this._width=At[this._cardStyle],this._height=bt[this._cardStyle];const a=this.loading,{LoadingIcon:l,EmbedCardBannerIcon:c}=w0(),d=a?l:Ib,u=a?"Loading...":e,h=a?"":n,p=!a&&t?b`<object type="image/webp" data=${t}>
            ${c}
          </object>`:c,g=!a&&r?b`<object type="image/webp" data=${r}>
            ${c}
          </object>`:ae;return this.renderEmbed(()=>b`
        <div
          style=${we({position:"relative"})}
        >
          <div
            ${this.isInSurface?ae:$t(this._whenHover.setReference)}
            class=${Qe({"affine-embed-youtube-block":!0,loading:a,selected:this._isSelected})}
            @click=${this._handleClick}
            @dblclick=${this._handleDoubleClick}
          >
            <div class="affine-embed-youtube-video">
              ${o?b`
                    <div class="affine-embed-youtube-video-iframe-container">
                      <iframe
                        id="ytplayer"
                        type="text/html"
                        src=${`https://www.youtube.com/embed/${o}`}
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen
                      ></iframe>
                      <div
                        class=${Qe({"affine-embed-youtube-video-iframe-overlay":!0,hide:!this._showOverlay})}
                      ></div>
                    </div>
                  `:p}
            </div>
            <div class="affine-embed-youtube-content">
              <div class="affine-embed-youtube-content-header">
                <div class="affine-embed-youtube-content-title-icon">
                  ${d}
                </div>

                <div class="affine-embed-youtube-content-title-text">
                  ${u}
                </div>

                <div class="affine-embed-youtube-content-creator-image">
                  ${g}
                </div>

                <div class="affine-embed-youtube-content-creator-text">
                  ${i}
                </div>
              </div>

              <div class="affine-embed-youtube-content-description">
                ${h}
              </div>

              <div class="affine-embed-youtube-content-url" @click=${this.open}>
                <span>www.youtube.com</span>

                <div class="affine-embed-youtube-content-url-icon">
                  ${oo}
                </div>
              </div>
            </div>
          </div>

          <embed-card-caption
            .block=${this}
            .display=${this.showCaption}
            @blur=${()=>{this.model.caption||(this.showCaption=!1)}}
          ></embed-card-caption>

          ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
        </div>
      `)}};Uo.styles=vQ;Gc([L({attribute:!1})],Uo.prototype,"loading",2);Gc([ie()],Uo.prototype,"_isSelected",2);Gc([ie()],Uo.prototype,"_showOverlay",2);Gc([ie()],Uo.prototype,"showCaption",2);Gc([he(".affine-embed-youtube-block")],Uo.prototype,"_youtubeBlockEl",2);Gc([he("embed-card-caption")],Uo.prototype,"captionElement",2);Uo=Gc([W("affine-embed-youtube-block")],Uo);class Hp extends li{constructor(){super(...arguments),this.queryUrlData=e=>Vpe(e,Hp.linkPreviewer)}static{this.linkPreviewer=new ey}mounted(){super.mounted();const e=this.std.spec.getService("affine:page");D(e),e.registerEmbedBlockOptions({flavour:this.flavour,urlRegex:hy,styles:py,viewType:"embed"})}static{this.setLinkPreviewEndpoint=Hp.linkPreviewer.setEndpoint}}const Wpe={style:py[0],url:"",caption:null,image:null,title:null,description:null,creator:null,creatorUrl:null,creatorImage:null,videoId:null},fy=ku({schema:{name:"youtube",version:1,toModel:()=>new g$,props:()=>Wpe},view:{component:st`affine-embed-youtube-block`},service:Hp});class qpe extends tv{}function $i(t){return Math.ceil(t/HD)-1}function Gf(t){t.rotate&&(t=ks(t));const e=$i(t.x),n=$i(t.x+t.w),i=$i(t.y),r=$i(t.y+t.h);return[e,n,i,r]}function Ype(t){const e=t.elementBound,n=$i(e.x),i=$i(e.maxX),r=$i(e.y),o=$i(e.maxY);return[n,i,r,o]}function Xpe(t){if(!t.externalXYWH)return null;const e=ne.deserialize(t.externalXYWH),n=$i(e.x),i=$i(e.maxX),r=$i(e.y),o=$i(e.maxY);return[n,i,r,o]}class r7{constructor(){this._grids=new Map,this._elementToGrids=new Map,this._externalGrids=new Map,this._externalElementToGrids=new Map}_createGrid(e,n){const i=e+"|"+n,r=new Set;return this._grids.set(i,r),r}_createExternalGrid(e,n){const i=e+"|"+n,r=new Set;return this._externalGrids.set(i,r),r}_getGrid(e,n){const i=e+"|"+n;return this._grids.get(i)}_getExternalGrid(e,n){const i=e+"|"+n;return this._externalGrids.get(i)}get isEmpty(){return this._grids.size===0}_addToExternalGrids(e){const n=Xpe(e);if(!n){this._removeFromExternalGrids(e);return}const[i,r,o,s]=n,a=new Set;this._externalElementToGrids.set(e,a);for(let l=i;l<=r;l++)for(let c=o;c<=s;c++){let d=this._getExternalGrid(l,c);d||(d=this._createExternalGrid(l,c)),d.add(e),a.add(d)}}_removeFromExternalGrids(e){const n=this._externalElementToGrids.get(e);if(n)for(const i of n)i.delete(e)}update(e){this.remove(e),this.add(e)}add(e){this._addToExternalGrids(e);const[n,i,r,o]=Ype(e),s=new Set;this._elementToGrids.set(e,s);for(let a=n;a<=i;a++)for(let l=r;l<=o;l++){let c=this._getGrid(a,l);c||(c=this._createGrid(a,l)),c.add(e),s.add(c)}}remove(e){const n=this._elementToGrids.get(e);if(n)for(const i of n)i.delete(e);this._removeFromExternalGrids(e)}boundHasChanged(e,n){const[i,r,o,s]=Gf(e),[a,l,c,d]=Gf(n);return i!==a||r!==l||o!==c||s!==d}_searchExternal(e,n=!1){const[i,r,o,s]=Gf(e),a=new Set,l=ne.from(e);for(let c=i;c<=r;c++)for(let d=o;d<=s;d++){const u=this._getExternalGrid(c,d);if(u)for(const h of u){const p=h.externalBound;p&&(n?l.contains(p):x7(p,e))&&a.add(h)}}return a}search(e,n=!1){const i=this._searchExternal(e,n),[r,o,s,a]=Gf(e),l=ne.from(e);for(let d=r;d<=o;d++)for(let u=s;u<=a;u++){const h=this._getGrid(d,u);if(h)for(const p of h)(n?l.contains(p.elementBound):x7(p.elementBound,e))&&i.add(p)}return Array.from(i).sort(ei)}pick(e,n){const i=$i(e),r=$i(n),o=this._getGrid(i,r);if(!o)return[];const s=[];for(const a of o)wD(ks(ne.deserialize(a.xywh)),e,n)&&s.push(a);return s}}class fi{constructor(e){this._disposables=new dt,this.slots={layerUpdated:new Ve},this.blocksGrid=new r7,this.framesGrid=new r7,this.canvasGrid=new r7,e&&this._init(e)}static{this.INITAL_INDEX="a0"}static create(e,n){const i=new fi(e.getBlocks().filter(r=>r instanceof Nl&&D6(e,n,r)).concat(n.elementModels));return i.listen(e,n),i}listen(e,n){this._disposables.add(e.slots.blockUpdated.on(i=>{if(i.type==="add"){const r=e.getBlockById(i.id);r instanceof Nl&&D6(e,n,r)&&this.add(r)}if(i.type==="update"){const r=e.getBlockById(i.id);(i.props.key==="index"||i.props.key==="xywh"&&r instanceof Nl&&D6(e,n,r))&&this.update(r,{[i.props.key]:!0})}if(i.type==="delete"){const r=i.model;r instanceof Nl&&this.delete(r)}})),this._disposables.add(n.elementAdded.on(i=>this.add(n.getElementById(i.id)))),this._disposables.add(n.elementUpdated.on(i=>{(i.props.index||i.props.xywh||i.props.externalXYWH)&&this.update(n.getElementById(i.id),i.props)})),this._disposables.add(n.elementRemoved.on(i=>this.delete(i.model)))}_init(e){this.canvasElements=[],this.blocks=[],this.frames=[],e.forEach(n=>{n instanceof Ni?(this.canvasElements.push(n),this.canvasGrid.add(n)):Ie(n,["affine:frame"])?(this.framesGrid.add(n),this.frames.push(n)):(this.blocksGrid.add(n),this.blocks.push(n))}),this.canvasElements.sort(ei),this.frames.sort(ei),this.blocks.sort(ei),this._initLayers(),this._buildCanvasLayers()}_initLayers(){let e=0,n=0;const i=[];let r,o=1;const s=()=>{r&&(r.indexes=[os(r.elements[0]),os(pi(r.elements))],r.zIndexes=r.type==="block"?[o,o+r.elements.length]:o,i.push(r),o+=r.type==="block"?r.elements.length+1:1)},a=l=>{s(),r=l==="canvas"?{type:l,indexes:[fi.INITAL_INDEX,fi.INITAL_INDEX],zIndexes:0,set:new Set,elements:[],bound:new ne}:{type:l,indexes:[fi.INITAL_INDEX,fi.INITAL_INDEX],zIndexes:[0,0],set:new Set,elements:[]}};for(;e<this.blocks.length||n<this.canvasElements.length;){const l=this.blocks[e],c=this.canvasElements[n];if(!l&&!c)break;if(!l){r?.type!=="canvas"&&a("canvas");const u=this.canvasElements.slice(n);r.elements=r.elements.concat(u),u.forEach(h=>r.set.add(h));break}if(!c){r?.type!=="block"&&a("block");const u=this.blocks.slice(e);r.elements=r.elements.concat(u),u.forEach(h=>r.set.add(h));break}switch(ei(l,c)){case-1:r?.type!=="block"&&a("block"),r.set.add(l),r.elements.push(l),++e;break;case 1:r?.type!=="canvas"&&a("canvas"),r.set.add(c),r.elements.push(c),++n;break;case 0:r||a("block"),r.type==="block"?(r.set.add(l),r.elements.push(l),++e):(r.set.add(c),r.elements.push(c),++n);break}}r&&r.elements.length&&s(),this.layers=i}_insertIntoLayer(e,n){if(this.layers.length===0){this._initLayers();return}const i=this.layers;let r=i.length-1;const o=(a,l,c)=>{c==="tail"?a.elements.push(l):a.elements.splice(c,0,l),a.set.add(l),(c==="tail"||c===0||c===a.elements.length-1)&&(a.indexes=[os(a.elements[0]),os(pi(a.elements))])},s=(a,l,c)=>({type:a,set:new Set(l),indexes:[os(l[0]),os(pi(l))],zIndexes:a==="block"?[c+1,c+l.length]:c+1,elements:l});if(ei(e,pi(pi(this.layers).elements))>0){const a=pi(this.layers);a?.type===n?(o(a,e,"tail"),rs(i,r)):this.layers.push(s(n,[e],gne(i,i.length-1)))}else for(;r>-1;){const a=i[r],l=a.elements;if(mne([l[0],pi(l)],e)){const c=l.findIndex((d,u)=>{const h=l[u-1];return ei(e,l[u])<0&&(!h||ei(e,h)>=0)});if(a.type===n)o(a,e,c),rs(i,r);else{const d=a.elements.splice(c);a.set=new Set(a.elements),i.splice(r+1,0,s(a.type,d,1)),i.splice(r+1,0,s(n,[e],1)),rs(i,r)}break}else{const c=i[r-1];if(!c||ei(e,pi(c.elements))>=0){a.type===n?(o(a,e,0),rs(i,r)):c?(o(c,e,"tail"),rs(i,r-1)):(i.unshift(s(n,[e],1)),rs(i,0));break}}--r}}_removeFromLayer(e,n){const i=this.layers,r=i.findIndex(s=>s.type!==n?!1:s.set.has(e)?(s.set.delete(e),s.elements.indexOf(e)!==-1&&(s.elements.splice(s.elements.indexOf(e),1),s.elements.length&&(s.indexes=[os(s.elements[0]),os(pi(s.elements))])),!0):!1);if(r===-1)return;const o=r===0||r===i.length-1;if(i[r].set.size===0){if(o)i.splice(r,1),i[r]&&rs(i,r);else{const s=i[r-1],a=i[r+1];s.elements=s.elements.concat(a.elements),s.set=new Set(s.elements),i.splice(r,2),rs(i,r-1)}return}rs(i,r)}_buildCanvasLayers(){const e=this.layers.filter(n=>n.type==="canvas").map(n=>({set:n.set,elements:n.elements,zIndexes:n.zIndexes,indexes:n.indexes}));(!e.length||pi(this.layers)?.type!=="canvas")&&e.push({set:new Set,elements:[],zIndexes:0,indexes:[fi.INITAL_INDEX,fi.INITAL_INDEX]}),this.canvasLayers=e}_updateLayer(e,n){let i;const r="type"in e?e.type:e.flavour,o=!n||"index"in n,s=(a,l)=>{o&&(Pf(a,l),Mf(a,l))};return r.startsWith("affine:")?Ie(e,["affine:frame"])?(s(this.frames,e),this.framesGrid.update(e)):(i="block",s(this.blocks,e),this.blocksGrid.update(e)):(i="canvas",s(this.canvasElements,e),this.canvasGrid.update(e),r==="group"&&o&&e.childElements.forEach(a=>a&&this._updateLayer(a))),i&&o?(this._removeFromLayer(e,i),this._insertIntoLayer(e,i),!0):!1}add(e){let n;const i="type"in e?e.type:e.flavour;i.startsWith("affine:")?Ie(e,["affine:frame"])?(Mf(this.frames,e),this.framesGrid.add(e)):(n="block",Mf(this.blocks,e),this.blocksGrid.add(e)):(n="canvas",Mf(this.canvasElements,e),this.canvasGrid.add(e),i==="group"&&e.childElements.forEach(r=>r&&this._updateLayer(r))),n&&(this._insertIntoLayer(e,n),this._buildCanvasLayers(),this.slots.layerUpdated.emit())}delete(e){let n;e instanceof Ni?(n="canvas",Pf(this.canvasElements,e),this.canvasGrid.remove(e)):Ie(e,["affine:frame"])?(Pf(this.frames,e),this.framesGrid.remove(e)):(n="block",Pf(this.blocks,e),this.blocksGrid.remove(e)),n&&(this._removeFromLayer(e,n),this._buildCanvasLayers(),this.slots.layerUpdated.emit())}update(e,n){this._updateLayer(e,n)&&(this._buildCanvasLayers(),this.slots.layerUpdated.emit())}getCanvasLayers(){return this.canvasLayers}generateIndex(e){const n=e==="affine:frame"?"frame":"common",i=e.startsWith("affine:")?"block":"canvas";if(n==="frame"){const r=pi(this.frames);return r?ds(B6(os(r)),null):fi.INITAL_INDEX}else{if(i==="canvas"){const o=pi(this.layers)?.indexes[1];return o?ds(B6(o),null):fi.INITAL_INDEX}const r=pi(this.layers);if(!r)return fi.INITAL_INDEX;if(r.type==="canvas"){const o=gD(this.layers,2),s=o?B6(o.indexes[1]):null;return ds(s,s&&s>=r.indexes[0]?null:r.indexes[0])}return ds(r.indexes[1],null)}}createIndexGenerator(e=!1){const n=new fi;return n.frames=[...this.frames],n.blocks=[...this.blocks],n.canvasElements=[...this.canvasElements],n.layers=this.layers.map(i=>({...i,set:new Set(i.set),elements:[...i.elements]})),n._buildCanvasLayers(),i=>{e&&i!=="affine:frame"&&(i="shape");const r=n.generateIndex(i),o=new ne(0,0,10,10);i==="group"&&(i="shape");const s={index:r,flavour:i,x:0,y:0,w:10,h:10,elementBound:o,xywh:"[0, 0, 10, 10]",group:()=>null,groups:()=>[]};return n.add(s),r}}getReorderedIndex(e,n){const i=e.group,r=e.flavour==="affine:frame";let o;i!==null?(o=i.childElements.filter(a=>a?.flavour==="affine:frame"===r),o.sort(ei)):r?o=this.frames:o=this.layers.reduce((a,l)=>a.concat(l.elements.filter(c=>c.group==null)),[]);const s=o.indexOf(e);switch(n){case"forward":case"front":if(s===-1||s===o.length-1)return e.index;{const a=n==="forward"?o[s+1]:o[o.length-1],l=n==="forward"?o[s+2]:null;return ds(a.index,l?.index&&a.index<l.index?l.index:null)}case"backward":case"back":if(s===-1||s===0)return e.index;{const a=n==="backward"?o[s-1]:o[0],l=n==="backward"?o[s-2]:null;return ds(l?.index??null,a.index)}}}compare(e,n){return ei(e,n)}dispose(){this.slots.layerUpdated.dispose(),this._disposables.dispose()}}class Kpe{constructor(e){this.disposable=new dt,this.slots={updated:new Ve,remoteUpdated:new Ve,cursorUpdated:new Ve,remoteCursorUpdated:new Ve},this.lastState=[],this.selections=[],this.cursor=null,this.remoteCursor=new Map,this.remoteSelection=new Map,this._activeGroup=null,this._selected=new Set,this._selectedIds=[],this._remoteSelected=new Set,this.service=e,this.surfaceModel=e.surface,this.mount()}get empty(){return this.selections.length===0||this.selections.every(e=>e.elements.length===0)}get activeGroup(){return this._activeGroup}get editing(){return this.selections.some(e=>e.editing)}get selectedIds(){return this._selectedIds}get elements(){const e=[];return this._selectedIds.forEach(n=>{const i=this.service.getElementById(n);i&&e.push(i)}),e}get firstElement(){return this.elements[0]}get selectedBound(){return Mo(this.elements)}get _selection(){return this.service.std.selection}_setState(e){this.lastState=this.selections,this.selections=e,this._selected=new Set,this._selectedIds=[],e.forEach(n=>n.elements.forEach(i=>{this._selected.add(i),this._selectedIds.push(i)}))}_setCursor(e){this.cursor=e}isEmpty(e){return e.length===0||e.every(n=>n.elements.length===0)}equals(e){let n=0,i=!1;return e.every(o=>{const s=o.elements.every(a=>this._selected.has(a));return s&&(n+=o.elements.length),o.editing&&(i=!0),s})&&n===this._selected.size&&i===this.editing}mount(){this.disposable.add(this._selection.slots.changed.on(e=>{const{cursor:n=[],surface:i=[]}=F1(e,r=>r.is("surface")?"surface":r.is("cursor")?"cursor":"none");n[0]&&!this.cursor?.equals(n[0])&&(this._setCursor(n[0]),this.slots.cursorUpdated.emit(n[0])),!(i.length===0&&this.empty||this.equals(i))&&(this._setState(i),this.slots.updated.emit(this.selections))})),this.disposable.add(this._selection.slots.remoteChanged.on(e=>{const n=new Map,i=new Map,r=new Set;e.forEach((o,s)=>{let a=!1,l=!1;o.forEach(c=>{c.is("text")&&(a=!0),c.is("block")&&(l=!0),c.is("surface")&&(n.set(s,c),c.elements.forEach(d=>r.add(d))),c.is("cursor")&&i.set(s,c)}),(l||a)&&n.delete(s),a&&i.delete(s)}),this.remoteCursor=i,this.remoteSelection=n,this._remoteSelected=r,this.slots.remoteUpdated.emit(),this.slots.remoteCursorUpdated.emit()}))}hasRemote(e){return this._remoteSelected.has(e)}has(e){return this._selected.has(e)}set(e){if(Array.isArray(e)){this._selection.setGroup("edgeless",this.cursor?[...e,this.cursor]:e);return}const{blocks:n=[],elements:i=[]}=F1(e.elements,o=>this.service.page.getBlockById(o)?"blocks":"elements");let r=[];i.length>0&&r.push(this._selection.create("surface",[this.service.page.root.id,this.surfaceModel.id],i,e.editing)),n.length>0&&(r=r.concat(n.map(o=>this._selection.create("surface",[this.service.page.root.id,o],[o],e.editing)))),this.cursor&&r.push(this.cursor),this._selection.setGroup("edgeless",r),e.elements.length===1&&this.firstElement instanceof On?this._activeGroup=this.firstElement:(this.elements.some(o=>o.group!==this._activeGroup)||this.elements.length===0)&&(this._activeGroup=null)}setCursor(e){const n=this._selection.create("cursor",e.x,e.y);this._selection.setGroup("edgeless",[...this.selections,n])}clear(){this._selection.clear(),this.set({elements:[],editing:!1})}dispose(){this.disposable.dispose()}}class Qpe extends tv{mounted(){if(super.mounted(),this._surface=this.page.getBlockByFlavour("affine:surface")[0],!this._surface)throw new Error("surface block not found");this._layer=fi.create(this.page,this._surface),this._viewport=new E9,this._selection=new Kpe(this)}unmounted(){super.unmounted(),this._layer.dispose(),this._selection.dispose(),this.selectionManager.set([]),this.viewport.dispose()}get surface(){return this._surface}get layer(){return this._layer}get selection(){return this._selection}get viewport(){return this._viewport}get elements(){return this._layer.canvasElements}get frames(){return this._layer.frames}get blocks(){return this.frames.concat(this._layer.blocks)}generateIndex(e){return this._layer.generateIndex(e)}addElement(e,n){return n.index=this.generateIndex(e),n.type=e,this.editSession.apply(e,n),this._surface.addElement(n)}addBlock(e,n,i,r){return n.index=this.generateIndex(e),this.editSession.apply(e,n),this.page.addBlock(e,n,i,r)}getElementsByType(e){return this.surface.getElementsByType(e)}updateElement(e,n){if(this._surface.getElementById(e)){const i=this._surface.getElementById(e);this.editSession.record(i.type,n),this._surface.updateElement(e,n)}else if(this.page.getBlockById(e)){const i=this.page.getBlockById(e);this.editSession.record(i.flavour,n),this.page.updateBlock(i,n)}}removeElement(e){if(e=typeof e=="string"?e:e.id,this._surface.getElementById(e))this._surface.removeElement(e);else if(this.page.getBlockById(e)){const n=this.page.getBlockById(e);this.page.deleteBlock(n)}}getElementById(e){return this._surface.getElementById(e)??this.page.getBlockById(e)}pickElement(e,n,i={all:!1,expand:10}){i.expand??=10,i.zoom=this._viewport.zoom;const r={x:e-i.expand/2,y:n-i.expand/2,w:i.expand,h:i.expand},o=()=>this._layer.canvasGrid.search(r).filter(u=>u.hitTest(e,n,i)||u.externalBound?.isPointInBound([e,n])),s=()=>this._layer.blocksGrid.search(r).filter(u=>u.hitTest(e,n,i)||u.externalBound?.isPointInBound([e,n])),a=()=>this._layer.frames.filter(c=>c.hitTest(e,n,i)||c.externalBound?.isPointInBound([e,n]));let l=o().concat(s());return l.sort(this._layer.compare),(i.all||l.length===0)&&(l=a().concat(l)),i.all?l:pi(l)??null}pickElementsByBound(e,n="all"){e=new ne(e.x,e.y,e.w,e.h);const i=()=>this._layer.canvasGrid.search(e).filter(l=>l.boxSelect(e)),r=()=>this._layer.blocksGrid.search(e).filter(l=>l.boxSelect(e)),o=()=>this._layer.framesGrid.search(e).filter(a=>a.boxSelect(e));switch(n){case"canvas":return i();case"blocks":return o().concat(r());case"frame":return o();case"all":{const s=i().concat(r());return s.sort(this._layer.compare),o().concat(s)}}}pickElementInGroup(e,n,i){const r=this._selection,o=this.pickElement(e,n,{...i,all:!0});let s=pi(o)??null;const{activeGroup:a}=r,l=s;if(a&&s&&a.hasDescendant(s.id)){let c=o.length-1;for(;s===a||s instanceof On&&s.hasDescendant(a);)s=o[--c]}else if(s){let c=o.length-1;for(;s.group!==null;){if(--c<0){s=null;break}s=o[c]}}return s??l}reorderElement(e,n){const i=this._layer.getReorderedIndex(e,n);e.index=i}createGroup(e){const n=this.elements.filter(r=>r.type==="group");return this._surface.addElement({type:"group",children:e.reduce((r,o)=>{const s=typeof o=="string"?o:o.id;return r[s]=!0,r},{}),title:`Group ${n.length+1}`})}createGroupFromSelected(){const{selection:e}=this;if(e.elements.length<=0||!e.elements.every(r=>r.group===e.firstElement.group))return;const n=e.firstElement.group;n!==null&&e.elements.forEach(r=>{n.removeChild(r.id)});const i=this.createGroup(e.elements);return n!==null&&n.addChild(i),e.set({editing:!1,elements:[i]}),i}ungroup(e){const{selection:n}=this,i=e.childElements,r=e.group;r!==null&&r.removeChild(e.id),i.forEach(o=>{const s=o.type||o.flavour;o.index=this.generateIndex(s)}),this.removeElement(e.id),r!==null&&i.forEach(o=>{r.addChild(o.id)}),n.set({editing:!1,elements:i.map(o=>o.id)})}getConnectors(e){const n=typeof e=="string"?e:e.id;return this.surface.getConnectors(n)}}class Jpe extends li{mounted(){if(super.mounted(),this.surface=this.page.getBlockByFlavour("affine:surface")[0],this.surface)this.layer=fi.create(this.page,this.surface);else{const e=this.page.slots.blockUpdated.on(n=>{n.flavour==="affine:surface"&&(e.dispose(),this.surface=this.page.getBlockById(n.id),this.layer=fi.create(this.page,this.surface))})}}unmounted(){this.layer?.dispose()}}const MC=["affine:surface","affine:surface-ref"],PC=["affine:surface","affine:page"],e0e=["template","sticker"];class J5{constructor({model:e,type:n,middlewares:i}){this._template=null,this.slots={beforeInsert:new Ve},this.job=new ar({workspace:e.page.workspace,middlewares:[]}),this.model=e,this.type=e0e.includes(n)?n:"template",i.forEach(r=>r(this)),J5.middlewares.forEach(r=>r(this))}static create(e){return new J5(e)}static{this.middlewares=[]}walk(e){if(!this._template)throw new Error("Template not loaded, please call insertTemplate first");const n=(i,r)=>{e(i,r),i.children&&i.children.forEach(o=>n(o,r))};n(this._template.blocks,this._template)}_mergeSurfaceElements(e,n){const r=this.model.page.workspace.schema.flavourSchemaMap.get("affine:surface")?.transformer?.();this.model.page.transact(()=>{const o=[];Object.entries(e).forEach(([s,a])=>{["connector","group"].includes(a.type)?o.push([s,a]):n.set(s,r.elementFromJSON(a))}),o.forEach(([s,a])=>{n.set(s,r.elementFromJSON(a))})})}_mergeProps(e,n){switch(e.flavour){case"affine:page":break;case"affine:surface":this._mergeSurfaceElements(e.props.elements,n.elements.getValue());break}}_getMergeBlockId(e){switch(e.flavour){case"affine:page":return this.model.page.root.id;case"affine:surface":return this.model.id}}_getTemplateBound(){const e=[];return this.walk(n=>{if(n.props.xywh&&e.push(ne.deserialize(n.props.xywh)),n.flavour==="affine:surface"){const i=["connector","group"];Object.entries(n.props.elements).forEach(([r,o])=>{const s=o.type;o.xywh&&!i.includes(s)&&e.push(ne.deserialize(o.xywh)),s==="connector"&&["target","source"].forEach(a=>{const l=o[a];if(l.id||!l.position)return;const c=l.position;c&&e.push(new ne(c[0],c[1],0,0))})})}}),U1(e)}async _jsonToModelData(e){const n=this.job,i=[],r=[],o=async(s,a,l,c=!0)=>{if(c&&MC.includes(s.flavour)){i.push({snapshot:s,parent:a,index:l});return}const d={blockJson:s,parent:a,index:l};this.slots.beforeInsert.emit({type:"block",data:d});const u=PC.includes(s.flavour)?null:await n.snapshotToModelData(s);if(r.push({flavour:s.flavour,json:s,modelData:u,parent:a,index:l}),s.children){let h=0;for(const p of s.children)await o(p,s.id,h),++h}};await o(e);for(const s of i)await o(s.snapshot,s.parent,s.index,!1);return r}async _insertToPage(e){const n=this.model.page,i=new Map,r=[],o=(s,a=!0)=>{const{flavour:l,json:c,modelData:d,parent:u,index:h}=s,p=PC.includes(l);if(p&&i.set(c.id,this._getMergeBlockId(c)),a&&MC.includes(l)){r.push(s);return}else{if(p){this._mergeProps(c,this.model.page.getBlockById(this._getMergeBlockId(c)));return}D(d),n.addBlock(d.flavour,{...d.props,id:d.id},u?i.get(u)??u:void 0,h)}};e.forEach(s=>o(s)),r.forEach(s=>o(s,!1))}async insertTemplate(e){zB.parse(e),this._template=e;const n=this._getTemplateBound();this.slots.beforeInsert.emit({type:"template",template:e,bound:n});const i=await this._jsonToModelData(e.blocks);return this._insertToPage(i).catch(console.error),n}}class m$ extends li{constructor(){super(...arguments),this.TemplateJob=J5}mounted(){super.mounted();const e=this.page.getBlockByFlavour("affine:surface")[0];D(e,"surface block not found")}get _surfaceView(){const[e]=this.page.getBlockByFlavour("affine:surface");return this.std.view.viewFromPath("block",qn(e))}get currentTool(){const e=this._surfaceView;if(!e)return null;const{edgeless:n}=e;return n.edgelessTool}setNavigatorMode(e,n){const i=this._surfaceView;if(!i)return;const{edgeless:r}=i;e&&r.edgelessTool.type==="frameNavigator"||!e&&r.edgelessTool.type!=="frameNavigator"||(e?r.tools.setEdgelessTool({type:"frameNavigator",mode:n}):r.tools.setEdgelessTool({type:"default"}))}}const t0e={schema:V3,service:qpe,view:{component:st`affine-doc-page`,widgets:{[gp]:st`${zn(gp)}`,[mp]:st`${zn(mp)}`,[pp]:st`${zn(pp)}`,[$8]:st`${zn($8)}`,[wr]:st`${zn(wr)}`,[Ra]:st`${zn(Ra)}`,[ap]:st`${zn(ap)}`}}},n0e={schema:V3,service:Qpe,view:{component:st`affine-edgeless-page`,widgets:{[gp]:st`${zn(gp)}`,[mp]:st`${zn(mp)}`,[pp]:st`${zn(pp)}`,[wr]:st`${zn(wr)}`,[Ra]:st`${zn(Ra)}`,[ap]:st`${zn(ap)}`,[B8]:st`${zn(B8)}`}}},b$=[{schema:wv,view:{component:st`affine-list`},service:WP},{schema:S1,service:BP,view:{component:st`affine-note`}},{schema:w4,service:t$,view:{component:st`affine-database`}},{schema:ry,view:{component:st`affine-data-view`}},{schema:_v,view:{component:st`affine-divider`}},{schema:iy,view:{component:st`affine-code`}},{schema:I1,service:hd,view:{component:st`affine-image`,widgets:{imageToolbar:st`affine-image-toolbar-widget`}}},{schema:mv,view:{component:st`affine-paragraph`},service:VP},{schema:T1,view:{component:st`affine-bookmark`},service:Dp},{schema:q3,view:{component:st`affine-attachment`},service:hv},sy,fy,cy,Np,uy],E4=[t0e,...b$,{schema:a3,view:{component:st`affine-surface`},service:Jpe},{schema:Q3,service:pv,view:{component:st`affine-surface-ref`,widgets:{surfaceToolbar:st`affine-surface-ref-toolbar`}}}],gy=[n0e,...b$,{schema:a3,view:{component:st`affine-surface`},service:m$},{schema:xv,view:{component:st`affine-frame`}},{schema:Q3,service:pv,view:{component:st`affine-edgeless-surface-ref`}}],o7=10*1024*1024,eg=[{name:"image",check:t=>t.page.schema.flavourSchemaMap.has("affine:image")&&t.type.startsWith("image/"),action:t=>Coe(t)},{name:"pdf",check:t=>t.type==="application/pdf"&&t.size<=o7,template:(t,e)=>b`<iframe
        style="width: 100%; color-scheme: auto;"
        height="480"
        src=${e+"#toolbar=0"}
        loading="lazy"
        scrolling="no"
        frameborder="no"
        allowTransparency
        allowfullscreen
      ></iframe>`},{name:"video",check:t=>t.type.startsWith("video/")&&t.size<=o7,template:(t,e)=>b`<video width="100%;" height="480" controls src=${e}></video>`},{name:"audio",check:t=>t.type.startsWith("audio/")&&t.size<=o7,template:(t,e)=>b`<audio controls src=${e} style="margin: 4px;"></audio>`}];function v$(t){return eg.some(e=>e.check(t))}function i0e(t){const e=eg.find(n=>n.check(t));if(!e||!e.action){t.page.updateBlock(t,{embed:!0});return}e.action(t)?.catch(console.error)}function r0e(t,e){const n=eg.find(i=>i.check(t));return!n||!n.template?(console.error("No embed view template found!",t,eg),null):n.template(t,e)}const o0e=X`
  .affine-attachment-rename-container {
    position: relative;
    display: flex;
    align-items: center;
    gap: 12px;
    width: 340px;

    font-family: ${Je(vt.fontSansFamily)};
    color: var(--affine-text-primary-color);
    border-radius: 8px;
    padding: 12px;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    z-index: var(--affine-z-index-popover);
  }

  .affine-attachment-rename-input-wrapper {
    flex: 1;
    display: flex;
    align-items: center;
    padding: 4px 10px;
    gap: 8px;

    border-radius: 8px;
    border: var(--affine-border-color) solid 1px;
  }

  .affine-attachment-rename-input-wrapper input {
    width: 100%;
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
  }

  .affine-attachment-rename-extension {
    font-size: var(--affine-font-xs);
    color: var(--affine-text-secondary-color);
  }

  .affine-attachment-rename-overlay-mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: var(--affine-z-index-popover);
  }
`,s0e=X`
  .affine-attachment-options-more {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--affine-text-primary-color);

    border-radius: 8px;
    padding: 8px;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
  }

  .affine-attachment-options-more icon-button {
    display: flex;
    align-items: center;
    padding: 8px;
    gap: 8px;
  }
  .affine-attachment-options-more icon-button[hidden] {
    display: none;
  }

  .affine-attachment-options-more icon-button:hover.danger {
    background: var(--affine-background-error-color);
    color: var(--affine-error-color);
  }
  .affine-attachment-options-more icon-button:hover.danger > svg {
    color: var(--affine-error-color);
  }
`,a0e=X`
  :host {
    z-index: 1;
  }

  .affine-attachment-options {
    display: flex;
    align-items: center;
    padding: 4px 8px;
    gap: 4px;
    border-radius: 8px;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
  }

  .affine-attachment-options .divider {
    width: 1px;
    margin: 0 1.5px;
    height: 24px;
    background-color: var(--affine-border-color);
  }

  .affine-attachment-options > div[hidden],
  icon-button[hidden] {
    display: none;
  }
`,l0e=({ref:t,model:e,downloadAttachment:n,abortController:i})=>{const r=e.page.readonly;return b`<style>
      ${s0e}
    </style>
    <div ${$t(t)} class="affine-attachment-options-more">
      <icon-button
        width="126px"
        height="32px"
        text="Download"
        @click="${()=>n(e)}"
      >
        ${g3}
      </icon-button>
      <icon-button
        width="126px"
        height="32px"
        text="Duplicate"
        ?hidden=${r}
        @click="${()=>{const o={flavour:"affine:attachment",...xoe(e)};e.page.addSiblingBlocks(e,[o])}}"
      >
        ${il}
      </icon-button>
      <icon-button
        width="126px"
        height="32px"
        text="Delete"
        class="danger"
        ?hidden=${r}
        @click="${()=>{e.page.deleteBlock(e),i.abort()}}"
      >
        ${xn}
      </icon-button>
    </div>`},c0e=({editorHost:t,model:e,abortController:n})=>{const i=Ri();setTimeout(()=>i.value?.focus());const r=e.name,o=r.slice(0,r.lastIndexOf(".")),s=r.slice(r.lastIndexOf(".")),a=s.includes(".")&&s.length<=7&&r.length>s.length;let l=a?o:r;const c=a?s:"",d=()=>{const p=l+c;if(!p){kt(t,"File name cannot be empty");return}e.page.updateBlock(e,{name:p}),n.abort()},u=p=>{l=p.target.value},h=p=>{if(p.stopPropagation(),p.key==="Escape"&&!p.isComposing){n.abort();return}if(p.key==="Enter"&&!p.isComposing){d();return}};return b`
    <style>
      ${o0e}
    </style>
    <div
      class="affine-attachment-rename-overlay-mask"
      @click="${()=>n.abort()}"
    ></div>
    <div class="affine-attachment-rename-container">
      <div class="affine-attachment-rename-input-wrapper">
        <input
          ${$t(i)}
          type="text"
          .value=${l}
          @input=${u}
          @keydown=${h}
        />
        <span class="affine-attachment-rename-extension">${c}</span>
      </div>
      <icon-button class="affine-confirm-button" @click=${d}
        >${cb}</icon-button
      >
    </div>
  `};function d0e({anchor:t,model:e,showCaption:n,downloadAttachment:i,abortController:r,ref:o=Ri()}){let s;const a=u=>{s=u,a&&(typeof o=="function"?o(u):o.value=u)},l=!v$(e),c=e.page.readonly;let d=null;return b`<style>
      ${a0e}
    </style>

    <div
      ${$t(a)}
      class="affine-attachment-options"
      @pointerdown=${at}
    >
      <icon-button size="32px" ?hidden=${!0}>
        ${BL}
        <affine-tooltip .offset=${12}>Preview</affine-tooltip>
      </icon-button>
      <div class="divider" ?hidden=${!0}></div>

      <icon-button size="32px" ?hidden=${!0}>
        ${Yd}
        <affine-tooltip .offset=${12}>Turn into Link view</affine-tooltip>
      </icon-button>

      <icon-button
        size="32px"
        ?hidden=${!e.embed}
        ?disabled=${c}
        @click="${()=>{e.page.updateBlock(e,{embed:!1}),r.abort()}}"
      >
        ${Yo}
        <affine-tooltip .offset=${12}>Turn into Card view</affine-tooltip>
      </icon-button>

      <icon-button
        size="32px"
        ?hidden=${e.embed}
        ?disabled=${c||l}
        @click="${()=>{i0e(e),r.abort()}}"
      >
        ${Qd}
        <affine-tooltip .offset=${12}>Turn into Embed view</affine-tooltip>
      </icon-button>
      <div class="divider"></div>

      <icon-button
        size="32px"
        ?hidden=${c}
        @click="${()=>{r.abort();const u=new AbortController;Rs({template:c0e({editorHost:t.host,model:e,abortController:u}),computePosition:{referenceElement:t,placement:"top-end",middleware:[Dn(),Dt(4)]},abortController:u})}}"
      >
        ${p0}
        <affine-tooltip .offset=${12}>Rename</affine-tooltip>
      </icon-button>
      <icon-button
        size="32px"
        ?hidden=${c}
        @click=${()=>{n()}}
      >
        ${Kd}
        <affine-tooltip .offset=${12}>Caption</affine-tooltip>
      </icon-button>
      <div class="divider" ?hidden=${c}></div>
      <icon-button
        size="32px"
        class="more-button"
        @click=${()=>{if(d){d.abort(),d=null;return}d=new AbortController,D(s),Rs({container:s,template:l0e({model:e,abortController:r,downloadAttachment:i}),abortController:d,computePosition:{referenceElement:s,placement:"top-end",middleware:[Dn(),Dt(4)]}})}}
      >
        ${V9}
        <affine-tooltip .offset=${12}>More</affine-tooltip>
      </icon-button>
    </div>`}const u0e=X`
  .affine-attachment-container {
    position: relative;
    display: flex;
    flex-direction: column;
    padding: 16px 24px;
    margin-top: calc(var(--affine-paragraph-space) + 8px);

    border-radius: 12px;
    border: 3px solid var(--affine-background-overlay-panel-color);
    background: var(--affine-card-background-blue);
    box-shadow: var(--affine-shadow-1);
    cursor: pointer;
  }

  .affine-attachment-embed-container {
    position: relative;
    display: flex;
    justify-content: center;
    margin-top: calc(var(--affine-paragraph-space) + 8px);
  }

  .affine-attachment-title {
    display: flex;
    gap: 8px;

    color: var(--affine-text-primary-color);
    font-size: var(--affine-font-sm);
    font-weight: 600;
    overflow: hidden;
    text-overflow: ellipsis;
    fill: var(--affine-icon-color);
    user-select: none;
    z-index: 1;
  }

  .affine-attachment-title > svg {
    /* Align icon vertically to the center of the first line of text,  */
    /* Assume the height of the icon is 16px */
    margin-top: calc((var(--affine-line-height) - 16px) / 2);
  }

  .affine-attachment-name {
    flex: 1;
    word-wrap: break-word;
    overflow: hidden;
  }

  .affine-attachment-desc {
    color: var(--affine-text-secondary-color);
    font-size: var(--affine-font-xs);
    user-select: none;
  }

  .affine-attachment-banner {
    position: absolute;
    display: flex;
    right: 24px;
    bottom: 0;
  }

  .affine-attachment-loading {
    display: flex;
    align-items: center;
    gap: 8px;

    color: var(--affine-placeholder-color);
    font-size: var(--affine-font-sm);
    font-weight: 600;
    fill: var(--affine-icon-color);
    user-select: none;
  }

  .affine-attachment-caption {
    width: 100%;
    font-size: var(--affine-font-sm);
    outline: none;
    border: 0;
    font-family: inherit;
    text-align: center;
    color: var(--affine-icon-color);
    background: var(--affine-background-primary-color);
  }
  .affine-attachment-caption::placeholder {
    color: var(--affine-placeholder-color);
  }

  .overlay-mask {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
`,AC=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <style xmlns="http://www.w3.org/2000/svg">
    .spinner {
      transform-origin: center;
      animation: spinner_animate 0.75s infinite linear;
    }
    @keyframes spinner_animate {
      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <path
    d="M14.6666 7.99992C14.6666 11.6818 11.6818 14.6666 7.99992 14.6666C4.31802 14.6666 1.33325 11.6818 1.33325 7.99992C1.33325 4.31802 4.31802 1.33325 7.99992 1.33325C11.6818 1.33325 14.6666 4.31802 14.6666 7.99992ZM3.30003 7.99992C3.30003 10.5956 5.40424 12.6998 7.99992 12.6998C10.5956 12.6998 12.6998 10.5956 12.6998 7.99992C12.6998 5.40424 10.5956 3.30003 7.99992 3.30003C5.40424 3.30003 3.30003 5.40424 3.30003 7.99992Z"
    fill-opacity="0.1"
  />
  <path
    d="M13.6833 7.99992C14.2263 7.99992 14.674 7.55732 14.5942 7.02014C14.5142 6.48171 14.3684 5.95388 14.1591 5.4487C13.8241 4.63986 13.333 3.90493 12.714 3.28587C12.0949 2.66682 11.36 2.17575 10.5511 1.84072C10.046 1.63147 9.51812 1.48564 8.9797 1.40564C8.44251 1.32583 7.99992 1.77351 7.99992 2.31659C7.99992 2.85967 8.44486 3.28962 8.9761 3.40241C9.25681 3.46201 9.53214 3.54734 9.79853 3.65768C10.3688 3.89388 10.8869 4.24008 11.3233 4.67652C11.7598 5.11295 12.106 5.63108 12.3422 6.20131C12.4525 6.4677 12.5378 6.74303 12.5974 7.02374C12.7102 7.55498 13.1402 7.99992 13.6833 7.99992Z"
    fill="#1E96EB"
    class="spinner"
  />
</svg>`,h0e=b`<svg
  width="90"
  height="67"
  viewBox="0 0 90 67"
  xmlns="http://www.w3.org/2000/svg"
>
  <g filter="url(#filter0_d_2804_28633)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M55.8256 13.2652C56.0233 11.8523 55.0434 10.546 53.6371 10.3475L20.5338 5.67357C18.4243 5.37573 16.4739 6.85229 16.1774 8.97157L6.51483 78.0428C6.21836 80.162 7.68812 82.1215 9.79763 82.4193L69.6381 90.8683C71.7476 91.1662 73.6981 89.6896 73.9945 87.5703L79.8994 45.3601C80.0971 43.9473 79.1172 42.641 77.7109 42.4424L59.8861 39.9257C55.6671 39.33 52.7276 35.4111 53.3205 31.1725L55.8256 13.2652ZM26.8035 44.3852C26.9517 43.3256 27.9269 42.5873 28.9817 42.7363L60.8117 47.2304C61.8665 47.3793 62.6014 48.359 62.4531 49.4187C62.3049 50.4783 61.3297 51.2166 60.2749 51.0677L28.4449 46.5735C27.3901 46.4246 26.6552 45.4449 26.8035 44.3852ZM27.4607 53.6086C26.406 53.4596 25.4308 54.1979 25.2825 55.2576C25.1343 56.3172 25.8692 57.2969 26.9239 57.4459L58.754 61.94C59.8087 62.0889 60.7839 61.3506 60.9322 60.291C61.0804 59.2314 60.3455 58.2516 59.2908 58.1027L27.4607 53.6086Z"
      fill="url(#paint0_linear_2804_28633)"
      shape-rendering="auto"
    />
    <path
      d="M62.3244 14.341C61.4678 13.199 59.6644 13.6675 59.4663 15.0836L57.1401 31.7118C56.8436 33.8311 58.3134 35.7906 60.4229 36.0884L76.9745 38.4254C78.384 38.6244 79.3295 37.012 78.4728 35.87L62.3244 14.341Z"
      fill="url(#paint1_linear_2804_28633)"
      shape-rendering="auto"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_2804_28633"
      x="1.47681"
      y="0.635498"
      width="83.448"
      height="95.271"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.08 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_2804_28633"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_2804_28633"
        result="shape"
      />
    </filter>
    <linearGradient
      id="paint0_linear_2804_28633"
      x1="50.4541"
      y1="9.89806"
      x2="39.6202"
      y2="86.63"
      gradientUnits="userSpaceOnUse"
    >
      <stop stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0.2" />
    </linearGradient>
    <linearGradient
      id="paint1_linear_2804_28633"
      x1="50.4541"
      y1="9.89806"
      x2="39.6202"
      y2="86.63"
      gradientUnits="userSpaceOnUse"
    >
      <stop stop-color="white" />
      <stop offset="1" stop-color="white" stop-opacity="0.2" />
    </linearGradient>
  </defs>
</svg>`,p0e=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="91"
  height="67"
  viewBox="0 0 91 67"
  fill="none"
>
  <g filter="url(#filter0_d_5306_36117)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M56.6675 13.2652C56.866 11.8523 55.8816 10.546 54.4688 10.3475L21.2123 5.67357C19.093 5.37573 17.1335 6.85229 16.8357 8.97157L7.12838 78.0428C6.83054 80.162 8.3071 82.1215 10.4264 82.4193L70.5439 90.8683C72.6632 91.1662 74.6226 89.6896 74.9205 87.5703L80.8527 45.3601C81.0513 43.9473 80.0669 42.641 78.6541 42.4424L60.7467 39.9257C56.5082 39.33 53.555 35.4111 54.1507 31.1725L56.6675 13.2652ZM27.511 44.3852C27.6599 43.3256 28.6396 42.5873 29.6993 42.7363L61.6767 47.2304C62.7363 47.3793 63.4746 48.359 63.3257 49.4187C63.1767 50.4783 62.197 51.2166 61.1374 51.0677L29.16 46.5735C28.1003 46.4246 27.362 45.4449 27.511 44.3852ZM28.1712 53.6086C27.1116 53.4597 26.1319 54.1979 25.983 55.2576C25.834 56.3172 26.5723 57.2969 27.632 57.4459L59.6094 61.94C60.669 62.0889 61.6487 61.3506 61.7976 60.291C61.9466 59.2314 61.2083 58.2516 60.1487 58.1027L28.1712 53.6086Z"
      fill="url(#paint0_linear_5306_36117)"
      fill-opacity="0.16"
      shape-rendering="auto"
    />
    <path
      d="M63.1963 14.341C62.3357 13.199 60.524 13.6675 60.325 15.0836L57.988 31.7118C57.6902 33.8311 59.1667 35.7906 61.286 36.0884L77.9143 38.4254C79.3303 38.6244 80.2801 37.012 79.4195 35.87L63.1963 14.341Z"
      fill="url(#paint1_linear_5306_36117)"
      fill-opacity="0.16"
      shape-rendering="auto"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_5306_36117"
      x="2.09021"
      y="0.635498"
      width="83.788"
      height="95.271"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.08 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_5306_36117"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_5306_36117"
        result="shape"
      />
    </filter>
    <linearGradient
      id="paint0_linear_5306_36117"
      x1="51.271"
      y1="9.89806"
      x2="40.4851"
      y2="86.6438"
      gradientUnits="userSpaceOnUse"
    >
      <stop stop-color="white" />
      <stop offset="1" stop-color="#777777" stop-opacity="0" />
    </linearGradient>
    <linearGradient
      id="paint1_linear_5306_36117"
      x1="51.271"
      y1="9.89806"
      x2="40.4851"
      y2="86.6438"
      gradientUnits="userSpaceOnUse"
    >
      <stop stop-color="white" />
      <stop offset="1" stop-color="#777777" stop-opacity="0" />
    </linearGradient>
  </defs>
</svg>`,f0e=()=>Wo()==="dark"?p0e:h0e,g0e=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="90"
  height="67"
  viewBox="0 0 90 67"
  fill="none"
>
  <g filter="url(#filter0_d_5306_36148)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M41.2256 8.42193L48.7032 23.7281L34.7987 39.9427L37.6963 43.7936L29.2604 42.602C28.2056 42.453 27.2304 43.1913 27.0821 44.2509C26.9338 45.3105 27.6686 46.2903 28.7233 46.4393L40.991 48.1721L44.5772 52.9381L43.1938 55.6573L27.7387 53.4743C26.684 53.3253 25.7087 54.0635 25.5604 55.1231C25.4121 56.1828 26.147 57.1625 27.2017 57.3115L41.3365 59.3081L36.1886 69.4269L39.6425 86.4606L10.0739 82.284C7.96442 81.986 6.49478 80.0264 6.79138 77.9072L16.4581 8.83657C16.7547 6.71732 18.7052 5.24087 20.8147 5.53884L41.2256 8.42193ZM53.9296 28.6836L41.7299 40.9218L43.7473 44.6484L61.0901 47.0981C62.1449 47.2471 62.8797 48.2268 62.7314 49.2865C62.5831 50.3461 61.6078 51.0843 60.5531 50.9353L46.0411 48.8855L48.5379 53.4976L47.0729 56.2053L59.5685 57.9703C60.6233 58.1193 61.3581 59.0991 61.2098 60.1587C61.0615 61.2183 60.0862 61.9565 59.0315 61.8076L45.1059 59.8405L39.6542 69.9165L40.7424 86.616L69.9139 90.7365C72.0234 91.0345 73.9739 89.5581 74.2705 87.4388L80.178 45.229C80.3757 43.8161 79.3959 42.5098 77.9896 42.3111L60.1649 39.7933C55.9459 39.1974 53.0067 35.2783 53.5999 31.0398L53.9296 28.6836ZM59.7466 14.9512C59.9448 13.5352 61.7482 13.0667 62.6048 14.2088L78.7519 35.7387C79.6085 36.8808 78.663 38.4931 77.2534 38.294L60.702 35.9561C58.5925 35.6581 57.1228 33.6986 57.4194 31.5793L59.7466 14.9512Z"
      fill="#E6E6E6"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_5306_36148"
      x="1.7533"
      y="0.500732"
      width="83.4501"
      height="95.2739"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.08 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_5306_36148"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_5306_36148"
        result="shape"
      />
    </filter>
  </defs>
</svg>`,m0e=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="90"
  height="67"
  viewBox="0 0 90 67"
  fill="none"
>
  <g filter="url(#filter0_d_5306_36172)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M41.2257 8.42193L48.7033 23.7281L34.7988 39.9427L37.6964 43.7936L29.2604 42.602C28.2057 42.453 27.2304 43.1913 27.0821 44.2509C26.9338 45.3105 27.6686 46.2903 28.7234 46.4393L40.991 48.1721L44.5773 52.9381L43.1939 55.6573L27.7388 53.4743C26.6841 53.3253 25.7088 54.0635 25.5605 55.1231C25.4122 56.1828 26.147 57.1625 27.2018 57.3115L41.3366 59.3081L36.1886 69.4269L39.6425 86.4606L10.074 82.284C7.96449 81.986 6.49485 80.0264 6.79145 77.9072L16.4582 8.83657C16.7548 6.71732 18.7053 5.24087 20.8148 5.53884L41.2257 8.42193ZM53.9297 28.6836L41.73 40.9218L43.7474 44.6484L61.0902 47.0981C62.1449 47.2471 62.8798 48.2268 62.7315 49.2865C62.5832 50.3461 61.6079 51.0843 60.5532 50.9353L46.0412 48.8855L48.538 53.4976L47.0729 56.2053L59.5686 57.9703C60.6233 58.1193 61.3581 59.0991 61.2098 60.1587C61.0615 61.2183 60.0863 61.9565 59.0315 61.8076L45.106 59.8405L39.6542 69.9165L40.7424 86.616L69.9139 90.7365C72.0234 91.0345 73.974 89.5581 74.2706 87.4388L80.178 45.229C80.3758 43.8161 79.396 42.5098 77.9897 42.3111L60.165 39.7933C55.946 39.1974 53.0067 35.2783 53.5999 31.0398L53.9297 28.6836ZM59.7467 14.9512C59.9449 13.5352 61.7483 13.0667 62.6048 14.2088L78.752 35.7387C79.6085 36.8808 78.663 38.4931 77.2535 38.294L60.702 35.9561C58.5925 35.6581 57.1229 33.6986 57.4195 31.5793L59.7467 14.9512Z"
      fill="#181818"
      fill-opacity="0.8"
      shape-rendering="auto"
    />
  </g>
  <defs>
    <filter
      id="filter0_d_5306_36172"
      x="1.75342"
      y="0.500732"
      width="83.45"
      height="95.2739"
      filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB"
    >
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix
        in="SourceAlpha"
        type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
        result="hardAlpha"
      />
      <feOffset />
      <feGaussianBlur stdDeviation="2.5" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix
        type="matrix"
        values="0 0 0 0 0.258824 0 0 0 0 0.254902 0 0 0 0 0.286275 0 0 0 0.08 0"
      />
      <feBlend
        mode="normal"
        in2="BackgroundImageFix"
        result="effect1_dropShadow_5306_36172"
      />
      <feBlend
        mode="normal"
        in="SourceGraphic"
        in2="effect1_dropShadow_5306_36172"
        result="shape"
      />
    </filter>
  </defs>
</svg>`,b0e=()=>Wo()==="dark"?m0e:g0e;var v0e=Object.defineProperty,y0e=Object.getOwnPropertyDescriptor,Zc=(t,e,n,i)=>{for(var r=i>1?void 0:i?y0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&v0e(e,n,r),r};let Vo=class extends wn{constructor(){super(...arguments),this._showCaption=!1,this._error=!1,this._isDownloading=!1,this._pointerPressed=!1,this._themeObserver=new cu,this._hoverController=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:d0e({anchor:this,model:this.model,showCaption:()=>{this._showCaption=!0,requestAnimationFrame(()=>{this._captionInput.focus()})},downloadAttachment:this._downloadAttachment,abortController:t}),computePosition:{referenceElement:this,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}}),this._registerDragHandleOption=()=>{this._disposables.add(ri.registerOption({flavour:q3.model.flavour,onDragStart:({state:t,startDragging:e})=>{const i=jn(t.raw.target)?.closest("affine-attachment");return i?(this.host.selection.set([this.host.selection.create("block",{path:i.path})]),e([i],t),!0):!1}}))},this._checkBlob=async()=>{const t=this.model.sourceId;if(t)try{const e=await SP(this.model);if(!e)throw new Error("Blob is missing!");v$(this.model)&&(this._blobUrl=URL.createObjectURL(e))}catch{this._error=!0,console.warn("The attachment is unavailable since the blob is missing!",this.model,t)}},this._focusAttachment=()=>{const t=this.host.selection,e=t.create("block",{path:this.path});t.setGroup("note",[e])},this._downloadAttachment=async()=>{if(this._isDownloading){kt(this.host,"Download in progress...");return}const t=this.model.name.length<20?this.model.name:this.model.name.slice(0,20)+"...";kt(this.host,`Downloading ${t}`),this._isDownloading=!0;try{await _oe(this.host,this.model)}catch(e){console.error(e),kt(this.host,`Failed to download ${t}!`)}finally{this._isDownloading=!1}},this._onBlur=()=>{this.model.caption||(this._showCaption=!1)},this._onInput=t=>{const e=t.target.value;this.model.page.updateBlock(this.model,{caption:e})},this._attachmentTail=t=>b`
      <div class="affine-attachment-banner">
        ${t?b0e():f0e()}
      </div>
      ${this.selected?.is("block")?b`<affine-block-selection
            .borderRadius=${12}
            .borderWidth=${3}
          ></affine-block-selection>`:null}
    `,this._captionTemplate=()=>b`<input
      ?hidden=${!this._showCaption}
      .disabled=${this.model.page.readonly}
      class="affine-attachment-caption"
      placeholder="Write a caption"
      value=${this.model.caption??""}
      @input=${this._onInput}
      @blur=${this._onBlur}
      @pointerdown=${at}
    />`}connectedCallback(){super.connectedCallback(),this.contentEditable="false",this.model.caption&&(this._showCaption=!0),this._checkBlob().catch(console.error),this._registerDragHandleOption(),this._themeObserver.observe(document.documentElement),this._themeObserver.on(()=>this.requestUpdate()),this.disposables.add(()=>this._themeObserver.dispose()),this.model.propsUpdated.on(({key:t})=>{t==="sourceId"&&(this._blobUrl&&(URL.revokeObjectURL(this._blobUrl),this._blobUrl=void 0),this._checkBlob().catch(console.error))}),this.disposables.add(this.std.event.add("pointerDown",t=>{t.get("pointerState").button===0&&(this._pointerPressed=!0)})),this.disposables.add(this.std.event.add("pointerUp",t=>{t.get("pointerState").button===0&&(this._pointerPressed=!1)}))}disconnectedCallback(){super.disconnectedCallback(),this._blobUrl&&URL.revokeObjectURL(this._blobUrl)}renderBlock(){const t=IP(this.model.id),e=this._error||!t&&!this.model.sourceId;if(t)return b`<div
        class="affine-attachment-container"
        @click=${this._focusAttachment}
      >
        <div class="affine-attachment-loading">${AC}Loading...</div>
        <div class="affine-attachment-desc">
          ${Gl(this.model.size)}
        </div>
        ${this._attachmentTail(e)}
      </div>`;if(e)return b`<div
        class="affine-attachment-container"
        @click=${this._focusAttachment}
      >
        <div class="affine-attachment-title">
          ${y8}
          <span class="affine-attachment-name">${this.model.name}</span>
        </div>
        <div class="affine-attachment-desc">
          Unable to upload or download attachment
        </div>
        ${this._attachmentTail(e)}
      </div>`;if(this.model.embed&&this._blobUrl){const i=r0e(this.model,this._blobUrl);if(i){const r=this._pointerPressed?b`<div class="overlay-mask"></div>`:null;return b`<div
            ${$t(this._hoverController.setReference)}
            class="affine-attachment-embed-container"
          >
            ${r} ${i}
            ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:null}
          </div>
          ${this._captionTemplate()}`}}const n=this._isDownloading||this.model.embed&&!this._blobUrl;return b`<div
        ${$t(this._hoverController.setReference)}
        class="affine-attachment-container"
        @click=${this._focusAttachment}
        @dblclick=${this._downloadAttachment}
      >
        <div class="affine-attachment-title">
          ${n?AC:y8}
          <span class="affine-attachment-name">${this.model.name}</span>
        </div>
        <div class="affine-attachment-desc">
          ${Gl(this.model.size)}
        </div>
        ${this._attachmentTail(e)}
      </div>
      ${this._captionTemplate()}`}};Vo.styles=u0e;Zc([ie()],Vo.prototype,"_showCaption",2);Zc([he("input.affine-attachment-caption")],Vo.prototype,"_captionInput",2);Zc([ie()],Vo.prototype,"_error",2);Zc([ie()],Vo.prototype,"_isDownloading",2);Zc([ie()],Vo.prototype,"_blobUrl",2);Zc([ie()],Vo.prototype,"_pointerPressed",2);Vo=Zc([W("affine-attachment")],Vo);function w0e({ref:t,model:e,wrap:n,onClickWrap:i,anchor:r}){const s=e.page.readonly;return b`
    <style>
      :host {
        z-index: 1;
      }
      .affine-codeblock-option {
        box-shadow: var(--affine-shadow-2);
        padding: 8px;
        border-radius: 8px;
        z-index: var(--affine-z-index-popover);
        background: var(--affine-background-overlay-panel-color);
      }
      .delete-code-button:hover {
        background: var(--affine-background-error-color);
        color: var(--affine-error-color);
      }
      .delete-code-button:hover > svg {
        color: var(--affine-error-color);
      }
    </style>

    <div ${$t(t)} class="affine-codeblock-option">
      <icon-button
        size="32px"
        data-testid="copy-button"
        @click=${()=>{const a=Ud.fromModels(e.page,[e]);r.std.clipboard.copySlice(a).then(()=>{kt(r.host,"Copied to clipboard")}).catch(l=>{kt(r.host,"Copied failed, something went wrong"),console.error(l)})}}
      >
        ${Tr}
        <affine-tooltip tip-position="right" .offset=${12}
          >Copy to Clipboard</affine-tooltip
        >
      </icon-button>
      <icon-button
        size="32px"
        data-testid="wrap-button"
        ?active=${n}
        @click=${i}
      >
        ${n?$L:AL}
        <affine-tooltip tip-position="right" .offset=${12}
          >${n?"Cancel wrap":"Wrap code"}</affine-tooltip
        >
      </icon-button>
      ${s?ae:b`<icon-button
            size="32px"
            data-testid="delete-button"
            class="delete-code-button"
            @click=${()=>{s||e.page.deleteBlock(e)}}
          >
            ${xn}
            <affine-tooltip tip-position="right" .offset=${12}
              >Delete</affine-tooltip
            >
          </icon-button>`}
    </div>
  `}var x0e=Object.defineProperty,_0e=Object.getOwnPropertyDescriptor,yl=(t,e,n,i)=>{for(var r=i>1?void 0:i?_0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&x0e(e,n,r),r};let Jr=class extends Ae{constructor(){super(...arguments),this._filterText="",this._currentSelectedIndex=0}static get styles(){return X`
      :host {
        max-height: 100%;
        width: 230px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        background: var(--affine-background-overlay-panel-color);
        color: var(--affine-text-primary-color);
        border-radius: 12px;
        z-index: var(--affine-z-index-popover);
        pointer-events: auto;
      }

      .lang-list-container {
        box-sizing: border-box;
        display: flex;
        height: 100%;
        overflow: hidden;
        flex-direction: column;
        box-shadow: var(--affine-menu-shadow);
        border-radius: 8px;
        padding: 8px;
      }

      .lang-list-button-container {
        flex: 1;
        overflow-y: scroll;
        padding-top: 5px;
        padding-left: 4px;
        padding-right: 4px;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      ${uu(".lang-list-button-container")}

      .lang-item {
        display: flex;
        justify-content: space-between;
        padding: 12px;
      }
      .lang-item svg {
        width: 20px;
        height: 20px;
      }
      .lang-item-active {
        color: var(--affine-blue-600);
        background: var(--affine-hover-color-filled);
      }

      .divider {
        height: 1px;
        background-color: var(--affine-divider-color);
        margin: 8px 0;
        flex-shrink: 0;
      }

      .input-wrapper {
        display: flex;
        margin-left: 4px;
        border-radius: 4px;
        padding: 4px 10px;
        gap: 4px;
        border: 1px solid transparent;
      }

      .input-wrapper:focus-within {
        border: 1px solid var(--affine-blue-600);
        box-shadow: var(--affine-active-shadow);
      }

      #filter-input {
        flex: 1;
        align-items: center;
        height: 20px;
        width: 140px;
        border-radius: 8px;
        padding-top: 2px;
        border: none;
        font-family: ${Je(vt.fontSansFamily)};
        font-size: var(--affine-font-sm);
        box-sizing: border-box;
        color: inherit;
        background: var(--affine-background-overlay-panel-color);
      }

      #filter-input:focus {
        outline: none;
      }

      #filter-input::placeholder {
        color: var(--affine-placeholder-color);
        font-size: var(--affine-font-sm);
      }

      .search-icon {
        display: flex;
        align-items: center;
        color: var(--affine-icon-color);
      }
    `}async connectedCallback(){super.connectedCallback(),setTimeout(()=>{this.filterInput?.focus()},0)}disconnectedCallback(){super.disconnectedCallback(),this.onClose?.()}_onLanguageClicked(t){this.onSelectLanguage?.(t)}render(){const t=this.placement?.startsWith("top"),e=[L1,...Wl].filter(i=>this._filterText?i.id.startsWith(this._filterText.toLowerCase())||i.aliases?.some(r=>r.startsWith(this._filterText.toLowerCase())):!0).sort((i,r)=>nC(i.id,this.currentLanguageId===i.id)-nC(r.id,this.currentLanguageId===r.id));return b`
      <div
        class="lang-list-container"
        style="${t?"flex-direction: column-reverse;":""}"
      >
        <div class="input-wrapper">
          <div class="search-icon">${ML}</div>
          <input
            id="filter-input"
            type="text"
            placeholder="Search for a language"
            @input="${()=>{this._filterText=this.filterInput?.value,this._currentSelectedIndex=0}}"
            @keydown="${i=>{if(i.key==="ArrowDown")i.preventDefault(),this._currentSelectedIndex=(this._currentSelectedIndex+1)%e.length;else if(i.key==="ArrowUp")i.preventDefault(),this._currentSelectedIndex=(this._currentSelectedIndex+e.length-1)%e.length;else if(i.key==="Enter"&&!i.isComposing){if(i.preventDefault(),this._currentSelectedIndex===-1||this._currentSelectedIndex>=e.length)return;this._onLanguageClicked(e[this._currentSelectedIndex])}}}"
          />
        </div>
        <div class="divider"></div>
        <div class="lang-list-button-container">
          ${e.map((i,r)=>{const o=r===this._currentSelectedIndex;return b`
              <icon-button
                width="100%"
                height="32px"
                @click="${()=>this._onLanguageClicked(i)}"
                class=${["lang-item",o?"lang-item-active":null].join(" ")}
              >
                ${i.displayName??i.id}
                <slot name="suffix"
                  >${this.currentLanguageId===i.id?$9:ae}</slot
                >
              </icon-button>
            `})}
        </div>
      </div>
    `}};yl([L({attribute:!1})],Jr.prototype,"currentLanguageId",2);yl([L({attribute:!1})],Jr.prototype,"onClose",2);yl([L({attribute:!1})],Jr.prototype,"onSelectLanguage",2);yl([L({attribute:!1})],Jr.prototype,"placement",2);yl([ie()],Jr.prototype,"_filterText",2);yl([ie()],Jr.prototype,"_currentSelectedIndex",2);yl([he("#filter-input")],Jr.prototype,"filterInput",2);Jr=yl([W("lang-list")],Jr);class C0e{constructor(e){this._disposables=new dt,this._plaintextAdapter=new nT,this._htmlAdapter=new Kg,this._init=()=>{this._clipboard.registerAdapter("text/plain",this._plaintextAdapter,90),this._clipboard.registerAdapter("text/html",this._htmlAdapter,80);const n=oT(this._std);this._clipboard.use(n),this._disposables.add({dispose:()=>{this._clipboard.unregisterAdapter("text/plain"),this._clipboard.unregisterAdapter("text/html"),this._clipboard.unuse(n)}})},this.onPagePaste=n=>{const i=n.get("clipboardState").raw;return i.preventDefault(),this._std.page.captureSync(),this._std.command.pipe().try(r=>[r.getTextSelection().inline((o,s)=>{const a=o.currentTextSelection;D(a);const l=a.to??a.from;s({currentSelectionPath:l.path})}),r.getBlockSelections().inline((o,s)=>{const a=o.currentBlockSelections;D(a);const l=a.at(-1);l&&s({currentSelectionPath:l.path})})]).getBlockIndex().inline((r,o)=>(D(r.parentBlock),this._clipboard.paste(i,this._std.page,r.parentBlock.model.id,r.blockIndex?r.blockIndex+1:void 0).catch(console.error),o())).run(),!0},this.host=e}get _std(){return this.host.std}hostConnected(){this._disposables.disposed&&(this._disposables=new dt),this._clipboard=new rD(this._std),this.host.handleEvent("paste",this.onPagePaste),this._init()}hostDisconnected(){this._disposables.dispose()}}const k0e=t=>e=>b`<affine-code-line
    .delta=${e}
    .highlightOptionsGetter=${t}
  ></affine-code-line>`;var E0e=Object.defineProperty,S0e=Object.getOwnPropertyDescriptor,q0=(t,e,n,i)=>{for(var r=i>1?void 0:i?S0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&E0e(e,n,r),r};let Za=class extends wn{constructor(){super(...arguments),this._wrap=!1,this.clipboardController=new C0e(this),this.highlightOptionsGetter=null,this.attributesSchema=ge.object({}),this.getAttributeRenderer=()=>k0e(()=>({lang:this.model.language.toLowerCase(),highlighter:this._highlighter})),this._richTextResizeObserver=new ResizeObserver(()=>{this._updateLineNumbers()}),this._perviousLanguage=L1,this._highlighter=null,this._inlineRangeProvider=null,this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:({updatePortal:r})=>w0e({anchor:this,model:this.model,wrap:this._wrap,onClickWrap:()=>{this._wrap=!this._wrap,r()},abortController:t}),computePosition:{referenceElement:this,placement:"right-start",middleware:[Dt({mainAxis:12,crossAxis:10}),tr({crossAxis:!0,padding:{top:B2+12,bottom:12,right:12},limiter:hk()})],autoUpdate:!0}}})}get _showLangList(){return!!this._langListAbortController}get readonly(){return this.model.page.readonly}get topContenteditableElement(){return this.rootBlockElement instanceof Fi?this.closest("affine-note"):this.rootBlockElement}async _startHighlight(t){if(this._highlighter){this._highlighter.getLoadedLanguages().includes(t.id)||this._highlighter.loadLanguage(t).then(()=>{const a=this.querySelector("rich-text")?.inlineEditor;a&&a.requestUpdate()}).catch(console.error);return}const e=Wo();this._highlighter=await rS({theme:e==="dark"?V8:z8,themes:[z8,V8],langs:[t],paths:{wasm:"https://cdn.jsdelivr.net/npm/shiki/dist",themes:"https://cdn.jsdelivr.net/",languages:"https://cdn.jsdelivr.net/npm/shiki/languages"}});const n=this.querySelector("rich-text");D(n);const i=n.inlineEditor;D(i);const r=i.getInlineRange();i.requestUpdate(),r&&i.setInlineRange(r)}get inlineEditor(){const t=this.querySelector(`[${ni}]`);if(!t)throw new Error("Inline editor root not found");return t.inlineEditor}async getUpdateComplete(){const t=await super.getUpdateComplete();return await this._richTextElement?.updateComplete,t}connectedCallback(){super.connectedCallback(),this.clipboardController.hostConnected(),this.setHighlightOptionsGetter(()=>({lang:this._perviousLanguage.id,highlighter:this._highlighter})),this._disposables.add(()=>KM(this,()=>{if(!this._highlighter)return;const o=this.querySelector("rich-text")?.inlineEditor;o&&setTimeout(()=>{o.requestUpdate()})})),fv(this);const t=this.host.selection,e="  ",n=`
`,i=(r,o,s=0,a=r.length)=>{const l=[];let c=s;for(;c<a;){const d=r.indexOf(o,c);if(d===-1||d>a)break;l.push(d),c=d+1}return l};this.bindHotKey({Backspace:r=>{const o=r.get("keyboardState"),s=t.find("text");if(!s){o.raw.preventDefault();return}const a=s.from;if(a.index===0&&a.length===0)return o.raw.preventDefault(),t.setGroup("note",[t.create("block",{path:this.path})]),!0},Tab:r=>{const s=r.get("keyboardState").raw,l=this.inlineEditor.getInlineRange();if(l){s.stopPropagation(),s.preventDefault();const c=this.inlineEditor.yText.toString(),d=c.lastIndexOf(n,l.index-1),u=i(c,n,l.index,l.index+l.length).map(h=>h+1).reverse();return d!==-1?u.push(d+1):u.push(0),u.forEach(h=>{this.inlineEditor.insertText({index:h,length:0},e)}),this.inlineEditor.setInlineRange({index:l.index+2,length:l.length+(u.length-1)*e.length}),!0}},"Shift-Tab":r=>{const s=r.get("keyboardState").raw,l=this.inlineEditor.getInlineRange();if(l){s.stopPropagation(),s.preventDefault();const c=this.inlineEditor.yText.toString(),d=c.lastIndexOf(n,l.index-1);let u=i(c,n,l.index,l.index+l.length).map(h=>h+1).reverse();return d!==-1?u.push(d+1):u.push(0),u=u.filter(h=>c.slice(h,h+2)===e),u.forEach(h=>{this.inlineEditor.deleteText({index:h,length:2})}),u.length>0&&this.inlineEditor.setInlineRange({index:l.index-(u[u.length-1]<l.index?2:0),length:l.length-(u.length-1)*e.length}),!0}}}),this._inlineRangeProvider=Xm(this)}disconnectedCallback(){super.disconnectedCallback(),this.clipboardController.hostDisconnected(),this._richTextResizeObserver.disconnect()}updated(){if(this.model.language!==this._perviousLanguage.id){const t=g2(this.model.language);this._perviousLanguage=t??L1,t?this._startHighlight(t).catch(console.error):this._highlighter=null;const n=this.querySelector("rich-text")?.inlineEditor;n&&n.requestUpdate()}D(this._richTextElement),this._richTextResizeObserver.disconnect(),this._richTextResizeObserver.observe(this._richTextElement)}setHighlightOptionsGetter(t){this.highlightOptionsGetter=t}setLang(t){const n=(t?g2(t):null)?.id??vp;this.page.updateBlock(this.model,{language:n})}_onClickLangBtn(){if(this.readonly||this._langListAbortController)return;const t=new AbortController;this._langListAbortController=t,t.signal.addEventListener("abort",()=>{this._langListAbortController=void 0});const e=440,n={top:B2+12,bottom:12};Rs({closeOnClickAway:!0,template:({positionSlot:i})=>{const r=new Jr;return r.currentLanguageId=this._perviousLanguage.id,r.onSelectLanguage=o=>{this.setLang(o?o.id:null),t.abort()},r.onClose=()=>t.abort(),i.on(({placement:o})=>{r.placement=o}),b`
          <style>
            :host {
              z-index: var(--affine-z-index-popover);
            }
          </style>
          ${r}
        `},computePosition:{referenceElement:this._langButton,placement:"bottom-start",middleware:[Dt(4),uk({allowedPlacements:["top-start","bottom-start"],padding:n}),pk({padding:n,apply({availableHeight:i,elements:r,placement:o}){Object.assign(r.floating.style,{height:"100%",maxHeight:`${Math.min(e,i)}px`,pointerEvents:"none",...o.startsWith("top")?{display:"flex",alignItems:"flex-end"}:{display:null,alignItems:null}})}})],autoUpdate:!0},abortController:t})}_curLanguageButtonTemplate(){const t=g2(this.model.language)??L1,e=t.displayName??t.id;return b`<div
      contenteditable="false"
      class="lang-list-wrapper caret-ignore"
      style="${this._showLangList?"visibility: visible;":""}"
    >
      <icon-button
        class="lang-button"
        data-testid="lang-button"
        width="auto"
        height="24px"
        ?hover=${this._showLangList}
        ?disabled=${this.readonly}
        @click=${this._onClickLangBtn}
      >
        ${e} ${this.readonly?ae:m3}
      </icon-button>
    </div>`}_updateLineNumbers(){const t=this.querySelector("#line-numbers");D(t);const e=this._wrap?T0e():I0e;Qa(Fe(Array.from(this.querySelectorAll("v-line")),e),t)}renderBlock(){return b`<div
      ${$t(this._whenHover.setReference)}
      class=${Qe({"affine-code-block-container":!0,wrap:this._wrap})}
    >
      ${this._curLanguageButtonTemplate()}
      <div class="rich-text-container">
        <div contenteditable="false" id="line-numbers"></div>
        <rich-text
          .yText=${this.model.text.yText}
          .inlineEventSource=${this.topContenteditableElement??ae}
          .undoManager=${this.model.page.history}
          .attributesSchema=${this.attributesSchema}
          .attributeRenderer=${this.getAttributeRenderer()}
          .readonly=${this.model.page.readonly}
          .inlineRangeProvider=${this._inlineRangeProvider}
          .enableClipboard=${!1}
          .enableUndoRedo=${!1}
          .wrapText=${this._wrap}
        >
        </rich-text>
      </div>
      ${this.renderModelChildren(this.model)}
      ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:null}
    </div>`}};Za.styles=X`
    code-block {
      position: relative;
      z-index: 1;
    }

    .affine-code-block-container {
      font-size: var(--affine-font-sm);
      line-height: var(--affine-line-height);
      position: relative;
      padding: 32px 0px 12px 0px;
      background: var(--affine-background-code-block);
      border-radius: 10px;
      margin-top: 24px;
      margin-bottom: 24px;
    }

    .affine-code-block-container .inline-editor {
      font-family: var(--affine-font-code-family);
      font-variant-ligatures: none;
    }

    .affine-code-block-container .lang-list-wrapper {
      position: absolute;
      font-size: var(--affine-font-sm);
      line-height: var(--affine-line-height);
      top: 12px;
      left: 12px;
    }

    .affine-code-block-container > .lang-list-wrapper {
      visibility: hidden;
    }
    .affine-code-block-container:hover > .lang-list-wrapper {
      visibility: visible;
    }

    .affine-code-block-container > .lang-list-wrapper > .lang-button {
      display: flex;
      justify-content: flex-start;
      padding: 0 8px;
    }

    .affine-code-block-container rich-text {
      /* to make sure the resize observer can be triggered as expected */
      display: block;
      position: relative;
      overflow-x: auto;
      overflow-y: hidden;
      padding-bottom: 20px;
      width: 90%;
    }

    .affine-code-block-container .rich-text-container {
      position: relative;
      border-radius: 4px;
      padding: 4px 12px 4px 60px;
    }

    #line-numbers {
      position: absolute;
      text-align: right;
      left: 20px;
      line-height: var(--affine-line-height);
      color: var(--affine-text-secondary-color);
    }

    .affine-code-block-container.wrap #line-numbers {
      top: calc(var(--affine-line-height) + 4px);
    }

    .affine-code-block-container.wrap #line-numbers > div {
      margin-top: calc(var(--top, 0) / 1 - var(--affine-line-height));
    }

    .code-block-option {
      box-shadow: var(--affine-shadow-2);
      border-radius: 8px;
      list-style: none;
      padding: 4px;
      width: 40px;
      background-color: var(--affine-background-overlay-panel-color);
      margin: 0;
    }
  `;q0([ie()],Za.prototype,"_wrap",2);q0([he(".lang-button")],Za.prototype,"_langButton",2);q0([ie()],Za.prototype,"_langListAbortController",2);q0([he("rich-text")],Za.prototype,"_richTextElement",2);Za=q0([W("affine-code")],Za);function T0e(t=0){return function(n,i){const r={"--top":`${t}px`};return t=n.getBoundingClientRect().height,b`<div style=${we(r)}>${i+1}</div>`}}function I0e(t,e){return b`<div>${e+1}</div>`}var L0e=Object.defineProperty,M0e=Object.getOwnPropertyDescriptor,Su=(t,e,n,i)=>{for(var r=i>1?void 0:i?M0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&L0e(e,n,r),r};let Gs=class extends _u{constructor(){super(...arguments),this._cardStyle="figma",this._isSelected=!1,this._showOverlay=!0,this.showCaption=!1,this._isDragging=!1,this.open=()=>{let t=this.model.url;t.match(/^[a-zA-Z]+:\/\//)||(t="https://"+t),window.open(t,"_blank")},this.refreshData=()=>{},this._whenHover=new Xn(this,({abortController:t})=>{const e=this.host.selection,n=e.find("text");if(n&&(n.to||n.from.length))return null;const i=e.filter("block");return i.length>1||i.length===1&&i[0].path!==this.path?null:{template:b`
        <style>
          :host {
            z-index: 1;
          }
        </style>
        <embed-card-toolbar
          .model=${this.model}
          .block=${this}
          .host=${this.host}
          .abortController=${t}
          .std=${this.std}
        ></embed-card-toolbar>
      `,computePosition:{referenceElement:this._figmaBlockEl,placement:"top-end",middleware:[Dn(),Dt(4)],autoUpdate:!0}}})}_selectBlock(){const t=this.host.selection,e=t.create("block",{path:this.path});t.setGroup("note",[e])}_handleClick(){this.isInSurface||this._selectBlock()}_handleDoubleClick(t){t.stopPropagation(),this.open()}connectedCallback(){if(super.connectedCallback(),this.model.caption&&this.model.caption.length&&(this.showCaption=!0),!this.model.description&&!this.model.title&&this.page.withoutTransact(()=>{this.page.updateBlock(this.model,{title:"Figma",description:this.model.url})}),this.disposables.add(this.model.propsUpdated.on(({key:t})=>{this.requestUpdate(),t==="url"&&this.refreshData()})),this.disposables.add(this.std.selection.slots.changed.on(t=>{this._isSelected=t.some(e=>gt.equals(e.path,this.path)),this._showOverlay=this._isDragging||!this._isSelected})),this.handleEvent("pointerMove",t=>{this._isDragging=t.get("pointerState").dragging,this._isDragging&&(this._showOverlay=!0)}),this.isInSurface){const t=this.surface;D(t),this.disposables.add(this.model.propsUpdated.on(()=>{this.requestUpdate()}))}}renderBlock(){const{title:t,description:e,style:n,url:i}=this.model;this._cardStyle=n,this._width=At[this._cardStyle],this._height=bt[this._cardStyle];const r=t??"Figma",o=e??i;return this.renderEmbed(()=>b`
        <div
          style=${we({position:"relative"})}
        >
          <div
            ${this.isInSurface?ae:$t(this._whenHover.setReference)}
            class=${Qe({"affine-embed-figma-block":!0,selected:this._isSelected})}
            @click=${this._handleClick}
            @dblclick=${this._handleDoubleClick}
          >
            <div class="affine-embed-figma">
              <div class="affine-embed-figma-iframe-container">
                <iframe
                  src=${`https://www.figma.com/embed?embed_host=blocksuite&url=${i}`}
                  allowfullscreen
                ></iframe>

                <div
                  class=${Qe({"affine-embed-figma-iframe-overlay":!0,hide:!this._showOverlay})}
                ></div>
              </div>
            </div>
            <div class="affine-embed-figma-content">
              <div class="affine-embed-figma-content-header">
                <div class="affine-embed-figma-content-title-icon">
                  ${Sb}
                </div>

                <div class="affine-embed-figma-content-title-text">
                  ${r}
                </div>
              </div>

              <div class="affine-embed-figma-content-description">
                ${o}
              </div>

              <div class="affine-embed-figma-content-url" @click=${this.open}>
                <span>www.figma.com</span>

                <div class="affine-embed-figma-content-url-icon">
                  ${oo}
                </div>
              </div>
            </div>
          </div>

          <embed-card-caption
            .block=${this}
            .display=${this.showCaption}
            @blur=${()=>{this.model.caption||(this.showCaption=!1)}}
          ></embed-card-caption>

          ${this.selected?.is("block")?b`<affine-block-selection></affine-block-selection>`:ae}
        </div>
      `)}};Gs.styles=cQ;Su([ie()],Gs.prototype,"_isSelected",2);Su([ie()],Gs.prototype,"_showOverlay",2);Su([ie()],Gs.prototype,"showCaption",2);Su([he(".affine-embed-figma-block")],Gs.prototype,"_figmaBlockEl",2);Su([he("embed-card-caption")],Gs.prototype,"captionElement",2);Gs=Su([W("affine-embed-figma-block")],Gs);var P0e=Object.defineProperty,A0e=Object.getOwnPropertyDescriptor,y$=(t,e,n,i)=>{for(var r=i>1?void 0:i?A0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&P0e(e,n,r),r};let Fp=class extends _u{constructor(){super(...arguments),this.updateWH=()=>{const[,,t,e]=JSON.parse(this.model.xywh);this.iframe.style.width=`${t}px`,this.iframe.style.height=`${e}px`}}connectedCallback(){super.connectedCallback(),this.disposables.add(this.model.propsUpdated.on(this.updateWH))}firstUpdated(t){super.firstUpdated(t),this.updateWH()}renderBlock(){return this.renderEmbed(()=>this.model.html?b`<iframe
        class="embed-html-block-iframe"
        sandbox="allow-scripts"
        scrolling="false"
        .srcdoc="${this.model.html}"
      ></iframe>`:b` <div class="affine-html-empty">Empty</div>`)}};Fp.styles=X`
    //affine-html {
    //  display: block;
    //}
    //
    .embed-html-block-iframe {
      border: none;
      width: 100%;
    }
  `;y$([he(".embed-html-block-iframe")],Fp.prototype,"iframe",2);Fp=y$([W("affine-embed-html-block")],Fp);class $0e extends li{}const w$=[iy,mv,V3,wv,S1,_v,I1,a3,T1,xv,w4,Q3],B0e=[ry,q3,fy.schema,sy.schema,cy.schema,Np.schema,uy.schema],kr={splitElements:YM,matchFlavours:Ie,mindMap:Lhe,deserializeXYWH:Wn,isCanvasElement:_0,Point:je},x$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},_$="__ $BLOCKSUITE_BLOCKS$ __";x$[_$]===!0&&console.error("@blocksuite/blocks was already imported. This breaks constructor checks and will lead to issues!");if(typeof window>"u")throw new Error("Seems like you are importing @blocksuite/blocks in SSR mode. Which is not supported for now.");x$[_$]=!0;const h4e=Object.freeze(Object.defineProperty({__proto__:null,get AffineDocDraggingAreaWidget(){return fd},get AffineDocRemoteSelectionWidget(){return ac},get AffineDragHandleWidget(){return ri},get AffineFormatBarWidget(){return Na},get AffineImageToolbarWidget(){return N8},get AffineLinkedDocWidget(){return fp},get AffineModalWidget(){return H8},AffineSchemas:w$,get AffineSlashMenuWidget(){return bp},get AffineSurfaceRefToolbar(){return U8},ArrowDownSmallIcon:W1,get AttachmentBlockComponent(){return Vo},AttachmentBlockModel:uv,AttachmentBlockSchema:q3,AttachmentService:hv,get BlockHubWidget(){return u5},BlocksUtils:kr,get BookmarkBlockComponent(){return ja},BookmarkBlockModel:jM,BookmarkBlockSchema:T1,BookmarkService:Dp,BookmarkStyles:rc,Bound:ne,BrushElementModel:Ec,CanvasElementType:kn,CloseIcon:Z9,get CodeBlockComponent(){return Za},CodeBlockSchema:iy,ColorVariables:LM,ConnectorElementModel:Ft,ConnectorEndpointStyle:St,ConnectorMode:jt,get DataViewBlockComponent(){return lm},DataViewBlockModel:a$,DataViewBlockSchema:ry,get DatabaseBlockComponent(){return K5},DatabaseBlockModel:e$,DatabaseBlockSchema:w4,DatabaseService:t$,get DividerBlockComponent(){return _5},DividerBlockSchema:_v,DocEditorBlockSpecs:E4,get DocPageBlockComponent(){return Kl},DualLinkIcon16:v3,EdgelessBlock:Nl,EdgelessEditorBlockSpecs:gy,get EdgelessPageBlockComponent(){return Fi},get EdgelessRemoteSelectionWidget(){return Os},get EdgelessSurfaceRefBlockComponent(){return F8},ElementModel:Ni,EmbedBlockElement:_u,get EmbedFigmaBlockComponent(){return Gs},EmbedFigmaBlockSpec:sy,EmbedFigmaModel:c$,EmbedFigmaStyles:oy,get EmbedGithubBlockComponent(){return Ga},EmbedGithubBlockSpec:cy,EmbedGithubModel:d$,EmbedGithubService:Rp,EmbedGithubStyles:ly,get EmbedHtmlBlock(){return Fp},EmbedHtmlBlockSpec:Np,EmbedHtmlModel:dy,EmbedHtmlService:$0e,get EmbedLinkedDocBlockComponent(){return Fo},EmbedLinkedDocBlockSpec:uy,EmbedLinkedDocModel:p$,EmbedLinkedDocService:f$,EmbedLinkedDocStyles:h$,get EmbedYoutubeBlockComponent(){return Uo},EmbedYoutubeBlockSpec:fy,EmbedYoutubeModel:g$,EmbedYoutubeService:Hp,EmbedYoutubeStyles:py,FontFamilyVariables:PM,get FrameBlockComponent(){return x5},FrameBlockModel:dc,FrameBlockSchema:xv,get FramePreview(){return yi},GroupElementModel:On,HtmlAdapter:Kg,HtmlTransformer:Ohe,ImageAdapter:cS,get ImageBlockComponent(){return _d},ImageBlockModel:Kb,ImageBlockSchema:I1,ImageService:hd,InlineManager:D0,get LangList(){return Jr},LinkedPageIcon:fb,get ListBlockComponent(){return xd},ListBlockSchema:wv,ListService:WP,MarkdownAdapter:Ws,MarkdownTransformer:Hhe,MixTextAdapter:tT,get NoteBlockComponent(){return b5},NoteBlockModel:s5,NoteBlockSchema:S1,NoteDisplayMode:qe,NoteService:BP,NotionHtmlAdapter:b9,PageBlockSchema:V3,PageIcon:b3,PageService:tv,get ParagraphBlockComponent(){return wd},ParagraphBlockSchema:mv,ParagraphService:VP,PlainTextAdapter:nT,PlusIcon:Sr,ReferenceNodeConfig:N0,get RichText(){return yn},ShapeElementModel:Ct,ShapeStyle:dn,SizeVariables:MM,StrokeStyle:Yt,StyleVariables:Ob,get SurfaceBlockComponent(){return ud},SurfaceBlockSchema:a3,get SurfaceRefBlockComponent(){return Bo},SurfaceRefBlockSchema:Q3,SurfaceRefBlockService:pv,SurfaceService:m$,TagsIcon:t5,TestUtils:Phe,TextElementModel:vn,ThemeObserver:cu,Viewport:E9,ZipTransformer:Vhe,__unstableSchemas:B0e,checkboxPureColumnConfig:Ev,createButtonPopper:Nt,createDefaultPage:Vg,createEmbedBlock:ku,customImageProxyMiddleware:q7,datePureColumnConfig:Sv,defaultImageProxyMiddleware:Xl,defineEmbedModel:Cu,extractCssVariables:L8,figmaUrlRegex:l$,generateKeyBetween:ds,getAffineInlineSpecsWithReference:R0,getAllowSelectedBlocks:IW,getThemeMode:Wo,githubUrlRegex:ay,insertPositionToIndex:Qr,linkPureColumnConfig:Tv,multiSelectColumnConfig:tA,multiSelectPureColumnConfig:hl,nanoidReplacement:Ahe,numberPureColumnConfig:F0,on:jd,onModelElementUpdated:rP,onModelTextUpdated:nv,once:Gd,popTagSelect:Z3,progressPureColumnConfig:r4,replaceIdMiddleware:Y2,richTextPureColumnConfig:i4,scrollbarStyle:uu,setImageProxyMiddlewareURL:rT,showImportModal:MP,youtubeUrlRegex:hy},Symbol.toStringTag,{value:"Module"}));var D0e=Object.defineProperty,O0e=Object.getOwnPropertyDescriptor,Y0=(t,e,n,i)=>{for(var r=i>1?void 0:i?O0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&D0e(e,n,r),r};const Zf=24;let Wa=class extends me(De){constructor(){super(...arguments),this._isReadonly=!1,this._isComposing=!1,this._onTitleKeyDown=t=>{if(t.isComposing||this.page.readonly)return;const e=!this.page.isEmpty;if(t.key==="Enter"&&e&&!t.isComposing){t.preventDefault();const n=this._inlineEditor;D(n);const i=n.getInlineRange();D(i);const r=this._pageModel.title.split(i.index);this._docPageElement.prependParagraphWithText(r)}else t.key==="ArrowDown"&&e?(t.preventDefault(),this._docPageElement.focusFirstParagraph()):t.key==="Tab"&&t.preventDefault()},this._updateTitleInMeta=()=>{this.page.workspace.setPageMeta(this.page.id,{title:this._pageModel.title.toString()})}}get _pageModel(){return this.page.root}get _inlineEditor(){return this._richTextElement.inlineEditor}get _docPageElement(){const t=this.closest(".affine-doc-viewport");D(t);const e=t.querySelector("affine-doc-page");return D(e),e}connectedCallback(){super.connectedCallback(),this._isReadonly=this.page.readonly,this._disposables.add(this.page.awarenessStore.slots.update.on(()=>{this._isReadonly!==this.page.readonly&&(this._isReadonly=this.page.readonly,this.requestUpdate())})),this._disposables.addFromEvent(this,"keydown",this._onTitleKeyDown),this._disposables.addFromEvent(this,"compositionstart",()=>this._isComposing=!0),this._disposables.addFromEvent(this,"compositionend",()=>this._isComposing=!1),this._pageModel.title.yText.observe(()=>{this._updateTitleInMeta(),this.requestUpdate()})}render(){const t=!this._pageModel.title.length&&!this._isComposing;return b`
      <div
        class="doc-title-container ${t?"doc-title-container-empty":""}"
        data-block-is-title="true"
      >
        <rich-text
          .yText=${this._pageModel.title.yText}
          .undoManager=${this.page.history}
          .readonly=${this.page.readonly}
          .enableFormat=${!1}
        ></rich-text>
      </div>
    `}};Wa.styles=X`
    .doc-title-container {
      box-sizing: border-box;
      font-family: var(--affine-font-family);
      font-size: var(--affine-font-base);
      line-height: var(--affine-line-height);
      color: var(--affine-text-primary-color);
      font-size: 40px;
      line-height: 50px;
      font-weight: 700;
      outline: none;
      resize: none;
      border: 0;
      width: 100%;
      max-width: var(--affine-editor-width);
      margin-left: auto;
      margin-right: auto;
      cursor: text;
      padding: 38px 0;

      padding-left: var(
        --affine-editor-side-padding,
        ${Zf}px
      );
      padding-right: var(
        --affine-editor-side-padding,
        ${Zf}px
      );
    }

    /* Extra small devices (phones, 640px and down) */
    @container viewport (width <= 640px) {
      .doc-title-container {
        padding-left: ${Zf}px;
        padding-right: ${Zf}px;
      }
    }

    .doc-title-container-empty::before {
      content: 'Title';
      color: var(--affine-placeholder-color);
      position: absolute;
      opacity: 0.5;
      pointer-events: none;
    }

    .doc-title-container:disabled {
      background-color: transparent;
    }
  `;Y0([L({attribute:!1})],Wa.prototype,"page",2);Y0([ie()],Wa.prototype,"_isReadonly",2);Y0([ie()],Wa.prototype,"_isComposing",2);Y0([he("rich-text")],Wa.prototype,"_richTextElement",2);Wa=Y0([W("doc-title")],Wa);const Wf=24,C$="Untitled";var R0e=Object.defineProperty,N0e=Object.getOwnPropertyDescriptor,k$=(t,e,n,i)=>{for(var r=i>1?void 0:i?N0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&R0e(e,n,r),r};let Up=class extends me(Ae){constructor(t){super(),this._showPopover=!1,this._onClickAway=e=>{e.target!==this&&this._showPopover&&(this._showPopover=!1,document.removeEventListener("mousedown",this._onClickAway))},this._backlinks=t}connectedCallback(){super.connectedCallback(),this.tabIndex=0}onClick(){this._showPopover=!this._showPopover,document.addEventListener("mousedown",this._onClickAway)}render(){const t=this._backlinks;return t.length?b`
      <div class="btn" @click="${this.onClick}">
        ${v3}<span>Backlinks (${t.length})</span>
        ${this._showPopover?H0e(t):null}
      </div>
    `:null}};Up.styles=X`
    :host {
      position: relative;
      display: flex;
    }

    .btn {
      padding: 0 12px;
      box-sizing: border-box;
      display: inline-flex;
      align-items: center;
      border: none;
      height: 30px;
      border-radius: 8px;
      gap: 4px;
      background: transparent;
      cursor: pointer;

      user-select: none;
      font-size: var(--affine-font-sm);
      font-family: ${Je(vt.fontSansFamily)};
      fill: var(--affine-text-secondary-color);
      color: var(--affine-text-secondary-color);
      pointer-events: auto;
    }

    .btn > span {
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    .btn:hover {
      background: var(--affine-hover-color);
    }

    .btn:active {
      background: var(--affine-hover-color);
    }

    .backlink-popover {
      position: absolute;
      left: 0;
      bottom: 0;
      transform: translateY(100%);
      z-index: 1;
      padding-top: 8px;
    }

    .menu {
      display: flex;
      flex-direction: column;
      padding: 8px 4px;
      background: var(--affine-white);
      box-shadow: var(--affine-menu-shadow);
      border-radius: 12px;
    }

    .backlink-popover .group-title {
      color: var(--affine-text-secondary-color);
      margin: 8px 12px;
    }

    .backlink-popover icon-button {
      padding: 8px;
      justify-content: flex-start;
      gap: 8px;
    }

    ${uu(".backlink-popover .group")}
  `;k$([ie()],Up.prototype,"_showPopover",2);Up=k$([W("backlink-button")],Up);function H0e(t){return b`<div
    class="backlink-popover"
    @click=${e=>e.stopPropagation()}
  >
    <div class="menu">
      <div class="group-title">Linked to this page</div>
      <div class="group" style="overflow-y: scroll; max-height: 372px;">
        ${t.map(e=>{const n=e.title||C$;return b`<icon-button
            width="248px"
            height="32px"
            text="${n}"
            @mousedown="${e.jump}"
          >
            ${e.icon}
          </icon-button>`})}
      </div>
    </div>
  </div>`}var F0e=Object.defineProperty,U0e=Object.getOwnPropertyDescriptor,X0=(t,e,n,i)=>{for(var r=i>1?void 0:i?U0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&F0e(e,n,r),r};let qa=class extends me(Ae){constructor(){super(...arguments),this.showSelect=!1,this.expanded=!1,this._listenBacklinkList=()=>{const t=Object.fromEntries(this.page.workspace.meta.pageMetas.map(r=>[r.id,r])),e=r=>{const o=t[r.pageId];return o||console.warn("Unexpected page meta not found",r.pageId),{...r,...o,icon:r.type==="LinkedPage"?fb:b3,jump:()=>{r.pageId!==this.page.id&&this.docPageElement.slots.pageLinkClicked.emit({pageId:r.pageId,blockId:r.blockId})}}},n=this.page.workspace.indexer.backlink,i=()=>n.getBacklink(this.page.id).filter(r=>r.type==="LinkedPage").map(e);this.backlinkList=i(),this._disposables.add(n.slots.indexUpdated.on(()=>{this.backlinkList=i()}))},this._toggle=()=>{this.expanded=!this.expanded},this._selectTags=()=>{this._disposables.add({dispose:Z3(this.shadowRoot?.querySelector(".tags")??this,{value:this.tags,onChange:t=>this.tags=t,options:this.options,onOptionsChange:t=>this.options=t})})},this._renderTagsInline=()=>{const t=this.tags,e=Object.fromEntries(this.options.map(n=>[n.id,n]));return b` <div class="tags-inline">
      ${t5}
      ${t.length>0?b` <div class="tag-list">
            ${Fe(t.slice(0,3),n=>n,(n,i)=>{const r=e[n];return r?b` <div>${i!==0?b`,&nbsp;`:""}</div>
                  <div class="tag-inline">${r.value}</div>`:null})}
            ${t.length>3?b`, and ${t.length-3} more`:""}
          </div>`:"Tags"}
    </div>`},this._renderBacklinkInline=()=>new Up(this.backlinkList),this._renderBacklinkExpanded=()=>{const t=this.backlinkList;return t.length?b`<div class="meta-data-expanded-column-item">
      <div class="backlink-title">
        ${v3}
        <span class="title">Linked to this page</span>
      </div>
      <div class="backlinks">
        ${Fe(t,n=>n.pageId,n=>b` <div @click=${n.jump} class="link">
        ${n.icon}
        <div class="link-title">${n.title||C$}</div>
      </div>`)}
      </div>
    </div>`:null},this._renderTagsExpanded=()=>{const t=Object.fromEntries(this.options.map(e=>[e.id,e]));return b` <div class="meta-data-expanded-item">
      <div class="type">${t5}</div>
      <div class="value">
        <div class="tags">
          ${Fe(this.tags,e=>e,e=>{const n=t[e];if(!n)return null;const i=we({backgroundColor:n.color});return b` <div class="tag" @click=${()=>{this.docPageElement.slots.tagClicked.emit({tagId:n.id})}} style=${i}>
                ${n.value}
              </div>`})}
          ${this.page.readonly?ae:b`<div class="add-tag" @click="${this._selectTags}">
                ${Sr}
              </div>`}
        </div>
      </div>
    </div>`}}get docPageElement(){const t=this.closest(".affine-doc-viewport");D(t);const e=t.querySelector("affine-doc-page");return D(e),e}get meta(){return this.page.workspace.meta}get options(){return this.meta.properties.tags?.options??[]}set options(t){this.tags=this.tags.filter(e=>t.find(n=>n.id===e)),this.page.workspace.meta.setProperties({...this.meta.properties,tags:{...this.meta.properties.tags,options:t}})}get tags(){return this.page.meta.tags??[]}set tags(t){this.page.meta.tags=t}connectedCallback(){super.connectedCallback(),this._listenBacklinkList(),this._disposables.add(this.meta.pageMetasUpdated.on(()=>{this.requestUpdate()}))}render(){return this.expanded?b`
      <div class="page-meta-container caret-ignore">
        <div class="meta-data-expanded caret-ignore">
          <div class="meta-data-expanded-title" @click="${this._toggle}">
            <div>Page info</div>
            <div class="close">${W1}</div>
          </div>
          <div class="meta-data-expanded-content">
            ${this._renderBacklinkExpanded()} ${this._renderTagsExpanded()}
          </div>
        </div>
      </div>
    `:b`
        <div class="page-meta-container caret-ignore">
          <div class="meta-data caret-ignore" @click="${this._toggle}">
            <div class="meta-data-content">
              ${this._renderBacklinkInline()} ${this._renderTagsInline()}
            </div>
            <div class="expand">${W1}</div>
          </div>
        </div>
      `}};qa.styles=X`
    .page-meta-container {
      font-family: ${Je(vt.fontSansFamily)};
      font-size: var(--affine-font-base);
      line-height: var(--affine-line-height);
      color: var(--affine-text-primary-color);
      display: block;
      box-sizing: border-box;
      max-width: var(--affine-editor-width);
      margin-left: auto;
      margin-right: auto;
      padding-left: var(
        --affine-editor-side-padding,
        ${Wf}px
      );
      padding-right: var(
        --affine-editor-side-padding,
        ${Wf}px
      );
    }

    /* Extra small devices (phones, 640px and down) */
    @container viewport (width <= 640px) {
      .page-meta-container {
        padding-left: ${Wf}px;
        padding-right: ${Wf}px;
      }
    }

    .meta-data {
      border-radius: 8px;
      display: flex;
      align-items: center;
      height: 30px;
      cursor: pointer;
      justify-content: space-between;
      margin: 0 -12px;
    }

    .meta-data-content {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--affine-text-secondary-color);
    }

    .meta-data:hover {
      background-color: var(--affine-hover-color);
    }

    .tags-inline {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 14px;
    }

    .tags-inline .tag-list {
      display: flex;
      align-items: center;
    }

    .tag-inline {
      max-width: 100px;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    .expand {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
    }

    .expand svg {
      color: var(--affine-icon-color);
    }

    .meta-data-expanded {
      padding: 10px 12px 24px;
      margin: 0 -24px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background-color: var(--affine-hover-color-filled);
      border-radius: 8px;
    }

    .meta-data-expanded-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 12px;
      font-weight: 600;
      font-size: 14px;
      color: var(--affine-text-secondary-color);
      border-radius: 4px;
      cursor: pointer;
    }

    .meta-data-expanded-title:hover {
      background-color: var(--affine-hover-color);
    }

    .meta-data-expanded-title .close {
      transform: rotate(180deg);
      border-radius: 4px;
      display: flex;
      align-items: center;
    }

    @media print {
      .meta-data-expanded-title .close {
        display: none;
      }

      .expand {
        display: none;
      }
    }

    .meta-data-expanded-title .close:hover {
      background-color: var(--affine-hover-color);
    }

    .meta-data-expanded-content {
      display: flex;
      flex-direction: column;
      gap: 24px;
      padding: 0 12px;
    }

    .meta-data-expanded-column-item {
      display: flex;
      flex-direction: column;
    }

    .meta-data-expanded-column-item .backlink-title {
      display: flex;
      align-items: center;
      gap: 8px;
      fill: var(--affine-icon-color);
    }

    .meta-data-expanded-column-item .backlinks {
      margin-left: 24px;
    }

    .meta-data-expanded-item {
      display: flex;
      gap: 8px;
    }

    .meta-data-expanded-item .value {
      flex: 1;
    }

    .add-tag {
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .add-tag svg {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      fill: var(--affine-icon-color);
    }

    .add-tag:hover svg {
      background-color: var(--affine-hover-color);
    }

    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tag {
      padding: 4px 10px;
      border-radius: 8px;
      color: var(--affine-text-primary-color);
      font-size: 13px;
      line-height: 13px;
      display: flex;
      align-items: center;
      font-weight: 400;
      cursor: pointer;
    }

    .backlinks {
      display: flex;
      gap: 8px;
      flex-direction: column;
    }

    .backlinks .title {
      height: 28px;
      color: var(--affine-text-secondary-color);
      font-size: var(--affine-font-sm);
    }

    .backlinks .link {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 15px;
      cursor: pointer;
      width: max-content;
      border-radius: 4px;
      padding: 0 8px 0 4px;
      margin: 0 -8px 0 -4px;
    }

    .backlinks .link:hover {
      background-color: var(--affine-hover-color);
    }

    .backlinks .link svg {
      fill: var(--affine-icon-color);
    }

    .link-title {
      border-bottom: 0.5px solid var(--affine-divider-color);
    }

    .backlinks .link:hover .link-title {
      border-bottom-color: transparent;
    }
  `;X0([L({attribute:!1})],qa.prototype,"page",2);X0([ie()],qa.prototype,"backlinkList",2);X0([ie()],qa.prototype,"showSelect",2);X0([ie()],qa.prototype,"expanded",2);qa=X0([W("page-meta-tags")],qa);var V0e=Object.defineProperty,z0e=Object.getOwnPropertyDescriptor,S4=(t,e,n,i)=>{for(var r=i>1?void 0:i?z0e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&V0e(e,n,r),r};let Rd=class extends me(De){constructor(){super(...arguments),this.specs=E4,this.hasViewport=!0,this._host=Ri()}get host(){return this._host.value}render(){return b`
      <style>
        doc-editor {
          font-family: var(--affine-font-family);
          background: var(--affine-background-primary-color);
        }

        doc-editor * {
          box-sizing: border-box;
        }

        @media print {
          doc-editor {
            height: auto;
          }
        }

        .affine-doc-viewport {
          position: relative;
          height: 100%;
          overflow-x: hidden;
          overflow-y: auto;
          user-select: none;
          container-name: viewport;
          container-type: inline-size;
        }

        .doc-editor-container {
          display: block;
          height: 100%;
          user-select: none;
        }
      </style>
      <div
        class=${this.hasViewport?"affine-doc-viewport":"doc-editor-container"}
      >
        <editor-host
          ${$t(this._host)}
          .page=${this.page}
          .specs=${this.specs}
        ></editor-host>
      </div>
    `}};S4([L({attribute:!1})],Rd.prototype,"page",2);S4([L({attribute:!1})],Rd.prototype,"specs",2);S4([L({type:Boolean})],Rd.prototype,"hasViewport",2);Rd=S4([W("doc-editor")],Rd);const j0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M2.11621 2.63482C2.11621 2.35056 2.34665 2.12012 2.63092 2.12012H3.39072H12.5084H13.2682C13.5524 2.12012 13.7829 2.35056 13.7829 2.63482C13.7829 2.91909 13.5524 3.14953 13.2682 3.14953H13.0231V9.71839H13.2682C13.5524 9.71839 13.7829 9.94884 13.7829 10.2331C13.7829 10.5174 13.5524 10.7478 13.2682 10.7478H8.46425V11.8554L11.0922 13.3571C11.339 13.4981 11.4247 13.8125 11.2837 14.0594C11.1427 14.3062 10.8282 14.3919 10.5814 14.2509L8.46425 13.0411V14.0321C8.46425 14.3164 8.23381 14.5468 7.94954 14.5468C7.66528 14.5468 7.43484 14.3164 7.43484 14.0321V13.0845L5.39364 14.2509C5.14683 14.3919 4.83241 14.3062 4.69138 14.0594C4.55035 13.8125 4.63609 13.4981 4.8829 13.3571L7.43484 11.8989V10.7478H2.63092C2.34665 10.7478 2.11621 10.5174 2.11621 10.2331C2.11621 9.94884 2.34665 9.71839 2.63092 9.71839H2.87601V3.14953H2.63092C2.34665 3.14953 2.11621 2.91909 2.11621 2.63482ZM3.90543 3.14953H11.9937V9.71815H3.90543V3.14953ZM6.18484 6.05396C6.18484 5.7697 5.9544 5.53926 5.67013 5.53926C5.38587 5.53926 5.15543 5.7697 5.15543 6.05396V7.57357C5.15543 7.85783 5.38587 8.08828 5.67013 8.08828C5.9544 8.08828 6.18484 7.85783 6.18484 7.57357V6.05396ZM7.94954 4.3996C8.23381 4.3996 8.46425 4.63004 8.46425 4.91431V7.57362C8.46425 7.85788 8.23381 8.08832 7.94954 8.08832C7.66528 8.08832 7.43484 7.85788 7.43484 7.57362V4.91431C7.43484 4.63004 7.66528 4.3996 7.94954 4.3996ZM10.7437 6.81396C10.7437 6.5297 10.5132 6.29925 10.229 6.29925C9.94469 6.29925 9.71425 6.5297 9.71425 6.81396V7.57376C9.71425 7.85803 9.94469 8.08847 10.229 8.08847C10.5132 8.08847 10.7437 7.85803 10.7437 7.57376V6.81396Z"
  />
</svg>`,E$=b`
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M7.9965 3.45031C8.50641 1.3499 11.4936 1.3499 12.0035 3.45031C12.1332 3.9845 12.7452 4.23801 13.2146 3.95198C15.0604 2.82733 17.1727 4.93958 16.048 6.78536C15.762 7.25479 16.0155 7.86681 16.5497 7.9965C18.6501 8.50641 18.6501 11.4936 16.5497 12.0035C16.0155 12.1332 15.762 12.7452 16.048 13.2146C17.1727 15.0604 15.0604 17.1727 13.2146 16.048C12.7452 15.762 12.1332 16.0155 12.0035 16.5497C11.4936 18.6501 8.50641 18.6501 7.9965 16.5497C7.86681 16.0155 7.25479 15.762 6.78536 16.048C4.93958 17.1727 2.82733 15.0604 3.95198 13.2146C4.23801 12.7452 3.9845 12.1332 3.45031 12.0035C1.3499 11.4936 1.3499 8.50641 3.45031 7.9965C3.9845 7.86681 4.23801 7.25479 3.95198 6.78536C2.82733 4.93958 4.93958 2.82733 6.78536 3.95198C7.25479 4.23801 7.86681 3.9845 7.9965 3.45031ZM10.7888 3.74521C10.588 2.91826 9.41197 2.91827 9.21121 3.7452C8.88182 5.10205 7.3273 5.74595 6.13495 5.01944C5.40826 4.57666 4.57666 5.40826 5.01944 6.13495C5.74595 7.3273 5.10205 8.88182 3.7452 9.21121C2.91827 9.41197 2.91826 10.588 3.74521 10.7888C5.10205 11.1182 5.74595 12.6727 5.01944 13.8651C4.57666 14.5917 5.40826 15.4233 6.13495 14.9806C7.3273 14.2541 8.88182 14.898 9.21121 16.2548C9.41197 17.0817 10.588 17.0817 10.7888 16.2548C11.1182 14.898 12.6727 14.2541 13.8651 14.9806C14.5917 15.4233 15.4233 14.5917 14.9806 13.8651C14.2541 12.6727 14.898 11.1182 16.2548 10.7888C17.0817 10.588 17.0817 9.41197 16.2548 9.21121C14.898 8.88182 14.2541 7.3273 14.9806 6.13495C15.4233 5.40826 14.5917 4.57666 13.8651 5.01944C12.6727 5.74595 11.1182 5.10205 10.7888 3.74521ZM10 8.125C8.96447 8.125 8.125 8.96447 8.125 10C8.125 11.0355 8.96447 11.875 10 11.875C11.0355 11.875 11.875 11.0355 11.875 10C11.875 8.96447 11.0355 8.125 10 8.125ZM6.875 10C6.875 8.27411 8.27411 6.875 10 6.875C11.7259 6.875 13.125 8.27411 13.125 10C13.125 11.7259 11.7259 13.125 10 13.125C8.27411 13.125 6.875 11.7259 6.875 10Z"
      fill="currentColor"
    />
  </svg>
`,G0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M7.77623 1.55279C7.91699 1.4824 8.08268 1.4824 8.22344 1.55279L13.5568 4.21945C13.7262 4.30415 13.8332 4.47728 13.8332 4.66667V11.3333C13.8332 11.5227 13.7262 11.6959 13.5568 11.7805L8.22344 14.4472C8.08268 14.5176 7.91699 14.5176 7.77623 14.4472L2.4429 11.7805C2.27351 11.6959 2.1665 11.5227 2.1665 11.3333V4.66667C2.1665 4.47728 2.27351 4.30415 2.4429 4.21945L7.77623 1.55279ZM3.1665 5.47568L7.49984 7.64235V13.191L3.1665 11.0243V5.47568ZM8.49984 13.191L12.8332 11.0243V5.47568L8.49984 7.64235V13.191ZM7.99984 6.77432L12.2151 4.66667L7.99984 2.55902L3.78454 4.66667L7.99984 6.77432Z"
  />
</svg>`,Z0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.1665 2.66666C2.1665 2.39051 2.39036 2.16666 2.6665 2.16666H13.3332C13.6093 2.16666 13.8332 2.39051 13.8332 2.66666V4.44443C13.8332 4.72058 13.6093 4.94443 13.3332 4.94443C13.057 4.94443 12.8332 4.72058 12.8332 4.44443V3.16666H8.49984V12.8333H10.6665C10.9426 12.8333 11.1665 13.0572 11.1665 13.3333C11.1665 13.6095 10.9426 13.8333 10.6665 13.8333H5.33317C5.05703 13.8333 4.83317 13.6095 4.83317 13.3333C4.83317 13.0572 5.05703 12.8333 5.33317 12.8333H7.49984V3.16666H3.1665V4.44443C3.1665 4.72058 2.94265 4.94443 2.6665 4.94443C2.39036 4.94443 2.1665 4.72058 2.1665 4.44443V2.66666Z"
  />
</svg>`,W0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M11.9501 4.38557V11.6509C11.9501 12.052 12.1707 12.2926 12.525 12.2926C12.8859 12.2926 13.0998 12.0587 13.0998 11.6509V3.81744C13.0998 3.36294 12.799 3.0488 12.3712 3.0488C12.1106 3.0488 11.8766 3.14906 11.4555 3.4632L10.1054 4.46578C9.83804 4.65961 9.71105 4.84007 9.71105 5.03391C9.71105 5.28789 9.91156 5.49509 10.1589 5.49509C10.3059 5.49509 10.4463 5.44162 10.6401 5.30126L11.8967 4.38557H11.9501ZM2.94643 3.26836C3.22993 3.26836 3.45975 3.49818 3.45975 3.78168V7.34927H7.57203V3.78168C7.57203 3.49818 7.80185 3.26836 8.08535 3.26836C8.36885 3.26836 8.59867 3.49818 8.59867 3.78168V7.86259V11.9435C8.59867 12.227 8.36885 12.4568 8.08535 12.4568C7.80185 12.4568 7.57203 12.227 7.57203 11.9435V8.37591H3.45975V11.9435C3.45975 12.227 3.22993 12.4568 2.94643 12.4568C2.66293 12.4568 2.43311 12.227 2.43311 11.9435V3.78168C2.43311 3.49818 2.66293 3.26836 2.94643 3.26836Z"
  />
</svg>`,q0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M9.43899 10.6664C9.06418 11.092 8.95618 11.2699 8.95618 11.4986C8.95618 11.8671 9.24841 12.0894 9.71216 12.0894H13.905C14.2544 12.0894 14.4577 11.9052 14.4577 11.6066C14.4577 11.3017 14.2417 11.1174 13.905 11.1174H10.3792V11.0412L12.7297 8.35396C13.8732 7.05164 14.1972 6.44812 14.1972 5.62226C14.1972 4.22465 13.0982 3.23361 11.5354 3.23361C9.85828 3.23361 8.81007 4.36441 8.81007 5.44438C8.81007 5.78743 9.01336 6.02249 9.32464 6.02249C9.58511 6.02249 9.76298 5.85096 9.85192 5.51426C10.0425 4.6884 10.646 4.19924 11.4655 4.19924C12.4311 4.19924 13.0728 4.7964 13.0728 5.69214C13.0728 6.2893 12.7996 6.82294 12.0817 7.64245L9.43899 10.6664ZM2.27891 3.57571C2.54836 3.57571 2.7668 3.79415 2.7668 4.0636V7.45447H6.67536V4.0636C6.67536 3.79415 6.8938 3.57571 7.16326 3.57571C7.43271 3.57571 7.65115 3.79415 7.65115 4.0636V7.94236V11.8211C7.65115 12.0906 7.43271 12.309 7.16326 12.309C6.8938 12.309 6.67536 12.0906 6.67536 11.8211V8.43026H2.7668V11.8211C2.7668 12.0906 2.54836 12.309 2.27891 12.309C2.00945 12.309 1.79102 12.0906 1.79102 11.8211V4.0636C1.79102 3.79415 2.00945 3.57571 2.27891 3.57571Z"
  />
</svg>`,Y0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.69991 3.90388C2.69991 3.62782 2.47612 3.40402 2.20005 3.40402C1.92399 3.40402 1.7002 3.62782 1.7002 3.90388V11.8516C1.7002 12.1277 1.92399 12.3515 2.20005 12.3515C2.47612 12.3515 2.69991 12.1277 2.69991 11.8516V8.37761H6.70432V11.8516C6.70432 12.1277 6.92812 12.3515 7.20418 12.3515C7.48025 12.3515 7.70404 12.1277 7.70404 11.8516V7.87775V3.90388C7.70404 3.62782 7.48025 3.40402 7.20418 3.40402C6.92812 3.40402 6.70432 3.62782 6.70432 3.90388V7.37789H2.69991V3.90388ZM9.01949 10.06C8.74072 10.06 8.54431 10.2628 8.54431 10.5479C8.54431 11.5172 9.74177 12.5056 11.3764 12.5056C13.1377 12.5056 14.3669 11.4665 14.3669 9.98398C14.3669 8.89423 13.5496 7.95654 12.4788 7.83616V7.7728C13.3595 7.62074 14.0754 6.7084 14.0754 5.7517C14.0754 4.43386 12.9477 3.48984 11.3637 3.48984C9.80512 3.48984 8.74705 4.4402 8.74705 5.42224C8.74705 5.73903 8.93713 5.94811 9.22857 5.94811C9.47567 5.94811 9.63406 5.81506 9.76077 5.46659C10.0142 4.81401 10.5844 4.4402 11.3384 4.4402C12.3077 4.4402 12.9603 5.02309 12.9603 5.89108C12.9603 6.75908 12.2887 7.38632 11.3637 7.38632H10.6161C10.312 7.38632 10.1092 7.58273 10.1092 7.8615C10.1092 8.13394 10.3247 8.34302 10.6161 8.34302H11.4081C12.5105 8.34302 13.2518 8.9956 13.2518 9.96497C13.2518 10.9343 12.5295 11.5552 11.3954 11.5552C10.5337 11.5552 9.87482 11.1751 9.54536 10.4972C9.38063 10.174 9.24124 10.06 9.01949 10.06Z"
  />
</svg>`,X0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M12.5287 10.5032V11.791C12.5287 12.1589 12.719 12.3682 13.0552 12.3682C13.3977 12.3682 13.588 12.1589 13.588 11.791V10.5032H14.2478C14.6093 10.5032 14.8123 10.3256 14.8123 10.0211C14.8123 9.71028 14.603 9.53267 14.2478 9.53267H13.588V4.46418C13.588 3.87424 13.2645 3.54437 12.6873 3.54437C12.2496 3.54437 11.9578 3.73468 11.5835 4.28657C10.1435 6.44337 9.57259 7.35683 8.66546 8.96175C8.44344 9.36773 8.36731 9.58976 8.36731 9.82447C8.36731 10.2431 8.69718 10.5032 9.19197 10.5032H12.5287ZM12.5287 9.53267H9.43303V9.46923C10.264 8.02925 11.3932 6.215 12.4716 4.62277H12.5287V9.53267ZM1.96619 3.80359C2.23525 3.80359 2.45337 4.02171 2.45337 4.29077V7.67669H6.35625V4.29077C6.35625 4.02171 6.57436 3.80359 6.84343 3.80359C7.11249 3.80359 7.33061 4.02171 7.33061 4.29077V8.16387V12.037C7.33061 12.306 7.11249 12.5242 6.84343 12.5242C6.57436 12.5242 6.35625 12.306 6.35625 12.037V8.65106H2.45337V12.037C2.45337 12.306 2.23525 12.5242 1.96619 12.5242C1.69712 12.5242 1.479 12.306 1.479 12.037V4.29077C1.479 4.02171 1.69712 3.80359 1.96619 3.80359Z"
  />
</svg>`,K0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M9.07668 10.0351C8.804 10.0351 8.62427 10.2458 8.62427 10.5556C8.62427 11.4233 9.64684 12.4211 11.2829 12.4211C13.012 12.4211 14.2453 11.2064 14.2453 9.49589C14.2453 7.89076 13.136 6.76284 11.5618 6.76284C10.8491 6.76284 10.124 7.06031 9.84515 7.47554H9.78318L10.0187 4.7177H13.3591C13.7247 4.7177 13.9292 4.55037 13.9292 4.2529C13.9292 3.94922 13.7185 3.7695 13.3591 3.7695H9.88234C9.34936 3.7695 9.08288 3.98641 9.04569 4.44502L8.77301 7.91555C8.74202 8.39275 8.92175 8.67163 9.275 8.67163C9.47331 8.67163 9.59726 8.59727 10.0497 8.17584C10.4091 7.85358 10.8367 7.69245 11.3201 7.69245C12.3923 7.69245 13.1545 8.46092 13.1545 9.55166C13.1545 10.692 12.3675 11.4852 11.2396 11.4852C10.4959 11.4852 9.92572 11.1258 9.58486 10.4627C9.42373 10.1466 9.28739 10.0351 9.07668 10.0351ZM2.05457 3.9359C2.31743 3.9359 2.53053 4.14899 2.53053 4.41185V7.71977H6.34347V4.41185C6.34347 4.14899 6.55657 3.9359 6.81943 3.9359C7.0823 3.9359 7.29539 4.14899 7.29539 4.41185V8.19573V11.9796C7.29539 12.2425 7.0823 12.4556 6.81943 12.4556C6.55657 12.4556 6.34347 12.2425 6.34347 11.9796V8.67169H2.53053V11.9796C2.53053 12.2425 2.31743 12.4556 2.05457 12.4556C1.79171 12.4556 1.57861 12.2425 1.57861 11.9796V4.41185C1.57861 4.14899 1.79171 3.9359 2.05457 3.9359Z"
  />
</svg>`,Q0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M11.7668 3.6778C9.70114 3.6778 8.55013 5.339 8.55013 8.33165C8.55013 9.61955 8.76166 10.5839 9.19096 11.2683C9.70114 12.0709 10.5411 12.5064 11.5925 12.5064C13.3222 12.5064 14.4919 11.343 14.4919 9.632C14.4919 8.00812 13.3844 6.86955 11.8041 6.86955C10.8335 6.86955 9.94379 7.40461 9.65759 8.16367H9.60782C9.62648 5.83674 10.3606 4.61728 11.7481 4.61728C12.3018 4.61728 12.7684 4.81637 13.2164 5.25812C13.4404 5.47588 13.571 5.54432 13.7453 5.54432C14.0128 5.54432 14.2057 5.34522 14.2057 5.07769C14.2057 4.79149 13.9568 4.44929 13.5462 4.18176C13.0733 3.85823 12.4325 3.6778 11.7668 3.6778ZM11.6361 11.5732C10.5349 11.5732 9.76336 10.783 9.76336 9.66933C9.76336 8.56808 10.5162 7.79658 11.5925 7.79658C12.7 7.79658 13.4217 8.54319 13.4217 9.67555C13.4217 10.8203 12.7062 11.5732 11.6361 11.5732ZM2.30302 3.99417C2.56692 3.99417 2.78085 4.2081 2.78085 4.472V7.79291H6.60878V4.472C6.60878 4.2081 6.82271 3.99417 7.08661 3.99417C7.35051 3.99417 7.56444 4.2081 7.56444 4.472V8.27074V12.0695C7.56444 12.3334 7.35051 12.5473 7.08661 12.5473C6.82271 12.5473 6.60878 12.3334 6.60878 12.0695V8.74857H2.78085V12.0695C2.78085 12.3334 2.56692 12.5473 2.30302 12.5473C2.03913 12.5473 1.8252 12.3334 1.8252 12.0695V4.472C1.8252 4.2081 2.03913 3.99417 2.30302 3.99417Z"
  />
</svg>`,J0e=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M1.5 3.99999C1.5 2.98747 2.32081 2.16666 3.33333 2.16666H12.6667C13.6792 2.16666 14.5 2.98747 14.5 3.99999V12C14.5 13.0125 13.6792 13.8333 12.6667 13.8333H3.33333C2.32081 13.8333 1.5 13.0125 1.5 12V3.99999ZM3.33333 3.16666C2.8731 3.16666 2.5 3.53975 2.5 3.99999V12C2.5 12.4602 2.8731 12.8333 3.33333 12.8333H12.6667C13.1269 12.8333 13.5 12.4602 13.5 12V3.99999C13.5 3.53975 13.1269 3.16666 12.6667 3.16666H3.33333ZM7.02022 6.24637C7.21548 6.44163 7.21548 6.75822 7.02022 6.95348L5.95956 8.01414L7.02022 9.0748C7.21548 9.27006 7.21548 9.58664 7.02022 9.78191C6.82496 9.97717 6.50838 9.97717 6.31311 9.78191L4.8989 8.36769C4.70364 8.17243 4.70364 7.85585 4.8989 7.66058L6.31311 6.24637C6.50838 6.05111 6.82496 6.05111 7.02022 6.24637ZM8.97978 6.95348C8.78452 6.75822 8.78452 6.44163 8.97978 6.24637C9.17504 6.05111 9.49162 6.05111 9.68689 6.24637L11.1011 7.66058C11.2964 7.85585 11.2964 8.17243 11.1011 8.36769L9.68689 9.78191C9.49162 9.97717 9.17504 9.97717 8.97978 9.78191C8.78452 9.58664 8.78452 9.27006 8.97978 9.0748L10.0404 8.01414L8.97978 6.95348Z"
  />
</svg>`,efe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.3335 7.31033V7.39684V10.0405C3.3335 10.4175 3.63908 10.7231 4.01604 10.7231H6.74619C7.12315 10.7231 7.42873 10.4175 7.42873 10.0405V7.31033C7.42873 6.93337 7.12315 6.62779 6.74619 6.62779H4.46965C4.78293 5.77502 5.60225 5.16666 6.56365 5.16666V4.16666C4.83323 4.16666 3.42062 5.52736 3.33738 7.23713C3.33481 7.26118 3.3335 7.2856 3.3335 7.31033ZM8.66683 7.31033V7.39684V10.0405C8.66683 10.4175 8.97242 10.7231 9.34937 10.7231H12.0795C12.4565 10.7231 12.7621 10.4175 12.7621 10.0405V7.31033C12.7621 6.93337 12.4565 6.62779 12.0795 6.62779H9.80298C10.1163 5.77502 10.9356 5.16666 11.897 5.16666V4.16666C10.1666 4.16666 8.75396 5.52736 8.67071 7.23713C8.66815 7.26118 8.66683 7.2856 8.66683 7.31033Z"
  />
</svg>`,tfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.75263 3.84138C2.7875 3.82966 2.81892 3.81149 2.85247 3.7882L3.02274 3.67024V5.09333C3.02274 5.21841 3.06494 5.32694 3.14381 5.40422C3.22253 5.48134 3.33201 5.52173 3.45631 5.52173C3.58061 5.52173 3.69008 5.48134 3.7688 5.40422C3.84767 5.32694 3.88988 5.21841 3.88988 5.09333V3.28924C3.88988 3.15004 3.84638 3.02903 3.75909 2.94279C3.67187 2.85661 3.54844 2.81259 3.40289 2.81259C3.25521 2.81259 3.11383 2.82725 2.95315 2.93437L2.50128 3.23619C2.38666 3.31397 2.3335 3.41753 2.3335 3.54254C2.3335 3.72466 2.46885 3.85721 2.643 3.85721C2.68225 3.85721 2.71723 3.85327 2.75263 3.84138ZM6.27061 3.73435C5.98781 3.73433 5.75855 3.96357 5.75853 4.24636C5.75851 4.52916 5.98775 4.75843 6.27055 4.75844L13.1548 4.75886C13.4375 4.75887 13.6668 4.52964 13.6668 4.24684C13.6668 3.96404 13.4376 3.73478 13.1548 3.73476L6.27061 3.73435ZM6.27061 7.48937C5.98781 7.48935 5.75855 7.71859 5.75853 8.00139C5.75851 8.28419 5.98775 8.51345 6.27055 8.51347L13.1548 8.51388C13.4375 8.5139 13.6668 8.28466 13.6668 8.00186C13.6668 7.71907 13.4376 7.4898 13.1548 7.48978L6.27061 7.48937ZM6.27061 11.2444C5.98781 11.2444 5.75855 11.4736 5.75853 11.7564C5.75851 12.0392 5.98775 12.2685 6.27055 12.2685L13.1548 12.2689C13.4375 12.2689 13.6668 12.0397 13.6668 11.7569C13.6668 11.4741 13.4376 11.2448 13.1548 11.2448L6.27061 11.2444ZM4.41634 7.40936C4.42422 7.36536 4.4281 7.31884 4.4281 7.26872C4.4281 6.81727 4.04212 6.51228 3.43732 6.51228C3.00309 6.51228 2.65331 6.69665 2.52235 6.99302C2.51378 7.0128 2.50697 7.03283 2.50184 7.05321C2.50698 7.03281 2.51379 7.01276 2.52237 6.99296C2.65332 6.69658 3.00311 6.51221 3.43733 6.51221C4.04214 6.51221 4.42811 6.8172 4.42811 7.26865C4.42811 7.3188 4.42423 7.36534 4.41634 7.40936ZM3.41666 8.50244L3.41664 8.50246V8.51624H4.20582C4.38847 8.51624 4.49185 8.6248 4.49185 8.79194C4.49185 8.81314 4.49012 8.83346 4.4867 8.8528C4.49013 8.83344 4.49187 8.81309 4.49187 8.79187C4.49187 8.62473 4.38848 8.51618 4.20583 8.51618H3.41666V8.50244ZM2.49348 8.6609C2.51659 8.5679 2.5776 8.48696 2.68261 8.39901L3.36669 7.81315C3.59238 7.6195 3.68741 7.51146 3.71552 7.39886C3.68743 7.51148 3.5924 7.61953 3.36667 7.81322L2.6826 8.39907C2.57761 8.487 2.5166 8.56793 2.49348 8.6609ZM3.00245 7.45443C3.06576 7.41681 3.11852 7.35977 3.16964 7.28495C3.21335 7.22183 3.25281 7.18128 3.29247 7.1562C3.33084 7.13193 3.37305 7.11981 3.42699 7.11981C3.50193 7.11981 3.55935 7.14261 3.59712 7.17634C3.63429 7.20954 3.65682 7.25704 3.65682 7.3169C3.65682 7.42985 3.60418 7.51941 3.32223 7.76134L2.63848 8.34692C2.49238 8.46935 2.41446 8.59008 2.41446 8.75224C2.41446 8.85608 2.44402 8.95426 2.51569 9.02649C2.58758 9.09893 2.69247 9.13584 2.82391 9.13584H4.20583C4.3113 9.13584 4.40151 9.10321 4.46551 9.03949C4.52944 8.97584 4.56014 8.88822 4.56014 8.79187C4.56014 8.69411 4.52962 8.60621 4.4653 8.54275C4.40102 8.47933 4.31071 8.4479 4.20583 8.4479H3.58427L3.91453 8.16286C4.10644 7.99664 4.25236 7.86448 4.34915 7.72979C4.44874 7.59122 4.49639 7.45023 4.49639 7.26865C4.49639 7.02144 4.38982 6.81248 4.20121 6.66707C4.01414 6.52284 3.75049 6.44394 3.43733 6.44394C2.98691 6.44394 2.6054 6.63612 2.45972 6.96581C2.43335 7.02666 2.42135 7.08939 2.42135 7.15493C2.42135 7.25795 2.45508 7.34823 2.52273 7.41249C2.58996 7.47636 2.68328 7.50751 2.78945 7.50751C2.86827 7.50751 2.93794 7.49275 3.00245 7.45443ZM2.44775 10.719C2.54915 10.4427 2.89358 10.1498 3.48551 10.1498C3.79028 10.1498 4.06201 10.2143 4.2587 10.3429C4.45674 10.4724 4.57779 10.6666 4.57779 10.9199C4.57779 11.2418 4.37235 11.4559 4.11613 11.5475C4.27228 11.5803 4.40301 11.6428 4.5004 11.7332C4.62307 11.8472 4.69016 12.003 4.69016 12.1916C4.69016 12.461 4.57389 12.6824 4.36382 12.8353C4.15486 12.9874 3.85534 13.0703 3.48925 13.0703C2.84939 13.0703 2.49302 12.7649 2.39522 12.4915C2.3769 12.4406 2.36887 12.3842 2.36887 12.3395C2.36887 12.2333 2.40451 12.144 2.47207 12.0815C2.53931 12.0193 2.63451 11.987 2.74761 11.987C2.82533 11.987 2.89225 11.9998 2.95092 12.0293C3.00974 12.0588 3.05785 12.1039 3.09973 12.1647C3.14935 12.2373 3.19619 12.2916 3.2569 12.3283C3.31713 12.3648 3.39437 12.3859 3.50798 12.3859C3.69342 12.3859 3.8147 12.276 3.8147 12.1335C3.8147 12.0471 3.78226 11.9841 3.7209 11.9412C3.65761 11.897 3.55985 11.8717 3.42558 11.8717H3.40685C3.30795 11.8717 3.22859 11.8442 3.1739 11.7906C3.11916 11.7369 3.09366 11.6617 3.09366 11.5754C3.09366 11.4925 3.11937 11.418 3.17378 11.3641C3.22823 11.3102 3.30745 11.281 3.40685 11.281H3.42558C3.54389 11.281 3.63283 11.2551 3.69126 11.2124C3.74841 11.1706 3.77911 11.1108 3.77911 11.0342C3.77911 10.9599 3.75194 10.902 3.70443 10.862C3.65624 10.8215 3.58381 10.7968 3.48925 10.7968C3.41343 10.7968 3.35069 10.8121 3.29851 10.8419C3.24639 10.8716 3.20271 10.9169 3.16682 10.9799C3.12025 11.0624 3.06988 11.122 3.00589 11.1606C2.94171 11.1992 2.86754 11.2144 2.77758 11.2144C2.66225 11.2144 2.57171 11.1804 2.50997 11.1187C2.44832 11.0571 2.41944 10.9717 2.41944 10.8769C2.41944 10.8202 2.42781 10.7749 2.44775 10.719Z"
  />
</svg>`,nfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.86686 4.99999C3.23505 4.99999 3.53353 4.70151 3.53353 4.33332C3.53353 3.96513 3.23505 3.66666 2.86686 3.66666C2.49867 3.66666 2.2002 3.96513 2.2002 4.33332C2.2002 4.70151 2.49867 4.99999 2.86686 4.99999ZM5.55577 3.83381C5.27963 3.8338 5.05576 4.05764 5.05575 4.33378C5.05573 4.60993 5.27958 4.8338 5.55572 4.83381L13.5001 4.83425C13.7763 4.83427 14.0002 4.61042 14.0002 4.33428C14.0002 4.05814 13.7763 3.83427 13.5002 3.83425L5.55577 3.83381ZM5.55578 7.50051C5.27963 7.5005 5.05576 7.72434 5.05575 8.00048C5.05573 8.27662 5.27957 8.5005 5.55572 8.50051L13.5002 8.50099C13.7763 8.50101 14.0002 8.27716 14.0002 8.00102C14.0002 7.72488 13.7764 7.50101 13.5002 7.50099L5.55578 7.50051ZM5.55578 11.1672C5.27963 11.1672 5.05576 11.391 5.05575 11.6671C5.05573 11.9433 5.27957 12.1672 5.55571 12.1672L13.5002 12.1677C13.7763 12.1677 14.0002 11.9438 14.0002 11.6677C14.0002 11.3915 13.7764 11.1677 13.5002 11.1677L5.55578 11.1672ZM3.53353 7.99999C3.53353 8.36818 3.23505 8.66666 2.86686 8.66666C2.49867 8.66666 2.2002 8.36818 2.2002 7.99999C2.2002 7.6318 2.49867 7.33332 2.86686 7.33332C3.23505 7.33332 3.53353 7.6318 3.53353 7.99999ZM2.86686 12.3333C3.23505 12.3333 3.53353 12.0348 3.53353 11.6667C3.53353 11.2985 3.23505 11 2.86686 11C2.49867 11 2.2002 11.2985 2.2002 11.6667C2.2002 12.0348 2.49867 12.3333 2.86686 12.3333Z"
  />
</svg>`,ife=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.99984 2.16666C2.98732 2.16666 2.1665 2.98747 2.1665 3.99999V12C2.1665 13.0125 2.98732 13.8333 3.99984 13.8333H11.9998C13.0124 13.8333 13.8332 13.0125 13.8332 12V3.99999C13.8332 2.98747 13.0124 2.16666 11.9998 2.16666H3.99984ZM3.1665 3.99999C3.1665 3.53975 3.5396 3.16666 3.99984 3.16666H11.9998C12.4601 3.16666 12.8332 3.53975 12.8332 3.99999V12C12.8332 12.4602 12.4601 12.8333 11.9998 12.8333H3.99984C3.5396 12.8333 3.1665 12.4602 3.1665 12V3.99999ZM11.0201 6.35354C11.2153 6.15828 11.2153 5.8417 11.0201 5.64644C10.8248 5.45117 10.5082 5.45117 10.3129 5.64644L6.99984 8.95955L6.02006 7.97977C5.82479 7.78451 5.50821 7.78451 5.31295 7.97977C5.11769 8.17503 5.11769 8.49161 5.31295 8.68688L6.64628 10.0202C6.84155 10.2155 7.15813 10.2155 7.35339 10.0202L11.0201 6.35354Z"
  />
</svg>`,rfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.33333 2.16669C2.32081 2.16669 1.5 2.9875 1.5 4.00002V8.66669C1.5 8.94283 1.72386 9.16669 2 9.16669C2.27614 9.16669 2.5 8.94283 2.5 8.66669V4.00002C2.5 3.53978 2.8731 3.16669 3.33333 3.16669H12.6667C13.1269 3.16669 13.5 3.53978 13.5 4.00002V12C13.5 12.4603 13.1269 12.8334 12.6667 12.8334H8C7.72386 12.8334 7.5 13.0572 7.5 13.3334C7.5 13.6095 7.72386 13.8334 8 13.8334H12.6667C13.6792 13.8334 14.5 13.0125 14.5 12V4.00002C14.5 2.9875 13.6792 2.16669 12.6667 2.16669H3.33333ZM6.07741 8.7441C6.40285 8.41866 6.93048 8.41866 7.25592 8.7441C7.58136 9.06953 7.58136 9.59717 7.25592 9.92261L5.92259 11.2559C5.59715 11.5814 5.06951 11.5814 4.74408 11.2559C4.54882 11.0607 4.23223 11.0607 4.03697 11.2559C3.84171 11.4512 3.84171 11.7678 4.03697 11.963C4.75293 12.679 5.91373 12.679 6.6297 11.963L7.96303 10.6297C8.67899 9.91375 8.67899 8.75295 7.96303 8.03699C7.24707 7.32103 6.08627 7.32103 5.3703 8.03699L5.00377 8.40353C4.80851 8.59879 4.80851 8.91537 5.00377 9.11063C5.19903 9.3059 5.51561 9.3059 5.71087 9.11063L6.07741 8.7441ZM4.07741 10.7441C4.40285 10.4187 4.93049 10.4187 5.25592 10.7441C5.45118 10.9394 5.76777 10.9394 5.96303 10.7441C6.15829 10.5488 6.15829 10.2323 5.96303 10.037C5.24707 9.32103 4.08627 9.32103 3.3703 10.037L2.03697 11.3703C1.32101 12.0863 1.32101 13.2471 2.03697 13.963C2.75293 14.679 3.91373 14.679 4.6297 13.963L4.99688 13.5959C5.19215 13.4006 5.19215 13.084 4.99688 12.8888C4.80162 12.6935 4.48504 12.6935 4.28978 12.8888L3.92259 13.2559C3.59715 13.5814 3.06951 13.5814 2.74408 13.2559C2.41864 12.9305 2.41864 12.4029 2.74408 12.0774L4.07741 10.7441Z"
  />
</svg>`,ofe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.99984 2.16669C2.98732 2.16669 2.1665 2.9875 2.1665 4.00002V10.6667V12C2.1665 13.0125 2.98732 13.8334 3.99984 13.8334H11.9998C13.0124 13.8334 13.8332 13.0125 13.8332 12V9.33335V4.00002C13.8332 2.9875 13.0124 2.16669 11.9998 2.16669H3.99984ZM3.1665 12V10.8738L6.07725 7.96305C6.40268 7.63761 6.93032 7.63761 7.25576 7.96305L8.97962 9.68691L10.313 11.0202C10.5082 11.2155 10.8248 11.2155 11.0201 11.0202C11.2153 10.825 11.2153 10.5084 11.0201 10.3131L10.0403 9.33335L10.7439 8.62972C11.0694 8.30428 11.597 8.30428 11.9224 8.62972L12.8332 9.54046V12C12.8332 12.4603 12.4601 12.8334 11.9998 12.8334H3.99984C3.5396 12.8334 3.1665 12.4603 3.1665 12ZM7.96287 7.25594L9.33317 8.62625L10.0368 7.92261C10.7528 7.20665 11.9136 7.20665 12.6295 7.92261L12.8332 8.12625V4.00002C12.8332 3.53978 12.4601 3.16669 11.9998 3.16669H3.99984C3.5396 3.16669 3.1665 3.53978 3.1665 4.00002V9.45958L5.37014 7.25594C6.0861 6.53998 7.2469 6.53998 7.96287 7.25594ZM9.33317 6.00002C9.70136 6.00002 9.99984 5.70154 9.99984 5.33335C9.99984 4.96516 9.70136 4.66669 9.33317 4.66669C8.96498 4.66669 8.6665 4.96516 8.6665 5.33335C8.6665 5.70154 8.96498 6.00002 9.33317 6.00002Z"
  />
</svg>`,sfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.1665 4.00002C2.1665 2.9875 2.98732 2.16669 3.99984 2.16669H11.9998C13.0124 2.16669 13.8332 2.9875 13.8332 4.00002V12C13.8332 13.0125 13.0124 13.8334 11.9998 13.8334H3.99984C2.98732 13.8334 2.1665 13.0125 2.1665 12V4.00002ZM3.99984 3.16669C3.5396 3.16669 3.1665 3.53978 3.1665 4.00002V5.50002H12.8332V4.00002C12.8332 3.53978 12.4601 3.16669 11.9998 3.16669H3.99984ZM3.1665 12V6.50002H5.1665V12.8334H3.99984C3.5396 12.8334 3.1665 12.4603 3.1665 12ZM6.1665 12.8334H11.9998C12.4601 12.8334 12.8332 12.4603 12.8332 12V6.50002H6.1665V12.8334Z"
  />
</svg>`,afe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.66667 2.5C3.02233 2.5 2.5 3.02233 2.5 3.66667V12C2.5 12.6443 3.02233 13.1667 3.66667 13.1667H6.33333C6.97767 13.1667 7.5 12.6443 7.5 12V3.66667C7.5 3.02233 6.97767 2.5 6.33333 2.5H3.66667ZM3.5 3.66667C3.5 3.57462 3.57462 3.5 3.66667 3.5H6.33333C6.42538 3.5 6.5 3.57462 6.5 3.66667V12C6.5 12.092 6.42538 12.1667 6.33333 12.1667H3.66667C3.57462 12.1667 3.5 12.092 3.5 12V3.66667ZM9.66667 2.5C9.02233 2.5 8.5 3.02233 8.5 3.66667V8.33333C8.5 8.97767 9.02233 9.5 9.66667 9.5H12.3333C12.9777 9.5 13.5 8.97767 13.5 8.33333V3.66667C13.5 3.02233 12.9777 2.5 12.3333 2.5H9.66667ZM9.5 3.66667C9.5 3.57462 9.57462 3.5 9.66667 3.5H12.3333C12.4254 3.5 12.5 3.57462 12.5 3.66667V8.33333C12.5 8.42538 12.4254 8.5 12.3333 8.5H9.66667C9.57462 8.5 9.5 8.42538 9.5 8.33333V3.66667Z"
  />
</svg>`,lfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M8.14486 3.73868L4.11805 7.76553C2.84936 9.00118 2.84933 10.9989 4.11802 12.2346C5.39409 13.4774 7.46833 13.4774 8.7444 12.2346L12.671 8.41922C12.8691 8.22678 13.1856 8.23133 13.378 8.42938C13.5705 8.62742 13.5659 8.94397 13.3679 9.13641L9.44212 12.9509C9.44204 12.951 9.44219 12.9509 9.44212 12.9509C7.77775 14.5717 5.08458 14.5719 3.4203 12.9509C1.74938 11.3235 1.74857 8.67989 3.41786 7.0515L7.44488 3.02445C8.61916 1.88075 10.5177 1.88078 11.692 3.02448C12.8729 4.17456 12.8737 6.04431 11.6945 7.1954L7.66745 11.2225C6.98324 11.8889 5.87921 11.8889 5.195 11.2225C4.50341 10.5489 4.50341 9.45119 5.195 8.77761L9.32726 4.75296C9.52508 4.56029 9.84163 4.56447 10.0343 4.76229C10.227 4.96011 10.2228 5.27666 10.025 5.46933L5.89272 9.49398C5.60417 9.77501 5.60417 10.2251 5.89272 10.5061C6.18796 10.7936 6.67153 10.7943 6.96765 10.5081L10.9943 6.48141C11.7729 5.72307 11.7729 4.49919 10.9943 3.74085C10.2091 2.97604 8.93105 2.97532 8.14486 3.73868Z"
  />
</svg>`,k2=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M2.8335 4.00002C2.8335 2.9875 3.65431 2.16669 4.66683 2.16669H11.3335C12.346 2.16669 13.1668 2.9875 13.1668 4.00002V8.00002C13.1668 8.27616 12.943 8.50002 12.6668 8.50002C12.3907 8.50002 12.1668 8.27616 12.1668 8.00002V4.00002C12.1668 3.53978 11.7937 3.16669 11.3335 3.16669H4.66683C4.20659 3.16669 3.8335 3.53978 3.8335 4.00002V12C3.8335 12.4603 4.20659 12.8334 4.66683 12.8334H8.00016C8.27631 12.8334 8.50016 13.0572 8.50016 13.3334C8.50016 13.6095 8.27631 13.8334 8.00016 13.8334H4.66683C3.65431 13.8334 2.8335 13.0125 2.8335 12V4.00002ZM5.50016 5.33335C5.50016 5.05721 5.72402 4.83335 6.00016 4.83335H8.00016C8.27631 4.83335 8.50016 5.05721 8.50016 5.33335C8.50016 5.6095 8.27631 5.83335 8.00016 5.83335H6.00016C5.72402 5.83335 5.50016 5.6095 5.50016 5.33335ZM6.00016 7.16669C5.72402 7.16669 5.50016 7.39054 5.50016 7.66669C5.50016 7.94283 5.72402 8.16669 6.00016 8.16669H10.0002C10.2763 8.16669 10.5002 7.94283 10.5002 7.66669C10.5002 7.39054 10.2763 7.16669 10.0002 7.16669H6.00016ZM5.50016 10C5.50016 9.72388 5.72402 9.50002 6.00016 9.50002H7.66683C7.94297 9.50002 8.16683 9.72388 8.16683 10C8.16683 10.2762 7.94297 10.5 7.66683 10.5H6.00016C5.72402 10.5 5.50016 10.2762 5.50016 10ZM10.3335 9.50002C10.0574 9.50002 9.8335 9.72388 9.8335 10C9.8335 10.2762 10.0574 10.5 10.3335 10.5H12.1264L9.64661 12.9798C9.45135 13.1751 9.45135 13.4916 9.64661 13.6869C9.84187 13.8822 10.1585 13.8822 10.3537 13.6869L12.8335 11.2071V13C12.8335 13.2762 13.0574 13.5 13.3335 13.5C13.6096 13.5 13.8335 13.2762 13.8335 13V10C13.8335 9.86741 13.7808 9.74023 13.687 9.64647C13.5933 9.5527 13.4661 9.50002 13.3335 9.50002H10.3335Z"
  />
</svg>`,S$=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M14.7916 13.9062C14.7916 14.2514 14.5118 14.5312 14.1666 14.5312C13.8214 14.5312 13.5416 14.2514 13.5416 13.9062V5.10263L10.8585 7.78569C10.6144 8.02977 10.2187 8.02977 9.97464 7.78569C9.73057 7.54161 9.73057 7.14589 9.97464 6.90181L13.7246 3.15181C13.9687 2.90773 14.3644 2.90773 14.6085 3.15181L18.3585 6.90181C18.6026 7.14589 18.6026 7.54161 18.3585 7.78569C18.1144 8.02977 17.7187 8.02977 17.4746 7.78569L14.7916 5.10263V13.9062ZM6.45825 6.09375C6.45825 5.74857 6.17843 5.46875 5.83325 5.46875C5.48807 5.46875 5.20825 5.74857 5.20825 6.09375V14.8974L2.52519 12.2143C2.28112 11.9702 1.88539 11.9702 1.64131 12.2143C1.39723 12.4584 1.39723 12.8541 1.64131 13.0982L5.39131 16.8482C5.63539 17.0923 6.03112 17.0923 6.27519 16.8482L10.0252 13.0982C10.2693 12.8541 10.2693 12.4584 10.0252 12.2143C9.78112 11.9702 9.38539 11.9702 9.14131 12.2143L6.45825 14.8974V6.09375Z"
  />
</svg>`,cfe=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M13.0265 9.4584C13.4358 9.69904 13.4358 10.3006 13.0265 10.5413L8.42122 13.2485C8.01186 13.4891 7.50016 13.1883 7.50016 12.707L7.50016 7.29264C7.50016 6.81136 8.01186 6.51056 8.42122 6.7512L13.0265 9.4584Z"
    fill="#77757D"
  />
</svg> `,dfe=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <g clip-path="url(#clip0_3398_22894)">
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M10.8359 5.4105C10.6024 5.66474 10.6192 6.06011 10.8735 6.29359L14.2287 9.37492L4.16658 9.37492C3.82141 9.37492 3.54158 9.65474 3.54158 9.99992C3.54158 10.3451 3.82141 10.6249 4.16658 10.6249L14.2287 10.6249L10.8735 13.7063C10.6192 13.9397 10.6024 14.3351 10.8359 14.5893C11.0694 14.8436 11.4647 14.8604 11.719 14.6269L16.256 10.4603C16.3849 10.3419 16.4583 10.1749 16.4583 9.99992C16.4583 9.82493 16.3849 9.65796 16.256 9.53959L11.719 5.37292C11.4647 5.13944 11.0694 5.15627 10.8359 5.4105Z"
      fill="#77757D"
      fill-opacity="0.6"
    />
  </g>
  <defs>
    <clipPath id="clip0_3398_22894">
      <rect width="20" height="20" fill="white" />
    </clipPath>
  </defs>
</svg> `,ufe=b`<svg
  width="20"
  height="20"
  viewBox="0 0 20 20"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    fill="currentColor"
    d="M3.83277 6.29118C3.62547 6.01519 3.23368 5.9595 2.95769 6.16681C2.68169 6.37411 2.62601 6.76591 2.83331 7.0419C3.50188 7.93198 4.33282 8.69373 5.28223 9.28306L3.64659 11.7365C3.45512 12.0237 3.53273 12.4118 3.81994 12.6032C4.10714 12.7947 4.49519 12.7171 4.68666 12.4299L6.35332 9.92989C6.36688 9.90956 6.37909 9.88872 6.38997 9.86748C7.31361 10.2747 8.31912 10.5306 9.37496 10.6034V14.5832C9.37496 14.9284 9.65478 15.2082 9.99996 15.2082C10.3451 15.2082 10.625 14.9284 10.625 14.5832V10.6035C11.6808 10.5307 12.6864 10.2749 13.6101 9.86776C13.6209 9.8889 13.6331 9.90965 13.6466 9.92989L15.3133 12.4299C15.5047 12.7171 15.8928 12.7947 16.18 12.6032C16.4672 12.4118 16.5448 12.0237 16.3533 11.7365L14.7179 9.2834C15.6675 8.69402 16.4987 7.93215 17.1674 7.0419C17.3747 6.76591 17.319 6.37411 17.043 6.16681C16.767 5.9595 16.3752 6.01519 16.1679 6.29118C14.7605 8.16488 12.5218 9.3749 10.0003 9.3749C7.47885 9.3749 5.24015 8.16488 3.83277 6.29118Z"
  />
</svg>`,hfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M4.31344 6.31295C4.5087 6.11769 4.82528 6.11769 5.02055 6.31295L7.76462 9.05703C7.8948 9.1872 8.10585 9.1872 8.23603 9.05703L10.9801 6.31295C11.1754 6.11769 11.492 6.11769 11.6872 6.31295C11.8825 6.50821 11.8825 6.8248 11.6872 7.02006L8.94313 9.76414C8.42244 10.2848 7.57822 10.2848 7.05752 9.76414L4.31344 7.02006C4.11818 6.8248 4.11818 6.50821 4.31344 6.31295Z"
    fill="currentColor"
  />
</svg>`,pfe=b`<svg
  width="16"
  height="16"
  viewBox="0 0 16 16"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    fill-rule="evenodd"
    clip-rule="evenodd"
    d="M3.64645 3.64645C3.84171 3.45118 4.15829 3.45118 4.35355 3.64645L8 7.29289L11.6464 3.64645C11.8417 3.45118 12.1583 3.45118 12.3536 3.64645C12.5488 3.84171 12.5488 4.15829 12.3536 4.35355L8.70711 8L12.3536 11.6464C12.5488 11.8417 12.5488 12.1583 12.3536 12.3536C12.1583 12.5488 11.8417 12.5488 11.6464 12.3536L8 8.70711L4.35355 12.3536C4.15829 12.5488 3.84171 12.5488 3.64645 12.3536C3.45118 12.1583 3.45118 11.8417 3.64645 11.6464L7.29289 8L3.64645 4.35355C3.45118 4.15829 3.45118 3.84171 3.64645 3.64645Z"
    fill="currentColor"
  />
</svg>`;var ffe=Object.defineProperty,gfe=Object.getOwnPropertyDescriptor,K0=(t,e,n,i)=>{for(var r=i>1?void 0:i?gfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&ffe(e,n,r),r};const{matchFlavours:qf}=kr;let Ya=class extends me(Ae){constructor(){super(...arguments),this._show=!1,this._backLinkShow=[],this._inlineManager=new D0}connectedCallback(){super.connectedCallback();const t=new N0;t.setInteractable(!1),t.setPage(this.page),this._inlineManager.registerSpecs(R0(t));const{_disposables:e}=this;e.add(this.page.workspace.indexer.backlink.slots.indexUpdated.on(()=>{this.requestUpdate()}))}_toggleShow(){this._show=!this._show}get _host(){return this.docPageBlock.host}get _links(){const{page:t}=this,{workspace:e}=t,n=new Set;return t.getBlockByFlavour(["affine:paragraph","affine:list","affine:embed-linked-doc"]).forEach(i=>{i.text?i.text.yText.toDelta().forEach(o=>{!o.attributes||!o.attributes.reference||n.add(o.attributes.reference.pageId)}):qf(i,["affine:embed-linked-doc"])&&n.add(i.pageId)}),n.size===0?ae:b`<div class="links">
      <div class="links-title">Outgoing links  ${n.size}</div>
      ${Fe(Array.from(n),i=>i,i=>{const r=e.getPage(i);return D(r),b`<div
            class="link"
            @click=${()=>{this.docPageBlock.slots.pageLinkClicked.emit({pageId:i})}}
          >
            ${k2}
            <div>${r.meta.title}</div>
          </div>`})}
    </div> `}get _backLinks(){const{page:t}=this,{workspace:e}=t,n=new Map;e.indexer.backlink.getBacklink(t.id).reduce((r,o)=>{const{pageId:s}=o;return r.has(s)?r.get(s).push(o.blockId):r.set(s,[o.blockId]),r},n);const i=n.size;return i?b` <div class="back-links">
      <div class="back-links-title">${`Backlinks  ${i}`}</div>
      ${Fe(n.keys(),r=>r,(r,o)=>{const s=e.getPage(r),a=n.get(r);D(s);const l=this._backLinkShow[o]??!1,c=this._host.spec.getService("affine:list");return b`<style>
              .affine-list-block__prefix{
                display: flex;
                align-items: center;
              }

              .rich-text{
                display: flex;
                align-items: center;
              }

              ${c.styles.prefix}
              ${c.styles.toggle}
            </style>
            <div class="back-link">
              <div class="back-link-title">
                <div
                  class="arrow"
                  style=${we({transform:`rotate(${l?90:0}deg)`})}
                  @click=${()=>{this._backLinkShow[o]=!l,this.requestUpdate()}}
                >
                  ${cfe}
                </div>
                <div>${k2}${s.meta.title}</div>
              </div>
              <div class="back-links-container">
                <div class="back-links-container-left-divider">
                  <div></div>
                </div>
                <div class="back-links-blocks-container">
                  ${l?Fe(a,d=>d,d=>{const u=s.getBlockById(d);return u?this._backlink(u,r,d):ae}):ae}
                </div>
              </div>
            </div>`})}
    </div>`:ae}_backlink(t,e,n){if(!qf(t,["affine:paragraph","affine:list","affine:embed-linked-doc"]))return ae;let i=null;qf(t,["affine:list"])&&(i=this._host.spec.getService("affine:list").styles.icon(t,!1,()=>{}));const r=qf(t,["affine:embed-linked-doc"])?"":t.type;return b` <style>
        .linked-page-container {
          display: flex;
          align-items: center;
          padding-left: 2px;
          gap: 2px;
        }
        .linked-page-container svg {
          scale: 1.2;
        }
      </style>
      <div
        class=${`rich-text-container ${r}`}
        @click=${()=>this.docPageBlock.slots.pageLinkClicked.emit({pageId:e,blockId:n})}
      >
        <div class="rich-text">
          ${r?b`${i??ae}
                <rich-text
                  .yText=${t.text}
                  .readonly=${!0}
                  .attributesSchema=${this._inlineManager.getSchema()}
                  .attributeRenderer=${this._inlineManager.getRenderer()}
                ></rich-text>`:b`<div class="linked-page-container">
                ${k2} ${this.page.meta.title}
              </div>`}
        </div>

        <div class="arrow-link">${dfe}</div>
      </div>`}_divider(t){return b`
      <style>
        .divider-container {
          height: 16px;
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
        }
        .divider {
          background: var(--affine-divider-color);
          height: 0.5px;
          width: 100%;
        }
      </style>
      <div
        style=${we({visibility:t?"visible":"hidden"})}
        class="divider-container"
      >
        <div class="divider"></div>
      </div>
    `}render(){return b`<style>
        .title {
          font-weight: 500;
          font-size: 15px;
          line-height: 24px;
          color: ${this._show?"var(--affine-text-primary-color)":"var(--affine-text-disable-color)"};
        }
        .show-button {
          width: 56px;
          height: 28px;
          border-radius: 8px;
          border: 1px solid var(--affine-border-color);
          background-color: var(--affine-white);
          text-align: center;
          font-size: 12px;
          line-height: 28px;
          font-weight: 500;
          color: var(--affine-text-primary-color);
          cursor: pointer;
        }
      </style>
      ${this._divider(!this._show)}
      <div class="title-line">
        <div class="title text">Bi-directional link</div>
        <div class="show-button" @click=${this._toggleShow}>
          ${this._show?"Hide":"Show"}
        </div>
      </div>
      ${this._divider(this._show)}
      ${this._show?b`${this._backLinks} ${this._links} `:ae} `}};Ya.styles=X`
    :host {
      width: 100%;
      max-width: var(--affine-editor-width);
      margin-left: auto;
      margin-right: auto;
      padding-left: var(--affine-editor-side-padding, 24px);
      padding-right: var(--affine-editor-side-padding, 24px);
      font-size: var(--affine-font-base);
    }

    .title-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .back-links-title,
    .links-title {
      color: var(--affine-text-secondary-color);
      height: 32px;
      line-height: 32px;
    }

    .links,
    .back-links {
      margin-bottom: 16px;
    }

    .back-link-title {
      width: 100%;
      height: 32px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-link-title div {
      display: flex;
      align-items: center;
      gap: 4px;
      color: var(--affine-text-primary-color);
    }

    .back-links-container {
      height: auto;
      display: flex;
    }

    .back-links-container-left-divider {
      width: 20px;
      display: flex;
      justify-content: center;
    }
    .back-links-container-left-divider div {
      width: 1px;
      height: 100%;
      background-color: var(--affine-border-color);
    }

    .link {
      width: 100%;
      height: 32px;
      display: flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
      cursor: pointer;
    }

    .link svg {
      flex: none;
    }

    .link div {
      width: fit-content;
      height: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 32px;
      border-bottom: 0.5px solid var(--affine-divider-color);
    }

    .arrow {
      cursor: pointer;
      transition: transform 0.2s;
    }

    .back-links-blocks-container {
      width: 100%;
      display: flex;
      flex-direction: column;
      padding-left: 8px;
      position: relative;
    }

    .rich-text-container {
      width: 100%;
      height: 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      border-radius: 4px;
      padding-left: 8px;
      padding-right: 8px;
    }

    .arrow-link {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      display: none;
    }

    .rich-text-container:hover {
      background-color: var(--affine-hover-color);
    }

    .rich-text-container:hover .arrow-link {
      display: flex;
    }
    .arrow-link:hover {
      background-color: var(--affine-hover-color);
    }

    .quote {
      padding-left: 24px;
    }
    .quote::after {
      content: '';
      width: 2px;
      height: 24px;
      position: absolute;
      left: 16px;
      background: var(--affine-quote-color);
      border-radius: 18px;
    }
  `;K0([ie()],Ya.prototype,"_show",2);K0([ie()],Ya.prototype,"_backLinkShow",2);K0([L({attribute:!1})],Ya.prototype,"page",2);K0([L({attribute:!1})],Ya.prototype,"docPageBlock",2);Ya=K0([W("bi-directional-link-panel")],Ya);var mfe=Object.defineProperty,bfe=Object.getOwnPropertyDescriptor,my=(t,e,n,i)=>{for(var r=i>1?void 0:i?bfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&mfe(e,n,r),r};let Vp=class extends me(De){constructor(){super(...arguments),this.specs=E4}render(){return b`
      <style>
        affine-doc-editor {
          display: block;
          height: 100%;
          overflow: hidden;
          font-family: var(--affine-font-family);
          background: var(--affine-background-primary-color);
        }

        affine-doc-editor * {
          box-sizing: border-box;
        }

        @media print {
          affine-doc-editor {
            height: auto;
          }
        }

        .affine-doc-viewport {
          position: relative;
          display: flex;
          flex-direction: column;
          height: 100%;
          overflow-x: hidden;
          overflow-y: auto;
          user-select: none;
          container-name: viewport;
          container-type: inline-size;
          background: var(--affine-background-primary-color);
        }

        doc-editor {
          flex-grow: 1;
        }
      </style>
      <div class="affine-doc-viewport">
        <doc-title .page=${this.page}></doc-title>
        <page-meta-tags .page=${this.page}></page-meta-tags>
        <doc-editor
          .page=${this.page}
          .specs=${this.specs}
          .hasViewport=${!1}
        ></doc-editor>
      </div>
    `}};my([L({attribute:!1})],Vp.prototype,"page",2);my([L({attribute:!1})],Vp.prototype,"specs",2);Vp=my([W("affine-doc-editor")],Vp);var vfe=Object.defineProperty,yfe=Object.getOwnPropertyDescriptor,by=(t,e,n,i)=>{for(var r=i>1?void 0:i?yfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&vfe(e,n,r),r};let zp=class extends me(De){constructor(){super(...arguments),this.specs=gy,this._host=Ri()}get host(){return this._host.value}render(){return b`
      <style>
        edgeless-editor * {
          box-sizing: border-box;
        }
        edgeless-editor {
          display: block;
          height: 100%;
          position: relative;
          overflow: hidden;
          font-family: var(--affine-font-family);
          background: var(--affine-background-primary-color);
          container-name: viewport;
          container-type: inline-size;
        }
        @media print {
          edgeless-editor {
            height: auto;
          }
        }
      </style>
      <editor-host
        ${$t(this._host)}
        .page=${this.page}
        .specs=${this.specs}
      ></editor-host>
    `}disconnectedCallback(){const t=this.host;if(!t)return;const e=t.page.getBlockByFlavour("affine:surface")[0],n=t.view.viewFromPath("block",[this.page.root.id,e.id]);if(!n)return;const{edgeless:i}=n;i.service.editSession.setItem("viewport",{centerX:i.service.viewport.centerX,centerY:i.service.viewport.centerY,zoom:i.service.viewport.zoom})}};by([L({attribute:!1})],zp.prototype,"page",2);by([L({attribute:!1})],zp.prototype,"specs",2);zp=by([W("edgeless-editor")],zp);var wfe=Object.defineProperty,xfe=Object.getOwnPropertyDescriptor,wl=(t,e,n,i)=>{for(var r=i>1?void 0:i?xfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&wfe(e,n,r),r};function $C(t,e){Object.entries(t).forEach(([n,i])=>{const r=e[n];r&&i.pipe(r)})}let zo=class extends me(De){constructor(){super(...arguments),this.mode="page",this.docSpecs=E4,this.edgelessSpecs=gy,this.autofocus=!1,this.themeObserver=new cu,this.slots={pageLinkClicked:new Ve,pageModeSwitched:new Ve,pageUpdated:new Ve,tagClicked:new Ve}}get host(){return this.mode==="page"?this._docPage?.host:this._edgelessPage?.host}get model(){return this.page.root}async getUpdateComplete(){const t=await super.getUpdateComplete(),e=this.host;return e&&await e.updateComplete,t}connectedCallback(){if(super.connectedCallback(),!this.page)throw new Error("Missing page for EditorContainer!");this._disposables.add(this.page.slots.rootAdded.on(()=>{this.requestUpdate("page")})),this.themeObserver.observe(document.documentElement),this._disposables.add(this.themeObserver)}disconnectedCallback(){super.disconnectedCallback()}firstUpdated(){this.mode==="page"&&setTimeout(()=>{if(this.autofocus){const t=this.querySelector("doc-title");if(t){const e=t.querySelector("rich-text");D(e);const n=e.inlineEditor;D(n),n.focusEnd()}else this._docPage?.focusFirstParagraph()}})}updated(t){t.has("mode")&&this.slots.pageModeSwitched.emit(this.mode),t.has("page")&&this.slots.pageUpdated.emit({newPageId:this.page.id}),!(!t.has("page")&&!t.has("mode"))&&requestAnimationFrame(()=>{this._docPage&&$C(this._docPage.slots,this.slots),this._edgelessPage&&$C(this._edgelessPage.slots,this.slots)})}render(){return this.model?b`${WA(this.model.id,this.mode==="page"?b`<affine-doc-editor
            .page=${this.page}
            .specs=${this.docSpecs}
          ></affine-doc-editor>`:b`<edgeless-editor
            .page=${this.page}
            .specs=${this.edgelessSpecs}
          ></edgeless-editor>`)}`:ae}};wl([L({attribute:!1})],zo.prototype,"page",2);wl([L({attribute:!1})],zo.prototype,"mode",2);wl([L({attribute:!1})],zo.prototype,"docSpecs",2);wl([L({attribute:!1})],zo.prototype,"edgelessSpecs",2);wl([L({attribute:!1})],zo.prototype,"autofocus",2);wl([he("affine-doc-page")],zo.prototype,"_docPage",2);wl([he("affine-edgeless-page")],zo.prototype,"_edgelessPage",2);zo=wl([W("affine-editor-container")],zo);const vy=t=>t,Wc=t=>{const e=[];return{type:t.type,title:t.title,getImpl:n=>e.find(i=>i.name===n),implList:e,implService:n=>{e.push(n)}}},Tu=Wc({type:"text-service",title:"Text service"}),qc=Wc({type:"chat-service",title:"Chat service"}),Q0=Wc({type:"text-to-image-service",title:"Text to image service"}),jp=Wc({type:"embedding-service",title:"Embedding service"}),T4=Wc({type:"image-to-text-service",title:"Image to text service"}),I4=Wc({type:"image-to-image-service",title:"Image to image service"}),L4=Wc({type:"fast-image-to-image-service",title:"Fast image to image service"}),cm=[Tu,qc,Q0,T4,I4,L4,jp];class _fe{loadFromLocalStorage(){try{return JSON.parse(localStorage.getItem("copilotConfig")??"")}catch{return{}}}loadVendorFromUrl(){const e=[],n=new URLSearchParams(window.location.search),i=n.get("openai");i&&e.push({id:"url-openai",vendorKey:"OpenAI",name:"url",data:{apiKey:i}});const r=n.get("fal");r&&e.push({id:"url-fal",vendorKey:"Fal",name:"url",data:{apiKey:r}});const o=n.get("llama");return o&&e.push({id:"url-llama",vendorKey:"llama",name:"url",data:{host:o}}),e}get config(){return this._config||(this._config=Object.assign({feature:{},vendors:[]},this.loadFromLocalStorage())),{...this._config,vendors:[...this._config.vendors.filter(e=>e.name!="url"),...this.loadVendorFromUrl()]}}save(){localStorage.setItem("copilotConfig",JSON.stringify(this.config))}changeService(e,n,i,r){this.config.feature[e]=this.config.feature[e]??{},this.config.feature[e][n]={vendorId:i,implName:r},this.save()}addVendor(e){this._config?.vendors.push(e),this.save()}getVendor(e,n){const r=(this.config.feature[e]??{})[n.type],o=r&&this.config.vendors.find(s=>s.id===r.vendorId);if(o){const s=n.getImpl(r.implName);return{vendor:o,impl:s}}else return this.getVendorsByService(n)[0]}getService(e,n){const i=this.getVendor(e,n);if(!i)throw new Error(`no vendor for ${n.type}`);return i.impl.method(i.vendor.data)}getVendorsByService(e){return this.config.vendors.flatMap(n=>e.implList.filter(i=>i.vendor.key===n.vendorKey).map(i=>({vendor:n,impl:i})))}}const zi=new _fe,Gp="chat",co=()=>zi.getService(Gp,Tu),Cfe=()=>zi.getService(Gp,qc),nn=t=>({role:"user",content:[{type:"text",text:t}]});var kfe=Object.defineProperty,Efe=Object.getOwnPropertyDescriptor,Js=(t,e,n,i)=>{for(var r=i>1?void 0:i?Efe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&kfe(e,n,r),r};let eo=class extends me(De){constructor(){super(...arguments),this.history=[],this.loading=!1,this.value="",this.syncedPages=[],this.surfaceSelection=!1,this.docSelection=!1,this.addSelectionBackground=async()=>{this.surfaceSelection&&await this.chat.selectShapesForBackground(),this.docSelection&&await this.chat.selectTextForBackground(),this.requestUpdate()},this.renderMessage=t=>{if(t.role==="system")return null;if(t.role==="user"){const e=we({alignItems:"flex-end"});return b` <div class="history-item" style="${e}">
        ${Fe(t.content,n=>n.type==="text"?b`<div style="width: fit-content">${n.text}</div>`:n.type==="image_url"?b`<div style="width: fit-content">
              <img .src="${n.image_url.url}" style="max-width: 100px" />
            </div>`:null)}
      </div>`}if(t.role==="assistant"){const e=we({alignItems:"flex-start",backgroundColor:"var(--affine-hover-color)"});return b` <div class="history-item" style="${e}">
        <div style="width: fit-content">${t.content}</div>
        ${t.sources?.length?b` <div class="history-refs">
              <div style="margin-top: 8px;">sources:</div>
              <div
                style="display: flex;flex-direction: column;gap: 4px;padding: 4px;"
              >
                ${Fe(t.sources,n=>{const i=this.editor.page.workspace.getPage(n.id);if(!i)return;const r=i.meta.title||"Untitled";return b` <a @click="${()=>{this.editor.page=i}}" style="cursor: pointer"
                    >${r}</a
                  >`})}
              </div>
            </div>`:null}
        ${this.docSelection?b`
              <div
                style="display:flex;align-items:center;gap: 8px;margin-top: 8px;user-select: none"
              >
                <div
                  @click="${()=>this.chat.replaceSelectedContent(t.content)}"
                  style="border-radius: 4px;border: 1px solid rgba(0,0,0,0.1);padding: 2px 6px;cursor: pointer"
                >
                  replace
                </div>
                <div
                  @click="${()=>this.chat.insertBelowSelectedContent(t.content)}"
                  style="border-radius: 4px;border: 1px solid rgba(0,0,0,0.1);padding: 2px 6px;cursor: pointer"
                >
                  insert below
                </div>
              </div>
            `:null}
      </div>`}return null}}get chat(){return this.logic.chat}get editor(){return this.logic.editor}connectedCallback(){super.connectedCallback(),this.logic.chat.reactiveData=this,this.disposables.add(this.editor.page.workspace.slots.pagesUpdated.on(()=>{this.requestUpdate()})),this.checkSelection(),this.disposables.add(this.editor.host.selection.slots.changed.on(()=>{this.checkSelection()}))}checkSelection(){this.surfaceSelection=this.editor.host.selection.value.find(t=>t.type==="surface")!=null,this.docSelection=this.editor.host.selection.value.find(t=>t.type==="block")!=null}render(){const t=async()=>{this.input.focus(),await this.chat.genAnswer()},e=async i=>{i.stopPropagation(),i.key==="Enter"&&!i.ctrlKey&&!i.metaKey&&await t()},n=we({opacity:this.loading?"0.5":"1"});return b`
      <div
        style="display:flex;flex-direction: column;justify-content: space-between;height: 100%"
      >
        <div>
          ${Fe(this.history,this.renderMessage)}
          <div class="copilot-chat-prompt-container">
            <input
              @keydown="${e}"
              autocomplete="off"
              data-1p-ignore
              type="text"
              class="copilot-chat-panel-chat-input copilot-chat-prompt"
              .value="${this.value}"
              @input="${i=>{this.value=i.target.value}}"
            />
            <div
              @click="${t}"
              style="${n}"
              class="send-button"
            >
              <sl-icon name="stars"></sl-icon>
            </div>
          </div>
          ${this.surfaceSelection||this.docSelection?b`<div
                @click="${this.addSelectionBackground}"
                style="border-radius: 4px;background-color: rgba(0,0,0,0.2);padding: 4px 8px;font-size: 12px;margin-top: 8px;width: max-content;cursor: pointer;user-select: none"
              >
                insert selected content
              </div>`:null}
        </div>
        <div>
          <div
            style="display:flex;flex-direction: column;gap: 12px;margin-bottom: 12px;"
          >
            <div style="display:flex;gap: 8px;flex-direction: column">
              <div
                style="font-size: 12px;color:var(--affine-text-secondary-color);"
              >
                embedding service:
              </div>
              <vendor-service-select
                .featureKey="${Gp}"
                .service="${jp}"
              ></vendor-service-select>
            </div>
            <div style="display:flex;gap: 8px;flex-direction: column">
              <div
                style="font-size: 12px;color:var(--affine-text-secondary-color);"
              >
                chat service:
              </div>
              <vendor-service-select
                .featureKey="${Gp}"
                .service="${qc}"
              ></vendor-service-select>
            </div>
          </div>
          <div class="synced-page-list">
            <div style="margin-bottom: 8px;">Synced pages:</div>
            ${this.syncedPages.length?Fe(this.syncedPages,i=>{const r=this.editor.page.workspace.getPage(i.id)?.meta.title??"Untitled";return b` <div>${r}</div>`}):"Empty"}
          </div>
          <div
            class="sync-workspace-button"
            style="margin-bottom: 12px"
            @click="${this.chat.syncWorkspace}"
          >
            Sync Workspace
          </div>
        </div>
      </div>
    `}};eo.styles=X`
    copilot-chat-panel {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      width: 100%;
      font-family: var(--affine-font-family);
      height: 100%;
      gap: 4px;
    }

    .copilot-chat-prompt-container {
      display: flex;
      gap: 8px;
      height: 30px;
      margin-top: 24px;
    }

    .copilot-chat-prompt {
      flex: 1;
      border: none;
      border-radius: 4px;
      padding: 4px 8px;
      outline: none;
      background-color: white;
    }

    .send-button {
      width: 36px;
      background-color: var(--affine-primary-color);
      border-radius: 4px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .sync-workspace-button {
      border: 1px solid var(--affine-border-color);
      height: 32px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .synced-page-list {
      margin-bottom: 14px;
      color: var(--affine-text-secondary-color);
      font-size: 12px;
    }

    .history-item {
      display: flex;
      flex-direction: column;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 14px;
    }

    .history-refs {
      font-size: 12px;
      color: var(--affine-text-secondary-color);
    }
  `;Js([L({attribute:!1})],eo.prototype,"logic",2);Js([ie()],eo.prototype,"history",2);Js([ie()],eo.prototype,"loading",2);Js([ie()],eo.prototype,"value",2);Js([ie()],eo.prototype,"syncedPages",2);Js([ie()],eo.prototype,"surfaceSelection",2);Js([ie()],eo.prototype,"docSelection",2);Js([he(".copilot-chat-panel-chat-input")],eo.prototype,"input",2);eo=Js([W("copilot-chat-panel")],eo);const Sfe=["Chinese","English","French","German","Italian","Japanese","Korean"],Tfe=["Casual","Formal","Friendly","Humorous","Professional","Straightforward"];async function Ife(t,e){const n=new ar({workspace:t.std.page.workspace}),i=await n.sliceToSnapshot(e);return(await new Ws().fromSliceSnapshot({snapshot:i,assets:n.assetsManager})).file}async function tg(t,e,n,i){const r=new ar({workspace:t.std.page.workspace}),o=new Ws,{blockVersions:s,workspaceVersion:a,pageVersion:l}=t.std.page.workspace.meta;if(!s||!a||!l)throw new Error("Need blockVersions, workspaceVersion, pageVersion meta information to get slice");const c={file:e,assets:r.assetsManager,blockVersions:s,pageVersion:l,workspaceVersion:a,workspaceId:t.std.page.workspace.id,pageId:t.std.page.id},d=await o.toSliceSnapshot(c);D(d,"import markdown failed, expected to get a snapshot");const u=d.content[0].children,h=[];for(let p=0;p<u.length;p++){const g=u[p],f=await r.snapshotToBlock(g,t.std.page,n,(i??0)+p);h.push(f)}return h}async function Lfe(t){let e=[];return t.std.command.pipe().getBlockSelections().inline((n,i)=>{const r=n.currentBlockSelections;if(r)return e=r.map(o=>n.std.view.viewFromPath("block",o.path)?.model).filter(o=>o!==void 0&&kr.matchFlavours(o,["affine:paragraph","affine:list","affine:code"])),i()}).run(),Ud.fromModels(t.std.page,e)}async function ng(t){let e=[];return t.std.command.pipe().getBlockSelections().inline((n,i)=>{const r=n.currentBlockSelections;if(r)return e=r.map(o=>n.std.view.viewFromPath("block",o.path)).filter(o=>o!==null&&kr.matchFlavours(o.model,["affine:paragraph","affine:list","affine:code"])),i()}).run(),e}function Rl(t){const e=t.getElementsByTagName("affine-edgeless-page")[0];if(!e)throw alert("Please switch to edgeless mode"),new Error("Please open switch to edgeless mode");return e}async function yy(t){const e=Rl(t),{notes:n,frames:i,shapes:r,images:o}=kr.splitElements(e.service.selection.elements);if(n.length+i.length+o.length+r.length===0)return;const s=await e.clipboardController.toCanvas([...n,...i,...o],r);if(s)return s}async function Mfe(t,e){const n=Nd(e),i=Rl(e),{notes:r,frames:o,shapes:s,images:a}=kr.splitElements(n.frame.getElementsInFrame(t,!0));if(r.length+o.length+a.length+s.length===0)return;const l=await i.clipboardController.toCanvas([...r,...o,...a],s);if(l)return l}async function Pfe(t){return(await yy(t))?.toDataURL("image/png")}async function T$(t){const e=await Lfe(t);return await Ife(t,e)}const dm=t=>{t.stopPropagation()};function Nd(t){const{page:e}=t,n=e.getBlockByFlavour("affine:surface")[0];D(n);const i=n.id,r=t.querySelector(`affine-surface[data-block-id="${i}"]`);return D(r),r}const Afe=(t,e)=>Nd(e).frame.getElementsInFrame(t,!1).find(o=>kr.isCanvasElement(o)?!1:o.flavour==="affine:image")?.id;async function $fe({question:t,input:e}){return await co().generateText([{role:"system",content:"You are assisting the user in discussing the content of the whiteboard."},nn(e),nn(t)])}async function Bfe({input:t,tone:e}){return await co().generateText([{role:"system",content:"You are assisting the user in writing high quality content."},nn(t),nn(`Change the tone the of Markdown text to ${e}, preserving the formatting, like bold, italic, link, highlight. Please be sure to only return the content.`)])}async function Dfe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting"},nn(e),nn("Fix the spelling and grammar of the text, preserving the markdown formatting, like bold, italic, link, highlight. To make sure do your best")])}async function Ofe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are assisting the user in extending the content of the whiteboard."},nn(e),nn("Generate more content based on the current input.")])}async function Rfe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting"},nn(e),nn("Improve the writing of the text, preserving the markdown formatting if needed, like bold, italic, link, highlight. To make sure do your best")])}async function Nfe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting"},nn(e),nn("Make the input text longer, preserving the markdown formatting, like bold, italic, link, highlight. To make sure do your best")])}async function Hfe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting"},nn(e),nn("Make the input text shorter, preserving the markdown formatting, like bold, italic, link, highlight. To make sure do your best")])}async function Ffe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are assisting the user in refining the content of the whiteboard."},nn(e),nn("Refine this text.")])}async function Ufe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting"},nn(e),nn("Simplify the text, preserving the markdown formatting if needed, like bold, italic, link, highlight. To make sure do your best")])}async function Vfe(t){const{input:e}=t;return await co().generateText([{role:"system",content:"You are a professional writing assisting."},nn(e),nn("Summarize this text. To make sure do your best.")])}async function zfe(t){const{input:e,language:n}=t;return await co().generateText([{role:"system",content:"You are assisting the user in translating the content."},nn(e),nn(`Translate the Markdown text to ${n} while preserving the formatting, like bold, italic, link, highlight. Please only return the result of translate.`)])}const BC={answer:$fe,refine:Ffe,generate:Ofe,summary:Vfe,translate:zfe,improveWriting:Rfe,fixSpelling:Dfe,makeShorter:Hfe,makeLonger:Nfe,changeTone:Bfe,simplifyLanguage:Ufe};var jfe=Object.defineProperty,Gfe=Object.getOwnPropertyDescriptor,M4=(t,e,n,i)=>{for(var r=i>1?void 0:i?Gfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&jfe(e,n,r),r};let Hd=class extends me(De){constructor(){super(...arguments),this.payload={type:"answer"},this.changeType=t=>{t.target instanceof HTMLSelectElement&&(this.payload={type:t.target.value})},this.textCompletion=async(t,e)=>{const n=await T$(this.editor.host);if(!n){alert("Please select some text first");return}return BC[t]({input:n,...e})},this._result="",this.ask=async()=>{const t=await this.textCompletion(this.payload.type,this.payload);this._result=t??""},this.extraPayload={answer:()=>{const t=e=>{e.target instanceof HTMLInputElement&&(this.payload.question=e.target.value)};return b` <div style="margin-top: 16px;">
        <input
          class="copilot-panel-action-prompt"
          type="text"
          .value="${this.payload.question??""}"
          @input="${t}"
        />
      </div>`},refine:()=>null,generate:()=>null,summary:()=>null,translate:()=>b` <div style="margin-top: 16px;">
        <div style="display:flex;align-items:center;">
          <div style="margin-right: 4px;">Language:</div>
          <select @change="${e=>{e.target instanceof HTMLSelectElement&&(this.payload.language=e.target.value)}}">
            ${Fe(Sfe,e=>b` <option>${e}</option>`)}
          </select>
        </div>
      </div>`,improveWriting:()=>null,fixSpelling:()=>null,makeShorter:()=>null,makeLonger:()=>null,changeTone:()=>b` <div style="margin-top: 16px;">
        <div style="display:flex;align-items:center;">
          <div style="margin-right: 4px;">Tone:</div>
          <select @change="${e=>{e.target instanceof HTMLSelectElement&&(this.payload.tone=e.target.value)}}">
            ${Fe(Tfe,e=>b` <option>${e}</option>`)}
          </select>
        </div>
      </div>`,simplifyLanguage:()=>null}}get editor(){return this.logic.editor}get page(){return this.editor.page}get host(){return this.editor.host}async _replace(){if(!this._result)return;const t=await ng(this.host);if(!t.length)return;const e=t[0],n=e.parentBlockElement,i=n.model.children.findIndex(o=>o.id===e.model.id);t.forEach(o=>{this.page.deleteBlock(o.model)});const r=await tg(this.host,this._result,n.model.id,i);setTimeout(()=>{const o=e.parentPath,s=r.map(a=>[...o,a.id]).map(a=>this.host.selection.create("block",{path:a}));this.host.selection.setGroup("note",s)},0)}async _insertBelow(){if(!this._result)return;const t=await ng(this.host),e=t.length;if(!e)return;const n=t[e-1],i=n.parentBlockElement,r=i.model.children.findIndex(s=>s.id===n.model.id),o=await tg(this.host,this._result,i.model.id,r+1);setTimeout(()=>{const s=n.parentPath,a=o.map(l=>[...s,l.id]).map(l=>this.host.selection.create("block",{path:l}));this.host.selection.setGroup("note",a)},0)}_ResultArea(){return this._result?b`
      <div style="margin-top: 16px;">${this._result}</div>
      <div style="display:flex;align-items:center;">
        <div
          class="copilot-panel-action-button"
          style="flex: 1;"
          @click="${this._replace}"
        >
          Replace
        </div>
        <div
          class="copilot-panel-action-button"
          style="flex: 1;"
          @click="${this._insertBelow}"
        >
          Insert below
        </div>
      </div>
    `:ae}render(){return b` <div style="margin-top: 16px;">
      <div style="display:flex;align-items:center;">
        <div style="margin-right: 4px;">Action:</div>
        <select @change="${this.changeType}">
          ${Fe(Object.keys(BC),t=>b` <option>${t}</option>`)}
        </select>
      </div>
      ${this.extraPayload[this.payload.type]()}
      <div class="copilot-panel-action-button" @click="${this.ask}">Ask</div>
      <div>${this._ResultArea()}</div>

      <div
        style="display:flex;flex-direction: column;gap: 12px;margin-top: 12px;"
      >
        <div style="display:flex;gap: 8px;flex-direction: column">
          <div
            style="font-size: 12px;color:var(--affine-text-secondary-color);"
          >
            chat service:
          </div>
          <vendor-service-select
            .featureKey="${Gp}"
            .service="${Tu}"
          ></vendor-service-select>
        </div>
      </div>
    </div>`}};Hd.styles=X``;M4([L({attribute:!1})],Hd.prototype,"logic",2);M4([ie()],Hd.prototype,"payload",2);M4([ie()],Hd.prototype,"_result",2);Hd=M4([W("copilot-doc-panel")],Hd);var Zfe=Object.defineProperty,Wfe=Object.getOwnPropertyDescriptor,I$=(t,e,n,i)=>{for(var r=i>1?void 0:i?Wfe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Zfe(e,n,r),r};let ig=class extends me(De){get editor(){return this.logic.editor}render(){const t=Nd(this.editor.host).model.children.filter(i=>i instanceof dc),e=i=>{this.logic.edgeless.fromFrame=i.target.value},n=()=>{this.logic.edgeless.toggleAutoGen(),this.requestUpdate()};return b`
      <div class="copilot-box">
        <div
          class="copilot-panel-action-button"
          @click="${this.logic.edgeless.makeItReal}"
        >
          Make It Real
        </div>
        <div class="copilot-panel-action-description">
          Select some shapes and text to generate html
        </div>
        <div style="display:flex;gap: 8px;flex-direction: column">
          <div
            style="font-size: 12px;color:var(--affine-text-secondary-color);"
          >
            service:
          </div>
          <vendor-service-select
            .featureKey="${"make it real"}"
            .service="${T4}"
          ></vendor-service-select>
        </div>
      </div>
      <div class="copilot-box">
        <div
          class="copilot-panel-action-button"
          @click="${this.logic.edgeless.createImage}"
        >
          Create Image
        </div>
        <input
          id="copilot-panel-create-image-prompt"
          class="copilot-panel-action-prompt"
          type="text"
          @keydown="${dm}"
          placeholder="Prompt"
        />
        <div class="copilot-panel-action-description">
          Type prompt to create an image.
        </div>
        <div style="display:flex;gap: 8px;flex-direction: column">
          <div
            style="font-size: 12px;color:var(--affine-text-secondary-color);"
          >
            service:
          </div>
          <vendor-service-select
            .featureKey="${"text to image"}"
            .service="${Q0}"
          ></vendor-service-select>
        </div>
      </div>
      <div class="copilot-box">
        <div
          class="copilot-panel-action-button"
          @click="${this.logic.edgeless.editImage}"
        >
          Edit Image
        </div>
        <input
          id="copilot-panel-edit-image-prompt"
          class="copilot-panel-action-prompt"
          type="text"
          @keydown="${dm}"
          placeholder="Prompt"
        />
        <div class="copilot-panel-action-description">
          Select some shapes and type prompt to edit them.
        </div>
        <div style="display:flex;gap: 8px;flex-direction: column">
          <div
            style="font-size: 12px;color:var(--affine-text-secondary-color);"
          >
            service:
          </div>
          <vendor-service-select
            .featureKey="${"edit image"}"
            .service="${I4}"
          ></vendor-service-select>
        </div>
      </div>
      <div class="copilot-box">
        <div
          class="copilot-panel-action-button"
          @click="${this.logic.edgeless.htmlBlockDemo}"
        >
          HTML Block Test
        </div>
        <div class="copilot-panel-action-description">
          Generate a html block
        </div>
      </div>
      <div class="copilot-box">
        <div @click="${n}" class="copilot-panel-action-button">
          ${this.logic.edgeless.autoGen?"Stop auto gen image":"Start auto gen image"}
        </div>
        <div class="copilot-panel-action-description">
          <div>
            Based on the shapes in frame
            <select
              .value="${this.logic.edgeless.fromFrame}"
              @change="${e}"
            >
              <option value="">None</option>
              ${t.map(i=>b` <option .value="${i.id}">
                  ${i.title.toString()}
                </option>`)}
            </select>
          </div>
          <div>Generate images to all connected frames</div>
        </div>
        <div style="display:flex;gap: 8px;flex-direction: column">
          <div
            style="font-size: 12px;color:var(--affine-text-secondary-color);"
          >
            service:
          </div>
          <vendor-service-select
            .featureKey="${"real time image to image"}"
            .service="${L4}"
          ></vendor-service-select>
        </div>
      </div>
    `}};ig.styles=X``;I$([L({attribute:!1})],ig.prototype,"logic",2);ig=I$([W("copilot-edgeless-panel")],ig);const f1="4.25.0";let DC=!1,Rh,L$,M$,um,P$,A$,$$,B$,D$;function qfe(t,e={auto:!1}){if(DC)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Rh)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Rh}'\``);DC=e.auto,Rh=t.kind,L$=t.fetch,t.Request,t.Response,t.Headers,M$=t.FormData,t.Blob,um=t.File,P$=t.ReadableStream,A$=t.getMultipartRequestOptions,$$=t.getDefaultAgent,B$=t.fileFromPath,D$=t.isFsReadStream}class Yfe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Xfe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,i,r,o;try{n=fetch,i=Request,r=Response,o=Headers}catch(s){throw new Error(`this environment is missing the following Web Fetch API type: ${s.message}. ${e}`)}return{kind:"web",fetch:n,Request:i,Response:r,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(s,a)=>({...a,body:new Yfe(s)}),getDefaultAgent:s=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:s=>!1}}Rh||qfe(Xfe(),{auto:!0});class Tt extends Error{}class ai extends Tt{constructor(e,n,i,r){super(`${ai.makeMessage(e,n,i)}`),this.status=e,this.headers=r;const o=n;this.error=o,this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(e,n,i){const r=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,n,i,r){if(!e)return new P4({cause:pm(n)});const o=n?.error;return e===400?new O$(e,o,i,r):e===401?new R$(e,o,i,r):e===403?new N$(e,o,i,r):e===404?new H$(e,o,i,r):e===409?new F$(e,o,i,r):e===422?new U$(e,o,i,r):e===429?new V$(e,o,i,r):e>=500?new z$(e,o,i,r):new ai(e,o,i,r)}}class yc extends ai{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class P4 extends ai{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class wy extends P4{constructor({message:e}={}){super({message:e??"Request timed out."})}}class O$ extends ai{constructor(){super(...arguments),this.status=400}}class R$ extends ai{constructor(){super(...arguments),this.status=401}}class N$ extends ai{constructor(){super(...arguments),this.status=403}}class H$ extends ai{constructor(){super(...arguments),this.status=404}}class F$ extends ai{constructor(){super(...arguments),this.status=409}}class U$ extends ai{constructor(){super(...arguments),this.status=422}}class V$ extends ai{constructor(){super(...arguments),this.status=429}}class z$ extends ai{}class ba{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let i=!1;const r=new Kfe;async function*o(){if(!e.body)throw n.abort(),new Tt("Attempted to iterate over a response with no body");const a=new wc,l=OC(e.body);for await(const c of l)for(const d of a.decode(c)){const u=r.decode(d);u&&(yield u)}for(const c of a.flush()){const d=r.decode(c);d&&(yield d)}}async function*s(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let a=!1;try{for await(const l of o())if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null){let c;try{c=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(c&&c.error)throw new ai(void 0,c.error,void 0,void 0);yield c}}a=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{a||n.abort()}}return new ba(s,n)}static fromReadableStream(e,n){let i=!1;async function*r(){const s=new wc,a=OC(e);for await(const l of a)for(const c of s.decode(l))yield c;for(const l of s.flush())yield l}async function*o(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let s=!1;try{for await(const a of r())s||a&&(yield JSON.parse(a));s=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{s||n.abort()}}return new ba(o,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],i=this.iterator(),r=o=>({next:()=>{if(o.length===0){const s=i.next();e.push(s),n.push(s)}return o.shift()}});return[new ba(()=>r(e),this.controller),new ba(()=>r(n),this.controller)]}toReadableStream(){const e=this;let n;const i=new TextEncoder;return new P$({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:s}=await n.next();if(s)return r.close();const a=i.encode(JSON.stringify(o)+`
`);r.enqueue(a)}catch(o){r.error(o)}},async cancel(){await n.return?.()}})}}class Kfe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,i,r]=Qfe(e,":");return r.startsWith(" ")&&(r=r.substring(1)),n==="event"?this.event=r:n==="data"&&this.data.push(r),null}}class wc{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const i=wc.NEWLINE_CHARS.has(n[n.length-1]||"");let r=n.split(wc.NEWLINE_REGEXP);return r.length===1&&!i?(this.buffer.push(r[0]),[]):(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),i||(this.buffer=[r.pop()||""]),r)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Tt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Tt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Tt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}wc.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);wc.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function Qfe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function OC(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const j$=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Jfe=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&G$(t),G$=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",e2e=t=>Jfe(t)||j$(t)||D$(t);async function Z$(t,e,n={}){if(t=await t,j$(t)){const r=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new um([r],e,n)}const i=await t2e(t);if(e||(e=i2e(t)??"unknown_file"),!n.type){const r=i[0]?.type;typeof r=="string"&&(n={...n,type:r})}return new um(i,e,n)}async function t2e(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(G$(t))e.push(await t.arrayBuffer());else if(r2e(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${n2e(t)}`);return e}function n2e(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function i2e(t){return s7(t.name)||s7(t.filename)||s7(t.path)?.split(/[\\/]/).pop()}const s7=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},r2e=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",RC=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Zp=async t=>{const e=await o2e(t.body);return A$(e,t)},o2e=async t=>{const e=new M$;return await Promise.all(Object.entries(t||{}).map(([n,i])=>hm(e,n,i))),e},hm=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(e2e(n)){const i=await Z$(n);t.append(e,i)}else if(Array.isArray(n))await Promise.all(n.map(i=>hm(t,e+"[]",i)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([i,r])=>hm(t,`${e}[${i}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var W$={},s2e=function(t,e,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(t,n):r?r.value=n:e.set(t,n),n},a2e=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},Yf;async function q$(t){const{response:e}=t;if(t.options.stream)return D1("response",e.status,e.url,e.headers,e.body),ba.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;if(e.headers.get("content-type")?.includes("application/json")){const r=await e.json();return D1("response",e.status,e.url,e.headers,r),r}const i=await e.text();return D1("response",e.status,e.url,e.headers,i),i}class A4 extends Promise{constructor(e,n=q$){super(i=>{i(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new A4(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class l2e{constructor({baseURL:e,maxRetries:n=2,timeout:i=6e5,httpAgent:r,fetch:o}){this.baseURL=e,this.maxRetries=a7("maxRetries",n),this.timeout=a7("timeout",i),this.httpAgent=r,this.fetch=o??L$}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...f2e(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${v2e()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,i){return this.request(Promise.resolve(i).then(r=>({method:e,path:n,...r})))}getAPIList(e,n,i){return this.requestAPIList(n,{method:"get",path:e,...i})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){const{method:n,path:i,query:r,headers:o={}}=e,s=RC(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,a=this.calculateContentLength(s),l=this.buildURL(i,r);"timeout"in e&&a7("timeout",e.timeout);const c=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??$$(l),u=c+1e3;typeof d?.options?.timeout=="number"&&u>(d.options.timeout??0)&&(d.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:o,contentLength:a});return{req:{method:n,...s&&{body:s},headers:h,...d&&{agent:d},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:n,contentLength:i}){const r={};i&&(r["content-length"]=i);const o=this.defaultHeaders(e);return UC(r,o),UC(r,n),RC(e.body)&&Rh!=="node"&&delete r["content-type"],this.validateHeaders(r,n),r}async prepareRequest(e,{url:n,options:i}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,i,r){return ai.generate(e,n,i,r)}request(e,n=null){return new A4(this.makeRequest(e,n))}async makeRequest(e,n){const i=await e;n==null&&(n=i.maxRetries??this.maxRetries);const{req:r,url:o,timeout:s}=this.buildRequest(i);if(await this.prepareRequest(r,{url:o,options:i}),D1("request",o,i,r.headers),i.signal?.aborted)throw new yc;const a=new AbortController,l=await this.fetchWithTimeout(o,r,s,a).catch(pm);if(l instanceof Error){if(i.signal?.aborted)throw new yc;if(n)return this.retryRequest(i,n);throw l.name==="AbortError"?new wy:new P4({cause:l})}const c=d2e(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const f=`retrying, ${n} attempts remaining`;return D1(`response (error; ${f})`,l.status,o,c),this.retryRequest(i,n,c)}const d=await l.text().catch(f=>pm(f).message),u=g2e(d),h=u?void 0:d;throw D1(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,o,c,h),this.makeStatusError(l.status,u,h,c)}return{response:l,options:i,controller:a}}requestAPIList(e,n){const i=this.makeRequest(n,null);return new c2e(this,i,e)}buildURL(e,n){const i=b2e(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return K$(r)||(n={...r,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,i])=>typeof i<"u").map(([n,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(n)}=`;throw new Tt(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,i,r){const{signal:o,...s}=n||{};o&&o.addEventListener("abort",()=>r.abort());const a=setTimeout(()=>r.abort(),i);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...s}).finally(()=>{clearTimeout(a)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,i){let r;const o=i?.["retry-after-ms"];if(o){const a=parseFloat(o);Number.isNaN(a)||(r=a)}const s=i?.["retry-after"];if(s&&!r){const a=parseFloat(s);Number.isNaN(a)?r=Date.parse(s)-Date.now():r=a*1e3}if(!(r&&0<=r&&r<60*1e3)){const a=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(n,a)}return await X$(r),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const o=n-e,s=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return s*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${f1}`}}class Y${constructor(e,n,i,r){Yf.set(this,void 0),s2e(this,Yf,e,"f"),this.options=r,this.response=n,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Tt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const i=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[r,o]of i)e.url.searchParams.set(r,o);n.query=void 0,n.path=e.url.toString()}return await a2e(this,Yf,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Yf=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class c2e extends A4{constructor(e,n,i){super(n,async r=>new i(e,r.response,await q$(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const d2e=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const i=n.toString();return e[i.toLowerCase()]||e[i]}}),u2e={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0},jo=t=>typeof t=="object"&&t!==null&&!K$(t)&&Object.keys(t).every(e=>Q$(u2e,e)),h2e=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":f1,"X-Stainless-OS":HC(Deno.build.os),"X-Stainless-Arch":NC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":f1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":f1,"X-Stainless-OS":HC(process.platform),"X-Stainless-Arch":NC(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=p2e();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":f1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":f1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function p2e(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const i=n.exec(navigator.userAgent);if(i){const r=i[1]||0,o=i[2]||0,s=i[3]||0;return{browser:e,version:`${r}.${o}.${s}`}}}return null}const NC=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",HC=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let FC;const f2e=()=>FC??(FC=h2e()),g2e=t=>{try{return JSON.parse(t)}catch{return}},m2e=new RegExp("^(?:[a-z]+:)?//","i"),b2e=t=>m2e.test(t),X$=t=>new Promise(e=>setTimeout(e,t)),a7=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Tt(`${t} must be an integer`);if(e<0)throw new Tt(`${t} must be a positive integer`);return e},pm=t=>t instanceof Error?t:new Error(t),l7=t=>{if(typeof process<"u")return W$?.[t]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(t)?.trim()};function K$(t){if(!t)return!0;for(const e in t)return!1;return!0}function Q$(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function UC(t,e){for(const n in e){if(!Q$(e,n))continue;const i=n.toLowerCase();if(!i)continue;const r=e[n];r===null?delete t[i]:r!==void 0&&(t[i]=r)}}function D1(t,...e){typeof process<"u"&&W$.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const v2e=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),y2e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class xy extends Y${constructor(e,n,i,r){super(e,n,i,r),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ea extends Y${constructor(e,n,i,r){super(e,n,i,r),this.data=i.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const n=e[e.length-1]?.id;return n?{params:{after:n}}:null}}class Wt{constructor(e){this._client=e}}let rg=class extends Wt{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}};rg||(rg={});let og=class extends Wt{constructor(){super(...arguments),this.completions=new rg(this._client)}};(function(t){t.Completions=rg})(og||(og={}));class sg extends Wt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,__binaryResponse:!0})}}sg||(sg={});class ag extends Wt{create(e,n){return this._client.post("/audio/transcriptions",Zp({body:e,...n}))}}ag||(ag={});class lg extends Wt{create(e,n){return this._client.post("/audio/translations",Zp({body:e,...n}))}}lg||(lg={});class cg extends Wt{constructor(){super(...arguments),this.transcriptions=new ag(this._client),this.translations=new lg(this._client),this.speech=new sg(this._client)}}(function(t){t.Transcriptions=ag,t.Translations=lg,t.Speech=sg})(cg||(cg={}));let dg=class extends Wt{create(e,n,i){return this._client.post(`/assistants/${e}/files`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}retrieve(e,n,i){return this._client.get(`/assistants/${e}/files/${n}`,{...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}list(e,n={},i){return jo(n)?this.list(e,{},n):this._client.getAPIList(`/assistants/${e}/files`,_y,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}del(e,n,i){return this._client.delete(`/assistants/${e}/files/${n}`,{...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}};class _y extends ea{}(function(t){t.AssistantFilesPage=_y})(dg||(dg={}));class ug extends Wt{constructor(){super(...arguments),this.files=new dg(this._client)}create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(e,n,i){return this._client.post(`/assistants/${e}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}list(e={},n){return jo(e)?this.list({},e):this._client.getAPIList("/assistants",Cy,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}class Cy extends ea{}(function(t){t.AssistantsPage=Cy,t.Files=dg,t.AssistantFilesPage=_y})(ug||(ug={}));function VC(t){return typeof t.parse=="function"}const O1=t=>t?.role==="assistant",J$=t=>t?.role==="function",eB=t=>t?.role==="tool";var Or=function(t,e,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(t,n):r?r.value=n:e.set(t,n),n},ut=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},Jn,E2,S2,ph,fh,T2,gh,cs,mh,I2,L2,g1,fm,hg,gm,mm,bm,vm,tB,ym;const zC=10;class nB{constructor(){Jn.add(this),this.controller=new AbortController,E2.set(this,void 0),S2.set(this,()=>{}),ph.set(this,()=>{}),fh.set(this,void 0),T2.set(this,()=>{}),gh.set(this,()=>{}),cs.set(this,{}),this._chatCompletions=[],this.messages=[],mh.set(this,!1),I2.set(this,!1),L2.set(this,!1),g1.set(this,!1),vm.set(this,e=>{if(Or(this,I2,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new yc),e instanceof yc)return Or(this,L2,!0,"f"),this._emit("abort",e);if(e instanceof Tt)return this._emit("error",e);if(e instanceof Error){const n=new Tt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Tt(String(e)))}),Or(this,E2,new Promise((e,n)=>{Or(this,S2,e,"f"),Or(this,ph,n,"f")}),"f"),Or(this,fh,new Promise((e,n)=>{Or(this,T2,e,"f"),Or(this,gh,n,"f")}),"f"),ut(this,E2,"f").catch(()=>{}),ut(this,fh,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ut(this,vm,"f"))},0)}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(J$(e)||eB(e))&&e.content)this._emit("functionCallResult",e.content);else if(O1(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(O1(e)&&e.tool_calls)for(const i of e.tool_calls)i.type==="function"&&this._emit("functionCall",i.function)}}_connected(){this.ended||(ut(this,S2,"f").call(this),this._emit("connect"))}get ended(){return ut(this,mh,"f")}get errored(){return ut(this,I2,"f")}get aborted(){return ut(this,L2,"f")}abort(){this.controller.abort()}on(e,n){return(ut(this,cs,"f")[e]||(ut(this,cs,"f")[e]=[])).push({listener:n}),this}off(e,n){const i=ut(this,cs,"f")[e];if(!i)return this;const r=i.findIndex(o=>o.listener===n);return r>=0&&i.splice(r,1),this}once(e,n){return(ut(this,cs,"f")[e]||(ut(this,cs,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,i)=>{Or(this,g1,!0,"f"),e!=="error"&&this.once("error",i),this.once(e,n)})}async done(){Or(this,g1,!0,"f"),await ut(this,fh,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Tt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ut(this,Jn,"m",fm).call(this)}async finalMessage(){return await this.done(),ut(this,Jn,"m",hg).call(this)}async finalFunctionCall(){return await this.done(),ut(this,Jn,"m",gm).call(this)}async finalFunctionCallResult(){return await this.done(),ut(this,Jn,"m",mm).call(this)}async totalUsage(){return await this.done(),ut(this,Jn,"m",bm).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...n){if(ut(this,mh,"f"))return;e==="end"&&(Or(this,mh,!0,"f"),ut(this,T2,"f").call(this));const i=ut(this,cs,"f")[e];if(i&&(ut(this,cs,"f")[e]=i.filter(r=>!r.once),i.forEach(({listener:r})=>r(...n))),e==="abort"){const r=n[0];!ut(this,g1,"f")&&!i?.length&&Promise.reject(r),ut(this,ph,"f").call(this,r),ut(this,gh,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=n[0];!ut(this,g1,"f")&&!i?.length&&Promise.reject(r),ut(this,ph,"f").call(this,r),ut(this,gh,"f").call(this,r),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ut(this,Jn,"m",hg).call(this);n&&this._emit("finalMessage",n);const i=ut(this,Jn,"m",fm).call(this);i&&this._emit("finalContent",i);const r=ut(this,Jn,"m",gm).call(this);r&&this._emit("finalFunctionCall",r);const o=ut(this,Jn,"m",mm).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(s=>s.usage)&&this._emit("totalUsage",ut(this,Jn,"m",bm).call(this))}async _createChatCompletion(e,n,i){const r=i?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),ut(this,Jn,"m",tB).call(this,n);const o=await e.create({...n,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addChatCompletion(o)}async _runChatCompletion(e,n,i){for(const r of n.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,n,i)}async _runFunctions(e,n,i){const r="function",{function_call:o="auto",stream:s,...a}=n,l=typeof o!="string"&&o?.name,{maxChatCompletions:c=zC}=i||{},d={};for(const h of n.functions)d[h.name||h.function.name]=h;const u=n.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of n.messages)this._addMessage(h,!1);for(let h=0;h<c;++h){const g=(await this._createChatCompletion(e,{...a,function_call:o,functions:u,messages:[...this.messages]},i)).choices[0]?.message;if(!g)throw new Tt("missing message in ChatCompletion response");if(!g.function_call)return;const{name:f,arguments:v}=g.function_call,m=d[f];if(m){if(l&&l!==f){const M=`Invalid function_call: ${JSON.stringify(f)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,name:f,content:M});continue}}else{const M=`Invalid function_call: ${JSON.stringify(f)}. Available options are: ${u.map(k=>JSON.stringify(k.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:f,content:M});continue}let y;try{y=VC(m)?await m.parse(v):v}catch(M){this._addMessage({role:r,name:f,content:M instanceof Error?M.message:String(M)});continue}const x=await m.function(y,this),T=ut(this,Jn,"m",ym).call(this,x);if(this._addMessage({role:r,name:f,content:T}),l)return}}async _runTools(e,n,i){const r="tool",{tool_choice:o="auto",stream:s,...a}=n,l=typeof o!="string"&&o?.function?.name,{maxChatCompletions:c=zC}=i||{},d={};for(const h of n.tools)h.type==="function"&&(d[h.function.name||h.function.function.name]=h.function);const u="tools"in n?n.tools.map(h=>h.type==="function"?{type:"function",function:{name:h.function.name||h.function.function.name,parameters:h.function.parameters,description:h.function.description}}:h):void 0;for(const h of n.messages)this._addMessage(h,!1);for(let h=0;h<c;++h){const g=(await this._createChatCompletion(e,{...a,tool_choice:o,tools:u,messages:[...this.messages]},i)).choices[0]?.message;if(!g)throw new Tt("missing message in ChatCompletion response");if(!g.tool_calls)return;for(const f of g.tool_calls){if(f.type!=="function")continue;const v=f.id,{name:m,arguments:y}=f.function,x=d[m];if(x){if(l&&l!==m){const _=`Invalid tool_call: ${JSON.stringify(m)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,tool_call_id:v,content:_});continue}}else{const _=`Invalid tool_call: ${JSON.stringify(m)}. Available options are: ${u.map(A=>JSON.stringify(A.function.name)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:v,content:_});continue}let T;try{T=VC(x)?await x.parse(y):y}catch(_){const A=_ instanceof Error?_.message:String(_);this._addMessage({role:r,tool_call_id:v,content:A});continue}const M=await x.function(T,this),k=ut(this,Jn,"m",ym).call(this,M);if(this._addMessage({role:r,tool_call_id:v,content:k}),l)return}}}}E2=new WeakMap,S2=new WeakMap,ph=new WeakMap,fh=new WeakMap,T2=new WeakMap,gh=new WeakMap,cs=new WeakMap,mh=new WeakMap,I2=new WeakMap,L2=new WeakMap,g1=new WeakMap,vm=new WeakMap,Jn=new WeakSet,fm=function(){return ut(this,Jn,"m",hg).call(this).content??null},hg=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(O1(n))return{...n,content:n.content??null}}throw new Tt("stream ended without producing a ChatCompletionMessage with role=assistant")},gm=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(O1(n)&&n?.function_call)return n.function_call;if(O1(n)&&n?.tool_calls?.length)return n.tool_calls.at(-1)?.function}},mm=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(J$(n)&&n.content!=null||eB(n)&&n.content!=null&&this.messages.some(i=>i.role==="assistant"&&i.tool_calls?.some(r=>r.type==="function"&&r.id===n.tool_call_id)))return n.content}},bm=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},tB=function(e){if(e.n!=null&&e.n>1)throw new Tt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ym=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Wp extends nB{static runFunctions(e,n,i){const r=new Wp,o={...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,n,o)),r}static runTools(e,n,i){const r=new Wp,o={...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,n,o)),r}_addMessage(e){super._addMessage(e),O1(e)&&e.content&&this._emit("content",e.content)}}var Rr=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},c7=function(t,e,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(t,n):r?r.value=n:e.set(t,n),n},ho,aa,d7,u7,Xf,jC;class qp extends nB{constructor(){super(...arguments),ho.add(this),aa.set(this,void 0)}get currentChatCompletionSnapshot(){return Rr(this,aa,"f")}static fromReadableStream(e){const n=new qp;return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,i){const r=new qp;return r._run(()=>r._runChatCompletion(e,{...n,stream:!0},{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,n,i){const r=i?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Rr(this,ho,"m",d7).call(this);const o=await e.create({...n,stream:!0},{...i,signal:this.controller.signal});this._connected();for await(const s of o)Rr(this,ho,"m",u7).call(this,s);if(o.controller.signal?.aborted)throw new yc;return this._addChatCompletion(Rr(this,ho,"m",Xf).call(this))}async _fromReadableStream(e,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Rr(this,ho,"m",d7).call(this),this._connected();const r=ba.fromReadableStream(e,this.controller);let o;for await(const s of r)o&&o!==s.id&&this._addChatCompletion(Rr(this,ho,"m",Xf).call(this)),Rr(this,ho,"m",u7).call(this,s),o=s.id;if(r.controller.signal?.aborted)throw new yc;return this._addChatCompletion(Rr(this,ho,"m",Xf).call(this))}[(aa=new WeakMap,ho=new WeakSet,d7=function(){this.ended||c7(this,aa,void 0,"f")},u7=function(n){if(this.ended)return;const i=Rr(this,ho,"m",jC).call(this,n);this._emit("chunk",n,i);const r=n.choices[0]?.delta?.content,o=i.choices[0]?.message;r!=null&&o?.role==="assistant"&&o?.content&&this._emit("content",r,o.content)},Xf=function(){if(this.ended)throw new Tt("stream has ended, this shouldn't happen");const n=Rr(this,aa,"f");if(!n)throw new Tt("request ended without sending any chunks");return c7(this,aa,void 0,"f"),w2e(n)},jC=function(n){var i,r,o;let s=Rr(this,aa,"f");const{choices:a,...l}=n;s?Object.assign(s,l):s=c7(this,aa,{...l,choices:[]},"f");for(const{delta:c,finish_reason:d,index:u,logprobs:h=null,...p}of n.choices){let g=s.choices[u];if(g||(g=s.choices[u]={finish_reason:d,index:u,message:{},logprobs:h,...p}),h)if(!g.logprobs)g.logprobs=Object.assign({},h);else{const{content:T,...M}=h;Object.assign(g.logprobs,M),T&&((i=g.logprobs).content??(i.content=[]),g.logprobs.content.push(...T))}if(d&&(g.finish_reason=d),Object.assign(g,p),!c)continue;const{content:f,function_call:v,role:m,tool_calls:y,...x}=c;if(Object.assign(g.message,x),f&&(g.message.content=(g.message.content||"")+f),m&&(g.message.role=m),v&&(g.message.function_call?(v.name&&(g.message.function_call.name=v.name),v.arguments&&((r=g.message.function_call).arguments??(r.arguments=""),g.message.function_call.arguments+=v.arguments)):g.message.function_call=v),y){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:T,id:M,type:k,function:_,...A}of y){const $=(o=g.message.tool_calls)[T]??(o[T]={});Object.assign($,A),M&&($.id=M),k&&($.type=k),_&&($.function??($.function={arguments:""})),_?.name&&($.function.name=_.name),_?.arguments&&($.function.arguments+=_.arguments)}}}return s},Symbol.asyncIterator)](){const e=[],n=[];let i=!1;return this.on("chunk",r=>{const o=n.shift();o?o(r):e.push(r)}),this.on("end",()=>{i=!0;for(const r of n)r(void 0);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise(o=>n.push(o)).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0})}}toReadableStream(){return new ba(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function w2e(t){const{id:e,choices:n,created:i,model:r,system_fingerprint:o,...s}=t;return{...s,id:e,choices:n.map(({message:a,finish_reason:l,index:c,logprobs:d,...u})=>{if(!l)throw new Tt(`missing finish_reason for choice ${c}`);const{content:h=null,function_call:p,tool_calls:g,...f}=a,v=a.role;if(!v)throw new Tt(`missing role for choice ${c}`);if(p){const{arguments:m,name:y}=p;if(m==null)throw new Tt(`missing function_call.arguments for choice ${c}`);if(!y)throw new Tt(`missing function_call.name for choice ${c}`);return{...u,message:{content:h,function_call:{arguments:m,name:y},role:v},finish_reason:l,index:c,logprobs:d}}return g?{...u,index:c,finish_reason:l,logprobs:d,message:{...f,role:v,content:h,tool_calls:g.map((m,y)=>{const{function:x,type:T,id:M,...k}=m,{arguments:_,name:A,...$}=x||{};if(M==null)throw new Tt(`missing choices[${c}].tool_calls[${y}].id
${Kf(t)}`);if(T==null)throw new Tt(`missing choices[${c}].tool_calls[${y}].type
${Kf(t)}`);if(A==null)throw new Tt(`missing choices[${c}].tool_calls[${y}].function.name
${Kf(t)}`);if(_==null)throw new Tt(`missing choices[${c}].tool_calls[${y}].function.arguments
${Kf(t)}`);return{...k,id:M,type:T,function:{...$,name:A,arguments:_}}})}}:{...u,message:{...f,content:h,role:v},finish_reason:l,index:c,logprobs:d}}),created:i,model:r,object:"chat.completion",...o?{system_fingerprint:o}:{}}}function Kf(t){return JSON.stringify(t)}class R1 extends qp{static fromReadableStream(e){const n=new R1;return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,i){const r=new R1,o={...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,n,o)),r}static runTools(e,n,i){const r=new R1,o={...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,n,o)),r}}let iB=class extends Wt{runFunctions(e,n){return e.stream?R1.runFunctions(this._client.chat.completions,e,n):Wp.runFunctions(this._client.chat.completions,e,n)}runTools(e,n){return e.stream?R1.runTools(this._client.chat.completions,e,n):Wp.runTools(this._client.chat.completions,e,n)}stream(e,n){return qp.createChatCompletion(this._client.chat.completions,e,n)}};class pg extends Wt{constructor(){super(...arguments),this.completions=new iB(this._client)}}(function(t){t.Completions=iB})(pg||(pg={}));let fg=class extends Wt{retrieve(e,n,i,r){return this._client.get(`/threads/${e}/messages/${n}/files/${i}`,{...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(e,n,i={},r){return jo(i)?this.list(e,n,{},i):this._client.getAPIList(`/threads/${e}/messages/${n}/files`,ky,{query:i,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}};class ky extends ea{}(function(t){t.MessageFilesPage=ky})(fg||(fg={}));class gg extends Wt{constructor(){super(...arguments),this.files=new fg(this._client)}create(e,n,i){return this._client.post(`/threads/${e}/messages`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}retrieve(e,n,i){return this._client.get(`/threads/${e}/messages/${n}`,{...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}update(e,n,i,r){return this._client.post(`/threads/${e}/messages/${n}`,{body:i,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(e,n={},i){return jo(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Ey,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}}class Ey extends ea{}(function(t){t.ThreadMessagesPage=Ey,t.Files=fg,t.MessageFilesPage=ky})(gg||(gg={}));class mg extends Wt{retrieve(e,n,i,r){return this._client.get(`/threads/${e}/runs/${n}/steps/${i}`,{...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(e,n,i={},r){return jo(i)?this.list(e,n,{},i):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Sy,{query:i,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}}class Sy extends ea{}(function(t){t.RunStepsPage=Sy})(mg||(mg={}));class bg extends Wt{constructor(){super(...arguments),this.steps=new mg(this._client)}create(e,n,i){return this._client.post(`/threads/${e}/runs`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}retrieve(e,n,i){return this._client.get(`/threads/${e}/runs/${n}`,{...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}update(e,n,i,r){return this._client.post(`/threads/${e}/runs/${n}`,{body:i,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(e,n={},i){return jo(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Ty,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}cancel(e,n,i){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}submitToolOutputs(e,n,i,r){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:i,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}}class Ty extends ea{}(function(t){t.RunsPage=Ty,t.Steps=mg,t.RunStepsPage=Sy})(bg||(bg={}));class vg extends Wt{constructor(){super(...arguments),this.runs=new bg(this._client),this.messages=new gg(this._client)}create(e={},n){return jo(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(e,n,i){return this._client.post(`/threads/${e}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v1",...i?.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}(function(t){t.Runs=bg,t.RunsPage=Ty,t.Messages=gg,t.ThreadMessagesPage=Ey})(vg||(vg={}));class yg extends Wt{constructor(){super(...arguments),this.chat=new pg(this._client),this.assistants=new ug(this._client),this.threads=new vg(this._client)}}(function(t){t.Chat=pg,t.Assistants=ug,t.AssistantsPage=Cy,t.Threads=vg})(yg||(yg={}));class wg extends Wt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}wg||(wg={});class xg extends Wt{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}xg||(xg={});class _g extends Wt{create(e,n){return this._client.post("/files",Zp({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return jo(e)?this.list({},e):this._client.getAPIList("/files",Iy,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n?.headers}})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:i=30*60*1e3}={}){const r=new Set(["processed","error","deleted"]),o=Date.now();let s=await this.retrieve(e);for(;!s.status||!r.has(s.status);)if(await X$(n),s=await this.retrieve(e),Date.now()-o>i)throw new wy({message:`Giving up on waiting for file ${e} to finish processing after ${i} milliseconds.`});return s}}class Iy extends xy{}(function(t){t.FileObjectsPage=Iy})(_g||(_g={}));class Cg extends Wt{create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return jo(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Ly,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},i){return jo(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,My,{query:n,...i})}}class Ly extends ea{}class My extends ea{}(function(t){t.FineTuningJobsPage=Ly,t.FineTuningJobEventsPage=My})(Cg||(Cg={}));class kg extends Wt{constructor(){super(...arguments),this.jobs=new Cg(this._client)}}(function(t){t.Jobs=Cg,t.FineTuningJobsPage=Ly,t.FineTuningJobEventsPage=My})(kg||(kg={}));class Eg extends Wt{createVariation(e,n){return this._client.post("/images/variations",Zp({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Zp({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}Eg||(Eg={});class Sg extends Wt{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Py,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class Py extends xy{}(function(t){t.ModelsPage=Py})(Sg||(Sg={}));class Tg extends Wt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}Tg||(Tg={});var rB;class pn extends l2e{constructor({baseURL:e=l7("OPENAI_BASE_URL"),apiKey:n=l7("OPENAI_API_KEY"),organization:i=l7("OPENAI_ORG_ID")??null,...r}={}){if(n===void 0)throw new Tt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:i,...r,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&y2e())throw new Tt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new wg(this),this.chat=new og(this),this.embeddings=new xg(this),this.files=new _g(this),this.images=new Eg(this),this.audio=new cg(this),this.moderations=new Tg(this),this.models=new Sg(this),this.fineTuning=new kg(this),this.beta=new yg(this),this._options=o,this.apiKey=n,this.organization=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}rB=pn;pn.OpenAI=rB;pn.OpenAIError=Tt;pn.APIError=ai;pn.APIConnectionError=P4;pn.APIConnectionTimeoutError=wy;pn.APIUserAbortError=yc;pn.NotFoundError=H$;pn.ConflictError=F$;pn.RateLimitError=V$;pn.BadRequestError=O$;pn.AuthenticationError=R$;pn.InternalServerError=z$;pn.PermissionDeniedError=N$;pn.UnprocessableEntityError=U$;(function(t){t.toFile=Z$,t.fileFromPath=B$,t.Page=xy,t.CursorPage=ea,t.Completions=wg,t.Chat=og,t.Embeddings=xg,t.Files=_g,t.FileObjectsPage=Iy,t.Images=Eg,t.Audio=cg,t.Moderations=Tg,t.Models=Sg,t.ModelsPage=Py,t.FineTuning=kg,t.Beta=yg})(pn||(pn={}));const x2e=(t,e)=>{if(e)return zi.getService("edit image",I4).generateImage(t,e.toDataURL())},_2e=(t,e)=>{const n=atob(t);let i=n.length;const r=new Uint8Array(i);for(;i--;)r[i]=n.charCodeAt(i);return new File([r],e,{type:"image/png"})},wm=(t,e)=>{const n=atob(t.split(",")[1]);let i=n.length;const r=new Uint8Array(i);for(;i--;)r[i]=n.charCodeAt(i);return new File([r],e,{type:"image/jpeg"})},ta=vy({key:"OpenAI",color:"#202123",initData:()=>({apiKey:""}),renderConfigEditor:(t,e)=>b`
      <div style="display:flex;flex-direction: column;gap: 12px;">
        <div>
          <label for="key">Key</label>
          <input
            type="text"
            id="key"
            .value="${t.apiKey}"
            @input="${n=>{const i=n.target;t.apiKey=i.value,e()}}"
          />
        </div>
      </div>
    `}),C2e=t=>t.map(e=>e.role==="assistant"?{role:e.role,content:e.content}:e),J0=async(t,e,n)=>(await new pn({apiKey:t,dangerouslyAllowBrowser:!0}).chat.completions.create({messages:C2e(n),model:e,temperature:0,max_tokens:4096})).choices[0].message;Tu.implService({name:"GPT3.5 Turbo",method:t=>({generateText:async e=>(await J0(t.apiKey,"gpt-3.5-turbo-1106",e)).content??""}),vendor:ta});Tu.implService({name:"GPT4",method:t=>({generateText:async e=>(await J0(t.apiKey,"gpt-4",e)).content??""}),vendor:ta});qc.implService({name:"GPT3.5 Turbo",method:t=>({chat:async e=>(await J0(t.apiKey,"gpt-3.5-turbo-1106",e)).content??""}),vendor:ta});qc.implService({name:"GPT4",method:t=>({chat:async e=>(await J0(t.apiKey,"gpt-4",e)).content??""}),vendor:ta});qc.implService({name:"GPT4-Vision",method:t=>({chat:async e=>(await J0(t.apiKey,"gpt-4-vision-preview",e)).content??""}),vendor:ta});Q0.implService({name:"DALL-E3",method:t=>({generateImage:async e=>{const n=t.apiKey,r=await new pn({apiKey:n,dangerouslyAllowBrowser:!0}).images.generate({prompt:e,model:"dall-e-3",response_format:"b64_json"});return _2e(r.data[0].b64_json??"","img")}}),vendor:ta});const GC=async(t,e)=>(await new pn({apiKey:t,dangerouslyAllowBrowser:!0}).embeddings.create({input:e,model:"text-embedding-ada-002",encoding_format:"float"})).data.map(r=>r.embedding);jp.implService({name:"Ada 002",method:t=>({generateEmbedding:async e=>(await GC(t.apiKey,[e]))[0],generateEmbeddings:async e=>GC(t.apiKey,e)}),vendor:ta});T4.implService({name:"GPT4 Vision",method:t=>({generateText:async e=>{const n=t.apiKey;return(await new pn({apiKey:n,dangerouslyAllowBrowser:!0}).chat.completions.create({messages:e,model:"gpt-4-vision-preview",temperature:0,max_tokens:4096})).choices[0].message.content??""}}),vendor:ta});var Yp={},ef={},Ay={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.withProxy=t.TARGET_URL_HEADER=t.withMiddleware=void 0;function e(...i){return r=>i.reduce((o,s)=>o.then(a=>s(a)),Promise.resolve(r))}t.withMiddleware=e,t.TARGET_URL_HEADER="x-fal-target-url";function n(i){return typeof window>"u"?r=>Promise.resolve(r):r=>Promise.resolve(Object.assign(Object.assign({},r),{url:i.targetUrl,headers:Object.assign(Object.assign({},r.headers||{}),{[t.TARGET_URL_HEADER]:r.url})}))}t.withProxy=n})(Ay);var _o={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xm=function(t,e){return xm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)i.hasOwnProperty(r)&&(n[r]=i[r])},xm(t,e)};function k2e(t,e){xm(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var _m=function(){return _m=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_m.apply(this,arguments)};function E2e(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function S2e(t,e,n,i){var r=arguments.length,o=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function T2e(t,e){return function(n,i){e(n,i,t)}}function I2e(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function L2e(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(u){s(u)}}function l(d){try{c(i.throw(d))}catch(u){s(u)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(t,e||[])).next())})}function M2e(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],r=0}finally{i=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function P2e(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}function A2e(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Cm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oB(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,o=[],s;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return o}function $2e(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(oB(arguments[e]));return t}function B2e(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function Xp(t){return this instanceof Xp?(this.v=t,this):new Xp(t)}function D2e(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(h){i[h]&&(r[h]=function(p){return new Promise(function(g,f){o.push([h,p,g,f])>1||a(h,p)})})}function a(h,p){try{l(i[h](p))}catch(g){u(o[0][3],g)}}function l(h){h.value instanceof Xp?Promise.resolve(h.value.v).then(c,d):u(o[0][2],h)}function c(h){a("next",h)}function d(h){a("throw",h)}function u(h,p){h(p),o.shift(),o.length&&a(o[0][0],o[0][1])}}function O2e(t){var e,n;return e={},i("next"),i("throw",function(r){throw r}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(r,o){e[r]=t[r]?function(s){return(n=!n)?{value:Xp(t[r](s)),done:r==="return"}:o?o(s):s}:o}}function R2e(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Cm=="function"?Cm(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}function N2e(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function H2e(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function F2e(t){return t&&t.__esModule?t:{default:t}}function U2e(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function V2e(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const z2e=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _m},__asyncDelegator:O2e,__asyncGenerator:D2e,__asyncValues:R2e,__await:Xp,__awaiter:L2e,__classPrivateFieldGet:U2e,__classPrivateFieldSet:V2e,__createBinding:P2e,__decorate:S2e,__exportStar:A2e,__extends:k2e,__generator:M2e,__importDefault:F2e,__importStar:H2e,__makeTemplateObject:N2e,__metadata:I2e,__param:T2e,__read:oB,__rest:E2e,__spread:$2e,__spreadArrays:B2e,__values:Cm},Symbol.toStringTag,{value:"Module"})),tf=Sm(z2e);Object.defineProperty(_o,"__esModule",{value:!0});_o.defaultResponseHandler=_o.ValidationError=_o.ApiError=void 0;const j2e=tf;class Ig extends Error{constructor({message:e,status:n,body:i}){super(e),this.name="ApiError",this.status=n,this.body=i}}_o.ApiError=Ig;class sB extends Ig{constructor(e){super(e),this.name="ValidationError"}get fieldErrors(){return typeof this.body.detail=="string"?[{loc:["body"],msg:this.body.detail,type:"value_error"}]:this.body.detail||[]}getFieldErrors(e){return this.fieldErrors.filter(n=>n.loc[n.loc.length-1]===e)}}_o.ValidationError=sB;function G2e(t){var e;return j2e.__awaiter(this,void 0,void 0,function*(){const{status:n,statusText:i}=t,r=(e=t.headers.get("Content-Type"))!==null&&e!==void 0?e:"";if(!t.ok){if(r.includes("application/json")){const o=yield t.json(),s=n===422?sB:Ig;throw new s({message:o.message||i,status:n,body:o})}throw new Ig({message:`HTTP ${n}: ${i}`,status:n})}return r.includes("application/json")?t.json():r.includes("text/html")?t.text():r.includes("application/octet-stream")?t.arrayBuffer():t.text()})}_o.defaultResponseHandler=G2e;(function(t){var e={};Object.defineProperty(t,"__esModule",{value:!0}),t.getRestApiUrl=t.getConfig=t.config=t.credentialsFromEnv=void 0;const n=Ay,i=_o;function r(){return typeof process<"u"&&e&&(typeof e.FAL_KEY<"u"||typeof e.FAL_KEY_ID<"u"&&typeof e.FAL_KEY_SECRET<"u")}const o=()=>{if(r())return typeof e.FAL_KEY<"u"?e.FAL_KEY:`${e.FAL_KEY_ID}:${e.FAL_KEY_SECRET}`};t.credentialsFromEnv=o;const s={credentials:t.credentialsFromEnv,requestMiddleware:u=>Promise.resolve(u),responseHandler:i.defaultResponseHandler};let a;function l(u){a=Object.assign(Object.assign({},s),u),u.proxyUrl&&(a=Object.assign(Object.assign({},a),{requestMiddleware:(0,n.withMiddleware)(a.requestMiddleware,(0,n.withProxy)({targetUrl:u.proxyUrl}))}))}t.config=l;function c(){return a||(console.info("Using default configuration for the fal client"),Object.assign({},s))}t.getConfig=c;function d(){return"https://rest.alpha.fal.ai"}t.getRestApiUrl=d})(ef);var aB={},Iu={},xc={};const Z2e="@fal-ai/serverless-client",W2e="The fal serverless JS/TS client",q2e="0.8.2",Y2e="MIT",X2e={type:"git",url:"https://github.com/fal-ai/serverless-js.git",directory:"libs/client"},K2e=["fal","serverless","client","ai","ml"],Q2e={"@msgpack/msgpack":"^3.0.0-beta2",robot3:"^0.4.1","uuid-random":"^1.3.2"},J2e={node:">=18.0.0"},e5e="./src/index.js",t5e="commonjs",n5e={name:Z2e,description:W2e,version:q2e,license:Y2e,repository:X2e,keywords:K2e,dependencies:Q2e,engines:J2e,main:e5e,type:t5e};Object.defineProperty(xc,"__esModule",{value:!0});xc.getUserAgent=xc.isBrowser=void 0;function i5e(){return typeof window<"u"&&typeof window.document<"u"}xc.isBrowser=i5e;let Qf=null;function r5e(){if(Qf!==null)return Qf;const t=n5e;return Qf=`${t.name}/${t.version}`,Qf}xc.getUserAgent=r5e;Object.defineProperty(Iu,"__esModule",{value:!0});Iu.dispatchRequest=void 0;const o5e=tf,s5e=ef,ZC=xc,a5e=typeof navigator<"u"&&navigator?.userAgent==="Cloudflare-Workers";function l5e(t,e,n){return o5e.__awaiter(this,void 0,void 0,function*(){const{credentials:i,requestMiddleware:r,responseHandler:o}=(0,s5e.getConfig)(),s=(0,ZC.isBrowser)()?{}:{"User-Agent":(0,ZC.getUserAgent)()},a=typeof i=="function"?i():i,{url:l,headers:c}=yield r({url:e}),d=a?{Authorization:`Key ${a}`}:{};typeof window<"u"&&a&&console.warn("The fal credentials are exposed in the browser's environment. That's not recommended for production use cases.");const u=Object.assign(Object.assign(Object.assign(Object.assign({},d),{Accept:"application/json","Content-Type":"application/json"}),s),c??{}),h=yield fetch(l,Object.assign(Object.assign({method:t,headers:u},!a5e&&{mode:"cors"}),{body:t.toLowerCase()!=="get"&&n?JSON.stringify(n):void 0}));return yield o(h)})}Iu.dispatchRequest=l5e;var $y={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.storageImpl=void 0;const e=tf,n=ef,i=Iu;function r(a){if(!a.startsWith("data:"))return!1;try{return new URL(a).protocol==="data:"}catch{return!1}}function o(a){var l;const[c,d]=a.split("/");return(l=d.split(/[-;]/)[0])!==null&&l!==void 0?l:"bin"}function s(a){return e.__awaiter(this,void 0,void 0,function*(){const l=a.type||"application/octet-stream",c=a.name||`${Date.now()}.${o(l)}`;return yield(0,i.dispatchRequest)("POST",`${(0,n.getRestApiUrl)()}/storage/upload/initiate`,{content_type:l,file_name:c})})}t.storageImpl={upload:a=>e.__awaiter(void 0,void 0,void 0,function*(){const{upload_url:l,file_url:c}=yield s(a),d=yield fetch(l,{method:"PUT",body:a,headers:{"Content-Type":a.type||"application/octet-stream"}}),{responseHandler:u}=(0,n.getConfig)();return yield u(d),c}),transformInput:a=>e.__awaiter(void 0,void 0,void 0,function*(){const l=Object.entries(a).map(([d,u])=>e.__awaiter(void 0,void 0,void 0,function*(){if(u instanceof Blob||typeof u=="string"&&r(u)){let h=u;typeof u=="string"&&r(u)&&(h=yield(yield fetch(u)).blob());const p=yield t.storageImpl.upload(h);return[d,p]}return[d,u]})),c=yield Promise.all(l);return Object.fromEntries(c)})}})($y);var Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.isReact=Ji.throttle=Ji.isValidUrl=Ji.ensureAppIdFormat=Ji.isUUIDv4=void 0;function c5e(t){return typeof t=="string"&&t.length===36&&t[14]==="4"&&["8","9","a","b"].includes(t[19])}Ji.isUUIDv4=c5e;function d5e(t){if(t.split("/").length===2)return t;const[,n,i]=/^([0-9]+)-([a-zA-Z0-9-]+)$/.exec(t)||[];if(n&&i)return`${n}/${i}`;throw new Error(`Invalid app id: ${t}. Must be in the format <appOwner>/<appId>`)}Ji.ensureAppIdFormat=d5e;function u5e(t){try{const{host:e}=new URL(t);return/(fal\.(ai|run))$/.test(e)}catch{return!1}}Ji.isValidUrl=u5e;function h5e(t,e,n=!1){let i,r;return(...o)=>{!r&&n?(t(...o),r=Date.now()):(i&&clearTimeout(i),i=setTimeout(()=>{Date.now()-r>=e&&(t(...o),r=Date.now())},e-(Date.now()-r)))}}Ji.throttle=h5e;let h7;function p5e(){if(h7===void 0){const t=new Error().stack;h7=!!t&&(t.includes("node_modules/react-dom/")||t.includes("node_modules/next/"))}return h7}Ji.isReact=p5e;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.queue=t.subscribe=t.run=t.send=t.buildUrl=void 0;const e=tf,n=Iu,i=$y,r=Ji;function o(c,d={}){var u,h;const p=((u=d.method)!==null&&u!==void 0?u:"post").toLowerCase(),g=((h=d.path)!==null&&h!==void 0?h:"").replace(/^\//,"").replace(/\/{2,}/,"/"),f=d.input,v=p==="get"&&f?new URLSearchParams(f):void 0,m=v?`?${v.toString()}`:"",y=c.split("/");if((0,r.isValidUrl)(c))return`${c.endsWith("/")?c:`${c}/`}${g}${m}`;if(y.length===2&&(0,r.isUUIDv4)(y[1]))return`https://gateway.shark.fal.ai/trigger/${c}/${g}${m}`;const x=(0,r.ensureAppIdFormat)(c);return`${`https://${d.subdomain?`${d.subdomain}.`:""}fal.run/${x}/${g}`.replace(/\/$/,"")}${m}`}t.buildUrl=o;function s(c,d={}){var u;return e.__awaiter(this,void 0,void 0,function*(){const h=d.input&&d.autoUpload!==!1?yield i.storageImpl.transformInput(d.input):d.input;return(0,n.dispatchRequest)((u=d.method)!==null&&u!==void 0?u:"post",o(c,d),h)})}t.send=s;function a(c,d={}){return e.__awaiter(this,void 0,void 0,function*(){return s(c,d)})}t.run=a;function l(c,d={}){return e.__awaiter(this,void 0,void 0,function*(){const{request_id:u}=yield t.queue.submit(c,d);return d.onEnqueue&&d.onEnqueue(u),new Promise((h,p)=>{var g;let f;const v=(g=d.pollInterval)!==null&&g!==void 0?g:1e3,m=()=>e.__awaiter(this,void 0,void 0,function*(){var y;try{const x=yield t.queue.status(c,{requestId:u,logs:(y=d.logs)!==null&&y!==void 0?y:!1});if(d.onQueueUpdate&&d.onQueueUpdate(x),x.status==="COMPLETED"){clearTimeout(f);try{const T=yield t.queue.result(c,{requestId:u});h(T)}catch(T){p(T)}return}f=setTimeout(m,v)}catch(x){clearTimeout(f),p(x)}});m().catch(p)})})}t.subscribe=l,t.queue={submit(c,d){return e.__awaiter(this,void 0,void 0,function*(){const{webhookUrl:u,path:h=""}=d,p=e.__rest(d,["webhookUrl","path"]),g=u?"?"+new URLSearchParams({fal_webhook:u}).toString():"";return s(c,Object.assign(Object.assign({},p),{subdomain:"queue",method:"post",path:h+g}))})},status(c,{requestId:d,logs:u=!1}){return e.__awaiter(this,void 0,void 0,function*(){return s(c,{subdomain:"queue",method:"get",path:`/requests/${d}/status`,input:{logs:u?"1":"0"}})})},result(c,{requestId:d}){return e.__awaiter(this,void 0,void 0,function*(){return s(c,{subdomain:"queue",method:"get",path:`/requests/${d}`})})},subscribe:l}})(aB);var $4={};function f5e(t){for(var e=t.length,n=0,i=0;i<e;){var r=t.charCodeAt(i++);if(r&4294967168)if(!(r&4294965248))n+=2;else{if(r>=55296&&r<=56319&&i<e){var o=t.charCodeAt(i);(o&64512)===56320&&(++i,r=((r&1023)<<10)+(o&1023)+65536)}r&4294901760?n+=4:n+=3}else{n++;continue}}return n}function g5e(t,e,n){for(var i=t.length,r=n,o=0;o<i;){var s=t.charCodeAt(o++);if(s&4294967168)if(!(s&4294965248))e[r++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&o<i){var a=t.charCodeAt(o);(a&64512)===56320&&(++o,s=((s&1023)<<10)+(a&1023)+65536)}s&4294901760?(e[r++]=s>>18&7|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128):(e[r++]=s>>12&15|224,e[r++]=s>>6&63|128)}else{e[r++]=s;continue}e[r++]=s&63|128}}var m5e=new TextEncoder,b5e=50;function v5e(t,e,n){m5e.encodeInto(t,e.subarray(n))}function y5e(t,e,n){t.length>b5e?v5e(t,e,n):g5e(t,e,n)}var w5e=4096;function lB(t,e,n){for(var i=e,r=i+n,o=[],s="";i<r;){var a=t[i++];if(!(a&128))o.push(a);else if((a&224)===192){var l=t[i++]&63;o.push((a&31)<<6|l)}else if((a&240)===224){var l=t[i++]&63,c=t[i++]&63;o.push((a&31)<<12|l<<6|c)}else if((a&248)===240){var l=t[i++]&63,c=t[i++]&63,d=t[i++]&63,u=(a&7)<<18|l<<12|c<<6|d;u>65535&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|u&1023),o.push(u)}else o.push(a);o.length>=w5e&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(s+=String.fromCharCode.apply(String,o)),s}var x5e=new TextDecoder,_5e=200;function C5e(t,e,n){var i=t.subarray(e,e+n);return x5e.decode(i)}function k5e(t,e,n){return n>_5e?C5e(t,e,n):lB(t,e,n)}var bh=function(){function t(e,n){this.type=e,this.data=n}return t}(),E5e=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Hr=function(t){E5e(e,t);function e(n){var i=t.call(this,n)||this,r=Object.create(e.prototype);return Object.setPrototypeOf(i,r),Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:e.name}),i}return e}(Error),Ju=4294967295;function S5e(t,e,n){var i=n/4294967296,r=n;t.setUint32(e,i),t.setUint32(e+4,r)}function cB(t,e,n){var i=Math.floor(n/4294967296),r=n;t.setUint32(e,i),t.setUint32(e+4,r)}function dB(t,e){var n=t.getInt32(e),i=t.getUint32(e+4);return n*4294967296+i}function T5e(t,e){var n=t.getUint32(e),i=t.getUint32(e+4);return n*4294967296+i}var uB=-1,I5e=4294967296-1,L5e=17179869184-1;function hB(t){var e=t.sec,n=t.nsec;if(e>=0&&n>=0&&e<=L5e)if(n===0&&e<=I5e){var i=new Uint8Array(4),r=new DataView(i.buffer);return r.setUint32(0,e),i}else{var o=e/4294967296,s=e&4294967295,i=new Uint8Array(8),r=new DataView(i.buffer);return r.setUint32(0,n<<2|o&3),r.setUint32(4,s),i}else{var i=new Uint8Array(12),r=new DataView(i.buffer);return r.setUint32(0,n),cB(r,4,e),i}}function pB(t){var e=t.getTime(),n=Math.floor(e/1e3),i=(e-n*1e3)*1e6,r=Math.floor(i/1e9);return{sec:n+r,nsec:i-r*1e9}}function fB(t){if(t instanceof Date){var e=pB(t);return hB(e)}else return null}function gB(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:{var n=e.getUint32(0),i=0;return{sec:n,nsec:i}}case 8:{var r=e.getUint32(0),o=e.getUint32(4),n=(r&3)*4294967296+o,i=r>>>2;return{sec:n,nsec:i}}case 12:{var n=dB(e,4),i=e.getUint32(0);return{sec:n,nsec:i}}default:throw new Hr("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(t.length))}}function mB(t){var e=gB(t);return new Date(e.sec*1e3+e.nsec/1e6)}var M5e={type:uB,encode:fB,decode:mB},By=function(){function t(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(M5e)}return t.prototype.register=function(e){var n=e.type,i=e.encode,r=e.decode;if(n>=0)this.encoders[n]=i,this.decoders[n]=r;else{var o=1+n;this.builtInEncoders[o]=i,this.builtInDecoders[o]=r}},t.prototype.tryToEncode=function(e,n){for(var i=0;i<this.builtInEncoders.length;i++){var r=this.builtInEncoders[i];if(r!=null){var o=r(e,n);if(o!=null){var s=-1-i;return new bh(s,o)}}}for(var i=0;i<this.encoders.length;i++){var r=this.encoders[i];if(r!=null){var o=r(e,n);if(o!=null){var s=i;return new bh(s,o)}}}return e instanceof bh?e:null},t.prototype.decode=function(e,n,i){var r=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return r?r(e,n,i):new bh(n,e)},t.defaultCodec=new t,t}();function Lg(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Uint8Array.from(t)}function P5e(t){if(t instanceof ArrayBuffer)return new DataView(t);var e=Lg(t);return new DataView(e.buffer,e.byteOffset,e.byteLength)}var A5e=100,$5e=2048,bB=function(){function t(e){var n,i,r,o,s,a,l,c;this.extensionCodec=(n=e?.extensionCodec)!==null&&n!==void 0?n:By.defaultCodec,this.context=e?.context,this.useBigInt64=(i=e?.useBigInt64)!==null&&i!==void 0?i:!1,this.maxDepth=(r=e?.maxDepth)!==null&&r!==void 0?r:A5e,this.initialBufferSize=(o=e?.initialBufferSize)!==null&&o!==void 0?o:$5e,this.sortKeys=(s=e?.sortKeys)!==null&&s!==void 0?s:!1,this.forceFloat32=(a=e?.forceFloat32)!==null&&a!==void 0?a:!1,this.ignoreUndefined=(l=e?.ignoreUndefined)!==null&&l!==void 0?l:!1,this.forceIntegerToFloat=(c=e?.forceIntegerToFloat)!==null&&c!==void 0?c:!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return t.prototype.reinitializeState=function(){this.pos=0},t.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},t.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},t.prototype.doEncode=function(e,n){if(n>this.maxDepth)throw new Error("Too deep objects in depth ".concat(n));e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)},t.prototype.ensureBufferSizeToWrite=function(e){var n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)},t.prototype.resizeBuffer=function(e){var n=new ArrayBuffer(e),i=new Uint8Array(n),r=new DataView(n);i.set(this.bytes),this.view=r,this.bytes=i},t.prototype.encodeNil=function(){this.writeU8(192)},t.prototype.encodeBoolean=function(e){e===!1?this.writeU8(194):this.writeU8(195)},t.prototype.encodeNumber=function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)},t.prototype.encodeNumberAsFloat=function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},t.prototype.encodeBigInt64=function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))},t.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error("Too long string: ".concat(e," bytes in UTF-8"))},t.prototype.encodeString=function(e){var n=5,i=f5e(e);this.ensureBufferSizeToWrite(n+i),this.writeStringHeader(i),y5e(e,this.bytes,this.pos),this.pos+=i},t.prototype.encodeObject=function(e,n){var i=this.extensionCodec.tryToEncode(e,this.context);if(i!=null)this.encodeExtension(i);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)))},t.prototype.encodeBinary=function(e){var n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error("Too large binary: ".concat(n));var i=Lg(e);this.writeU8a(i)},t.prototype.encodeArray=function(e,n){var i=e.length;if(i<16)this.writeU8(144+i);else if(i<65536)this.writeU8(220),this.writeU16(i);else if(i<4294967296)this.writeU8(221),this.writeU32(i);else throw new Error("Too large array: ".concat(i));for(var r=0,o=e;r<o.length;r++){var s=o[r];this.doEncode(s,n+1)}},t.prototype.countWithoutUndefined=function(e,n){for(var i=0,r=0,o=n;r<o.length;r++){var s=o[r];e[s]!==void 0&&i++}return i},t.prototype.encodeMap=function(e,n){var i=Object.keys(e);this.sortKeys&&i.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,i):i.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else if(r<4294967296)this.writeU8(223),this.writeU32(r);else throw new Error("Too large map object: ".concat(r));for(var o=0,s=i;o<s.length;o++){var a=s[o],l=e[a];this.ignoreUndefined&&l===void 0||(this.encodeString(a),this.doEncode(l,n+1))}},t.prototype.encodeExtension=function(e){var n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error("Too large extension object: ".concat(n));this.writeI8(e.type),this.writeU8a(e.data)},t.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},t.prototype.writeU8a=function(e){var n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n},t.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},t.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},t.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},t.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},t.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},t.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},t.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},t.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),S5e(this.view,this.pos,e),this.pos+=8},t.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),cB(this.view,this.pos,e),this.pos+=8},t.prototype.writeBigUint64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8},t.prototype.writeBigInt64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8},t}();function B5e(t,e){var n=new bB(e);return n.encodeSharedRef(t)}function p7(t){return"".concat(t<0?"-":"","0x").concat(Math.abs(t).toString(16).padStart(2,"0"))}var D5e=16,O5e=16,R5e=function(){function t(e,n){e===void 0&&(e=D5e),n===void 0&&(n=O5e),this.maxKeyLength=e,this.maxLengthPerKey=n,this.hit=0,this.miss=0,this.caches=[];for(var i=0;i<this.maxKeyLength;i++)this.caches.push([])}return t.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},t.prototype.find=function(e,n,i){var r=this.caches[i-1];e:for(var o=0,s=r;o<s.length;o++){for(var a=s[o],l=a.bytes,c=0;c<i;c++)if(l[c]!==e[n+c])continue e;return a.str}return null},t.prototype.store=function(e,n){var i=this.caches[e.length-1],r={bytes:e,str:n};i.length>=this.maxLengthPerKey?i[Math.random()*i.length|0]=r:i.push(r)},t.prototype.decode=function(e,n,i){var r=this.find(e,n,i);if(r!=null)return this.hit++,r;this.miss++;var o=lB(e,n,i),s=Uint8Array.prototype.slice.call(e,n,n+i);return this.store(s,o),o},t}(),N5e=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(u){s(u)}}function l(d){try{c(i.throw(d))}catch(u){s(u)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(t,e||[])).next())})},f7=function(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(i=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],r=0}finally{i=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},WC=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),r(a,l,s.done,s.value)})}}function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}},N1=function(t){return this instanceof N1?(this.v=t,this):new N1(t)},H5e=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(h){i[h]&&(r[h]=function(p){return new Promise(function(g,f){o.push([h,p,g,f])>1||a(h,p)})})}function a(h,p){try{l(i[h](p))}catch(g){u(o[0][3],g)}}function l(h){h.value instanceof N1?Promise.resolve(h.value.v).then(c,d):u(o[0][2],h)}function c(h){a("next",h)}function d(h){a("throw",h)}function u(h,p){h(p),o.shift(),o.length&&a(o[0][0],o[0][1])}},qC="array",Jf="map_key",F5e="map_value",U5e=function(t){return typeof t=="string"||typeof t=="number"},eh=-1,Dy=new DataView(new ArrayBuffer(0)),V5e=new Uint8Array(Dy.buffer);try{Dy.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var Mg=RangeError,YC=new Mg("Insufficient data"),z5e=new R5e,Lu=function(){function t(e){var n,i,r,o,s,a,l;this.totalPos=0,this.pos=0,this.view=Dy,this.bytes=V5e,this.headByte=eh,this.stack=[],this.extensionCodec=(n=e?.extensionCodec)!==null&&n!==void 0?n:By.defaultCodec,this.context=e?.context,this.useBigInt64=(i=e?.useBigInt64)!==null&&i!==void 0?i:!1,this.maxStrLength=(r=e?.maxStrLength)!==null&&r!==void 0?r:Ju,this.maxBinLength=(o=e?.maxBinLength)!==null&&o!==void 0?o:Ju,this.maxArrayLength=(s=e?.maxArrayLength)!==null&&s!==void 0?s:Ju,this.maxMapLength=(a=e?.maxMapLength)!==null&&a!==void 0?a:Ju,this.maxExtLength=(l=e?.maxExtLength)!==null&&l!==void 0?l:Ju,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:z5e}return t.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=eh,this.stack.length=0},t.prototype.setBuffer=function(e){this.bytes=Lg(e),this.view=P5e(this.bytes),this.pos=0},t.prototype.appendBuffer=function(e){if(this.headByte===eh&&!this.hasRemaining(1))this.setBuffer(e);else{var n=this.bytes.subarray(this.pos),i=Lg(e),r=new Uint8Array(n.length+i.length);r.set(n),r.set(i,n.length),this.setBuffer(r)}},t.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},t.prototype.createExtraByteError=function(e){var n=this,i=n.view,r=n.pos;return new RangeError("Extra ".concat(i.byteLength-r," of ").concat(i.byteLength," byte(s) found at buffer[").concat(e,"]"))},t.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n},t.prototype.decodeMulti=function(e){return f7(this,function(n){switch(n.label){case 0:this.reinitializeState(),this.setBuffer(e),n.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}})},t.prototype.decodeAsync=function(e){var n,i,r,o,s,a,l;return N5e(this,void 0,void 0,function(){var c,d,u,h,p,g,f,v;return f7(this,function(m){switch(m.label){case 0:c=!1,m.label=1;case 1:m.trys.push([1,6,7,12]),n=!0,i=WC(e),m.label=2;case 2:return[4,i.next()];case 3:if(r=m.sent(),o=r.done,!!o)return[3,5];l=r.value,n=!1;try{if(u=l,c)throw this.createExtraByteError(this.totalPos);this.appendBuffer(u);try{d=this.doDecodeSync(),c=!0}catch(y){if(!(y instanceof Mg))throw y}this.totalPos+=this.pos}finally{n=!0}m.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return h=m.sent(),s={error:h},[3,12];case 7:return m.trys.push([7,,10,11]),!n&&!o&&(a=i.return)?[4,a.call(i)]:[3,9];case 8:m.sent(),m.label=9;case 9:return[3,11];case 10:if(s)throw s.error;return[7];case 11:return[7];case 12:if(c){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,d]}throw p=this,g=p.headByte,f=p.pos,v=p.totalPos,new RangeError("Insufficient data in parsing ".concat(p7(g)," at ").concat(v," (").concat(f," in the current buffer)"))}})})},t.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},t.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},t.prototype.decodeMultiAsync=function(e,n){return H5e(this,arguments,function(){var r,o,s,a,l,c,d,u,h,p,g,f;return f7(this,function(v){switch(v.label){case 0:r=n,o=-1,v.label=1;case 1:v.trys.push([1,15,16,21]),s=!0,a=WC(e),v.label=2;case 2:return[4,N1(a.next())];case 3:if(l=v.sent(),h=l.done,!!h)return[3,14];f=l.value,s=!1,v.label=4;case 4:if(v.trys.push([4,,12,13]),c=f,n&&o===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(c),r&&(o=this.readArraySize(),r=!1,this.complete()),v.label=5;case 5:v.trys.push([5,10,,11]),v.label=6;case 6:return[4,N1(this.doDecodeSync())];case 7:return[4,v.sent()];case 8:return v.sent(),--o===0?[3,9]:[3,6];case 9:return[3,11];case 10:if(d=v.sent(),!(d instanceof Mg))throw d;return[3,11];case 11:return this.totalPos+=this.pos,[3,13];case 12:return s=!0,[7];case 13:return[3,2];case 14:return[3,21];case 15:return u=v.sent(),p={error:u},[3,21];case 16:return v.trys.push([16,,19,20]),!s&&!h&&(g=a.return)?[4,N1(g.call(a))]:[3,18];case 17:v.sent(),v.label=18;case 18:return[3,20];case 19:if(p)throw p.error;return[7];case 20:return[7];case 21:return[2]}})})},t.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),n=void 0;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){var i=e-128;if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e<160){var i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else{var r=e-160;n=this.decodeUtf8String(r,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){var r=this.lookU8();n=this.decodeUtf8String(r,1)}else if(e===218){var r=this.lookU16();n=this.decodeUtf8String(r,2)}else if(e===219){var r=this.lookU32();n=this.decodeUtf8String(r,4)}else if(e===220){var i=this.readU16();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===221){var i=this.readU32();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===222){var i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===223){var i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===196){var i=this.lookU8();n=this.decodeBinary(i,1)}else if(e===197){var i=this.lookU16();n=this.decodeBinary(i,2)}else if(e===198){var i=this.lookU32();n=this.decodeBinary(i,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){var i=this.lookU8();n=this.decodeExtension(i,1)}else if(e===200){var i=this.lookU16();n=this.decodeExtension(i,2)}else if(e===201){var i=this.lookU32();n=this.decodeExtension(i,4)}else throw new Hr("Unrecognized type byte: ".concat(p7(e)));this.complete();for(var o=this.stack;o.length>0;){var s=o[o.length-1];if(s.type===qC)if(s.array[s.position]=n,s.position++,s.position===s.size)o.pop(),n=s.array;else continue e;else if(s.type===Jf){if(!U5e(n))throw new Hr("The type of key must be string or number but "+typeof n);if(n==="__proto__")throw new Hr("The key __proto__ is not allowed");s.key=n,s.type=F5e;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)o.pop(),n=s.map;else{s.key=null,s.type=Jf;continue e}}return n}},t.prototype.readHeadByte=function(){return this.headByte===eh&&(this.headByte=this.readU8()),this.headByte},t.prototype.complete=function(){this.headByte=eh},t.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Hr("Unrecognized array type byte: ".concat(p7(e)))}}},t.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new Hr("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:Jf,size:e,key:null,readCount:0,map:{}})},t.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new Hr("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:qC,size:e,array:new Array(e),position:0})},t.prototype.decodeUtf8String=function(e,n){var i;if(e>this.maxStrLength)throw new Hr("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+n+e)throw YC;var r=this.pos+n,o;return this.stateIsMapKey()&&(!((i=this.keyDecoder)===null||i===void 0)&&i.canBeCached(e))?o=this.keyDecoder.decode(this.bytes,r,e):o=k5e(this.bytes,r,e),this.pos+=n+e,o},t.prototype.stateIsMapKey=function(){if(this.stack.length>0){var e=this.stack[this.stack.length-1];return e.type===Jf}return!1},t.prototype.decodeBinary=function(e,n){if(e>this.maxBinLength)throw new Hr("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+n))throw YC;var i=this.pos+n,r=this.bytes.subarray(i,i+e);return this.pos+=n+e,r},t.prototype.decodeExtension=function(e,n){if(e>this.maxExtLength)throw new Hr("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var i=this.view.getInt8(this.pos+n),r=this.decodeBinary(e,n+1);return this.extensionCodec.decode(r,i,this.context)},t.prototype.lookU8=function(){return this.view.getUint8(this.pos)},t.prototype.lookU16=function(){return this.view.getUint16(this.pos)},t.prototype.lookU32=function(){return this.view.getUint32(this.pos)},t.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},t.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},t.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},t.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},t.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},t.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},t.prototype.readU64=function(){var e=T5e(this.view,this.pos);return this.pos+=8,e},t.prototype.readI64=function(){var e=dB(this.view,this.pos);return this.pos+=8,e},t.prototype.readU64AsBigInt=function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e},t.prototype.readI64AsBigInt=function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e},t.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},t.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},t}();function j5e(t,e){var n=new Lu(e);return n.decode(t)}function G5e(t,e){var n=new Lu(e);return n.decodeMulti(t)}var Z5e=function(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(i=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],r=0}finally{i=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},H1=function(t){return this instanceof H1?(this.v=t,this):new H1(t)},W5e=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(h){i[h]&&(r[h]=function(p){return new Promise(function(g,f){o.push([h,p,g,f])>1||a(h,p)})})}function a(h,p){try{l(i[h](p))}catch(g){u(o[0][3],g)}}function l(h){h.value instanceof H1?Promise.resolve(h.value.v).then(c,d):u(o[0][2],h)}function c(h){a("next",h)}function d(h){a("throw",h)}function u(h,p){h(p),o.shift(),o.length&&a(o[0][0],o[0][1])}};function q5e(t){return t[Symbol.asyncIterator]!=null}function Y5e(t){if(t==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function X5e(t){return W5e(this,arguments,function(){var n,i,r,o;return Z5e(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,H1(n.read())];case 3:return i=s.sent(),r=i.done,o=i.value,r?[4,H1(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return Y5e(o),[4,H1(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Oy(t){return q5e(t)?t:X5e(t)}var K5e=function(t,e,n,i){function r(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(d){try{c(i.next(d))}catch(u){s(u)}}function l(d){try{c(i.throw(d))}catch(u){s(u)}}function c(d){d.done?o(d.value):r(d.value).then(a,l)}c((i=i.apply(t,e||[])).next())})},Q5e=function(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(i=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],r=0}finally{i=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};function J5e(t,e){return K5e(this,void 0,void 0,function(){var n,i;return Q5e(this,function(r){return n=Oy(t),i=new Lu(e),[2,i.decodeAsync(n)]})})}function ege(t,e){var n=Oy(t),i=new Lu(e);return i.decodeArrayStream(n)}function tge(t,e){var n=Oy(t),i=new Lu(e);return i.decodeStream(n)}var nge=void 0;const ige=Object.freeze(Object.defineProperty({__proto__:null,DataViewIndexOutOfBoundsError:Mg,DecodeError:Hr,Decoder:Lu,EXT_TIMESTAMP:uB,Encoder:bB,ExtData:bh,ExtensionCodec:By,decode:j5e,decodeArrayStream:ege,decodeAsync:J5e,decodeMulti:G5e,decodeMultiStream:tge,decodeStream:nge,decodeTimestampExtension:mB,decodeTimestampToTimeSpec:gB,encode:B5e,encodeDateToTimeSpec:pB,encodeTimeSpecToTimestamp:hB,encodeTimestampExtension:fB},Symbol.toStringTag,{value:"Module"})),rge=Sm(ige);var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function Tn(t){return{enumerable:!0,value:t}}function XC(t){return{enumerable:!0,writable:!0,value:t}}let _c={},oge=()=>!0,KC=()=>({}),vB=t=>t,sge=(t,e,n,i)=>t.apply(n,i)&&e.apply(n,i),age=(t,e,n,[i,r])=>e.call(n,t.call(n,i,r),r),Xa=(t,e)=>Object.freeze(Object.create(t,e));function QC(t,e,n){return t.reduce((i,r)=>function(...o){return n(i,r,this,o)},e)}function yB(t){return Xa(this,{fn:Tn(t)})}let wB={},xB=yB.bind(wB),lge=t=>xB((e,n)=>!!~t(e,n)&&e),_B={},cge=yB.bind(_B);function Pg(t,e){return e.filter(n=>t.isPrototypeOf(n))}function CB(t,e,...n){let i=QC(Pg(_B,n).map(o=>o.fn),oge,sge),r=QC(Pg(wB,n).map(o=>o.fn),vB,age);return Xa(this,{from:Tn(t),to:Tn(e),guards:Tn(i),reducers:Tn(r)})}let kB={},EB={},dge=CB.bind(kB),uge=CB.bind(EB,null);function hge(t,e,n){return Ny(e,t,n,this.immediates)||t}function SB(t){let e=new Map;for(let n of t)e.has(n.from)||e.set(n.from,[]),e.get(n.from).push(n);return e}let pge={enter:vB};function fge(...t){let e=Pg(kB,t),n=Pg(EB,t),i={final:Tn(t.length===0),transitions:Tn(SB(e))};return n.length&&(i.immediates=Tn(n),i.enter=Tn(hge)),Xa(pge,i)}let gge={enter(t,e,n){let i=this.fn.call(e,e.context,n);return Ry.isPrototypeOf(i)?Xa(TB,{machine:Tn(i),transitions:Tn(this.transitions)}).enter(t,e,n):(i.then(r=>e.send({type:"done",data:r})).catch(r=>e.send({type:"error",error:r})),t)}},TB={enter(t,e,n){if(e.child=IB(this.machine,i=>{e.onChange(i),e.child==i&&i.machine.state.value.final&&(delete e.child,e.send({type:"done",data:i.context}))},e.context,n),e.child.machine.state.value.final){let i=e.child.context;return delete e.child,Ny(e,t,{type:"done",data:i},this.transitions.get("done"))}return t}};function mge(t,...e){let n=Tn(SB(e));return Ry.isPrototypeOf(t)?Xa(TB,{machine:Tn(t),transitions:n}):Xa(gge,{fn:Tn(t),transitions:n})}let Ry={get state(){return{name:this.current,value:this.states[this.current]}}};function bge(t,e,n=KC){return typeof t!="string"&&(n=e||KC,e=t,t=Object.keys(e)[0]),_c._create&&_c._create(t,e),Xa(Ry,{context:Tn(n),current:Tn(t),states:Tn(e)})}function Ny(t,e,n,i){let{context:r}=t;for(let{to:o,guards:s,reducers:a}of i)if(s(r,n)){t.context=a.call(t,r,n);let l=e.original||e,c=Xa(l,{current:Tn(o),original:{value:l}});return _c._onEnter&&_c._onEnter(e,o,t.context,r,n),c.state.value.enter(c,t,n)}}function vge(t,e){let n=e.type||e,{machine:i}=t,{value:r,name:o}=i.state;return r.transitions.has(n)?Ny(t,i,e,r.transitions.get(n))||i:(_c._send&&_c._send(n,o),i)}let yge={send(t){this.machine=vge(this,t),this.onChange(this)}};function IB(t,e,n,i){let r=Object.create(yge,{machine:XC(t),context:XC(t.context(n,i)),onChange:Tn(e)});return r.send=r.send.bind(r),r.machine=r.machine.state.value.enter(r.machine,r,i),r}Ar.action=lge;Ar.createMachine=bge;Ar.d=_c;Ar.guard=cge;Ar.immediate=uge;Ar.interpret=IB;Ar.invoke=mge;Ar.reduce=xB;Ar.state=fge;Ar.transition=dge;var g7={exports:{}};const wge={},xge=Object.freeze(Object.defineProperty({__proto__:null,default:wge},Symbol.toStringTag,{value:"Module"})),_ge=Sm(xge);var JC;function Cge(){return JC||(JC=1,function(t){(function(){var e,n=0,i=[],r;for(r=0;r<256;r++)i[r]=(r+256).toString(16).substr(1);l.BUFFER_SIZE=4096,l.bin=a,l.clearBuffer=function(){e=null,n=0},l.test=function(c){return typeof c=="string"?/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c):!1};var o;typeof crypto<"u"?o=crypto:typeof window<"u"&&typeof window.msCrypto<"u"&&(o=window.msCrypto),typeof ch=="function"?(o=o||_ge,t.exports=l):typeof window<"u"&&(window.uuid=l),l.randomBytes=function(){if(o){if(o.randomBytes)return o.randomBytes;if(o.getRandomValues)return typeof Uint8Array.prototype.slice!="function"?function(c){var d=new Uint8Array(c);return o.getRandomValues(d),Array.from(d)}:function(c){var d=new Uint8Array(c);return o.getRandomValues(d),d}}return function(c){var d,u=[];for(d=0;d<c;d++)u.push(Math.floor(Math.random()*256));return u}}();function s(c){return(!e||n+c>l.BUFFER_SIZE)&&(n=0,e=l.randomBytes(l.BUFFER_SIZE)),e.slice(n,n+=c)}function a(){var c=s(16);return c[6]=c[6]&15|64,c[8]=c[8]&63|128,c}function l(){var c=a();return i[c[0]]+i[c[1]]+i[c[2]]+i[c[3]]+"-"+i[c[4]]+i[c[5]]+"-"+i[c[6]]+i[c[7]]+"-"+i[c[8]]+i[c[9]]+"-"+i[c[10]]+i[c[11]]+i[c[12]]+i[c[13]]+i[c[14]]+i[c[15]]}})()}(g7)),g7.exports}Object.defineProperty($4,"__esModule",{value:!0});$4.realtimeImpl=void 0;const LB=tf,M2=rge,ct=Ar,ek=LB.__importDefault(Cge()),kge=ef,Ege=Iu,m7=_o,tk=xc,B4=Ji,Sge=()=>({enqueuedMessage:void 0});function Tge(t){return t.token!==void 0}function Ige(t){return!Tge(t)}function e2(t,e){return Object.assign(Object.assign({},t),{enqueuedMessage:e.message})}function b7(t){return t.websocket&&t.websocket.readyState===WebSocket.OPEN&&t.websocket.close(),Object.assign(Object.assign({},t),{websocket:void 0})}function Lge(t,e){return t.websocket&&t.websocket.readyState===WebSocket.OPEN?(e.message instanceof Uint8Array?t.websocket.send(e.message):Dge(e.message)?t.websocket.send((0,M2.encode)(e.message)):t.websocket.send(JSON.stringify(e.message)),Object.assign(Object.assign({},t),{enqueuedMessage:void 0})):Object.assign(Object.assign({},t),{enqueuedMessage:e.message})}function v7(t){return Object.assign(Object.assign({},t),{token:void 0})}function Mge(t,e){return Object.assign(Object.assign({},t),{token:e.token})}function Pge(t,e){return Object.assign(Object.assign({},t),{websocket:e.websocket})}const Age=(0,ct.createMachine)("idle",{idle:(0,ct.state)((0,ct.transition)("send","connecting",(0,ct.reduce)(e2)),(0,ct.transition)("expireToken","idle",(0,ct.reduce)(v7))),connecting:(0,ct.state)((0,ct.transition)("connecting","connecting"),(0,ct.transition)("connected","active",(0,ct.reduce)(Pge)),(0,ct.transition)("connectionClosed","idle",(0,ct.reduce)(b7)),(0,ct.transition)("send","connecting",(0,ct.reduce)(e2)),(0,ct.immediate)("authRequired",(0,ct.guard)(Ige))),authRequired:(0,ct.state)((0,ct.transition)("initiateAuth","authInProgress"),(0,ct.transition)("send","authRequired",(0,ct.reduce)(e2))),authInProgress:(0,ct.state)((0,ct.transition)("authenticated","connecting",(0,ct.reduce)(Mge)),(0,ct.transition)("unauthorized","idle",(0,ct.reduce)(v7),(0,ct.reduce)(b7)),(0,ct.transition)("send","authInProgress",(0,ct.reduce)(e2))),active:(0,ct.state)((0,ct.transition)("send","active",(0,ct.reduce)(Lge)),(0,ct.transition)("unauthorized","idle",(0,ct.reduce)(v7)),(0,ct.transition)("connectionClosed","idle",(0,ct.reduce)(b7))),failed:(0,ct.state)((0,ct.transition)("send","failed"))},Sge);function $ge(t,{token:e,maxBuffering:n}){if(n!==void 0&&(n<1||n>60))throw new Error("The `maxBuffering` must be between 1 and 60 (inclusive)");const i=new URLSearchParams({fal_jwt_token:e});return n!==void 0&&i.set("max_buffering",n.toFixed(0)),`wss://fal.run/${(0,B4.ensureAppIdFormat)(t)}/ws?${i.toString()}`}const MB=120,Bge=128;function Dge(t){return Object.values(t).some(e=>e instanceof Blob||e instanceof ArrayBuffer||e instanceof Uint8Array)}function Oge(t){return LB.__awaiter(this,void 0,void 0,function*(){const[,e]=(0,B4.ensureAppIdFormat)(t).split("/"),n=yield(0,Ege.dispatchRequest)("POST",`${(0,kge.getRestApiUrl)()}/tokens/`,{allowed_apps:[e],token_expiration:MB});return typeof n!="string"&&n.detail?n.detail:n})}function Rge(t){return t.status==="error"&&t.error==="Unauthorized"}const Nge={NORMAL_CLOSURE:1e3,GOING_AWAY:1001},y7=new Map,nk=new Map;function Hge(t,e,n){if(!y7.has(t)){const i=(0,ct.interpret)(Age,n);y7.set(t,Object.assign(Object.assign({},i),{throttledSend:e>0?(0,B4.throttle)(i.send,e,!0):i.send}))}return y7.get(t)}const Nh=()=>{},Fge={send:Nh,close:Nh};function Uge(t){return t.status!=="error"&&t.type!=="x-fal-message"&&!PB(t)}function PB(t){return t.type==="x-fal-error"}$4.realtimeImpl={connect(t,e){const{clientOnly:n=(0,B4.isReact)()&&!(0,tk.isBrowser)(),connectionKey:i=(0,ek.default)(),maxBuffering:r,throttleInterval:o=Bge}=e;if(n&&!(0,tk.isBrowser)())return Fge;let s;nk.set(i,{onError:e.onError,onResult:e.onResult});const a=()=>nk.get(i),l=Hge(i,o,({context:u,machine:h,send:p})=>{const{enqueuedMessage:g,token:f}=u;if(h.current==="active"&&g&&p({type:"send",message:g}),h.current==="authRequired"&&f===void 0&&s!==h.current&&(p({type:"initiateAuth"}),Oge(t).then(v=>{p({type:"authenticated",token:v});const m=Math.round(MB*.9*1e3);setTimeout(()=>{p({type:"expireToken"})},m)}).catch(v=>{p({type:"unauthorized",error:v})})),h.current==="connecting"&&s!==h.current&&f!==void 0){const v=new WebSocket($ge(t,{token:f,maxBuffering:r}));v.onopen=()=>{p({type:"connected",websocket:v})},v.onclose=m=>{if(m.code!==Nge.NORMAL_CLOSURE){const{onError:y=Nh}=a();y(new m7.ApiError({message:`Error closing the connection: ${m.reason}`,status:m.code}))}p({type:"connectionClosed",code:m.code})},v.onerror=m=>{const{onError:y=Nh}=a();y(new m7.ApiError({message:"Unknown error",status:500}))},v.onmessage=m=>{const{onResult:y}=a();if(m.data instanceof ArrayBuffer){const T=(0,M2.decode)(new Uint8Array(m.data));y(T);return}if(m.data instanceof Uint8Array){const T=(0,M2.decode)(m.data);y(T);return}if(m.data instanceof Blob){m.data.arrayBuffer().then(T=>{const M=(0,M2.decode)(new Uint8Array(T));y(M)});return}const x=JSON.parse(m.data);if(Rge(x)){p({type:"unauthorized",error:new Error("Unauthorized")});return}if(Uge(x)){y(x);return}if(PB(x)){const{onError:T=Nh}=a();T(new m7.ApiError({message:`${x.error}: ${x.reason}`,status:400,body:x}));return}}}s=h.current});return{send:u=>{var h;const p=u instanceof Uint8Array?u:Object.assign(Object.assign({},u),{request_id:(h=u.request_id)!==null&&h!==void 0?h:(0,ek.default)()});l.throttledSend({type:"send",message:p})},close:()=>{l.send({type:"close"})}}}};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.storage=t.ValidationError=t.ApiError=t.realtime=t.withProxy=t.withMiddleware=t.subscribe=t.run=t.queue=t.getConfig=t.config=void 0;var e=ef;Object.defineProperty(t,"config",{enumerable:!0,get:function(){return e.config}}),Object.defineProperty(t,"getConfig",{enumerable:!0,get:function(){return e.getConfig}});var n=aB;Object.defineProperty(t,"queue",{enumerable:!0,get:function(){return n.queue}}),Object.defineProperty(t,"run",{enumerable:!0,get:function(){return n.run}}),Object.defineProperty(t,"subscribe",{enumerable:!0,get:function(){return n.subscribe}});var i=Ay;Object.defineProperty(t,"withMiddleware",{enumerable:!0,get:function(){return i.withMiddleware}}),Object.defineProperty(t,"withProxy",{enumerable:!0,get:function(){return i.withProxy}});var r=$4;Object.defineProperty(t,"realtime",{enumerable:!0,get:function(){return r.realtimeImpl}});var o=_o;Object.defineProperty(t,"ApiError",{enumerable:!0,get:function(){return o.ApiError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return o.ValidationError}});var s=$y;Object.defineProperty(t,"storage",{enumerable:!0,get:function(){return s.storageImpl}})})(Yp);const D4=vy({key:"Fal",color:"#5C4DD2",initData:()=>({apiKey:""}),renderConfigEditor:(t,e)=>b`
      <div style="display:flex;flex-direction: column;gap: 12px;">
        <div>
          <label for="key">Key</label>
          <input
            type="text"
            id="key"
            .value="${t.apiKey}"
            @input="${n=>{const i=n.target;t.apiKey=i.value,e()}}"
          />
        </div>
      </div>
    `}),Vge=t=>{const e=Yp.realtime.connect("110602490-lcm-sd15-i2i",{onResult:r=>{const o=n.get(r.request_id);o&&(o(r.images[0].url),n.delete(r.request_id))},onError:r=>{console.error(r)}}),n=new Map;let i=0;return(r,o)=>new Promise(s=>{Yp.config({credentials:t}),e.send({request_id:`${i++}`,prompt:r,sync_mode:!0,enable_safety_checks:!1,image_url:o}),n.set(i.toString(),s)})};I4.implService({name:"110602490-lcm-sd15-i2i",method:({apiKey:t})=>({generateImage:async(e,n)=>(await fetch("https://110602490-lcm-sd15-i2i.gateway.alpha.fal.ai/",{method:"post",headers:{Authorization:`key ${t}`,"Content-Type":"application/json"},body:JSON.stringify({image_url:n,prompt:e,sync_mode:!0,seed:42,enable_safety_checks:!1})}).then(r=>r.json())).images[0].url}),vendor:D4});Q0.implService({name:"110602490-fast-sdxl",method:({apiKey:t})=>({generateImage:async e=>{Yp.config({credentials:t});const n=await Yp.subscribe("110602490-fast-sdxl",{input:{prompt:e,sync_mode:!0}});return wm(n.images[0].url,"img")}}),vendor:D4});L4.implService({name:"lcm-sd15-i2i",method:t=>({createFastRequest:()=>{const e=Vge(t.apiKey);return async(n,i)=>e(n,i)}}),vendor:D4});const Hy=vy({key:"llama",color:"#202123",initData:()=>({host:""}),renderConfigEditor:(t,e)=>b`
      <div style="display:flex;flex-direction: column;gap: 12px;">
        <div>
          <label for="key">Host</label>
          <input
            type="text"
            id="key"
            .value="${t.host}"
            @input="${n=>{const i=n.target;t.host=i.value,e()}}"
          />
        </div>
      </div>
    `});Tu.implService({name:"llama2",method:t=>({generateText:async e=>(await fetch(`${t.host}/api/chat`,{method:"POST",body:JSON.stringify({model:"llama2",messages:e,stream:!1})}).then(i=>i.json())).message.content}),vendor:Hy});qc.implService({name:"llama2",method:t=>({chat:async e=>{const n=e.map(r=>{if(r.role==="user"){let o="";const s=[];return r.content.forEach(a=>{a.type==="text"&&(o+=`${a.text}
`),a.type==="image_url"&&s.push(a.image_url.url.split(",")[1])}),{role:r.role,content:o,images:s}}return r});return(await fetch(`${t.host}/api/chat`,{method:"POST",body:JSON.stringify({model:"llama2",messages:n,stream:!1})}).then(r=>r.json())).message.content}}),vendor:Hy});var zge=Object.defineProperty,jge=Object.getOwnPropertyDescriptor,dr=(t,e,n,i)=>{for(var r=i>1?void 0:i?jge(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&zge(e,n,r),r};const ik=[ta,D4,Hy];let Ka=class extends me(De){constructor(){super(...arguments),this.key="",this.name=""}changeKeyByEvent(t){const e=t.target;this.changeKey(e.value)}get serviceKind(){return cm.find(t=>t.type===this.type)}changeKey(t){this.key=t,this.data=ik.find(e=>e.key===t)?.initData()}changeName(t){const e=t.target;this.name=e.value}save(){this.data&&this.onSave({id:Oe(),vendorKey:this.key,name:this.name,data:this.data})}close(){this.remove()}list(){const t=new Set;return cm.find(e=>e.type===this.type)?.implList.forEach(e=>{t.add(e.vendor)}),[...t]}render(){const t=this.list();if(!t){requestAnimationFrame(()=>{this.remove()});return}const e=ik.find(n=>n.key===this.key);if(!e){if(!t[0])return b` <div>no vendor</div>`;this.changeKey(t[0].key),requestAnimationFrame(()=>{this.requestUpdate()});return}return b`
      <div
        @click="${this.close}"
        style="position: fixed;left: 0;top: 0;width: 100vw;height: 100vh;background-color: rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;"
      >
        <div
          @click="${dm}"
          style="display:flex;flex-direction: column;background-color: white;border-radius: 8px;padding: 24px;gap: 12px;"
        >
          <div>
            <select .value="${e.key}" @change="${this.changeKeyByEvent}">
              ${Fe(t,n=>n.key,n=>b` <option value="${n.key}">${n.key}</option>`)}
            </select>
          </div>
          <div>
            <label>Name: </label>
            <input
              type="text"
              .value="${this.name}"
              @input="${this.changeName}"
            />
          </div>
          <div>
            ${e.renderConfigEditor(this.data,()=>this.requestUpdate())}
          </div>
          <div>
            <button @click="${this.save}"></button>
          </div>
        </div>
      </div>
    `}};dr([L({attribute:!1})],Ka.prototype,"type",2);dr([L({attribute:!1})],Ka.prototype,"onSave",2);dr([ie()],Ka.prototype,"key",2);dr([ie()],Ka.prototype,"name",2);dr([ie()],Ka.prototype,"data",2);Ka=dr([W("create-new-service")],Ka);let Kp=class extends me(De){changeService(t){const e=new Cc;e.featureKey=this.featureKey,e.service=this.service,e.close=()=>{this.requestUpdate()};const n=t.target;document.body.appendChild(e),ii(n,e).then(i=>{e.style.left=`${i.x}px`,e.style.top=`${i.y}px`}).catch(()=>{e.remove()})}render(){if(!zi.getVendorsByService(this.service))return b` <div style="font-size: 12px;color: red">no service</div>`;const e=zi.getVendor(this.featureKey,this.service);if(!e)return b` <div style="font-size: 12px;color: red">no vendor</div>`;const n=we({border:"1px solid",borderColor:e.impl.vendor.color,color:e.impl.vendor.color});return b`
      <div
        @click="${this.changeService}"
        class="vendor-service-select"
        style="${n}"
      >
        ${e.vendor.name} ${e.impl.vendor.key} ${e.impl.name}
      </div>
    `}};Kp.styles=X`
    .vendor-service-select {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      padding: 2px 4px;
      font-size: 12px;
      color: white;
      width: max-content;
      cursor: pointer;
    }
  `;dr([L({attribute:!1})],Kp.prototype,"featureKey",2);dr([L({attribute:!1})],Kp.prototype,"service",2);Kp=dr([W("vendor-service-select")],Kp);let Cc=class extends me(De){select(t,e){zi.changeService(this.featureKey,this.service.type,t.id,e.name),this.remove(),this.close()}render(){const t=zi.getVendorsByService(this.service);return b`
      <div
        style="background-color: var(--affine-background-overlay-panel-color);padding: 12px;display:flex;flex-direction: column;gap: 8px;"
      >
        ${Fe(t,e=>{const n=we({backgroundColor:e.impl.vendor.color});return b` <div
            @click="${()=>{this.select(e.vendor,e.impl)}}"
            class="vendor-service-option"
            style="${n}"
          >
            ${e.vendor.name} ${e.impl.vendor.key} ${e.impl.name}
          </div>`})}
      </div>
    `}};Cc.styles=X`
    vendor-service-options {
      position: fixed;
      font-family: var(--affine-font-family);
    }

    .vendor-service-option {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      padding: 2px 4px;
      font-size: 12px;
      color: white;
      width: max-content;
      cursor: pointer;
    }
  `;dr([L({attribute:!1})],Cc.prototype,"featureKey",2);dr([L({attribute:!1})],Cc.prototype,"service",2);dr([L({attribute:!1})],Cc.prototype,"close",2);Cc=dr([W("vendor-service-options")],Cc);const Gge=b`
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M6 12H18M12 6V18"
      stroke="currentColor"
      stroke-linecap="round"
      stroke-linejoin="round"
    />
  </svg>
`,Zge=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  viewBox="0 0 24 24"
>
  <g fill="none" fill-rule="evenodd">
    <path
      d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"
    />
    <path
      fill="currentColor"
      d="M14.035 2.809c.37-.266.89-.39 1.401-.203a9.99 9.99 0 0 1 2.982 1.725c.417.35.57.861.524 1.313c-.075.753.057 1.48.42 2.106c.32.557.802.997 1.39 1.307l.225.11c.414.187.782.576.875 1.113a10.06 10.06 0 0 1 0 3.44c-.083.484-.39.847-.753 1.051l-.122.063c-.69.31-1.254.79-1.616 1.416c-.362.627-.494 1.353-.419 2.106c.045.452-.107.964-.524 1.313a9.99 9.99 0 0 1-2.982 1.725a1.51 1.51 0 0 1-1.4-.203C13.42 20.75 12.723 20.5 12 20.5s-1.42.249-2.035.691a1.51 1.51 0 0 1-1.401.203a9.989 9.989 0 0 1-2.982-1.725a1.511 1.511 0 0 1-.524-1.313c.075-.753-.058-1.48-.42-2.106a3.414 3.414 0 0 0-1.39-1.307l-.225-.11a1.511 1.511 0 0 1-.875-1.113a10.057 10.057 0 0 1 0-3.44c.083-.484.39-.847.753-1.051l.122-.062c.69-.311 1.254-.79 1.616-1.417c.361-.626.494-1.353.419-2.106a1.511 1.511 0 0 1 .524-1.313a9.99 9.99 0 0 1 2.982-1.725a1.511 1.511 0 0 1 1.4.203c.615.442 1.312.691 2.036.691s1.42-.249 2.035-.691m.957 1.769c-.866.57-1.887.922-2.992.922s-2.126-.353-2.992-.922A7.99 7.99 0 0 0 7.068 5.7c.06 1.033-.145 2.093-.697 3.05c-.553.956-1.368 1.663-2.293 2.128a8.078 8.078 0 0 0 0 2.242c.925.465 1.74 1.172 2.293 2.13c.552.955.757 2.015.697 3.048a7.99 7.99 0 0 0 1.94 1.123c.866-.57 1.887-.922 2.992-.922s2.126.353 2.992.922a7.993 7.993 0 0 0 1.94-1.122c-.06-1.034.145-2.094.697-3.05c.552-.957 1.368-1.664 2.293-2.13a8.066 8.066 0 0 0 0-2.24c-.925-.466-1.74-1.173-2.293-2.13c-.552-.956-.757-2.016-.697-3.05a7.99 7.99 0 0 0-1.94-1.122ZM12 8a4 4 0 1 1 0 8a4 4 0 0 1 0-8m0 2a2 2 0 1 0 0 4a2 2 0 0 0 0-4"
    />
  </g>
</svg>`,Wge=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="currentColor"
  class="bi bi-filetype-doc"
  viewBox="0 0 16 16"
  part="svg"
>
  <path
    fill-rule="evenodd"
    d="M14 4.5V14a2 2 0 0 1-2 2v-1a1 1 0 0 0 1-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5Zm-7.839 9.166v.522c0 .256-.039.47-.117.641a.861.861 0 0 1-.322.387.877.877 0 0 1-.469.126.883.883 0 0 1-.471-.126.868.868 0 0 1-.32-.386 1.55 1.55 0 0 1-.117-.642v-.522c0-.257.04-.471.117-.641a.868.868 0 0 1 .32-.387.868.868 0 0 1 .471-.129c.176 0 .332.043.469.13a.861.861 0 0 1 .322.386c.078.17.117.384.117.641Zm.803.519v-.513c0-.377-.068-.7-.205-.972a1.46 1.46 0 0 0-.589-.63c-.254-.147-.56-.22-.917-.22-.355 0-.662.073-.92.22a1.441 1.441 0 0 0-.589.627c-.136.271-.205.596-.205.975v.513c0 .375.069.7.205.973.137.271.333.48.59.627.257.144.564.216.92.216.357 0 .662-.072.916-.216.256-.147.452-.356.59-.627.136-.274.204-.598.204-.973ZM0 11.926v4h1.459c.402 0 .735-.08.999-.238a1.45 1.45 0 0 0 .595-.689c.13-.3.196-.662.196-1.084 0-.42-.065-.778-.196-1.075a1.426 1.426 0 0 0-.59-.68c-.263-.156-.598-.234-1.004-.234H0Zm.791.645h.563c.248 0 .45.05.609.152a.89.89 0 0 1 .354.454c.079.201.118.452.118.753a2.3 2.3 0 0 1-.068.592 1.141 1.141 0 0 1-.196.422.8.8 0 0 1-.334.252 1.298 1.298 0 0 1-.483.082H.79V12.57Zm7.422.483a1.732 1.732 0 0 0-.103.633v.495c0 .246.034.455.103.627a.834.834 0 0 0 .298.393.845.845 0 0 0 .478.131.868.868 0 0 0 .401-.088.699.699 0 0 0 .273-.248.8.8 0 0 0 .117-.364h.765v.076a1.268 1.268 0 0 1-.226.674c-.137.194-.32.345-.55.454a1.81 1.81 0 0 1-.786.164c-.36 0-.664-.072-.914-.216a1.424 1.424 0 0 1-.571-.627c-.13-.272-.194-.597-.194-.976v-.498c0-.379.066-.705.197-.978.13-.274.321-.485.571-.633.252-.149.556-.223.911-.223.219 0 .421.032.607.097.187.062.35.153.489.272a1.326 1.326 0 0 1 .466.964v.073H9.78a.85.85 0 0 0-.12-.38.7.7 0 0 0-.273-.261.802.802 0 0 0-.398-.097.814.814 0 0 0-.475.138.868.868 0 0 0-.301.398Z"
  ></path>
</svg>`,qge=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  fill="currentColor"
  class="bi bi-palette"
  viewBox="0 0 16 16"
  part="svg"
>
  <path
    d="M8 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm4 3a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM5.5 7a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"
  ></path>
  <path
    d="M16 8c0 3.15-1.866 2.585-3.567 2.07C11.42 9.763 10.465 9.473 10 10c-.603.683-.475 1.819-.351 2.92C9.826 14.495 9.996 16 8 16a8 8 0 1 1 8-8zm-8 7c.611 0 .654-.171.655-.176.078-.146.124-.464.07-1.119-.014-.168-.037-.37-.061-.591-.052-.464-.112-1.005-.118-1.462-.01-.707.083-1.61.704-2.314.369-.417.845-.578 1.272-.618.404-.038.812.026 1.16.104.343.077.702.186 1.025.284l.028.008c.346.105.658.199.953.266.653.148.904.083.991.024C14.717 9.38 15 9.161 15 8a7 7 0 1 0-7 7z"
  ></path>
</svg>`,Yge=b`<svg
  xmlns="http://www.w3.org/2000/svg"
  width="16"
  height="16"
  viewBox="0 0 24 24"
>
  <path
    fill="currentColor"
    d="M3 2.75A2.75 2.75 0 0 1 5.75 0h14.5a.75.75 0 0 1 .75.75v20.5a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h5.25v-4H6A1.5 1.5 0 0 0 4.5 18v.75c0 .716.43 1.334 1.05 1.605a.75.75 0 0 1-.6 1.374A3.251 3.251 0 0 1 3 18.75ZM19.5 1.5H5.75c-.69 0-1.25.56-1.25 1.25v12.651A2.989 2.989 0 0 1 6 15h13.5Z"
  />
  <path
    fill="currentColor"
    d="M7 18.25a.25.25 0 0 1 .25-.25h5a.25.25 0 0 1 .25.25v5.01a.25.25 0 0 1-.397.201l-2.206-1.604a.25.25 0 0 0-.294 0L7.397 23.46a.25.25 0 0 1-.397-.2z"
  />
</svg>`,Xge=b`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="16"
    height="16"
    fill="currentColor"
    class="bi bi-stars"
    viewBox="0 0 16 16"
    part="svg"
  >
    <path
      d="M7.657 6.247c.11-.33.576-.33.686 0l.645 1.937a2.89 2.89 0 0 0 1.829 1.828l1.936.645c.33.11.33.576 0 .686l-1.937.645a2.89 2.89 0 0 0-1.828 1.829l-.645 1.936a.361.361 0 0 1-.686 0l-.645-1.937a2.89 2.89 0 0 0-1.828-1.828l-1.937-.645a.361.361 0 0 1 0-.686l1.937-.645a2.89 2.89 0 0 0 1.828-1.828l.645-1.937zM3.794 1.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387A1.734 1.734 0 0 0 4.593 5.69l-.387 1.162a.217.217 0 0 1-.412 0L3.407 5.69A1.734 1.734 0 0 0 2.31 4.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387A1.734 1.734 0 0 0 3.407 2.31l.387-1.162zM10.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732L9.1 2.137a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L10.863.1z"
    ></path>
  </svg>
`;class Kge{constructor(e){this.editor=e,this.selectTextForBackground=async()=>{const n=await T$(this.editor.host);n&&this.reactiveData.history.push({role:"user",content:[{type:"text",text:n}]})},this.selectShapesForBackground=async()=>{const n=await yy(this.editor.host);if(!n){alert("Please select some shapes first");return}const i=n.toDataURL();this.reactiveData.history.push({role:"user",content:[{type:"image_url",image_url:{url:i}}]})},this.splitPage=async n=>{const i=await Qge(n);return t3e(i)},this.embeddingPages=async n=>{const i={},r=(await Promise.all(n.map(async s=>(await this.splitPage(s)).map(a=>({id:s.id,text:a}))))).flat(),o=await zi.getService("chat with workspace",jp).generateEmbeddings(r.map(s=>s.text));return r.forEach((s,a)=>{(i[s.id]??(i[s.id]={id:s.id,sections:[]})).sections.push({vector:o[a],text:s.text})}),Object.values(i)},this.syncWorkspace=async()=>{this.reactiveData.syncedPages=await this.embeddingPages([...this.editor.page.workspace.pages.values()])},this.genAnswer=async()=>{if(!this.reactiveData.loading){this.reactiveData.loading=!0;try{const n=this.reactiveData.value;this.reactiveData.history.push({role:"user",content:[{text:n,type:"text"}]});const i=await this.getBackground();this.reactiveData.value="";const r=await Cfe().chat([...i.messages,...this.reactiveData.history]);this.reactiveData.history.push({role:"assistant",content:r??"",sources:i.sources})}finally{this.reactiveData.loading=!1}}}}get host(){return this.editor.host}async getBackground(){if(this.reactiveData.syncedPages.length===0)return{messages:[],sources:[]};const[e]=await zi.getService("chat with workspace",jp).generateEmbeddings([this.reactiveData.value]),n=this.reactiveData.syncedPages.flatMap(r=>r.sections.map(o=>({id:r.id,distance:Jge(e,o.vector),text:o.text}))).sort((r,o)=>r.distance-o.distance).filter(r=>r.distance<.7).slice(0,3),i=new Map;return n.forEach(r=>{let o=i.get(r.id);o||(o=[],i.set(r.id,o)),o.push(r.text)}),{messages:[{role:"system",content:`the background is:
${n.map(r=>r.text).join(`
`)}`}],sources:[...i.entries()].map(([r,o])=>({id:r,slice:o}))}}async replaceSelectedContent(e){if(!e)return;const n=await ng(this.host);if(!n.length)return;const i=n[0],r=i.parentBlockElement,o=r.model.children.findIndex(a=>a.id===i.model.id);n.forEach(a=>{this.editor.page.deleteBlock(a.model)});const s=await tg(this.host,e,r.model.id,o);setTimeout(()=>{const a=i.parentPath,l=s.map(c=>[...a,c.id]).map(c=>this.host.selection.create("block",{path:c}));this.host.selection.setGroup("note",l)},0)}async insertBelowSelectedContent(e){if(!e)return;const n=await ng(this.host),i=n.length;if(!i)return;const r=n[i-1],o=r.parentBlockElement,s=o.model.children.findIndex(l=>l.id===r.model.id),a=await tg(this.host,e,o.model.id,s+1);setTimeout(()=>{const l=r.parentPath,c=a.map(d=>[...l,d.id]).map(d=>this.host.selection.create("block",{path:d}));this.host.selection.setGroup("note",c)},0)}}const Qge=async t=>{const e=new ar({workspace:t.workspace}),n=await e.pageToSnapshot(t);return(await new Ws().fromPageSnapshot({snapshot:n,assets:e.assetsManager})).file},Jge=(t,e)=>{let n=0;for(let i=0;i<t.length;i++)n+=(t[i]-e[i])**2;return Math.sqrt(n)},e3e=(t,e)=>{const n=[];for(;t.length;)n.push(t.slice(0,e)),t=t.slice(e);return n},w7=300,t3e=t=>{const e=t.split(/(?<=[\n.,])/).flatMap(r=>r.length>w7?e3e(r,Math.ceil(r.length/w7)):[r]),n=[];let i="";for(const r of e)i.length+r.length>w7&&(n.push(i),i=""),i+=r;return i.length&&n.push(i),n};class n3e{constructor(e){this.editor=e}get host(){return this.editor.host}}const i3e=`
    <html>
    <header>
    <script type='importmap'>
  {
    "imports": {
      "three": "https://unpkg.com/three@0.158.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.158.0/examples/jsm/"
    }
  }
<\/script>
</header>
    <body>
    <script  type='module'>import * as THREE from "three";
import {OrbitControls} from "three/addons/controls/OrbitControls.js";


let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(30, innerWidth / innerHeight, 1, 1000);
camera.position.set(0, 10, 10).setLength(17);
let renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

window.addEventListener("resize", event => {
  camera.aspect = innerWidth / innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
})

let controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

let gu = {
  time: {value: 0}
}

let params = {
  instanceCount: {value: 10},
  instanceLength: {value: 1.75},
  instanceGap: {value: 0.5},
  profileFactor: {value: 1.5}
}

let ig = new THREE.InstancedBufferGeometry().copy(new THREE.BoxGeometry(1, 1, 1, 100, 1, 1).translate(0.5, 0, 0));
ig.instanceCount = params.instanceCount.value;

let m = new THREE.MeshBasicMaterial({
  vertexColors: true,
  onBeforeCompile: shader => {
    shader.uniforms.time = gu.time;
    shader.uniforms.instanceCount = params.instanceCount;
    shader.uniforms.instanceLength = params.instanceLength;
    shader.uniforms.instanceGap = params.instanceGap;
    shader.uniforms.profileFactor = params.profileFactor;
    shader.vertexShader = \`
      uniform float time;
      
      uniform float instanceCount;
      uniform float instanceLength;
      uniform float instanceGap;
      
      uniform float profileFactor;
      
      varying float noGrid;
      
      mat2 rot(float a){return mat2(cos(a), sin(a), -sin(a), cos(a));}
      
      \${shader.vertexShader}
    \`.replace(
      \`#include <begin_vertex>\`,
      \`#include <begin_vertex>
      
        float t = time * 0.1;
        
        float iID = float(gl_InstanceID);
        
        float instanceTotalLength = instanceLength + instanceGap;
        float instanceFactor = instanceLength / instanceTotalLength;
        
        float circleLength = instanceTotalLength * instanceCount;
        float circleRadius = circleLength / PI2;
        
        float partAngle = PI2 / instanceCount;
        float boxAngle = partAngle * instanceFactor;

        float partTurn = PI / instanceCount;
        float boxTurn = partTurn * instanceFactor;
        
        float startAngle = t + partAngle * iID;
        float startTurn = t * 0.5 + partTurn * iID;
        
        float angleFactor = position.x;
        
        float angle = startAngle + boxAngle * angleFactor;
        float turn = startTurn + boxTurn * angleFactor;
        
        vec3 pos = vec3(0, position.y, position.z);
        pos.yz *= rot(turn);
        pos.yz *= profileFactor;
        pos.z += circleRadius;
        pos.xz *= rot(angle);
        
        transformed = pos;
        float nZ = floor(abs(normal.z) + 0.1);
        float nX = floor(abs(normal.x) + 0.1);
        noGrid = 1. - nX;
        vColor = vec3(nZ == 1. ? 0.1 : nX == 1. ? 0. : 0.01);
      \`
    );
    //console.log(shader.vertexShader);
    shader.fragmentShader = \`
      varying float noGrid;
      
      float lines(vec2 coord, float thickness){
        vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord) / thickness;
        float line = min(grid.x, grid.y);
        return 1.0 - min(line, 1.0);
      }
      \${shader.fragmentShader}
    \`.replace(
      \`#include <color_fragment>\`,
      \`#include <color_fragment>
        
        float multiply = vColor.r > 0.05 ? 3. : 2.;
        float edges = lines(vUv, 3.);
        float grid = min(noGrid, lines(vUv * multiply, 1.));
        diffuseColor.rgb = mix(diffuseColor.rgb, vec3(1), max(edges, grid));
      \`
    )
    //console.log(shader.fragmentShader)
  }
});
m.defines = {"USE_UV": ""};

let o = new THREE.Mesh(ig, m);
scene.add(o)
o.rotation.z = -Math.PI * 0.25;

let clock = new THREE.Clock();
let t = 0;

renderer.setAnimationLoop(()=>{
  let dt = clock.getDelta();
  t += dt;
  gu.time.value = t;
  controls.update();
  renderer.render(scene, camera);
})
<\/script>
</body>
</html>`,r3e=async(t,e)=>{const n=await zi.getService("make it real",T4).generateText([{role:"system",content:`You are an expert web developer who specializes in building working website prototypes from low-fidelity wireframes.
Your job is to accept low-fidelity wireframes, then create a working prototype using HTML, CSS, and JavaScript, and finally send back the results.
The results should be a single HTML file.
Use tailwind to style the website.
Put any additional CSS styles in a style tag and any JavaScript in a script tag.
Use unpkg or skypack to import any required dependencies.
Use Google fonts to pull in any open source fonts you require.
If you have any images, load them from Unsplash or use solid colored rectangles.

The wireframes may include flow charts, diagrams, labels, arrows, sticky notes, and other features that should inform your work.
If there are screenshots or images, use them to inform the colors, fonts, and layout of your website.
Use your best judgement to determine whether what you see should be part of the user interface, or else is just an annotation.

Use what you know about applications and user experience to fill in any implicit business logic in the wireframes. Flesh it out, make it real!

The user may also provide you with the html of a previous design that they want you to iterate from.
In the wireframe, the previous design's html will appear as a white rectangle.
Use their notes, together with the previous design, to inform your next result.

Sometimes it's hard for you to read the writing in the wireframes.
For this reason, all text from the wireframes will be provided to you as a list of strings, separated by newlines.
Use the provided list of text from the wireframes as a reference if any text is hard to read.

You love your designers and want them to be happy. Incorporating their feedback and notes and producing working websites makes them happy.

When sent new wireframes, respond ONLY with the contents of the html file.`},{role:"user",content:[{type:"image_url",image_url:{detail:"high",url:t}},{type:"text",text:"Here are the latest wireframes. Could you make a new website based on these wireframes and notes and send back just the html file?"},...e?[{type:"text",text:"The designs also included one of your previous result. Here's the image that you used as its source:"},{type:"image_url",image_url:{url:e.design,detail:"high"}},{type:"text",text:`And here's the HTML you came up with for it: ${e.html}`}]:[]]}]);if(!n)return;const i=n.indexOf("<!DOCTYPE html>"),r=n.indexOf("</html>");return n.slice(i,r+7)};class o3e{constructor(e){this.editor=e,this.fromFrame="",this.targets={},this.toggleAutoGen=()=>{if(this.unsub){this.unsub(),this.unsub=void 0;return}const n=Rl(this.editor.host);this.unsub=n.surfaceBlockModel.elementUpdated.on(()=>{this.createImageFromFrame().catch(console.error)}).dispose},this.makeItReal=async()=>{const n=await Pfe(this.editor.host);if(!n){alert("Please select some shapes first");return}const i=Rl(this.editor.host),{notes:r}=kr.splitElements(i.service.selection.elements),o=r.flatMap(a=>a.children.filter(l=>l instanceof dy?l.html&&l.design:!1))[0],s=await r3e(n,o);s&&i.page.addBlock(Np.schema.model.flavour,{html:s,design:n,xywh:"[0, 400, 400, 200]"},i.surface.model.id)},this.htmlBlockDemo=async()=>{const n=Rl(this.editor.host);n.page.addBlock(Np.schema.model.flavour,{html:i3e,xywh:"[0, 400, 400, 200]"},n.surface.model.id)},this.editImage=async()=>{const n=await yy(this.editor.host);if(!n){alert("Please select some shapes first");return}n.toBlob(i=>{if(i){const r=document.getElementById("copilot-panel-edit-image-prompt")?.value??"";x2e(r,n)?.then(o=>{if(!o)return;const s=wm(o,"img");Rl(this.editor.host).addImages([s]).catch(console.error)}).catch(console.error)}})},this.createImage=async()=>{const n=Rl(this.editor.host),i=document.getElementById("copilot-panel-create-image-prompt")?.value??"";if(!i){alert("Please enter some prompt first");return}const r=await zi.getService("text to image",Q0).generateImage(i);r&&await n.addImages([r])},this.createImageFromFrame=async()=>{const n=this.editor.page.getBlockById(this.fromFrame??"");if(!n)return;const r=Nd(this.editor.host).model.elementModels.filter(a=>a.type==="connector").filter(a=>a.source.id===n.id).flatMap(a=>{const l=this.editor.page.getBlockById(a.target.id??"");return l instanceof dc?[l]:[]}),o=await Mfe(n,this.editor.host);if(!o)return;const s=a=>{(async()=>{if(a){const c=o.toDataURL(),d=async u=>{const h=u.title.toString();if(!h)return;const p=h+c;let g=this.targets[u.id];if(g||(this.targets[u.id]=g={lastHash:"",request:zi.getService("real time image to image",L4).createFastRequest()}),g.lastHash===p)return;g.lastHash=p;const f=await g.request(h,c);if(!f)return;const v=Nd(this.editor.host);let m=Afe(u,this.editor.host);const y=wm(f,"img"),x=await this.editor.page.workspace.blob.set(y);m||(m=v.edgeless.service.addBlock("affine:image",{size:y.size,xywh:u.xywh},v.model)),v.edgeless.service.updateElement(m,{sourceId:x})};r.forEach(u=>{d(u).catch(console.error)})}})().catch(console.error)};o.toBlob(s)}}get autoGen(){return this.unsub!==void 0}get workspace(){return this.editor.page.workspace}get host(){return this.editor.host}}class s3e{constructor(e){this.editor=e,this.edgeless=new o3e(this.editor),this.doc=new n3e(this.editor),this.chat=new Kge(this.editor)}}var a3e=Object.defineProperty,l3e=Object.getOwnPropertyDescriptor,Fy=(t,e,n,i)=>{for(var r=i>1?void 0:i?l3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&a3e(e,n,r),r};let Fd=class extends me(De){constructor(){super(...arguments),this.config=()=>{const t=e=>()=>{const n=new Ka;n.type=e,n.onSave=i=>{zi.addVendor(i),this.requestUpdate(),n.remove()},document.body.appendChild(n)};return b`
      <div style="display:flex;flex-direction: column;gap: 32px;">
        ${Fe(cm,e=>{const n=zi.getVendorsByService(e);return b`
            <div>
              <div
                class="copilot-panel-setting-title"
                style="display:flex;justify-content:space-between;align-items:center;;color: var(--affine-text-primary-color);"
              >
                ${e.title}
                <div
                  @click="${t(e.type)}"
                  class="copilot-panel-add-vendor-button"
                >
                  ${Gge}
                </div>
              </div>
              <div style="display:flex;flex-wrap: wrap;padding: 4px;gap: 4px">
                ${Fe(n,i=>{const r=we({backgroundColor:i.impl.vendor.color});return b` <div
                    style="${r}"
                    class="copilot-panel-vendor-item"
                  >
                    ${i.vendor.name} ${i.impl.vendor.key} ${i.impl.name}
                  </div>`})}
              </div>
            </div>
          `})}
      </div>
    `},this.panels={chat:{icon:Yge,render:()=>b` <copilot-chat-panel
          .logic="${this.logic}"
        ></copilot-chat-panel>`},doc:{icon:Wge,render:()=>b` <copilot-doc-panel
          .logic="${this.logic}"
        ></copilot-doc-panel>`},edgeless:{icon:qge,render:()=>b` <copilot-edgeless-panel
          .logic="${this.logic}"
        ></copilot-edgeless-panel>`},config:{icon:Zge,render:this.config}},this.currentPanel="chat"}get logic(){return this.aiLogic||(this.aiLogic=new s3e(this.editor)),this.aiLogic}connectedCallback(){super.connectedCallback(),this.disposables.add(Nd(this.editor.host).model.childrenUpdated.on(()=>{this.requestUpdate()}))}render(){const t=this.panels[this.currentPanel];return b`
      <div
        style="display:flex;flex-direction: column;padding: 12px;height: 100%"
        class="blocksuite-overlay"
      >
        <div style="display:flex;align-items:center;justify-content:center;">
          <div
            style="display:flex;align-items:center;justify-content:center;cursor: pointer;user-select: none;width: max-content;padding: 4px; background-color: var(--affine-hover-color);border-radius: 12px;"
          >
            ${Fe(Object.keys(this.panels),e=>{const n=()=>{this.currentPanel=e},i=we({"background-color":this.currentPanel===e?"white":"transparent",padding:"4px 8px","border-radius":"8px",display:"flex",alignItems:"center"});return b` <div style="${i}" @click="${n}">
                ${this.panels[e].icon}
              </div>`})}
          </div>
        </div>
        <div style="flex:1">${t.render()}</div>
      </div>
    `}};Fd.styles=X`
    copilot-panel {
      width: 100%;
      font-family: var(--affine-font-family);
      overflow-y: scroll;
      overflow-x: visible;
    }

    .copilot-panel-setting-title {
      font-size: 14px;
      margin-top: 12px;
      margin-bottom: 4px;
      color: var(--affine-text-secondary-color);
    }

    .copilot-panel-key-input {
      width: 100%;
      border: 1px solid var(--affine-border-color, #e3e2e4);
      border-radius: 4px;
      padding: 8px;
      box-sizing: border-box;
      margin-bottom: 12px;
    }

    .copilot-panel-action-button {
      cursor: pointer;
      user-select: none;
      padding: 4px;
      background-color: var(--affine-primary-color);
      border-radius: 8px;
      color: white;
      height: 32px;
      border: 1px solid var(--affine-border-color, #e3e2e4);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 12px;
    }

    .copilot-panel-action-prompt {
      width: 100%;
      border: 1px solid var(--affine-border-color, #e3e2e4);
      border-radius: 4px;
      padding: 8px;
      box-sizing: border-box;
      margin-top: 8px;
    }

    .copilot-panel-action-description {
      font-size: 14px;
      margin-bottom: 8px;
      margin-top: 4px;
      color: var(--affine-text-secondary-color);
    }

    .copilot-panel-add-vendor-button {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      cursor: pointer;
    }

    .copilot-panel-add-vendor-button:hover {
      background-color: var(--affine-hover-color);
    }

    .copilot-panel-vendor-item {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      padding: 2px 4px;
      border-radius: 4px;
      color: white;
    }
    .copilot-box {
      margin-bottom: 64px;
    }
  `;Fy([L({attribute:!1})],Fd.prototype,"editor",2);Fy([ie()],Fd.prototype,"currentPanel",2);Fd=Fy([W("copilot-panel")],Fd);Na.registerCustomRenderer({render(){const t=document.querySelector("copilot-panel");return t?b`
      <style>
        .copilot-format-bar-item {
          padding: 4px;
          border-radius: 4px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          color: var(--affine-icon-color);
        }
        .copilot-format-bar-item:hover {
          background-color: var(--affine-hover-color);
        }
      </style>
      <div class="copilot-format-bar-item" @click="${async()=>{console.log("ask"),await t.aiLogic?.chat.selectTextForBackground()}}">
        ${Xge} Ask AI
      </div>
    `:void 0}});var c3e=Object.defineProperty,d3e=Object.getOwnPropertyDescriptor,nf=(t,e,n,i)=>{for(var r=i>1?void 0:i?d3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&c3e(e,n,r),r};const u3e=X`
  :host {
    display: block;
    box-sizing: border-box;
    padding: 8px;
    width: 220px;
  }

  .frames-setting-menu-container {
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    width: 100%;
  }

  .frames-setting-menu-item {
    display: flex;
    box-sizing: border-box;
    width: 100%;
    height: 28px;
    padding: 4px 12px;
    align-items: center;
  }

  .frames-setting-menu-item .setting-label {
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
    color: var(--affine-text-secondary-color);
    padding: 0 4px;
  }

  .frames-setting-menu-divider {
    width: 100%;
    height: 1px;
    box-sizing: border-box;
    background: var(--affine-border-color);
    margin: 8px 0;
  }

  .frames-setting-menu-item.action {
    gap: 4px;
  }

  .frames-setting-menu-item .action-label {
    width: 138px;
    height: 20px;
    padding: 0 4px;
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
    color: var(--affine-text-primary-color);
  }

  .frames-setting-menu-item .toggle-button {
    display: flex;
  }

  menu-divider {
    height: 16px;
  }
`;class Mu extends me(Ae){constructor(){super(...arguments),this.blackBackground=!1,this.fillScreen=!1,this.hideToolbar=!1,this._onBlackBackgroundChange=e=>{this.blackBackground=e,this.edgeless?.slots.navigatorSettingUpdated.emit({blackBackground:this.blackBackground})},this._onFillScreenChange=e=>{this.fillScreen=e,this.edgeless?.slots.navigatorSettingUpdated.emit({fillScreen:this.fillScreen}),this._pageService.editSession.setItem("presentFillScreen",this.fillScreen)},this._onHideToolBarChange=e=>{this.hideToolbar=e,this.edgeless?.slots.navigatorSettingUpdated.emit({hideToolbar:this.hideToolbar}),this._pageService.editSession.setItem("presentHideToolbar",this.hideToolbar)}}static{this.styles=u3e}get _pageService(){return this.editorHost.spec.getService("affine:page")}_tryRestoreSettings(){const{editSession:e}=this._pageService,n=e.getItem("presentBlackBackground");this.blackBackground=n||!0,this.fillScreen=e.getItem("presentFillScreen")??!1,this.hideToolbar=e.getItem("presentHideToolbar")??!1}connectedCallback(){super.connectedCallback(),this._tryRestoreSettings()}disconnectedCallback(){super.disconnectedCallback()}updated(e){e.has("edgeless")&&(this.edgeless?this.disposables.add(this.edgeless.slots.navigatorSettingUpdated.on(({blackBackground:n,hideToolbar:i})=>{n!==void 0&&n!==this.blackBackground&&(this.blackBackground=n),i!==void 0&&i!==this.hideToolbar&&(this.hideToolbar=i)})):this.disposables.dispose())}render(){return b`<div
      class="frames-setting-menu-container"
      @click=${e=>{e.stopPropagation()}}
    >
      <div class="frames-setting-menu-item">
        <div class="setting-label">Preview Settings</div>
      </div>
      <div class="frames-setting-menu-item action">
        <div class="action-label">Fill Screen</div>
        <div class="toggle-button">
          <toggle-switch
            .on=${this.fillScreen}
            .onChange=${this._onFillScreenChange}
          ></toggle-switch>
        </div>
      </div>

      <menu-divider></menu-divider>

      <div class="frames-setting-menu-item">
        <div class="setting-label">Playback Settings</div>
      </div>
      <div class="frames-setting-menu-item action">
        <div class="action-label">Dark background</div>
        <div class="toggle-button">
          <toggle-switch
            .on=${this.blackBackground}
            .onChange=${this._onBlackBackgroundChange}
          ></toggle-switch>
        </div>
      </div>
      <div class="frames-setting-menu-item action">
        <div class="action-label">Hide toolbar</div>
        <div class="toggle-button">
          <toggle-switch
            .on=${this.hideToolbar}
            .onChange=${this._onHideToolBarChange}
          ></toggle-switch>
        </div>
      </div>
    </div>`}}nf([L({attribute:!1})],Mu.prototype,"edgeless",2);nf([L({attribute:!1})],Mu.prototype,"editorHost",2);nf([ie()],Mu.prototype,"blackBackground",2);nf([ie()],Mu.prototype,"fillScreen",2);nf([ie()],Mu.prototype,"hideToolbar",2);var h3e=Object.defineProperty,p3e=Object.getOwnPropertyDescriptor,Pu=(t,e,n,i)=>{for(var r=i>1?void 0:i?p3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&h3e(e,n,r),r};const f3e=X`
  :host {
    display: flex;
    width: 100%;
    justify-content: start;
  }

  .frame-panel-header {
    display: flex;
    width: 100%;
    height: 36px;
    align-items: center;
    justify-content: space-between;
    box-sizing: border-box;
    padding: 0 8px;
  }

  .all-frames-setting {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100px;
    height: 24px;
    margin: 8px 4px;
  }

  .all-frames-setting-button svg {
    color: var(--affine-icon-secondary);
  }

  .all-frames-setting-button:hover svg,
  .all-frames-setting-button.active svg {
    color: var(--affine-icon-color);
  }

  .all-frames-setting-label {
    width: 68px;
    height: 22px;
    font-size: var(--affine-font-sm);
    font-weight: 500;
    line-height: 22px;
    color: var(--light-text-color-text-secondary-color, #8e8d91);
  }

  .frames-setting-container {
    display: none;
    justify-content: center;
    align-items: center;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
  }

  .frames-setting-container[data-show] {
    display: flex;
  }

  .presentation-button {
    display: flex;
    align-items: center;
    gap: 4px;
    box-sizing: border-box;
    width: 117px;
    height: 28px;
    padding: 4px 8px;
    border-radius: 8px;
    margin: 4px 0;
    border: 1px solid var(--affine-border-color);
    background: var(--affine-white);
  }

  .presentation-button:hover {
    background: var(--affine-hover-color);
    cursor: pointer;
  }

  .presentation-button svg {
    fill: var(--affine-icon-color);
    margin-right: 4px;
  }

  .presentation-button-label {
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
  }
`;class Yc extends me(Ae){constructor(){super(...arguments),this._settingPopperShow=!1,this._framesSettingMenuPopper=null,this._navigatorMode="fit",this._edgelessDisposables=null,this._enterPresentationMode=()=>{this.edgeless||this.changeEditorMode("edgeless"),this.edgeless?.updateComplete.then(()=>{this.edgeless?.tools.setEdgelessTool({type:"frameNavigator",mode:this._navigatorMode})}).catch(console.error)},this._clearEdgelessDisposables=()=>{this._edgelessDisposables?.dispose(),this._edgelessDisposables=null},this._setEdgelessDisposables=()=>{this.edgeless&&(this._clearEdgelessDisposables(),this._edgelessDisposables=new dt,this._edgelessDisposables.add(this.edgeless.slots.navigatorSettingUpdated.on(({fillScreen:e})=>{this._navigatorMode=e?"fill":"fit"})))}}static{this.styles=f3e}_tryLoadNavigatorStateLocalRecord(){this._navigatorMode=this.editorHost.spec.getService("affine:page").editSession.getItem("presentFillScreen")?"fill":"fit"}connectedCallback(){super.connectedCallback(),this._tryLoadNavigatorStateLocalRecord()}firstUpdated(){const e=this.disposables;this._framesSettingMenuPopper=Nt(this._frameSettingButton,this._frameSettingMenu,({display:n})=>{this._settingPopperShow=n==="show"},14,-120),e.add(this._framesSettingMenuPopper)}updated(e){e.has("edgeless")&&(this.edgeless?this._setEdgelessDisposables():this._clearEdgelessDisposables())}disconnectedCallback(){super.disconnectedCallback(),this._edgelessDisposables&&this._clearEdgelessDisposables()}render(){return b`<div class="frame-panel-header">
      <div class="all-frames-setting">
        <span class="all-frames-setting-label">All frames</span>
        <edgeless-tool-icon-button
          class="all-frames-setting-button ${this._settingPopperShow?"active":""}"
          .tooltip=${this._settingPopperShow?"":"All Frames Settings"}
          .tipPosition=${"top"}
          .iconContainerPadding=${2}
          .active=${this._settingPopperShow}
          .activeMode=${"background"}
          @click=${()=>this._framesSettingMenuPopper?.toggle()}
        >
          ${E$}
        </edgeless-tool-icon-button>
      </div>
      <div class="frames-setting-container">
        <frames-setting-menu
          .edgeless=${this.edgeless}
          .editorHost=${this.editorHost}
        ></frames-setting-menu>
      </div>
      <div class="presentation-button" @click=${this._enterPresentationMode}>
        ${j0e}<span class="presentation-button-label"
          >Presentation</span
        >
      </div>
    </div>`}}Pu([L({attribute:!1})],Yc.prototype,"editorHost",2);Pu([L({attribute:!1})],Yc.prototype,"edgeless",2);Pu([L({attribute:!1})],Yc.prototype,"changeEditorMode",2);Pu([ie()],Yc.prototype,"_settingPopperShow",2);Pu([he(".all-frames-setting-button")],Yc.prototype,"_frameSettingButton",2);Pu([he(".frames-setting-container")],Yc.prototype,"_frameSettingMenu",2);var g3e=Object.defineProperty,m3e=Object.getOwnPropertyDescriptor,rf=(t,e,n,i)=>{for(var r=i>1?void 0:i?m3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&g3e(e,n,r),r};const b3e=X`
  frame-card-title-editor rich-text .nowrap-lines::-webkit-scrollbar {
    display: none;
  }
`;class Xc extends me(De){constructor(){super(...arguments),this._isComposing=!1}static{this.styles=b3e}get inlineEditor(){return D(this.richText.inlineEditor),this.richText.inlineEditor}get inlineEditorContainer(){return this.inlineEditor.rootElement}async getUpdateComplete(){const e=await super.getUpdateComplete();return await this.richText?.updateComplete,e}firstUpdated(){this.updateComplete.then(()=>{this.titleContentElement.style.display="none",this.inlineEditor.selectAll(),this.inlineEditor.slots.renderComplete.on(()=>{this.requestUpdate()}),this.disposables.addFromEvent(this.inlineEditorContainer,"blur",()=>{this._unmount()}),this.disposables.addFromEvent(this.inlineEditorContainer,"click",e=>{e.stopPropagation()}),this.disposables.addFromEvent(this.inlineEditorContainer,"dblclick",e=>{e.stopPropagation()}),this.disposables.addFromEvent(this.inlineEditorContainer,"keydown",e=>{e.stopPropagation(),e.key==="Enter"&&!this._isComposing&&this._unmount()})}).catch(console.error)}_unmount(){this.disposables.dispose(),this.remove(),this.titleContentElement.style.display="block"}render(){const e=we({transformOrigin:"top left",borderRadius:"4px",maxWidth:`${this.maxWidth}px`,maxHeight:"20px",width:"fit-content",height:"20px",fontSize:"var(--affine-font-sm)",lineHeight:"20px",position:"absolute",left:`${this.left}px`,top:"0px",minWidth:"8px",background:"var(--affine-background-primary-color)",border:"1px solid var(--affine-primary-color)",color:"var(--affine-text-primary-color)",boxShadow:"0px 0px 0px 2px rgba(30, 150, 235, 0.30)",zIndex:"1",display:"block"});return b`<rich-text
      .yText=${this.frameModel.title.yText}
      .enableFormat=${!1}
      .enableAutoScrollHorizontally=${!0}
      .enableAutoScrollVertically=${!1}
      .enableUndoRedo=${!1}
      .wrapText=${!1}
      style=${e}
    ></rich-text>`}}rf([he("rich-text")],Xc.prototype,"richText",2);rf([L({attribute:!1})],Xc.prototype,"frameModel",2);rf([L({attribute:!1})],Xc.prototype,"titleContentElement",2);rf([L({attribute:!1})],Xc.prototype,"left",2);rf([L({attribute:!1})],Xc.prototype,"maxWidth",2);var v3e=Object.defineProperty,y3e=Object.getOwnPropertyDescriptor,of=(t,e,n,i)=>{for(var r=i>1?void 0:i?y3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&v3e(e,n,r),r};const w3e=X`
  .frame-card-title-container {
    display: flex;
    white-space: nowrap;
    display: flex;
    justify-content: start;
    align-items: center;
    width: 100%;
    height: 20px;
    box-sizing: border-box;
    gap: 6px;
    font-size: var(--affine-font-sm);
    cursor: default;
    position: relative;
  }

  .frame-card-title-container .card-index {
    display: flex;
    align-self: center;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    box-sizing: border-box;
    border-radius: 2px;
    background: var(--affine-black);
    margin-left: 2px;

    color: var(--affine-white);
    text-align: center;
    font-weight: 500;
    line-height: 18px;
  }

  .frame-card-title-container .card-title {
    height: 20px;
    color: var(--affine-text-primary-color);
    font-weight: 400;
    line-height: 20px;

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
  }
`;class Au extends me(De){constructor(){super(...arguments),this._titleDisposables=null,this._updateElement=()=>{this.requestUpdate()},this._mountTitleEditor=e=>{e.stopPropagation();const n=new Xc;n.frameModel=this.frame,n.titleContentElement=this.titleContentElement;const i=this.titleIndexElement.offsetWidth+6;n.left=i,n.maxWidth=this.titleContainer.offsetWidth-i-6,this.titleContainer.appendChild(n)},this._clearTitleDisposables=()=>{this._titleDisposables?.dispose(),this._titleDisposables=null}}static{this.styles=w3e}_setFrameDisposables(e){this._clearTitleDisposables(),e.observe(this._updateElement),this._titleDisposables=new dt,this._titleDisposables.add({dispose:()=>{e.unobserve(this._updateElement)}})}updated(e){e.has("frame")&&this._setFrameDisposables(this.frame.title.yText)}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._clearTitleDisposables()}render(){return b`<div class="frame-card-title-container">
      <div
        class="card-index"
        @click=${e=>e.stopPropagation()}
        @dblclick=${e=>e.stopPropagation()}
      >
        ${this.cardIndex+1}
      </div>
      <div class="card-title">
        <span
          @click=${e=>e.stopPropagation()}
          @dblclick=${this._mountTitleEditor}
          >${this.frame.title}</span
        >
      </div>
    </div>`}}of([L({attribute:!1})],Au.prototype,"frame",2);of([L({attribute:!1})],Au.prototype,"cardIndex",2);of([he(".frame-card-title-container")],Au.prototype,"titleContainer",2);of([he(".frame-card-title-container .card-index")],Au.prototype,"titleIndexElement",2);of([he(".frame-card-title-container .card-title")],Au.prototype,"titleContentElement",2);var x3e=Object.defineProperty,_3e=Object.getOwnPropertyDescriptor,$r=(t,e,n,i)=>{for(var r=i>1?void 0:i?_3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&x3e(e,n,r),r};const C3e=X`
  :host {
    display: block;
  }

  .frame-card-container {
    display: flex;
    flex-direction: column;
    width: 284px;
    height: 198px;
    gap: 8px;

    position: relative;
  }

  .frame-card-body {
    display: flex;
    width: 100%;
    height: 170px;
    box-sizing: border-box;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    border: 1px solid var(--affine-border-color);
    background: var(--affine-background-primary-color);
    box-shadow: 0px 0px 12px 0px rgba(66, 65, 73, 0.18);
    cursor: pointer;
    position: relative;
  }

  .frame-card-container.selected .frame-card-body {
    border: 2px solid var(--light-brand-color, #1e96eb);
  }

  .frame-card-container.dragging {
    pointer-events: none;
    transform-origin: 16px 8px;
    position: fixed;
    top: 0;
    left: 0;
    z-index: calc(var(--affine-z-index-popover, 0) + 3);
  }

  .frame-card-container.dragging frame-card-title {
    display: none;
  }

  .frame-card-container.dragging .dragging-card-number {
    position: absolute;
    bottom: 0;
    left: 0;
    transform: translate(-30%, 30%);

    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--affine-black);
    color: var(--affine-white);
    font-size: 15px;
    line-height: 24px;
    text-align: center;
    font-weight: 400;
  }

  .frame-card-container.placeholder {
    opacity: 0.5;
  }
`;class Gi extends me(De){constructor(){super(...arguments),this.edgeless=null,this.status="none",this._frameDisposables=null,this._updateElement=()=>{this.requestUpdate()},this._clearFrameDisposables=()=>{this._frameDisposables?.dispose(),this._frameDisposables=null}}static{this.styles=C3e}_dispatchSelectEvent(e){e.stopPropagation();const n=new CustomEvent("select",{detail:{id:this.frame.id,selected:this.status!=="selected",index:this.cardIndex,multiselect:e.shiftKey}});this.dispatchEvent(n)}_dispatchFitViewEvent(e){e.stopPropagation();const n=new CustomEvent("fitview",{detail:{block:this.frame}});this.dispatchEvent(n)}_dispatchDragEvent(e){if(e.preventDefault(),e.button!==0)return;const{clientX:n,clientY:i}=e,r=jd(this.ownerDocument,"mousemove",o=>{if(Math.abs(n-o.clientX)<5&&Math.abs(i-o.clientY)<5)return;this.status!=="selected"&&this._dispatchSelectEvent(o);const s=new CustomEvent("drag",{detail:{clientX:o.clientX,clientY:o.clientY,pageX:o.pageX,pageY:o.pageY}});this.dispatchEvent(s),r()});Gd(this.ownerDocument,"mouseup",()=>{r()})}_DraggingCardNumber(){return this.draggingCardNumber===void 0?ae:b`<div class="dragging-card-number">
      ${this.draggingCardNumber}
    </div>`}_setFrameDisposables(e){this._clearFrameDisposables(),this._frameDisposables=new dt,this._frameDisposables.add(e.propsUpdated.on(this._updateElement))}updated(e){e.has("frame")&&this._setFrameDisposables(this.frame)}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._clearFrameDisposables()}render(){const{pos:e,stackOrder:n,width:i}=this,r=this.status==="dragging"?we({transform:`${n===0?`translate(${e.x-16}px, ${e.y-8}px)`:`translate(${e.x-10}px, ${e.y-16}px) scale(0.96)`}`,width:i?`${i}px`:void 0}):{};return b`<div
      class="frame-card-container ${this.status??""}"
      style=${r}
    >
      ${this.status==="dragging"?ae:b`<frame-card-title
            .cardIndex=${this.cardIndex}
            .frame=${this.frame}
          ></frame-card-title>`}
      <div
        class="frame-card-body"
        @click=${this._dispatchSelectEvent}
        @dblclick=${this._dispatchFitViewEvent}
        @mousedown=${this._dispatchDragEvent}
      >
        ${this.status==="dragging"&&n!==0?ae:b`<frame-preview
              .edgeless=${this.edgeless}
              .host=${this.host}
              .page=${this.page}
              .frame=${this.frame}
            ></frame-preview>`}
        ${this._DraggingCardNumber()}
      </div>
    </div>`}}$r([L({attribute:!1})],Gi.prototype,"edgeless",2);$r([L({attribute:!1})],Gi.prototype,"frame",2);$r([L({attribute:!1})],Gi.prototype,"page",2);$r([L({attribute:!1})],Gi.prototype,"host",2);$r([L({attribute:!1})],Gi.prototype,"cardIndex",2);$r([L({attribute:!1})],Gi.prototype,"frameIndex",2);$r([L({attribute:!1})],Gi.prototype,"status",2);$r([L({attribute:!1})],Gi.prototype,"stackOrder",2);$r([L({attribute:!1})],Gi.prototype,"pos",2);$r([L({attribute:!1})],Gi.prototype,"width",2);$r([L({attribute:!1})],Gi.prototype,"draggingCardNumber",2);$r([he(".frame-card-container")],Gi.prototype,"containerElement",2);function k3e(t,e){const{doc:n,domHost:i,container:r,onDragMove:o,onDragEnd:s,frameElementHeight:a,framePanelBody:l,frameListContainer:c,start:d,edgeless:u,page:h,editorHost:p}=e,g=t.slice(t.length-2,t.length).map((E,R,I)=>{const N=new Gi;return N.edgeless=u,N.page=h,N.host=p,N.frame=E.frame,N.cardIndex=E.cardIndex,N.frameIndex=E.frameIndex,N.status="dragging",N.stackOrder=I.length-1-R,N.pos=d,N.width=e.width,t.length>1&&N.stackOrder===0&&(N.draggingCardNumber=t.length),N}),f=E3e(n),v=l.getBoundingClientRect(),m=Array.from(c.children),y=getComputedStyle(c),x=parseInt(y.getPropertyValue("gap"))??16;let T,M;r.renderRoot.appendChild(f),r.renderRoot.append(...g);const k=E=>E.clientX>=v.left&&E.clientX<=v.right&&E.clientY>=v.top&&E.clientY<=v.bottom,_=jd(r,"mousemove",E=>{if(g.forEach(R=>{R.pos={x:E.clientX,y:E.clientY}}),!k(E)){T=void 0,o?.(T,0);return}T=0;for(const R of m){if(!R.frame)break;const I=v.top+R.offsetTop-l.scrollTop-x/2,N=I+R.offsetHeight/2,P=I+R.offsetHeight+x;if(E.clientY>=I&&E.clientY<=P){T=E.clientY>N?T+1:T,M=T*(a+x)-x/2,o?.(T,M);return}++T}o?.(T)});let A=!1;Gd(i,"mouseup",()=>{A||(A=!0,g.forEach(E=>r.renderRoot.removeChild(E)),r.renderRoot.removeChild(f),_(),s?.(T))})}function E3e(t){const e=t.createElement("div");return e.style.height="100vh",e.style.width="100vw",e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.zIndex="calc(var(--affine-z-index-popover, 0) + 3)",e.style.cursor="grabbing",e}var S3e=Object.defineProperty,T3e=Object.getOwnPropertyDescriptor,ns=(t,e,n,i)=>{for(var r=i>1?void 0:i?T3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&S3e(e,n,r),r};const I3e=X`
  .frame-list-container {
    display: flex;
    align-items: start;
    box-sizing: border-box;
    flex-direction: column;
    width: 100%;
    gap: 16px;
    position: relative;
    margin: 0 8px;
  }

  .no-frame-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    min-width: 300px;
  }

  .no-frame-placeholder {
    margin-top: 240px;
    align-self: center;
    width: 230px;
    height: 48px;
    color: var(--affine-text-secondary-color, #8e8d91);
    text-align: center;

    /* light/base */
    font-size: 15px;
    font-style: normal;
    font-weight: 400;
    line-height: 24px;
  }

  .insert-indicator {
    height: 2px;
    border-radius: 1px;
    background-color: var(--affine-blue-600);
    position: absolute;
    contain: layout size;
    width: 284px;
    left: 0;
  }
`;class uo extends me(De){constructor(){super(...arguments),this.edgeless=null,this._selected=[],this._dragging=!1,this._frameItems=[],this._frameElementHeight=0,this._indicatorTranslateY=0,this._pageDisposables=null,this._lastEdgelessPageId="",this._clearPageDisposables=()=>{this._pageDisposables?.dispose(),this._pageDisposables=null},this._selectFrame=e=>{const{selected:n,id:i,multiselect:r}=e.detail;n?r?this._selected=[...this._selected,i]:this._selected=[i]:this._selected=this._selected.filter(o=>o!==i),this.edgeless?.service.selection.set({elements:this._selected,editing:!1})},this._clickBlank=e=>{e.stopPropagation(),!(e.target.closest("frame-card")||this._selected.length===0)&&(this._selected=[],this.edgeless?.service.selection.set({elements:this._selected,editing:!1}))},this._updateFrameItems=()=>{this._frameItems=this.frames.map((e,n)=>({frame:e,frameIndex:e.index,cardIndex:n}))}}static{this.styles=I3e}get frames(){return this.page.getBlockByFlavour("affine:frame").sort(this.compare)}get viewportPadding(){return this.fitPadding?[0,0,0,0].map((e,n)=>Number.isFinite(this.fitPadding[n])?this.fitPadding[n]:e):[0,0,0,0]}compare(e,n){return e.index<n.index?-1:e.index>n.index?1:0}_setPageDisposables(e){this._clearPageDisposables(),this._pageDisposables=new dt,this._pageDisposables.add(e.slots.blockUpdated.on(({flavour:n})=>{n==="affine:frame"&&requestAnimationFrame(()=>{this._updateFrames()})}))}_updateFrames(){if(this._dragging)return;if(!this.frames.length){this._selected=[],this._frameItems=[];return}const e=[],n=new Set(this._selected),i=[];this.frames.sort(this.compare).forEach((o,s)=>{const a={frame:o,frameIndex:o.index,cardIndex:s};e.push(a),n.has(o.id)&&i.push(o.id)}),this._frameItems=e,this._selected=i,this.requestUpdate()}_reorderFrames(e,n,i){if(i>=0&&i<=this._frameItems.length){const r=Array.from(n.values()).map(l=>l.frame),o=e.map(l=>n.get(l)).map(l=>l.frame).sort(this.compare);let s=r[i-1]?.index||null;const a=r[i]?.index||null;o.forEach(l=>{const c=ds(s,a);l.page.updateBlock(l,{index:c}),s=c}),this.page.captureSync(),this._updateFrames()}}_fitToElement(e){const{block:n}=e.detail,i=ne.deserialize(n.xywh);if(this.edgeless)this.edgeless.service.viewport.setViewportByBound(i,this.viewportPadding,!0);else{const r={xywh:n.xywh,referenceId:n.id,padding:this.viewportPadding};this.editorHost.spec.getService("affine:page").editSession.setItem("viewport",r),this.changeEditorMode("edgeless")}}_drag(e){if(!this._selected.length)return;this._dragging=!0;const n=this._frameItems.reduce((s,a)=>(s.set(a.frame.id,{...a}),s),new Map),i=this._selected.slice(),r=i.map(s=>{const a=n.get(s);return{frame:a.frame,element:this.renderRoot.querySelector(`[data-frame-id="${a.frame.id}"]`),cardIndex:a.cardIndex,frameIndex:a.frameIndex}}),o=r[0].element.clientWidth;this._frameElementHeight=r[0].element.offsetHeight,k3e(r,{width:o,container:this,doc:this.ownerDocument,domHost:this.domHost??this.ownerDocument,start:{x:e.detail.clientX,y:e.detail.clientY},framePanelBody:this,frameListContainer:this.frameListContainer,frameElementHeight:this._frameElementHeight,edgeless:this.edgeless,page:this.page,editorHost:this.editorHost,onDragEnd:s=>{this._dragging=!1,this.insertIndex=void 0,s!==void 0&&this._reorderFrames(i,n,s)},onDragMove:(s,a)=>{this.insertIndex=s,this._indicatorTranslateY=a??0}})}_renderEmptyContent(){return b` <div class="no-frame-container">
      <div class="no-frame-placeholder">
        Add frames to organize and present your Edgeless
      </div>
    </div>`}_renderFrameList(){const e=new Set(this._selected),n=this._frameItems.map((r,o)=>b`<frame-card
          data-frame-id=${r.frame.id}
          .edgeless=${this.edgeless}
          .page=${this.page}
          .host=${this.editorHost}
          .frame=${r.frame}
          .cardIndex=${o}
          .frameIndex=${r.frameIndex}
          .status=${e.has(r.frame.id)?this._dragging?"placeholder":"selected":"none"}
          @select=${this._selectFrame}
          @fitview=${this._fitToElement}
          @drag=${this._drag}
        ></frame-card>`);return b` <div class="frame-list-container">
      ${this.insertIndex!==void 0?b`<div
            class="insert-indicator"
            style=${`transform: translateY(${this._indicatorTranslateY}px)`}
          ></div>`:ae}
      ${n}
    </div>`}firstUpdated(){this.disposables.addFromEvent(this,"click",this._clickBlank)}updated(e){(e.has("page")||e.has("edgeless"))&&this._setPageDisposables(this.page),e.has("edgeless")&&this.edgeless&&(this.edgeless.model.id===this._lastEdgelessPageId?this.edgeless.service.selection.set({elements:this._selected,editing:!1}):this._selected=[],this._lastEdgelessPageId=this.edgeless.model.id)}connectedCallback(){super.connectedCallback(),this._updateFrameItems(),this.edgeless&&(this._lastEdgelessPageId=this.edgeless.model.id)}disconnectedCallback(){super.disconnectedCallback(),this._clearPageDisposables()}render(){return this._updateFrameItems(),b` ${this._frameItems.length?this._renderFrameList():this._renderEmptyContent()}`}}ns([L({attribute:!1})],uo.prototype,"edgeless",2);ns([L({attribute:!1})],uo.prototype,"page",2);ns([L({attribute:!1})],uo.prototype,"editorHost",2);ns([L({attribute:!1})],uo.prototype,"changeEditorMode",2);ns([ie()],uo.prototype,"_selected",2);ns([ie()],uo.prototype,"_dragging",2);ns([L({attribute:!1})],uo.prototype,"insertIndex",2);ns([L({attribute:!1})],uo.prototype,"fitPadding",2);ns([L({attribute:!1})],uo.prototype,"domHost",2);ns([he(".frame-list-container")],uo.prototype,"frameListContainer",2);var L3e=Object.defineProperty,M3e=Object.getOwnPropertyDescriptor,AB=(t,e,n,i)=>{for(var r=i>1?void 0:i?M3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&L3e(e,n,r),r};const P3e=X`
  frame-panel {
    display: block;
    width: 100%;
    height: 100%;
  }

  .frame-panel-container {
    background-color: var(--affine-background-primary-color);
    box-sizing: border-box;

    display: flex;
    flex-direction: column;
    align-items: stretch;

    height: 100%;
    font-family: ${Je(vt.fontSansFamily)};
    padding: 8px;
  }

  .frame-panel-body {
    padding-top: 12px;
    flex-grow: 1;
    width: 100%;

    overflow: auto;
    overflow-x: hidden;
    scrollbar-width: thin; /* For Firefox */
    scrollbar-color: transparent transparent; /* For Firefox */
  }

  .frame-panel-body::-webkit-scrollbar {
    width: 4px;
  }

  .frame-panel-body::-webkit-scrollbar-thumb {
    border-radius: 2px;
  }

  .frame-panel-body:hover::-webkit-scrollbar-thumb {
    background-color: var(--affine-black-30);
  }

  .frame-panel-body::-webkit-scrollbar-track {
    background-color: transparent;
  }

  .frame-panel-body::-webkit-scrollbar-corner {
    display: none;
  }
`;class O4 extends me(De){constructor(){super(...arguments),this.fitPadding=[50,380,50,50],this._changeEditorMode=e=>{this.editor.mode=e},this._editorDisposables=null}static{this.styles=P3e}get page(){return this.editor.page}get host(){return this.editor.host}get edgeless(){return this.editor.querySelector("affine-edgeless-page")}_clearEditorDisposables(){this._editorDisposables?.dispose(),this._editorDisposables=null}_setEditorDisposables(){this._clearEditorDisposables(),this._editorDisposables=new dt,this._editorDisposables.add(this.editor.slots.pageModeSwitched.on(()=>{this.editor.updateComplete.then(()=>this.requestUpdate()).catch(console.error)})),this._editorDisposables.add(this.editor.slots.pageUpdated.on(()=>{this.editor.updateComplete.then(()=>{this.requestUpdate()}).catch(console.error)}))}updated(e){e.has("editor")&&this._setEditorDisposables()}connectedCallback(){super.connectedCallback(),customElements.get("frame-preview")||customElements.define("frame-preview",yi)}disconnectedCallback(){super.disconnectedCallback(),this._clearEditorDisposables()}render(){return b`<div class="frame-panel-container">
      <frame-panel-header
        .edgeless=${this.edgeless}
        .changeEditorMode=${this._changeEditorMode}
        .editorHost=${this.host}
      ></frame-panel-header>
      <frame-panel-body
        class="frame-panel-body"
        .edgeless=${this.edgeless}
        .page=${this.page}
        .editorHost=${this.host}
        .changeEditorMode=${this._changeEditorMode}
        .fitPadding=${this.fitPadding}
      ></frame-panel-body>
    </div>`}}AB([L({attribute:!1})],O4.prototype,"editor",2);AB([L({attribute:!1})],O4.prototype,"fitPadding",2);const A3e={"frame-panel":O4,"frame-panel-header":Yc,"frame-panel-body":uo,"frames-setting-menu":Mu,"frame-card":Gi,"frame-card-title":Au,"frame-card-title-editor":Xc};function $3e(t){t(A3e)}var B3e=Object.defineProperty,D3e=Object.getOwnPropertyDescriptor,Uy=(t,e,n,i)=>{for(var r=i>1?void 0:i?D3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&B3e(e,n,r),r};const O3e=X`
  :host {
    width: 100%;
    box-sizing: border-box;
    position: absolute;
    left: 0;
    bottom: 8px;
    padding: 0 8px;
  }
  .outline-notice-container {
    display: flex;
    width: 100%;
    box-sizing: border-box;
    gap: 14px;
    padding: 10px;
    font-style: normal;
    font-size: 12px;
    flex-direction: column;
    border-radius: 8px;
    background-color: var(--affine-background-overlay-panel-color);
  }
  .outline-notice-header {
    display: flex;
    width: 100%;
    height: 20px;
    align-items: center;
    justify-content: space-between;
  }
  .outline-notice-label {
    font-weight: 600;
    line-height: 20px;
    color: var(--affine-text-secondary-color);
  }
  .outline-notice-close-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    cursor: pointer;
    color: var(--affine-icon-color);
  }
  .outline-notice-body {
    display: flex;
    width: 100%;
    gap: 2px;
    flex-direction: column;
  }
  .outline-notice-item {
    display: flex;
    height: 20px;
    align-items: center;
    line-height: 20px;
    color: var(--affine-text-primary-color);
  }
  .outline-notice-item.notice {
    font-weight: 400;
  }
  .outline-notice-item.button {
    display: flex;
    gap: 2px;
    font-weight: 500;
    text-decoration: underline;
    cursor: pointer;
  }
  .outline-notice-item.button span {
    display: flex;
    align-items: center;
    line-height: 20px;
  }
  .outline-notice-item.button svg {
    scale: 0.8;
  }
`;class R4 extends me(Ae){static{this.styles=O3e}_handleNoticeButtonClick(){this.toggleNotesSorting(),this.setNoticeVisibility(!1)}render(){return this.noticeVisible?b`<div class="outline-notice-container">
      <div class="outline-notice-header">
        <span class="outline-notice-label">SOME CONTENTS HIDDEN</span>
        <span
          class="outline-notice-close-button"
          @click=${()=>this.setNoticeVisibility(!1)}
          >${pfe}</span
        >
      </div>
      <div class="outline-notice-body">
        <div class="outline-notice-item notice">
          Some contents are not visible on edgeless.
        </div>
        <div
          class="outline-notice-item button"
          @click=${this._handleNoticeButtonClick}
        >
          <span>Click here or</span>
          <span>${S$}</span>
          <span>to organize content.</span>
        </div>
      </div>
    </div>`:ae}}Uy([L({attribute:!1})],R4.prototype,"noticeVisible",2);Uy([L({attribute:!1})],R4.prototype,"toggleNotesSorting",2);Uy([L({attribute:!1})],R4.prototype,"setNoticeVisibility",2);const R3e={quote:efe,text:Z0e,h1:W0e,h2:q0e,h3:Y0e,h4:X0e,h5:K0e,h6:Q0e},a1={...R3e,code:J0e,numbered:tfe,bulleted:nfe,todo:ife,toggle:G0e,bookmark:rfe,image:ofe,table:sfe,kanban:afe,attachment:lfe},$B={quote:"Quote",text:"Text Block",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},th={code:"Code Block",bulleted:"Bulleted List",numbered:"Numbered List",toggle:"Toggle List",todo:"Todo",bookmark:"Bookmark",image:"Image",database:"Database",attachment:"Attachment",...$B},BB=new Set(Object.keys($B).filter(t=>t.startsWith("h")));var N3e=Object.defineProperty,H3e=Object.getOwnPropertyDescriptor,sf=(t,e,n,i)=>{for(var r=i>1?void 0:i?H3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&N3e(e,n,r),r};const F3e=X`
  :host {
    display: block;
    width: 100%;
  }

  .outline-block-preview {
    width: 100%;
    box-sizing: border-box;
    padding: 6px 8px;
    white-space: nowrap;
    display: flex;
    justify-content: start;
    align-items: center;
    gap: 8px;
  }

  .icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    box-sizing: border-box;
    padding: 4px;
    background: var(--affine-background-secondary-color);
    border-radius: 4px;
    color: var(--affine-icon-color);
  }

  .icon.disabled {
    color: var(--affine-disabled-icon-color);
  }

  .text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;

    font-size: var(--affine-font-sm);
    line-height: 24px;
    height: 24px;
  }

  .text.general,
  .subtype.text,
  .subtype.quote {
    font-weight: 400;
    padding-left: 28px;
  }

  .subtype.h1,
  .subtype.h2,
  .subtype.h3,
  .subtype.h4,
  .subtype.h5,
  .subtype.h6 {
    font-weight: 600;
  }

  .subtype.h1 {
    padding-left: 0;
  }
  .subtype.h2 {
    padding-left: 4px;
  }
  .subtype.h3 {
    padding-left: 12px;
  }
  .subtype.h4 {
    padding-left: 16px;
  }
  .subtype.h5 {
    padding-left: 20px;
  }
  .subtype.h6 {
    padding-left: 24px;
  }

  .outline-block-preview:not(:has(span)) {
    display: none;
  }

  .text span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .linked-doc-preview svg {
    width: 1.1em;
    height: 1.1em;
    vertical-align: middle;
    font-size: inherit;
    margin-bottom: 0.1em;
  }

  .linked-doc-text {
    font-size: inherit;
    border-bottom: 0.5px solid var(--affine-divider-color);
    white-space: break-spaces;
    margin-right: 2px;
  }

  .linked-doc-preview.unavailable svg {
    color: var(--affine-text-disable-color);
  }

  .linked-doc-preview.unavailable .linked-doc-text {
    color: var(--affine-text-disable-color);
    text-decoration: line-through;
  }
`;class $u extends me(Ae){constructor(){super(...arguments),this.disabledIcon=!1,this._textDisposables=null,this._clearTextDisposables=()=>{this._textDisposables?.dispose(),this._textDisposables=null},this._setTextDisposables=e=>{this._clearTextDisposables(),this._textDisposables=new dt,e.text?.yText.observe(this._updateElement),this._textDisposables.add({dispose:()=>e.text?.yText.unobserve(this._updateElement)}),this._textDisposables.add(this.block.propsUpdated.on(this._updateElement))},this._updateElement=()=>{this.requestUpdate()}}static{this.styles=F3e}_TextBlockPreview(e){const n=e.text.yText.toDelta();if(!n?.length)return ae;const i=this.disabledIcon?"icon disabled":"icon",r=n.map(o=>{if(o.attributes?.reference){const s=o.attributes.reference,a=e.page.workspace.meta.pageMetas.find(d=>d.id===s.pageId),l=!a,c=l?"Deleted page":a.title;return b`<span
          class="linked-doc-preview ${l?"unavailable":""}"
          >${k2}
          <span class="linked-doc-text"
            >${c.length?c:"Untitled"}</span
          ></span
        >`}else return o.insert.toString().trim().length>0?b`<span>${o.insert.toString()}</span>`:ae});return b`<span class="text subtype ${e.type}">${r}</span>
      ${this.showPreviewIcon?b`<span class=${i}>${a1[e.type]}</span>`:ae}`}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._clearTextDisposables()}updated(){this.updateComplete.then(()=>{kr.matchFlavours(this.block,["affine:paragraph","affine:list"])&&this._setTextDisposables(this.block)}).catch(console.error)}renderBlockByFlavour(){const{block:e}=this,n=this.disabledIcon?"icon disabled":"icon",i=kr.matchFlavours(e,["affine:paragraph"])&&BB.has(e.type);if(!this.enableNotesSorting&&!i)return ae;switch(e.flavour){case"affine:paragraph":return this._TextBlockPreview(e);case"affine:list":return this._TextBlockPreview(e);case"affine:bookmark":return b`
          <span class="text general"
            >${e.title||e.url||th.bookmark}</span
          >
          ${this.showPreviewIcon?b`<span class=${n}
                >${a1.bookmark}</span
              >`:ae}
        `;case"affine:code":return b`
          <span class="text general"
            >${e.language??th.code}</span
          >
          ${this.showPreviewIcon?b`<span class=${n}>${a1.code}</span>`:ae}
        `;case"affine:database":return b`
          <span class="text general"
            >${e.title.toString().length?e.title.toString():th.database}</span
          >
          ${this.showPreviewIcon?b`<span class=${n}>${a1.table}</span>`:ae}
        `;case"affine:image":return b`
          <span class="text general"
            >${e.caption?.length?e.caption:th.image}</span
          >
          ${this.showPreviewIcon?b`<span class=${n}>${a1.image}</span>`:ae}
        `;case"affine:attachment":return b`
          <span class="text general"
            >${e.name?.length?e.name:th.attachment}</span
          >
          ${this.showPreviewIcon?b`<span class=${n}
                >${a1.attachment}</span
              >`:ae}
        `;default:return ae}}render(){return b`<div class="outline-block-preview">
      ${this.renderBlockByFlavour()}
    </div>`}}sf([L({attribute:!1})],$u.prototype,"block",2);sf([L({attribute:!1})],$u.prototype,"showPreviewIcon",2);sf([L({attribute:!1})],$u.prototype,"enableNotesSorting",2);sf([L({attribute:!1})],$u.prototype,"disabledIcon",2);sf([L({attribute:!1})],$u.prototype,"cardNumber",2);var U3e=Object.defineProperty,V3e=Object.getOwnPropertyDescriptor,Br=(t,e,n,i)=>{for(var r=i>1?void 0:i?V3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&U3e(e,n,r),r};const z3e=X`
  :host {
    display: block;
    position: relative;
  }

  .card-container {
    position: relative;

    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
  }

  .card-preview {
    position: relative;

    width: 100%;

    border-radius: 4px;
    background-color: var(--affine-background-primary-color);

    cursor: default;
    user-select: none;
  }

  .card-preview.edgeless:hover {
    background: var(--affine-hover-color);
  }

  .card-header-container {
    padding: 0 8px;
    width: 100%;
    min-height: 28px;
    display: none;
    align-items: center;
    gap: 8px;
    box-sizing: border-box;
  }

  .card-header-container.enable-sorting {
    display: flex;
  }

  .card-header-container .card-number {
    text-align: center;
    font-size: var(--affine-font-sm);
    font-family: ${Je(vt.fontSansFamily)};
    color: var(--affine-brand-color, #1e96eb);
    font-weight: 500;
    line-height: 14px;
    line-height: 20px;
  }

  .card-header-container .card-header-icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .card-header-container .card-divider {
    height: 1px;
    flex: 1;
    border-top: 1px dashed var(--affine-border-color);
    transform: translateY(50%);
  }

  .display-mode-button-group {
    display: none;
    align-items: center;
    gap: 4px;
    padding: 2px;
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
    position: relative;
  }

  .card-preview:hover .display-mode-button-group {
    display: flex;
  }

  .display-mode-button-label {
    color: var(--affine-text-primary-color);
  }

  .display-mode-button {
    display: flex;
    border-radius: 4px;
    background-color: var(--affine-hover-color);
    align-items: center;
  }

  .current-mode-label {
    display: flex;
    padding: 2px 0px 2px 4px;
    align-items: center;
  }

  note-display-mode-panel {
    position: absolute;
    display: none;
  }

  note-display-mode-panel[data-show] {
    display: flex;
  }

  .card-content {
    font-family: ${Je(vt.fontSansFamily)};
    user-select: none;
    color: var(--affine-text-primary-color);
  }

  .card-preview.edgeless .card-content:hover {
    cursor: pointer;
  }

  .card-preview.edgeless .card-header-container:hover {
    cursor: grab;
  }

  .card-container.placeholder {
    pointer-events: none;
    opacity: 0.5;
  }

  .card-container.selected .card-preview.edgeless {
    background: var(--affine-hover-color);
  }

  .card-container.placeholder .card-preview.edgeless {
    background: var(--affine-hover-color);
    opacity: 0.9;
  }

  .card-container[data-sortable='true'] {
    padding: 2px 0;
  }

  .card-container[data-invisible='true'] .card-header-container .card-number,
  .card-container[data-invisible='true']
    .card-header-container
    .card-header-icon,
  .card-container[data-invisible='true'] .card-preview .card-content {
    color: var(--affine-text-disable-color);
    pointer-events: none;
  }

  .card-preview.page outline-block-preview:hover {
    color: var(--affine-brand-color);
  }
`;class ur extends me(Ae){constructor(){super(...arguments),this.editorMode="page",this.invisible=!1,this._showPopper=!1,this._displayModePopper=null,this._noteDisposables=null,this._clearNoteDisposables=()=>{this._noteDisposables?.dispose(),this._noteDisposables=null}}static{this.styles=z3e}connectedCallback(){super.connectedCallback();const e=new MutationObserver(()=>this.requestUpdate());e.observe(this.ownerDocument.documentElement,{subtree:!1,childList:!1,attributes:!0,attributeFilter:["data-theme"]}),this._disposables.add(()=>e.disconnect())}disconnectedCallback(){super.disconnectedCallback(),this._clearNoteDisposables()}_setNoteDisposables(){this._clearNoteDisposables(),this._noteDisposables=new dt,this._noteDisposables.add(this.note.childrenUpdated.on(()=>{this.requestUpdate()})),this._noteDisposables.add(this.note.propsUpdated.on(()=>this.requestUpdate()))}_getCurrentModeLabel(e){switch(e){case qe.DocAndEdgeless:return"Both";case qe.EdgelessOnly:return"Edgeless";case qe.DocOnly:return"Page";default:return"Both"}}updated(e){(e.has("note")||e.has("index"))&&this._setNoteDisposables()}firstUpdated(){this._displayModePopper=Nt(this._displayModeButtonGroup,this._displayModePanel,({display:e})=>{this._showPopper=e==="show"},-144,-60),this.disposables.add(this._displayModePopper)}_dispatchSelectEvent(e){e.stopPropagation();const n=new CustomEvent("select",{detail:{id:this.note.id,selected:this.status!=="selected",number:this.number,multiselect:e.shiftKey}});this.dispatchEvent(n)}_dispatchDragEvent(e){if(e.preventDefault(),e.button!==0||this.editorMode==="page"||!this.enableNotesSorting)return;const{clientX:n,clientY:i}=e,r=jd(this.ownerDocument,"mousemove",o=>{if(Math.abs(n-o.clientX)<5&&Math.abs(i-o.clientY)<5)return;this.status!=="selected"&&this._dispatchSelectEvent(o);const s=new CustomEvent("drag");this.dispatchEvent(s),r()});Gd(this.ownerDocument,"mouseup",()=>{r()})}_dispatchFitViewEvent(e){e.stopPropagation();const n=new CustomEvent("fitview",{detail:{block:this.note}});this.dispatchEvent(n)}_buildBlockPath(e){return[this.note.id,e.id]}_dispatchClickBlockEvent(e){const n=new CustomEvent("clickblock",{detail:{blockPath:this._buildBlockPath(e)}});this.dispatchEvent(n)}_dispatchDisplayModeChangeEvent(e,n){const i=new CustomEvent("displaymodechange",{detail:{note:e,newMode:n}});this.dispatchEvent(i)}render(){if(this.note.isEmpty())return ae;const e=Wo(),{children:n,displayMode:i}=this.note,r=this._getCurrentModeLabel(i),o=Qe({"card-header-container":!0,"enable-sorting":this.enableNotesSorting});return b`
      <div
        data-invisible="${this.invisible?"true":"false"}"
        data-sortable="${this.enableNotesSorting?"true":"false"}"
        class="card-container ${this.status??""} ${e}"
      >
        <div
          class="card-preview ${this.editorMode}"
          @mousedown=${this._dispatchDragEvent}
          @click=${this._dispatchSelectEvent}
          @dblclick=${this._dispatchFitViewEvent}
        >
        ${b`<div class=${o}>
          ${this.invisible?b`<span class="card-header-icon">${ufe}</span>`:b`<span class="card-number">${this.number}</span>`}
          <span class="card-divider"></span>
          <div class="display-mode-button-group">
            <span class="display-mode-button-label">Show in</span>
            <edgeless-tool-icon-button
              .tooltip=${this._showPopper?"":"Display Mode"}
              .tipPosition=${"left-start"}
              .iconContainerPadding=${0}
              @click=${s=>{s.stopPropagation(),this._displayModePopper?.toggle()}}
              @dblclick=${s=>s.stopPropagation()}
            >
              <div class="display-mode-button">
                <span class="current-mode-label">${r}</span>
                ${hfe}
              </div>
            </edgeless-tool-icon-button>
          </div>
          <note-display-mode-panel
            .displayMode=${i}
            .panelWidth=${220}
            .onSelect=${s=>{this._dispatchDisplayModeChangeEvent(this.note,s),this._displayModePopper?.hide()}}
          >
          </note-display-mode-panel>
        </div>`}
          <div class="card-content">
            ${n.map(s=>b`<outline-block-preview
                .block=${s}
                .showPreviewIcon=${this.showPreviewIcon}
                .disabledIcon=${this.invisible}
                .cardNumber=${this.number}
                .enableNotesSorting=${this.enableNotesSorting}
                @click=${()=>{this.editorMode==="edgeless"||this.invisible||this._dispatchClickBlockEvent(s)}}
              ></outline-block-preview>`)}
            </div>
          </div>
        </div>
      </div>
    `}}Br([L({attribute:!1})],ur.prototype,"page",2);Br([L({attribute:!1})],ur.prototype,"editorMode",2);Br([L({attribute:!1})],ur.prototype,"note",2);Br([L({attribute:!1})],ur.prototype,"index",2);Br([L({attribute:!1})],ur.prototype,"number",2);Br([L({attribute:!1})],ur.prototype,"showPreviewIcon",2);Br([L({attribute:!1})],ur.prototype,"enableNotesSorting",2);Br([L({attribute:!1})],ur.prototype,"status",2);Br([L({attribute:!1})],ur.prototype,"invisible",2);Br([ie()],ur.prototype,"_showPopper",2);Br([he(".display-mode-button-group")],ur.prototype,"_displayModeButtonGroup",2);Br([he("note-display-mode-panel")],ur.prototype,"_displayModePanel",2);function j3e(t){const{doc:e,host:n,container:i,onDragMove:r,onDragEnd:o,outlineListContainer:s}=t,a=G3e(e),l=s.getBoundingClientRect(),c=Array.from(s.children);let d,u;i.renderRoot.appendChild(a);const h=v=>v.clientX>=l.left&&v.clientX<=l.right&&v.clientY>=l.top&&v.clientY<=l.bottom,p=jd(i,"mousemove",v=>{if(!h(v)){d=void 0,r?.(d,0);return}d=0;for(const m of c){if(m.invisible||!m.note)break;const y=l.top+m.offsetTop-s.scrollTop,x=y+m.offsetHeight/2,T=y+m.offsetHeight;if(v.clientY>=y&&v.clientY<=T){d=v.clientY>x?d+1:d,u=v.clientY>x?T:y,u-=l.top,r?.(d,u);return}++d}r?.(d)});let g=!1;Gd(n,"mouseup",()=>{g||(g=!0,i.renderRoot.removeChild(a),p(),o?.(d))})}function G3e(t){const e=t.createElement("div");return e.style.height="100vh",e.style.width="100vw",e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.zIndex="calc(var(--affine-z-index-popover, 0) + 3)",e.style.cursor="grabbing",e}var Z3e=Object.defineProperty,W3e=Object.getOwnPropertyDescriptor,Fn=(t,e,n,i)=>{for(var r=i>1?void 0:i?W3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Z3e(e,n,r),r};const q3e=X`
  .outline-panel-body-container {
    position: relative;
    display: flex;
    align-items: start;
    box-sizing: border-box;
    flex-direction: column;
    width: 100%;
    height: 100%;
    padding: 0 8px;
  }

  .panel-list {
    position: relative;
    width: 100%;
  }

  .panel-list .hidden-title {
    width: 100%;
    font-size: 14px;
    line-height: 24px;
    font-weight: 500;
    color: var(--affine-text-secondary-color);
    padding-left: 8px;
    height: 40px;
    box-sizing: border-box;
    padding: 6px 8px;
    margin-top: 8px;
  }

  .insert-indicator {
    height: 2px;
    border-radius: 1px;
    background-color: var(--affine-brand-color);
    border-radius: 1px;
    position: absolute;
    contain: layout size;
    width: 100%;
  }

  .no-note-container {
    display: flex;
    flex-direction: column;
    width: 100%;
  }

  .note-placeholder {
    margin-top: 240px;
    align-self: center;
    width: 190px;
    height: 48px;
    color: var(--affine-text-secondary-color, #8e8d91);
    text-align: center;
    /* light/base */
    font-size: 15px;
    font-style: normal;
    font-weight: 400;
    line-height: 24px;
  }
`;class Mn extends me(Ae){constructor(){super(...arguments),this._dragging=!1,this._pageVisibleNotes=[],this._edgelessOnlyNotes=[],this.mode="page",this._selected=[],this._pageDisposables=null,this._indicatorTranslateY=0,this._changedFlag=!1,this._highlightMask=null,this._highlightTimeoutId=null}static{this.styles=q3e}get viewportPadding(){return this.fitPadding?[0,0,0,0].map((e,n)=>Number.isFinite(this.fitPadding[n])?this.fitPadding[n]:e):[0,0,0,0]}_isEdgelessMode(){return this.mode==="edgeless"}_clearHighlightMask(){this._highlightMask?.remove(),this._highlightMask=null,this._highlightTimeoutId&&(clearTimeout(this._highlightTimeoutId),this._highlightTimeoutId=null)}connectedCallback(){super.connectedCallback()}disconnectedCallback(){if(super.disconnectedCallback(),!this._changedFlag&&this._oldViewport){const e=this.edgeless;if(!e)return;e.service.viewport.setViewport(this._oldViewport.zoom,[this._oldViewport.center.x,this._oldViewport.center.y],!0)}this._clearPageDisposables(),this._clearHighlightMask()}_clearPageDisposables(){this._pageDisposables?.dispose(),this._pageDisposables=null}_updateNoticeVisibility(){if(this.enableNotesSorting){this.noticeVisible&&this.setNoticeVisibility(!1);return}this._pageVisibleNotes.some(n=>n.note.displayMode===qe.DocOnly)&&!this.noticeVisible&&this.setNoticeVisibility(!0)}_setPageDisposables(){const{slots:e,root:n}=this.page,i=n?[n.childrenUpdated,e.blockUpdated]:[e.blockUpdated];e.rootAdded.on(r=>{this._clearPageDisposables(),this._pageDisposables=new dt,this._pageDisposables.add(r.childrenUpdated.on(()=>{this._updateNotes(),this._updateNoticeVisibility()}))}),i.forEach(r=>{this._clearPageDisposables(),this._pageDisposables=new dt,this._pageDisposables.add(r.on(()=>{this._updateNotes(),this._updateNoticeVisibility()}))}),this._updateNotes(),this._updateNoticeVisibility()}updated(e){if((e.has("page")||e.has("edgeless"))&&this._setPageDisposables(),e.has("mode")&&this.edgeless&&this._isEdgelessMode()){if(this._clearHighlightMask(),e.get("mode")===void 0)return;requestAnimationFrame(()=>this._zoomToFit())}}_updateNotes(){const e=this.page.root;if(this._dragging)return;if(!e){this._pageVisibleNotes=[];return}const n=[],i=[],r=this._selected.reduce((s,a)=>(s.add(a),s),new Set),o=[];e.children.forEach((s,a)=>{if(!["affine:note"].includes(s.flavour))return;const l=s,c={note:s,index:a,number:a+1};l.displayMode===qe.EdgelessOnly||!l.displayMode&&l.hidden?i.push(c):(n.push(c),r.has(s.id)&&o.push(s.id))}),this._pageVisibleNotes=n,this._edgelessOnlyNotes=i,this._selected=o}_moveNotes(e,n,i,r,o){if(!this._isEdgelessMode()||!o.length||!this.page.root)return;const s=n.map(h=>i.get(h).note),a=new Set(s),l=e===r.length?r[e-1].index+1:r[e].index,c=o.slice(0,l).filter(h=>!a.has(h)),d=o.slice(l).filter(h=>!a.has(h)),u=[...c,...s,...d];this._changedFlag=!0,this.page.updateBlock(this.page.root,{children:u}),this.page.root.childrenUpdated.emit()}_selectNote(e){if(!this._isEdgelessMode())return;const{selected:n,id:i,multiselect:r}=e.detail;n?r?this._selected=[...this._selected,i]:this._selected=[i]:this._selected=this._selected.filter(s=>s!==i);const o=this._pageVisibleNotes.reduce((s,a)=>{const l=a.note;return this._selected.includes(l.id)&&(!l.displayMode||l.displayMode===qe.DocAndEdgeless)&&s.push(l.id),s},[]);this.edgeless?.service.selection.set({elements:o,editing:!1})}_drag(){if(!this._selected.length||!this._pageVisibleNotes.length||!this.page.root)return;this._dragging=!0;const e=this.page.root.children.slice(),n=this._pageVisibleNotes,i=this._pageVisibleNotes.reduce((o,s,a)=>(o.set(s.note.id,{...s,number:a+1}),o),new Map),r=this._selected.slice();j3e({container:this,doc:this.ownerDocument,host:this.domHost??this.ownerDocument,page:this.page,outlineListContainer:this.panelListElement,onDragEnd:o=>{this._dragging=!1,this.insertIndex=void 0,o!==void 0&&this._moveNotes(o,r,i,n,e)},onDragMove:(o,s)=>{this.insertIndex=o,this._indicatorTranslateY=s??0}})}_clickHandler(e){e.stopPropagation(),!(e.target.closest("outline-note-card")||this._selected.length===0)&&(this._selected=[],this.edgeless?.service.selection.set({elements:this._selected,editing:!1}))}_doubleClickHandler(e){e.stopPropagation(),!(e.target.closest("outline-note-card")||!this.enableNotesSorting)&&this.toggleNotesSorting()}firstUpdated(){this.disposables.addFromEvent(this,"click",this._clickHandler),this.disposables.addFromEvent(this,"dblclick",this._doubleClickHandler)}_zoomToFit(){const e=this.edgeless;if(!e)return;const n=e.getElementsBound();n&&(this._oldViewport={zoom:e.service.viewport.zoom,center:{x:e.service.viewport.center.x,y:e.service.viewport.center.y}},e.service.viewport.setViewportByBound(new ne(n.x,n.y,n.w,n.h),this.viewportPadding,!0))}_fitToElement(e){const n=this.edgeless;if(!n)return;const{block:i}=e.detail,r=ne.deserialize(i.xywh);n.service.viewport.setViewportByBound(r,this.viewportPadding,!0)}_deSelectNoteInEdgelessMode(e){if(!this._isEdgelessMode()||!this.edgeless)return;const{selection:n}=this.edgeless.service;if(!n.has(e.id))return;const i=n.selectedIds.filter(r=>r!==e.id);n.set({elements:i,editing:!1})}_handleDisplayModeChange(e){const{note:n,newMode:i}=e.detail,{displayMode:r}=n;if(i===r)return;this.page.updateBlock(n,{displayMode:i});const o=this.page.getParent(n);D(o);const s=o.children.filter(l=>kr.matchFlavours(l,["affine:note"])),a=s[s.length-1];r===qe.EdgelessOnly&&n!==a&&this.page.moveBlocks([n],o,a,!1),i===qe.DocOnly&&this._deSelectNoteInEdgelessMode(n)}_scrollToBlock(e){if(this._isEdgelessMode()||!this.editorHost)return;const n=this.editorHost.querySelector("affine-doc-page");if(!n)return;const{blockPath:i}=e.detail,r=[n.model.id,...i],o=this.editorHost.view.viewFromPath("block",r);o&&(o.scrollIntoView({behavior:"instant",block:"center",inline:"center"}),requestAnimationFrame(()=>{const s=o.getBoundingClientRect(),{top:a,left:l,width:c,height:d}=s,{top:u,left:h,scrollTop:p,scrollLeft:g}=n.viewport;this._highlightMask||(this._highlightMask=document.createElement("div"),n.appendChild(this._highlightMask)),Object.assign(this._highlightMask.style,{position:"absolute",top:`${a-u+p}px`,left:`${l-h+g}px`,width:`${c}px`,height:`${d}px`,background:"var(--affine-hover-color)",borderRadius:"4px",display:"block"}),this._highlightTimeoutId!==null&&clearTimeout(this._highlightTimeoutId),this._highlightTimeoutId=setTimeout(()=>{this._highlightMask&&(this._highlightMask.style.display="none")},1e3)}))}_isHeadingBlock(e){return kr.matchFlavours(e,["affine:paragraph"])&&BB.has(e.type)}_shouldRenderNoteList(e){if(!e.length)return!1;let n=!1,i=!1;for(const r of e){for(const o of r.note.children)if(i=!0,this._isHeadingBlock(o)){n=!0;break}if(n)break}return n||this.enableNotesSorting&&i}_PanelList(e){const n=new Set(this._selected);return b`<div class="panel-list">
      ${this.insertIndex!==void 0?b`<div
            class="insert-indicator"
            style=${`transform: translateY(${this._indicatorTranslateY}px)`}
          ></div>`:ae}
      ${this._pageVisibleNotes.length?Fe(this._pageVisibleNotes,i=>i.note.id,(i,r)=>b`
              <outline-note-card
                data-note-id=${i.note.id}
                .note=${i.note}
                .number=${r+1}
                .index=${i.index}
                .page=${this.page}
                .editorMode=${this.mode}
                .status=${n.has(i.note.id)?this._dragging?"placeholder":"selected":void 0}
                .showPreviewIcon=${this.showPreviewIcon}
                .enableNotesSorting=${this.enableNotesSorting}
                @select=${this._selectNote}
                @drag=${this._drag}
                @fitview=${this._fitToElement}
                @clickblock=${this._scrollToBlock}
                @displaymodechange=${this._handleDisplayModeChange}
              ></outline-note-card>
            `):b`${ae}`}
      ${e?b`<div class="hidden-title">Hidden Contents</div>
            ${Fe(this._edgelessOnlyNotes,i=>i.note.id,(i,r)=>b`<outline-note-card
                  data-note-id=${i.note.id}
                  .note=${i.note}
                  .number=${r+1}
                  .index=${i.index}
                  .page=${this.page}
                  .invisible=${!0}
                  .showPreviewIcon=${this.showPreviewIcon}
                  .enableNotesSorting=${this.enableNotesSorting}
                  @fitview=${this._fitToElement}
                  @displaymodechange=${this._handleDisplayModeChange}
                ></outline-note-card>`)} `:ae}
    </div>`}_EmptyPanel(){return b`<div class="no-note-container">
      <div class="note-placeholder">
        Use headings to create a table of contents.
      </div>
    </div>`}render(){const e=this._shouldRenderNoteList(this._pageVisibleNotes),n=this._shouldRenderNoteList(this._edgelessOnlyNotes);return b`
      <div class="outline-panel-body-container">
        ${!e&&!n?this._EmptyPanel():this._PanelList(n)}
      </div>
    `}}Fn([ie()],Mn.prototype,"_dragging",2);Fn([ie()],Mn.prototype,"_pageVisibleNotes",2);Fn([ie()],Mn.prototype,"_edgelessOnlyNotes",2);Fn([L({attribute:!1})],Mn.prototype,"page",2);Fn([L({attribute:!1})],Mn.prototype,"edgeless",2);Fn([L({attribute:!1})],Mn.prototype,"editorHost",2);Fn([L({attribute:!1})],Mn.prototype,"mode",2);Fn([L({attribute:!1})],Mn.prototype,"insertIndex",2);Fn([L({attribute:!1})],Mn.prototype,"showPreviewIcon",2);Fn([L({attribute:!1})],Mn.prototype,"enableNotesSorting",2);Fn([L({attribute:!1})],Mn.prototype,"noticeVisible",2);Fn([L({attribute:!1})],Mn.prototype,"toggleNotesSorting",2);Fn([L({attribute:!1})],Mn.prototype,"setNoticeVisibility",2);Fn([ie()],Mn.prototype,"_selected",2);Fn([he(".panel-list")],Mn.prototype,"panelListElement",2);Fn([he(".outline-panel-body-container")],Mn.prototype,"OutlinePanelContainer",2);Fn([L({attribute:!1})],Mn.prototype,"fitPadding",2);Fn([L({attribute:!1})],Mn.prototype,"domHost",2);var Y3e=Object.defineProperty,X3e=Object.getOwnPropertyDescriptor,DB=(t,e,n,i)=>{for(var r=i>1?void 0:i?X3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Y3e(e,n,r),r};const K3e=X`
  :host {
    display: block;
    box-sizing: border-box;
    padding: 8px;
    width: 220px;
  }

  .note-preview-setting-menu-container {
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    width: 100%;
  }

  .note-preview-setting-menu-item {
    display: flex;
    box-sizing: border-box;
    width: 100%;
    height: 28px;
    padding: 4px 12px;
    align-items: center;
  }

  .note-preview-setting-menu-item .setting-label {
    font-family: sans-serif;
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
    color: var(--affine-text-secondary-color);
    padding: 0 4px;
  }

  .note-preview-setting-menu-item.action {
    gap: 4px;
  }

  .note-preview-setting-menu-item .action-label {
    width: 138px;
    height: 20px;
    padding: 0 4px;
    font-size: 12px;
    font-weight: 500;
    line-height: 20px;
    color: var(--affine-text-primary-color);
  }

  .note-preview-setting-menu-item .toggle-button {
    display: flex;
  }
`;class Vy extends me(Ae){static{this.styles=K3e}render(){return b`<div
      class="note-preview-setting-menu-container"
      @click=${e=>e.stopPropagation()}
    >
      <div class="note-preview-setting-menu-item">
        <div class="setting-label">Settings</div>
      </div>
      <div class="note-preview-setting-menu-item action">
        <div class="action-label">Show type icon</div>
        <div class="toggle-button">
          <toggle-switch
            .on=${this.showPreviewIcon}
            .onChange=${this.toggleShowPreviewIcon}
          ></toggle-switch>
        </div>
      </div>
    </div>`}}DB([L({attribute:!1})],Vy.prototype,"showPreviewIcon",2);DB([L({attribute:!1})],Vy.prototype,"toggleShowPreviewIcon",2);var Q3e=Object.defineProperty,J3e=Object.getOwnPropertyDescriptor,Kc=(t,e,n,i)=>{for(var r=i>1?void 0:i?J3e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&Q3e(e,n,r),r};const e4e=X`
  :host {
    display: flex;
    width: 100%;
    height: 40px;
    align-items: center;
    justify-content: space-between;
    box-sizing: border-box;
    padding: 8px 16px;
  }

  .outline-panel-header-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    padding-right: 6px;
  }

  .note-setting-container {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .outline-panel-header-label {
    width: 119px;
    height: 22px;
    font-size: 14px;
    font-weight: 500;
    line-height: 22px;
    color: var(--affine-text-secondary-color, #8e8d91);
  }

  .note-sorting-button {
    justify-self: end;
  }

  .note-setting-button svg,
  .note-sorting-button svg {
    color: var(--affine-icon-secondary);
  }

  .note-setting-button:hover svg,
  .note-setting-button.active svg,
  .note-sorting-button:hover svg {
    color: var(--affine-icon-color);
  }

  .note-sorting-button.active svg {
    color: var(--affine-primary-color);
  }

  .note-preview-setting-container {
    display: none;
    justify-content: center;
    align-items: center;
    background: var(--affine-background-overlay-panel-color);
    box-shadow: var(--affine-shadow-2);
    border-radius: 8px;
  }

  .note-preview-setting-container[data-show] {
    display: flex;
  }
`;class xl extends me(Ae){constructor(){super(...arguments),this._settingPopperShow=!1,this._notePreviewSettingMenuPopper=null}static{this.styles=e4e}firstUpdated(){const e=this._disposables;this._notePreviewSettingMenuPopper=Nt(this._noteSettingButton,this._notePreviewSettingMenu,({display:n})=>{this._settingPopperShow=n==="show"},14,-90),e.add(this._notePreviewSettingMenuPopper)}render(){return b`<div class="outline-panel-header-container">
        <div class="note-setting-container">
          <span class="outline-panel-header-label">Table of Contents</span>
          <edgeless-tool-icon-button
            class="note-setting-button ${this._settingPopperShow?"active":""}"
            .tooltip=${this._settingPopperShow?"":"Preview Settings"}
            .tipPosition=${"left"}
            .iconContainerPadding=${2}
            .active=${this._settingPopperShow}
            .activeMode=${"background"}
            @click=${()=>this._notePreviewSettingMenuPopper?.toggle()}
          >
            ${E$}
          </edgeless-tool-icon-button>
        </div>
        <edgeless-tool-icon-button
          class="note-sorting-button ${this.enableNotesSorting?"active":""}"
          .tooltip=${"Note Sort Options"}
          .tipPosition=${"left"}
          .iconContainerPadding=${0}
          .active=${this.enableNotesSorting}
          .activeMode=${"color"}
          @click=${()=>this.toggleNotesSorting()}
        >
          ${S$}
        </edgeless-tool-icon-button>
      </div>
      <div class="note-preview-setting-container">
        <outline-note-preview-setting-menu
          .showPreviewIcon=${this.showPreviewIcon}
          .toggleShowPreviewIcon=${this.toggleShowPreviewIcon}
        ></outline-note-preview-setting-menu>
      </div>`}}Kc([L({attribute:!1})],xl.prototype,"showPreviewIcon",2);Kc([L({attribute:!1})],xl.prototype,"enableNotesSorting",2);Kc([L({attribute:!1})],xl.prototype,"toggleShowPreviewIcon",2);Kc([L({attribute:!1})],xl.prototype,"toggleNotesSorting",2);Kc([ie()],xl.prototype,"_settingPopperShow",2);Kc([he(".note-setting-button")],xl.prototype,"_noteSettingButton",2);Kc([he(".note-preview-setting-container")],xl.prototype,"_notePreviewSettingMenu",2);var t4e=Object.defineProperty,n4e=Object.getOwnPropertyDescriptor,af=(t,e,n,i)=>{for(var r=i>1?void 0:i?n4e(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(r=(i?s(e,n,r):s(r))||r);return i&&r&&t4e(e,n,r),r};const i4e=X`
  :host {
    display: block;
    width: 100%;
    height: 100%;
  }

  .outline-panel-container {
    background-color: var(--affine-background-primary-color);
    box-sizing: border-box;

    display: flex;
    flex-direction: column;
    align-items: stretch;

    height: 100%;
    font-family: ${Je(vt.fontSansFamily)};
    padding-top: 8px;
    position: relative;
  }

  .outline-panel-body {
    flex-grow: 1;
    width: 100%;

    overflow-y: scroll;
  }
  .outline-panel-body::-webkit-scrollbar {
    width: 4px;
  }
  .outline-panel-body::-webkit-scrollbar-thumb {
    border-radius: 2px;
  }
  .outline-panel-body:hover::-webkit-scrollbar-thumb {
    background-color: var(--affine-black-30);
  }
  .outline-panel-body::-webkit-scrollbar-track {
    background-color: transparent;
  }
  .outline-panel-body::-webkit-scrollbar-corner {
    display: none;
  }
`;class Qc extends me(Ae){constructor(){super(...arguments),this._showPreviewIcon=!1,this._enableNotesSorting=!1,this._noticeVisible=!1,this._toggleShowPreviewIcon=e=>{this._showPreviewIcon=e},this._toggleNotesSorting=()=>{this._enableNotesSorting=!this._enableNotesSorting},this._setNoticeVisibility=e=>{this._noticeVisible=e},this._editorDisposables=null}static{this.styles=i4e}get page(){return this.editor.page}get host(){return this.editor.host}get edgeless(){return this.editor.querySelector("affine-edgeless-page")}get mode(){return this.editor.mode}_clearEditorDisposables(){this._editorDisposables?.dispose(),this._editorDisposables=null}_setEditorDisposables(){this._clearEditorDisposables(),this._editorDisposables=new dt,this._editorDisposables.add(this.editor.slots.pageModeSwitched.on(()=>{this.editor.updateComplete.then(()=>{this.requestUpdate()}).catch(console.error)})),this._editorDisposables.add(this.editor.slots.pageUpdated.on(()=>{this.editor.updateComplete.then(()=>{this.requestUpdate()}).catch(console.error)}))}updated(e){e.has("editor")&&this._setEditorDisposables()}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._clearEditorDisposables()}render(){return b`
      <div class="outline-panel-container">
        <outline-panel-header
          .showPreviewIcon=${this._showPreviewIcon}
          .enableNotesSorting=${this._enableNotesSorting}
          .toggleShowPreviewIcon=${this._toggleShowPreviewIcon}
          .toggleNotesSorting=${this._toggleNotesSorting}
        ></outline-panel-header>
        <outline-panel-body
          class="outline-panel-body"
          .page=${this.page}
          .fitPadding=${this.fitPadding}
          .edgeless=${this.edgeless}
          .editorHost=${this.host}
          .mode=${this.mode}
          .showPreviewIcon=${this._showPreviewIcon}
          .enableNotesSorting=${this._enableNotesSorting}
          .toggleNotesSorting=${this._toggleNotesSorting}
          .noticeVisible=${this._noticeVisible}
          .setNoticeVisibility=${this._setNoticeVisibility}
        >
        </outline-panel-body>
        <outline-notice
          .noticeVisible=${this._noticeVisible}
          .toggleNotesSorting=${this._toggleNotesSorting}
          .setNoticeVisibility=${this._setNoticeVisibility}
        ></outline-notice>
      </div>
    `}}af([L({attribute:!1})],Qc.prototype,"editor",2);af([L({attribute:!1})],Qc.prototype,"fitPadding",2);af([ie()],Qc.prototype,"_showPreviewIcon",2);af([ie()],Qc.prototype,"_enableNotesSorting",2);af([ie()],Qc.prototype,"_noticeVisible",2);const r4e={"outline-note-card":ur,"outline-block-preview":$u,"outline-panel":Qc,"outline-note-preview-setting-menu":Vy,"outline-panel-body":Mn,"outline-panel-header":xl,"outline-notice":R4};function o4e(t){t(r4e)}function s4e(){const t=new jB().register(w$),n=new nt({schema:t}).createPage();return{page:n,async init(){return await n.load(()=>{const i=n.addBlock("affine:page",{});n.addBlock("affine:surface",{},i);const r=n.addBlock("affine:note",{},i);n.addBlock("affine:paragraph",{},r)}),n}}}const OB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},RB="__ $BLOCKSUITE_EDITOR$ __";OB[RB]===!0&&console.error("@blocksuite/presets was already imported. This breaks constructor checks and will lead to issues!");if(typeof window>"u")throw new Error("Seems like you are importing @blocksuite/presets in SSR mode. Which is not supported for now.");OB[RB]=!0;const _4e=Object.freeze(Object.defineProperty({__proto__:null,get AffineDocEditor(){return Vp},get AffineEditorContainer(){return zo},get BiDirectionalLinkPanel(){return Ya},get CopilotPanel(){return Fd},get DocEditor(){return Rd},get DocTitle(){return Wa},get EdgelessEditor(){return zp},FramePanel:O4,OutlinePanel:Qc,get PageMetaTags(){return qa},createEmptyPage:s4e,registerFramePanelComponents:$3e,registerOutlinePanelComponents:o4e},Symbol.toStringTag,{value:"Module"}));export{hv as A,kr as B,LM as C,E4 as D,gy as E,PM as F,Z9 as G,Vg as H,s4e as I,Rd as J,zp as K,WP as L,k2e as M,B2e as N,_m as O,VP as P,L2e as Q,M2e as R,Ob as S,Phe as T,E2e as U,_ge as V,eP as W,Xb as X,B0e as _,Dhe as a,Rhe as b,Fhe as c,w$ as d,L8 as e,zo as f,d4e as g,F0 as h,Uhe as i,Sv as j,Ev as k,Tv as l,tA as m,c4e as n,h4e as o,r4 as p,_4e as q,i4 as r,Dg as s,Vd as t,Nhe as u,$3e as v,o4e as w,Na as x,MM as y,Fd as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/browser-lRWe77PM.js","assets/static-yoecXErL.js","assets/index-HSX1BOCG.js","assets/ref-ehjBZcli.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=affine-C_E42r0n.js.map
